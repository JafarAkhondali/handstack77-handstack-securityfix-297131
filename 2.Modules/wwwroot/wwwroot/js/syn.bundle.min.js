!function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){"use strict";var P=new Map;function F(e){e=P.get(e);e&&e.destroy()}function B(e){e=P.get(e);e&&e.update()}var e=null,H=("undefined"==typeof window?((e=function(e){return e}).destroy=function(e){return e},e.update=function(e){return e}):((e=function(e,t){return e&&Array.prototype.forEach.call(e.length?e:[e],function(e){function i(e){var t,n=e.restoreTextAlign,n=void 0===n?null:n,e=e.testForHeightReduction,e=void 0===e||e,r=a.overflowY;0===o.scrollHeight||("vertical"===a.resize?o.style.resize="none":"both"===a.resize&&(o.style.resize="horizontal"),e&&(t=function(e){for(var t=[];e&&e.parentNode&&e.parentNode instanceof Element;)e.parentNode.scrollTop&&t.push([e.parentNode,e.parentNode.scrollTop]),e=e.parentNode;return function(){return t.forEach(function(e){var t=e[0],e=e[1];t.style.scrollBehavior="auto",t.scrollTop=e,t.style.scrollBehavior=null})}}(o),o.style.height=""),e="content-box"===a.boxSizing?o.scrollHeight-(parseFloat(a.paddingTop)+parseFloat(a.paddingBottom)):o.scrollHeight+parseFloat(a.borderTopWidth)+parseFloat(a.borderBottomWidth),"none"!==a.maxHeight&&e>parseFloat(a.maxHeight)?("hidden"===a.overflowY&&(o.style.overflow="scroll"),e=parseFloat(a.maxHeight)):"hidden"!==a.overflowY&&(o.style.overflow="hidden"),o.style.height=e+"px",n&&(o.style.textAlign=n),t&&t(),s!==e&&(o.dispatchEvent(new Event("autosize:resized",{bubbles:!0})),s=e),r===a.overflow)||n||(t=a.textAlign,"hidden"===a.overflow&&(o.style.textAlign="start"===t?"end":"start"),i({restoreTextAlign:t,testForHeightReduction:!0}))}function n(){i({testForHeightReduction:!0,restoreTextAlign:null})}var o,t,s,a,r,l;(o=e)&&o.nodeName&&"TEXTAREA"===o.nodeName&&!P.has(o)&&(s=null,a=window.getComputedStyle(o),t=o.value,r=function(){i({testForHeightReduction:""===t||!o.value.startsWith(t),restoreTextAlign:null}),t=o.value},l=function(t){o.removeEventListener("autosize:destroy",l),o.removeEventListener("autosize:update",n),o.removeEventListener("input",r),window.removeEventListener("resize",n),Object.keys(t).forEach(function(e){return o.style[e]=t[e]}),P.delete(o)}.bind(o,{height:o.style.height,resize:o.style.resize,textAlign:o.style.textAlign,overflowY:o.style.overflowY,overflowX:o.style.overflowX,wordWrap:o.style.wordWrap}),o.addEventListener("autosize:destroy",l),o.addEventListener("autosize:update",n),o.addEventListener("input",r),window.addEventListener("resize",n),o.style.overflowX="hidden",o.style.wordWrap="break-word",P.set(o,{destroy:l,update:n}),n())}),e}).destroy=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],F),e},e.update=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],B),e}),e),e=document.querySelectorAll('[data-bs-toggle="autosize"]');function U(e,t){if(null==e)return{};for(var n,r={},i=Object.keys(e),o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||(r[n]=e[n]);return r}function l(e){return new l.InputMask(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})}e.length&&e.forEach(function(e){H(e)});class d{constructor(e){Object.assign(this,{inserted:"",rawInserted:"",skip:!1,tailShift:0},e)}aggregate(e){return this.rawInserted+=e.rawInserted,this.skip=this.skip||e.skip,this.inserted+=e.inserted,this.tailShift+=e.tailShift,this}get offset(){return this.tailShift+this.inserted.length}}function V(e){return"string"==typeof e||e instanceof String}l.ChangeDetails=d;const h="NONE",f="LEFT",p="FORCE_LEFT",W="RIGHT",g="FORCE_RIGHT";function $(e){return e.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function j(e){return Array.isArray(e)?e:[e,new d]}function z(e,t){if(t===e)return!0;var n=Array.isArray(t),r=Array.isArray(e);if(n&&r){if(t.length!=e.length)return!1;for(o=0;o<t.length;o++)if(!z(t[o],e[o]))return!1;return!0}if(n!=r)return!1;if(t&&e&&"object"==typeof t&&"object"==typeof e){n=t instanceof Date,r=e instanceof Date;if(n&&r)return t.getTime()==e.getTime();if(n!=r)return!1;n=t instanceof RegExp,r=e instanceof RegExp;if(n&&r)return t.toString()==e.toString();if(n!=r)return!1;for(var i=Object.keys(t),o=0;o<i.length;o++)if(!Object.prototype.hasOwnProperty.call(e,i[o]))return!1;for(o=0;o<i.length;o++)if(!z(e[i[o]],t[i[o]]))return!1;return!0}return!(!t||!e||"function"!=typeof t||"function"!=typeof e)&&t.toString()===e.toString()}class G{constructor(e,t,n,r){for(this.value=e,this.cursorPos=t,this.oldValue=n,this.oldSelection=r;this.value.slice(0,this.startChangePos)!==this.oldValue.slice(0,this.startChangePos);)--this.oldSelection.start}get startChangePos(){return Math.min(this.cursorPos,this.oldSelection.start)}get insertedCount(){return this.cursorPos-this.startChangePos}get inserted(){return this.value.substr(this.startChangePos,this.insertedCount)}get removedCount(){return Math.max(this.oldSelection.end-this.startChangePos||this.oldValue.length-this.value.length,0)}get removed(){return this.oldValue.substr(this.startChangePos,this.removedCount)}get head(){return this.value.substring(0,this.startChangePos)}get tail(){return this.value.substring(this.startChangePos+this.insertedCount)}get removeDirection(){return!this.removedCount||this.insertedCount?h:this.oldSelection.end!==this.cursorPos&&this.oldSelection.start!==this.cursorPos||this.oldSelection.end!==this.oldSelection.start?f:W}}class a{constructor(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length?arguments[2]:void 0;this.value=e,this.from=t,this.stop=n}toString(){return this.value}extend(e){this.value+=String(e)}appendTo(e){return e.append(this.toString(),{tail:!0}).aggregate(e._appendPlaceholder())}get state(){return{value:this.value,from:this.from,stop:this.stop}}set state(e){Object.assign(this,e)}unshift(e){return!this.value.length||null!=e&&this.from>=e?"":(e=this.value[0],this.value=this.value.slice(1),e)}shift(){var e;return this.value.length?(e=this.value[this.value.length-1],this.value=this.value.slice(0,-1),e):""}}class n{constructor(e){this._value="",this._update(Object.assign({},n.DEFAULTS,e)),this.isInitialized=!0}updateOptions(e){Object.keys(e).length&&this.withValueRefresh(this._update.bind(this,e))}_update(e){Object.assign(this,e)}get state(){return{_value:this.value}}set state(e){this._value=e._value}reset(){this._value=""}get value(){return this._value}set value(e){this.resolve(e)}resolve(e){return this.reset(),this.append(e,{input:!0},""),this.doCommit(),this.value}get unmaskedValue(){return this.value}set unmaskedValue(e){this.reset(),this.append(e,{},""),this.doCommit()}get typedValue(){return this.doParse(this.value)}set typedValue(e){this.value=this.doFormat(e)}get rawInputValue(){return this.extractInput(0,this.value.length,{raw:!0})}set rawInputValue(e){this.reset(),this.append(e,{raw:!0},""),this.doCommit()}get displayValue(){return this.value}get isComplete(){return!0}get isFilled(){return this.isComplete}nearestInputPos(e,t){return e}totalInputPositions(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.value.length;return Math.min(this.value.length,t-e)}extractInput(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.value.length;return this.value.slice(e,t)}extractTail(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.value.length;return new a(this.extractInput(e,t),e)}appendTail(e){return(e=V(e)?new a(String(e)):e).appendTo(this)}_appendCharRaw(e){return e?(this._value+=e,new d({inserted:e,rawInserted:e})):new d}_appendChar(e){let r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=2<arguments.length?arguments[2]:void 0;var o=this.state;let s;if([e,s]=j(this.doPrepare(e,r)),(s=s.aggregate(this._appendCharRaw(e,r))).inserted){let t,n=!1!==this.doValidate(r);if(n&&null!=i){const r=this.state;!0===this.overwrite&&(t=i.state,i.unshift(this.value.length-s.tailShift));let e=this.appendTail(i);(n=e.rawInserted===i.toString())&&e.inserted||"shift"!==this.overwrite||(this.state=r,t=i.state,i.shift(),e=this.appendTail(i),n=e.rawInserted===i.toString()),n&&e.inserted&&(this.state=r)}n||(s=new d,this.state=o,i&&t&&(i.state=t))}return s}_appendPlaceholder(){return new d}_appendEager(){return new d}append(t,n,e){if(!V(t))throw new Error("value should be string");var r=new d,i=V(e)?new a(String(e)):e;null!=n&&n.tail&&(n._beforeTailState=this.state);for(let e=0;e<t.length;++e){var o=this._appendChar(t[e],n,i);if(!o.rawInserted&&!this.doSkipInvalid(t[e],n,i))break;r.aggregate(o)}return null!=i&&(r.tailShift+=this.appendTail(i).tailShift),(!0===this.eager||"append"===this.eager)&&null!=n&&n.input&&t&&r.aggregate(this._appendEager()),r}remove(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.value.length;return this._value=this.value.slice(0,e)+this.value.slice(t),new d}withValueRefresh(e){if(this._refreshing||!this.isInitialized)return e();this._refreshing=!0;var t=this.rawInputValue,n=this.value,e=e();return this.rawInputValue=t,this.value&&this.value!==n&&0===n.indexOf(this.value)&&this.append(n.slice(this.value.length),{},""),delete this._refreshing,e}runIsolated(e){if(this._isolated||!this.isInitialized)return e(this);this._isolated=!0;var t=this.state,e=e(this);return this.state=t,delete this._isolated,e}doSkipInvalid(e){return this.skipInvalid}doPrepare(e){return this.prepare?this.prepare(e,this,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}):e}doValidate(e){return(!this.validate||this.validate(this.value,this,e))&&(!this.parent||this.parent.doValidate(e))}doCommit(){this.commit&&this.commit(this.value,this)}doFormat(e){return this.format?this.format(e,this):e}doParse(e){return this.parse?this.parse(e,this):e}splice(e,t,n,r){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{input:!0},o=e+t,s=this.extractTail(o),a=!0===this.eager||"remove"===this.eager;let l,u=(a&&(r=function(e){switch(e){case f:return p;case W:return g;default:return e}}(r),l=this.extractInput(0,o,{raw:!0})),e);var c=new d;if(r!==h&&(u=this.nearestInputPos(e,1<t&&0!==e&&!a?h:r),c.tailShift=u-e),c.aggregate(this.remove(u)),a&&r!==h&&l===this.rawInputValue)if(r===p){let e;for(;l===this.rawInputValue&&(e=this.value.length);)c.aggregate(new d({tailShift:-1})).aggregate(this.remove(e-1))}else r===g&&s.unshift();return c.aggregate(this.append(n,i,s))}maskEquals(e){return this.mask===e}typedValueEquals(e){var t=this.typedValue;return e===t||n.EMPTY_VALUES.includes(e)&&n.EMPTY_VALUES.includes(t)||this.doFormat(e)===this.doFormat(this.typedValue)}}function Y(e){if(null==e)throw new Error("mask property should be defined");return e instanceof RegExp?l.MaskedRegExp:V(e)?l.MaskedPattern:e instanceof Date||e===Date?l.MaskedDate:e instanceof Number||"number"==typeof e||e===Number?l.MaskedNumber:Array.isArray(e)||e===Array?l.MaskedDynamic:l.Masked&&e.prototype instanceof l.Masked?e:e instanceof l.Masked?e.constructor:e instanceof Function?l.MaskedFunction:(console.warn("Mask not found for mask",e),l.Masked)}function u(e){if(l.Masked&&e instanceof l.Masked)return e;var t=(e=Object.assign({},e)).mask;if(l.Masked&&t instanceof l.Masked)return t;t=Y(t);if(t)return new t(e);throw new Error("Masked class is not found for provided mask, appropriate module needs to be import manually before creating mask.")}n.DEFAULTS={format:String,parse:e=>e,skipInvalid:!0},n.EMPTY_VALUES=[void 0,null,""],l.Masked=n,l.createMask=u;const X=["parent","isOptional","placeholderChar","displayChar","lazy","eager"],K={0:/\d/,a:/[\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,"*":/./};class q{constructor(e){var{parent:t,isOptional:n,placeholderChar:r,displayChar:i,lazy:o,eager:s}=e,e=U(e,X);this.masked=u(e),Object.assign(this,{parent:t,isOptional:n,placeholderChar:r,displayChar:i,lazy:o,eager:s})}reset(){this.isFilled=!1,this.masked.reset()}remove(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.value.length;return 0===e&&1<=t?(this.isFilled=!1,this.masked.remove(e,t)):new d}get value(){return this.masked.value||(this.isFilled&&!this.isOptional?this.placeholderChar:"")}get unmaskedValue(){return this.masked.unmaskedValue}get displayValue(){return this.masked.value&&this.displayChar||this.value}get isComplete(){return Boolean(this.masked.value)||this.isOptional}_appendChar(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return this.isFilled?new d:(t=this.masked.state,(e=this.masked._appendChar(e,n)).inserted&&!1===this.doValidate(n)&&(e.inserted=e.rawInserted="",this.masked.state=t),e.inserted||this.isOptional||this.lazy||n.input||(e.inserted=this.placeholderChar),e.skip=!e.inserted&&!this.isOptional,this.isFilled=Boolean(e.inserted),e)}append(){return this.masked.append(...arguments)}_appendPlaceholder(){var e=new d;return this.isFilled||this.isOptional||(this.isFilled=!0,e.inserted=this.placeholderChar),e}_appendEager(){return new d}extractTail(){return this.masked.extractTail(...arguments)}appendTail(){return this.masked.appendTail(...arguments)}extractInput(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.value.length;return this.masked.extractInput(e,t,2<arguments.length?arguments[2]:void 0)}nearestInputPos(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:h,n=this.value.length,r=Math.min(Math.max(e,0),n);switch(t){case f:case p:return this.isComplete?r:0;case W:case g:return this.isComplete?r:n;default:return r}}totalInputPositions(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.value.length;return this.value.slice(e,t).length}doValidate(){return this.masked.doValidate(...arguments)&&(!this.parent||this.parent.doValidate(...arguments))}doCommit(){this.masked.doCommit()}get state(){return{masked:this.masked.state,isFilled:this.isFilled}}set state(e){this.masked.state=e.masked,this.isFilled=e.isFilled}}class Z{constructor(e){Object.assign(this,e),this._value="",this.isFixed=!0}get value(){return this._value}get unmaskedValue(){return this.isUnmasking?this.value:""}get displayValue(){return this.value}reset(){this._isRawInput=!1,this._value=""}remove(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this._value.length;return this._value=this._value.slice(0,e)+this._value.slice(t),this._value||(this._isRawInput=!1),new d}nearestInputPos(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:h,n=this._value.length;switch(t){case f:case p:return 0;default:return n}}totalInputPositions(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this._value.length;return this._isRawInput?t-e:0}extractInput(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this._value.length;return(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).raw&&this._isRawInput&&this._value.slice(e,t)||""}get isComplete(){return!0}get isFilled(){return Boolean(this._value)}_appendChar(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=new d;return this.isFilled||(t=!0===this.eager||"append"===this.eager,(e=this.char===e&&(this.isUnmasking||n.input||n.raw)&&(!n.raw||!t)&&!n.tail)&&(r.rawInserted=this.char),this._value=r.inserted=this.char,this._isRawInput=e&&(n.raw||n.input)),r}_appendEager(){return this._appendChar(this.char,{tail:!0})}_appendPlaceholder(){var e=new d;return this.isFilled||(this._value=e.inserted=this.char),e}extractTail(){return 1<arguments.length&&void 0!==arguments[1]||this.value.length,new a("")}appendTail(e){return(e=V(e)?new a(String(e)):e).appendTo(this)}append(e,t,n){e=this._appendChar(e[0],t);return null!=n&&(e.tailShift+=this.appendTail(n).tailShift),e}doCommit(){}get state(){return{_value:this._value,_isRawInput:this._isRawInput}}set state(e){Object.assign(this,e)}}const Q=["chunks"];class J{constructor(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.chunks=e,this.from=t}toString(){return this.chunks.map(String).join("")}extend(e){if(String(e)){V(e)&&(e=new a(String(e)));var t,n=this.chunks[this.chunks.length-1],r=n&&(n.stop===e.stop||null==e.stop)&&e.from===n.from+n.toString().length;if(e instanceof a)r?n.extend(e.toString()):this.chunks.push(e);else if(e instanceof J){if(null==e.stop)for(;e.chunks.length&&null==e.chunks[0].stop;)(t=e.chunks.shift()).from+=e.from,this.extend(t);e.toString()&&(e.stop=e.blockIndex,this.chunks.push(e))}}}appendTo(n){if(!(n instanceof l.MaskedPattern))return new a(this.toString()).appendTo(n);var r=new d;for(let t=0;t<this.chunks.length&&!r.skip;++t){var i=this.chunks[t],o=n._mapPosToBlock(n.value.length),s=i.stop;let e;null!=s&&(!o||o.index<=s)&&((i instanceof J||0<=n._stops.indexOf(s))&&(o=n._appendPlaceholder(s),r.aggregate(o)),e=i instanceof J&&n._blocks[s]),e?((o=e.appendTail(i)).skip=!1,r.aggregate(o),n._value+=o.inserted,(s=i.toString().slice(o.rawInserted.length))&&r.aggregate(n.append(s,{tail:!0}))):r.aggregate(n.append(i.toString(),{tail:!0}))}return r}get state(){return{chunks:this.chunks.map(e=>e.state),from:this.from,stop:this.stop,blockIndex:this.blockIndex}}set state(e){var t=e["chunks"],e=U(e,Q);Object.assign(this,e),this.chunks=t.map(e=>{var t=new("chunks"in e?J:a);return t.state=e,t})}unshift(t){if(this.chunks.length&&!(null!=t&&this.from>=t)){var n=null!=t?t-this.from:t;let e=0;for(;e<this.chunks.length;){const t=this.chunks[e],r=t.unshift(n);if(t.toString()){if(!r)break;++e}else this.chunks.splice(e,1);if(r)return r}}return""}shift(){if(this.chunks.length){let e=this.chunks.length-1;for(;0<=e;){var t=this.chunks[e],n=t.shift();if(t.toString()){if(!n)break;--e}else this.chunks.splice(e,1);if(n)return n}}return""}}class ee{constructor(e,t){this.masked=e,this._log=[];var{offset:e,index:t}=e._mapPosToBlock(t)||(t<0?{index:0,offset:0}:{index:this.masked._blocks.length,offset:0});this.offset=e,this.index=t,this.ok=!1}get block(){return this.masked._blocks[this.index]}get pos(){return this.masked._blockStartPos(this.index)+this.offset}get state(){return{index:this.index,offset:this.offset,ok:this.ok}}set state(e){Object.assign(this,e)}pushState(){this._log.push(this.state)}popState(){var e=this._log.pop();return this.state=e}bindBlock(){this.block||(this.index<0&&(this.index=0,this.offset=0),this.index>=this.masked._blocks.length&&(this.index=this.masked._blocks.length-1,this.offset=this.block.value.length))}_pushLeft(e){for(this.pushState(),this.bindBlock();0<=this.index;--this.index,this.offset=(null==(t=this.block)?void 0:t.value.length)||0){var t;if(e())return this.ok=!0}return this.ok=!1}_pushRight(e){for(this.pushState(),this.bindBlock();this.index<this.masked._blocks.length;++this.index,this.offset=0)if(e())return this.ok=!0;return this.ok=!1}pushLeftBeforeFilled(){return this._pushLeft(()=>{if(!this.block.isFixed&&this.block.value)return this.offset=this.block.nearestInputPos(this.offset,p),0!==this.offset||void 0})}pushLeftBeforeInput(){return this._pushLeft(()=>{if(!this.block.isFixed)return this.offset=this.block.nearestInputPos(this.offset,f),!0})}pushLeftBeforeRequired(){return this._pushLeft(()=>{if(!(this.block.isFixed||this.block.isOptional&&!this.block.value))return this.offset=this.block.nearestInputPos(this.offset,f),!0})}pushRightBeforeFilled(){return this._pushRight(()=>{if(!this.block.isFixed&&this.block.value)return this.offset=this.block.nearestInputPos(this.offset,g),this.offset!==this.block.value.length||void 0})}pushRightBeforeInput(){return this._pushRight(()=>{if(!this.block.isFixed)return this.offset=this.block.nearestInputPos(this.offset,h),!0})}pushRightBeforeRequired(){return this._pushRight(()=>{if(!(this.block.isFixed||this.block.isOptional&&!this.block.value))return this.offset=this.block.nearestInputPos(this.offset,h),!0})}}l.MaskedRegExp=class extends n{_update(t){t.mask&&(t.validate=e=>0<=e.search(t.mask)),super._update(t)}};const te=["_blocks"];class c extends n{constructor(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.definitions=Object.assign({},K,e.definitions),super(Object.assign({},c.DEFAULTS,e))}_update(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.definitions=Object.assign({},this.definitions,e.definitions),super._update(e),this._rebuildMask()}_rebuildMask(){const o=this.definitions;this._blocks=[],this._stops=[],this._maskedBlocks={};var s=this.mask;if(s&&o){let r=!1,i=!1;for(let n=0;n<s.length;++n){if(this.blocks){const o=s.slice(n),e=Object.keys(this.blocks).filter(e=>0===o.indexOf(e)),t=(e.sort((e,t)=>t.length-e.length),e[0]);if(t){const o=u(Object.assign({parent:this,lazy:this.lazy,eager:this.eager,placeholderChar:this.placeholderChar,displayChar:this.displayChar,overwrite:this.overwrite},this.blocks[t]));o&&(this._blocks.push(o),this._maskedBlocks[t]||(this._maskedBlocks[t]=[]),this._maskedBlocks[t].push(this._blocks.length-1)),n+=t.length-1;continue}}let e=s[n],t=e in o;if(e===c.STOP_CHAR)this._stops.push(this._blocks.length);else if("{"===e||"}"===e)r=!r;else if("["===e||"]"===e)i=!i;else{if(e===c.ESCAPE_CHAR){if(++n,!(e=s[n]))break;t=!1}var a=null==(a=o[e])||!a.mask||(null==(a=o[e])?void 0:a.mask.prototype)instanceof l.Masked?{mask:o[e]}:o[e],a=t?new q(Object.assign({parent:this,isOptional:i,lazy:this.lazy,eager:this.eager,placeholderChar:this.placeholderChar,displayChar:this.displayChar},a)):new Z({char:e,eager:this.eager,isUnmasking:r});this._blocks.push(a)}}}}get state(){return Object.assign({},super.state,{_blocks:this._blocks.map(e=>e.state)})}set state(e){const n=e["_blocks"],t=U(e,te);this._blocks.forEach((e,t)=>e.state=n[t]),super.state=t}reset(){super.reset(),this._blocks.forEach(e=>e.reset())}get isComplete(){return this._blocks.every(e=>e.isComplete)}get isFilled(){return this._blocks.every(e=>e.isFilled)}get isFixed(){return this._blocks.every(e=>e.isFixed)}get isOptional(){return this._blocks.every(e=>e.isOptional)}doCommit(){this._blocks.forEach(e=>e.doCommit()),super.doCommit()}get unmaskedValue(){return this._blocks.reduce((e,t)=>e+t.unmaskedValue,"")}set unmaskedValue(e){super.unmaskedValue=e}get value(){return this._blocks.reduce((e,t)=>e+t.value,"")}set value(e){super.value=e}get displayValue(){return this._blocks.reduce((e,t)=>e+t.displayValue,"")}appendTail(e){return super.appendTail(e).aggregate(this._appendPlaceholder())}_appendEager(){var e,t=new d;let n=null==(e=this._mapPosToBlock(this.value.length))?void 0:e.index;if(null!=n){this._blocks[n].isFilled&&++n;for(let e=n;e<this._blocks.length;++e){const n=this._blocks[e]._appendEager();if(!n.inserted)break;t.aggregate(n)}}return t}_appendCharRaw(t){var n,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};const i=this._mapPosToBlock(this.value.length),o=new d;if(i)for(let e=i.index;;++e){const i=this._blocks[e];if(!i)break;const s=i._appendChar(t,Object.assign({},r,{_beforeTailState:null==(n=r._beforeTailState)||null==(n=n._blocks)?void 0:n[e]})),d=s.skip;if(o.aggregate(s),d||s.rawInserted)break}return o}extractTail(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.value.length;const i=new J;return e!==t&&this._forEachBlocksInRange(e,t,(e,t,n,r)=>{e=e.extractTail(n,r);e.stop=this._findStopBefore(t),e.from=this._blockStartPos(t),e instanceof J&&(e.blockIndex=t),i.extend(e)}),i}extractInput(){let e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.value.length,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(e===t)return"";let o="";return this._forEachBlocksInRange(e,t,(e,t,n,r)=>{o+=e.extractInput(n,r,i)}),o}_findStopBefore(t){let n;for(let e=0;e<this._stops.length;++e){var r=this._stops[e];if(!(r<=t))break;n=r}return n}_appendPlaceholder(n){const r=new d;var e,t;return this.lazy&&null==n||(e=this._mapPosToBlock(this.value.length))&&(e=e.index,t=null!=n?n:this._blocks.length,this._blocks.slice(e,t).forEach(e=>{if(!e.lazy||null!=n){const n=null!=e._blocks?[e._blocks.length]:[],t=e._appendPlaceholder(...n);this._value+=t.inserted,r.aggregate(t)}})),r}_mapPosToBlock(t){let n="";for(let e=0;e<this._blocks.length;++e){var r=this._blocks[e],i=n.length;if(t<=(n+=r.value).length)return{index:e,offset:t-i}}}_blockStartPos(e){return this._blocks.slice(0,e).reduce((e,t)=>e+t.value.length,0)}_forEachBlocksInRange(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.value.length,n=2<arguments.length?arguments[2]:void 0,r=this._mapPosToBlock(t);if(r){const t=this._mapPosToBlock(e),i=t&&r.index===t.index,o=r.offset,s=t&&i?t.offset:this._blocks[r.index].value.length;if(n(this._blocks[r.index],r.index,o,s),t&&!i){for(let e=r.index+1;e<t.index;++e)n(this._blocks[e],e,0,this._blocks[e].value.length);n(this._blocks[t.index],t.index,0,t.offset)}}}remove(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.value.length;const i=super.remove(e,t);return this._forEachBlocksInRange(e,t,(e,t,n,r)=>{i.aggregate(e.remove(n,r))}),i}nearestInputPos(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:h;if(!this._blocks.length)return 0;var n=new ee(this,e);if(t===h)return n.pushRightBeforeInput()||(n.popState(),n.pushLeftBeforeInput())?n.pos:this.value.length;if(t!==f&&t!==p)return t===W||t===g?(n.pushRightBeforeInput(),n.pushRightBeforeRequired(),n.pushRightBeforeFilled()?n.pos:t===g?this.value.length:(n.popState(),n.ok||(n.popState(),n.ok)?n.pos:this.nearestInputPos(e,f))):e;if(t===f){if(n.pushRightBeforeFilled(),n.ok&&n.pos===e)return e;n.popState()}if(n.pushLeftBeforeInput(),n.pushLeftBeforeRequired(),n.pushLeftBeforeFilled(),t===f){if(n.pushRightBeforeInput(),n.pushRightBeforeRequired(),n.ok&&n.pos<=e)return n.pos;if(n.popState(),n.ok&&n.pos<=e)return n.pos;n.popState()}return n.ok||t!==p&&(n.popState(),n.ok||(n.popState(),n.ok))?n.pos:0}totalInputPositions(){let e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.value.length,i=0;return this._forEachBlocksInRange(e,t,(e,t,n,r)=>{i+=e.totalInputPositions(n,r)}),i}maskedBlock(e){return this.maskedBlocks(e)[0]}maskedBlocks(e){e=this._maskedBlocks[e];return e?e.map(e=>this._blocks[e]):[]}}c.DEFAULTS={lazy:!0,placeholderChar:"_"},c.STOP_CHAR="`",c.ESCAPE_CHAR="\\",c.InputDefinition=q,c.FixedDefinition=Z;class ne extends(l.MaskedPattern=c){get _matchFrom(){return this.maxLength-String(this.from).length}_update(e){e=Object.assign({to:this.to||0,from:this.from||0,maxLength:this.maxLength||0},e);let t=String(e.to).length;null!=e.maxLength&&(t=Math.max(t,e.maxLength)),e.maxLength=t;var n=String(e.from).padStart(t,"0"),r=String(e.to).padStart(t,"0");let i=0;for(;i<r.length&&r[i]===n[i];)++i;e.mask=r.slice(0,i).replace(/0/g,"\\0")+"0".repeat(t-i),super._update(e)}get isComplete(){return super.isComplete&&Boolean(this.value)}boundaries(e){let t="",n="";var[,e,r]=e.match(/^(\D*)(\d*)(\D*)/)||[];return r&&(t="0".repeat(e.length)+r,n="9".repeat(e.length)+r),t=t.padEnd(this.maxLength,"0"),n=n.padEnd(this.maxLength,"9"),[t,n]}doPrepare(e){var t,n,r,i,o,s,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return[e,t]=j(super.doPrepare(e.replace(/\D/g,""),a)),this.autofix&&e?(n=String(this.from).padStart(this.maxLength,"0"),r=String(this.to).padStart(this.maxLength,"0"),(i=this.value+e).length>this.maxLength?"":([o,s]=this.boundaries(i),Number(s)<this.from?n[i.length-1]:Number(o)>this.to?"pad"===this.autofix&&i.length<this.maxLength?["",t.aggregate(this.append(n[i.length-1]+e,a))]:r[i.length-1]:e)):e}doValidate(){var e,t=this.value;return-1===t.search(/[^0]/)&&t.length<=this._matchFrom||([t,e]=this.boundaries(t),this.from<=Number(e)&&Number(t)<=this.to&&super.doValidate(...arguments))}}l.MaskedRange=ne;class re extends c{constructor(e){super(Object.assign({},re.DEFAULTS,e))}_update(t){t.mask===Date&&delete t.mask,t.pattern&&(t.mask=t.pattern);var e=t.blocks;t.blocks=Object.assign({},re.GET_DEFAULT_BLOCKS()),t.min&&(t.blocks.Y.from=t.min.getFullYear()),t.max&&(t.blocks.Y.to=t.max.getFullYear()),t.min&&t.max&&t.blocks.Y.from===t.blocks.Y.to&&(t.blocks.m.from=t.min.getMonth()+1,t.blocks.m.to=t.max.getMonth()+1,t.blocks.m.from===t.blocks.m.to)&&(t.blocks.d.from=t.min.getDate(),t.blocks.d.to=t.max.getDate()),Object.assign(t.blocks,this.blocks,e),Object.keys(t.blocks).forEach(e=>{e=t.blocks[e];!("autofix"in e)&&"autofix"in t&&(e.autofix=t.autofix)}),super._update(t)}doValidate(){var e=this.date;return super.doValidate(...arguments)&&(!this.isComplete||this.isDateExist(this.value)&&null!=e&&(null==this.min||this.min<=e)&&(null==this.max||e<=this.max))}isDateExist(e){return 0<=this.format(this.parse(e,this),this).indexOf(e)}get date(){return this.typedValue}set date(e){this.typedValue=e}get typedValue(){return this.isComplete?super.typedValue:null}set typedValue(e){super.typedValue=e}maskEquals(e){return e===Date||super.maskEquals(e)}}re.DEFAULTS={pattern:"d{.}`m{.}`Y",format:e=>e?[String(e.getDate()).padStart(2,"0"),String(e.getMonth()+1).padStart(2,"0"),e.getFullYear()].join("."):"",parse:e=>{var[e,t,n]=e.split(".");return new Date(n,t-1,e)}},re.GET_DEFAULT_BLOCKS=()=>({d:{mask:ne,from:1,to:31,maxLength:2},m:{mask:ne,from:1,to:12,maxLength:2},Y:{mask:ne,from:1900,to:9999}}),l.MaskedDate=re;class ie{get selectionStart(){let e;try{e=this._unsafeSelectionStart}catch(e){}return null!=e?e:this.value.length}get selectionEnd(){let e;try{e=this._unsafeSelectionEnd}catch(e){}return null!=e?e:this.value.length}select(e,t){if(null!=e&&null!=t&&(e!==this.selectionStart||t!==this.selectionEnd))try{this._unsafeSelect(e,t)}catch(e){}}_unsafeSelect(e,t){}get isActive(){return!1}bindEvents(e){}unbindEvents(){}}class oe extends(l.MaskElement=ie){constructor(e){super(),this.input=e,this._handlers={}}get rootElement(){var e,t;return null!=(e=null==(e=(t=this.input).getRootNode)?void 0:e.call(t))?e:document}get isActive(){return this.input===this.rootElement.activeElement}get _unsafeSelectionStart(){return this.input.selectionStart}get _unsafeSelectionEnd(){return this.input.selectionEnd}_unsafeSelect(e,t){this.input.setSelectionRange(e,t)}get value(){return this.input.value}set value(e){this.input.value=e}bindEvents(t){Object.keys(t).forEach(e=>this._toggleEventHandler(oe.EVENTS_MAP[e],t[e]))}unbindEvents(){Object.keys(this._handlers).forEach(e=>this._toggleEventHandler(e))}_toggleEventHandler(e,t){this._handlers[e]&&(this.input.removeEventListener(e,this._handlers[e]),delete this._handlers[e]),t&&(this.input.addEventListener(e,t),this._handlers[e]=t)}}oe.EVENTS_MAP={selectionChange:"keydown",input:"input",drop:"drop",click:"click",focus:"focus",commit:"blur"};class se extends(l.HTMLMaskElement=oe){get _unsafeSelectionStart(){var e=this.rootElement,e=e.getSelection&&e.getSelection(),t=e&&e.anchorOffset,e=e&&e.focusOffset;return null==e||null==t||t<e?t:e}get _unsafeSelectionEnd(){var e=this.rootElement,e=e.getSelection&&e.getSelection(),t=e&&e.anchorOffset,e=e&&e.focusOffset;return null==e||null==t||e<t?t:e}_unsafeSelect(e,t){var n;this.rootElement.createRange&&((n=this.rootElement.createRange()).setStart(this.input.firstChild||this.input,e),n.setEnd(this.input.lastChild||this.input,t),t=(e=this.rootElement).getSelection&&e.getSelection())&&(t.removeAllRanges(),t.addRange(n))}get value(){return this.input.textContent}set value(e){this.input.textContent=e}}l.HTMLContenteditableMaskElement=se;const ae=["mask"];l.InputMask=class{constructor(e,t){this.el=e instanceof ie?e:new(e.isContentEditable&&"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName?se:oe)(e),this.masked=u(t),this._listeners={},this._value="",this._unmaskedValue="",this._saveSelection=this._saveSelection.bind(this),this._onInput=this._onInput.bind(this),this._onChange=this._onChange.bind(this),this._onDrop=this._onDrop.bind(this),this._onFocus=this._onFocus.bind(this),this._onClick=this._onClick.bind(this),this.alignCursor=this.alignCursor.bind(this),this.alignCursorFriendly=this.alignCursorFriendly.bind(this),this._bindEvents(),this.updateValue(),this._onChange()}get mask(){return this.masked.mask}maskEquals(e){var t;return null==e||(null==(t=this.masked)?void 0:t.maskEquals(e))}set mask(e){var t;this.maskEquals(e)||(e instanceof l.Masked||this.masked.constructor!==Y(e)?((t=u({mask:e})).unmaskedValue=this.masked.unmaskedValue,this.masked=t):this.masked.updateOptions({mask:e}))}get value(){return this._value}set value(e){this.value!==e&&(this.masked.value=e,this.updateControl(),this.alignCursor())}get unmaskedValue(){return this._unmaskedValue}set unmaskedValue(e){this.unmaskedValue!==e&&(this.masked.unmaskedValue=e,this.updateControl(),this.alignCursor())}get typedValue(){return this.masked.typedValue}set typedValue(e){this.masked.typedValueEquals(e)||(this.masked.typedValue=e,this.updateControl(),this.alignCursor())}get displayValue(){return this.masked.displayValue}_bindEvents(){this.el.bindEvents({selectionChange:this._saveSelection,input:this._onInput,drop:this._onDrop,click:this._onClick,focus:this._onFocus,commit:this._onChange})}_unbindEvents(){this.el&&this.el.unbindEvents()}_fireEvent(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=this._listeners[e];e&&e.forEach(e=>e(...n))}get selectionStart(){return this._cursorChanging?this._changingCursorPos:this.el.selectionStart}get cursorPos(){return this._cursorChanging?this._changingCursorPos:this.el.selectionEnd}set cursorPos(e){this.el&&this.el.isActive&&(this.el.select(e,e),this._saveSelection())}_saveSelection(){this.displayValue!==this.el.value&&console.warn("Element value was changed outside of mask. Syncronize mask using `mask.updateValue()` to work properly."),this._selection={start:this.selectionStart,end:this.cursorPos}}updateValue(){this.masked.value=this.el.value,this._value=this.masked.value}updateControl(){var e=this.masked.unmaskedValue,t=this.masked.value,n=this.displayValue,r=this.unmaskedValue!==e||this.value!==t;this._unmaskedValue=e,this._value=t,this.el.value!==n&&(this.el.value=n),r&&this._fireChangeEvents()}updateOptions(e){var t=e["mask"],e=U(e,ae),n=!this.maskEquals(t),r=!z(this.masked,e);n&&(this.mask=t),r&&this.masked.updateOptions(e),(n||r)&&this.updateControl()}updateCursor(e){null!=e&&(this.cursorPos=e,this._delayUpdateCursor(e))}_delayUpdateCursor(e){this._abortUpdateCursor(),this._changingCursorPos=e,this._cursorChanging=setTimeout(()=>{this.el&&(this.cursorPos=this._changingCursorPos,this._abortUpdateCursor())},10)}_fireChangeEvents(){this._fireEvent("accept",this._inputEvent),this.masked.isComplete&&this._fireEvent("complete",this._inputEvent)}_abortUpdateCursor(){this._cursorChanging&&(clearTimeout(this._cursorChanging),delete this._cursorChanging)}alignCursor(){this.cursorPos=this.masked.nearestInputPos(this.masked.nearestInputPos(this.cursorPos,f))}alignCursorFriendly(){this.selectionStart===this.cursorPos&&this.alignCursor()}on(e,t){return this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t),this}off(e,t){return this._listeners[e]&&(t?0<=(t=this._listeners[e].indexOf(t))&&this._listeners[e].splice(t,1):delete this._listeners[e]),this}_onInput(e){if(this._inputEvent=e,this._abortUpdateCursor(),!this._selection)return this.updateValue();var e=new G(this.el.value,this.cursorPos,this.displayValue,this._selection),t=this.masked.rawInputValue,n=this.masked.splice(e.startChangePos,e.removed.length,e.inserted,e.removeDirection,{input:!0,raw:!0}).offset,t=t===this.masked.rawInputValue?e.removeDirection:h;let r=this.masked.nearestInputPos(e.startChangePos+n,t);t!==h&&(r=this.masked.nearestInputPos(r,h)),this.updateControl(),this.updateCursor(r),delete this._inputEvent}_onChange(){this.displayValue!==this.el.value&&this.updateValue(),this.masked.doCommit(),this.updateControl(),this._saveSelection()}_onDrop(e){e.preventDefault(),e.stopPropagation()}_onFocus(e){this.alignCursorFriendly()}_onClick(e){this.alignCursorFriendly()}destroy(){this._unbindEvents(),this._listeners.length=0,delete this.el}},l.MaskedEnum=class extends c{_update(e){e.enum&&(e.mask="*".repeat(e.enum[0].length)),super._update(e)}doValidate(){return this.enum.some(e=>0<=e.indexOf(this.unmaskedValue))&&super.doValidate(...arguments)}};class i extends n{constructor(e){super(Object.assign({},i.DEFAULTS,e))}_update(e){super._update(e),this._updateRegExps()}_updateRegExps(){var e="^"+(this.allowNegative?"[+|\\-]?":""),t=(this.scale?"(".concat($(this.radix),"\\d{0,").concat(this.scale,"})?"):"")+"$";this._numberRegExp=new RegExp(e+"\\d*"+t),this._mapToRadixRegExp=new RegExp("[".concat(this.mapToRadix.map($).join(""),"]"),"g"),this._thousandsSeparatorRegExp=new RegExp($(this.thousandsSeparator),"g")}_removeThousandsSeparators(e){return e.replace(this._thousandsSeparatorRegExp,"")}_insertThousandsSeparators(e){e=e.split(this.radix);return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,this.thousandsSeparator),e.join(this.radix)}doPrepare(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},[t,n]=(e=this._removeThousandsSeparators(this.scale&&this.mapToRadix.length&&(t.input&&t.raw||!t.input&&!t.raw)?e.replace(this._mapToRadixRegExp,this.radix):e),j(super.doPrepare(e,t)));return e&&!t&&(n.skip=!0),[t,n]}_separatorsCount(t){let n=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=0;for(let e=0;e<t;++e)this._value.indexOf(this.thousandsSeparator,e)===e&&(++r,n)&&(t+=this.thousandsSeparator.length);return r}_separatorsCountFromSlice(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._value;return this._separatorsCount(this._removeThousandsSeparators(e).length,!0)}extractInput(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.value.length,n=2<arguments.length?arguments[2]:void 0;return[e,t]=this._adjustRangeWithSeparators(e,t),this._removeThousandsSeparators(super.extractInput(e,t,n))}_appendCharRaw(e){var t,n,r,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return this.thousandsSeparator?(t=(i.tail&&i._beforeTailState?i._beforeTailState:this)._value,t=this._separatorsCountFromSlice(t),this._value=this._removeThousandsSeparators(this.value),n=super._appendCharRaw(e,i),this._value=this._insertThousandsSeparators(this._value),r=(i.tail&&i._beforeTailState?i._beforeTailState:this)._value,r=this._separatorsCountFromSlice(r),n.tailShift+=(r-t)*this.thousandsSeparator.length,n.skip=!n.rawInserted&&e===this.thousandsSeparator,n):super._appendCharRaw(e,i)}_findSeparatorAround(e){if(this.thousandsSeparator){var t=e-this.thousandsSeparator.length+1,t=this.value.indexOf(this.thousandsSeparator,t);if(t<=e)return t}return-1}_adjustRangeWithSeparators(e,t){var n=this._findSeparatorAround(e),n=(0<=n&&(e=n),this._findSeparatorAround(t));return[e,t=0<=n?n+this.thousandsSeparator.length:t]}remove(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.value.length,e=([e,t]=this._adjustRangeWithSeparators(e,t),this.value.slice(0,e)),t=this.value.slice(t),n=this._separatorsCount(e.length),t=(this._value=this._insertThousandsSeparators(this._removeThousandsSeparators(e+t)),this._separatorsCountFromSlice(e));return new d({tailShift:(t-n)*this.thousandsSeparator.length})}nearestInputPos(e,t){if(this.thousandsSeparator)switch(t){case h:case f:case p:var n=this._findSeparatorAround(e-1);if(0<=n){var r=n+this.thousandsSeparator.length;if(e<r||this.value.length<=r||t===p)return n}break;case W:case g:{const t=this._findSeparatorAround(e);if(0<=t)return t+this.thousandsSeparator.length}}return e}doValidate(e){let t=Boolean(this._removeThousandsSeparators(this.value).match(this._numberRegExp));if(t){const e=this.number;t=t&&!isNaN(e)&&(null==this.min||0<=this.min||this.min<=this.number)&&(null==this.max||this.max<=0||this.number<=this.max)}return t&&super.doValidate(e)}doCommit(){if(this.value){var n=this.number;let e=n,t=(null!=this.min&&(e=Math.max(e,this.min)),(e=null!=this.max?Math.min(e,this.max):e)!==n&&(this.unmaskedValue=this.doFormat(e)),this.value);this.normalizeZeros&&(t=this._normalizeZeros(t)),this.padFractionalZeros&&0<this.scale&&(t=this._padFractionalZeros(t)),this._value=t}super.doCommit()}_normalizeZeros(e){var t=this._removeThousandsSeparators(e).split(this.radix);return t[0]=t[0].replace(/^(\D*)(0*)(\d*)/,(e,t,n,r)=>t+r),e.length&&!/\d$/.test(t[0])&&(t[0]=t[0]+"0"),1<t.length&&(t[1]=t[1].replace(/0*$/,""),t[1].length||(t.length=1)),this._insertThousandsSeparators(t.join(this.radix))}_padFractionalZeros(e){var t;return e&&((t=e.split(this.radix)).length<2&&t.push(""),t[1]=t[1].padEnd(this.scale,"0"),t.join(this.radix))}doSkipInvalid(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length?arguments[2]:void 0,r=0===this.scale&&e!==this.thousandsSeparator&&(e===this.radix||e===i.UNMASKED_RADIX||this.mapToRadix.includes(e));return super.doSkipInvalid(e,t,n)&&!r}get unmaskedValue(){return this._removeThousandsSeparators(this._normalizeZeros(this.value)).replace(this.radix,i.UNMASKED_RADIX)}set unmaskedValue(e){super.unmaskedValue=e}get typedValue(){return this.doParse(this.unmaskedValue)}set typedValue(e){this.rawInputValue=this.doFormat(e).replace(i.UNMASKED_RADIX,this.radix)}get number(){return this.typedValue}set number(e){this.typedValue=e}get allowNegative(){return this.signed||null!=this.min&&this.min<0||null!=this.max&&this.max<0}typedValueEquals(e){return(super.typedValueEquals(e)||i.EMPTY_VALUES.includes(e)&&i.EMPTY_VALUES.includes(this.typedValue))&&!(0===e&&""===this.value)}}i.UNMASKED_RADIX=".",i.DEFAULTS={radix:",",thousandsSeparator:"",mapToRadix:[i.UNMASKED_RADIX],scale:2,signed:!1,normalizeZeros:!0,padFractionalZeros:!1,parse:Number,format:e=>e.toLocaleString("en-US",{useGrouping:!1,maximumFractionDigits:20})},i.EMPTY_VALUES=[...n.EMPTY_VALUES,0],l.MaskedNumber=i,l.MaskedFunction=class extends n{_update(e){e.mask&&(e.validate=e.mask),super._update(e)}};const le=["compiledMasks","currentMaskRef","currentMask"],ue=["mask"];class ce extends n{constructor(e){super(Object.assign({},ce.DEFAULTS,e)),this.currentMask=null}_update(e){super._update(e),"mask"in e&&(this.compiledMasks=Array.isArray(e.mask)?e.mask.map(e=>u(e)):[])}_appendCharRaw(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=this._applyDispatch(e,t);return this.currentMask&&n.aggregate(this.currentMask._appendChar(e,this.currentMaskFlags(t))),n}_applyDispatch(){let e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";var r=t.tail&&null!=t._beforeTailState?t._beforeTailState._value:this.value,i=this.rawInputValue,o=t.tail&&null!=t._beforeTailState?t._beforeTailState._rawInputValue:i,i=i.slice(o.length),s=this.currentMask,a=new d,l=null==s?void 0:s.state;if(this.currentMask=this.doDispatch(e,Object.assign({},t),n),this.currentMask)if(this.currentMask!==s){if(this.currentMask.reset(),o){const e=this.currentMask.append(o,{raw:!0});a.tailShift=e.inserted.length-r.length}i&&(a.tailShift+=this.currentMask.append(i,{raw:!0,tail:!0}).tailShift)}else this.currentMask.state=l;return a}_appendPlaceholder(){var e=this._applyDispatch(...arguments);return this.currentMask&&e.aggregate(this.currentMask._appendPlaceholder()),e}_appendEager(){var e=this._applyDispatch(...arguments);return this.currentMask&&e.aggregate(this.currentMask._appendEager()),e}appendTail(e){var t=new d;return e&&t.aggregate(this._applyDispatch("",{},e)),t.aggregate(this.currentMask?this.currentMask.appendTail(e):super.appendTail(e))}currentMaskFlags(e){var t;return Object.assign({},e,{_beforeTailState:(null==(t=e._beforeTailState)?void 0:t.currentMaskRef)===this.currentMask&&(null==(t=e._beforeTailState)?void 0:t.currentMask)||e._beforeTailState})}doDispatch(e){return this.dispatch(e,this,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},2<arguments.length&&void 0!==arguments[2]?arguments[2]:"")}doValidate(e){return super.doValidate(e)&&(!this.currentMask||this.currentMask.doValidate(this.currentMaskFlags(e)))}doPrepare(e){let t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},[n,r]=j(super.doPrepare(e,t));return this.currentMask&&([n,e]=j(super.doPrepare(n,this.currentMaskFlags(t))),r=r.aggregate(e)),[n,r]}reset(){var e;null!=(e=this.currentMask)&&e.reset(),this.compiledMasks.forEach(e=>e.reset())}get value(){return this.currentMask?this.currentMask.value:""}set value(e){super.value=e}get unmaskedValue(){return this.currentMask?this.currentMask.unmaskedValue:""}set unmaskedValue(e){super.unmaskedValue=e}get typedValue(){return this.currentMask?this.currentMask.typedValue:""}set typedValue(e){let t=String(e);this.currentMask&&(this.currentMask.typedValue=e,t=this.currentMask.unmaskedValue),this.unmaskedValue=t}get displayValue(){return this.currentMask?this.currentMask.displayValue:""}get isComplete(){var e;return Boolean(null==(e=this.currentMask)?void 0:e.isComplete)}get isFilled(){var e;return Boolean(null==(e=this.currentMask)?void 0:e.isFilled)}remove(){var e=new d;return this.currentMask&&e.aggregate(this.currentMask.remove(...arguments)).aggregate(this._applyDispatch()),e}get state(){var e;return Object.assign({},super.state,{_rawInputValue:this.rawInputValue,compiledMasks:this.compiledMasks.map(e=>e.state),currentMaskRef:this.currentMask,currentMask:null==(e=this.currentMask)?void 0:e.state})}set state(e){const{compiledMasks:n,currentMaskRef:t,currentMask:r}=e,i=U(e,le);this.compiledMasks.forEach((e,t)=>e.state=n[t]),null!=t&&(this.currentMask=t,this.currentMask.state=r),super.state=i}extractInput(){return this.currentMask?this.currentMask.extractInput(...arguments):""}extractTail(){return this.currentMask?this.currentMask.extractTail(...arguments):super.extractTail(...arguments)}doCommit(){this.currentMask&&this.currentMask.doCommit(),super.doCommit()}nearestInputPos(){return this.currentMask?this.currentMask.nearestInputPos(...arguments):super.nearestInputPos(...arguments)}get overwrite(){return this.currentMask?this.currentMask.overwrite:super.overwrite}set overwrite(e){console.warn('"overwrite" option is not available in dynamic mask, use this option in siblings')}get eager(){return this.currentMask?this.currentMask.eager:super.eager}set eager(e){console.warn('"eager" option is not available in dynamic mask, use this option in siblings')}get skipInvalid(){return this.currentMask?this.currentMask.skipInvalid:super.skipInvalid}set skipInvalid(e){!this.isInitialized&&e===n.DEFAULTS.skipInvalid||console.warn('"skipInvalid" option is not available in dynamic mask, use this option in siblings')}maskEquals(r){return Array.isArray(r)&&this.compiledMasks.every((e,t)=>{var n;if(r[t])return n=(t=r[t])["mask"],z(e,U(t,ue))&&e.maskEquals(n)})}typedValueEquals(e){var t;return Boolean(null==(t=this.currentMask)?void 0:t.typedValueEquals(e))}}ce.DEFAULTS={dispatch:(i,o,s,a)=>{if(o.compiledMasks.length){const l=o.rawInputValue,e=o.compiledMasks.map((e,t)=>{var n=o.currentMask===e,r=n?e.value.length:e.nearestInputPos(e.value.length,p);return e.rawInputValue!==l?(e.reset(),e.append(l,{raw:!0})):n||e.remove(r),e.append(i,o.currentMaskFlags(s)),e.appendTail(a),{index:t,weight:e.rawInputValue.length,totalInputPositions:e.totalInputPositions(0,Math.max(r,e.nearestInputPos(e.value.length,p)))}});return e.sort((e,t)=>t.weight-e.weight||t.totalInputPositions-e.totalInputPositions),o.compiledMasks[e[0].index]}}},l.MaskedDynamic=ce;const de={MASKED:"value",UNMASKED:"unmaskedValue",TYPED:"typedValue"};function he(e){let n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:de.MASKED,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:de.MASKED;const i=u(e);return t=>i.runIsolated(e=>(e[n]=t,e[r]))}l.PIPE_TYPE=de,l.createPipe=he,l.pipe=function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return he(...n)(e)};try{globalThis.IMask=l}catch(P){}[].slice.call(document.querySelectorAll("[data-mask]")).map(function(e){return new l(e,{mask:e.dataset.mask,lazy:"true"===e.dataset["mask-visible"]})});var _="top",N="bottom",x="right",O="left",fe="auto",pe=[_,N,x,O],ge="start",me="end",ye="clippingParents",ve="viewport",be="popper",Ee="reference",Ce=pe.reduce(function(e,t){return e.concat([t+"-"+ge,t+"-"+me])},[]),we=[].concat(pe,[fe]).reduce(function(e,t){return e.concat([t,t+"-"+ge,t+"-"+me])},[]),e="beforeRead",Se="afterRead",Te="beforeMain",Re="afterMain",Ae="beforeWrite",_e="afterWrite",Ne=[e,"read",Se,Te,"main",Re,Ae,"write",_e];function m(e){return e?(e.nodeName||"").toLowerCase():null}function b(e){var t;return null==e?window:"[object Window]"!==e.toString()?(t=e.ownerDocument)&&t.defaultView||window:e}function xe(e){return e instanceof b(e).Element||e instanceof Element}function y(e){return e instanceof b(e).HTMLElement||e instanceof HTMLElement}function Oe(e){return"undefined"!=typeof ShadowRoot&&(e instanceof b(e).ShadowRoot||e instanceof ShadowRoot)}var Ie={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var i=e.state;Object.keys(i.elements).forEach(function(e){var t=i.styles[e]||{},n=i.attributes[e]||{},r=i.elements[e];y(r)&&m(r)&&(Object.assign(r.style,t),Object.keys(n).forEach(function(e){var t=n[e];!1===t?r.removeAttribute(e):r.setAttribute(e,!0===t?"":t)}))})},effect:function(e){var r=e.state,i={popper:{position:r.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(r.elements.popper.style,i.popper),r.styles=i,r.elements.arrow&&Object.assign(r.elements.arrow.style,i.arrow),function(){Object.keys(r.elements).forEach(function(e){var t=r.elements[e],n=r.attributes[e]||{},e=Object.keys((r.styles.hasOwnProperty(e)?r.styles:i)[e]).reduce(function(e,t){return e[t]="",e},{});y(t)&&m(t)&&(Object.assign(t.style,e),Object.keys(n).forEach(function(e){t.removeAttribute(e)}))})}},requires:["computeStyles"]};function I(e){return e.split("-")[0]}var Me=Math.max,ke=Math.min,De=Math.round;function Le(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Pe(){return!/^((?!chrome|android).)*safari/i.test(Le())}function Fe(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=e.getBoundingClientRect(),i=1,o=1,t=(t&&y(e)&&(i=0<e.offsetWidth&&De(r.width)/e.offsetWidth||1,o=0<e.offsetHeight&&De(r.height)/e.offsetHeight||1),(xe(e)?b(e):window).visualViewport),e=!Pe()&&n,n=(r.left+(e&&t?t.offsetLeft:0))/i,e=(r.top+(e&&t?t.offsetTop:0))/o,t=r.width/i,i=r.height/o;return{width:t,height:i,top:e,right:n+t,bottom:e+i,left:n,x:n,y:e}}function Be(e){var t=Fe(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function He(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&Oe(n)){var r=t;do{if(r&&e.isSameNode(r))return!0}while(r=r.parentNode||r.host)}return!1}function E(e){return b(e).getComputedStyle(e)}function C(e){return((xe(e)?e.ownerDocument:e.document)||window.document).documentElement}function Ue(e){return"html"===m(e)?e:e.assignedSlot||e.parentNode||(Oe(e)?e.host:null)||C(e)}function Ve(e){return y(e)&&"fixed"!==E(e).position?e.offsetParent:null}function We(e){for(var t,n=b(e),r=Ve(e);r&&(t=r,0<=["table","td","th"].indexOf(m(t)))&&"static"===E(r).position;)r=Ve(r);return(!r||"html"!==m(r)&&("body"!==m(r)||"static"!==E(r).position))&&(r||function(e){var t=/firefox/i.test(Le());if(!/Trident/i.test(Le())||!y(e)||"fixed"!==E(e).position){var n=Ue(e);for(Oe(n)&&(n=n.host);y(n)&&["html","body"].indexOf(m(n))<0;){var r=E(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}}return null}(e))||n}function $e(e){return 0<=["top","bottom"].indexOf(e)?"x":"y"}function je(e,t,n){return Me(e,ke(t,n))}function ze(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function Ge(n,e){return e.reduce(function(e,t){return e[t]=n,e},{})}var Ye={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n,r,i,o=e.state,s=e.name,e=e.options,a=o.elements.arrow,l=o.modifiersData.popperOffsets,u=I(o.placement),c=$e(u),u=0<=[O,x].indexOf(u)?"height":"width";a&&l&&(e=ze("number"!=typeof(e="function"==typeof(e=e.padding)?e(Object.assign({},o.rects,{placement:o.placement})):e)?e:Ge(e,pe)),t=Be(a),i="y"===c?_:O,r="y"===c?N:x,n=o.rects.reference[u]+o.rects.reference[c]-l[c]-o.rects.popper[u],l=l[c]-o.rects.reference[c],a=(a=We(a))?"y"===c?a.clientHeight||0:a.clientWidth||0:0,i=e[i],e=a-t[u]-e[r],i=je(i,r=a/2-t[u]/2+(n/2-l/2),e),o.modifiersData[s]=((a={})[c]=i,a.centerOffset=i-r,a))},effect:function(e){var t=e.state,e=e.options.element,e=void 0===e?"[data-popper-arrow]":e;null!=e&&("string"!=typeof e||(e=t.elements.popper.querySelector(e)))&&He(t.elements.popper,e)&&(t.elements.arrow=e)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Xe(e){return e.split("-")[1]}var Ke={top:"auto",right:"auto",bottom:"auto",left:"auto"};function qe(e){var t=e.popper,n=e.popperRect,r=e.placement,i=e.variation,o=e.offsets,s=e.position,a=e.gpuAcceleration,l=e.adaptive,u=e.roundOffsets,e=e.isFixed,c=o.x,c=void 0===c?0:c,d=o.y,d=void 0===d?0:d,h="function"==typeof u?u({x:c,y:d}):{x:c,y:d},c=h.x,d=h.y,h=o.hasOwnProperty("x"),o=o.hasOwnProperty("y"),f=O,p=_,g=window;l&&(y="clientHeight",m="clientWidth",(v=We(t))===b(t)&&"static"!==E(v=C(t)).position&&"absolute"===s&&(y="scrollHeight",m="scrollWidth"),r!==_&&(r!==O&&r!==x||i!==me)||(p=N,d=(d-((e&&v===g&&g.visualViewport?g.visualViewport.height:v[y])-n.height))*(a?1:-1)),r!==O&&(r!==_&&r!==N||i!==me)||(f=x,c=(c-((e&&v===g&&g.visualViewport?g.visualViewport.width:v[m])-n.width))*(a?1:-1)));var m,y=Object.assign({position:s},l&&Ke),v=!0===u?(r={x:c,y:d},i=b(t),e=r.y,i=i.devicePixelRatio||1,{x:De(r.x*i)/i||0,y:De(e*i)/i||0}):{x:c,y:d};return c=v.x,d=v.y,a?Object.assign({},y,((m={})[p]=o?"0":"",m[f]=h?"0":"",m.transform=(g.devicePixelRatio||1)<=1?"translate("+c+"px, "+d+"px)":"translate3d("+c+"px, "+d+"px, 0)",m)):Object.assign({},y,((n={})[p]=o?d+"px":"",n[f]=h?c+"px":"",n.transform="",n))}var Ze={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,e=e.options,n=e.gpuAcceleration,n=void 0===n||n,r=e.adaptive,r=void 0===r||r,e=e.roundOffsets,e=void 0===e||e,n={placement:I(t.placement),variation:Xe(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:n,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,qe(Object.assign({},n,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:r,roundOffsets:e})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,qe(Object.assign({},n,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:e})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},Qe={passive:!0},Je={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,e=e.options,r=e.scroll,i=void 0===r||r,r=e.resize,o=void 0===r||r,s=b(t.elements.popper),a=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&a.forEach(function(e){e.addEventListener("scroll",n.update,Qe)}),o&&s.addEventListener("resize",n.update,Qe),function(){i&&a.forEach(function(e){e.removeEventListener("scroll",n.update,Qe)}),o&&s.removeEventListener("resize",n.update,Qe)}},data:{}},et={left:"right",right:"left",bottom:"top",top:"bottom"};function tt(e){return e.replace(/left|right|bottom|top/g,function(e){return et[e]})}var nt={start:"end",end:"start"};function rt(e){return e.replace(/start|end/g,function(e){return nt[e]})}function it(e){e=b(e);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function ot(e){return Fe(C(e)).left+it(e).scrollLeft}function st(e){var e=E(e),t=e.overflow,n=e.overflowX,e=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+e+n)}function at(e,t){void 0===t&&(t=[]);var n=function e(t){return 0<=["html","body","#document"].indexOf(m(t))?t.ownerDocument.body:y(t)&&st(t)?t:e(Ue(t))}(e),e=n===(null==(e=e.ownerDocument)?void 0:e.body),r=b(n),r=e?[r].concat(r.visualViewport||[],st(n)?n:[]):n,n=t.concat(r);return e?n:n.concat(at(Ue(r)))}function lt(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function ut(e,t,n){return t===ve?lt((i=n,s=b(r=e),a=C(r),s=s.visualViewport,l=a.clientWidth,a=a.clientHeight,c=u=0,s&&(l=s.width,a=s.height,(o=Pe())||!o&&"fixed"===i)&&(u=s.offsetLeft,c=s.offsetTop),{width:l,height:a,x:u+ot(r),y:c})):xe(t)?((i=Fe(o=t,!1,"fixed"===n)).top=i.top+o.clientTop,i.left=i.left+o.clientLeft,i.bottom=i.top+o.clientHeight,i.right=i.left+o.clientWidth,i.width=o.clientWidth,i.height=o.clientHeight,i.x=i.left,i.y=i.top,i):lt((s=C(e),l=C(s),a=it(s),u=null==(u=s.ownerDocument)?void 0:u.body,r=Me(l.scrollWidth,l.clientWidth,u?u.scrollWidth:0,u?u.clientWidth:0),c=Me(l.scrollHeight,l.clientHeight,u?u.scrollHeight:0,u?u.clientHeight:0),s=-a.scrollLeft+ot(s),a=-a.scrollTop,"rtl"===E(u||l).direction&&(s+=Me(l.clientWidth,u?u.clientWidth:0)-r),{width:r,height:c,x:s,y:a}));var r,i,o,s,a,l,u,c}function ct(e){var t,n=e.reference,r=e.element,e=e.placement,i=e?I(e):null,e=e?Xe(e):null,o=n.x+n.width/2-r.width/2,s=n.y+n.height/2-r.height/2;switch(i){case _:t={x:o,y:n.y-r.height};break;case N:t={x:o,y:n.y+n.height};break;case x:t={x:n.x+n.width,y:s};break;case O:t={x:n.x-r.width,y:s};break;default:t={x:n.x,y:n.y}}var a=i?$e(i):null;if(null!=a){var l="y"===a?"height":"width";switch(e){case ge:t[a]=t[a]-(n[l]/2-r[l]/2);break;case me:t[a]=t[a]+(n[l]/2-r[l]/2)}}return t}function dt(e,t){var n,r,i,o,s,a,t=t=void 0===t?{}:t,l=t.placement,l=void 0===l?e.placement:l,u=t.strategy,u=void 0===u?e.strategy:u,c=t.boundary,c=void 0===c?ye:c,d=t.rootBoundary,d=void 0===d?ve:d,h=t.elementContext,h=void 0===h?be:h,f=t.altBoundary,f=void 0!==f&&f,t=t.padding,t=void 0===t?0:t,t=ze("number"!=typeof t?t:Ge(t,pe)),p=e.rects.popper,f=e.elements[f?h===be?Ee:be:h],u=(n=xe(f)?f:f.contextElement||C(e.elements.popper),f=d,r=u,o="clippingParents"===(d=c)?(s=at(Ue(o=n)),xe(i=0<=["absolute","fixed"].indexOf(E(o).position)&&y(o)?We(o):o)?s.filter(function(e){return xe(e)&&He(e,i)&&"body"!==m(e)}):[]):[].concat(d),s=[].concat(o,[f]),d=s[0],(f=s.reduce(function(e,t){t=ut(n,t,r);return e.top=Me(t.top,e.top),e.right=ke(t.right,e.right),e.bottom=ke(t.bottom,e.bottom),e.left=Me(t.left,e.left),e},ut(n,d,r))).width=f.right-f.left,f.height=f.bottom-f.top,f.x=f.left,f.y=f.top,f),c=Fe(e.elements.reference),d=ct({reference:c,element:p,strategy:"absolute",placement:l}),f=lt(Object.assign({},p,d)),p=h===be?f:c,g={top:u.top-p.top+t.top,bottom:p.bottom-u.bottom+t.bottom,left:u.left-p.left+t.left,right:p.right-u.right+t.right},d=e.modifiersData.offset;return h===be&&d&&(a=d[l],Object.keys(g).forEach(function(e){var t=0<=[x,N].indexOf(e)?1:-1,n=0<=[_,N].indexOf(e)?"y":"x";g[e]+=a[n]*t})),g}var ht={name:"flip",enabled:!0,phase:"main",fn:function(e){var d=e.state,t=e.options,e=e.name;if(!d.modifiersData[e]._skip){for(var n=t.mainAxis,r=void 0===n||n,n=t.altAxis,i=void 0===n||n,n=t.fallbackPlacements,h=t.padding,f=t.boundary,p=t.rootBoundary,o=t.altBoundary,s=t.flipVariations,g=void 0===s||s,m=t.allowedAutoPlacements,s=d.options.placement,t=I(s),n=n||(t!==s&&g?I(n=s)===fe?[]:(t=tt(n),[rt(n),t,rt(t)]):[tt(s)]),a=[s].concat(n).reduce(function(e,t){return e.concat(I(t)===fe?(n=d,r=(e=e=void 0===(e={placement:t,boundary:f,rootBoundary:p,padding:h,flipVariations:g,allowedAutoPlacements:m})?{}:e).placement,i=e.boundary,o=e.rootBoundary,s=e.padding,a=e.flipVariations,l=void 0===(e=e.allowedAutoPlacements)?we:e,u=Xe(r),e=u?a?Ce:Ce.filter(function(e){return Xe(e)===u}):pe,c=(r=0===(r=e.filter(function(e){return 0<=l.indexOf(e)})).length?e:r).reduce(function(e,t){return e[t]=dt(n,{placement:t,boundary:i,rootBoundary:o,padding:s})[I(t)],e},{}),Object.keys(c).sort(function(e,t){return c[e]-c[t]})):t);var n,r,i,o,s,a,l,u,c},[]),l=d.rects.reference,u=d.rects.popper,c=new Map,y=!0,v=a[0],b=0;b<a.length;b++){var E=a[b],C=I(E),w=Xe(E)===ge,S=0<=[_,N].indexOf(C),T=S?"width":"height",R=dt(d,{placement:E,boundary:f,rootBoundary:p,altBoundary:o,padding:h}),S=S?w?x:O:w?N:_,w=(l[T]>u[T]&&(S=tt(S)),tt(S)),T=[];if(r&&T.push(R[C]<=0),i&&T.push(R[S]<=0,R[w]<=0),T.every(function(e){return e})){v=E,y=!1;break}c.set(E,T)}if(y)for(var A=g?3:1;0<A&&"break"!==function(t){var e=a.find(function(e){e=c.get(e);if(e)return e.slice(0,t).every(function(e){return e})});if(e)return v=e,"break"}(A);A--);d.placement!==v&&(d.modifiersData[e]._skip=!0,d.placement=v,d.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function ft(e,t,n){return{top:e.top-t.height-(n=void 0===n?{x:0,y:0}:n).y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function pt(t){return[_,x,N,O].some(function(e){return 0<=t[e]})}var gt={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,e=e.name,n=t.rects.reference,r=t.rects.popper,i=t.modifiersData.preventOverflow,o=dt(t,{elementContext:"reference"}),s=dt(t,{altBoundary:!0}),o=ft(o,n),n=ft(s,r,i),s=pt(o),r=pt(n);t.modifiersData[e]={referenceClippingOffsets:o,popperEscapeOffsets:n,isReferenceHidden:s,hasPopperEscaped:r},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":s,"data-popper-escaped":r})}},mt={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var s=e.state,t=e.options,e=e.name,t=t.offset,a=void 0===t?[0,0]:t,t=we.reduce(function(e,t){return e[t]=(t=t,n=s.rects,r=a,i=I(t),o=0<=[O,_].indexOf(i)?-1:1,n="function"==typeof r?r(Object.assign({},n,{placement:t})):r,t=n[0]||0,r=(n[1]||0)*o,0<=[O,x].indexOf(i)?{x:r,y:t}:{x:t,y:r}),e;var n,r,i,o},{}),n=t[s.placement],r=n.x,n=n.y;null!=s.modifiersData.popperOffsets&&(s.modifiersData.popperOffsets.x+=r,s.modifiersData.popperOffsets.y+=n),s.modifiersData[e]=t}},yt={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,e=e.name;t.modifiersData[e]=ct({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},vt={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t,n,r,i,o,s,a,l,u,c=e.state,d=e.options,e=e.name,h=d.mainAxis,h=void 0===h||h,f=d.altAxis,f=void 0!==f&&f,p=d.boundary,g=d.rootBoundary,m=d.altBoundary,y=d.padding,v=d.tether,v=void 0===v||v,d=d.tetherOffset,d=void 0===d?0:d,p=dt(c,{boundary:p,rootBoundary:g,padding:y,altBoundary:m}),g=I(c.placement),y=Xe(c.placement),m=!y,b=$e(g),E="x"===b?"y":"x",C=c.modifiersData.popperOffsets,w=c.rects.reference,S=c.rects.popper,d="function"==typeof d?d(Object.assign({},c.rects,{placement:c.placement})):d,d="number"==typeof d?{mainAxis:d,altAxis:d}:Object.assign({mainAxis:0,altAxis:0},d),T=c.modifiersData.offset?c.modifiersData.offset[c.placement]:null,R={x:0,y:0};C&&(h&&(h="y"===b?"height":"width",s=(a=C[b])+p[n="y"===b?_:O],l=a-p[u="y"===b?N:x],t=v?-S[h]/2:0,i=(y===ge?w:S)[h],y=y===ge?-S[h]:-w[h],o=c.elements.arrow,o=v&&o?Be(o):{width:0,height:0},n=(r=c.modifiersData["arrow#persistent"]?c.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0})[n],r=r[u],u=je(0,w[h],o[h]),o=m?w[h]/2-t-u-n-d.mainAxis:i-u-n-d.mainAxis,i=m?-w[h]/2+t+u+r+d.mainAxis:y+u+r+d.mainAxis,m=(n=c.elements.arrow&&We(c.elements.arrow))?"y"===b?n.clientTop||0:n.clientLeft||0:0,y=a+i-(t=null!=(h=null==T?void 0:T[b])?h:0),u=je(v?ke(s,a+o-t-m):s,a,v?Me(l,y):l),C[b]=u,R[b]=u-a),f&&(r="y"==E?"height":"width",i=(n=C[E])+p["x"===b?_:O],h=n-p["x"===b?N:x],o=-1!==[_,O].indexOf(g),m=null!=(t=null==T?void 0:T[E])?t:0,s=o?i:n-w[r]-S[r]-m+d.altAxis,y=o?n+w[r]+S[r]-m-d.altAxis:h,a=v&&o?(u=je(s,n,l=y),l<u?l:u):je(v?s:i,n,v?y:h),C[E]=a,R[E]=a-n),c.modifiersData[e]=R)},requiresIfExists:["offset"]};function bt(e){var n=new Map,r=new Set,i=[];return e.forEach(function(e){n.set(e.name,e)}),e.forEach(function(e){r.has(e.name)||function t(e){r.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach(function(e){r.has(e)||(e=n.get(e))&&t(e)}),i.push(e)}(e)}),i}var Et={placement:"bottom",modifiers:[],strategy:"absolute"};function Ct(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(e){return!(e&&"function"==typeof e.getBoundingClientRect)})}function wt(e){var e=e=void 0===e?{}:e,t=e.defaultModifiers,l=void 0===t?[]:t,t=e.defaultOptions,u=void 0===t?Et:t;return function(r,i,t){void 0===t&&(t=u);var n,o,f={placement:"bottom",orderedModifiers:[],options:Object.assign({},Et,u),modifiersData:{},elements:{reference:r,popper:i},attributes:{},styles:{}},s=[],p=!1,g={state:f,setOptions:function(e){e="function"==typeof e?e(f.options):e;a(),f.options=Object.assign({},u,f.options,e),f.scrollParents={reference:xe(r)?at(r):r.contextElement?at(r.contextElement):[],popper:at(i)};e=[].concat(l,f.options.modifiers),t=e.reduce(function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e},{}),n=bt(Object.keys(t).map(function(e){return t[e]}));var t,n,e=Ne.reduce(function(e,t){return e.concat(n.filter(function(e){return e.phase===t}))},[]);return f.orderedModifiers=e.filter(function(e){return e.enabled}),f.orderedModifiers.forEach(function(e){var t=e.name,n=e.options,e=e.effect;"function"==typeof e&&(e=e({state:f,name:t,instance:g,options:void 0===n?{}:n}),s.push(e||function(){}))}),g.update()},forceUpdate:function(){if(!p){var e=f.elements,t=e.reference,e=e.popper;if(Ct(t,e)){f.rects={reference:(t=t,s=We(e),void 0===(a="fixed"===f.options.strategy)&&(a=!1),l=y(s),u=y(s)&&(d=(u=s).getBoundingClientRect(),c=De(d.width)/u.offsetWidth||1,d=De(d.height)/u.offsetHeight||1,1!==c||1!==d),c=C(s),d=Fe(t,u,a),t={scrollLeft:0,scrollTop:0},h={x:0,y:0},!l&&a||("body"===m(s)&&!st(c)||(t=(l=s)!==b(l)&&y(l)?{scrollLeft:l.scrollLeft,scrollTop:l.scrollTop}:it(l)),y(s)?((h=Fe(s,!0)).x+=s.clientLeft,h.y+=s.clientTop):c&&(h.x=ot(c))),{x:d.left+t.scrollLeft-h.x,y:d.top+t.scrollTop-h.y,width:d.width,height:d.height}),popper:Be(e)},f.reset=!1,f.placement=f.options.placement,f.orderedModifiers.forEach(function(e){return f.modifiersData[e.name]=Object.assign({},e.data)});for(var n,r,i,o=0;o<f.orderedModifiers.length;o++)!0!==f.reset?(n=(i=f.orderedModifiers[o]).fn,r=i.options,i=i.name,"function"==typeof n&&(f=n({state:f,options:void 0===r?{}:r,name:i,instance:g})||f)):(f.reset=!1,o=-1)}}var s,a,l,u,c,d,h},update:(n=function(){return new Promise(function(e){g.forceUpdate(),e(f)})},function(){return o=o||new Promise(function(e){Promise.resolve().then(function(){o=void 0,e(n())})})}),destroy:function(){a(),p=!0}};return Ct(r,i)&&g.setOptions(t).then(function(e){!p&&t.onFirstUpdate&&t.onFirstUpdate(e)}),g;function a(){s.forEach(function(e){return e()}),s=[]}}}var St=wt(),Tt=wt({defaultModifiers:[Je,yt,Ze,Ie]}),Rt=wt({defaultModifiers:[Je,yt,Ze,Ie,mt,ht,vt,Ye,gt]}),At=Object.freeze({__proto__:null,popperGenerator:wt,detectOverflow:dt,createPopperBase:St,createPopper:Rt,createPopperLite:Tt,top:_,bottom:N,right:x,left:O,auto:fe,basePlacements:pe,start:ge,end:me,clippingParents:ye,viewport:ve,popper:be,reference:Ee,variationPlacements:Ce,placements:we,beforeRead:e,read:"read",afterRead:Se,beforeMain:Te,main:"main",afterMain:Re,beforeWrite:Ae,write:"write",afterWrite:_e,modifierPhases:Ne,applyStyles:Ie,arrow:Ye,computeStyles:Ze,eventListeners:Je,flip:ht,hide:gt,offset:mt,popperOffsets:yt,preventOverflow:vt});const r=new Map,_t={set(e,t,n){r.has(e)||r.set(e,new Map);e=r.get(e);e.has(t)||0===e.size?e.set(t,n):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(e.keys())[0]}.`)},get:(e,t)=>r.has(e)&&r.get(e).get(t)||null,remove(e,t){var n;r.has(e)&&((n=r.get(e)).delete(t),0===n.size)&&r.delete(e)}},Nt="transitionend",xt=e=>e=e&&window.CSS&&window.CSS.escape?e.replace(/#([^\s"#']+)/g,(e,t)=>"#"+CSS.escape(t)):e,Ot=e=>{e.dispatchEvent(new Event(Nt))},s=e=>!(!e||"object"!=typeof e)&&void 0!==(e=void 0!==e.jquery?e[0]:e).nodeType,o=e=>s(e)?e.jquery?e[0]:e:"string"==typeof e&&0<e.length?document.querySelector(xt(e)):null,It=e=>{if(!s(e)||0===e.getClientRects().length)return!1;const t="visible"===getComputedStyle(e).getPropertyValue("visibility"),n=e.closest("details:not([open])");if(n&&n!==e){const t=e.closest("summary");if(t&&t.parentNode!==n)return!1;if(null===t)return!1}return t},v=e=>!e||e.nodeType!==Node.ELEMENT_NODE||!!e.classList.contains("disabled")||(void 0!==e.disabled?e.disabled:e.hasAttribute("disabled")&&"false"!==e.getAttribute("disabled")),Mt=e=>{var t;return document.documentElement.attachShadow?"function"==typeof e.getRootNode?(t=e.getRootNode())instanceof ShadowRoot?t:null:e instanceof ShadowRoot?e:e.parentNode?Mt(e.parentNode):null:null},kt=()=>{},Dt=e=>{e.offsetHeight},Lt=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Pt=[],w=()=>"rtl"===document.documentElement.dir,t=r=>{var e=()=>{const e=Lt();if(e){const t=r.NAME,n=e.fn[t];e.fn[t]=r.jQueryInterface,e.fn[t].Constructor=r,e.fn[t].noConflict=()=>(e.fn[t]=n,r.jQueryInterface)}};"loading"===document.readyState?(Pt.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Pt)e()}),Pt.push(e)):e()},S=(e,t=[],n=e)=>"function"==typeof e?e(...t):n,Ft=(n,i,e=!0)=>{if(e){e=(()=>{if(!i)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(i);var n=Number.parseFloat(e),r=Number.parseFloat(t);return n||r?(e=e.split(",")[0],t=t.split(",")[0],1e3*(Number.parseFloat(e)+Number.parseFloat(t))):0})()+5;let t=!1;const r=({target:e})=>{e===i&&(t=!0,i.removeEventListener(Nt,r),S(n))};i.addEventListener(Nt,r),setTimeout(()=>{t||Ot(i)},e)}else S(n)},Bt=(e,t,n,r)=>{var i=e.length;let o=e.indexOf(t);return-1===o?!n&&r?e[i-1]:e[0]:(o+=n?1:-1,r&&(o=(o+i)%i),e[Math.max(0,Math.min(o,i-1))])},Ht=/[^.]*(?=\..*)\.|.*/,Ut=/\..*/,Vt=/::\d+$/,Wt={};let $t=1;const jt={mouseenter:"mouseover",mouseleave:"mouseout"},zt=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Gt(e,t){return t&&t+"::"+$t++||e.uidEvent||$t++}function Yt(e){var t=Gt(e);return e.uidEvent=t,Wt[t]=Wt[t]||{},Wt[t]}function Xt(e,t,n=null){return Object.values(e).find(e=>e.callable===t&&e.delegationSelector===n)}function Kt(e,t,n){var r="string"==typeof t,t=!r&&t||n;let i=Qt(e);return[r,t,i=zt.has(i)?i:e]}function qt(r,i,o,s,a){if("string"==typeof i&&r){let[e,t,n]=Kt(i,o,s);if(i in jt){const r=t=>function(e){if(!e.relatedTarget||e.relatedTarget!==e.delegateTarget&&!e.delegateTarget.contains(e.relatedTarget))return t.call(this,e)};t=r(t)}var s=Yt(r),s=s[n]||(s[n]={}),l=Xt(s,t,e?o:null);if(l)return l.oneOff=l.oneOff&&a;var u,c,d,h,f,l=Gt(t,i.replace(Ht,"")),i=e?(d=r,h=o,f=t,function t(n){var r=d.querySelectorAll(h);for(let e=n["target"];e&&e!==this;e=e.parentNode)for(const i of r)if(i===e)return Jt(n,{delegateTarget:e}),t.oneOff&&T.off(d,n.type,h,f),f.apply(e,[n])}):(u=r,c=t,function e(t){return Jt(t,{delegateTarget:u}),e.oneOff&&T.off(u,t.type,c),c.apply(u,[t])});i.delegationSelector=e?o:null,i.callable=t,i.oneOff=a,s[i.uidEvent=l]=i,r.addEventListener(n,i,e)}}function Zt(e,t,n,r,i){r=Xt(t[n],r,i);r&&(e.removeEventListener(n,r,Boolean(i)),delete t[n][r.uidEvent])}function Qt(e){return e=e.replace(Ut,""),jt[e]||e}const T={on(e,t,n,r){qt(e,t,n,r,!1)},one(e,t,n,r){qt(e,t,n,r,!0)},off(e,t,n,r){if("string"==typeof t&&e){const[d,h,f]=Kt(t,n,r),p=f!==t,g=Yt(e),m=g[f]||{},y=t.startsWith(".");if(void 0===h){if(y)for(const n of Object.keys(g)){i=void 0;o=void 0;s=void 0;a=void 0;c=void 0;l=void 0;u=void 0;var i=e;var o=g;var s=n;var a=t.slice(1);var l,u,c=o[s]||{};for([l,u]of Object.entries(c))l.includes(a)&&Zt(i,o,s,u.callable,u.delegationSelector)}for(const[n,r]of Object.entries(m)){const d=n.replace(Vt,"");p&&!t.includes(d)||Zt(e,g,f,r.callable,r.delegationSelector)}}else Object.keys(m).length&&Zt(e,g,f,h,d?n:null)}},trigger(e,t,n){if("string"!=typeof t||!e)return null;var r=Lt();let i=null,o=!0,s=!0,a=!1;t!==Qt(t)&&r&&(i=r.Event(t,n),r(e).trigger(i),o=!i.isPropagationStopped(),s=!i.isImmediatePropagationStopped(),a=i.isDefaultPrevented());r=Jt(new Event(t,{bubbles:o,cancelable:!0}),n);return a&&r.preventDefault(),s&&e.dispatchEvent(r),r.defaultPrevented&&i&&i.preventDefault(),r}};function Jt(e,t={}){for(const[n,r]of Object.entries(t))try{e[n]=r}catch(t){Object.defineProperty(e,n,{configurable:!0,get:()=>r})}return e}function en(t){if("true"===t)return!0;if("false"===t)return!1;if(t===Number(t).toString())return Number(t);if(""===t||"null"===t)return null;if("string"!=typeof t)return t;try{return JSON.parse(decodeURIComponent(t))}catch(e){return t}}function tn(e){return e.replace(/[A-Z]/g,e=>"-"+e.toLowerCase())}const R={setDataAttribute(e,t,n){e.setAttribute("data-bs-"+tn(t),n)},removeDataAttribute(e,t){e.removeAttribute("data-bs-"+tn(t))},getDataAttributes(t){if(!t)return{};var n={};for(const r of Object.keys(t.dataset).filter(e=>e.startsWith("bs")&&!e.startsWith("bsConfig"))){let e=r.replace(/^bs/,"");n[e=e.charAt(0).toLowerCase()+e.slice(1,e.length)]=en(t.dataset[r])}return n},getDataAttribute:(e,t)=>en(e.getAttribute("data-bs-"+tn(t)))};class nn{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){var n=s(t)?R.getDataAttribute(t,"config"):{};return{...this.constructor.Default,..."object"==typeof n?n:{},...s(t)?R.getDataAttributes(t):{},..."object"==typeof e?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(var[n,r]of Object.entries(t)){const t=e[n],o=s(t)?"element":null==(i=t)?""+i:Object.prototype.toString.call(i).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(r).test(o))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${n}" provided type "${o}" but expected type "${r}".`)}var i}}class A extends nn{constructor(e,t){super(),(e=o(e))&&(this._element=e,this._config=this._getConfig(t),_t.set(this._element,this.constructor.DATA_KEY,this))}dispose(){_t.remove(this._element,this.constructor.DATA_KEY),T.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,n=!0){Ft(e,t,n)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return _t.get(o(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,"object"==typeof t?t:null)}static get VERSION(){return"5.3.1"}static get DATA_KEY(){return"bs."+this.NAME}static get EVENT_KEY(){return"."+this.DATA_KEY}static eventName(e){return""+e+this.EVENT_KEY}}const rn=t=>{let n=t.getAttribute("data-bs-target");if(!n||"#"===n){let e=t.getAttribute("href");if(!e||!e.includes("#")&&!e.startsWith("."))return null;e.includes("#")&&!e.startsWith("#")&&(e="#"+e.split("#")[1]),n=e&&"#"!==e?e.trim():null}return xt(n)},M={find:(e,t=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(t,e)),findOne:(e,t=document.documentElement)=>Element.prototype.querySelector.call(t,e),children:(e,t)=>[].concat(...e.children).filter(e=>e.matches(t)),parents(e,t){var n=[];let r=e.parentNode.closest(t);for(;r;)n.push(r),r=r.parentNode.closest(t);return n},prev(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return[n];n=n.previousElementSibling}return[]},next(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return[n];n=n.nextElementSibling}return[]},focusableChildren(e){var t=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(e=>e+':not([tabindex^="-"])').join(",");return this.find(t,e).filter(e=>!v(e)&&It(e))},getSelectorFromElement(e){e=rn(e);return e&&M.findOne(e)?e:null},getElementFromSelector(e){e=rn(e);return e?M.findOne(e):null},getMultipleElementsFromSelector(e){e=rn(e);return e?M.find(e):[]}},on=(t,n="hide")=>{const e="click.dismiss"+t.EVENT_KEY,r=t.NAME;T.on(document,e,`[data-bs-dismiss="${r}"]`,function(e){["A","AREA"].includes(this.tagName)&&e.preventDefault(),v(this)||(e=M.getElementFromSelector(this)||this.closest("."+r),t.getOrCreateInstance(e)[n]())})};class sn extends A{static get NAME(){return"alert"}close(){var e;T.trigger(this._element,"close.bs.alert").defaultPrevented||(this._element.classList.remove("show"),e=this._element.classList.contains("fade"),this._queueCallback(()=>this._destroyElement(),this._element,e))}_destroyElement(){this._element.remove(),T.trigger(this._element,"closed.bs.alert"),this.dispose()}static jQueryInterface(t){return this.each(function(){var e=sn.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}})}}on(sn,"close"),t(sn);const an='[data-bs-toggle="button"]';class ln extends A{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(t){return this.each(function(){var e=ln.getOrCreateInstance(this);"toggle"===t&&e[t]()})}}T.on(document,"click.bs.button.data-api",an,e=>{e.preventDefault();e=e.target.closest(an);ln.getOrCreateInstance(e).toggle()}),t(ln);const un=".bs.swipe",cn=(un,un,un,un,un,{endCallback:null,leftCallback:null,rightCallback:null}),dn={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class hn extends nn{constructor(e,t){super(),(this._element=e)&&hn.isSupported()&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents())}static get Default(){return cn}static get DefaultType(){return dn}static get NAME(){return"swipe"}dispose(){T.off(this._element,un)}_start(e){this._supportPointerEvents?this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX):this._deltaX=e.touches[0].clientX}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),S(this._config.endCallback)}_move(e){this._deltaX=e.touches&&1<e.touches.length?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){var e=Math.abs(this._deltaX);e<=40||(e=e/this._deltaX,this._deltaX=0,e&&S(0<e?this._config.rightCallback:this._config.leftCallback))}_initEvents(){this._supportPointerEvents?(T.on(this._element,"pointerdown.bs.swipe",e=>this._start(e)),T.on(this._element,"pointerup.bs.swipe",e=>this._end(e)),this._element.classList.add("pointer-event")):(T.on(this._element,"touchstart.bs.swipe",e=>this._start(e)),T.on(this._element,"touchmove.bs.swipe",e=>this._move(e)),T.on(this._element,"touchend.bs.swipe",e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&("pen"===e.pointerType||"touch"===e.pointerType)}static isSupported(){return"ontouchstart"in document.documentElement||0<navigator.maxTouchPoints}}const fn=".bs.carousel",pn="next",gn="prev",mn="left",yn="right",vn="slid"+fn,bn="carousel",En="active",Cn=".active",wn=".carousel-item",Sn=(Cn,wn,{ArrowLeft:yn,ArrowRight:mn}),Tn={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Rn={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class An extends A{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=M.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===bn&&this.cycle()}static get Default(){return Tn}static get DefaultType(){return Rn}static get NAME(){return"carousel"}next(){this._slide(pn)}nextWhenVisible(){!document.hidden&&It(this._element)&&this.next()}prev(){this._slide(gn)}pause(){this._isSliding&&Ot(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?T.one(this._element,vn,()=>this.cycle()):this.cycle())}to(e){var t,n=this._getItems();e>n.length-1||e<0||(this._isSliding?T.one(this._element,vn,()=>this.to(e)):(t=this._getItemIndex(this._getActive()))!==e&&(t=t<e?pn:gn,this._slide(t,n[e])))}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&T.on(this._element,"keydown.bs.carousel",e=>this._keydown(e)),"hover"===this._config.pause&&(T.on(this._element,"mouseenter.bs.carousel",()=>this.pause()),T.on(this._element,"mouseleave.bs.carousel",()=>this._maybeEnableCycle())),this._config.touch&&hn.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const e of M.find(".carousel-item img",this._element))T.on(e,"dragstart.bs.carousel",e=>e.preventDefault());const e={leftCallback:()=>this._slide(this._directionToOrder(mn)),rightCallback:()=>this._slide(this._directionToOrder(yn)),endCallback:()=>{"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}};this._swipeHelper=new hn(this._element,e)}_keydown(e){var t;/input|textarea/i.test(e.target.tagName)||(t=Sn[e.key])&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){var t;this._indicatorsElement&&((t=M.findOne(Cn,this._indicatorsElement)).classList.remove(En),t.removeAttribute("aria-current"),t=M.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement))&&(t.classList.add(En),t.setAttribute("aria-current","true"))}_updateInterval(){var e=this._activeElement||this._getActive();e&&(e=Number.parseInt(e.getAttribute("data-bs-interval"),10),this._config.interval=e||this._config.defaultInterval)}_slide(t,e=null){if(!this._isSliding){const n=this._getActive(),r=t===pn,i=e||Bt(this._getItems(),n,r,this._config.wrap);if(i!==n){const o=this._getItemIndex(i),s=e=>T.trigger(this._element,e,{relatedTarget:i,direction:this._orderToDirection(t),from:this._getItemIndex(n),to:o});if(!s("slide.bs.carousel").defaultPrevented&&n&&i){e=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(o),this._activeElement=i;const a=r?"carousel-item-start":"carousel-item-end",l=r?"carousel-item-next":"carousel-item-prev";i.classList.add(l),Dt(i),n.classList.add(a),i.classList.add(a),this._queueCallback(()=>{i.classList.remove(a,l),i.classList.add(En),n.classList.remove(En,l,a),this._isSliding=!1,s(vn)},n,this._isAnimated()),e&&this.cycle()}}}}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return M.findOne(".active.carousel-item",this._element)}_getItems(){return M.find(wn,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return w()?e===mn?gn:pn:e===mn?pn:gn}_orderToDirection(e){return w()?e===gn?mn:yn:e===gn?yn:mn}static jQueryInterface(t){return this.each(function(){var e=An.getOrCreateInstance(this,t);if("number"!=typeof t){if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}else e.to(t)})}}T.on(document,"click.bs.carousel.data-api","[data-bs-slide], [data-bs-slide-to]",function(e){var t=M.getElementFromSelector(this);t&&t.classList.contains(bn)&&(e.preventDefault(),e=An.getOrCreateInstance(t),(t=this.getAttribute("data-bs-slide-to"))?e.to(t):"next"===R.getDataAttribute(this,"slide")?e.next():e.prev(),e._maybeEnableCycle())}),T.on(window,"load.bs.carousel.data-api",()=>{for(const e of M.find('[data-bs-ride="carousel"]'))An.getOrCreateInstance(e)}),t(An);const _n="show",Nn="collapse",xn="collapsing",On=(Nn,Nn,'[data-bs-toggle="collapse"]'),In={parent:null,toggle:!0},Mn={parent:"(null|element)",toggle:"boolean"};class kn extends A{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const n=M.find(On);for(const e of n){const t=M.getSelectorFromElement(e),n=M.find(t).filter(e=>e===this._element);null!==t&&n.length&&this._triggerArray.push(e)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return In}static get DefaultType(){return Mn}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(!this._isTransitioning&&!this._isShown()){let e=[];if(!((e=this._config.parent?this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(e=>e!==this._element).map(e=>kn.getOrCreateInstance(e,{toggle:!1})):e).length&&e[0]._isTransitioning||T.trigger(this._element,"show.bs.collapse").defaultPrevented)){for(const n of e)n.hide();const n=this._getDimension();this._element.classList.remove(Nn),this._element.classList.add(xn),this._element.style[n]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;var t="scroll"+(n[0].toUpperCase()+n.slice(1));this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(xn),this._element.classList.add(Nn,_n),this._element.style[n]="",T.trigger(this._element,"shown.bs.collapse")},this._element,!0),this._element.style[n]=this._element[t]+"px"}}}hide(){if(!this._isTransitioning&&this._isShown()&&!T.trigger(this._element,"hide.bs.collapse").defaultPrevented){const t=this._getDimension();this._element.style[t]=this._element.getBoundingClientRect()[t]+"px",Dt(this._element),this._element.classList.add(xn),this._element.classList.remove(Nn,_n);for(const t of this._triggerArray){var e=M.getElementFromSelector(t);e&&!this._isShown(e)&&this._addAriaAndCollapsedClass([t],!1)}this._isTransitioning=!0,this._element.style[t]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(xn),this._element.classList.add(Nn),T.trigger(this._element,"hidden.bs.collapse")},this._element,!0)}}_isShown(e=this._element){return e.classList.contains(_n)}_configAfterMerge(e){return e.toggle=Boolean(e.toggle),e.parent=o(e.parent),e}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(this._config.parent){const e=this._getFirstLevelChildren(On);for(const t of e){const e=M.getElementFromSelector(t);e&&this._addAriaAndCollapsedClass([t],this._isShown(e))}}}_getFirstLevelChildren(e){const t=M.find(":scope .collapse .collapse",this._config.parent);return M.find(e,this._config.parent).filter(e=>!t.includes(e))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const n of e)n.classList.toggle("collapsed",!t),n.setAttribute("aria-expanded",t)}static jQueryInterface(t){const n={};return"string"==typeof t&&/show|hide/.test(t)&&(n.toggle=!1),this.each(function(){var e=kn.getOrCreateInstance(this,n);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}})}}T.on(document,"click.bs.collapse.data-api",On,function(e){("A"===e.target.tagName||e.delegateTarget&&"A"===e.delegateTarget.tagName)&&e.preventDefault();for(const e of M.getMultipleElementsFromSelector(this))kn.getOrCreateInstance(e,{toggle:!1}).toggle()}),t(kn);const Dn="dropdown",Ln=".bs.dropdown",Pn=".data-api",Fn="ArrowDown",Bn="click"+Ln+Pn,Hn="keydown"+Ln+Pn,Un="show",Vn='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Wn=(Vn,".dropdown-menu"),$n=w()?"top-end":"top-start",jn=w()?"top-start":"top-end",zn=w()?"bottom-end":"bottom-start",Gn=w()?"bottom-start":"bottom-end",Yn=w()?"left-start":"right-start",Xn=w()?"right-start":"left-start",Kn={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},qn={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class k extends A{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=M.next(this._element,Wn)[0]||M.prev(this._element,Wn)[0]||M.findOne(Wn,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Kn}static get DefaultType(){return qn}static get NAME(){return Dn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(!v(this._element)&&!this._isShown()){const e={relatedTarget:this._element};if(!T.trigger(this._element,"show.bs.dropdown",e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const e of[].concat(...document.body.children))T.on(e,"mouseover",kt);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Un),this._element.classList.add(Un),T.trigger(this._element,"shown.bs.dropdown",e)}}}hide(){var e;!v(this._element)&&this._isShown()&&(e={relatedTarget:this._element},this._completeHide(e))}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!T.trigger(this._element,"hide.bs.dropdown",e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))T.off(e,"mouseover",kt);this._popper&&this._popper.destroy(),this._menu.classList.remove(Un),this._element.classList.remove(Un),this._element.setAttribute("aria-expanded","false"),R.removeDataAttribute(this._menu,"popper"),T.trigger(this._element,"hidden.bs.dropdown",e)}}_getConfig(e){if("object"!=typeof(e=super._getConfig(e)).reference||s(e.reference)||"function"==typeof e.reference.getBoundingClientRect)return e;throw new TypeError(Dn.toUpperCase()+': Option "reference" provided type "object" without a required "getBoundingClientRect" method.')}_createPopper(){if(void 0===At)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let e=this._element;"parent"===this._config.reference?e=this._parent:s(this._config.reference)?e=o(this._config.reference):"object"==typeof this._config.reference&&(e=this._config.reference);var t=this._getPopperConfig();this._popper=Rt(e,this._menu,t)}_isShown(){return this._menu.classList.contains(Un)}_getPlacement(){var e,t=this._parent;return t.classList.contains("dropend")?Yn:t.classList.contains("dropstart")?Xn:t.classList.contains("dropup-center")?"top":t.classList.contains("dropdown-center")?"bottom":(e="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim(),t.classList.contains("dropup")?e?jn:$n:e?Gn:zn)}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){const t=this._config["offset"];return"string"==typeof t?t.split(",").map(e=>Number.parseInt(e,10)):"function"==typeof t?e=>t(e,this._element):t}_getPopperConfig(){var e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return!this._inNavbar&&"static"!==this._config.display||(R.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...S(this._config.popperConfig,[e])}}_selectMenuItem({key:e,target:t}){var n=M.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(e=>It(e));n.length&&Bt(n,t,e===Fn,!n.includes(t)).focus()}static jQueryInterface(t){return this.each(function(){var e=k.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}})}static clearMenus(e){if(2!==e.button&&("keyup"!==e.type||"Tab"===e.key)){const r=M.find('[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled).show');for(const i of r){const r=k.getInstance(i);var t,n;r&&!1!==r._config.autoClose&&(t=(n=e.composedPath()).includes(r._menu),n.includes(r._element)||"inside"===r._config.autoClose&&!t||"outside"===r._config.autoClose&&t||r._menu.contains(e.target)&&("keyup"===e.type&&"Tab"===e.key||/input|select|option|textarea|form/i.test(e.target.tagName))||(n={relatedTarget:r._element},"click"===e.type&&(n.clickEvent=e),r._completeHide(n)))}}}static dataApiKeydownHandler(e){var t=/input|textarea/i.test(e.target.tagName),n="Escape"===e.key,r=["ArrowUp",Fn].includes(e.key);!r&&!n||t&&!n||(e.preventDefault(),t=this.matches(Vn)?this:M.prev(this,Vn)[0]||M.next(this,Vn)[0]||M.findOne(Vn,e.delegateTarget.parentNode),n=k.getOrCreateInstance(t),r?(e.stopPropagation(),n.show(),n._selectMenuItem(e)):n._isShown()&&(e.stopPropagation(),n.hide(),t.focus()))}}T.on(document,Hn,Vn,k.dataApiKeydownHandler),T.on(document,Hn,Wn,k.dataApiKeydownHandler),T.on(document,Bn,k.clearMenus),T.on(document,"keyup.bs.dropdown.data-api",k.clearMenus),T.on(document,Bn,Vn,function(e){e.preventDefault(),k.getOrCreateInstance(this).toggle()}),t(k);const Zn="backdrop",Qn="mousedown.bs."+Zn,Jn={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},er={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class tr extends nn{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Jn}static get DefaultType(){return er}static get NAME(){return Zn}show(e){var t;this._config.isVisible?(this._append(),t=this._getElement(),this._config.isAnimated&&Dt(t),t.classList.add("show"),this._emulateAnimation(()=>{S(e)})):S(e)}hide(e){this._config.isVisible?(this._getElement().classList.remove("show"),this._emulateAnimation(()=>{this.dispose(),S(e)})):S(e)}dispose(){this._isAppended&&(T.off(this._element,Qn),this._element.remove(),this._isAppended=!1)}_getElement(){var e;return this._element||((e=document.createElement("div")).className=this._config.className,this._config.isAnimated&&e.classList.add("fade"),this._element=e),this._element}_configAfterMerge(e){return e.rootElement=o(e.rootElement),e}_append(){var e;this._isAppended||(e=this._getElement(),this._config.rootElement.append(e),T.on(e,Qn,()=>{S(this._config.clickCallback)}),this._isAppended=!0)}_emulateAnimation(e){Ft(e,this._getElement(),this._config.isAnimated)}}const nr=".bs.focustrap",rr=(nr,nr,"backward"),ir={autofocus:!0,trapElement:null},or={autofocus:"boolean",trapElement:"element"};class sr extends nn{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return ir}static get DefaultType(){return or}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),T.off(document,nr),T.on(document,"focusin.bs.focustrap",e=>this._handleFocusin(e)),T.on(document,"keydown.tab.bs.focustrap",e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,T.off(document,nr))}_handleFocusin(e){var t=this._config["trapElement"];e.target===document||e.target===t||t.contains(e.target)||(0===(e=M.focusableChildren(t)).length?t:this._lastTabNavDirection===rr?e[e.length-1]:e[0]).focus()}_handleKeydown(e){"Tab"===e.key&&(this._lastTabNavDirection=e.shiftKey?rr:"forward")}}const ar=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",lr=".sticky-top",ur="padding-right",cr="margin-right";class dr{constructor(){this._element=document.body}getWidth(){var e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const t=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,ur,e=>e+t),this._setElementAttributes(ar,ur,e=>e+t),this._setElementAttributes(lr,cr,e=>e-t)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,ur),this._resetElementAttributes(ar,ur),this._resetElementAttributes(lr,cr)}isOverflowing(){return 0<this.getWidth()}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,n,r){const i=this.getWidth();this._applyManipulationCallback(e,e=>{var t;e!==this._element&&window.innerWidth>e.clientWidth+i||(this._saveInitialAttribute(e,n),t=window.getComputedStyle(e).getPropertyValue(n),e.style.setProperty(n,r(Number.parseFloat(t))+"px"))})}_saveInitialAttribute(e,t){var n=e.style.getPropertyValue(t);n&&R.setDataAttribute(e,t,n)}_resetElementAttributes(e,n){this._applyManipulationCallback(e,e=>{var t=R.getDataAttribute(e,n);null!==t?(R.removeDataAttribute(e,n),e.style.setProperty(n,t)):e.style.removeProperty(n)})}_applyManipulationCallback(e,t){if(s(e))t(e);else for(const n of M.find(e,this._element))t(n)}}const D=".bs.modal",hr=(D,D,"hidden"+D),fr="show"+D,pr=(D,D,D,D,D,D,"modal-open"),gr="modal-static",mr={backdrop:!0,focus:!0,keyboard:!0},yr={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class vr extends A{constructor(e,t){super(e,t),this._dialog=M.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new dr,this._addEventListeners()}static get Default(){return mr}static get DefaultType(){return yr}static get NAME(){return"modal"}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||T.trigger(this._element,fr,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(pr),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||T.trigger(this._element,"hide.bs.modal").defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove("show"),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){T.off(window,D),T.off(this._dialog,D),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new tr({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new sr({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;var t=M.findOne(".modal-body",this._dialog);t&&(t.scrollTop=0),Dt(this._element),this._element.classList.add("show"),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,T.trigger(this._element,"shown.bs.modal",{relatedTarget:e})},this._dialog,this._isAnimated())}_addEventListeners(){T.on(this._element,"keydown.dismiss.bs.modal",e=>{"Escape"===e.key&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())}),T.on(window,"resize.bs.modal",()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),T.on(this._element,"mousedown.dismiss.bs.modal",t=>{T.one(this._element,"click.dismiss.bs.modal",e=>{this._element===t.target&&this._element===e.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(pr),this._resetAdjustments(),this._scrollBar.reset(),T.trigger(this._element,hr)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(!T.trigger(this._element,"hidePrevented.bs.modal").defaultPrevented){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._element.style.overflowY;"hidden"===t||this._element.classList.contains(gr)||(e||(this._element.style.overflowY="hidden"),this._element.classList.add(gr),this._queueCallback(()=>{this._element.classList.remove(gr),this._queueCallback(()=>{this._element.style.overflowY=t},this._dialog)},this._dialog),this._element.focus())}}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),n=0<t;if(n&&!e){const e=w()?"paddingLeft":"paddingRight";this._element.style[e]=t+"px"}if(!n&&e){const e=w()?"paddingRight":"paddingLeft";this._element.style[e]=t+"px"}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,n){return this.each(function(){var e=vr.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t](n)}})}}T.on(document,"click.bs.modal.data-api",'[data-bs-toggle="modal"]',function(e){const t=M.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&e.preventDefault(),T.one(t,fr,e=>{e.defaultPrevented||T.one(t,hr,()=>{It(this)&&this.focus()})});e=M.findOne(".modal.show");e&&vr.getInstance(e).hide(),vr.getOrCreateInstance(t).toggle(this)}),on(vr),t(vr);const br=".bs.offcanvas",Er="showing",Cr=".offcanvas.show",wr="hidePrevented"+br,Sr="hidden"+br,Tr={backdrop:!0,keyboard:!0,scroll:!1},Rr={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class L extends A{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Tr}static get DefaultType(){return Rr}static get NAME(){return"offcanvas"}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||T.trigger(this._element,"show.bs.offcanvas",{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||(new dr).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Er),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add("show"),this._element.classList.remove(Er),T.trigger(this._element,"shown.bs.offcanvas",{relatedTarget:e})},this._element,!0))}hide(){!this._isShown||T.trigger(this._element,"hide.bs.offcanvas").defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add("hiding"),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove("show","hiding"),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||(new dr).reset(),T.trigger(this._element,Sr)},this._element,!0))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){var e=Boolean(this._config.backdrop);return new tr({className:"offcanvas-backdrop",isVisible:e,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:e?()=>{"static"!==this._config.backdrop?this.hide():T.trigger(this._element,wr)}:null})}_initializeFocusTrap(){return new sr({trapElement:this._element})}_addEventListeners(){T.on(this._element,"keydown.dismiss.bs.offcanvas",e=>{"Escape"===e.key&&(this._config.keyboard?this.hide():T.trigger(this._element,wr))})}static jQueryInterface(t){return this.each(function(){var e=L.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}})}}T.on(document,"click.bs.offcanvas.data-api",'[data-bs-toggle="offcanvas"]',function(e){var t=M.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&e.preventDefault(),v(this)||(T.one(t,Sr,()=>{It(this)&&this.focus()}),(e=M.findOne(Cr))&&e!==t&&L.getInstance(e).hide(),L.getOrCreateInstance(t).toggle(this))}),T.on(window,"load.bs.offcanvas.data-api",()=>{for(const e of M.find(Cr))L.getOrCreateInstance(e).show()}),T.on(window,"resize.bs.offcanvas",()=>{for(const e of M.find("[aria-modal][class*=show][class*=offcanvas-]"))"fixed"!==getComputedStyle(e).position&&L.getOrCreateInstance(e).hide()}),on(L),t(L);const Ar={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},_r=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Nr=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,xr={allowList:Ar,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Or={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Ir={entry:"(string|element|function|null)",selector:"(string|element)"};class Mr extends nn{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return xr}static get DefaultType(){return Or}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return 0<this.getContent().length}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){var e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[t,n]of Object.entries(this._config.content))this._setContent(e,n,t);const t=e.children[0],n=this._resolvePossibleFunction(this._config.extraClass);return n&&t.classList.add(...n.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(var[t,n]of Object.entries(e))super._typeCheckConfig({selector:t,entry:n},Ir)}_setContent(e,t,n){n=M.findOne(n,e);n&&((t=this._resolvePossibleFunction(t))?s(t)?this._putElementInTemplate(o(t),n):this._config.html?n.innerHTML=this._maybeSanitize(t):n.textContent=t:n.remove())}_maybeSanitize(e){if(this._config.sanitize){var t=e,n=this._config.allowList,r=this._config.sanitizeFn;if(!t.length)return t;if(r&&"function"==typeof r)return r(t);const i=(new window.DOMParser).parseFromString(t,"text/html"),o=[].concat(...i.body.querySelectorAll("*"));for(const t of o){const r=t.nodeName.toLowerCase();if(Object.keys(n).includes(r)){const i=[].concat(...t.attributes),o=[].concat(n["*"]||[],n[r]||[]);for(const n of i)((e,t)=>{const n=e.nodeName.toLowerCase();return t.includes(n)?!_r.has(n)||Boolean(Nr.test(e.nodeValue)):t.filter(e=>e instanceof RegExp).some(e=>e.test(n))})(n,o)||t.removeAttribute(n.nodeName)}else t.remove()}return i.body.innerHTML}return e}_resolvePossibleFunction(e){return S(e,[this])}_putElementInTemplate(e,t){this._config.html?(t.innerHTML="",t.append(e)):t.textContent=e.textContent}}const kr=new Set(["sanitize","allowList","sanitizeFn"]),Dr="fade",Lr="show",Pr="hide.bs.modal",Fr="hover",Br="focus",Hr={AUTO:"auto",TOP:"top",RIGHT:w()?"left":"right",BOTTOM:"bottom",LEFT:w()?"right":"left"},Ur={allowList:Ar,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Vr={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Wr extends A{constructor(e,t){if(void 0===At)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Ur}static get DefaultType(){return Vr}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),T.off(this._element.closest(".modal"),Pr,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if("none"===this._element.style.display)throw new Error("Please use show on visible elements");if(this._isWithContent()&&this._isEnabled){const n=T.trigger(this._element,this.constructor.eventName("show")),r=(Mt(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(!n.defaultPrevented&&r){this._disposePopper();var e=this._getTipElement(),t=(this._element.setAttribute("aria-describedby",e.getAttribute("id")),this._config)["container"];if(this._element.ownerDocument.documentElement.contains(this.tip)||(t.append(e),T.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(e),e.classList.add(Lr),"ontouchstart"in document.documentElement)for(const n of[].concat(...document.body.children))T.on(n,"mouseover",kt);this._queueCallback(()=>{T.trigger(this._element,this.constructor.eventName("shown")),!1===this._isHovered&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}}}hide(){if(this._isShown()&&!T.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(Lr),"ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))T.off(e,"mouseover",kt);this._activeTrigger.click=!1,this._activeTrigger[Br]=!1,this._activeTrigger[Fr]=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),T.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){e=this._getTemplateFactory(e).toHtml();if(!e)return null;e.classList.remove(Dr,Lr),e.classList.add(`bs-${this.constructor.NAME}-auto`);var t=(e=>{for(;e+=Math.floor(1e6*Math.random()),document.getElementById(e););return e})(this.constructor.NAME).toString();return e.setAttribute("id",t),this._isAnimated()&&e.classList.add(Dr),e}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new Mr({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Dr)}_isShown(){return this.tip&&this.tip.classList.contains(Lr)}_createPopper(e){var t=S(this._config.placement,[this,e,this._element]),t=Hr[t.toUpperCase()];return Rt(this._element,e,this._getPopperConfig(t))}_getOffset(){const t=this._config["offset"];return"string"==typeof t?t.split(",").map(e=>Number.parseInt(e,10)):"function"==typeof t?e=>t(e,this._element):t}_resolvePossibleFunction(e){return S(e,[this._element])}_getPopperConfig(e){e={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:e=>{this._getTipElement().setAttribute("data-popper-placement",e.state.placement)}}]};return{...e,...S(this._config.popperConfig,[e])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if("click"===t)T.on(this._element,this.constructor.eventName("click"),this._config.selector,e=>{this._initializeOnDelegatedTarget(e).toggle()});else if("manual"!==t){const e=t===Fr?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),n=t===Fr?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");T.on(this._element,e,this._config.selector,e=>{var t=this._initializeOnDelegatedTarget(e);t._activeTrigger["focusin"===e.type?Br:Fr]=!0,t._enter()}),T.on(this._element,n,this._config.selector,e=>{var t=this._initializeOnDelegatedTarget(e);t._activeTrigger["focusout"===e.type?Br:Fr]=t._element.contains(e.relatedTarget),t._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},T.on(this._element.closest(".modal"),Pr,this._hideModalHandler)}_fixTitle(){var e=this._element.getAttribute("title");e&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){var t=R.getDataAttributes(this._element);for(const e of Object.keys(t))kr.has(e)&&delete t[e];return e={...t,..."object"==typeof e&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=!1===e.container?document.body:o(e.container),"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),"number"==typeof e.title&&(e.title=e.title.toString()),"number"==typeof e.content&&(e.content=e.content.toString()),e}_getDelegateConfig(){var e,t,n={};for([e,t]of Object.entries(this._config))this.constructor.Default[e]!==t&&(n[e]=t);return n.selector=!1,n.trigger="manual",n}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(t){return this.each(function(){var e=Wr.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}})}}t(Wr);const $r={...Wr.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},jr={...Wr.DefaultType,content:"(null|string|element|function)"};class zr extends Wr{static get Default(){return $r}static get DefaultType(){return jr}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(t){return this.each(function(){var e=zr.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}})}}t(zr);const Gr=".bs.scrollspy",Yr="click"+Gr,Xr="active",Kr="[href]",qr={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Zr={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Qr extends A{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement="visible"===getComputedStyle(this._element).overflowY?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return qr}static get DefaultType(){return Zr}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=o(e.target)||document.body,e.rootMargin=e.offset?e.offset+"px 0px -30%":e.rootMargin,"string"==typeof e.threshold&&(e.threshold=e.threshold.split(",").map(e=>Number.parseFloat(e))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(T.off(this._config.target,Yr),T.on(this._config.target,Yr,Kr,e=>{var t=this._observableSections.get(e.target.hash);t&&(e.preventDefault(),e=this._rootElement||window,t=t.offsetTop-this._element.offsetTop,e.scrollTo?e.scrollTo({top:t,behavior:"smooth"}):e.scrollTop=t)}))}_getNewObserver(){var e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(e=>this._observerCallback(e),e)}_observerCallback(e){const t=e=>this._targetLinks.get("#"+e.target.id),n=e=>{this._previousScrollData.visibleEntryTop=e.target.offsetTop,this._process(t(e))},r=(this._rootElement||document.documentElement).scrollTop,i=r>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=r;for(const o of e)if(o.isIntersecting){const e=o.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(i&&e){if(n(o),!r)return}else i||e||n(o)}else this._activeTarget=null,this._clearActiveClass(t(o))}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=M.find(Kr,this._config.target);for(const t of e)if(t.hash&&!v(t)){const e=M.findOne(decodeURI(t.hash),this._element);It(e)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,e))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),(this._activeTarget=e).classList.add(Xr),this._activateParents(e),T.trigger(this._element,"activate.bs.scrollspy",{relatedTarget:e}))}_activateParents(e){if(e.classList.contains("dropdown-item"))M.findOne(".dropdown-toggle",e.closest(".dropdown")).classList.add(Xr);else for(const t of M.parents(e,".nav, .list-group"))for(const e of M.prev(t,".nav-link, .nav-item > .nav-link, .list-group-item"))e.classList.add(Xr)}_clearActiveClass(e){e.classList.remove(Xr);var t=M.find(Kr+"."+Xr,e);for(const e of t)e.classList.remove(Xr)}static jQueryInterface(t){return this.each(function(){var e=Qr.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}})}}T.on(window,"load.bs.scrollspy.data-api",()=>{for(const e of M.find('[data-bs-spy="scroll"]'))Qr.getOrCreateInstance(e)}),t(Qr);const Jr="ArrowRight",ei="ArrowDown",ti="Home",ni="active",ri="show",ii=":not(.dropdown-toggle)",oi='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',si=`.nav-link${ii}, .list-group-item${ii}, [role="tab"]`+ii+", "+oi;ni,ni,ni;class ai extends A{constructor(e){super(e),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),T.on(this._element,"keydown.bs.tab",e=>this._keydown(e)))}static get NAME(){return"tab"}show(){var e,t,n=this._element;this._elemIsActive(n)||(t=(e=this._getActiveElem())?T.trigger(e,"hide.bs.tab",{relatedTarget:n}):null,T.trigger(n,"show.bs.tab",{relatedTarget:e}).defaultPrevented)||t&&t.defaultPrevented||(this._deactivate(e,n),this._activate(n,e))}_activate(e,t){e&&(e.classList.add(ni),this._activate(M.getElementFromSelector(e)),this._queueCallback(()=>{"tab"===e.getAttribute("role")?(e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),T.trigger(e,"shown.bs.tab",{relatedTarget:t})):e.classList.add(ri)},e,e.classList.contains("fade")))}_deactivate(e,t){e&&(e.classList.remove(ni),e.blur(),this._deactivate(M.getElementFromSelector(e)),this._queueCallback(()=>{"tab"===e.getAttribute("role")?(e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),T.trigger(e,"hidden.bs.tab",{relatedTarget:t})):e.classList.remove(ri)},e,e.classList.contains("fade")))}_keydown(t){if(["ArrowLeft",Jr,"ArrowUp",ei,ti,"End"].includes(t.key)){t.stopPropagation(),t.preventDefault();var n,r=this._getChildren().filter(e=>!v(e));let e;(e=[ti,"End"].includes(t.key)?r[t.key===ti?0:r.length-1]:(n=[Jr,ei].includes(t.key),Bt(r,t.target,n,!0)))&&(e.focus({preventScroll:!0}),ai.getOrCreateInstance(e).show())}}_getChildren(){return M.find(si,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const e of t)this._setInitialAttributesOnChild(e)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);var t=this._elemIsActive(e),n=this._getOuterElement(e);e.setAttribute("aria-selected",t),n!==e&&this._setAttributeIfNotExists(n,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){var t=M.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id)&&this._setAttributeIfNotExists(t,"aria-labelledby",""+e.id)}_toggleDropDown(e,n){const r=this._getOuterElement(e);r.classList.contains("dropdown")&&((e=(e,t)=>{e=M.findOne(e,r);e&&e.classList.toggle(t,n)})(".dropdown-toggle",ni),e(".dropdown-menu",ri),r.setAttribute("aria-expanded",n))}_setAttributeIfNotExists(e,t,n){e.hasAttribute(t)||e.setAttribute(t,n)}_elemIsActive(e){return e.classList.contains(ni)}_getInnerElement(e){return e.matches(si)?e:M.findOne(si,e)}_getOuterElement(e){return e.closest(".nav-item, .list-group-item")||e}static jQueryInterface(t){return this.each(function(){var e=ai.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}})}}T.on(document,"click.bs.tab",oi,function(e){["A","AREA"].includes(this.tagName)&&e.preventDefault(),v(this)||ai.getOrCreateInstance(this).show()}),T.on(window,"load.bs.tab",()=>{for(const e of M.find('.active[data-bs-toggle="tab"], .active[data-bs-toggle="pill"], .active[data-bs-toggle="list"]'))ai.getOrCreateInstance(e)}),t(ai);const li="show",ui="showing",ci={animation:"boolean",autohide:"boolean",delay:"number"},di={animation:!0,autohide:!0,delay:5e3};class hi extends A{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return di}static get DefaultType(){return ci}static get NAME(){return"toast"}show(){T.trigger(this._element,"show.bs.toast").defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove("hide"),Dt(this._element),this._element.classList.add(li,ui),this._queueCallback(()=>{this._element.classList.remove(ui),T.trigger(this._element,"shown.bs.toast"),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){!this.isShown()||T.trigger(this._element,"hide.bs.toast").defaultPrevented||(this._element.classList.add(ui),this._queueCallback(()=>{this._element.classList.add("hide"),this._element.classList.remove(ui,li),T.trigger(this._element,"hidden.bs.toast")},this._element,this._config.animation))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(li),super.dispose()}isShown(){return this._element.classList.contains(li)}_maybeScheduleHide(){!this._config.autohide||this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":this._hasMouseInteraction=t;break;case"focusin":case"focusout":this._hasKeyboardInteraction=t}t?this._clearTimeout():(e=e.relatedTarget,this._element===e||this._element.contains(e)||this._maybeScheduleHide())}_setListeners(){T.on(this._element,"mouseover.bs.toast",e=>this._onInteraction(e,!0)),T.on(this._element,"mouseout.bs.toast",e=>this._onInteraction(e,!1)),T.on(this._element,"focusin.bs.toast",e=>this._onInteraction(e,!0)),T.on(this._element,"focusout.bs.toast",e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each(function(){var e=hi.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t](this)}})}}on(hi),t(hi);function fi(e,t){return(e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e))?"rgba(".concat(parseInt(e[1],16),", ").concat(parseInt(e[2],16),", ").concat(parseInt(e[3],16),", ").concat(t,")"):null}var pi,St=Object.freeze({__proto__:null,Alert:sn,Button:ln,Carousel:An,Collapse:kn,Dropdown:k,Modal:vr,Offcanvas:L,Popover:zr,ScrollSpy:Qr,Tab:ai,Toast:hi,Tooltip:Wr}),Tt=([].slice.call(document.querySelectorAll('[data-bs-toggle="dropdown"]')).map(function(e){var t={boundary:"viewport"===e.getAttribute("data-bs-boundary")?document.querySelector(".btn"):"clippingParents"};return new k(e,t)}),[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map(function(e){var t={delay:{show:50,hide:50},html:null!==(t="true"===e.getAttribute("data-bs-html"))&&t,placement:null!=(t=e.getAttribute("data-bs-placement"))?t:"auto"};return new Wr(e,t)}),[].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]')).map(function(e){var t={delay:{show:50,hide:50},html:null!==(t="true"===e.getAttribute("data-bs-html"))&&t,placement:null!=(t=e.getAttribute("data-bs-placement"))?t:"auto"};return new zr(e,t)}),[].slice.call(document.querySelectorAll('[data-bs-toggle="switch-icon"]')).map(function(t){t.addEventListener("click",function(e){e.stopPropagation(),t.classList.toggle("active")})}),(pi=window.location.hash)&&[].slice.call(document.querySelectorAll('[data-bs-toggle="tab"]')).filter(function(e){return e.hash===pi}).map(function(e){new ai(e).show()}),[].slice.call(document.querySelectorAll('[data-bs-toggle="toast"]')).map(function(e){return new hi(e)}),Object.freeze({__proto__:null,prefix:"tblr-",hexToRgba:fi,getColor:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,e=getComputedStyle(document.body).getPropertyValue("--".concat("tblr-").concat(e)).trim();return 1!==t?fi(e,t):e}}));globalThis.bootstrap=St,globalThis.tabler=Tt}),!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(e.document)return t(e);throw new Error("jQuery requires a window with a document")}:t(e)}("undefined"!=typeof window?window:this,function(C,P){"use strict";function v(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item}function g(e){return null!=e&&e===e.window}var t=[],F=Object.getPrototypeOf,a=t.slice,B=t.flat?function(e){return t.flat.call(e)}:function(e){return t.concat.apply([],e)},H=t.push,U=t.indexOf,V={},W=V.toString,$=V.hasOwnProperty,j=$.toString,z=j.call(Object),m={},w=C.document,G={type:!0,src:!0,nonce:!0,noModule:!0};function Y(e,t,n){var r,i,o=(n=n||w).createElement("script");if(o.text=e,t)for(r in G)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function p(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?V[W.call(e)]||"object":typeof e}var S=function(e,t){return new S.fn.init(e,t)};function X(e){var t=!!e&&"length"in e&&e.length,n=p(e);return!v(e)&&!g(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}S.fn=S.prototype={jquery:"3.6.0",constructor:S,length:0,toArray:function(){return a.call(this)},get:function(e){return null==e?a.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){e=S.merge(this.constructor(),e);return e.prevObject=this,e},each:function(e){return S.each(this,e)},map:function(n){return this.pushStack(S.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(S.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(S.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,e=+e+(e<0?t:0);return this.pushStack(0<=e&&e<t?[this[e]]:[])},end:function(){return this.prevObject||this.constructor()},push:H,sort:t.sort,splice:t.splice},S.extend=S.fn.extend=function(){var e,t,n,r,i,o=arguments[0]||{},s=1,a=arguments.length,l=!1;for("boolean"==typeof o&&(l=o,o=arguments[s]||{},s++),"object"==typeof o||v(o)||(o={}),s===a&&(o=this,s--);s<a;s++)if(null!=(e=arguments[s]))for(t in e)n=e[t],"__proto__"!==t&&o!==n&&(l&&n&&(S.isPlainObject(n)||(r=Array.isArray(n)))?(i=o[t],i=r&&!Array.isArray(i)?[]:r||S.isPlainObject(i)?i:{},r=!1,o[t]=S.extend(l,i,n)):void 0!==n&&(o[t]=n));return o},S.extend({expando:"jQuery"+("3.6.0"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){return!(!e||"[object Object]"!==W.call(e)||(e=F(e))&&("function"!=typeof(e=$.call(e,"constructor")&&e.constructor)||j.call(e)!==z))},isEmptyObject:function(e){for(var t in e)return!1;return!0},globalEval:function(e,t,n){Y(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(X(e))for(n=e.length;r<n&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},makeArray:function(e,t){t=t||[];return null!=e&&(X(Object(e))?S.merge(t,"string"==typeof e?[e]:e):H.call(t,e)),t},inArray:function(e,t,n){return null==t?-1:U.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,s=!n;i<o;i++)!t(e[i],i)!=s&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,s=[];if(X(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&s.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&s.push(i);return B(s)},guid:1,support:m}),"function"==typeof Symbol&&(S.fn[Symbol.iterator]=t[Symbol.iterator]),S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){V["[object "+t+"]"]=t.toLowerCase()});function r(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&S(e).is(n))break;r.push(e)}return r}function K(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}var e=function(P){function d(e,t){return e="0x"+e.slice(1)-65536,t||(e<0?String.fromCharCode(65536+e):String.fromCharCode(e>>10|55296,1023&e|56320))}function F(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}function B(){w()}var e,h,E,o,H,f,U,V,C,l,u,w,S,n,T,p,r,i,g,R="sizzle"+ +new Date,c=P.document,A=0,W=0,$=I(),j=I(),z=I(),m=I(),G=function(e,t){return e===t&&(u=!0),0},Y={}.hasOwnProperty,t=[],X=t.pop,K=t.push,_=t.push,q=t.slice,v=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},Z="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",s="[\\x20\\t\\r\\n\\f]",a="(?:\\\\[\\da-fA-F]{1,6}"+s+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",Q="\\["+s+"*("+a+")(?:"+s+"*([*^$|!~]?=)"+s+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+a+"))|)"+s+"*\\]",J=":("+a+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+Q+")*)|.*)\\)|)",ee=new RegExp(s+"+","g"),y=new RegExp("^"+s+"+|((?:^|[^\\\\])(?:\\\\.)*)"+s+"+$","g"),te=new RegExp("^"+s+"*,"+s+"*"),ne=new RegExp("^"+s+"*([>+~]|"+s+")"+s+"*"),re=new RegExp(s+"|>"),ie=new RegExp(J),oe=new RegExp("^"+a+"$"),b={ID:new RegExp("^#("+a+")"),CLASS:new RegExp("^\\.("+a+")"),TAG:new RegExp("^("+a+"|[*])"),ATTR:new RegExp("^"+Q),PSEUDO:new RegExp("^"+J),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+s+"*(even|odd|(([+-]|)(\\d*)n|)"+s+"*(?:([+-]|)"+s+"*(\\d+)|))"+s+"*\\)|)","i"),bool:new RegExp("^(?:"+Z+")$","i"),needsContext:new RegExp("^"+s+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+s+"*((?:-\\d)?\\d*)"+s+"*\\)|)(?=[^-]|$)","i")},se=/HTML$/i,ae=/^(?:input|select|textarea|button)$/i,le=/^h\d$/i,N=/^[^{]+\{\s*\[native \w/,ue=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ce=/[+~]/,x=new RegExp("\\\\[\\da-fA-F]{1,6}"+s+"?|\\\\([^\\r\\n\\f])","g"),de=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,he=ve(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{_.apply(t=q.call(c.childNodes),c.childNodes),t[c.childNodes.length].nodeType}catch(e){_={apply:t.length?function(e,t){K.apply(e,q.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}function O(t,e,n,r){var i,o,s,a,l,u,c=e&&e.ownerDocument,d=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==d&&9!==d&&11!==d)return n;if(!r&&(w(e),e=e||S,T)){if(11!==d&&(a=ue.exec(t)))if(i=a[1]){if(9===d){if(!(u=e.getElementById(i)))return n;if(u.id===i)return n.push(u),n}else if(c&&(u=c.getElementById(i))&&g(e,u)&&u.id===i)return n.push(u),n}else{if(a[2])return _.apply(n,e.getElementsByTagName(t)),n;if((i=a[3])&&h.getElementsByClassName&&e.getElementsByClassName)return _.apply(n,e.getElementsByClassName(i)),n}if(h.qsa&&!m[t+" "]&&(!p||!p.test(t))&&(1!==d||"object"!==e.nodeName.toLowerCase())){if(u=t,c=e,1===d&&(re.test(t)||ne.test(t))){for((c=ce.test(t)&&me(e.parentNode)||e)===e&&h.scope||((s=e.getAttribute("id"))?s=s.replace(de,F):e.setAttribute("id",s=R)),o=(l=f(t)).length;o--;)l[o]=(s?"#"+s:":scope")+" "+L(l[o]);u=l.join(",")}try{return _.apply(n,c.querySelectorAll(u)),n}catch(e){m(t,!0)}finally{s===R&&e.removeAttribute("id")}}}return V(t.replace(y,"$1"),e,n,r)}function I(){var n=[];function r(e,t){return n.push(e+" ")>E.cacheLength&&delete r[n.shift()],r[e+" "]=t}return r}function M(e){return e[R]=!0,e}function k(e){var t=S.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t)}}function fe(e,t){for(var n=e.split("|"),r=n.length;r--;)E.attrHandle[n[r]]=t}function pe(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function ge(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&he(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function D(s){return M(function(o){return o=+o,M(function(e,t){for(var n,r=s([],e.length,o),i=r.length;i--;)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function me(e){return e&&void 0!==e.getElementsByTagName&&e}for(e in h=O.support={},H=O.isXML=function(e){var t=e&&e.namespaceURI,e=e&&(e.ownerDocument||e).documentElement;return!se.test(t||e&&e.nodeName||"HTML")},w=O.setDocument=function(e){var e=e?e.ownerDocument||e:c;return e!=S&&9===e.nodeType&&e.documentElement&&(n=(S=e).documentElement,T=!H(S),c!=S&&(e=S.defaultView)&&e.top!==e&&(e.addEventListener?e.addEventListener("unload",B,!1):e.attachEvent&&e.attachEvent("onunload",B)),h.scope=k(function(e){return n.appendChild(e).appendChild(S.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length}),h.attributes=k(function(e){return e.className="i",!e.getAttribute("className")}),h.getElementsByTagName=k(function(e){return e.appendChild(S.createComment("")),!e.getElementsByTagName("*").length}),h.getElementsByClassName=N.test(S.getElementsByClassName),h.getById=k(function(e){return n.appendChild(e).id=R,!S.getElementsByName||!S.getElementsByName(R).length}),h.getById?(E.filter.ID=function(e){var t=e.replace(x,d);return function(e){return e.getAttribute("id")===t}},E.find.ID=function(e,t){if(void 0!==t.getElementById&&T)return(t=t.getElementById(e))?[t]:[]}):(E.filter.ID=function(e){var t=e.replace(x,d);return function(e){e=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return e&&e.value===t}},E.find.ID=function(e,t){if(void 0!==t.getElementById&&T){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];for(i=t.getElementsByName(e),r=0;o=i[r++];)if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),E.find.TAG=h.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):h.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"!==e)return o;for(;n=o[i++];)1===n.nodeType&&r.push(n);return r},E.find.CLASS=h.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&T)return t.getElementsByClassName(e)},r=[],p=[],(h.qsa=N.test(S.querySelectorAll))&&(k(function(e){var t;n.appendChild(e).innerHTML="<a id='"+R+"'></a><select id='"+R+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&p.push("[*^$]="+s+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||p.push("\\["+s+"*(?:value|"+Z+")"),e.querySelectorAll("[id~="+R+"-]").length||p.push("~="),(t=S.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||p.push("\\["+s+"*name"+s+"*="+s+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||p.push(":checked"),e.querySelectorAll("a#"+R+"+*").length||p.push(".#.+[+~]"),e.querySelectorAll("\\\f"),p.push("[\\r\\n\\f]")}),k(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=S.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&p.push("name"+s+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&p.push(":enabled",":disabled"),n.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&p.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),p.push(",.*:")})),(h.matchesSelector=N.test(i=n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.oMatchesSelector||n.msMatchesSelector))&&k(function(e){h.disconnectedMatch=i.call(e,"*"),i.call(e,"[s!='']:x"),r.push("!=",J)}),p=p.length&&new RegExp(p.join("|")),r=r.length&&new RegExp(r.join("|")),e=N.test(n.compareDocumentPosition),g=e||N.test(n.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,t=t&&t.parentNode;return e===t||!(!t||1!==t.nodeType||!(n.contains?n.contains(t):e.compareDocumentPosition&&16&e.compareDocumentPosition(t)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},G=e?function(e,t){var n;return e===t?(u=!0,0):(n=!e.compareDocumentPosition-!t.compareDocumentPosition)||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!h.sortDetached&&t.compareDocumentPosition(e)===n?e==S||e.ownerDocument==c&&g(c,e)?-1:t==S||t.ownerDocument==c&&g(c,t)?1:l?v(l,e)-v(l,t):0:4&n?-1:1)}:function(e,t){if(e===t)return u=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,s=[e],a=[t];if(!i||!o)return e==S?-1:t==S?1:i?-1:o?1:l?v(l,e)-v(l,t):0;if(i===o)return pe(e,t);for(n=e;n=n.parentNode;)s.unshift(n);for(n=t;n=n.parentNode;)a.unshift(n);for(;s[r]===a[r];)r++;return r?pe(s[r],a[r]):s[r]==c?-1:a[r]==c?1:0}),S},O.matches=function(e,t){return O(e,null,null,t)},O.matchesSelector=function(e,t){if(w(e),h.matchesSelector&&T&&!m[t+" "]&&(!r||!r.test(t))&&(!p||!p.test(t)))try{var n=i.call(e,t);if(n||h.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){m(t,!0)}return 0<O(t,S,null,[e]).length},O.contains=function(e,t){return(e.ownerDocument||e)!=S&&w(e),g(e,t)},O.attr=function(e,t){(e.ownerDocument||e)!=S&&w(e);var n=E.attrHandle[t.toLowerCase()],n=n&&Y.call(E.attrHandle,t.toLowerCase())?n(e,t,!T):void 0;return void 0!==n?n:h.attributes||!T?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},O.escape=function(e){return(e+"").replace(de,F)},O.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},O.uniqueSort=function(e){var t,n=[],r=0,i=0;if(u=!h.detectDuplicates,l=!h.sortStable&&e.slice(0),e.sort(G),u){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return l=null,e},o=O.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=o(t);return n},(E=O.selectors={cacheLength:50,createPseudo:M,match:b,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(x,d),e[3]=(e[3]||e[4]||e[5]||"").replace(x,d),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||O.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&O.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return b.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&ie.test(n)&&(t=(t=f(n,!0))&&n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(x,d).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=$[e+" "];return t||(t=new RegExp("(^|"+s+")"+e+"("+s+"|$)"))&&$(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(t,n,r){return function(e){e=O.attr(e,t);return null==e?"!="===n:!n||(e+="","="===n?e===r:"!="===n?e!==r:"^="===n?r&&0===e.indexOf(r):"*="===n?r&&-1<e.indexOf(r):"$="===n?r&&e.slice(-r.length)===r:"~="===n?-1<(" "+e.replace(ee," ")+" ").indexOf(r):"|="===n&&(e===r||e.slice(0,r.length+1)===r+"-"))}},CHILD:function(p,e,t,g,m){var y="nth"!==p.slice(0,3),v="last"!==p.slice(-4),b="of-type"===e;return 1===g&&0===m?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,s,a,l,u=y!=v?"nextSibling":"previousSibling",c=e.parentNode,d=b&&e.nodeName.toLowerCase(),h=!n&&!b,f=!1;if(c){if(y){for(;u;){for(s=e;s=s[u];)if(b?s.nodeName.toLowerCase()===d:1===s.nodeType)return!1;l=u="only"===p&&!l&&"nextSibling"}return!0}if(l=[v?c.firstChild:c.lastChild],v&&h){for(f=(a=(r=(i=(o=(s=c)[R]||(s[R]={}))[s.uniqueID]||(o[s.uniqueID]={}))[p]||[])[0]===A&&r[1])&&r[2],s=a&&c.childNodes[a];s=++a&&s&&s[u]||(f=a=0,l.pop());)if(1===s.nodeType&&++f&&s===e){i[p]=[A,a,f];break}}else if(!1===(f=h?a=(r=(i=(o=(s=e)[R]||(s[R]={}))[s.uniqueID]||(o[s.uniqueID]={}))[p]||[])[0]===A&&r[1]:f))for(;(s=++a&&s&&s[u]||(f=a=0,l.pop()))&&((b?s.nodeName.toLowerCase()!==d:1!==s.nodeType)||!++f||(h&&((i=(o=s[R]||(s[R]={}))[s.uniqueID]||(o[s.uniqueID]={}))[p]=[A,f]),s!==e)););return(f-=m)===g||f%g==0&&0<=f/g}}},PSEUDO:function(e,o){var t,s=E.pseudos[e]||E.setFilters[e.toLowerCase()]||O.error("unsupported pseudo: "+e);return s[R]?s(o):1<s.length?(t=[e,e,"",o],E.setFilters.hasOwnProperty(e.toLowerCase())?M(function(e,t){for(var n,r=s(e,o),i=r.length;i--;)e[n=v(e,r[i])]=!(t[n]=r[i])}):function(e){return s(e,0,t)}):s}},pseudos:{not:M(function(e){var r=[],i=[],a=U(e.replace(y,"$1"));return a[R]?M(function(e,t,n,r){for(var i,o=a(e,null,r,[]),s=e.length;s--;)(i=o[s])&&(e[s]=!(t[s]=i))}):function(e,t,n){return r[0]=e,a(r,null,n,i),r[0]=null,!i.pop()}}),has:M(function(t){return function(e){return 0<O(t,e).length}}),contains:M(function(t){return t=t.replace(x,d),function(e){return-1<(e.textContent||o(e)).indexOf(t)}}),lang:M(function(n){return oe.test(n||"")||O.error("unsupported lang: "+n),n=n.replace(x,d).toLowerCase(),function(e){var t;do{if(t=T?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=P.location&&P.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===n},focus:function(e){return e===S.activeElement&&(!S.hasFocus||S.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!E.pseudos.empty(e)},header:function(e){return le.test(e.nodeName)},input:function(e){return ae.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(e=e.getAttribute("type"))||"text"===e.toLowerCase())},first:D(function(){return[0]}),last:D(function(e,t){return[t-1]}),eq:D(function(e,t,n){return[n<0?n+t:n]}),even:D(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:D(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:D(function(e,t,n){for(var r=n<0?n+t:t<n?t:n;0<=--r;)e.push(r);return e}),gt:D(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=E.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})E.pseudos[e]=function(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}(e);for(e in{submit:!0,reset:!0})E.pseudos[e]=function(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}(e);function ye(){}function L(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function ve(s,e,t){var a=e.dir,l=e.next,u=l||a,c=t&&"parentNode"===u,d=W++;return e.first?function(e,t,n){for(;e=e[a];)if(1===e.nodeType||c)return s(e,t,n);return!1}:function(e,t,n){var r,i,o=[A,d];if(n){for(;e=e[a];)if((1===e.nodeType||c)&&s(e,t,n))return!0}else for(;e=e[a];)if(1===e.nodeType||c)if(i=(i=e[R]||(e[R]={}))[e.uniqueID]||(i[e.uniqueID]={}),l&&l===e.nodeName.toLowerCase())e=e[a]||e;else{if((r=i[u])&&r[0]===A&&r[1]===d)return o[2]=r[2];if((i[u]=o)[2]=s(e,t,n))return!0}return!1}}function be(i){return 1<i.length?function(e,t,n){for(var r=i.length;r--;)if(!i[r](e,t,n))return!1;return!0}:i[0]}function Ee(e,t,n,r,i){for(var o,s=[],a=0,l=e.length,u=null!=t;a<l;a++)!(o=e[a])||n&&!n(o,r,i)||(s.push(o),u&&t.push(a));return s}function Ce(f,p,g,m,y,e){return m&&!m[R]&&(m=Ce(m)),y&&!y[R]&&(y=Ce(y,e)),M(function(e,t,n,r){var i,o,s,a=[],l=[],u=t.length,c=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)O(e,t[r],n);return n}(p||"*",n.nodeType?[n]:n,[]),d=!f||!e&&p?c:Ee(c,a,f,n,r),h=g?y||(e?f:u||m)?[]:t:d;if(g&&g(d,h,n,r),m)for(i=Ee(h,l),m(i,[],n,r),o=i.length;o--;)(s=i[o])&&(h[l[o]]=!(d[l[o]]=s));if(e){if(y||f){if(y){for(i=[],o=h.length;o--;)(s=h[o])&&i.push(d[o]=s);y(null,h=[],i,r)}for(o=h.length;o--;)(s=h[o])&&-1<(i=y?v(e,s):a[o])&&(e[i]=!(t[i]=s))}}else h=Ee(h===t?h.splice(u,h.length):h),y?y(null,t,h,r):_.apply(t,h)})}function we(m,y){function e(e,t,n,r,i){var o,s,a,l=0,u="0",c=e&&[],d=[],h=C,f=e||b&&E.find.TAG("*",i),p=A+=null==h?1:Math.random()||.1,g=f.length;for(i&&(C=t==S||t||i);u!==g&&null!=(o=f[u]);u++){if(b&&o){for(s=0,t||o.ownerDocument==S||(w(o),n=!T);a=m[s++];)if(a(o,t||S,n)){r.push(o);break}i&&(A=p)}v&&((o=!a&&o)&&l--,e)&&c.push(o)}if(l+=u,v&&u!==l){for(s=0;a=y[s++];)a(c,d,t,n);if(e){if(0<l)for(;u--;)c[u]||d[u]||(d[u]=X.call(r));d=Ee(d)}_.apply(r,d),i&&!e&&0<d.length&&1<l+y.length&&O.uniqueSort(r)}return i&&(A=p,C=h),c}var v=0<y.length,b=0<m.length;return v?M(e):e}return ye.prototype=E.filters=E.pseudos,E.setFilters=new ye,f=O.tokenize=function(e,t){var n,r,i,o,s,a,l,u=j[e+" "];if(u)return t?0:u.slice(0);for(s=e,a=[],l=E.preFilter;s;){for(o in n&&!(r=te.exec(s))||(r&&(s=s.slice(r[0].length)||s),a.push(i=[])),n=!1,(r=ne.exec(s))&&(n=r.shift(),i.push({value:n,type:r[0].replace(y," ")}),s=s.slice(n.length)),E.filter)!(r=b[o].exec(s))||l[o]&&!(r=l[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?O.error(e):j(e,a).slice(0)},U=O.compile=function(e,t){var n,r=[],i=[],o=z[e+" "];if(!o){for(n=(t=t||f(e)).length;n--;)((o=function e(t){for(var r,n,i,o=t.length,s=E.relative[t[0].type],a=s||E.relative[" "],l=s?1:0,u=ve(function(e){return e===r},a,!0),c=ve(function(e){return-1<v(r,e)},a,!0),d=[function(e,t,n){return e=!s&&(n||t!==C)||((r=t).nodeType?u:c)(e,t,n),r=null,e}];l<o;l++)if(n=E.relative[t[l].type])d=[ve(be(d),n)];else{if((n=E.filter[t[l].type].apply(null,t[l].matches))[R]){for(i=++l;i<o&&!E.relative[t[i].type];i++);return Ce(1<l&&be(d),1<l&&L(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(y,"$1"),n,l<i&&e(t.slice(l,i)),i<o&&e(t=t.slice(i)),i<o&&L(t))}d.push(n)}return be(d)}(t[n]))[R]?r:i).push(o);(o=z(e,we(i,r))).selector=e}return o},V=O.select=function(e,t,n,r){var i,o,s,a,l,u="function"==typeof e&&e,c=!r&&f(e=u.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(s=o[0]).type&&9===t.nodeType&&T&&E.relative[o[1].type]){if(!(t=(E.find.ID(s.matches[0].replace(x,d),t)||[])[0]))return n;u&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(i=b.needsContext.test(e)?0:o.length;i--&&(s=o[i],!E.relative[a=s.type]);)if((l=E.find[a])&&(r=l(s.matches[0].replace(x,d),ce.test(o[0].type)&&me(t.parentNode)||t))){if(o.splice(i,1),e=r.length&&L(o))break;return _.apply(n,r),n}}return(u||U(e,c))(r,t,!T,n,!t||ce.test(e)&&me(t.parentNode)||t),n},h.sortStable=R.split("").sort(G).join("")===R,h.detectDuplicates=!!u,w(),h.sortDetached=k(function(e){return 1&e.compareDocumentPosition(S.createElement("fieldset"))}),k(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||fe("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),h.attributes&&k(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||fe("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),k(function(e){return null==e.getAttribute("disabled")})||fe(Z,function(e,t,n){if(!n)return!0===e[t]?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),O}(C),q=(S.find=e,S.expr=e.selectors,S.expr[":"]=S.expr.pseudos,S.uniqueSort=S.unique=e.uniqueSort,S.text=e.getText,S.isXMLDoc=e.isXML,S.contains=e.contains,S.escapeSelector=e.escape,S.expr.match.needsContext);function l(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var Z=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Q(e,n,r){return v(n)?S.grep(e,function(e,t){return!!n.call(e,t,e)!==r}):n.nodeType?S.grep(e,function(e){return e===n!==r}):"string"!=typeof n?S.grep(e,function(e){return-1<U.call(n,e)!==r}):S.filter(n,e,r)}S.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?S.find.matchesSelector(r,e)?[r]:[]:S.find.matches(e,S.grep(t,function(e){return 1===e.nodeType}))},S.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(S(e).filter(function(){for(t=0;t<r;t++)if(S.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)S.find(e,i[t],n);return 1<r?S.uniqueSort(n):n},filter:function(e){return this.pushStack(Q(this,e||[],!1))},not:function(e){return this.pushStack(Q(this,e||[],!0))},is:function(e){return!!Q(this,"string"==typeof e&&q.test(e)?S(e):e||[],!1).length}});var J,ee=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,te=((S.fn.init=function(e,t,n){if(e){if(n=n||J,"string"!=typeof e)return e.nodeType?(this[0]=e,this.length=1,this):v(e)?void 0!==n.ready?n.ready(e):e(S):S.makeArray(e,this);if(!(r="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:ee.exec(e))||!r[1]&&t)return(!t||t.jquery?t||n:this.constructor(t)).find(e);if(r[1]){if(t=t instanceof S?t[0]:t,S.merge(this,S.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:w,!0)),Z.test(r[1])&&S.isPlainObject(t))for(var r in t)v(this[r])?this[r](t[r]):this.attr(r,t[r])}else(n=w.getElementById(r[2]))&&(this[0]=n,this.length=1)}return this}).prototype=S.fn,J=S(w),/^(?:parents|prev(?:Until|All))/),ne={children:!0,contents:!0,next:!0,prev:!0};function re(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}S.fn.extend({has:function(e){var t=S(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(S.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],s="string"!=typeof e&&S(e);if(!q.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(s?-1<s.index(n):1===n.nodeType&&S.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?S.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?U.call(S(e),this[0]):U.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),S.each({parent:function(e){e=e.parentNode;return e&&11!==e.nodeType?e:null},parents:function(e){return r(e,"parentNode")},parentsUntil:function(e,t,n){return r(e,"parentNode",n)},next:function(e){return re(e,"nextSibling")},prev:function(e){return re(e,"previousSibling")},nextAll:function(e){return r(e,"nextSibling")},prevAll:function(e){return r(e,"previousSibling")},nextUntil:function(e,t,n){return r(e,"nextSibling",n)},prevUntil:function(e,t,n){return r(e,"previousSibling",n)},siblings:function(e){return K((e.parentNode||{}).firstChild,e)},children:function(e){return K(e.firstChild)},contents:function(e){return null!=e.contentDocument&&F(e.contentDocument)?e.contentDocument:(l(e,"template")&&(e=e.content||e),S.merge([],e.childNodes))}},function(r,i){S.fn[r]=function(e,t){var n=S.map(this,i,e);return(t="Until"!==r.slice(-5)?e:t)&&"string"==typeof t&&(n=S.filter(t,n)),1<this.length&&(ne[r]||S.uniqueSort(n),te.test(r))&&n.reverse(),this.pushStack(n)}});var T=/[^\x20\t\r\n\f]+/g;function c(e){return e}function ie(e){throw e}function oe(e,t,n,r){var i;try{e&&v(i=e.promise)?i.call(e).done(t).fail(n):e&&v(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}S.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},S.each(e.match(T)||[],function(e,t){n[t]=!0}),n):S.extend({},r);function i(){for(a=a||r.once,s=o=!0;u.length;c=-1)for(t=u.shift();++c<l.length;)!1===l[c].apply(t[0],t[1])&&r.stopOnFalse&&(c=l.length,t=!1);r.memory||(t=!1),o=!1,a&&(l=t?[]:"")}var o,t,s,a,l=[],u=[],c=-1,d={add:function(){return l&&(t&&!o&&(c=l.length-1,u.push(t)),function n(e){S.each(e,function(e,t){v(t)?r.unique&&d.has(t)||l.push(t):t&&t.length&&"string"!==p(t)&&n(t)})}(arguments),t)&&!o&&i(),this},remove:function(){return S.each(arguments,function(e,t){for(var n;-1<(n=S.inArray(t,l,n));)l.splice(n,1),n<=c&&c--}),this},has:function(e){return e?-1<S.inArray(e,l):0<l.length},empty:function(){return l=l&&[],this},disable:function(){return a=u=[],l=t="",this},disabled:function(){return!l},lock:function(){return a=u=[],t||o||(l=t=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],u.push(t),o)||i(),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!s}};return d},S.extend({Deferred:function(e){var o=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],i="pending",s={state:function(){return i},always:function(){return a.done(arguments).fail(arguments),this},catch:function(e){return s.then(null,e)},pipe:function(){var i=arguments;return S.Deferred(function(r){S.each(o,function(e,t){var n=v(i[t[4]])&&i[t[4]];a[t[1]](function(){var e=n&&n.apply(this,arguments);e&&v(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this,n?[e]:arguments)})}),i=null}).promise()},then:function(t,n,r){var l=0;function u(i,o,s,a){return function(){function e(){var e,t;if(!(i<l)){if((e=s.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");t=e&&("object"==typeof e||"function"==typeof e)&&e.then,v(t)?a?t.call(e,u(l,o,c,a),u(l,o,ie,a)):(l++,t.call(e,u(l,o,c,a),u(l,o,ie,a),u(l,o,c,o.notifyWith))):(s!==c&&(n=void 0,r=[e]),(a||o.resolveWith)(n,r))}}var n=this,r=arguments,t=a?e:function(){try{e()}catch(e){S.Deferred.exceptionHook&&S.Deferred.exceptionHook(e,t.stackTrace),l<=i+1&&(s!==ie&&(n=void 0,r=[e]),o.rejectWith(n,r))}};i?t():(S.Deferred.getStackHook&&(t.stackTrace=S.Deferred.getStackHook()),C.setTimeout(t))}}return S.Deferred(function(e){o[0][3].add(u(0,e,v(r)?r:c,e.notifyWith)),o[1][3].add(u(0,e,v(t)?t:c)),o[2][3].add(u(0,e,v(n)?n:ie))}).promise()},promise:function(e){return null!=e?S.extend(e,s):s}},a={};return S.each(o,function(e,t){var n=t[2],r=t[5];s[t[1]]=n.add,r&&n.add(function(){i=r},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),n.add(t[3].fire),a[t[0]]=function(){return a[t[0]+"With"](this===a?void 0:this,arguments),this},a[t[0]+"With"]=n.fireWith}),s.promise(a),e&&e.call(a,a),a},when:function(e){function t(t){return function(e){i[t]=this,o[t]=1<arguments.length?a.call(arguments):e,--n||s.resolveWith(i,o)}}var n=arguments.length,r=n,i=Array(r),o=a.call(arguments),s=S.Deferred();if(n<=1&&(oe(e,s.done(t(r)).resolve,s.reject,!n),"pending"===s.state()||v(o[r]&&o[r].then)))return s.then();for(;r--;)oe(o[r],t(r),s.reject);return s.promise()}});var se=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/,ae=(S.Deferred.exceptionHook=function(e,t){C.console&&C.console.warn&&e&&se.test(e.name)&&C.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},S.readyException=function(e){C.setTimeout(function(){throw e})},S.Deferred());function le(){w.removeEventListener("DOMContentLoaded",le),C.removeEventListener("load",le),S.ready()}S.fn.ready=function(e){return ae.then(e).catch(function(e){S.readyException(e)}),this},S.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--S.readyWait:S.isReady)||(S.isReady=!0)!==e&&0<--S.readyWait||ae.resolveWith(w,[S])}}),S.ready.then=ae.then,"complete"===w.readyState||"loading"!==w.readyState&&!w.documentElement.doScroll?C.setTimeout(S.ready):(w.addEventListener("DOMContentLoaded",le),C.addEventListener("load",le));function d(e,t,n,r,i,o,s){var a=0,l=e.length,u=null==n;if("object"===p(n))for(a in i=!0,n)d(e,t,a,n[a],!0,o,s);else if(void 0!==r&&(i=!0,v(r)||(s=!0),t=u?s?(t.call(e,r),null):(u=t,function(e,t,n){return u.call(S(e),n)}):t))for(;a<l;a++)t(e[a],n,s?r:r.call(e[a],a,t(e[a],n)));return i?e:u?t.call(e):l?t(e[0],n):o}var ue=/^-ms-/,ce=/-([a-z])/g;function de(e,t){return t.toUpperCase()}function b(e){return e.replace(ue,"ms-").replace(ce,de)}function y(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType}function he(){this.expando=S.expando+he.uid++}he.uid=1,he.prototype={cache:function(e){var t=e[this.expando];return t||(t={},y(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[b(t)]=n;else for(r in t)i[b(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][b(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(b):(t=b(t))in r?[t]:t.match(T)||[]).length;for(;n--;)delete r[t[n]]}void 0!==t&&!S.isEmptyObject(r)||(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){e=e[this.expando];return void 0!==e&&!S.isEmptyObject(e)}};var E=new he,u=new he,fe=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,pe=/[A-Z]/g;function ge(e,t,n){var r,i;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(pe,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:fe.test(i)?JSON.parse(i):i)}catch(e){}u.set(e,t,n)}else n=void 0;return n}S.extend({hasData:function(e){return u.hasData(e)||E.hasData(e)},data:function(e,t,n){return u.access(e,t,n)},removeData:function(e,t){u.remove(e,t)},_data:function(e,t,n){return E.access(e,t,n)},_removeData:function(e,t){E.remove(e,t)}}),S.fn.extend({data:function(n,e){var t,r,i,o=this[0],s=o&&o.attributes;if(void 0!==n)return"object"==typeof n?this.each(function(){u.set(this,n)}):d(this,function(e){var t;if(o&&void 0===e)return void 0!==(t=u.get(o,n))||void 0!==(t=ge(o,n))?t:void 0;this.each(function(){u.set(this,n,e)})},null,e,1<arguments.length,null,!0);if(this.length&&(i=u.get(o),1===o.nodeType)&&!E.get(o,"hasDataAttrs")){for(t=s.length;t--;)s[t]&&0===(r=s[t].name).indexOf("data-")&&(r=b(r.slice(5)),ge(o,r,i[r]));E.set(o,"hasDataAttrs",!0)}return i},removeData:function(e){return this.each(function(){u.remove(this,e)})}}),S.extend({queue:function(e,t,n){var r;if(e)return r=E.get(e,t=(t||"fx")+"queue"),n&&(!r||Array.isArray(n)?r=E.access(e,t,S.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=S.queue(e,t),r=n.length,i=n.shift(),o=S._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){S.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return E.get(e,n)||E.access(e,n,{empty:S.Callbacks("once memory").add(function(){E.remove(e,[t+"queue",n])})})}}),S.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?S.queue(this[0],t):void 0===n?this:this.each(function(){var e=S.queue(this,t,n);S._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&S.dequeue(this,t)})},dequeue:function(e){return this.each(function(){S.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){function n(){--i||o.resolveWith(s,[s])}var r,i=1,o=S.Deferred(),s=this,a=this.length;for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)(r=E.get(s[a],e+"queueHooks"))&&r.empty&&(i++,r.empty.add(n));return n(),o.promise(t)}});function me(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&A(e)&&"none"===S.css(e,"display")}var e=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ye=new RegExp("^(?:([+-])=|)("+e+")([a-z%]*)$","i"),h=["Top","Right","Bottom","Left"],R=w.documentElement,A=function(e){return S.contains(e.ownerDocument,e)},ve={composed:!0};R.getRootNode&&(A=function(e){return S.contains(e.ownerDocument,e)||e.getRootNode(ve)===e.ownerDocument});function be(e,t,n,r){var i,o,s=20,a=r?function(){return r.cur()}:function(){return S.css(e,t,"")},l=a(),u=n&&n[3]||(S.cssNumber[t]?"":"px"),c=e.nodeType&&(S.cssNumber[t]||"px"!==u&&+l)&&ye.exec(S.css(e,t));if(c&&c[3]!==u){for(u=u||c[3],c=+(l/=2)||1;s--;)S.style(e,t,c+u),(1-o)*(1-(o=a()/l||.5))<=0&&(s=0),c/=o;S.style(e,t,(c*=2)+u),n=n||[]}return n&&(c=+c||+l||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r)&&(r.unit=u,r.start=c,r.end=i),i}var Ee={};function _(e,t){for(var n,r,i,o,s,a=[],l=0,u=e.length;l<u;l++)(r=e[l]).style&&(n=r.style.display,t?("none"===n&&(a[l]=E.get(r,"display")||null,a[l]||(r.style.display="")),""===r.style.display&&me(r)&&(a[l]=(s=o=void 0,o=(i=r).ownerDocument,i=i.nodeName,(s=Ee[i])||(o=o.body.appendChild(o.createElement(i)),s=S.css(o,"display"),o.parentNode.removeChild(o),Ee[i]=s="none"===s?"block":s),s))):"none"!==n&&(a[l]="none",E.set(r,"display",n)));for(l=0;l<u;l++)null!=a[l]&&(e[l].style.display=a[l]);return e}S.fn.extend({show:function(){return _(this,!0)},hide:function(){return _(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){me(this)?S(this).show():S(this).hide()})}});var Ce=/^(?:checkbox|radio)$/i,we=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Se=/^$|^module$|\/(?:java|ecma)script/i,N=(M=w.createDocumentFragment().appendChild(w.createElement("div")),(s=w.createElement("input")).setAttribute("type","radio"),s.setAttribute("checked","checked"),s.setAttribute("name","t"),M.appendChild(s),m.checkClone=M.cloneNode(!0).cloneNode(!0).lastChild.checked,M.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!M.cloneNode(!0).lastChild.defaultValue,M.innerHTML="<option></option>",m.option=!!M.lastChild,{thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]});function x(e,t){var n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&l(e,t)?S.merge([e],n):n}function Te(e,t){for(var n=0,r=e.length;n<r;n++)E.set(e[n],"globalEval",!t||E.get(t[n],"globalEval"))}N.tbody=N.tfoot=N.colgroup=N.caption=N.thead,N.th=N.td,m.option||(N.optgroup=N.option=[1,"<select multiple='multiple'>","</select>"]);var Re=/<|&#?\w+;/;function Ae(e,t,n,r,i){for(var o,s,a,l,u,c=t.createDocumentFragment(),d=[],h=0,f=e.length;h<f;h++)if((o=e[h])||0===o)if("object"===p(o))S.merge(d,o.nodeType?[o]:o);else if(Re.test(o)){for(s=s||c.appendChild(t.createElement("div")),a=(we.exec(o)||["",""])[1].toLowerCase(),a=N[a]||N._default,s.innerHTML=a[1]+S.htmlPrefilter(o)+a[2],u=a[0];u--;)s=s.lastChild;S.merge(d,s.childNodes),(s=c.firstChild).textContent=""}else d.push(t.createTextNode(o));for(c.textContent="",h=0;o=d[h++];)if(r&&-1<S.inArray(o,r))i&&i.push(o);else if(l=A(o),s=x(c.appendChild(o),"script"),l&&Te(s),n)for(u=0;o=s[u++];)Se.test(o.type||"")&&n.push(o);return c}var _e=/^([^.]*)(?:\.(.+)|)/;function n(){return!0}function f(){return!1}function Ne(e,t){return e===function(){try{return w.activeElement}catch(e){}}()==("focus"===t)}function xe(e,t,n,r,i,o){var s,a;if("object"==typeof t){for(a in"string"!=typeof n&&(r=r||n,n=void 0),t)xe(e,a,n,r,t[a],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=f;else if(!i)return e;return 1===o&&(s=i,(i=function(e){return S().off(e),s.apply(this,arguments)}).guid=s.guid||(s.guid=S.guid++)),e.each(function(){S.event.add(this,t,i,r,n)})}function Oe(e,i,o){o?(E.set(e,i,!1),S.event.add(e,i,{namespace:!1,handler:function(e){var t,n,r=E.get(this,i);if(1&e.isTrigger&&this[i]){if(r.length)(S.event.special[i]||{}).delegateType&&e.stopPropagation();else if(r=a.call(arguments),E.set(this,i,r),t=o(this,i),this[i](),r!==(n=E.get(this,i))||t?E.set(this,i,!1):n={},r!==n)return e.stopImmediatePropagation(),e.preventDefault(),n&&n.value}else r.length&&(E.set(this,i,{value:S.event.trigger(S.extend(r[0],S.Event.prototype),r.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===E.get(e,i)&&S.event.add(e,i,n)}S.event={global:{},add:function(t,e,n,r,i){var o,s,a,l,u,c,d,h,f,p=E.get(t);if(y(t))for(n.handler&&(n=(o=n).handler,i=o.selector),i&&S.find.matchesSelector(R,i),n.guid||(n.guid=S.guid++),a=(a=p.events)||(p.events=Object.create(null)),s=(s=p.handle)||(p.handle=function(e){return void 0!==S&&S.event.triggered!==e.type?S.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(T)||[""]).length;l--;)d=f=(h=_e.exec(e[l])||[])[1],h=(h[2]||"").split(".").sort(),d&&(u=S.event.special[d]||{},d=(i?u.delegateType:u.bindType)||d,u=S.event.special[d]||{},f=S.extend({type:d,origType:f,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&S.expr.match.needsContext.test(i),namespace:h.join(".")},o),(c=a[d])||((c=a[d]=[]).delegateCount=0,u.setup&&!1!==u.setup.call(t,r,h,s))||t.addEventListener&&t.addEventListener(d,s),u.add&&(u.add.call(t,f),f.handler.guid||(f.handler.guid=n.guid)),i?c.splice(c.delegateCount++,0,f):c.push(f),S.event.global[d]=!0)},remove:function(e,t,n,r,i){var o,s,a,l,u,c,d,h,f,p,g,m=E.hasData(e)&&E.get(e);if(m&&(l=m.events)){for(u=(t=(t||"").match(T)||[""]).length;u--;)if(f=g=(a=_e.exec(t[u])||[])[1],p=(a[2]||"").split(".").sort(),f){for(d=S.event.special[f]||{},h=l[f=(r?d.delegateType:d.bindType)||f]||[],a=a[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=h.length;o--;)c=h[o],!i&&g!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(h.splice(o,1),c.selector&&h.delegateCount--,d.remove&&d.remove.call(e,c));s&&!h.length&&(d.teardown&&!1!==d.teardown.call(e,p,m.handle)||S.removeEvent(e,f,m.handle),delete l[f])}else for(f in l)S.event.remove(e,f+t[u],n,r,!0);S.isEmptyObject(l)&&E.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,s=new Array(arguments.length),a=S.event.fix(e),e=(E.get(this,"events")||Object.create(null))[a.type]||[],l=S.event.special[a.type]||{};for(s[0]=a,t=1;t<arguments.length;t++)s[t]=arguments[t];if(a.delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,a)){for(o=S.event.handlers.call(this,a,e),t=0;(r=o[t++])&&!a.isPropagationStopped();)for(a.currentTarget=r.elem,n=0;(i=r.handlers[n++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!1!==i.namespace&&!a.rnamespace.test(i.namespace)||(a.handleObj=i,a.data=i.data,void 0!==(i=((S.event.special[i.origType]||{}).handle||i.handler).apply(r.elem,s))&&!1===(a.result=i)&&(a.preventDefault(),a.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,a),a.result}},handlers:function(e,t){var n,r,i,o,s,a=[],l=t.delegateCount,u=e.target;if(l&&u.nodeType&&!("click"===e.type&&1<=e.button))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==e.type||!0!==u.disabled)){for(o=[],s={},n=0;n<l;n++)void 0===s[i=(r=t[n]).selector+" "]&&(s[i]=r.needsContext?-1<S(i,this).index(u):S.find(i,this,null,[u]).length),s[i]&&o.push(r);o.length&&a.push({elem:u,handlers:o})}return u=this,l<t.length&&a.push({elem:u,handlers:t.slice(l)}),a},addProp:function(t,e){Object.defineProperty(S.Event.prototype,t,{enumerable:!0,configurable:!0,get:v(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[S.expando]?e:new S.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){e=this||e;return Ce.test(e.type)&&e.click&&l(e,"input")&&Oe(e,"click",n),!1},trigger:function(e){e=this||e;return Ce.test(e.type)&&e.click&&l(e,"input")&&Oe(e,"click"),!0},_default:function(e){e=e.target;return Ce.test(e.type)&&e.click&&l(e,"input")&&E.get(e,"click")||l(e,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},S.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},S.Event=function(e,t){if(!(this instanceof S.Event))return new S.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?n:f,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&S.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[S.expando]=!0},S.Event.prototype={constructor:S.Event,isDefaultPrevented:f,isPropagationStopped:f,isImmediatePropagationStopped:f,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=n,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=n,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=n,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},S.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},S.event.addProp),S.each({focus:"focusin",blur:"focusout"},function(e,t){S.event.special[e]={setup:function(){return Oe(this,e,Ne),!1},trigger:function(){return Oe(this,e),!0},_default:function(){return!0},delegateType:t}}),S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){S.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||S.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}}),S.fn.extend({on:function(e,t,n,r){return xe(this,e,t,n,r)},one:function(e,t,n,r){return xe(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)r=e.handleObj,S(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler);else{if("object"!=typeof e)return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=f),this.each(function(){S.event.remove(this,e,n,t)});for(i in e)this.off(i,t,e[i])}return this}});var Ie=/<script|<style|<link/i,Me=/checked\s*(?:[^=]|=\s*.checked.)/i,ke=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function De(e,t){return l(e,"table")&&l(11!==t.nodeType?t:t.firstChild,"tr")&&S(e).children("tbody")[0]||e}function Le(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Pe(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Fe(e,t){var n,r,i,o;if(1===t.nodeType){if(E.hasData(e)&&(o=E.get(e).events))for(i in E.remove(t,"handle events"),o)for(n=0,r=o[i].length;n<r;n++)S.event.add(t,i,o[i][n]);u.hasData(e)&&(e=u.access(e),e=S.extend({},e),u.set(t,e))}}function O(n,r,i,o){r=B(r);var e,t,s,a,l,u,c=0,d=n.length,h=d-1,f=r[0],p=v(f);if(p||1<d&&"string"==typeof f&&!m.checkClone&&Me.test(f))return n.each(function(e){var t=n.eq(e);p&&(r[0]=f.call(this,e,t.html())),O(t,r,i,o)});if(d&&(t=(e=Ae(r,n[0].ownerDocument,!1,n,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(a=(s=S.map(x(e,"script"),Le)).length;c<d;c++)l=e,c!==h&&(l=S.clone(l,!0,!0),a)&&S.merge(s,x(l,"script")),i.call(n[c],l,c);if(a)for(u=s[s.length-1].ownerDocument,S.map(s,Pe),c=0;c<a;c++)l=s[c],Se.test(l.type||"")&&!E.access(l,"globalEval")&&S.contains(u,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?S._evalUrl&&!l.noModule&&S._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")},u):Y(l.textContent.replace(ke,""),l,u))}return n}function Be(e,t,n){for(var r,i=t?S.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||S.cleanData(x(r)),r.parentNode&&(n&&A(r)&&Te(x(r,"script")),r.parentNode.removeChild(r));return e}S.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,s,a,l,u,c=e.cloneNode(!0),d=A(e);if(!(m.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||S.isXMLDoc(e)))for(s=x(c),r=0,i=(o=x(e)).length;r<i;r++)a=o[r],l=s[r],u=void 0,"input"===(u=l.nodeName.toLowerCase())&&Ce.test(a.type)?l.checked=a.checked:"input"!==u&&"textarea"!==u||(l.defaultValue=a.defaultValue);if(t)if(n)for(o=o||x(e),s=s||x(c),r=0,i=o.length;r<i;r++)Fe(o[r],s[r]);else Fe(e,c);return 0<(s=x(c,"script")).length&&Te(s,!d&&x(e,"script")),c},cleanData:function(e){for(var t,n,r,i=S.event.special,o=0;void 0!==(n=e[o]);o++)if(y(n)){if(t=n[E.expando]){if(t.events)for(r in t.events)i[r]?S.event.remove(n,r):S.removeEvent(n,r,t.handle);n[E.expando]=void 0}n[u.expando]&&(n[u.expando]=void 0)}}}),S.fn.extend({detach:function(e){return Be(this,e,!0)},remove:function(e){return Be(this,e)},text:function(e){return d(this,function(e){return void 0===e?S.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return O(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||De(this,e).appendChild(e)})},prepend:function(){return O(this,arguments,function(e){var t;1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(t=De(this,e)).insertBefore(e,t.firstChild)})},before:function(){return O(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return O(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(S.cleanData(x(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return S.clone(this,e,t)})},html:function(e){return d(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ie.test(e)&&!N[(we.exec(e)||["",""])[1].toLowerCase()]){e=S.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(S.cleanData(x(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return O(this,arguments,function(e){var t=this.parentNode;S.inArray(this,n)<0&&(S.cleanData(x(this)),t)&&t.replaceChild(e,this)},n)}}),S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,s){S.fn[e]=function(e){for(var t,n=[],r=S(e),i=r.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),S(r[o])[s](t),H.apply(n,t.get());return this.pushStack(n)}});function He(e){var t=e.ownerDocument.defaultView;return(t=t&&t.opener?t:C).getComputedStyle(e)}function Ue(e,t,n){var r,i={};for(r in t)i[r]=e.style[r],e.style[r]=t[r];for(r in n=n.call(e),t)e.style[r]=i[r];return n}var Ve,We,$e,je,ze,Ge,Ye,i,Xe=new RegExp("^("+e+")(?!px)[a-z%]+$","i"),Ke=new RegExp(h.join("|"),"i");function qe(){var e;i&&(Ye.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",i.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",R.appendChild(Ye).appendChild(i),e=C.getComputedStyle(i),Ve="1%"!==e.top,Ge=12===Ze(e.marginLeft),i.style.right="60%",je=36===Ze(e.right),We=36===Ze(e.width),i.style.position="absolute",$e=12===Ze(i.offsetWidth/3),R.removeChild(Ye),i=null)}function Ze(e){return Math.round(parseFloat(e))}function Qe(e,t,n){var r,i,o=e.style;return(n=n||He(e))&&(""!==(i=n.getPropertyValue(t)||n[t])||A(e)||(i=S.style(e,t)),!m.pixelBoxStyles())&&Xe.test(i)&&Ke.test(t)&&(e=o.width,t=o.minWidth,r=o.maxWidth,o.minWidth=o.maxWidth=o.width=i,i=n.width,o.width=e,o.minWidth=t,o.maxWidth=r),void 0!==i?i+"":i}function Je(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}Ye=w.createElement("div"),(i=w.createElement("div")).style&&(i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle="content-box"===i.style.backgroundClip,S.extend(m,{boxSizingReliable:function(){return qe(),We},pixelBoxStyles:function(){return qe(),je},pixelPosition:function(){return qe(),Ve},reliableMarginLeft:function(){return qe(),Ge},scrollboxSize:function(){return qe(),$e},reliableTrDimensions:function(){var e,t,n;return null==ze&&(e=w.createElement("table"),t=w.createElement("tr"),n=w.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",R.appendChild(e).appendChild(t).appendChild(n),n=C.getComputedStyle(t),ze=parseInt(n.height,10)+parseInt(n.borderTopWidth,10)+parseInt(n.borderBottomWidth,10)===t.offsetHeight,R.removeChild(e)),ze}}));var et=["Webkit","Moz","ms"],tt=w.createElement("div").style,nt={};function rt(e){var t=S.cssProps[e]||nt[e];return t||(e in tt?e:nt[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=et.length;n--;)if((e=et[n]+t)in tt)return e}(e)||e)}var it=/^(none|table(?!-c[ea]).+)/,ot=/^--/,st={position:"absolute",visibility:"hidden",display:"block"},at={letterSpacing:"0",fontWeight:"400"};function lt(e,t,n){var r=ye.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function ut(e,t,n,r,i,o){var s="width"===t?1:0,a=0,l=0;if(n===(r?"border":"content"))return 0;for(;s<4;s+=2)"margin"===n&&(l+=S.css(e,n+h[s],!0,i)),r?("content"===n&&(l-=S.css(e,"padding"+h[s],!0,i)),"margin"!==n&&(l-=S.css(e,"border"+h[s]+"Width",!0,i))):(l+=S.css(e,"padding"+h[s],!0,i),"padding"!==n?l+=S.css(e,"border"+h[s]+"Width",!0,i):a+=S.css(e,"border"+h[s]+"Width",!0,i));return!r&&0<=o&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-l-a-.5))||0),l}function ct(e,t,n){var r=He(e),i=(!m.boxSizingReliable()||n)&&"border-box"===S.css(e,"boxSizing",!1,r),o=i,s=Qe(e,t,r),a="offset"+t[0].toUpperCase()+t.slice(1);if(Xe.test(s)){if(!n)return s;s="auto"}return(!m.boxSizingReliable()&&i||!m.reliableTrDimensions()&&l(e,"tr")||"auto"===s||!parseFloat(s)&&"inline"===S.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===S.css(e,"boxSizing",!1,r),o=a in e)&&(s=e[a]),(s=parseFloat(s)||0)+ut(e,t,n||(i?"border":"content"),o,r,s)+"px"}function o(e,t,n,r,i){return new o.prototype.init(e,t,n,r,i)}S.extend({cssHooks:{opacity:{get:function(e,t){if(t)return""===(t=Qe(e,"opacity"))?"1":t}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,s,a=b(t),l=ot.test(t),u=e.style;if(l||(t=rt(a)),s=S.cssHooks[t]||S.cssHooks[a],void 0===n)return s&&"get"in s&&void 0!==(i=s.get(e,!1,r))?i:u[t];"string"===(o=typeof n)&&(i=ye.exec(n))&&i[1]&&(n=be(e,t,i),o="number"),null==n||n!=n||("number"!==o||l||(n+=i&&i[3]||(S.cssNumber[a]?"":"px")),m.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),s&&"set"in s&&void 0===(n=s.set(e,n,r)))||(l?u.setProperty(t,n):u[t]=n)}},css:function(e,t,n,r){var i,o=b(t);return ot.test(t)||(t=rt(o)),"normal"===(i=void 0===(i=(o=S.cssHooks[t]||S.cssHooks[o])&&"get"in o?o.get(e,!0,n):i)?Qe(e,t,r):i)&&t in at&&(i=at[t]),(""===n||n)&&(o=parseFloat(i),!0===n||isFinite(o))?o||0:i}}),S.each(["height","width"],function(e,s){S.cssHooks[s]={get:function(e,t,n){if(t)return!it.test(S.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?ct(e,s,n):Ue(e,st,function(){return ct(e,s,n)})},set:function(e,t,n){var r=He(e),i=!m.scrollboxSize()&&"absolute"===r.position,o=(i||n)&&"border-box"===S.css(e,"boxSizing",!1,r),n=n?ut(e,s,n,o,r):0;return o&&i&&(n-=Math.ceil(e["offset"+s[0].toUpperCase()+s.slice(1)]-parseFloat(r[s])-ut(e,s,"border",!1,r)-.5)),n&&(o=ye.exec(t))&&"px"!==(o[3]||"px")&&(e.style[s]=t,t=S.css(e,s)),lt(0,t,n)}}}),S.cssHooks.marginLeft=Je(m.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Qe(e,"marginLeft"))||e.getBoundingClientRect().left-Ue(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),S.each({margin:"",padding:"",border:"Width"},function(i,o){S.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+h[t]+o]=r[t]||r[t-2]||r[0];return n}},"margin"!==i&&(S.cssHooks[i+o].set=lt)}),S.fn.extend({css:function(e,t){return d(this,function(e,t,n){var r,i,o={},s=0;if(Array.isArray(t)){for(r=He(e),i=t.length;s<i;s++)o[t[s]]=S.css(e,t[s],!1,r);return o}return void 0!==n?S.style(e,t,n):S.css(e,t)},e,t,1<arguments.length)}}),((S.Tween=o).prototype={constructor:o,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||S.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(S.cssNumber[n]?"":"px")},cur:function(){var e=o.propHooks[this.prop];return(e&&e.get?e:o.propHooks._default).get(this)},run:function(e){var t,n=o.propHooks[this.prop];return this.options.duration?this.pos=t=S.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),(n&&n.set?n:o.propHooks._default).set(this),this}}).init.prototype=o.prototype,(o.propHooks={_default:{get:function(e){return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(e=S.css(e.elem,e.prop,""))&&"auto"!==e?e:0},set:function(e){S.fx.step[e.prop]?S.fx.step[e.prop](e):1!==e.elem.nodeType||!S.cssHooks[e.prop]&&null==e.elem.style[rt(e.prop)]?e.elem[e.prop]=e.now:S.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=o.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},S.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},S.fx=o.prototype.init,S.fx.step={};var I,dt,s,M,ht=/^(?:toggle|show|hide)$/,ft=/queueHooks$/;function pt(){dt&&(!1===w.hidden&&C.requestAnimationFrame?C.requestAnimationFrame(pt):C.setTimeout(pt,S.fx.interval),S.fx.tick())}function gt(){return C.setTimeout(function(){I=void 0}),I=Date.now()}function mt(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=h[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function yt(e,t,n){for(var r,i=(k.tweeners[t]||[]).concat(k.tweeners["*"]),o=0,s=i.length;o<s;o++)if(r=i[o].call(n,t,e))return r}function k(i,e,t){var n,o,r,s,a,l,u,c=0,d=k.prefilters.length,h=S.Deferred().always(function(){delete f.elem}),f=function(){if(!o){for(var e=I||gt(),e=Math.max(0,p.startTime+p.duration-e),t=1-(e/p.duration||0),n=0,r=p.tweens.length;n<r;n++)p.tweens[n].run(t);if(h.notifyWith(i,[p,t,e]),t<1&&r)return e;r||h.notifyWith(i,[p,1,0]),h.resolveWith(i,[p])}return!1},p=h.promise({elem:i,props:S.extend({},e),opts:S.extend(!0,{specialEasing:{},easing:S.easing._default},t),originalProperties:e,originalOptions:t,startTime:I||gt(),duration:t.duration,tweens:[],createTween:function(e,t){t=S.Tween(i,p.opts,e,t,p.opts.specialEasing[e]||p.opts.easing);return p.tweens.push(t),t},stop:function(e){var t=0,n=e?p.tweens.length:0;if(!o){for(o=!0;t<n;t++)p.tweens[t].run(1);e?(h.notifyWith(i,[p,1,0]),h.resolveWith(i,[p,e])):h.rejectWith(i,[p,e])}return this}}),g=p.props,m=g,y=p.opts.specialEasing;for(r in m)if(a=y[s=b(r)],l=m[r],Array.isArray(l)&&(a=l[1],l=m[r]=l[0]),r!==s&&(m[s]=l,delete m[r]),(u=S.cssHooks[s])&&"expand"in u)for(r in l=u.expand(l),delete m[s],l)r in m||(m[r]=l[r],y[r]=a);else y[s]=a;for(;c<d;c++)if(n=k.prefilters[c].call(p,i,g,p.opts))return v(n.stop)&&(S._queueHooks(p.elem,p.opts.queue).stop=n.stop.bind(n)),n;return S.map(g,yt,p),v(p.opts.start)&&p.opts.start.call(i,p),p.progress(p.opts.progress).done(p.opts.done,p.opts.complete).fail(p.opts.fail).always(p.opts.always),S.fx.timer(S.extend(f,{elem:i,anim:p,queue:p.opts.queue})),p}S.Animation=S.extend(k,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return be(n.elem,e,ye.exec(t),n),n}]},tweener:function(e,t){for(var n,r=0,i=(e=v(e)?(t=e,["*"]):e.match(T)).length;r<i;r++)n=e[r],k.tweeners[n]=k.tweeners[n]||[],k.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,s,a,l,u,c="width"in t||"height"in t,d=this,h={},f=e.style,p=e.nodeType&&me(e),g=E.get(e,"fxshow");for(r in n.queue||(null==(s=S._queueHooks(e,"fx")).unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,d.always(function(){d.always(function(){s.unqueued--,S.queue(e,"fx").length||s.empty.fire()})})),t)if(i=t[r],ht.test(i)){if(delete t[r],o=o||"toggle"===i,i===(p?"hide":"show")){if("show"!==i||!g||void 0===g[r])continue;p=!0}h[r]=g&&g[r]||S.style(e,r)}if((l=!S.isEmptyObject(t))||!S.isEmptyObject(h))for(r in c&&1===e.nodeType&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],null==(u=g&&g.display)&&(u=E.get(e,"display")),"none"===(c=S.css(e,"display"))&&(u?c=u:(_([e],!0),u=e.style.display||u,c=S.css(e,"display"),_([e]))),"inline"===c||"inline-block"===c&&null!=u)&&"none"===S.css(e,"float")&&(l||(d.done(function(){f.display=u}),null==u&&(c=f.display,u="none"===c?"":c)),f.display="inline-block"),n.overflow&&(f.overflow="hidden",d.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]})),l=!1,h)l||(g?"hidden"in g&&(p=g.hidden):g=E.access(e,"fxshow",{display:u}),o&&(g.hidden=!p),p&&_([e],!0),d.done(function(){for(r in p||_([e]),E.remove(e,"fxshow"),h)S.style(e,r,h[r])})),l=yt(p?g[r]:0,r,d),r in g||(g[r]=l.start,p&&(l.end=l.start,l.start=0))}],prefilter:function(e,t){t?k.prefilters.unshift(e):k.prefilters.push(e)}}),S.speed=function(e,t,n){var r=e&&"object"==typeof e?S.extend({},e):{complete:n||!n&&t||v(e)&&e,duration:e,easing:n&&t||t&&!v(t)&&t};return S.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in S.fx.speeds?r.duration=S.fx.speeds[r.duration]:r.duration=S.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){v(r.old)&&r.old.call(this),r.queue&&S.dequeue(this,r.queue)},r},S.fn.extend({fadeTo:function(e,t,n,r){return this.filter(me).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){function i(){var e=k(this,S.extend({},t),s);(o||E.get(this,"finish"))&&e.stop(!0)}var o=S.isEmptyObject(t),s=S.speed(e,n,r);return i.finish=i,o||!1===s.queue?this.each(i):this.queue(s.queue,i)},stop:function(i,e,o){function s(e){var t=e.stop;delete e.stop,t(o)}return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=S.timers,r=E.get(this);if(t)r[t]&&r[t].stop&&s(r[t]);else for(t in r)r[t]&&r[t].stop&&ft.test(t)&&s(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||S.dequeue(this,i)})},finish:function(s){return!1!==s&&(s=s||"fx"),this.each(function(){var e,t=E.get(this),n=t[s+"queue"],r=t[s+"queueHooks"],i=S.timers,o=n?n.length:0;for(t.finish=!0,S.queue(this,s,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===s&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),S.each(["toggle","show","hide"],function(e,r){var i=S.fn[r];S.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(mt(r,!0),e,t,n)}}),S.each({slideDown:mt("show"),slideUp:mt("hide"),slideToggle:mt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){S.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),S.timers=[],S.fx.tick=function(){var e,t=0,n=S.timers;for(I=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||S.fx.stop(),I=void 0},S.fx.timer=function(e){S.timers.push(e),S.fx.start()},S.fx.interval=13,S.fx.start=function(){dt||(dt=!0,pt())},S.fx.stop=function(){dt=null},S.fx.speeds={slow:600,fast:200,_default:400},S.fn.delay=function(r,e){return r=S.fx&&S.fx.speeds[r]||r,this.queue(e=e||"fx",function(e,t){var n=C.setTimeout(e,r);t.stop=function(){C.clearTimeout(n)}})},s=w.createElement("input"),M=w.createElement("select").appendChild(w.createElement("option")),s.type="checkbox",m.checkOn=""!==s.value,m.optSelected=M.selected,(s=w.createElement("input")).value="t",s.type="radio",m.radioValue="t"===s.value;var vt,bt=S.expr.attrHandle,Et=(S.fn.extend({attr:function(e,t){return d(this,S.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){S.removeAttr(this,e)})}}),S.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?S.prop(e,t,n):(1===o&&S.isXMLDoc(e)||(i=S.attrHooks[t.toLowerCase()]||(S.expr.match.bool.test(t)?vt:void 0)),void 0!==n?null===n?void S.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):!(i&&"get"in i&&null!==(r=i.get(e,t)))&&null==(r=S.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){var n;if(!m.radioValue&&"radio"===t&&l(e,"input"))return n=e.value,e.setAttribute("type",t),n&&(e.value=n),t}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(T);if(i&&1===e.nodeType)for(;n=i[r++];)e.removeAttribute(n)}}),vt={set:function(e,t,n){return!1===t?S.removeAttr(e,n):e.setAttribute(n,n),n}},S.each(S.expr.match.bool.source.match(/\w+/g),function(e,t){var s=bt[t]||S.find.attr;bt[t]=function(e,t,n){var r,i,o=t.toLowerCase();return n||(i=bt[o],bt[o]=r,r=null!=s(e,t,n)?o:null,bt[o]=i),r}}),/^(?:input|select|textarea|button)$/i),Ct=/^(?:a|area)$/i;function D(e){return(e.match(T)||[]).join(" ")}function L(e){return e.getAttribute&&e.getAttribute("class")||""}function wt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(T)||[]}S.fn.extend({prop:function(e,t){return d(this,S.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[S.propFix[e]||e]})}}),S.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&S.isXMLDoc(e)||(t=S.propFix[t]||t,i=S.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=S.find.attr(e,"tabindex");return t?parseInt(t,10):Et.test(e.nodeName)||Ct.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(S.propHooks.selected={get:function(e){e=e.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(e){e=e.parentNode;e&&(e.selectedIndex,e.parentNode)&&e.parentNode.selectedIndex}}),S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){S.propFix[this.toLowerCase()]=this}),S.fn.extend({addClass:function(t){var e,n,r,i,o,s,a=0;if(v(t))return this.each(function(e){S(this).addClass(t.call(this,e,L(this)))});if((e=wt(t)).length)for(;n=this[a++];)if(s=L(n),r=1===n.nodeType&&" "+D(s)+" "){for(o=0;i=e[o++];)r.indexOf(" "+i+" ")<0&&(r+=i+" ");s!==(s=D(r))&&n.setAttribute("class",s)}return this},removeClass:function(t){var e,n,r,i,o,s,a=0;if(v(t))return this.each(function(e){S(this).removeClass(t.call(this,e,L(this)))});if(!arguments.length)return this.attr("class","");if((e=wt(t)).length)for(;n=this[a++];)if(s=L(n),r=1===n.nodeType&&" "+D(s)+" "){for(o=0;i=e[o++];)for(;-1<r.indexOf(" "+i+" ");)r=r.replace(" "+i+" "," ");s!==(s=D(r))&&n.setAttribute("class",s)}return this},toggleClass:function(i,t){var o=typeof i,s="string"==o||Array.isArray(i);return"boolean"==typeof t&&s?t?this.addClass(i):this.removeClass(i):v(i)?this.each(function(e){S(this).toggleClass(i.call(this,e,L(this),t),t)}):this.each(function(){var e,t,n,r;if(s)for(t=0,n=S(this),r=wt(i);e=r[t++];)n.hasClass(e)?n.removeClass(e):n.addClass(e);else void 0!==i&&"boolean"!=o||((e=L(this))&&E.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",!e&&!1!==i&&E.get(this,"__className__")||""))})},hasClass:function(e){for(var t,n=0,r=" "+e+" ";t=this[n++];)if(1===t.nodeType&&-1<(" "+D(L(t))+" ").indexOf(r))return!0;return!1}});function St(e){e.stopPropagation()}var Tt=/\r/g,Rt=(S.fn.extend({val:function(t){var n,e,r,i=this[0];return arguments.length?(r=v(t),this.each(function(e){1!==this.nodeType||(null==(e=r?t.call(this,e,S(this).val()):t)?e="":"number"==typeof e?e+="":Array.isArray(e)&&(e=S.map(e,function(e){return null==e?"":e+""})),(n=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()])&&"set"in n&&void 0!==n.set(this,e,"value"))||(this.value=e)})):i?(n=S.valHooks[i.type]||S.valHooks[i.nodeName.toLowerCase()])&&"get"in n&&void 0!==(e=n.get(i,"value"))?e:"string"==typeof(e=i.value)?e.replace(Tt,""):null==e?"":e:void 0}}),S.extend({valHooks:{option:{get:function(e){var t=S.find.attr(e,"value");return null!=t?t:D(S.text(e))}},select:{get:function(e){for(var t,n=e.options,r=e.selectedIndex,i="select-one"===e.type,o=i?null:[],s=i?r+1:n.length,a=r<0?s:i?r:0;a<s;a++)if(((t=n[a]).selected||a===r)&&!t.disabled&&(!t.parentNode.disabled||!l(t.parentNode,"optgroup"))){if(t=S(t).val(),i)return t;o.push(t)}return o},set:function(e,t){for(var n,r,i=e.options,o=S.makeArray(t),s=i.length;s--;)((r=i[s]).selected=-1<S.inArray(S.valHooks.option.get(r),o))&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),S.each(["radio","checkbox"],function(){S.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<S.inArray(S(e).val(),t)}},m.checkOn||(S.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),m.focusin="onfocusin"in C,/^(?:focusinfocus|focusoutblur)$/),At=(S.extend(S.event,{trigger:function(e,t,n,r){var i,o,s,a,l,u,c,d=[n||w],h=$.call(e,"type")?e.type:e,f=$.call(e,"namespace")?e.namespace.split("."):[],p=c=o=n=n||w;if(3!==n.nodeType&&8!==n.nodeType&&!Rt.test(h+S.event.triggered)&&(-1<h.indexOf(".")&&(h=(f=h.split(".")).shift(),f.sort()),a=h.indexOf(":")<0&&"on"+h,(e=e[S.expando]?e:new S.Event(h,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=f.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:S.makeArray(t,[e]),u=S.event.special[h]||{},r||!u.trigger||!1!==u.trigger.apply(n,t))){if(!r&&!u.noBubble&&!g(n)){for(s=u.delegateType||h,Rt.test(s+h)||(p=p.parentNode);p;p=p.parentNode)d.push(p),o=p;o===(n.ownerDocument||w)&&d.push(o.defaultView||o.parentWindow||C)}for(i=0;(p=d[i++])&&!e.isPropagationStopped();)c=p,e.type=1<i?s:u.bindType||h,(l=(E.get(p,"events")||Object.create(null))[e.type]&&E.get(p,"handle"))&&l.apply(p,t),(l=a&&p[a])&&l.apply&&y(p)&&(e.result=l.apply(p,t),!1===e.result)&&e.preventDefault();return e.type=h,r||e.isDefaultPrevented()||u._default&&!1!==u._default.apply(d.pop(),t)||!y(n)||a&&v(n[h])&&!g(n)&&((o=n[a])&&(n[a]=null),S.event.triggered=h,e.isPropagationStopped()&&c.addEventListener(h,St),n[h](),e.isPropagationStopped()&&c.removeEventListener(h,St),S.event.triggered=void 0,o)&&(n[a]=o),e.result}},simulate:function(e,t,n){n=S.extend(new S.Event,n,{type:e,isSimulated:!0});S.event.trigger(n,null,t)}}),S.fn.extend({trigger:function(e,t){return this.each(function(){S.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return S.event.trigger(e,t,n,!0)}}),m.focusin||S.each({focus:"focusin",blur:"focusout"},function(n,r){function i(e){S.event.simulate(r,e.target,S.event.fix(e))}S.event.special[r]={setup:function(){var e=this.ownerDocument||this.document||this,t=E.access(e,r);t||e.addEventListener(n,i,!0),E.access(e,r,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=E.access(e,r)-1;t?E.access(e,r,t):(e.removeEventListener(n,i,!0),E.remove(e,r))}}}),C.location),_t={guid:Date.now()},Nt=/\?/,xt=(S.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new C.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||S.error("Invalid XML: "+(n?S.map(n.childNodes,function(e){return e.textContent}).join("\n"):e)),t},/\[\]$/),Ot=/\r?\n/g,It=/^(?:submit|button|image|reset|file)$/i,Mt=/^(?:input|select|textarea|keygen)/i;S.param=function(e,t){function n(e,t){t=v(t)?t():t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==t?"":t)}var r,i=[];if(null==e)return"";if(Array.isArray(e)||e.jquery&&!S.isPlainObject(e))S.each(e,function(){n(this.name,this.value)});else for(r in e)!function n(r,e,i,o){if(Array.isArray(e))S.each(e,function(e,t){i||xt.test(r)?o(r,t):n(r+"["+("object"==typeof t&&null!=t?e:"")+"]",t,i,o)});else if(i||"object"!==p(e))o(r,e);else for(var t in e)n(r+"["+t+"]",e[t],i,o)}(r,e[r],t,n);return i.join("&")},S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=S.prop(this,"elements");return e?S.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!S(this).is(":disabled")&&Mt.test(this.nodeName)&&!It.test(e)&&(this.checked||!Ce.test(e))}).map(function(e,t){var n=S(this).val();return null==n?null:Array.isArray(n)?S.map(n,function(e){return{name:t.name,value:e.replace(Ot,"\r\n")}}):{name:t.name,value:n.replace(Ot,"\r\n")}}).get()}});var kt=/%20/g,Dt=/#.*$/,Lt=/([?&])_=[^&]*/,Pt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ft=/^(?:GET|HEAD)$/,Bt=/^\/\//,Ht={},Ut={},Vt="*/".concat("*"),Wt=w.createElement("a");function $t(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(T)||[];if(v(t))for(;n=i[r++];)"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function jt(t,r,i,o){var s={},a=t===Ut;function l(e){var n;return s[e]=!0,S.each(t[e]||[],function(e,t){t=t(r,i,o);return"string"!=typeof t||a||s[t]?a?!(n=t):void 0:(r.dataTypes.unshift(t),l(t),!1)}),n}return l(r.dataTypes[0])||!s["*"]&&l("*")}function zt(e,t){var n,r,i=S.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r=r||{})[n]=t[n]);return r&&S.extend(!0,e,r),e}Wt.href=At.href,S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:At.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(At.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Vt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?zt(zt(e,S.ajaxSettings),t):zt(S.ajaxSettings,e)},ajaxPrefilter:$t(Ht),ajaxTransport:$t(Ut),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0);var l,u,c,n,d,h,f,r,p=S.ajaxSetup({},t=t||{}),g=p.context||p,m=p.context&&(g.nodeType||g.jquery)?S(g):S.event,y=S.Deferred(),v=S.Callbacks("once memory"),b=p.statusCode||{},i={},o={},s="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(h){if(!n)for(n={};t=Pt.exec(c);)n[t[1].toLowerCase()+" "]=(n[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=n[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return h?c:null},setRequestHeader:function(e,t){return null==h&&(e=o[e.toLowerCase()]=o[e.toLowerCase()]||e,i[e]=t),this},overrideMimeType:function(e){return null==h&&(p.mimeType=e),this},statusCode:function(e){if(e)if(h)E.always(e[E.status]);else for(var t in e)b[t]=[b[t],e[t]];return this},abort:function(e){e=e||s;return l&&l.abort(e),a(0,e),this}};if(y.promise(E),p.url=((e||p.url||At.href)+"").replace(Bt,At.protocol+"//"),p.type=t.method||t.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(T)||[""],null==p.crossDomain){e=w.createElement("a");try{e.href=p.url,e.href=e.href,p.crossDomain=Wt.protocol+"//"+Wt.host!=e.protocol+"//"+e.host}catch(e){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=S.param(p.data,p.traditional)),jt(Ht,p,t,E),!h){for(r in(f=S.event&&p.global)&&0==S.active++&&S.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Ft.test(p.type),u=p.url.replace(Dt,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(kt,"+")):(e=p.url.slice(u.length),p.data&&(p.processData||"string"==typeof p.data)&&(u+=(Nt.test(u)?"&":"?")+p.data,delete p.data),!1===p.cache&&(u=u.replace(Lt,"$1"),e=(Nt.test(u)?"&":"?")+"_="+_t.guid+++e),p.url=u+e),p.ifModified&&(S.lastModified[u]&&E.setRequestHeader("If-Modified-Since",S.lastModified[u]),S.etag[u])&&E.setRequestHeader("If-None-Match",S.etag[u]),(p.data&&p.hasContent&&!1!==p.contentType||t.contentType)&&E.setRequestHeader("Content-Type",p.contentType),E.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Vt+"; q=0.01":""):p.accepts["*"]),p.headers)E.setRequestHeader(r,p.headers[r]);if(p.beforeSend&&(!1===p.beforeSend.call(g,E,p)||h))return E.abort();if(s="abort",v.add(p.complete),E.done(p.success),E.fail(p.error),l=jt(Ut,p,t,E)){if(E.readyState=1,f&&m.trigger("ajaxSend",[E,p]),h)return E;p.async&&0<p.timeout&&(d=C.setTimeout(function(){E.abort("timeout")},p.timeout));try{h=!1,l.send(i,a)}catch(e){if(h)throw e;a(-1,e)}}else a(-1,"No Transport")}return E;function a(e,t,n,r){var i,o,s,a=t;h||(h=!0,d&&C.clearTimeout(d),l=void 0,c=r||"",E.readyState=0<e?4:0,r=200<=e&&e<300||304===e,n&&(s=function(e,t,n){for(var r,i,o,s,a=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){l.unshift(i);break}if(l[0]in n)o=l[0];else{for(i in n){if(!l[0]||e.converters[i+" "+l[0]]){o=i;break}s=s||i}o=o||s}if(o)return o!==l[0]&&l.unshift(o),n[o]}(p,E,n)),!r&&-1<S.inArray("script",p.dataTypes)&&S.inArray("json",p.dataTypes)<0&&(p.converters["text script"]=function(){}),s=function(e,t,n,r){var i,o,s,a,l,u={},c=e.dataTypes.slice();if(c[1])for(s in e.converters)u[s.toLowerCase()]=e.converters[s];for(o=c.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!l&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=c.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(s=u[l+" "+o]||u["* "+o]))for(i in u)if((a=i.split(" "))[1]===o&&(s=u[l+" "+a[0]]||u["* "+a[0]])){!0===s?s=u[i]:!0!==u[i]&&(o=a[0],c.unshift(a[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}(p,s,E,r),r?(p.ifModified&&((n=E.getResponseHeader("Last-Modified"))&&(S.lastModified[u]=n),n=E.getResponseHeader("etag"))&&(S.etag[u]=n),204===e||"HEAD"===p.type?a="nocontent":304===e?a="notmodified":(a=s.state,i=s.data,r=!(o=s.error))):(o=a,!e&&a||(a="error",e<0&&(e=0))),E.status=e,E.statusText=(t||a)+"",r?y.resolveWith(g,[i,a,E]):y.rejectWith(g,[E,a,o]),E.statusCode(b),b=void 0,f&&m.trigger(r?"ajaxSuccess":"ajaxError",[E,p,r?i:o]),v.fireWith(g,[E,a]),f&&(m.trigger("ajaxComplete",[E,p]),--S.active||S.event.trigger("ajaxStop")))}},getJSON:function(e,t,n){return S.get(e,t,n,"json")},getScript:function(e,t){return S.get(e,void 0,t,"script")}}),S.each(["get","post"],function(e,i){S[i]=function(e,t,n,r){return v(t)&&(r=r||n,n=t,t=void 0),S.ajax(S.extend({url:e,type:i,dataType:r,data:t,success:n},S.isPlainObject(e)&&e))}}),S.ajaxPrefilter(function(e){for(var t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),S._evalUrl=function(e,t,n){return S.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){S.globalEval(e,t,n)}})},S.fn.extend({wrapAll:function(e){return this[0]&&(v(e)&&(e=e.call(this[0])),e=S(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(n){return v(n)?this.each(function(e){S(this).wrapInner(n.call(this,e))}):this.each(function(){var e=S(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=v(t);return this.each(function(e){S(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not("body").each(function(){S(this).replaceWith(this.childNodes)}),this}}),S.expr.pseudos.hidden=function(e){return!S.expr.pseudos.visible(e)},S.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},S.ajaxSettings.xhr=function(){try{return new C.XMLHttpRequest}catch(e){}};var Gt={0:200,1223:204},Yt=S.ajaxSettings.xhr(),Xt=(m.cors=!!Yt&&"withCredentials"in Yt,m.ajax=Yt=!!Yt,S.ajaxTransport(function(i){var o,s;if(m.cors||Yt&&!i.crossDomain)return{send:function(e,t){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);o=function(e){return function(){o&&(o=s=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?t(0,"error"):t(r.status,r.statusText):t(Gt[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),s=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=s:r.onreadystatechange=function(){4===r.readyState&&C.setTimeout(function(){o&&s()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}}),S.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return S.globalEval(e),e}}}),S.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),S.ajaxTransport("script",function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(e,t){r=S("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),w.head.appendChild(r[0])},abort:function(){i&&i()}}}),[]),Kt=/(=)\?(?=&|$)|\?\?/,qt=(S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Xt.pop()||S.expando+"_"+_t.guid++;return this[e]=!0,e}}),S.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,s=!1!==e.jsonp&&(Kt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Kt.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=v(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(Kt,"$1"+r):!1!==e.jsonp&&(e.url+=(Nt.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||S.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=C[r],C[r]=function(){o=arguments},n.always(function(){void 0===i?S(C).removeProp(r):C[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,Xt.push(r)),o&&v(i)&&i(o[0]),o=i=void 0}),"script"}),m.createHTMLDocument=((e=w.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===e.childNodes.length),S.parseHTML=function(e,t,n){var r;return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(m.createHTMLDocument?((r=(t=w.implementation.createHTMLDocument("")).createElement("base")).href=w.location.href,t.head.appendChild(r)):t=w),r=!n&&[],(n=Z.exec(e))?[t.createElement(n[1])]:(n=Ae([e],t,r),r&&r.length&&S(r).remove(),S.merge([],n.childNodes)))},S.fn.load=function(e,t,n){var r,i,o,s=this,a=e.indexOf(" ");return-1<a&&(r=D(e.slice(a)),e=e.slice(0,a)),v(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<s.length&&S.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,s.html(r?S("<div>").append(S.parseHTML(e)).find(r):e)}).always(n&&function(e,t){s.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},S.expr.pseudos.animated=function(t){return S.grep(S.timers,function(e){return t===e.elem}).length},S.offset={setOffset:function(e,t,n){var r,i,o,s,a=S.css(e,"position"),l=S(e),u={};"static"===a&&(e.style.position="relative"),o=l.offset(),r=S.css(e,"top"),s=S.css(e,"left"),a=("absolute"===a||"fixed"===a)&&-1<(r+s).indexOf("auto")?(i=(a=l.position()).top,a.left):(i=parseFloat(r)||0,parseFloat(s)||0),null!=(t=v(t)?t.call(e,n,S.extend({},o)):t).top&&(u.top=t.top-o.top+i),null!=t.left&&(u.left=t.left-o.left+a),"using"in t?t.using.call(e,u):l.css(u)}},S.fn.extend({offset:function(t){var e,n;return arguments.length?void 0===t?this:this.each(function(e){S.offset.setOffset(this,t,e)}):(n=this[0])?n.getClientRects().length?(e=n.getBoundingClientRect(),n=n.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===S.css(r,"position"))t=r.getBoundingClientRect();else{for(t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===S.css(e,"position");)e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=S(e).offset()).top+=S.css(e,"borderTopWidth",!0),i.left+=S.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-S.css(r,"marginTop",!0),left:t.left-i.left-S.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===S.css(e,"position");)e=e.offsetParent;return e||R})}}),S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;S.fn[t]=function(e){return d(this,function(e,t,n){var r;if(g(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n)return r?r[i]:e[t];r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):e[t]=n},t,e,arguments.length)}}),S.each(["top","left"],function(e,n){S.cssHooks[n]=Je(m.pixelPosition,function(e,t){if(t)return t=Qe(e,n),Xe.test(t)?S(e).position()[n]+"px":t})}),S.each({Height:"height",Width:"width"},function(s,a){S.each({padding:"inner"+s,content:a,"":"outer"+s},function(r,o){S.fn[o]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return d(this,function(e,t,n){var r;return g(e)?0===o.indexOf("outer")?e["inner"+s]:e.document.documentElement["client"+s]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+s],r["scroll"+s],e.body["offset"+s],r["offset"+s],r["client"+s])):void 0===n?S.css(e,t,i):S.style(e,t,n,i)},a,n?e:void 0,n)}})}),S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){S.fn[t]=function(e){return this.on(t,e)}}),S.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),S.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,n){S.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}}),/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g),Zt=(S.proxy=function(e,t){var n,r;if("string"==typeof t&&(r=e[t],t=e,e=r),v(e))return n=a.call(arguments,2),(r=function(){return e.apply(t||this,n.concat(a.call(arguments)))}).guid=e.guid=e.guid||S.guid++,r},S.holdReady=function(e){e?S.readyWait++:S.ready(!0)},S.isArray=Array.isArray,S.parseJSON=JSON.parse,S.nodeName=l,S.isFunction=v,S.isWindow=g,S.camelCase=b,S.type=p,S.now=Date.now,S.isNumeric=function(e){var t=S.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},S.trim=function(e){return null==e?"":(e+"").replace(qt,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return S}),C.jQuery),Qt=C.$;return S.noConflict=function(e){return C.$===S&&(C.$=Qt),e&&C.jQuery===S&&(C.jQuery=Zt),S},void 0===P&&(C.jQuery=C.$=S),S}),!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(r){var n=[],i=r(document),o=r(window),l=[];r.alert=function(e,t){return r.alert.impl.init(e,t)},r.alert.close=function(){r.alert.impl.close()},r.alert.focus=function(e){r.alert.impl.focus(e)},r.alert.setContainerDimensions=function(){r.alert.impl.setContainerDimensions()},r.alert.setPosition=function(){r.alert.impl.setPosition()},r.alert.update=function(e,t){r.alert.impl.update(e,t)},r.fn.alert=function(e){return r.alert.impl.init(this,e)},r.alert.defaults={appendTo:"body",focus:!0,opacity:50,overlayId:"alertmodal-overlay",overlayCss:{},containerId:"alertmodal-container",containerCss:{},dataId:"alertmodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:!1,autoPosition:!0,zIndex:20200,close:!0,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"alertmodal-close",escClose:!1,overlayClose:!1,fixed:!0,position:null,persist:!1,alert:!0,onOpen:null,onShow:null,onClose:null},r.alert.impl={d:{},init:function(e,t){var n=this;if(n.d.data)return!1;if(r.boxModel,n.o=r.extend({},r.alert.defaults,t),n.zIndex=n.o.zIndex,n.occb=!1,"object"==typeof e)e=e instanceof jQuery?e:r(e),n.d.placeholder=!1,0<e.parent().parent().length&&(e.before(r("<span></span>").attr("id","alertmodal-placeholder").css({display:"none"})),n.d.placeholder=!0,n.display=e.css("display"),n.o.persist||(n.d.orig=e.clone(!0)));else{if("string"!=typeof e&&"number"!=typeof e)return alert("AlertModal Error: Unsupported data type: "+typeof e),n;e=r("<div></div>").html(e)}return n.create(e),e=null,n.open(),r.isFunction(n.o.onShow)&&n.o.onShow.apply(n,[n.d]),n},create:function(e){var t=this;t.getDimensions(),t.o.alert&&syn.$b.isIE6&&(t.d.iframe=r('<iframe src="javascript:false;"></iframe>').css(r.extend(t.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:l[0],width:l[1],zIndex:t.o.zIndex,top:0,left:0})).appendTo(t.o.appendTo)),t.d.overlay=r("<div></div>").attr("id",t.o.overlayId).addClass("alertmodal-overlay").css(r.extend(t.o.overlayCss,{display:"none",opacity:t.o.opacity/100,height:t.o.alert?n[0]:0,width:t.o.alert?n[1]:0,position:"fixed",left:0,top:0,zIndex:t.o.zIndex+1})).appendTo(t.o.appendTo),t.d.container=r("<div></div>").attr("id",t.o.containerId).addClass("alertmodal-container").css(r.extend({position:"fixed"},t.o.containerCss,{display:"none",zIndex:t.o.zIndex+2})).append(t.o.close&&t.o.closeHTML?r(t.o.closeHTML).addClass(t.o.closeClass):"").appendTo(t.o.appendTo),t.d.wrap=r("<div></div>").attr("tabIndex",-1).addClass("alertmodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(t.d.container),t.d.data=e.attr("id",e.attr("id")||t.o.dataId).addClass("alertmodal-data").css(r.extend(t.o.dataCss,{display:"none"})).appendTo("body"),e=null,t.setContainerDimensions(),t.d.data.appendTo(t.d.wrap),syn.$b.isIE6&&t.fixIE()},bindEvents:function(){var t=this;r("."+t.o.closeClass).bind("click.alertmodal",function(e){e.preventDefault(),t.close()}),t.o.alert&&t.o.close&&t.o.overlayClose&&t.d.overlay.bind("click.alertmodal",function(e){e.preventDefault(),t.close()}),i.bind("keydown.alertmodal",function(e){t.o.alert&&9===e.keyCode?t.watchTab(e):t.o.close&&t.o.escClose&&27===e.keyCode&&(e.preventDefault(),t.close())}),o.bind("resize.alertmodal orientationchange.alertmodal",function(){t.getDimensions(),t.o.autoResize?t.setContainerDimensions():t.o.autoPosition&&t.setPosition(),syn.$b.isIE6?t.fixIE():t.o.alert&&(t.d.iframe&&t.d.iframe.css({height:l[0],width:l[1]}),t.d.overlay.css({height:n[0],width:n[1]}))})},unbindEvents:function(){r("."+this.o.closeClass).unbind("click.alertmodal"),i.unbind("keydown.alertmodal"),o.unbind(".alertmodal"),this.d.overlay.unbind("click.alertmodal")},fixIE:function(){var g=this.o.position;r.each([this.d.iframe||null,this.o.alert?this.d.overlay:null,"fixed"===this.d.container.css("position")?this.d.container:null],function(e,t){var n,r,i,o,s,a,l,u,c,d,h,f,p;t&&(n="document.body.clientHeight",r="document.body.clientWidth",h="document.body.scrollHeight",i="document.body.scrollLeft",o="document.body.scrollTop",s="document.body.scrollWidth",a="document.documentElement.clientHeight",l="document.documentElement.clientWidth",u="document.documentElement.scrollLeft",c="document.documentElement.scrollTop",(d=t[0].style).position="absolute",e<2?(d.removeExpression("height"),d.removeExpression("width"),d.setExpression("height",h+" > "+n+" ? "+h+" : "+n+' + "px"'),d.setExpression("width",s+" > "+r+" ? "+s+" : "+r+' + "px"')):(g&&g.constructor===Array?(p=-1===(e=g[0]?"number"==typeof g[0]?g[0].toString():g[0].replace(/px/,""):t.css("top").replace(/px/,"")).indexOf("%")?e+" + (t = "+c+" ? "+c+" : "+o+') + "px"':parseInt(e.replace(/%/,""))+" * (("+a+" || "+n+") / 100) + (t = "+c+" ? "+c+" : "+o+') + "px"',g[1]&&(f=-1===(h="number"==typeof g[1]?g[1].toString():g[1].replace(/px/,"")).indexOf("%")?h+" + (t = "+u+" ? "+u+" : "+i+') + "px"':parseInt(h.replace(/%/,""))+" * (("+l+" || "+r+") / 100) + (t = "+u+" ? "+u+" : "+i+') + "px"')):(p="("+a+" || "+n+") / 2 - (this.offsetHeight / 2) + (t = "+c+" ? "+c+" : "+o+') + "px"',f="("+l+" || "+r+") / 2 - (this.offsetWidth / 2) + (t = "+u+" ? "+u+" : "+i+') + "px"'),d.removeExpression("top"),d.removeExpression("left"),d.setExpression("top",p),d.setExpression("left",f)))})},focus:function(e){var t=this,e=e&&-1!==r.inArray(e,["first","last"])?e:"first",n=r(":input:enabled:visible:"+e,t.d.wrap);setTimeout(function(){(0<n.length?n:t.d.wrap).focus()},10)},getDimensions:function(){var e=o.height();n=[i.height(),i.width()],l=[e,o.width()]},getVal:function(e,t){return e?"number"==typeof e?e:"auto"===e?0:0<e.indexOf("%")?parseInt(e.replace(/%/,""))/100*("h"===t?l[0]:l[1]):parseInt(e.replace(/px/,"")):null},update:function(e,t){var n=this;if(!n.d.data)return!1;n.d.origHeight=n.getVal(e,"h"),n.d.origWidth=n.getVal(t,"w"),n.d.data.hide(),e&&n.d.container.css("height",e),t&&n.d.container.css("width",t),n.setContainerDimensions(),n.d.data.show(),n.o.focus&&n.focus(),n.unbindEvents(),n.bindEvents()},setContainerDimensions:function(){var e=this,t=(syn.$b.isIE6||syn.$b.isIE7,e.getVal(e.d.container.css("height"),"h")),n=e.getVal(e.d.container.css("width"),"h"),r=e.d.data.outerHeight(!0),i=e.d.data.outerWidth(!0),o=(e.d.origHeight=e.d.origHeight||t,e.d.origWidth=e.d.origWidth||n,e.o.maxHeight?e.getVal(e.o.maxHeight,"h"):null),s=e.o.maxWidth?e.getVal(e.o.maxWidth,"w"):null,o=o&&o<l[0]?o:l[0],s=s&&s<l[1]?s:l[1],a=e.o.minHeight?e.getVal(e.o.minHeight,"h"):"auto",t=t&&a<t?r?o<r?o:e.o.minHeight&&"auto"!==a&&r<a?a:r:a:e.o.autoResize&&o<t?o:t<a?a:t,o=e.o.minWidth?e.getVal(e.o.minWidth,"w"):"auto",n=n&&o<n?i?s<i?s:e.o.minWidth&&"auto"!==o&&i<o?o:i:o:e.o.autoResize&&s<n?s:n<o?o:n;e.d.container.css({height:t,width:n}),e.d.wrap.css({overflow:t<r||n<i?"auto":"visible"}),e.o.autoPosition&&e.setPosition()},setPosition:function(){var e,t=l[0]/2-this.d.container.outerHeight(!0)/2,n=l[1]/2-this.d.container.outerWidth(!0)/2,r="fixed"!==this.d.container.css("position")?o.scrollTop():0,r=this.o.position&&"[object Array]"===Object.prototype.toString.call(this.o.position)?(e=r+(this.o.position[0]||t),this.o.position[1]||n):(e=r+t,n);this.d.container.css({left:r,top:e})},watchTab:function(e){var t;0<r(e.target).parents(".alertmodal-container").length?(this.inputs=r(":input:enabled:visible:first, :input:enabled:visible:last",this.d.data[0]),(!e.shiftKey&&e.target===this.inputs[this.inputs.length-1]||e.shiftKey&&e.target===this.inputs[0]||0===this.inputs.length)&&(e.preventDefault(),t=e.shiftKey?"last":"first",this.focus(t))):(e.preventDefault(),this.focus())},open:function(){var e=this;e.d.iframe&&e.d.iframe.show(),r.isFunction(e.o.onOpen)?e.o.onOpen.apply(e,[e.d]):(e.d.overlay.show(),e.d.container.show(),e.d.data.show()),e.o.focus&&e.focus(),e.bindEvents()},close:function(){var e,t=this;if(!t.d.data)return!1;t.unbindEvents(),r.isFunction(t.o.onClose)&&!t.occb?(t.occb=!0,t.o.onClose.apply(t,[t.d])):(t.d.placeholder?(e=r("#alertmodal-placeholder"),t.o.persist?e.replaceWith(t.d.data.removeClass("alertmodal-data").css("display",t.display)):(t.d.data.hide().remove(),e.replaceWith(t.d.orig))):t.d.data.hide().remove(),t.d.container.hide().remove(),t.d.overlay.hide(),t.d.iframe&&t.d.iframe.hide().remove(),t.d.overlay.remove(),t.d={})}}}),!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(r){var n=[],i=r(document),o=r(window),l=[];r.modal=function(e,t){return r.modal.impl.init(e,t)},r.modal.close=function(){r.modal.impl.close()},r.modal.focus=function(e){r.modal.impl.focus(e)},r.modal.setContainerDimensions=function(){r.modal.impl.setContainerDimensions()},r.modal.setPosition=function(){r.modal.impl.setPosition()},r.modal.update=function(e,t){r.modal.impl.update(e,t)},r.fn.modal=function(e){return r.modal.impl.init(this,e)},r.modal.defaults={appendTo:"body",focus:!0,opacity:50,overlayId:"simplemodal-overlay",overlayCss:{},containerId:"simplemodal-container",containerCss:{},dataId:"simplemodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:!1,autoPosition:!0,zIndex:20100,close:!0,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"simplemodal-close",escClose:!0,overlayClose:!1,fixed:!0,position:null,persist:!1,modal:!0,onOpen:null,onShow:null,onClose:null},r.modal.impl={d:{},init:function(e,t){var n=this;if(n.d.data)return!1;if(r.boxModel,n.o=r.extend({},r.modal.defaults,t),n.zIndex=n.o.zIndex,n.occb=!1,"object"==typeof e)e=e instanceof jQuery?e:r(e),n.d.placeholder=!1,0<e.parent().parent().length&&(e.before(r("<span></span>").attr("id","simplemodal-placeholder").css({display:"none"})),n.d.placeholder=!0,n.display=e.css("display"),n.o.persist||(n.d.orig=e.clone(!0)));else{if("string"!=typeof e&&"number"!=typeof e)return alert("SimpleModal Error: Unsupported data type: "+typeof e),n;e=r("<div></div>").html(e)}return n.create(e),e=null,n.open(),r.isFunction(n.o.onShow)&&n.o.onShow.apply(n,[n.d]),n},create:function(e){var t=this;t.getDimensions(),t.o.modal&&syn.$b.isIE6&&(t.d.iframe=r('<iframe src="javascript:false;"></iframe>').css(r.extend(t.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:l[0],width:l[1],zIndex:t.o.zIndex,top:0,left:0})).appendTo(t.o.appendTo)),t.d.overlay=r("<div></div>").attr("id",t.o.overlayId).addClass("simplemodal-overlay").css(r.extend(t.o.overlayCss,{display:"none",opacity:t.o.opacity/100,height:t.o.modal?n[0]:0,width:t.o.modal?n[1]:0,position:"fixed",left:0,top:0,zIndex:t.o.zIndex+1})).appendTo(t.o.appendTo),t.d.container=r("<div></div>").attr("id",t.o.containerId).addClass("simplemodal-container").css(r.extend({position:"fixed"},t.o.containerCss,{display:"none",zIndex:t.o.zIndex+2})).append(t.o.close&&t.o.closeHTML?r(t.o.closeHTML).addClass(t.o.closeClass):"").appendTo(t.o.appendTo),t.d.wrap=r("<div></div>").attr("tabIndex",-1).addClass("simplemodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(t.d.container),t.d.data=e.attr("id",e.attr("id")||t.o.dataId).addClass("simplemodal-data").css(r.extend(t.o.dataCss,{display:"none"})).appendTo("body"),e=null,t.setContainerDimensions(),t.d.data.appendTo(t.d.wrap),syn.$b.isIE6&&t.fixIE()},bindEvents:function(){var t=this;r("."+t.o.closeClass).bind("click.simplemodal",function(e){e.preventDefault(),t.close()}),t.o.modal&&t.o.close&&t.o.overlayClose&&t.d.overlay.bind("click.simplemodal",function(e){e.preventDefault(),t.close()}),i.bind("keydown.simplemodal",function(e){t.o.modal&&9===e.keyCode?t.watchTab(e):t.o.close&&t.o.escClose&&27===e.keyCode&&(e.preventDefault(),t.close())}),o.bind("resize.simplemodal orientationchange.simplemodal",function(){t.getDimensions(),t.o.autoResize?t.setContainerDimensions():t.o.autoPosition&&t.setPosition(),syn.$b.isIE6?t.fixIE():t.o.modal&&(t.d.iframe&&t.d.iframe.css({height:l[0],width:l[1]}),t.d.overlay.css({height:n[0],width:n[1]}))})},unbindEvents:function(){r("."+this.o.closeClass).unbind("click.simplemodal"),i.unbind("keydown.simplemodal"),o.unbind(".simplemodal"),this.d.overlay.unbind("click.simplemodal")},fixIE:function(){},focus:function(e){var t=this,e=e&&-1!==r.inArray(e,["first","last"])?e:"first",n=r(":input:enabled:visible:"+e,t.d.wrap);setTimeout(function(){(0<n.length?n:t.d.wrap).focus()},10)},getDimensions:function(){var e=o.height?o[0].innerHeight:o.height();n=[i.height(),i.width()],l=[e,o.width()]},getVal:function(e,t){return e?"number"==typeof e?e:"auto"===e?0:0<e.indexOf("%")?parseInt(e.replace(/%/,""))/100*("h"===t?l[0]:l[1]):parseInt(e.replace(/px/,"")):null},update:function(e,t){var n=this;if(!n.d.data)return!1;n.d.origHeight=n.getVal(e,"h"),n.d.origWidth=n.getVal(t,"w"),n.d.data.hide(),e&&n.d.container.css("height",e),t&&n.d.container.css("width",t),n.setContainerDimensions(),n.d.data.show(),n.o.focus&&n.focus(),n.unbindEvents(),n.bindEvents()},setContainerDimensions:function(){var e=this,t=(syn.$b.isIE6||syn.$b.isIE7,e.getVal(e.d.container.css("height"),"h")),n=e.getVal(e.d.container.css("width"),"h"),r=e.d.data.outerHeight(!0),i=e.d.data.outerWidth(!0),o=(e.d.origHeight=e.d.origHeight||t,e.d.origWidth=e.d.origWidth||n,e.o.maxHeight?e.getVal(e.o.maxHeight,"h"):null),s=e.o.maxWidth?e.getVal(e.o.maxWidth,"w"):null,o=o&&o<l[0]?o:l[0],s=s&&s<l[1]?s:l[1],a=e.o.minHeight?e.getVal(e.o.minHeight,"h"):"auto",t=t&&a<t?r?o<r?o:e.o.minHeight&&"auto"!==a&&r<a?a:r:a:e.o.autoResize&&o<t?o:t<a?a:t,o=e.o.minWidth?e.getVal(e.o.minWidth,"w"):"auto",n=n&&o<n?i?s<i?s:e.o.minWidth&&"auto"!==o&&i<o?o:i:o:e.o.autoResize&&s<n?s:n<o?o:n;e.d.container.css({height:t,width:n}),e.d.wrap.css({overflow:t<r||n<i?"auto":"visible"}),e.o.autoPosition&&e.setPosition()},setPosition:function(){var e,t=l[0]/2-this.d.container.outerHeight(!0)/2,n=l[1]/2-this.d.container.outerWidth(!0)/2,r="fixed"!==this.d.container.css("position")?o.scrollTop():0,r=this.o.position&&"[object Array]"===Object.prototype.toString.call(this.o.position)?(e=r+(this.o.position[0]||t),this.o.position[1]||n):(e=r+t,n);this.d.container.css({left:r,top:e})},watchTab:function(e){var t;0<r(e.target).parents(".simplemodal-container").length?(this.inputs=r(":input:enabled:visible:first, :input:enabled:visible:last",this.d.data[0]),(!e.shiftKey&&e.target===this.inputs[this.inputs.length-1]||e.shiftKey&&e.target===this.inputs[0]||0===this.inputs.length)&&(e.preventDefault(),t=e.shiftKey?"last":"first",this.focus(t))):(e.preventDefault(),this.focus())},open:function(){var e=this;e.d.iframe&&e.d.iframe.show(),r.isFunction(e.o.onOpen)?e.o.onOpen.apply(e,[e.d]):(e.d.overlay.show(),e.d.container.show(),e.d.data.show()),e.o.focus&&e.focus(),e.bindEvents()},close:function(){var e,t=this;if(!t.d.data)return!1;t.unbindEvents(),r.isFunction(t.o.onClose)&&!t.occb?(t.occb=!0,t.o.onClose.apply(t,[t.d])):(t.d.placeholder?(e=r("#simplemodal-placeholder"),t.o.persist?e.replaceWith(t.d.data.removeClass("simplemodal-data").css("display",t.display)):(t.d.data.hide().remove(),e.replaceWith(t.d.orig))):t.d.data.hide().remove(),t.d.container.hide().remove(),t.d.overlay.hide(),t.d.iframe&&t.d.iframe.hide().remove(),t.d.overlay.remove(),t.d={})}}}),!function(y){var v=null!=window.orientation;y.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},dataName:"rawMaskFn"},y.fn.extend({caret:function(t,n){var e;if(0!=this.length)return"number"==typeof t?(n="number"==typeof n?n:t,this.each(function(){var e;this.setSelectionRange?this.setSelectionRange(t,n):this.createTextRange&&((e=this.createTextRange()).collapse(!0),e.moveEnd("character",n),e.moveStart("character",t),e.select())})):(this[0].setSelectionRange?(t=this[0].selectionStart,n=this[0].selectionEnd):document.selection&&document.selection.createRange&&(e=document.selection.createRange(),t=0-e.duplicate().moveStart("character",-1e5),n=t+e.text.length),{begin:t,end:n})},unmask:function(){return this.trigger("unmask")},mask:function(n,f){if(!n&&0<this.length)return y(this[0]).data(y.mask.dataName)();f=y.extend({placeholder:"_",completed:null},f);var o=y.mask.definitions,p=[],s=n.length,g=null,m=n.length;return y.each(n.split(""),function(e,t){"?"==t?(m--,s=e):o[t]?(p.push(new RegExp(o[t])),null==g&&(g=p.length-1)):p.push(null)}),this.trigger("unmask").each(function(){var a=y(this),l=y.map(n.split(""),function(e,t){if("?"!=e)return o[e]?f.placeholder:e}),r=a.val();function u(e){for(;++e<=m&&!p[e];);return e}function c(e,t){if(!(e<0)){for(var n=e,r=u(t);n<m;n++)if(p[n]){if(!(r<m&&p[n].test(l[r])))break;l[n]=l[r],l[r]=f.placeholder,r=u(r)}h(),a.caret(Math.max(g,e))}}function e(e){var t,n,e=e.which;return 8==e||46==e||v&&127==e?(t=(n=a.caret()).begin,(n=n.end)-t==0&&(t=46!=e?function(e){for(;0<=--e&&!p[e];);return e}(t):n=u(t-1),n=46==e?u(n):n),d(t,n),c(t,n-1),!1):27==e?(a.val(r),a.caret(0,i()),!1):void 0}function t(e){var t=e.which,n=a.caret();if(e.ctrlKey||e.altKey||e.metaKey||t<32)return!0;if(t){n.end-n.begin!=0&&(d(n.begin,n.end),c(n.begin,n.end-1));e=u(n.begin-1);if(e<m){n=String.fromCharCode(t);if(p[e].test(n)){for(var r=e,i=f.placeholder;r<m;r++)if(p[r]){var o=u(r),s=l[r];if(l[r]=i,!(o<m&&p[o].test(s)))break;i=s}l[e]=n,h();t=u(e);a.caret(t),f.completed&&m<=t&&f.completed.call(a)}}return!1}}function d(e,t){for(var n=e;n<t&&n<m;n++)p[n]&&(l[n]=f.placeholder)}function h(){a.val(l.join("")).val()}function i(e){for(var t=a.val(),n=-1,r=0,i=0;r<m;r++)if(p[r]){for(l[r]=f.placeholder;i++<t.length;){var o=t.charAt(i-1);if(p[r].test(o)){l[r]=o,n=r;break}}if(i>t.length)break}else l[r]==t.charAt(i)&&r!=s&&(i++,n=r);return!e&&n+1<s?(a.val(""),d(0,m)):(e||s<=n+1)&&(h(),e||a.val(a.val().substring(0,n+1))),s?r:g}a.data(y.mask.dataName,function(){return y.map(l,function(e,t){return p[t]&&e!=f.placeholder?e:null}).join("")}),a.attr("readonly")||a.one("unmask",function(){a.unbind(".mask").removeData(y.mask.dataName)}).bind("focus.mask",function(){r=a.val();var e=i(),t=(h(),function(){e==n.length?a.caret(0,e):a.caret(e)});setTimeout(t,0)}).bind("blur.mask",function(){i(),a.val()!=r&&a.change()}).bind("keydown.mask",e).bind("keypress.mask",t).bind("input.mask",function(){setTimeout(function(){a.caret(i(!0))},0)}),i()})}})}(jQuery),!function(s){function a(e){var t=this.className.match(/resizer\-(\w+)/);return 2!=t.length||("t"==(t=t[1])[S=0]?S|=1:"b"==t[0]&&(S|=4),t.match(/l/)?S|=8:t.match(/r/)&&(S|=2),i=s(this).closest(".window").removeClass("minimized").removeClass("maximized").removeData("oldPos"),m=i.find("> .windowtitlebar").height()+5,(w=n(i)).right=w.parentW-i.outerWidth()-w.left,w.bottom=w.parentH-i.outerHeight()-w.top,w.width=w.height="auto",o=e.pageX,g=e.pageY,C.css(w),E.show(),!1)}function l(e){var t;return i=s(this).closest(".window"),(t=b?t:(new Date).getTime())-_<=250?(_=0,i.triggerHandler("dblclick")):(_=t,i.WM_raise(),(R=n(i)).width=i.width()+2,R.height=i.height()+2,R.bottom=R.right="auto",A.css(R),T.show(),o=e.pageX,g=e.pageY),!1}function n(e){return(e=e.offset()).top-=s(document).scrollTop(),e.left-=s(document).scrollLeft(),e.parentW=s(window).width(),e.parentH=s(window).height(),e}function r(e){var t;e.data("oldPos")||(t=n(e),e.data("oldPos",{top:t.top,left:t.left,right:"auto",bottom:"auto",width:e.width(),height:e.height()}))}function u(){return!1}function c(){return s(this).closest(".window").WM_raise(),!0}function d(){return s(this).closest(".window").WM_minimize(),!1}function h(){return s(this).closest(".window").WM_restore(),!1}function f(){return s(this).closest(".window").WM_maximize(),!1}function p(){var e=s(this).closest(".window"),t=e.attr("id"),n=syn.$w.channels.filter(function(e){return e.elID==t});return 0<n.length&&(e=(n=n[0]).windowHandle,n.channel.destroy(),""!=(n=e.attr("baseELID"))&&s("#"+n).closest(".window").WM_raise(),n=e.attr("id")+"_overlay",s("#"+n).remove(),e.WM_close()),!1}var i,o,g,m,y=1e4,v=50,b=navigator.userAgent.match(/MSIE/),E=s("<div id=resizerproxy>").mousemove(function(e){var t;return 1&S?(w.top+=-1*(g-e.pageY),(t=w.parentH-w.top-w.bottom-m)<0&&(w.top+=t)):4&S&&(w.bottom+=g-e.pageY,(t=w.parentH-w.top-w.bottom-m)<0)&&(w.bottom+=t),8&S?(w.left+=-1*(o-e.pageX),(t=w.parentW-w.left-w.right-160)<0&&(w.left+=t)):2&S&&(w.right+=o-e.pageX,(t=w.parentW-w.left-w.right-160)<0)&&(w.left+=t),o=e.pageX,g=e.pageY,C.css(w),!1}).mouseup(function(){return E.hide(),i.css(w).WM_ensure_viewable(),i=void 0,!1}),C=s("<div>").appendTo(E),w=null,S=null,T=s("<div id=moverproxy>").mousemove(function(e){return R.top+=-1*(g-e.pageY),R.left+=-1*(o-e.pageX),o=e.pageX,g=e.pageY,A.css(R),!1}).mouseup(function(){return T.hide(),i.css(R).WM_ensure_viewable().removeClass("moving"),i=void 0,!1}),R={left:0,top:0,right:"auto",bottom:"auto",width:0,height:0},A=s("<div>").appendTo(T),_=0;T[0].onselectstart=u,s.fn.WM_ensure_viewable=function(){return this.filter(".window").each(function(){var e=s(this),t=n(e);t.top<0?e.css("top",0):t.parentH-t.top<20&&e.css("top",t.parentH-20),t.left+e.width()<80?e.css({left:-1*e.width()+80,width:e.width(),right:"auto"}):t.parentW-t.left<30&&e.css("left",t.parentW-30)}),this},s.fn.WM_minimize=function(){return this.each(function(){var e=s(this);if(!e.is(".window"))return!0;e.removeClass("maximized"),r(e),m=e.find(">.windowtitlebar").height()+5,e.css({left:"auto",top:"auto",right:0,width:300,height:m,zIndex:1e4}).removeClass("focused").addClass("minimized")}),s.WM_retileMin(),this},s.WM_retileMin=function(){return s(".window.minimized").each(function(e){e*=m+2;s(this).css("bottom")!=e&&s(this).css("bottom",e)}),this},s.fn.WM_maximize=function(){var t;return this.each(function(){var e=s(this);if(!e.is(".window"))return!0;e.hasClass("minimized")&&(e.removeClass("minimized"),t=1),r(e),e.css({left:0,top:0,bottom:0,right:0,width:"auto",height:"auto"}).WM_raise().addClass("maximized")}),t&&s.WM_retileMin(),this},s.fn.WM_restore=function(){var t;return this.each(function(){var e=s(this);if(!e.is(".window"))return!0;e.hasClass("minimized")?(e.removeClass("minimized"),t=1):e.removeClass("maximized"),e.css(e.data("oldPos")).removeData("oldPos").WM_ensure_viewable()}),t&&s.WM_retileMin(),this.WM_raise(),this},s.fn.WM_raise=function(){var e,t=this.filter(".window:first");return 0==t.length||t.hasClass("focused")||(s(".window.focused").removeClass("focused"),t.addClass("focused"),(e=t.attr("baseELID"))?t.attr("id")!=e&&t.css("zIndex",++y):""!=e&&t.css("zIndex",++y)),this},s.fn.WM_close=function(){var e,t=this.attr("channelID");return t&&(e=syn.$w.channels.find(function(e){return e.id==t}),-1<(e=syn.$w.channels.indexOf(e)))&&syn.$w.channels.splice(e,1),this.filter(".window").remove()},s.WM_open=function(e,t,n,r){r=r||{};var i=s('<div class=window><div class=windowtitlebar><img src=/favicon.ico width=16 height=16 class=titlebaricon><div class=titlebartext></div><div class=horizbuts><div class=minimizebut title="hidden"></div><div class=restorebut style="display:none;" title=restore></div><div class="maximizebut" style="display: none;" title=close></div><div class=closebut title=close></div></div></div><div class=windowcontent></div><div class=resizer-tl></div><div class=resizer-t></div><div class=resizer-tr></div><div class=resizer-r></div><div class=resizer-br></div><div class=resizer-b></div><div class=resizer-bl></div><div class=resizer-l></div></div>'),e=(i[0].id=e,r.name||r.title||n||t),e=(t&&(e=t.replace(/^https?:\/\/[^\/]+\//,"").replace(/\.\w+$/,"").replace(/[^A-Za-z0-9]/g,"")),i.addClass("windowname_"+(e=e||"default")),400<(v+=10)&&(v=50),r.width&&i.css("width",r.width),r.height&&i.css("height",r.height),r.top?i.css("top",r.top):i.css("top",v),r.left?i.css("left",r.left):i.css("left",v),s(".resizer-tl,.resizer-t,.resizer-tr,.resizer-r,.resizer-br,.resizer-b,.resizer-bl,.resizer-l",i).mousedown(a),i.click(c),s(".windowtitlebar",i)),o=(e.mousedown(l),e.find("> .horizbuts").mousedown(u).children()),o=(o.eq(0).click(d),o.eq(1).click(h),o.eq(2).click(f),o.eq(3).click(p),e.children(".titlebartext").text(r.title||t||""));return o[0].onselectstart=u,o[0].unselectable="on",s(window.document.body).append(i),t&&("string"==typeof t?((e=t.match(/^(https?\:\/\/)([^\/]+)/))&&e[2]!=document.location.hostname&&i.find(".titlebaricon").attr("src",e[1]+e[2]+"/favicon.ico"),s('<iframe src="'+t+'" target="'+n+'"></iframe><div class=iframecover></div>').appendTo(i.find(".windowcontent"))):i.find(".windowcontent").append(t)),i.WM_raise(),i},s(document).delegate("a","click",function(e){return!((!e.button||0==e.button)&&this.target.match(/^\_child\b/)&&(e=s(this),window.jQuery.WM_open(this.href,this.target,{title:e.attr("title")||e.text().substr(0,100)}),1))}),s(window).resize(function(){return s(".window").WM_ensure_viewable(),!0}),s(function(){b&&s(document.body).addClass("IE"),s(document.body).append(T).append(E)})}(jQuery),!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&"undefined"!=typeof exports?module.exports=t():e.Papa=t()}(this,function r(){"use strict";var i="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==i?i:{};var c,o=!i.document&&!!i.postMessage,s=o&&/blob:/i.test((i.location||{}).protocol),a={},l=0,E={};function u(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=w(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null);this._handle=new n(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,t){this.isFirstChunk&&P(this._config.beforeFirstChunk)&&void 0!==(n=this._config.beforeFirstChunk(e))&&(e=n),this.isFirstChunk=!1,this._halted=!1;var n=this._partialLine+e,e=(this._partialLine="",this._handle.parse(n,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){var r=e.meta.cursor,n=(this._finished||(this._partialLine=n.substring(r-this._baseIndex),this._baseIndex=r),e&&e.data&&(this._rowCount+=e.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview);if(s)i.postMessage({results:e,workerId:E.WORKER_ID,finished:n});else if(P(this._config.chunk)&&!t){if(this._config.chunk(e,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=e=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(e.data),this._completeResults.errors=this._completeResults.errors.concat(e.errors),this._completeResults.meta=e.meta),this._completed||!n||!P(this._config.complete)||e&&e.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),n||e&&e.meta.paused||this._nextChunk(),e}this._halted=!0},this._sendError=function(e){P(this._config.error)?this._config.error(e):s&&this._config.error&&i.postMessage({workerId:E.WORKER_ID,error:e,finished:!1})}}function d(e){var r;(e=e||{}).chunkSize||(e.chunkSize=E.RemoteChunkSize),u.call(this,e),this._nextChunk=o?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(r=new XMLHttpRequest,this._config.withCredentials&&(r.withCredentials=this._config.withCredentials),o||(r.onload=b(this._chunkLoaded,this),r.onerror=b(this._chunkError,this)),r.open(this._config.downloadRequestBody?"POST":"GET",this._input,!o),this._config.downloadRequestHeaders){var e,t=this._config.downloadRequestHeaders;for(e in t)r.setRequestHeader(e,t[e])}var n;this._config.chunkSize&&(n=this._start+this._config.chunkSize-1,r.setRequestHeader("Range","bytes="+this._start+"-"+n));try{r.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}o&&0===r.status&&this._chunkError()}},this._chunkLoaded=function(){4===r.readyState&&(r.status<200||400<=r.status?this._chunkError():(this._start+=this._config.chunkSize||r.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(e){e=e.getResponseHeader("Content-Range");return null!==e?parseInt(e.substring(e.lastIndexOf("/")+1)):-1}(r),this.parseChunk(r.responseText)))},this._chunkError=function(e){e=r.statusText||e;this._sendError(new Error(e))}}function h(e){(e=e||{}).chunkSize||(e.chunkSize=E.LocalChunkSize),u.call(this,e);var n,r,i="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,r=e.slice||e.webkitSlice||e.mozSlice,i?((n=new FileReader).onload=b(this._chunkLoaded,this),n.onerror=b(this._chunkError,this)):n=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input,t=(this._config.chunkSize&&(t=Math.min(this._start+this._config.chunkSize,this._input.size),e=r.call(e,this._start,t)),n.readAsText(e,this._config.encoding));i||this._chunkLoaded({target:{result:t}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(n.error)}}function f(e){var n;u.call(this,e=e||{}),this.stream=function(e){return n=e,this._nextChunk()},this._nextChunk=function(){var e,t;if(!this._finished)return e=this._config.chunkSize,n=e?(t=n.substring(0,e),n.substring(e)):(t=n,""),this._finished=!n,this.parseChunk(t)}}function p(e){u.call(this,e=e||{});var t=[],n=!0,r=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=b(function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}},this),this._streamError=b(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=b(function(){this._streamCleanUp(),r=!0,this._streamData("")},this),this._streamCleanUp=b(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function g(e){var t=require("stream").Duplex,n=w(e),r=!0,i=!1,o=[],s=null;this._onCsvData=function(e){e=e.data;s.push(e)||this._handle.paused()||this._handle.pause()},this._onCsvComplete=function(){s.push(null)},n.step=b(this._onCsvData,this),n.complete=b(this._onCsvComplete,this),u.call(this,n),this._nextChunk=function(){i&&1===o.length&&(this._finished=!0),o.length?o.shift()():r=!0},this._addToParseQueue=function(e,t){o.push(b(function(){if(this.parseChunk("string"==typeof e?e:e.toString(n.encoding)),P(t))return t()},this)),r&&(r=!1,this._nextChunk())},this._onRead=function(){this._handle.paused()&&this._handle.resume()},this._onWrite=function(e,t,n){this._addToParseQueue(e,n)},this._onWriteComplete=function(){i=!0,this._addToParseQueue("")},this.getStream=function(){return s},(s=new t({readableObjectMode:!0,decodeStrings:!1,read:b(this._onRead,this),write:b(this._onWrite,this)})).once("finish",b(this._onWriteComplete,this))}function n(y){var i,o,s,t,a=Math.pow(2,53),l=-a,u=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)(e[-+]?\d+)?\s*$/,c=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,n=this,r=0,d=0,h=!1,e=!1,f=[],p={data:[],errors:[],meta:{}};function v(e){return"greedy"===y.skipEmptyLines?""===e.join("").trim():1===e.length&&0===e[0].length}function g(){if(p&&s&&(b("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+E.DefaultDelimiter+"'"),s=!1),y.skipEmptyLines)for(var e=0;e<p.data.length;e++)v(p.data[e])&&p.data.splice(e--,1);if(m()){if(p)if(Array.isArray(p.data[0])){for(var t=0;m()&&t<p.data.length;t++)p.data[t].forEach(n);p.data.splice(0,1)}else p.data.forEach(n);function n(e,t){P(y.transformHeader)&&(e=y.transformHeader(e,t)),f.push(e)}}function r(e,t){for(var n=y.header?{}:[],r=0;r<e.length;r++){var i=r,o=e[r],o=function(e,t){if(function(e){y.dynamicTypingFunction&&void 0===y.dynamicTyping[e]&&(y.dynamicTyping[e]=y.dynamicTypingFunction(e));return!0===(y.dynamicTyping[e]||y.dynamicTyping)}(e))return"true"===t||"TRUE"===t||"false"!==t&&"FALSE"!==t&&(function(e){if(u.test(e)){e=parseFloat(e);if(l<e&&e<a)return 1}}(t)?parseFloat(t):c.test(t)?new Date(t):""===t?null:t);return t}(i=y.header?r>=f.length?"__parsed_extra":f[r]:i,o=y.transform?y.transform(o,i):o);"__parsed_extra"===i?(n[i]=n[i]||[],n[i].push(o)):n[i]=o}return y.header&&(r>f.length?b("FieldMismatch","TooManyFields","Too many fields: expected "+f.length+" fields but parsed "+r,d+t):r<f.length&&b("FieldMismatch","TooFewFields","Too few fields: expected "+f.length+" fields but parsed "+r,d+t)),n}var i;p&&(y.header||y.dynamicTyping||y.transform)&&(i=1,!p.data.length||Array.isArray(p.data[0])?(p.data=p.data.map(r),i=p.data.length):p.data=r(p.data,0),y.header&&p.meta&&(p.meta.fields=f),d+=i)}function m(){return y.header&&0===f.length}function b(e,t,n,r){e={type:e,code:t,message:n};void 0!==r&&(e.row=r),p.errors.push(e)}P(y.step)&&(t=y.step,y.step=function(e){p=e,m()?g():(g(),0!==p.data.length&&(r+=e.data.length,y.preview&&r>y.preview?o.abort():(p.data=p.data[0],t(p,n))))}),this.parse=function(e,t,n){var r=y.quoteChar||'"',r=(y.newline||(y.newline=function(e,t){e=e.substring(0,1048576);var t=new RegExp(L(t)+"([^]*?)"+L(t),"gm"),n=(e=e.replace(t,"")).split("\r"),t=e.split("\n"),e=1<t.length&&t[0].length<n[0].length;if(1===n.length||e)return"\n";for(var r=0,i=0;i<n.length;i++)"\n"===n[i][0]&&r++;return r>=n.length/2?"\r\n":"\r"}(e,r)),s=!1,y.delimiter?P(y.delimiter)&&(y.delimiter=y.delimiter(e),p.meta.delimiter=y.delimiter):((r=function(e,t,n,r,i){var o,s,a,l;i=i||[",","\t","|",";",E.RECORD_SEP,E.UNIT_SEP];for(var u=0;u<i.length;u++){for(var c,d=i[u],h=0,f=0,p=0,g=(a=void 0,new C({comments:r,delimiter:d,newline:t,preview:10}).parse(e)),m=0;m<g.data.length;m++)n&&v(g.data[m])?p++:(c=g.data[m].length,f+=c,void 0===a?a=c:0<c&&(h+=Math.abs(c-a),a=c));0<g.data.length&&(f/=g.data.length-p),(void 0===s||h<=s)&&(void 0===l||l<f)&&1.99<f&&(s=h,o=d,l=f)}return{successful:!!(y.delimiter=o),bestDelimiter:o}}(e,y.newline,y.skipEmptyLines,y.comments,y.delimitersToGuess)).successful?y.delimiter=r.bestDelimiter:(s=!0,y.delimiter=E.DefaultDelimiter),p.meta.delimiter=y.delimiter),w(y));return y.preview&&y.header&&r.preview++,i=e,o=new C(r),p=o.parse(i,t,n),g(),h?{meta:{paused:!0}}:p||{meta:{paused:!1}}},this.paused=function(){return h},this.pause=function(){h=!0,o.abort(),i=P(y.chunk)?"":i.substring(o.getCharIndex())},this.resume=function(){n.streamer._halted?(h=!1,n.streamer.parseChunk(i,!0)):setTimeout(n.resume,3)},this.aborted=function(){return e},this.abort=function(){e=!0,o.abort(),p.meta.aborted=!0,P(y.complete)&&y.complete(p),i=""}}function L(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function C(e){var R=(e=e||{}).delimiter,A=e.newline,_=e.comments,N=e.step,x=e.preview,O=e.fastMode,I=void 0===e.quoteChar?'"':e.quoteChar,M=I;if(void 0!==e.escapeChar&&(M=e.escapeChar),("string"!=typeof R||-1<E.BAD_DELIMITERS.indexOf(R))&&(R=","),_===R)throw new Error("Comment character same as delimiter");!0===_?_="#":("string"!=typeof _||-1<E.BAD_DELIMITERS.indexOf(_))&&(_=!1),"\n"!==A&&"\r"!==A&&"\r\n"!==A&&(A="\n");var k=0,D=!1;this.parse=function(n,t,r){if("string"!=typeof n)throw new Error("Input must be a string");var i=n.length,e=R.length,o=A.length,s=_.length,a=P(N),l=[],u=[],c=[],d=k=0;if(!n)return S();if(O||!1!==O&&-1===n.indexOf(I)){for(var h=n.split(A),f=0;f<h.length;f++){if(c=h[f],k+=c.length,f!==h.length-1)k+=A.length;else if(r)return S();if(!_||c.substring(0,s)!==_){if(a){if(l=[],b(c.split(R)),T(),D)return S()}else b(c.split(R));if(x&&x<=f)return l=l.slice(0,x),S(!0)}}return S()}for(var p=n.indexOf(R,k),g=n.indexOf(A,k),m=new RegExp(L(M)+L(I),"g"),y=n.indexOf(I,k);;)if(n[k]===I)for(y=k,k++;;){if(-1===(y=n.indexOf(I,y+1)))return r||u.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:l.length,index:k}),C();if(y===i-1)return C(n.substring(k,y).replace(m,I));if(I===M&&n[y+1]===M)y++;else if(I===M||0===y||n[y-1]!==M){-1!==p&&p<y+1&&(p=n.indexOf(R,y+1));var v=E(-1===(g=-1!==g&&g<y+1?n.indexOf(A,y+1):g)?p:Math.min(p,g));if(n[y+1+v]===R){c.push(n.substring(k,y).replace(m,I)),n[k=y+1+v+e]!==I&&(y=n.indexOf(I,k)),p=n.indexOf(R,k),g=n.indexOf(A,k);break}v=E(g);if(n.substring(y+1+v,y+1+v+o)===A){if(c.push(n.substring(k,y).replace(m,I)),w(y+1+v+o),p=n.indexOf(R,k),y=n.indexOf(I,k),a&&(T(),D))return S();if(x&&l.length>=x)return S(!0);break}u.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:l.length,index:k}),y++}}else if(_&&0===c.length&&n.substring(k,k+s)===_){if(-1===g)return S();k=g+o,g=n.indexOf(A,k),p=n.indexOf(R,k)}else if(-1!==p&&(p<g||-1===g))c.push(n.substring(k,p)),k=p+e,p=n.indexOf(R,k);else{if(-1===g)break;if(c.push(n.substring(k,g)),w(g+o),a&&(T(),D))return S();if(x&&l.length>=x)return S(!0)}return C();function b(e){l.push(e),d=k}function E(e){var t=0;return t=-1!==e&&(e=n.substring(y+1,e))&&""===e.trim()?e.length:t}function C(e){return r||(void 0===e&&(e=n.substring(k)),c.push(e),k=i,b(c),a&&T()),S()}function w(e){k=e,b(c),c=[],g=n.indexOf(A,k)}function S(e){return{data:l,errors:u,meta:{delimiter:R,linebreak:A,aborted:D,truncated:!!e,cursor:d+(t||0)}}}function T(){N(S()),l=[],u=[]}},this.abort=function(){D=!0},this.getCharIndex=function(){return k}}function m(e){var t=e.data,n=a[t.workerId],r=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var i={abort:function(){r=!0,y(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:v,resume:v};if(P(n.userStep)){for(var o=0;o<t.results.data.length&&(n.userStep({data:t.results.data[o],errors:t.results.errors,meta:t.results.meta},i),!r);o++);delete t.results}else P(n.userChunk)&&(n.userChunk(t.results,i,t.file),delete t.results)}t.finished&&!r&&y(t.workerId,t.results)}function y(e,t){var n=a[e];P(n.userComplete)&&n.userComplete(t),n.terminate(),delete a[e]}function v(){throw new Error("Not implemented.")}function w(e){if("object"!=typeof e||null===e)return e;var t,n=Array.isArray(e)?[]:{};for(t in e)n[t]=w(e[t]);return n}function b(e,t){return function(){e.apply(t,arguments)}}function P(e){return"function"==typeof e}return E.parse=function(e,t){var n=(t=t||{}).dynamicTyping||!1;P(n)&&(t.dynamicTypingFunction=n,n={});if(t.dynamicTyping=n,t.transform=!!P(t.transform)&&t.transform,!t.worker||!E.WORKERS_SUPPORTED)return n=null,e===E.NODE_STREAM_INPUT&&"undefined"==typeof PAPA_BROWSER_CONTEXT?(n=new g(t)).getStream():("string"==typeof e?n=new(t.download?d:f)(t):!0===e.readable&&P(e.read)&&P(e.on)?n=new p(t):(i.File&&e instanceof File||e instanceof Object)&&(n=new h(t)),n.stream(e));(n=function(){var e;return!!E.WORKERS_SUPPORTED&&(e=function(){var e=i.URL||i.webkitURL||null,t=r.toString();return E.BLOB_URL||(E.BLOB_URL=e.createObjectURL(new Blob(["(",t,")();"],{type:"text/javascript"})))}(),(e=new i.Worker(e)).onmessage=m,e.id=l++,a[e.id]=e)}()).userStep=t.step,n.userChunk=t.chunk,n.userComplete=t.complete,n.userError=t.error,t.step=P(t.step),t.chunk=P(t.chunk),t.complete=P(t.complete),t.error=P(t.error),delete t.worker,n.postMessage({input:e,config:t,workerId:n.id})},E.unparse=function(e,t){var r=!1,m=!0,y=",",v="\r\n",i='"',o=i+i,n=!1,s=null,a=!1,l=(function(){if("object"==typeof t){if("string"!=typeof t.delimiter||E.BAD_DELIMITERS.filter(function(e){return-1!==t.delimiter.indexOf(e)}).length||(y=t.delimiter),"boolean"!=typeof t.quotes&&"function"!=typeof t.quotes&&!Array.isArray(t.quotes)||(r=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(n=t.skipEmptyLines),"string"==typeof t.newline&&(v=t.newline),"string"==typeof t.quoteChar&&(i=t.quoteChar),"boolean"==typeof t.header&&(m=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");s=t.columns}void 0!==t.escapeChar&&(o=t.escapeChar+i),"boolean"==typeof t.escapeFormulae&&(a=t.escapeFormulae)}}(),new RegExp(L(i),"g"));"string"==typeof e&&(e=JSON.parse(e));if(Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return u(null,e,n);if("object"==typeof e[0])return u(s||Object.keys(e[0]),e,n)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),u(e.fields||[],e.data||[],n);throw new Error("Unable to serialize unrecognized input");function u(e,t,n){var r="",i=("string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t)),Array.isArray(e)&&0<e.length),o=!Array.isArray(t[0]);if(i&&m){for(var s=0;s<e.length;s++)0<s&&(r+=y),r+=b(e[s],s);0<t.length&&(r+=v)}for(var a=0;a<t.length;a++){var l=(i?e:t[a]).length,u=!1,c=i?0===Object.keys(t[a]).length:0===t[a].length;if(n&&!i&&(u="greedy"===n?""===t[a].join("").trim():1===t[a].length&&0===t[a][0].length),"greedy"===n&&i){for(var d=[],h=0;h<l;h++){var f=o?e[h]:h;d.push(t[a][f])}u=""===d.join("").trim()}if(!u){for(var p=0;p<l;p++){0<p&&!c&&(r+=y);var g=i&&o?e[p]:p;r+=b(t[a][g],p)}a<t.length-1&&(!n||0<l&&!c)&&(r+=v)}}return r}function b(e,t){var n;return null==e?"":e.constructor===Date?JSON.stringify(e).slice(1,25):(n=(e=!0===a&&"string"==typeof e&&null!==e.match(/^[=+\-@].*$/)?"'"+e:e).toString().replace(l,o),"boolean"==typeof r&&r||"function"==typeof r&&r(e,t)||Array.isArray(r)&&r[t]||function(e,t){for(var n=0;n<t.length;n++)if(-1<e.indexOf(t[n]))return!0;return!1}(n,E.BAD_DELIMITERS)||-1<n.indexOf(y)||" "===n.charAt(0)||" "===n.charAt(n.length-1)?i+n+i:n)}},E.RECORD_SEP=String.fromCharCode(30),E.UNIT_SEP=String.fromCharCode(31),E.BYTE_ORDER_MARK="\ufeff",E.BAD_DELIMITERS=["\r","\n",'"',E.BYTE_ORDER_MARK],E.WORKERS_SUPPORTED=!o&&!!i.Worker,E.NODE_STREAM_INPUT=1,E.LocalChunkSize=10485760,E.RemoteChunkSize=5242880,E.DefaultDelimiter=",",E.Parser=C,E.ParserHandle=n,E.NetworkStreamer=d,E.FileStreamer=h,E.StringStreamer=f,E.ReadableStreamStreamer=p,"undefined"==typeof PAPA_BROWSER_CONTEXT&&(E.DuplexStreamStreamer=g),i.jQuery&&((c=i.jQuery).fn.parse=function(a){var n=a.config||{},l=[];return this.each(function(e){if(!("INPUT"===c(this).prop("tagName").toUpperCase()&&"file"===c(this).attr("type").toLowerCase()&&i.FileReader)||!this.files||0===this.files.length)return!0;for(var t=0;t<this.files.length;t++)l.push({file:this.files[t],inputElem:this,instanceConfig:c.extend({},n)})}),e(),this;function e(){if(0===l.length)P(a.complete)&&a.complete();else{var e,t,n,r,i=l[0];if(P(a.before)){var o=a.before(i.file,i.inputElem);if("object"==typeof o){if("abort"===o.action)return e="AbortError",t=i.file,n=i.inputElem,r=o.reason,void(P(a.error)&&a.error({name:e},t,n,r));if("skip"===o.action)return void u();"object"==typeof o.config&&(i.instanceConfig=c.extend(i.instanceConfig,o.config))}else if("skip"===o)return void u()}var s=i.instanceConfig.complete;i.instanceConfig.complete=function(e){P(s)&&s(e,i.file,i.inputElem),u()},E.parse(i.file,i.instanceConfig)}}function u(){l.splice(0,1),e()}}),s&&(i.onmessage=function(e){e=e.data;void 0===E.WORKER_ID&&e&&(E.WORKER_ID=e.workerId);"string"==typeof e.input?i.postMessage({workerId:E.WORKER_ID,results:E.parse(e.input,e.config),finished:!0}):(i.File&&e.input instanceof File||e.input instanceof Object)&&(e=E.parse(e.input,e.config))&&i.postMessage({workerId:E.WORKER_ID,results:e,finished:!0})}),(d.prototype=Object.create(u.prototype)).constructor=d,(h.prototype=Object.create(u.prototype)).constructor=h,(f.prototype=Object.create(f.prototype)).constructor=f,(p.prototype=Object.create(u.prototype)).constructor=p,"undefined"==typeof PAPA_BROWSER_CONTEXT&&((g.prototype=Object.create(u.prototype)).constructor=g),E});var DO_NOT_EXPORT_CODEPAGE=!0,DO_NOT_EXPORT_JSZIP=!0,XLSX=(!function(e){var t;"object"==typeof exports&&"undefined"!=typeof module&&void 0===DO_NOT_EXPORT_JSZIP?module.exports=e():"function"==typeof define&&define.amd&&void 0===DO_NOT_EXPORT_JSZIP?(JSZipSync=e(),define([],e)):("undefined"!=typeof globalThis?t=globalThis:"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof $&&$.global?t=$.global:"undefined"!=typeof self&&(t=self),t.JSZipSync=e())}(function(){return function r(i,o,s){function a(n,e){if(!o[n]){if(!i[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(l)return l(n,!0);throw new Error("Cannot find module '"+n+"'")}e=o[n]={exports:{}};i[n][0].call(e.exports,function(e){var t=i[n][1][e];return a(t||e)},e,e.exports,r,i,o,s)}return o[n].exports}for(var l="function"==typeof require&&require,e=0;e<s.length;e++)a(s[e]);return a}({1:[function(e,t,n){"use strict";var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e,t){for(var n,r,i,o,s,a,l="",u=0;u<e.length;)i=(n=e.charCodeAt(u++))>>2,o=(3&n)<<4|(n=e.charCodeAt(u++))>>4,s=(15&n)<<2|(r=e.charCodeAt(u++))>>6,a=63&r,isNaN(n)?s=a=64:isNaN(r)&&(a=64),l=l+c.charAt(i)+c.charAt(o)+c.charAt(s)+c.charAt(a);return l},n.decode=function(e,t){var n,r,i,o,s,a,l="",u=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<e.length;)i=c.indexOf(e.charAt(u++)),n=(15&(o=c.indexOf(e.charAt(u++))))<<4|(s=c.indexOf(e.charAt(u++)))>>2,r=(3&s)<<6|(a=c.indexOf(e.charAt(u++))),l+=String.fromCharCode(i<<2|o>>4),64!=s&&(l+=String.fromCharCode(n)),64!=a&&(l+=String.fromCharCode(r));return l}},{}],2:[function(e,t,n){"use strict";function r(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}r.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},t.exports=r},{}],3:[function(e,t,n){"use strict";n.STORE={magic:"\0\0",compress:function(e){return e},uncompress:function(e){return e},compressInputType:null,uncompressInputType:null},n.DEFLATE=e("./flate")},{"./flate":8}],4:[function(e,t,n){"use strict";var s=e("./utils"),a=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];t.exports=function(e,t){if(void 0===e||!e.length)return 0;var n,r="string"!==s.getTypeOf(e);void 0===t&&(t=0);t^=-1;for(var i=0,o=e.length;i<o;i++)n=r?e[i]:e.charCodeAt(i),t=t>>>8^a[255&(t^n)];return-1^t}},{"./utils":21}],5:[function(e,t,n){"use strict";var r=e("./utils");function i(e){this.data=null,this.length=0,this.index=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1)}},t.exports=i},{"./utils":21}],6:[function(e,t,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!1,n.date=null,n.compression=null,n.comment=null},{}],7:[function(e,t,n){"use strict";var r=e("./utils");n.string2binary=function(e){return r.string2binary(e)},n.string2Uint8Array=function(e){return r.transformTo("uint8array",e)},n.uint8Array2String=function(e){return r.transformTo("string",e)},n.string2Blob=function(e){e=r.transformTo("arraybuffer",e);return r.arrayBuffer2Blob(e)},n.arrayBuffer2Blob=function(e){return r.arrayBuffer2Blob(e)},n.transformTo=function(e,t){return r.transformTo(e,t)},n.getTypeOf=function(e){return r.getTypeOf(e)},n.checkSupport=function(e){return r.checkSupport(e)},n.MAX_VALUE_16BITS=r.MAX_VALUE_16BITS,n.MAX_VALUE_32BITS=r.MAX_VALUE_32BITS,n.pretty=function(e){return r.pretty(e)},n.findCompression=function(e){return r.findCompression(e)},n.isRegExp=function(e){return r.isRegExp(e)}},{"./utils":21}],8:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("pako");n.uncompressInputType=r?"uint8array":"array",n.compressInputType=r?"uint8array":"array",n.magic="\b\0",n.compress=function(e){return i.deflateRaw(e)},n.uncompress=function(e){return i.inflateRaw(e)}},{pako:24}],9:[function(e,t,n){"use strict";var r=e("./base64");function i(e,t){if(!(this instanceof i))return new i(e,t);this.files={},this.comment=null,this.root="",e&&this.load(e,t),this.clone=function(){var e,t=new i;for(e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t}}(i.prototype=e("./object")).load=e("./load"),i.support=e("./support"),i.defaults=e("./defaults"),i.utils=e("./deprecatedPublicUtils"),i.base64={encode:function(e){return r.encode(e)},decode:function(e){return r.decode(e)}},i.compressions=e("./compressions"),t.exports=i},{"./base64":1,"./compressions":3,"./defaults":6,"./deprecatedPublicUtils":7,"./load":10,"./object":13,"./support":17}],10:[function(e,t,n){"use strict";var o=e("./base64"),s=e("./zipEntries");t.exports=function(e,t){var n,r,i;for((t=t||{}).base64&&(e=o.decode(e)),n=(e=new s(e,t)).files,r=0;r<n.length;r++)i=n[r],this.file(i.fileName,i.decompressed,{binary:!0,optimizedBinaryString:!0,date:i.date,dir:i.dir,comment:i.fileComment.length?i.fileComment:null,createFolders:t.createFolders});return e.zipComment.length&&(this.comment=e.zipComment),this}},{"./base64":1,"./zipEntries":22}],11:[function(e,i,t){!function(n){"use strict";var r=function(){};if(void 0!==n){var t=!n.from;if(!t)try{n.from("foo","utf8")}catch(e){t=!0}r=t?function(e,t){return t?new n(e,t):new n(e)}:n.from.bind(n),n.alloc||(n.alloc=function(e){return new n(e)})}i.exports=function(e,t){return"number"==typeof e?n.alloc(e):r(e,t)},i.exports.test=function(e){return n.isBuffer(e)}}.call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],12:[function(e,t,n){"use strict";e=e("./uint8ArrayReader");function r(e){this.data=e,this.length=this.data.length,this.index=0}(r.prototype=new e).readData=function(e){this.checkOffset(e);var t=this.data.slice(this.index,this.index+e);return this.index+=e,t},t.exports=r},{"./uint8ArrayReader":18}],13:[function(e,t,n){"use strict";function r(e){var t;return e._data instanceof c&&(e._data=e._data.getContent(),e.options.binary=!0,e.options.base64=!1,"uint8array"===m.getTypeOf(e._data))&&(t=e._data,e._data=new Uint8Array(t.length),0!==t.length)&&e._data.set(t,0),e._data}function i(e){var t=r(e);return"string"===m.getTypeOf(t)?!e.options.binary&&l.nodebuffer?d(t,"utf-8"):e.asBinary():t}function o(e){var t=r(this);return null==t?"":(this.options.base64&&(t=v.decode(t)),t=e&&this.options.binary?R.utf8decode(t):m.transformTo("string",t),e||this.options.binary?t:m.transformTo("string",R.utf8encode(t)))}function s(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this._data=t,this.options=n,this._initialMetadata={dir:n.dir,date:n.date}}function f(e,t){for(var n="",r=0;r<t;r++)n+=String.fromCharCode(255&e),e>>>=8;return n}function a(e,t){return"/"!=e.slice(-1)&&(e+="/"),t=void 0!==t&&t,this.files[e]||T.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]}function p(e,t){var n,r=new c;return e._data instanceof c?(r.uncompressedSize=e._data.uncompressedSize,r.crc32=e._data.crc32,0===r.uncompressedSize||e.dir?(t=b.STORE,r.compressedContent="",r.crc32=0):e._data.compressionMethod===t.magic?r.compressedContent=e._data.getCompressedContent():(n=e._data.getContent(),r.compressedContent=t.compress(m.transformTo(t.compressInputType,n)))):((n=i(e))&&0!==n.length&&!e.dir||(t=b.STORE,n=""),r.uncompressedSize=n.length,r.crc32=h(n),r.compressedContent=t.compress(m.transformTo(t.compressInputType,n))),r.compressedSize=r.compressedContent.length,r.compressionMethod=t.magic,r}function g(e,t,n,r){n.compressedContent;var i,o=m.transformTo("string",E.utf8encode(t.name)),s=t.comment||"",a=m.transformTo("string",E.utf8encode(s)),l=o.length!==t.name.length,s=a.length!==s.length,u=t.options,c="",d=(t._initialMetadata.dir!==t.dir?t:u).dir,u=(t=(t._initialMetadata.date!==t.date?t:u).date).getHours(),t=(u<<=6,u=(u=(u|t.getMinutes())<<5)|t.getSeconds()/2,i=t.getFullYear()-1980,i<<=4,i=(i=(i|t.getMonth()+1)<<5)|t.getDate(),l&&(t=f(1,1)+f(h(o),4)+o,c+="up"+f(t.length,2)+t),s&&(t=f(1,1)+f(this.crc32(a),4)+a,c+="uc"+f(t.length,2)+t),""),t=(t=(t=(t=(t=(t=(t=(t=(t+="\n\0")+(l||s?"\0\b":"\0\0")+n.compressionMethod)+f(u,2))+f(i,2))+f(n.crc32,4))+f(n.compressedSize,4))+f(n.uncompressedSize,4))+f(o.length,2))+f(c.length,2);return{fileRecord:y.LOCAL_FILE_HEADER+t+o+c,dirRecord:y.CENTRAL_FILE_HEADER+"\0"+t+f(a.length,2)+"\0\0\0\0"+(!0===d?"\0\0\0":"\0\0\0\0")+f(r,4)+o+c+a,compressedObject:n}}var l=e("./support"),m=e("./utils"),h=e("./crc32"),y=e("./signature"),u=e("./defaults"),v=e("./base64"),b=e("./compressions"),c=e("./compressedObject"),d=e("./nodeBuffer"),E=e("./utf8"),C=e("./stringWriter"),w=e("./uint8ArrayWriter"),S=(s.prototype={asText:function(){return o.call(this,!0)},asBinary:function(){return o.call(this,!1)},asNodeBuffer:function(){var e=i(this);return m.transformTo("nodebuffer",e)},asUint8Array:function(){var e=i(this);return m.transformTo("uint8array",e)},asArrayBuffer:function(){return this.asUint8Array().buffer}},function(){for(var e,t={},n=0;n<arguments.length;n++)for(e in arguments[n])arguments[n].hasOwnProperty(e)&&void 0===t[e]&&(t[e]=arguments[n][e]);return t}),T=function(e,t,n){var r=m.getTypeOf(t);if(!0!==(i=(i=n)||{}).base64||null!==i.binary&&void 0!==i.binary||(i.binary=!0),(i=S(i,u)).date=i.date||new Date,null!==i.compression&&(i.compression=i.compression.toUpperCase()),(n=i).createFolders&&(i=function(e){if(e.slice(-1)=="/")e=e.substring(0,e.length-1);var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""}(e))&&a.call(this,i,!0),n.dir||null==t)n.base64=!1,n.binary=!1,t=null;else if("string"===r)n.binary&&!n.base64&&!0!==n.optimizedBinaryString&&(t=m.string2binary(t));else{if(n.base64=!1,n.binary=!0,!(r||t instanceof c))throw new Error("The data of '"+e+"' is in an unsupported format !");"arraybuffer"===r&&(t=m.transformTo("uint8array",t))}var i=new s(e,t,n);return this.files[e]=i},R={load:function(e,t){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(e){var t,n,r,i=[];for(t in this.files)this.files.hasOwnProperty(t)&&(r=this.files[t],r=new s(r.name,r._data,S(r.options)),n=t.slice(this.root.length,t.length),t.slice(0,this.root.length)===this.root)&&e(n,r)&&i.push(r);return i},file:function(n,e,t){var r;return 1===arguments.length?m.isRegExp(n)?(r=n,this.filter(function(e,t){return!t.dir&&r.test(e)})):this.filter(function(e,t){return!t.dir&&e===n})[0]||null:(n=this.root+n,T.call(this,n,e,t),this)},folder:function(n){var e,t;return n?m.isRegExp(n)?this.filter(function(e,t){return t.dir&&n.test(e)}):(e=this.root+n,e=a.call(this,e),(t=this.clone()).root=e.name,t):this},remove:function(n){n=this.root+n;var e=this.files[n];if(e||("/"!=n.slice(-1)&&(n+="/"),e=this.files[n]),e&&!e.dir)delete this.files[n];else for(var t=this.filter(function(e,t){return t.name.slice(0,n.length)===n}),r=0;r<t.length;r++)delete this.files[t[r].name];return this},generate:function(e){e=S(e||{},{base64:!0,compression:"STORE",type:"base64",comment:null}),m.checkSupport(e.type);var t,n=[],r=0,i=0,o=m.transformTo("string",this.utf8encode(e.comment||this.comment||""));for(t in this.files)if(this.files.hasOwnProperty(t)){var s=this.files[t],a=s.options.compression||e.compression.toUpperCase(),l=b[a];if(!l)throw new Error(a+" is not a valid compression method !");a=p.call(this,s,l),l=g.call(this,t,s,a,r);r+=l.fileRecord.length+a.compressedSize,i+=l.dirRecord.length,n.push(l)}for(var o=y.CENTRAL_DIRECTORY_END+"\0\0\0\0"+f(n.length,2)+f(n.length,2)+f(i,4)+f(r,4)+f(o.length,2)+o,u=e.type.toLowerCase(),c=new("uint8array"===u||"arraybuffer"===u||"blob"===u||"nodebuffer"===u?w:C)(r+i+o.length),d=0;d<n.length;d++)c.append(n[d].fileRecord),c.append(n[d].compressedObject.compressedContent);for(d=0;d<n.length;d++)c.append(n[d].dirRecord);c.append(o);var h=c.finalize();switch(e.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return m.transformTo(e.type.toLowerCase(),h);case"blob":return m.arrayBuffer2Blob(m.transformTo("arraybuffer",h));case"base64":return e.base64?v.encode(h):h;default:return h}},crc32:function(e,t){return h(e,t)},utf8encode:function(e){return m.transformTo("string",E.utf8encode(e))},utf8decode:function(e){return E.utf8decode(e)}};t.exports=R},{"./base64":1,"./compressedObject":2,"./compressions":3,"./crc32":4,"./defaults":6,"./nodeBuffer":11,"./signature":14,"./stringWriter":16,"./support":17,"./uint8ArrayWriter":19,"./utf8":20,"./utils":21}],14:[function(e,t,n){"use strict";n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],15:[function(e,t,n){"use strict";var r=e("./dataReader"),i=e("./utils");function o(e,t){this.data=e,t||(this.data=i.string2binary(this.data)),this.length=this.data.length,this.index=0}(o.prototype=new r).byteAt=function(e){return this.data.charCodeAt(e)},o.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)},o.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.index,this.index+e);return this.index+=e,t},t.exports=o},{"./dataReader":5,"./utils":21}],16:[function(e,t,n){"use strict";function r(){this.data=[]}var i=e("./utils");r.prototype={append:function(e){e=i.transformTo("string",e),this.data.push(e)},finalize:function(){return this.data.join("")}},t.exports=r},{"./utils":21}],17:[function(e,t,r){!function(t){"use strict";if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer=void 0!==t,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{t=new ArrayBuffer(0);try{r.blob=0===new Blob([t],{type:"application/zip"}).size}catch(e){try{var n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);n.append(t),r.blob=0===n.getBlob("application/zip").size}catch(e){r.blob=!1}}}}.call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],18:[function(e,t,n){"use strict";e=e("./dataReader");function r(e){e&&(this.data=e,this.length=this.data.length,this.index=0)}(r.prototype=new e).byteAt=function(e){return this.data[e]},r.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),o=this.length-4;0<=o;--o)if(this.data[o]===t&&this.data[o+1]===n&&this.data[o+2]===r&&this.data[o+3]===i)return o;return-1},r.prototype.readData=function(e){var t;return this.checkOffset(e),0===e?new Uint8Array(0):(t=this.data.subarray(this.index,this.index+e),this.index+=e,t)},t.exports=r},{"./dataReader":5}],19:[function(e,t,n){"use strict";function r(e){this.data=new Uint8Array(e),this.index=0}var i=e("./utils");r.prototype={append:function(e){0!==e.length&&(e=i.transformTo("uint8array",e),this.data.set(e,this.index),this.index+=e.length)},finalize:function(){return this.data}},t.exports=r},{"./utils":21}],20:[function(e,t,n){"use strict";for(var a=e("./utils"),u=e("./support"),c=e("./nodeBuffer"),l=new Array(256),r=0;r<256;r++)l[r]=252<=r?6:248<=r?5:240<=r?4:224<=r?3:192<=r?2:1;l[254]=l[254]=1;function o(e){for(var t,n,r=e.length,i=new Array(2*r),o=0,s=0;s<r;)if((t=e[s++])<128)i[o++]=t;else if(4<(n=l[t]))i[o++]=65533,s+=n-1;else{for(t&=2===n?31:3===n?15:7;1<n&&s<r;)t=t<<6|63&e[s++],n--;1<n?i[o++]=65533:t<65536?i[o++]=t:(t-=65536,i[o++]=55296|t>>10&1023,i[o++]=56320|1023&t)}return i.length!==o&&(i.subarray?i=i.subarray(0,o):i.length=o),a.applyFromCharCode(i)}n.utf8encode=function(e){if(u.nodebuffer)return c(e,"utf-8");for(var t,n,r,i,o=e,s=o.length,a=0,l=0;l<s;l++)55296==(64512&(n=o.charCodeAt(l)))&&l+1<s&&56320==(64512&(r=o.charCodeAt(l+1)))&&(n=65536+(n-55296<<10)+(r-56320),l++),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new(u.uint8array?Uint8Array:Array)(a),l=i=0;i<a;l++)55296==(64512&(n=o.charCodeAt(l)))&&l+1<s&&56320==(64512&(r=o.charCodeAt(l+1)))&&(n=65536+(n-55296<<10)+(r-56320),l++),n<128?t[i++]=n:(n<2048?t[i++]=192|n>>>6:(n<65536?t[i++]=224|n>>>12:(t[i++]=240|n>>>18,t[i++]=128|n>>>12&63),t[i++]=128|n>>>6&63),t[i++]=128|63&n);return t},n.utf8decode=function(e){if(u.nodebuffer)return a.transformTo("nodebuffer",e).toString("utf-8");for(var t=[],n=0,r=(e=a.transformTo(u.uint8array?"uint8array":"array",e)).length;n<r;){var i=function(e,t){for(var n=(t=(t=t||e.length)>e.length?e.length:t)-1;0<=n&&128==(192&e[n]);)n--;return!(n<0)&&0!==n&&n+l[e[n]]>t?n:t}(e,Math.min(n+65536,r));u.uint8array?t.push(o(e.subarray(n,i))):t.push(o(e.slice(n,i))),n=i}return t.join("")}},{"./nodeBuffer":11,"./support":17,"./utils":21}],21:[function(e,t,u){"use strict";var n=e("./support"),r=e("./compressions"),c=e("./nodeBuffer");function i(e){return e}function o(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}function s(e){var t=65536,n=[],r=e.length,i=u.getTypeOf(e),o=0,s=!0;try{switch(i){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,c(0))}}catch(e){s=!1}if(!s){for(var a="",l=0;l<e.length;l++)a+=String.fromCharCode(e[l]);return a}for(;o<r&&1<t;)try{n.push("array"===i||"nodebuffer"===i?String.fromCharCode.apply(null,e.slice(o,Math.min(o+t,r))):String.fromCharCode.apply(null,e.subarray(o,Math.min(o+t,r)))),o+=t}catch(e){t=Math.floor(t/2)}return n.join("")}function a(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}u.string2binary=function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(255&e.charCodeAt(n));return t},u.arrayBuffer2Blob=function(t){u.checkSupport("blob");try{return new Blob([t],{type:"application/zip"})}catch(e){try{var n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return n.append(t),n.getBlob("application/zip")}catch(e){throw new Error("Bug : can't construct the Blob.")}}},u.applyFromCharCode=s;var l={};l.string={string:i,array:function(e){return o(e,new Array(e.length))},arraybuffer:function(e){return l.string.uint8array(e).buffer},uint8array:function(e){return o(e,new Uint8Array(e.length))},nodebuffer:function(e){return o(e,c(e.length))}},l.array={string:s,array:i,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return c(e)}},l.arraybuffer={string:function(e){return s(new Uint8Array(e))},array:function(e){return a(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:i,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return c(new Uint8Array(e))}},l.uint8array={string:s,array:function(e){return a(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:i,nodebuffer:function(e){return c(e)}},l.nodebuffer={string:s,array:function(e){return a(e,new Array(e.length))},arraybuffer:function(e){return l.nodebuffer.uint8array(e).buffer},uint8array:function(e){return a(e,new Uint8Array(e.length))},nodebuffer:i},u.transformTo=function(e,t){if(t=t||"",!e)return t;u.checkSupport(e);var n=u.getTypeOf(t);return l[n][e](t)},u.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":n.nodebuffer&&c.test(e)?"nodebuffer":n.uint8array&&e instanceof Uint8Array?"uint8array":n.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},u.checkSupport=function(e){if(!n[e.toLowerCase()])throw new Error(e+" is not supported by this browser")},u.MAX_VALUE_16BITS=65535,u.MAX_VALUE_32BITS=-1,u.pretty=function(e){for(var t,n="",r=0;r<(e||"").length;r++)n+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return n},u.findCompression=function(e){for(var t in r)if(r.hasOwnProperty(t)&&r[t].magic===e)return r[t];return null},u.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)}},{"./compressions":3,"./nodeBuffer":11,"./support":17}],22:[function(e,t,n){"use strict";var r=e("./stringReader"),i=e("./nodeBufferReader"),o=e("./uint8ArrayReader"),s=e("./utils"),a=e("./signature"),l=e("./zipEntry"),u=e("./support"),c=e("./object");function d(e,t){this.files=[],this.loadOptions=t,e&&this.load(e)}d.prototype={checkSignature:function(e){var t=this.reader.readString(4);if(t!==e)throw new Error("Corrupted zip or bug : unexpected signature ("+s.pretty(t)+", expected "+s.pretty(e)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength),this.zipComment=c.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,r=this.zip64EndOfCentralSize-44;0<r;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readString(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){for(var e,t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===a.CENTRAL_FILE_HEADER;)(e=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(-1===e)throw new Error("Corrupted zip : can't find end of central directory");if(this.reader.setIndex(e),this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,-1===(e=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR)))throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(e),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(e){var t=s.getTypeOf(e);"string"!==t||u.uint8array?this.reader="nodebuffer"===t?new i(e):new o(s.transformTo("uint8array",e)):this.reader=new r(e,this.loadOptions.optimizedBinaryString)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=d},{"./nodeBufferReader":12,"./object":13,"./signature":14,"./stringReader":15,"./support":17,"./uint8ArrayReader":18,"./utils":21,"./zipEntry":23}],23:[function(e,t,n){"use strict";var r=e("./stringReader"),o=e("./utils"),i=e("./compressedObject"),s=e("./object");function a(e,t){this.options=e,this.loadOptions=t}a.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},prepareCompressedContent:function(n,r,i){return function(){var e=n.index,t=(n.setIndex(r),n.readData(i));return n.setIndex(e),t}},prepareContent:function(e,t,n,r,i){return function(){var e=o.transformTo(r.uncompressInputType,this.getCompressedContent()),e=r.uncompress(e);if(e.length!==i)throw new Error("Bug : uncompressed data size mismatch");return e}},readLocalPart:function(e){var t;if(e.skip(22),this.fileNameLength=e.readInt(2),t=e.readInt(2),this.fileName=e.readString(this.fileNameLength),e.skip(t),-1==this.compressedSize||-1==this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(null===(t=o.findCompression(this.compressionMethod)))throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");if(this.decompressed=new i,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(e,e.index,this.compressedSize,t),this.decompressed.getContent=this.prepareContent(e,e.index,this.compressedSize,t,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=o.transformTo("string",this.decompressed.getContent()),s.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(e){if(this.versionMadeBy=e.readString(2),this.versionNeeded=e.readInt(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4),this.fileNameLength=e.readInt(2),this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=e.readString(this.fileNameLength),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readString(this.fileCommentLength),this.dir=!!(16&this.externalFileAttributes)},parseZIP64ExtraField:function(e){var t;this.extraFields[1]&&(t=new r(this.extraFields[1].value),this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS)&&(this.diskNumberStart=t.readInt(4))},readExtraFields:function(e){var t,n,r,i=e.index;for(this.extraFields=this.extraFields||{};e.index<i+this.extraFieldsLength;)t=e.readInt(2),n=e.readInt(2),r=e.readString(n),this.extraFields[t]={id:t,length:n,value:r}},handleUTF8:function(){var e;this.useUTF8()?(this.fileName=s.utf8decode(this.fileName),this.fileComment=s.utf8decode(this.fileComment)):(null!==(e=this.findExtraFieldUnicodePath())&&(this.fileName=e),null!==(e=this.findExtraFieldUnicodeComment())&&(this.fileComment=e))},findExtraFieldUnicodePath:function(){var e,t=this.extraFields[28789];return!t||1!==(e=new r(t.value)).readInt(1)||s.crc32(this.fileName)!==e.readInt(4)?null:s.utf8decode(e.readString(t.length-5))},findExtraFieldUnicodeComment:function(){var e,t=this.extraFields[25461];return!t||1!==(e=new r(t.value)).readInt(1)||s.crc32(this.fileComment)!==e.readInt(4)?null:s.utf8decode(e.readString(t.length-5))}},t.exports=a},{"./compressedObject":2,"./object":13,"./stringReader":15,"./utils":21}],24:[function(e,t,n){"use strict";var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":25,"./lib/inflate":26,"./lib/utils/common":27,"./lib/zlib/constants":30}],25:[function(e,t,n){"use strict";function r(e){this.options=a.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});(e=this.options).raw&&0<e.windowBits?e.windowBits=-e.windowBits:e.gzip&&0<e.windowBits&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var t=s.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(0!==t)throw new Error(i[t]);e.header&&s.deflateSetHeader(this.strm,e.header)}var s=e("./zlib/deflate.js"),a=e("./utils/common"),l=e("./utils/strings"),i=e("./zlib/messages"),o=e("./zlib/zstream");function u(e,t){t=new r(t);if(t.push(e,!0),t.err)throw t.msg;return t.result}r.prototype.push=function(e,t){var n,r,i=this.strm,o=this.options.chunkSize;if(this.ended)return!1;r=t===~~t?t:!0===t?4:0,i.input="string"==typeof e?l.string2buf(e):e,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new a.Buf8(o),i.next_out=0,i.avail_out=o),1!==(n=s.deflate(i,r))&&0!==n)return this.onEnd(n),!(this.ended=!0)}while((0===i.avail_out||0===i.avail_in&&4===r)&&("string"===this.options.to?this.onData(l.buf2binstring(a.shrinkBuf(i.output,i.next_out))):this.onData(a.shrinkBuf(i.output,i.next_out))),(0<i.avail_in||0===i.avail_out)&&1!==n);return 4!==r||(n=s.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n)},r.prototype.onData=function(e){this.chunks.push(e)},r.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=r,n.deflate=u,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,u(e,t)}},{"./utils/common":27,"./utils/strings":28,"./zlib/deflate.js":32,"./zlib/messages":37,"./zlib/zstream":39}],26:[function(e,t,n){"use strict";function r(e){this.options=c.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;if(t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits)&&(t.windowBits=-15),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0,(e=u.inflateInit2(this.strm,t.windowBits))!==h.Z_OK)throw new Error(i[e]);this.header=new s,u.inflateGetHeader(this.strm,this.header)}var u=e("./zlib/inflate.js"),c=e("./utils/common"),d=e("./utils/strings"),h=e("./zlib/constants"),i=e("./zlib/messages"),o=e("./zlib/zstream"),s=e("./zlib/gzheader");function a(e,t){t=new r(t);if(t.push(e,!0),t.err)throw t.msg;return t.result}r.prototype.push=function(e,t){var n,r,i,o,s,a=this.strm,l=this.options.chunkSize;if(this.ended)return!1;r=t===~~t?t:!0===t?h.Z_FINISH:h.Z_NO_FLUSH,a.input="string"==typeof e?d.binstring2buf(e):e,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new c.Buf8(l),a.next_out=0,a.avail_out=l),(n=u.inflate(a,h.Z_NO_FLUSH))!==h.Z_STREAM_END&&n!==h.Z_OK)return this.onEnd(n),!(this.ended=!0)}while(a.next_out&&(0===a.avail_out||n===h.Z_STREAM_END||0===a.avail_in&&r===h.Z_FINISH)&&("string"===this.options.to?(i=d.utf8border(a.output,a.next_out),o=a.next_out-i,s=d.buf2string(a.output,i),a.next_out=o,a.avail_out=l-o,o&&c.arraySet(a.output,a.output,i,o,0),this.onData(s)):this.onData(c.shrinkBuf(a.output,a.next_out))),0<a.avail_in&&n!==h.Z_STREAM_END);return(r=n===h.Z_STREAM_END?h.Z_FINISH:r)!==h.Z_FINISH||(n=u.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===h.Z_OK)},r.prototype.onData=function(e){this.chunks.push(e)},r.prototype.onEnd=function(e){e===h.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=r,n.inflate=a,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,a(e,t)},n.ungzip=a},{"./utils/common":27,"./utils/strings":28,"./zlib/constants":30,"./zlib/gzheader":33,"./zlib/inflate.js":35,"./zlib/messages":37,"./zlib/zstream":39}],27:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array,i=(n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}}return e},n.shrinkBuf=function(e,t){if(e.length!==t){if(e.subarray)return e.subarray(0,t);e.length=t}return e},{arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var o=0;o<r;o++)e[i+o]=t[n+o]},flattenChunks:function(e){for(var t,n,r,i=0,o=0,s=e.length;o<s;o++)i+=e[o].length;for(r=new Uint8Array(i),o=t=0,s=e.length;o<s;o++)n=e[o],r.set(n,t),t+=n.length;return r}}),o={arraySet:function(e,t,n,r,i){for(var o=0;o<r;o++)e[i+o]=t[n+o]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(r)},{}],28:[function(e,t,n){"use strict";var l=e("./common"),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var u=new l.Buf8(256),r=0;r<256;r++)u[r]=252<=r?6:248<=r?5:240<=r?4:224<=r?3:192<=r?2:1;function c(e,t){if(t<65537&&(e.subarray&&o||!e.subarray&&i))return String.fromCharCode.apply(null,l.shrinkBuf(e,t));for(var n="",r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n}u[254]=u[254]=1,n.string2buf=function(e){for(var t,n,r,i,o=e.length,s=0,a=0;a<o;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new l.Buf8(s),a=i=0;i<s;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),n<128?t[i++]=n:(n<2048?t[i++]=192|n>>>6:(n<65536?t[i++]=224|n>>>12:(t[i++]=240|n>>>18,t[i++]=128|n>>>12&63),t[i++]=128|n>>>6&63),t[i++]=128|63&n);return t},n.buf2binstring=function(e){return c(e,e.length)},n.binstring2buf=function(e){for(var t=new l.Buf8(e.length),n=0,r=t.length;n<r;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){for(var n,r,i=t||e.length,o=new Array(2*i),s=0,a=0;a<i;)if((n=e[a++])<128)o[s++]=n;else if(4<(r=u[n]))o[s++]=65533,a+=r-1;else{for(n&=2===r?31:3===r?15:7;1<r&&a<i;)n=n<<6|63&e[a++],r--;1<r?o[s++]=65533:n<65536?o[s++]=n:(n-=65536,o[s++]=55296|n>>10&1023,o[s++]=56320|1023&n)}return c(o,s)},n.utf8border=function(e,t){for(var n=(t=(t=t||e.length)>e.length?e.length:t)-1;0<=n&&128==(192&e[n]);)n--;return!(n<0)&&0!==n&&n+u[e[n]]>t?n:t}},{"./common":27}],29:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){for(var i=65535&e|0,o=e>>>16&65535|0,s=0;0!==n;){for(n-=s=2e3<n?2e3:n;o=o+(i=i+t[r++]|0)|0,--s;);i%=65521,o%=65521}return i|o<<16|0}},{}],30:[function(e,t,n){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(e,t,n){"use strict";var a=function(){for(var e=[],t=0;t<256;t++){for(var n=t,r=0;r<8;r++)n=1&n?3988292384^n>>>1:n>>>1;e[t]=n}return e}();t.exports=function(e,t,n,r){var i=a,o=r+n;e^=-1;for(var s=r;s<o;s++)e=e>>>8^i[255&(e^t[s])];return-1^e}},{}],32:[function(e,P,t){"use strict";var d=e("../utils/common"),a=e("./trees"),F=e("./adler32"),h=e("./crc32"),B=e("./messages"),l=0,u=4,c=0,f=-2,H=-1,U=4,V=2,p=8,W=9,n=286,$=30,j=19,z=2*n+1,G=15,g=3,m=258,y=m+g+1,v=42,b=113,E=1,C=2,w=3,S=4;function T(e,t){return e.msg=B[t],t}function R(e){return(e<<1)-(4<e?9:0)}function A(e){for(var t=e.length;0<=--t;)e[t]=0}function _(e){var t=e.state,n=t.pending;0!==(n=n>e.avail_out?e.avail_out:n)&&(d.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending)&&(t.pending_out=0)}function N(e,t){a._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,_(e.strm)}function x(e,t){e.pending_buf[e.pending++]=t}function O(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function o(e,t){var n,r,i=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match,l=e.strstart>e.w_size-y?e.strstart-(e.w_size-y):0,u=e.window,c=e.w_mask,d=e.prev,h=e.strstart+m,f=u[o+s-1],p=u[o+s];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do{if(u[(n=t)+s]===p&&u[n+s-1]===f&&u[n]===u[o]&&u[++n]===u[o+1]){for(o+=2,n++;u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&o<h;);if(r=m-(h-o),o=h-m,s<r){if(e.match_start=t,a<=(s=r))break;f=u[o+s-1],p=u[o+s]}}}while((t=d[t&c])>l&&0!=--i);return s<=e.lookahead?s:e.lookahead}function I(e){var t,n,r,i,o,s,a,l,u,c=e.w_size;do{if(l=e.window_size-e.lookahead-e.strstart,e.strstart>=c+(c-y)){for(d.arraySet(e.window,e.window,c,c,0),e.match_start-=c,e.strstart-=c,e.block_start-=c,t=n=e.hash_size;r=e.head[--t],e.head[t]=c<=r?r-c:0,--n;);for(t=n=c;r=e.prev[--t],e.prev[t]=c<=r?r-c:0,--n;);l+=c}if(0===e.strm.avail_in)break;if(o=e.strm,s=e.window,a=e.strstart+e.lookahead,l=l,u=void 0,u=o.avail_in,n=0===(u=l<u?l:u)?0:(o.avail_in-=u,d.arraySet(s,o.input,o.next_in,u,a),1===o.state.wrap?o.adler=F(o.adler,s,u,a):2===o.state.wrap&&(o.adler=h(o.adler,s,u,a)),o.next_in+=u,o.total_in+=u,u),e.lookahead+=n,e.lookahead+e.insert>=g)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=(e.ins_h<<e.hash_shift^e.window[i+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[i+g-1])&e.hash_mask,e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<g)););}while(e.lookahead<y&&0!==e.strm.avail_in)}function r(e,t){for(var n,r;;){if(e.lookahead<y){if(I(e),e.lookahead<y&&t===l)return E;if(0===e.lookahead)break}if(n=0,e.lookahead>=g&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+g-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-y&&(e.match_length=o(e,n)),e.match_length>=g)if(r=a._tr_tally(e,e.strstart-e.match_start,e.match_length-g),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=g){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+g-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(N(e,!1),0===e.strm.avail_out))return E}return e.insert=e.strstart<g-1?e.strstart:g-1,t===u?(N(e,!0),0===e.strm.avail_out?w:S):e.last_lit&&(N(e,!1),0===e.strm.avail_out)?E:C}function i(e,t){for(var n,r,i;;){if(e.lookahead<y){if(I(e),e.lookahead<y&&t===l)return E;if(0===e.lookahead)break}if(n=0,e.lookahead>=g&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+g-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=g-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-y&&(e.match_length=o(e,n),e.match_length<=5)&&(1===e.strategy||e.match_length===g&&4096<e.strstart-e.match_start)&&(e.match_length=g-1),e.prev_length>=g&&e.match_length<=e.prev_length){for(i=e.strstart+e.lookahead-g,r=a._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-g),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+g-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=g-1,e.strstart++,r&&(N(e,!1),0===e.strm.avail_out))return E}else if(e.match_available){if((r=a._tr_tally(e,0,e.window[e.strstart-1]))&&N(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return E}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=a._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<g-1?e.strstart:g-1,t===u?(N(e,!0),0===e.strm.avail_out?w:S):e.last_lit&&(N(e,!1),0===e.strm.avail_out)?E:C}function s(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}var M;function Y(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=p,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new d.Buf16(2*z),this.dyn_dtree=new d.Buf16(2*(2*$+1)),this.bl_tree=new d.Buf16(2*(2*j+1)),A(this.dyn_ltree),A(this.dyn_dtree),A(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new d.Buf16(G+1),this.heap=new d.Buf16(2*n+1),A(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new d.Buf16(2*n+1),A(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function k(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=V,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?v:b,e.adler=2===t.wrap?0:1,t.last_flush=l,a._tr_init(t),c):T(e,f)}function D(e){var t=k(e);return t===c&&((e=e.state).window_size=2*e.w_size,A(e.head),e.max_lazy_match=M[e.level].max_lazy,e.good_match=M[e.level].good_length,e.nice_match=M[e.level].nice_length,e.max_chain_length=M[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=g-1,e.match_available=0,e.ins_h=0),t}function L(e,t,n,r,i,o){if(!e)return f;var s=1;if(t===H&&(t=6),r<0?(s=0,r=-r):15<r&&(s=2,r-=16),i<1||W<i||n!==p||r<8||15<r||t<0||9<t||o<0||U<o)return T(e,f);8===r&&(r=9);var a=new Y;return(e.state=a).strm=e,a.wrap=s,a.gzhead=null,a.w_bits=r,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+g-1)/g),a.window=new d.Buf8(2*a.w_size),a.head=new d.Buf16(a.hash_size),a.prev=new d.Buf16(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new d.Buf8(a.pending_buf_size),a.d_buf=a.lit_bufsize>>1,a.l_buf=3*a.lit_bufsize,a.level=t,a.strategy=o,a.method=n,D(e)}M=[new s(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(I(e),0===e.lookahead&&t===l)return E;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,N(e,!1),0===e.strm.avail_out))return E;if(e.strstart-e.block_start>=e.w_size-y&&(N(e,!1),0===e.strm.avail_out))return E}return e.insert=0,t===u?(N(e,!0),0===e.strm.avail_out?w:S):(e.strstart>e.block_start&&(N(e,!1),e.strm.avail_out),E)}),new s(4,4,8,4,r),new s(4,5,16,8,r),new s(4,6,32,32,r),new s(4,4,16,16,i),new s(8,16,32,32,i),new s(8,16,128,128,i),new s(8,32,128,256,i),new s(32,128,258,1024,i),new s(32,258,258,4096,i)],t.deflateInit=function(e,t){return L(e,t,p,15,8,0)},t.deflateInit2=L,t.deflateReset=D,t.deflateResetKeep=k,t.deflateSetHeader=function(e,t){return!e||!e.state||2!==e.state.wrap?f:(e.state.gzhead=t,c)},t.deflate=function(e,t){var n,r,i,o;if(!e||!e.state||5<t||t<0)return e?T(e,f):f;if(r=e.state,!e.output||!e.input&&0!==e.avail_in||666===r.status&&t!==u)return T(e,0===e.avail_out?-5:f);if(r.strm=e,n=r.last_flush,r.last_flush=t,r.status===v&&(2===r.wrap?(e.adler=0,x(r,31),x(r,139),x(r,8),r.gzhead?(x(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),x(r,255&r.gzhead.time),x(r,r.gzhead.time>>8&255),x(r,r.gzhead.time>>16&255),x(r,r.gzhead.time>>24&255),x(r,9===r.level?2:2<=r.strategy||r.level<2?4:0),x(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(x(r,255&r.gzhead.extra.length),x(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=h(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(x(r,0),x(r,0),x(r,0),x(r,0),x(r,0),x(r,9===r.level?2:2<=r.strategy||r.level<2?4:0),x(r,3),r.status=b)):(s=p+(r.w_bits-8<<4)<<8,s|=(2<=r.strategy||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(s|=32),s+=31-s%31,r.status=b,O(r,s),0!==r.strstart&&(O(r,e.adler>>>16),O(r,65535&e.adler)),e.adler=1)),69===r.status)if(r.gzhead.extra){for(i=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>i&&(e.adler=h(e.adler,r.pending_buf,r.pending-i,i)),_(e),i=r.pending,r.pending!==r.pending_buf_size));)x(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>i&&(e.adler=h(e.adler,r.pending_buf,r.pending-i,i)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){i=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(e.adler=h(e.adler,r.pending_buf,r.pending-i,i)),_(e),i=r.pending,r.pending===r.pending_buf_size)){o=1;break}}while(o=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,x(r,o),0!==o);r.gzhead.hcrc&&r.pending>i&&(e.adler=h(e.adler,r.pending_buf,r.pending-i,i)),0===o&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){i=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(e.adler=h(e.adler,r.pending_buf,r.pending-i,i)),_(e),i=r.pending,r.pending===r.pending_buf_size)){o=1;break}}while(o=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,x(r,o),0!==o);r.gzhead.hcrc&&r.pending>i&&(e.adler=h(e.adler,r.pending_buf,r.pending-i,i)),0===o&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&_(e),r.pending+2<=r.pending_buf_size&&(x(r,255&e.adler),x(r,e.adler>>8&255),e.adler=0,r.status=b)):r.status=b),0!==r.pending){if(_(e),0===e.avail_out)return r.last_flush=-1,c}else if(0===e.avail_in&&R(t)<=R(n)&&t!==u)return T(e,-5);if(666===r.status&&0!==e.avail_in)return T(e,-5);if(0!==e.avail_in||0!==r.lookahead||t!==l&&666!==r.status){var s=2===r.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(I(e),0===e.lookahead)){if(t===l)return E;break}if(e.match_length=0,n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(N(e,!1),0===e.strm.avail_out))return E}return e.insert=0,t===u?(N(e,!0),0===e.strm.avail_out?w:S):e.last_lit&&(N(e,!1),0===e.strm.avail_out)?E:C}(r,t):3===r.strategy?function(e,t){for(var n,r,i,o,s=e.window;;){if(e.lookahead<=m){if(I(e),e.lookahead<=m&&t===l)return E;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=g&&0<e.strstart&&(r=s[i=e.strstart-1])===s[++i]&&r===s[++i]&&r===s[++i]){for(o=e.strstart+m;r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<o;);e.match_length=m-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=g?(n=a._tr_tally(e,1,e.match_length-g),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(N(e,!1),0===e.strm.avail_out))return E}return e.insert=0,t===u?(N(e,!0),0===e.strm.avail_out?w:S):e.last_lit&&(N(e,!1),0===e.strm.avail_out)?E:C}(r,t):M[r.level].func(r,t);if(s!==w&&s!==S||(r.status=666),s===E||s===w)return 0===e.avail_out&&(r.last_flush=-1),c;if(s===C&&(1===t?a._tr_align(r):5!==t&&(a._tr_stored_block(r,0,0,!1),3===t)&&(A(r.head),0===r.lookahead)&&(r.strstart=0,r.block_start=0,r.insert=0),_(e),0===e.avail_out))return r.last_flush=-1,c}return t!==u||!(r.wrap<=0)&&(2===r.wrap?(x(r,255&e.adler),x(r,e.adler>>8&255),x(r,e.adler>>16&255),x(r,e.adler>>24&255),x(r,255&e.total_in),x(r,e.total_in>>8&255),x(r,e.total_in>>16&255),x(r,e.total_in>>24&255)):(O(r,e.adler>>>16),O(r,65535&e.adler)),_(e),0<r.wrap&&(r.wrap=-r.wrap),0!==r.pending)?c:1},t.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==v&&69!==t&&73!==t&&91!==t&&103!==t&&t!==b&&666!==t?T(e,f):(e.state=null,t===b?T(e,-3):c):f},t.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./messages":37,"./trees":38}],33:[function(e,t,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],34:[function(e,t,n){"use strict";t.exports=function(e,t){var n,r,i,o,s,a,l,u,c,d,h,f,p,g,m,y,v,b,E,C,w,S,T,R,A=e.state;n=e.next_in,T=e.input,r=n+(e.avail_in-5),i=e.next_out,R=e.output,o=i-(t-e.avail_out),s=i+(e.avail_out-257),a=A.dmax,l=A.wsize,u=A.whave,c=A.wnext,d=A.window,h=A.hold,f=A.bits,p=A.lencode,g=A.distcode,m=(1<<A.lenbits)-1,y=(1<<A.distbits)-1;e:do{for(f<15&&(h+=T[n++]<<f,f+=8,h+=T[n++]<<f,f+=8),v=p[h&m];;){if(h>>>=b=v>>>24,f-=b,0===(b=v>>>16&255))R[i++]=65535&v;else{if(!(16&b)){if(0==(64&b)){v=p[(65535&v)+(h&(1<<b)-1)];continue}if(32&b){A.mode=12;break e}e.msg="invalid literal/length code",A.mode=30;break e}for(E=65535&v,(b&=15)&&(f<b&&(h+=T[n++]<<f,f+=8),E+=h&(1<<b)-1,h>>>=b,f-=b),f<15&&(h+=T[n++]<<f,f+=8,h+=T[n++]<<f,f+=8),v=g[h&y];;){if(h>>>=b=v>>>24,f-=b,!(16&(b=v>>>16&255))){if(0==(64&b)){v=g[(65535&v)+(h&(1<<b)-1)];continue}e.msg="invalid distance code",A.mode=30;break e}if(C=65535&v,f<(b&=15)&&(h+=T[n++]<<f,(f+=8)<b)&&(h+=T[n++]<<f,f+=8),a<(C+=h&(1<<b)-1)){e.msg="invalid distance too far back",A.mode=30;break e}if(h>>>=b,f-=b,(b=i-o)<C){if(u<(b=C-b)&&A.sane){e.msg="invalid distance too far back",A.mode=30;break e}if(S=d,(w=0)===c){if(w+=l-b,b<E){for(E-=b;R[i++]=d[w++],--b;);w=i-C,S=R}}else if(c<b){if(w+=l+c-b,(b-=c)<E){for(E-=b;R[i++]=d[w++],--b;);if(w=0,c<E){for(E-=b=c;R[i++]=d[w++],--b;);w=i-C,S=R}}}else if(w+=c-b,b<E){for(E-=b;R[i++]=d[w++],--b;);w=i-C,S=R}for(;2<E;)R[i++]=S[w++],R[i++]=S[w++],R[i++]=S[w++],E-=3;E&&(R[i++]=S[w++],1<E)&&(R[i++]=S[w++])}else{for(w=i-C;R[i++]=R[w++],R[i++]=R[w++],R[i++]=R[w++],2<(E-=3););E&&(R[i++]=R[w++],1<E)&&(R[i++]=R[w++])}break}}break}}while(n<r&&i<s);h&=(1<<(f-=(E=f>>3)<<3))-1,e.next_in=n-=E,e.next_out=i,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=i<s?s-i+257:257-(i-s),A.hold=h,A.bits=f}},{}],35:[function(e,t,n){"use strict";var P=e("../utils/common"),F=e("./adler32"),B=e("./crc32"),H=e("./inffast"),U=e("./inftrees"),V=1,W=2,$=0,j=-2,z=1,r=852,i=592;function G(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function o(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new P.Buf16(320),this.work=new P.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function s(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=z,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new P.Buf32(r),t.distcode=t.distdyn=new P.Buf32(i),t.sane=1,t.back=-1,$):j}function a(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,s(e)):j}function l(e,t){var n,r;return!e||!e.state||(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t))?j:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,a(e))}function u(e,t){var n;return e?(n=new o,(e.state=n).window=null,(n=l(e,t))!==$&&(e.state=null),n):j}var Y,X,K=!0;n.inflateReset=a,n.inflateReset2=l,n.inflateResetKeep=s,n.inflateInit=function(e){return u(e,15)},n.inflateInit2=u,n.inflate=function(e,t){var n,r,i,o,s,a,l,u,c,d,h,f,p,g,m,y,v,b,E,C,w,S,T,R,A,_,N,x,O,I=0,M=new P.Buf8(4),k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return j;12===(n=e.state).mode&&(n.mode=13),s=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,r=e.input,a=e.avail_in,u=n.hold,c=n.bits,d=a,h=l,S=$;e:for(;;)switch(n.mode){case z:if(0===n.wrap)n.mode=13;else{for(;c<16;){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}if(2&n.wrap&&35615===u)M[n.check=0]=255&u,M[1]=u>>>8&255,n.check=B(n.check,M,2,0),c=u=0,n.mode=2;else if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&u)<<8)+(u>>8))%31)e.msg="incorrect header check",n.mode=30;else if(8!=(15&u))e.msg="unknown compression method",n.mode=30;else{if(c-=4,w=8+(15&(u>>>=4)),0===n.wbits)n.wbits=w;else if(w>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<w,e.adler=n.check=1,n.mode=512&u?10:12,c=u=0}}break;case 2:for(;c<16;){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}if(n.flags=u,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=u>>8&1),512&n.flags&&(M[0]=255&u,M[1]=u>>>8&255,n.check=B(n.check,M,2,0)),c=u=0,n.mode=3;case 3:for(;c<32;){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}n.head&&(n.head.time=u),512&n.flags&&(M[0]=255&u,M[1]=u>>>8&255,M[2]=u>>>16&255,M[3]=u>>>24&255,n.check=B(n.check,M,4,0)),c=u=0,n.mode=4;case 4:for(;c<16;){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}n.head&&(n.head.xflags=255&u,n.head.os=u>>8),512&n.flags&&(M[0]=255&u,M[1]=u>>>8&255,n.check=B(n.check,M,2,0)),c=u=0,n.mode=5;case 5:if(1024&n.flags){for(;c<16;){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}n.length=u,n.head&&(n.head.extra_len=u),512&n.flags&&(M[0]=255&u,M[1]=u>>>8&255,n.check=B(n.check,M,2,0)),c=u=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((f=a<(f=n.length)?a:f)&&(n.head&&(w=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),P.arraySet(n.head.extra,r,o,f,w)),512&n.flags&&(n.check=B(n.check,r,f,o)),a-=f,o+=f,n.length-=f),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===a)break e;for(f=0;w=r[o+f++],n.head&&w&&n.length<65536&&(n.head.name+=String.fromCharCode(w)),w&&f<a;);if(512&n.flags&&(n.check=B(n.check,r,f,o)),a-=f,o+=f,w)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===a)break e;for(f=0;w=r[o+f++],n.head&&w&&n.length<65536&&(n.head.comment+=String.fromCharCode(w)),w&&f<a;);if(512&n.flags&&(n.check=B(n.check,r,f,o)),a-=f,o+=f,w)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;c<16;){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}if(u!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}c=u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;c<32;){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}e.adler=n.check=G(u),c=u=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=s,e.avail_out=l,e.next_in=o,e.avail_in=a,n.hold=u,n.bits=c,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last)u>>>=7&c,c-=7&c,n.mode=27;else{for(;c<3;){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}switch(n.last=1&u,--c,3&(u>>>=1)){case 0:n.mode=14;break;case 1:D=L=void 0;var D,L=n;if(K){for(Y=new P.Buf32(512),X=new P.Buf32(32),D=0;D<144;)L.lens[D++]=8;for(;D<256;)L.lens[D++]=9;for(;D<280;)L.lens[D++]=7;for(;D<288;)L.lens[D++]=8;for(U(V,L.lens,0,288,Y,0,L.work,{bits:9}),D=0;D<32;)L.lens[D++]=5;U(W,L.lens,0,32,X,0,L.work,{bits:5}),K=!1}if(L.lencode=Y,L.lenbits=9,L.distcode=X,L.distbits=5,n.mode=20,6!==t)break;u>>>=2,c-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}u>>>=2,c-=2}break;case 14:for(u>>>=7&c,c-=7&c;c<32;){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}if((65535&u)!=(u>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&u,c=u=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(f=n.length){if(0===(f=l<(f=a<f?a:f)?l:f))break e;P.arraySet(i,r,o,f,s),a-=f,o+=f,l-=f,s+=f,n.length-=f}else n.mode=12;break;case 17:for(;c<14;){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}if(n.nlen=257+(31&u),u>>>=5,c-=5,n.ndist=1+(31&u),u>>>=5,c-=5,n.ncode=4+(15&u),u>>>=4,c-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;c<3;){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}n.lens[k[n.have++]]=7&u,u>>>=3,c-=3}for(;n.have<19;)n.lens[k[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,T={bits:n.lenbits},S=U(0,n.lens,0,19,n.lencode,0,n.work,T),n.lenbits=T.bits,S){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;y=(I=n.lencode[u&(1<<n.lenbits)-1])>>>16&255,v=65535&I,!((m=I>>>24)<=c);){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}if(v<16)u>>>=m,c-=m,n.lens[n.have++]=v;else{if(16===v){for(R=m+2;c<R;){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}if(u>>>=m,c-=m,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}w=n.lens[n.have-1],f=3+(3&u),u>>>=2,c-=2}else if(17===v){for(R=m+3;c<R;){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}w=0,f=3+(7&(u>>>=m)),u>>>=3,c=c-m-3}else{for(R=m+7;c<R;){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}w=0,f=11+(127&(u>>>=m)),u>>>=7,c=c-m-7}if(n.have+f>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;f--;)n.lens[n.have++]=w}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,T={bits:n.lenbits},S=U(V,n.lens,0,n.nlen,n.lencode,0,n.work,T),n.lenbits=T.bits,S){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,T={bits:n.distbits},S=U(W,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,T),n.distbits=T.bits,S){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=a&&258<=l){e.next_out=s,e.avail_out=l,e.next_in=o,e.avail_in=a,n.hold=u,n.bits=c,H(e,h),s=e.next_out,i=e.output,l=e.avail_out,o=e.next_in,r=e.input,a=e.avail_in,u=n.hold,c=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;y=(I=n.lencode[u&(1<<n.lenbits)-1])>>>16&255,v=65535&I,!((m=I>>>24)<=c);){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}if(y&&0==(240&y)){for(b=m,E=y,C=v;y=(I=n.lencode[C+((u&(1<<b+E)-1)>>b)])>>>16&255,v=65535&I,!(b+(m=I>>>24)<=c);){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}u>>>=b,c-=b,n.back+=b}if(u>>>=m,c-=m,n.back+=m,n.length=v,0===y){n.mode=26;break}if(32&y){n.back=-1,n.mode=12;break}if(64&y){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&y,n.mode=22;case 22:if(n.extra){for(R=n.extra;c<R;){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,c-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;y=(I=n.distcode[u&(1<<n.distbits)-1])>>>16&255,v=65535&I,!((m=I>>>24)<=c);){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}if(0==(240&y)){for(b=m,E=y,C=v;y=(I=n.distcode[C+((u&(1<<b+E)-1)>>b)])>>>16&255,v=65535&I,!(b+(m=I>>>24)<=c);){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}u>>>=b,c-=b,n.back+=b}if(u>>>=m,c-=m,n.back+=m,64&y){e.msg="invalid distance code",n.mode=30;break}n.offset=v,n.extra=15&y,n.mode=24;case 24:if(n.extra){for(R=n.extra;c<R;){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,c-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===l)break e;if(n.offset>(f=h-l)){if((f=n.offset-f)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}p=f>n.wnext?(f-=n.wnext,n.wsize-f):n.wnext-f,f>n.length&&(f=n.length),g=n.window}else g=i,p=s-n.offset,f=n.length;for(l-=f=l<f?l:f,n.length-=f;i[s++]=g[p++],--f;);0===n.length&&(n.mode=21);break;case 26:if(0===l)break e;i[s++]=n.length,l--,n.mode=21;break;case 27:if(n.wrap){for(;c<32;){if(0===a)break e;a--,u|=r[o++]<<c,c+=8}if(h-=l,e.total_out+=h,n.total+=h,h&&(e.adler=n.check=(n.flags?B:F)(n.check,i,h,s-h)),h=l,(n.flags?u:G(u))!==n.check){e.msg="incorrect data check",n.mode=30;break}c=u=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;c<32;){if(0===a)break e;a--,u+=r[o++]<<c,c+=8}if(u!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}c=u=0}n.mode=29;case 29:S=1;break e;case 30:S=-3;break e;case 31:return-4;default:return j}return e.next_out=s,e.avail_out=l,e.next_in=o,e.avail_in=a,n.hold=u,n.bits=c,(n.wsize||h!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&(_=(A=e).output,N=e.next_out,x=h-e.avail_out,null===(A=A.state).window&&(A.wsize=1<<A.wbits,A.wnext=0,A.whave=0,A.window=new P.Buf8(A.wsize)),x>=A.wsize?(P.arraySet(A.window,_,N-A.wsize,A.wsize,0),A.wnext=0,A.whave=A.wsize):(x<(O=A.wsize-A.wnext)&&(O=x),P.arraySet(A.window,_,N-x,O,A.wnext),(x-=O)?(P.arraySet(A.window,_,N-x,x,0),A.wnext=x,A.whave=A.wsize):(A.wnext+=O,A.wnext===A.wsize&&(A.wnext=0),A.whave<A.wsize&&(A.whave+=O)))),d-=e.avail_in,h-=e.avail_out,e.total_in+=d,e.total_out+=h,n.total+=h,n.wrap&&h&&(e.adler=n.check=(n.flags?B:F)(n.check,i,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),S=(0==d&&0===h||4===t)&&S===$?-5:S},n.inflateEnd=function(e){var t;return e&&e.state?((t=e.state).window&&(t.window=null),e.state=null,$):j},n.inflateGetHeader=function(e,t){return!e||!e.state||0==(2&(e=e.state).wrap)?j:((e.head=t).done=!1,$)},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./inffast":34,"./inftrees":36}],36:[function(e,t,n){"use strict";var D=e("../utils/common"),L=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],P=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],F=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],B=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,r,i,o,s,a){for(var l,u,c,d,h,f,p,g,m,y=a.bits,v=0,b=0,E=0,C=0,w=0,S=0,T=0,R=0,A=0,_=0,N=null,x=0,O=new D.Buf16(16),I=new D.Buf16(16),M=null,k=0,v=0;v<=15;v++)O[v]=0;for(b=0;b<r;b++)O[t[n+b]]++;for(w=y,C=15;1<=C&&0===O[C];C--);if(C<w&&(w=C),0===C)i[o++]=20971520,i[o++]=20971520,a.bits=1;else{for(E=1;E<C&&0===O[E];E++);for(w<E&&(w=E),v=R=1;v<=15;v++)if((R=(R<<=1)-O[v])<0)return-1;if(0<R&&(0===e||1!==C))return-1;for(I[1]=0,v=1;v<15;v++)I[v+1]=I[v]+O[v];for(b=0;b<r;b++)0!==t[n+b]&&(s[I[t[n+b]]++]=b);if(f=0===e?(N=M=s,19):1===e?(N=L,x-=257,M=P,k-=257,256):(N=F,M=B,-1),v=E,h=o,c=-1,d=(A=1<<(S=w))-1,1===e&&852<A||2===e&&592<A)return 1;for(T=b=_=0;;){for(m=s[b]<f?(g=0,s[b]):s[b]>f?(g=M[k+s[b]],N[x+s[b]]):(g=96,0),l=1<<(p=v-T),E=u=1<<S;i[h+(_>>T)+(u-=l)]=p<<24|g<<16|m|0,0!==u;);for(l=1<<v-1;_&l;)l>>=1;if(_=0!==l?(_&l-1)+l:0,b++,0==--O[v]){if(v===C)break;v=t[n+s[b]]}if(w<v&&(_&d)!==c){for(h+=E,R=1<<(S=v-(T=0===T?w:T));S+T<C&&!((R-=O[S+T])<=0);)S++,R<<=1;if(A+=1<<S,1===e&&852<A||2===e&&592<A)return 1;i[c=_&d]=w<<24|S<<16|h-o|0}}0!==_&&(i[h+_]=v-T<<24|64<<16|0),a.bits=w}return 0}},{"../utils/common":27}],37:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],38:[function(n,o,e){"use strict";var s=n("../utils/common"),c=0,d=1;function t(e){for(var t=e.length;0<=--t;)e[t]=0}function a(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}var l,u,h,f=29,p=256,g=p+1+f,m=30,y=19,R=2*g+1,A=15,r=16,H=7,v=256,b=16,E=17,C=18,w=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],S=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],U=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],T=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],_=new Array(2*(g+2)),N=(t(_),new Array(2*m)),x=(t(N),new Array(512)),O=(t(x),new Array(256)),I=(t(O),new Array(f)),M=(t(I),new Array(m)),k=(t(M),function(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length});function D(e){return e<256?x[e]:x[256+(e>>>7)]}function i(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function L(e,t,n){e.bi_valid>r-n?(e.bi_buf|=t<<e.bi_valid&65535,i(e,e.bi_buf),e.bi_buf=t>>r-e.bi_valid,e.bi_valid+=n-r):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function P(e,t,n){L(e,n[2*t],n[2*t+1])}function V(e,t){for(var n=0;n|=1&e,e>>>=1,n<<=1,0<--t;);return n>>>1}function W(e,t,n){for(var r,i=new Array(A+1),o=0,s=1;s<=A;s++)i[s]=o=o+n[s-1]<<1;for(r=0;r<=t;r++){var a=e[2*r+1];0!==a&&(e[2*r]=V(i[a]++,a))}}function $(e){for(var t=0;t<g;t++)e.dyn_ltree[2*t]=0;for(t=0;t<m;t++)e.dyn_dtree[2*t]=0;for(t=0;t<y;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*v]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function j(e){8<e.bi_valid?i(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function z(e,t,n,r){var i=2*t,o=2*n;return e[i]<e[o]||e[i]===e[o]&&r[t]<=r[n]}function F(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&z(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!z(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function G(e,t,n){var r,i,o,s,a=0;if(0!==e.last_lit)for(;r=e.pending_buf[e.d_buf+2*a]<<8|e.pending_buf[e.d_buf+2*a+1],i=e.pending_buf[e.l_buf+a],a++,0==r?P(e,i,t):(P(e,(o=O[i])+p+1,t),0!==(s=w[o])&&L(e,i-=I[o],s),P(e,o=D(--r),n),0!==(s=S[o])&&L(e,r-=M[o],s)),a<e.last_lit;);P(e,v,t)}function B(e,t){var n,r,i,o=t.dyn_tree,s=t.stat_desc.static_tree,a=t.stat_desc.has_stree,l=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=R,n=0;n<l;n++)0!==o[2*n]?(e.heap[++e.heap_len]=u=n,e.depth[n]=0):o[2*n+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[i]=0,e.opt_len--,a&&(e.static_len-=s[2*i+1]);for(t.max_code=u,n=e.heap_len>>1;1<=n;n--)F(e,o,n);for(i=l;n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],F(e,o,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,o[2*i]=o[2*n]+o[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,o[2*n+1]=o[2*r+1]=i,e.heap[1]=i++,F(e,o,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1];for(var c,d,h,f,p,g=e,m=t.dyn_tree,y=t.max_code,v=t.stat_desc.static_tree,b=t.stat_desc.has_stree,E=t.stat_desc.extra_bits,C=t.stat_desc.extra_base,w=t.stat_desc.max_length,S=0,T=0;T<=A;T++)g.bl_count[T]=0;for(m[2*g.heap[g.heap_max]+1]=0,c=g.heap_max+1;c<R;c++)w<(T=m[2*m[2*(d=g.heap[c])+1]+1]+1)&&(T=w,S++),m[2*d+1]=T,y<d||(g.bl_count[T]++,f=0,C<=d&&(f=E[d-C]),p=m[2*d],g.opt_len+=p*(T+f),b&&(g.static_len+=p*(v[2*d+1]+f)));if(0!==S){do{for(T=w-1;0===g.bl_count[T];)T--}while(g.bl_count[T]--,g.bl_count[T+1]+=2,g.bl_count[w]--,0<(S-=2));for(T=w;0!==T;T--)for(d=g.bl_count[T];0!==d;)y<(h=g.heap[--c])||(m[2*h+1]!==T&&(g.opt_len+=(T-m[2*h+1])*m[2*h],m[2*h+1]=T),d--)}W(o,u,e.bl_count)}function Y(e,t,n){var r,i,o=-1,s=t[1],a=0,l=7,u=4;for(0===s&&(l=138,u=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=s,s=t[2*(r+1)+1],++a<l&&i===s||(a<u?e.bl_tree[2*i]+=a:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[2*b]++):a<=10?e.bl_tree[2*E]++:e.bl_tree[2*C]++,o=i,u=(a=0)===s?(l=138,3):i===s?(l=6,3):(l=7,4))}function X(e,t,n){var r,i,o=-1,s=t[1],a=0,l=7,u=4;for(0===s&&(l=138,u=3),r=0;r<=n;r++)if(i=s,s=t[2*(r+1)+1],!(++a<l&&i===s)){if(a<u)for(;P(e,i,e.bl_tree),0!=--a;);else 0!==i?(i!==o&&(P(e,i,e.bl_tree),a--),P(e,b,e.bl_tree),L(e,a-3,2)):a<=10?(P(e,E,e.bl_tree),L(e,a-3,3)):(P(e,C,e.bl_tree),L(e,a-11,7));o=i,u=(a=0)===s?(l=138,3):i===s?(l=6,3):(l=7,4)}}var K=!1;function q(e,t,n,r){L(e,0+(r?1:0),3),r=t,t=n,n=!0,j(e=e),n&&(i(e,t),i(e,~t)),s.arraySet(e.pending_buf,e.window,r,t,e.pending),e.pending+=t}e._tr_init=function(e){if(!K){for(var t,n,r,i=new Array(A+1),o=0,s=0;s<f-1;s++)for(I[s]=o,t=0;t<1<<w[s];t++)O[o++]=s;for(O[o-1]=s,s=r=0;s<16;s++)for(M[s]=r,t=0;t<1<<S[s];t++)x[r++]=s;for(r>>=7;s<m;s++)for(M[s]=r<<7,t=0;t<1<<S[s]-7;t++)x[256+r++]=s;for(n=0;n<=A;n++)i[n]=0;for(t=0;t<=143;)_[2*t+1]=8,t++,i[8]++;for(;t<=255;)_[2*t+1]=9,t++,i[9]++;for(;t<=279;)_[2*t+1]=7,t++,i[7]++;for(;t<=287;)_[2*t+1]=8,t++,i[8]++;for(W(_,g+1,i),t=0;t<m;t++)N[2*t+1]=5,N[2*t]=V(t,5);l=new k(_,w,p+1,g,A),u=new k(N,S,0,m,A),h=new k(new Array(0),U,0,y,H),K=!0}e.l_desc=new a(e.dyn_ltree,l),e.d_desc=new a(e.dyn_dtree,u),e.bl_desc=new a(e.bl_tree,h),e.bi_buf=0,e.bi_valid=0,$(e)},e._tr_stored_block=q,e._tr_flush_block=function(e,t,n,r){var i,o,s=0;if(0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){for(var t=4093624447,n=0;n<=31;n++,t>>>=1)if(1&t&&0!==e.dyn_ltree[2*n])return c;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return d;for(n=32;n<p;n++)if(0!==e.dyn_ltree[2*n])return d;return c}(e)),B(e,e.l_desc),B(e,e.d_desc),s=function(e){var t;for(Y(e,e.dyn_ltree,e.l_desc.max_code),Y(e,e.dyn_dtree,e.d_desc.max_code),B(e,e.bl_desc),t=y-1;3<=t&&0===e.bl_tree[2*T[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=n+5,n+4<=i&&-1!==t)q(e,t,n,r);else if(4===e.strategy||o===i)L(e,2+(r?1:0),3),G(e,_,N);else{L(e,4+(r?1:0),3);var a,l=e,t=e.l_desc.max_code+1,n=e.d_desc.max_code+1,u=s+1;for(L(l,t-257,5),L(l,n-1,5),L(l,u-4,4),a=0;a<u;a++)L(l,l.bl_tree[2*T[a]+1],3);X(l,l.dyn_ltree,t-1),X(l,l.dyn_dtree,n-1),G(e,e.dyn_ltree,e.dyn_dtree)}$(e),r&&j(e)},e._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(O[n]+p+1)]++,e.dyn_dtree[2*D(t)]++),e.last_lit===e.lit_bufsize-1},e._tr_align=function(e){L(e,2,3),P(e,v,_),16===(e=e).bi_valid?(i(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}},{"../utils/common":27}],39:[function(e,t,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}]},{},[9])(9)}),{});function make_xlsx_lib(s){s.version="0.16.8";for(var g=1200,C=1252,t=("undefined"!=typeof module&&"undefined"!=typeof require&&"undefined"==typeof cptable&&("undefined"!=typeof global?global.cptable=void 0:"undefined"!=typeof window&&(window.cptable=void 0)),[874,932,936,949,950]),n=0;n<=8;++n)t.push(1250+n);function p(e){-1!=t.indexOf(e)&&(C=k[0]=e)}var k={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969};var be=function(e){p(g=e)};function m(){be(1200),p(1252)}function Ee(e){for(var t=[],n=0,r=e.length;n<r;++n)t[n]=e.charCodeAt(n);return t}var u,Ce=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);if(255==t&&254==n){for(var r=e.slice(2),i=[],o=0;o<r.length>>1;++o)i[o]=String.fromCharCode(r.charCodeAt(2*o)+(r.charCodeAt(2*o+1)<<8));return i.join("")}if(254!=t||255!=n)return 65279==t?e.slice(1):e;for(var s=e.slice(2),a=[],l=0;l<s.length>>1;++l)a[l]=String.fromCharCode(s.charCodeAt(2*l+1)+(s.charCodeAt(2*l)<<8));return a.join("")},c=function(e){return String.fromCharCode(e)},r=function(e){return String.fromCharCode(e)},ae=("undefined"!=typeof cptable&&(be=function(e){p(g=e)},Ce=function(e){return 255===e.charCodeAt(0)&&254===e.charCodeAt(1)?cptable.utils.decode(1200,Ee(e.slice(2))):e},c=function(e){return 1200===g?String.fromCharCode(e):cptable.utils.decode(g,[255&e,e>>8])[0]},r=function(e){return cptable.utils.decode(C,[e])[0]}),null),S=(u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",{encode:function(e){for(var t,n,r,i,o="",s=0,a=0,l=0;l<e.length;)r=(t=e.charCodeAt(l++))>>2,i=(3&t)<<4|(t=e.charCodeAt(l++))>>4,s=(15&t)<<2|(n=e.charCodeAt(l++))>>6,a=63&n,isNaN(t)?s=a=64:isNaN(n)&&(a=64),o+=u.charAt(r)+u.charAt(i)+u.charAt(s)+u.charAt(a);return o},decode:function(e){var t,n,r="";e=e.replace(/[^\w\+\/\=]/g,"");for(var i=0;i<e.length;)t=u.indexOf(e.charAt(i++)),n=u.indexOf(e.charAt(i++)),r+=String.fromCharCode(t<<2|n>>4),64!==(t=u.indexOf(e.charAt(i++)))&&(r+=String.fromCharCode((15&n)<<4|t>>2)),64!==(n=u.indexOf(e.charAt(i++)))&&(r+=String.fromCharCode((3&t)<<6|n));return r}}),T="undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node,f=function(){};if("undefined"!=typeof Buffer){var i=!Buffer.from;if(!i)try{Buffer.from("foo","utf8")}catch(e){i=!0}f=i?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer),Buffer.alloc||(Buffer.alloc=function(e){return new Buffer(e)}),Buffer.allocUnsafe||(Buffer.allocUnsafe=function(e){return new Buffer(e)})}function te(e){return T?Buffer.alloc(e):new Array(e)}function ne(e){return T?Buffer.allocUnsafe(e):new Array(e)}var re=function(e){return T?f(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function v(e){if("undefined"==typeof ArrayBuffer)return re(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}function o(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function b(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return b(new Uint8Array(e));for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t}var we=function(e){return[].concat.apply([],e)},ie=/\u0000/g,Se=/[\u0001-\u0006]/g,le={},Te=function(e){function E(e){for(var t="",n=e.length-1;0<=n;)t+=e.charAt(n--);return t}function C(e,t){for(var n="";n.length<t;)n+=e;return n}function R(e,t){e=""+e;return t<=e.length?e:C("0",t-e.length)+e}function w(e,t){e=""+e;return t<=e.length?e:C(" ",t-e.length)+e}function S(e,t){e=""+e;return t<=e.length?e:e+C(" ",t-e.length)}e.version="0.11.2";var i=Math.pow(2,32);function T(e,t){var n,r;return i<e||e<-i?(r=e,n=t,r=""+Math.round(r),n<=r.length?r:C("0",n-r.length)+r):(n=Math.round(e),(r=t)<=(e=""+(e=n)).length?e:C("0",r-e.length)+e)}function A(e,t){return e.length>=7+(t=t||0)&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var _=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],N=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function t(e){e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "'}for(var o={},s=(t(o),[]),n=0,n=5;n<=8;++n)s[n]=32+n;for(n=23;n<=26;++n)s[n]=0;for(n=27;n<=31;++n)s[n]=14;for(n=50;n<=58;++n)s[n]=14;for(n=59;n<=62;++n)s[n]=n-58;for(n=67;n<=68;++n)s[n]=n-58;for(n=72;n<=75;++n)s[n]=n-58;for(n=67;n<=68;++n)s[n]=n-57;for(n=76;n<=78;++n)s[n]=n-56;for(n=79;n<=81;++n)s[n]=n-34;var a=[];function x(e,t,n){var r,i=e<0?-1:1,o=e*i,s=0,a=1,l=0,u=1,c=0,d=0;for(Math.floor(o);c<t&&(l=(r=Math.floor(o))*a+s,d=r*c+u,!(o-r<5e-8));)o=1/(o-r),s=a,a=l,u=c,c=d;return t<d&&(l=t<c?(d=u,s):(d=c,a)),n?[e=Math.floor(i*l/d),i*l-e*d,d]:[0,i*l,d]}function O(e,t,n){var r,i,o,s;return 2958465<e||e<0?null:(o=[],s={D:r=0|e,T:i=Math.floor(86400*(e-r)),u:86400*(e-r)-i,y:e=0,m:0,d:0,H:0,M:0,S:0,q:0},Math.abs(s.u)<1e-6&&(s.u=0),t&&t.date1904&&(r+=1462),.9999<s.u&&(s.u=0,86400==++i)&&(s.T=i=0,++r,++s.D),60===r?(o=n?[1317,10,29]:[1900,2,29],e=3):0===r?(o=n?[1317,8,29]:[1900,1,0],e=6):(60<r&&--r,(t=new Date(1900,0,1)).setDate(t.getDate()+r-1),o=[t.getFullYear(),t.getMonth()+1,t.getDate()],e=t.getDay(),r<60&&(e=(e+6)%7),n&&(e=function(e,t){t[0]-=581;t=e.getDay();e<60&&(t=(t+6)%7);return t}(t,o))),s.y=o[0],s.m=o[1],s.d=o[2],s.S=i%60,i=Math.floor(i/60),s.M=i%60,i=Math.floor(i/60),s.H=i,s.q=e,s)}a[5]=a[63]='"$"#,##0_);\\("$"#,##0\\)',a[6]=a[64]='"$"#,##0_);[Red]\\("$"#,##0\\)',a[7]=a[65]='"$"#,##0.00_);\\("$"#,##0.00\\)',a[8]=a[66]='"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',a[41]='_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',a[42]='_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',a[43]='_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',a[44]='_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)',e.parse_date_code=O;var r=new Date(1899,11,31,0,0,0),p=r.getTime(),g=new Date(1900,2,1,0,0,0);function l(e,t){var n=e.getTime();return t?n-=1262304e5:g<=e&&(n+=864e5),(n-(p+6e4*(e.getTimezoneOffset()-r.getTimezoneOffset())))/864e5}e._general_int=function(e){return e.toString(10)};u=/(?:\.0*|(\.\d*[1-9])0+)$/,c=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,d=/(E[+-])(\d)$/;var u,c,d,h=function(e){var t,n,r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),i=-4<=r&&r<=-1?e.toPrecision(10+r):Math.abs(r)<=9?(t=(i=e)<0?12:11,(n=f(i.toFixed(12))).length<=t||(n=i.toPrecision(10)).length<=t?n:i.toExponential(5)):10===r?e.toFixed(10).substr(0,12):(n=f((t=e).toFixed(11))).length>(t<0?12:11)||"0"===n||"-0"===n?t.toPrecision(6):n;return f(-1==(r=i.toUpperCase()).indexOf("E")?r:r.replace(c,"$1E").replace(d,"$10$2"))};function f(e){return-1==e.indexOf(".")?e:e.replace(u,"$1")}function I(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):h(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return Y(14,l(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function M(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(0<n.length?",":"")+e.substr(t,3);return n}e._general_num=h,e._general=I;k=/%/g,D=/# (\?+)( ?)\/( ?)(\d+)/,L=/^#*0*\.([0#]+)/,P=/\).*[0#]/,F=/\(###\) ###\\?-####/;var k,D,L,P,F,B=function(e,t,n){return((0|n)===n?v:U)(e,t,n)};function H(e){for(var t,n="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function V(e,t){t=Math.pow(10,t);return""+Math.round(e*t)/t}function W(e,t){var e=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(e*n)).length?0:Math.round(e*n)}function U(e,t,n){if(40===e.charCodeAt(0)&&!t.match(P))return r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,""),0<=n?U("n",r,n):"("+U("n",r,-n)+")";if(44===t.charCodeAt(t.length-1)){for(var r=e,i=t,o=n,s=i.length-1;44===i.charCodeAt(s-1);)--s;return B(r,i.substr(0,s),o/Math.pow(10,3*(i.length-s)))}if(-1!==t.indexOf("%"))return o=e,u=n,l=(c=t).replace(k,""),c=c.length-l.length,B(o,l,u*Math.pow(10,2*c))+C("%",c);if(-1!==t.indexOf("E"))return function e(t,n){var r,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==n)return"0.0E+0";if(n<0)return"-"+e(t,-n);var o=t.indexOf("."),s=(-1===o&&(o=t.indexOf("E")),Math.floor(Math.log(n)*Math.LOG10E)%o);if(s<0&&(s+=o),-1===(r=(n/Math.pow(10,s)).toPrecision(1+i+(o+s)%o)).indexOf("e")){var a=Math.floor(Math.log(n)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,o)+"."+r.substr(2+o)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,r){return t+n+r.substr(0,(o+s)%o)+"."+r.substr(s)+"E"})}else r=n.toExponential(i);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),(r=t.match(/E\-/)&&r.match(/e\+/)?r.replace(/e\+/,"e"):r).replace("e","E")}(t,n);if(36===t.charCodeAt(0))return"$"+U(e,t.substr(" "==t.charAt(1)?2:1),n);var a,l,u,c,d,h=Math.abs(n),f=n<0?"-":"";if(t.match(/^00+$/))return f+T(h,t.length);if(t.match(/^[#?]+$/))return(p="0"===(p=T(n,0))?"":p).length>t.length?p:H(t.substr(0,t.length-p.length))+p;if(a=t.match(D))return l=a,u=h,c=f,v=parseInt(l[4],10),u=Math.round(u*v),d=Math.floor(u/v),c+(0===d?"":""+d)+" "+(0==(u=u-d*v)?C(" ",l[1].length+1+l[4].length):w(u,l[1].length)+l[2]+"/"+l[3]+R(v,l[4].length));if(t.match(/^#+0+$/))return f+T(h,t.length-t.indexOf("0"));if(a=t.match(L))return p=V(n,a[1].length).replace(/^([^\.]+)$/,"$1."+H(a[1])).replace(/\.$/,"."+H(a[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+C("0",H(a[1]).length-t.length)}),-1!==t.indexOf("0.")?p:p.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+V(h,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+M(T(h,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+U(e,t,-n):M(""+(Math.floor(n)+((d=a[1].length)<(""+Math.round((n-Math.floor(n))*Math.pow(10,d))).length?1:0)))+"."+R(W(n,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return U(e,t.replace(/^#,#*,/,""),n);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return p=E(U(e,t.replace(/[\\-]/g,""),n)),g=0,E(E(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return g<p.length?p.charAt(g++):"0"===e?"0":""}));if(t.match(F))return"("+(p=U(e,"##########",n)).substr(0,3)+") "+p.substr(3,3)+"-"+p.substr(6);var p,g,m,y,v="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return g=Math.min(a[4].length,7),y=x(h,Math.pow(10,g)-1,!1),p=f," "==(v=B("n",a[1],y[1])).charAt(v.length-1)&&(v=v.substr(0,v.length-1)+"0"),p+=v+a[2]+"/"+a[3],(v=S(y[2],g)).length<a[4].length&&(v=H(a[4].substr(a[4].length-v.length))+v),p+=v;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return g=Math.min(Math.max(a[1].length,a[4].length),7),f+((y=x(h,Math.pow(10,g)-1,!0))[0]||(y[1]?"":"0"))+" "+(y[1]?w(y[1],g)+a[2]+"/"+a[3]+S(y[2],g):C(" ",2*g+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return p=T(n,0),t.length<=p.length?p:H(t.substr(0,t.length-p.length))+p;if(a=t.match(/^([#0?]+)\.([#0]+)$/))return g=(p=""+n.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf("."),y=t.indexOf(".")-g,m=t.length-p.length-y,H(t.substr(0,y)+p+t.substr(t.length-m));if(a=t.match(/^00,000\.([#0]*0)$/))return g=W(n,a[1].length),n<0?"-"+U(e,t,-n):M((y=n)<2147483647&&-2147483648<y?""+(0<=y?0|y:y-1|0):""+Math.floor(y)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?R(0,3-e.length):"")+e})+"."+R(g,a[1].length);switch(t){case"###,##0.00":return U(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var b=M(T(h,0));return"0"!==b?f+b:"";case"###,###.00":return U(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return U(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function v(e,t,n){if(40===e.charCodeAt(0)&&!t.match(P))return r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,""),0<=n?v("n",r,n):"("+v("n",r,-n)+")";if(44===t.charCodeAt(t.length-1)){for(var r=e,i=t,o=n,s=i.length-1;44===i.charCodeAt(s-1);)--s;return B(r,i.substr(0,s),o/Math.pow(10,3*(i.length-s)))}if(-1!==t.indexOf("%"))return o=e,l=n,u=(m=t).replace(k,""),m=m.length-u.length,B(o,u,l*Math.pow(10,2*m))+C("%",m);if(-1!==t.indexOf("E"))return function e(t,n){var r,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==n)return"0.0E+0";if(n<0)return"-"+e(t,-n);var o,s=t.indexOf("."),a=(-1===s&&(s=t.indexOf("E")),Math.floor(Math.log(n)*Math.LOG10E)%s);a<0&&(a+=s),(r=(n/Math.pow(10,a)).toPrecision(1+i+(s+a)%s)).match(/[Ee]/)||(o=Math.floor(Math.log(n)*Math.LOG10E),-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")),r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,r){return t+n+r.substr(0,(s+a)%s)+"."+r.substr(a)+"E"})}else r=n.toExponential(i);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),(r=t.match(/E\-/)&&r.match(/e\+/)?r.replace(/e\+/,"e"):r).replace("e","E")}(t,n);if(36===t.charCodeAt(0))return"$"+v(e,t.substr(" "==t.charAt(1)?2:1),n);var a,l,u,c=Math.abs(n),d=n<0?"-":"";if(t.match(/^00+$/))return d+R(c,t.length);if(t.match(/^[#?]+$/))return(h=0===n?"":""+n).length>t.length?h:H(t.substr(0,t.length-h.length))+h;if(a=t.match(D))return d+(0===(u=c)?"":""+u)+C(" ",(l=a)[1].length+2+l[4].length);if(t.match(/^#+0+$/))return d+R(c,t.length-t.indexOf("0"));if(a=t.match(L))return h=(h=(""+n).replace(/^([^\.]+)$/,"$1."+H(a[1])).replace(/\.$/,"."+H(a[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+C("0",H(a[1]).length-t.length)}),-1!==t.indexOf("0.")?h:h.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return d+M(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+v(e,t,-n):M(""+n)+"."+C("0",a[1].length);if(a=t.match(/^#,#*,#0/))return v(e,t.replace(/^#,#*,/,""),n);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return h=E(v(e,t.replace(/[\\-]/g,""),n)),f=0,E(E(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return f<h.length?h.charAt(f++):"0"===e?"0":""}));if(t.match(F))return"("+(h=v(e,"##########",n)).substr(0,3)+") "+h.substr(3,3)+"-"+h.substr(6);var h,f,p,g,m="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(a[4].length,7),p=x(c,Math.pow(10,f)-1,!1),h=d," "==(m=B("n",a[1],p[1])).charAt(m.length-1)&&(m=m.substr(0,m.length-1)+"0"),h+=m+a[2]+"/"+a[3],(m=S(p[2],f)).length<a[4].length&&(m=H(a[4].substr(a[4].length-m.length))+m),h+=m;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(Math.max(a[1].length,a[4].length),7),d+((p=x(c,Math.pow(10,f)-1,!0))[0]||(p[1]?"":"0"))+" "+(p[1]?w(p[1],f)+a[2]+"/"+a[3]+S(p[2],f):C(" ",2*f+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return h=""+n,t.length<=h.length?h:H(t.substr(0,t.length-h.length))+h;if(a=t.match(/^([#0]+)\.([#0]+)$/))return f=(h=""+n.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf("."),p=t.indexOf(".")-f,g=t.length-h.length-p,H(t.substr(0,p)+h+t.substr(t.length-g));if(a=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+v(e,t,-n):M(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?R(0,3-e.length):"")+e})+"."+R(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var y=M(""+c);return"0"!==y?d+y:"";default:if(t.match(/\.[0#?]*$/))return v(e,t.slice(0,t.lastIndexOf(".")),n)+H(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function m(e){for(var t=[],n=!1,r=0,i=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(i,r-i),i=r+1}if(t[t.length]=e.substr(i),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}e._split=m;var $=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function j(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":A(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("上午/下午"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=n;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match($))return!0;break;case".":case"0":case"#":for(;t<e.length&&(-1<"0#?.,E+-%".indexOf(n=e.charAt(++t))||"\\"==n&&"-"==e.charAt(t+1)&&-1<"0#".indexOf(e.charAt(t+2))););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&-1<"0123456789".indexOf(e.charAt(++t)););break;default:++t}return!1}function y(e,t,n,r){for(var i,o,s,a=[],l="",u=0,c="",d="t",h="H";u<e.length;)switch(c=e.charAt(u)){case"G":if(!A(e,u))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},u+=7;break;case'"':for(l="";34!==(s=e.charCodeAt(++u))&&u<e.length;)l+=String.fromCharCode(s);a[a.length]={t:"t",v:l},++u;break;case"\\":var f=e.charAt(++u);a[a.length]={t:"("===f||")"===f?f:"t",v:f},++u;break;case"_":a[a.length]={t:"t",v:" "},u+=2;break;case"@":a[a.length]={t:"T",v:t},++u;break;case"B":case"b":if("1"===e.charAt(u+1)||"2"===e.charAt(u+1)){if(null==i&&null==(i=O(t,n,"2"===e.charAt(u+1))))return"";a[a.length]={t:"X",v:e.substr(u,2)},d=c,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==i&&null==(i=O(t,n)))return"";for(l=c;++u<e.length&&e.charAt(u).toLowerCase()===c;)l+=c;"h"===(c="m"===c&&"h"===d.toLowerCase()?"M":c)&&(c=h),a[a.length]={t:c,v:l},d=c;break;case"A":case"a":case"上":f={t:c,v:c};if(null==i&&(i=O(t,n)),"A/P"===e.substr(u,3).toUpperCase()?(null!=i&&(f.v=12<=i.H?"P":"A"),f.t="T",h="h",u+=3):"AM/PM"===e.substr(u,5).toUpperCase()?(null!=i&&(f.v=12<=i.H?"PM":"AM"),f.t="T",u+=5,h="h"):"上午/下午"===e.substr(u,5).toUpperCase()?(null!=i&&(f.v=12<=i.H?"下午":"上午"),f.t="T",u+=5,h="h"):(f.t="t",++u),null==i&&"T"===f.t)return"";a[a.length]=f,d=c;break;case"[":for(l=c;"]"!==e.charAt(u++)&&u<e.length;)l+=e.charAt(u);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match($)){if(null==i&&null==(i=O(t,n)))return"";a[a.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else-1<l.indexOf("$")&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",j(e)||(a[a.length]={t:"t",v:l}));break;case".":if(null!=i){for(l=c;++u<e.length&&"0"===(c=e.charAt(u));)l+=c;a[a.length]={t:"s",v:l};break}case"0":case"#":for(l=c;++u<e.length&&-1<"0#?.,E+-%".indexOf(c=e.charAt(u));)l+=c;a[a.length]={t:"n",v:l};break;case"?":for(l=c;e.charAt(++u)===c;)l+=c;a[a.length]={t:c,v:l},d=c;break;case"*":++u," "!=e.charAt(u)&&"*"!=e.charAt(u)||++u;break;case"(":case")":a[a.length]={t:1===r?"t":c,v:c},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=c;u<e.length&&-1<"0123456789".indexOf(e.charAt(++u));)l+=e.charAt(u);a[a.length]={t:"D",v:l};break;case" ":a[a.length]={t:c,v:c},++u;break;case"$":a[a.length]={t:"t",v:"$"},++u;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++u}var p,g=0,m=0;for(u=a.length-1,d="t";0<=u;--u)switch(a[u].t){case"h":case"H":a[u].t=h,d="h",g<1&&(g=1);break;case"s":(p=a[u].v.match(/\.0+$/))&&(m=Math.max(m,p[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":d=a[u].t;break;case"m":"s"===d&&(a[u].t="M",g<2)&&(g=2);break;case"X":break;case"Z":(g=(g=g<1&&a[u].v.match(/[Hh]/)?1:g)<2&&a[u].v.match(/[Mm]/)?2:g)<3&&a[u].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:.5<=i.u&&(i.u=0,++i.S),60<=i.S&&(i.S=0,++i.M),60<=i.M&&(i.M=0,++i.H);break;case 2:.5<=i.u&&(i.u=0,++i.S),60<=i.S&&(i.S=0,++i.M)}var y="";for(u=0;u<a.length;++u)switch(a[u].t){case"t":case"T":case" ":case"D":break;case"X":a[u].v="",a[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[u].v=function(e,t,n,r){var i,o="",s=0,a=0,l=n.y,u=0;switch(e){case 98:l=n.y+543;case 121:switch(t.length){case 1:case 2:i=l%100,u=2;break;default:i=l%1e4,u=4}break;case 109:switch(t.length){case 1:case 2:i=n.m,u=t.length;break;case 3:return N[n.m-1][1];case 5:return N[n.m-1][0];default:return N[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:i=n.d,u=t.length;break;case 3:return _[n.q][0];default:return _[n.q][1]}break;case 104:switch(t.length){case 1:case 2:i=1+(n.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:i=n.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:i=n.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(60*(a=2<=r?3===r?1e3:100:1===r?10:1)<=(s=Math.round(a*(n.S+n.u)))&&(s=0),"s"===t?0===s?"0":""+s/a:(o=R(s,2+r),"ss"===t?o.substr(0,2):"."+o.substr(2,t.length-1))):R(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":i=24*n.D+n.H;break;case"[m]":case"[mm]":i=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":i=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}u=3===t.length?1:2;break;case 101:i=l,u=1}return 0<u?R(i,u):""}(a[u].t.charCodeAt(0),a[u].v,i,m),a[u].t="t";break;case"n":case"?":for(C=u+1;null!=a[C]&&("?"===(c=a[C].t)||"D"===c||(" "===c||"t"===c)&&null!=a[C+1]&&("?"===a[C+1].t||"t"===a[C+1].t&&"/"===a[C+1].v)||"("===a[u].t&&(" "===c||"n"===c||")"===c)||"t"===c&&("/"===a[C].v||" "===a[C].v&&null!=a[C+1]&&"?"==a[C+1].t));)a[u].v+=a[C].v,a[C]={v:"",t:";"},++C;y+=a[u].v,u=C-1;break;case"G":a[u].t="t",a[u].v=I(t,n)}var v,b,E="";if(0<y.length){40==y.charCodeAt(0)?(v=t<0&&45===y.charCodeAt(0)?-t:t,b=B("n",y,v)):(b=B("n",y,v=t<0&&1<r?-t:t),v<0&&a[0]&&"t"==a[0].t&&(b=b.substr(1),a[0].v="-"+a[0].v));for(var C=b.length-1,w=a.length,u=0;u<a.length;++u)if(null!=a[u]&&"t"!=a[u].t&&-1<a[u].v.indexOf(".")){w=u;break}var S=a.length;if(w===a.length&&-1===b.indexOf("E")){for(u=a.length-1;0<=u;--u)null!=a[u]&&-1!=="n?".indexOf(a[u].t)&&(C>=a[u].v.length-1?(C-=a[u].v.length,a[u].v=b.substr(C+1,a[u].v.length)):C<0?a[u].v="":(a[u].v=b.substr(0,C+1),C=-1),a[u].t="t",S=u);0<=C&&S<a.length&&(a[S].v=b.substr(0,C+1)+a[S].v)}else if(w!==a.length&&-1===b.indexOf("E")){for(C=b.indexOf(".")-1,u=w;0<=u;--u)if(null!=a[u]&&-1!=="n?".indexOf(a[u].t)){for(o=-1<a[u].v.indexOf(".")&&u===w?a[u].v.indexOf(".")-1:a[u].v.length-1,E=a[u].v.substr(o+1);0<=o;--o)0<=C&&("0"===a[u].v.charAt(o)||"#"===a[u].v.charAt(o))&&(E=b.charAt(C--)+E);a[u].v=E,a[u].t="t",S=u}for(0<=C&&S<a.length&&(a[S].v=b.substr(0,C+1)+a[S].v),C=b.indexOf(".")+1,u=w;u<a.length;++u)if(null!=a[u]&&(-1!=="n?(".indexOf(a[u].t)||u===w)){for(o=-1<a[u].v.indexOf(".")&&u===w?a[u].v.indexOf(".")+1:0,E=a[u].v.substr(0,o);o<a[u].v.length;++o)C<b.length&&(E+=b.charAt(C++));a[u].v=E,a[u].t="t",S=u}}}for(u=0;u<a.length;++u)null!=a[u]&&-1<"n?".indexOf(a[u].t)&&(v=1<r&&t<0&&0<u&&"-"===a[u-1].v?-t:t,a[u].v=B(a[u].t,a[u].v,v),a[u].t="t");var T="";for(u=0;u!==a.length;++u)null!=a[u]&&(T+=a[u].v);return T}e.is_date=j,e._eval=y;var b=/\[[=<>]/,z=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function G(e,t){if(null!=t){var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return 1;break;case">":if(n<e)return 1;break;case"<":if(e<n)return 1;break;case"<>":if(e!=n)return 1;break;case">=":if(n<=e)return 1;break;case"<=":if(e<=n)return 1}}}function Y(e,t,n){null==n&&(n={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":null==(r=null==(r=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:o)[e])?n.table&&n.table[s[e]]||o[s[e]]:r)&&(r=a[e]||"General")}if(A(r,0))return I(t,n);var i=function(e,t){var n=m(e),e=n.length,r=n[e-1].indexOf("@");if(e<4&&-1<r&&--e,4<n.length)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!=typeof t)return[4,4===n.length||-1<r?n[n.length-1]:"@"];switch(n.length){case 1:n=-1<r?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=-1<r?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=-1<r?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var i,o,s=0<t?n[0]:t<0?n[1]:n[2];return!(-1===n[0].indexOf("[")&&-1===n[1].indexOf("[")||null==n[0].match(b)&&null==n[1].match(b))?(i=n[0].match(z),o=n[1].match(z),G(t,i)?[e,n[0]]:G(t,o)?[e,n[1]]:[e,n[null!=i&&null!=o?2:1]]):[e,s]}(r,t=t instanceof Date?l(t,n.date1904):t);if(A(i[1]))return I(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return y(i[1],t,n,i[0])}function X(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(null==o[n])t<0&&(t=n);else if(o[n]==e){t=n;break}t<0&&(t=391)}return o[t]=e,t}e.load=X,e._table=o,e.get_table=function(){return o},e.load_table=function(e){for(var t=0;392!=t;++t)void 0!==e[t]&&X(e[t],t)},e.init_table=t,e.format=Y},Re=(Te(le),{"General Number":"General","General Date":le._table[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":le._table[15],"Short Date":le._table[14],"Long Time":le._table[19],"Medium Time":le._table[18],"Short Time":le._table[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:le._table[2],Standard:le._table[4],Percent:le._table[10],Scientific:le._table[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'}),l={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},w=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;i=Ae={version:"1.2.0"},a=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}(),i.table=a,i.bstr=function(e,t){for(var n=-1^t,r=e.length-1,i=0;i<r;)n=(n=n>>>8^a[255&(n^e.charCodeAt(i++))])>>>8^a[255&(n^e.charCodeAt(i++))];i===r&&(n=n>>>8^a[255&(n^e.charCodeAt(i))]);return-1^n},i.buf=function(e,t){if(1e4<e.length)return function(e,t){for(var n=-1^t,r=e.length-7,i=0;i<r;)n=(n=(n=(n=(n=(n=(n=(n=n>>>8^a[255&(n^e[i++])])>>>8^a[255&(n^e[i++])])>>>8^a[255&(n^e[i++])])>>>8^a[255&(n^e[i++])])>>>8^a[255&(n^e[i++])])>>>8^a[255&(n^e[i++])])>>>8^a[255&(n^e[i++])])>>>8^a[255&(n^e[i++])];for(;i<7+r;)n=n>>>8^a[255&(n^e[i++])];return-1^n}(e,t);for(var n=-1^t,r=e.length-3,i=0;i<r;)n=(n=(n=(n=n>>>8^a[255&(n^e[i++])])>>>8^a[255&(n^e[i++])])>>>8^a[255&(n^e[i++])])>>>8^a[255&(n^e[i++])];for(;i<3+r;)n=n>>>8^a[255&(n^e[i++])];return-1^n},i.str=function(e,t){for(var n,r,i=-1^t,o=0,s=e.length;o<s;)n=e.charCodeAt(o++),i=n<128?i>>>8^a[255&(i^n)]:n<2048?(i=i>>>8^a[255&(i^(192|n>>6&31))])>>>8^a[255&(i^(128|63&n))]:55296<=n&&n<57344?(n=64+(1023&n),r=1023&e.charCodeAt(o++),(i=(i=(i=i>>>8^a[255&(i^(240|n>>8&7))])>>>8^a[255&(i^(128|n>>2&63))])>>>8^a[255&(i^(128|r>>6&15|(3&n)<<4))])>>>8^a[255&(i^(128|63&r))]):(i=(i=i>>>8^a[255&(i^(224|n>>12&15))])>>>8^a[255&(i^(128|n>>6&63))])>>>8^a[255&(i^(128|63&n))];return-1^i};var Ae,a,D,Q=function(){var i,e={};function h(e){var t;return"/"==e.charAt(e.length-1)?-1===e.slice(0,-1).indexOf("/")?e:h(e.slice(0,-1)):-1===(t=e.lastIndexOf("/"))?e:e.slice(0,t+1)}function f(e){var t;return"/"==e.charAt(e.length-1)?f(e.slice(0,-1)):-1===(t=e.lastIndexOf("/"))?e:e.slice(t+1)}function _(e){fe(e,0);for(var t,n={};e.l<=e.length-4;){var r=e._R(2),i=e._R(2),o=e.l+i,s={};21589===r&&(1&(t=e._R(1))&&(s.mtime=e._R(4)),5<i&&(2&t&&(s.atime=e._R(4)),4&t)&&(s.ctime=e._R(4)),s.mtime)&&(s.mt=new Date(1e3*s.mtime)),e.l=o,n[r]=s}return n}function o(){i=i||require("fs")}function s(e,t){if(80==e[0]&&75==e[1])return q(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var n,r=512,i=[],o=e.slice(0,512),s=(fe(o,0),function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(X,"Header Signature: "),e.l+=16;var t=e._R(2,"u");return[e._R(2,"u"),t]}(o));switch(n=s[0]){case 3:r=512;break;case 4:r=4096;break;case 0:if(0==s[1])return q(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+n)}512!==r&&fe(o=e.slice(0,r),28);var P=e.slice(0,r),a=o,l=n,u=9;switch(a.l+=2,u=a._R(2)){case 9:if(3!=l)throw new Error("Sector Shift: Expected 9 saw "+u);break;case 12:if(4!=l)throw new Error("Sector Shift: Expected 12 saw "+u);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+u)}a.chk("0600","Mini Sector Shift: "),a.chk("000000000000","Reserved: ");var a=o._R(4,"i");if(3===n&&0!==a)throw new Error("# Directory Sectors: Expected 0 saw "+a);o.l+=4,a=o._R(4,"i"),o.l+=4,o.chk("00100000","Mini Stream Cutoff Size: ");for(var c,d=o._R(4,"i"),h=o._R(4,"i"),f=o._R(4,"i"),p=o._R(4,"i"),g=0;g<109&&!((c=o._R(4,"i"))<0);++g)i[g]=c;for(var m,y=function(e,t){for(var n=Math.ceil(e.length/t)-1,r=[],i=1;i<n;++i)r[i-1]=e.slice(i*t,(i+1)*t);return r[n-1]=e.slice(n*t),r}(e,r),f=(!function e(t,n,r,i,o){var s=Y;if(t===Y){if(0!==n)throw new Error("DIFAT chain shorter than expected")}else if(-1!==t){var a=r[t],l=(i>>>2)-1;if(a){for(var u=0;u<l&&(s=Wt(a,4*u))!==Y;++u)o.push(s);e(Wt(a,i-4),n-1,r,i,o)}}}(f,p,y,r,i),function(e,t,n,r){var i=e.length,o=[],s=[],a=[],l=[],u=r-1,c=0,d=0,h=0,f=0;for(c=0;c<i;++c)if(a=[],i<=(h=c+t)&&(h-=i),!s[h]){l=[];var p=[];for(d=h;0<=d;){s[d]=p[d]=!0,a[a.length]=d,l.push(e[d]);var g=n[Math.floor(4*d/r)];if(r<4+(f=4*d&u))throw new Error("FAT boundary crossed: "+d+" 4 "+r);if(!e[g])break;if(d=Wt(e[g],f),p[d])break}o[h]={nodes:a,data:Et([l])}}return o}(y,a,i,r)),p=(f[a].name="!Directory",0<h&&d!==Y&&(f[d].name="!MiniFAT"),f[i[0]].name="!FAT",f.fat_addrs=i,f.ssz=r,[]),v=[],b=[],E=f,F=y,C=p,B=h,H={},U=v,V=d,w=0,W=C.length?2:0,$=E[a].data,S=0,j=0;S<$.length;S+=128){var T=$.slice(S,S+128),R=(fe(T,64),j=T._R(2),m=wt(T,0,j-W),C.push(m),{name:m,type:T._R(1),color:T._R(1),L:T._R(4,"i"),R:T._R(4,"i"),C:T._R(4,"i"),clsid:T._R(16),state:T._R(4,"i"),start:0,size:0});0!==T._R(2)+T._R(2)+T._R(2)+T._R(2)&&(R.ct=G(T,T.l-8)),0!==T._R(2)+T._R(2)+T._R(2)+T._R(2)&&(R.mt=G(T,T.l-8)),R.start=T._R(4,"i"),R.size=T._R(4,"i"),R.size<0&&R.start<0&&(R.size=R.type=0,R.start=Y,R.name=""),5===R.type?(w=R.start,0<B&&w!==Y&&(E[w].name="!StreamData")):4096<=R.size?(R.storage="fat",void 0===E[R.start]&&(E[R.start]=function(e,t,n,r,i){var o=[],s=[];i=i||[];var a=r-1,l=0,u=0;for(l=t;0<=l;){i[l]=!0,o[o.length]=l,s.push(e[l]);var c=n[Math.floor(4*l/r)];if(r<4+(u=4*l&a))throw new Error("FAT boundary crossed: "+l+" 4 "+r);if(!e[c])break;l=Wt(e[c],u)}return{nodes:o,data:Et([s])}}(F,R.start,E.fat_addrs,E.ssz)),E[R.start].name=R.name,R.content=E[R.start].data.slice(0,R.size)):(R.storage="minifat",R.size<0?R.size=0:w!==Y&&R.start!==Y&&E[w]&&(R.content=function(e,t,n){var r=e.start,i=e.size,o=[],s=r;for(;n&&0<i&&0<=s;)o.push(t.slice(64*s,64*s+64)),i-=64,s=Wt(n,4*s);return 0===o.length?ee(0):we(o).slice(0,e.size)}(R,E[w].data,(E[V]||{}).data))),R.content&&fe(R.content,0),H[m]=R,U.push(R)}for(var A=v,_=b,z=p,N=0,x=0,O=0,I=0,M=0,k=z.length,D=[],L=[];N<k;++N)D[N]=L[N]=N,_[N]=z[N];for(;M<L.length;++M)x=A[N=L[M]].L,O=A[N].R,I=A[N].C,D[N]===N&&(-1!==x&&D[x]!==x&&(D[N]=D[x]),-1!==O)&&D[O]!==O&&(D[N]=D[O]),-1!==I&&(D[I]=N),-1!==x&&N!=D[N]&&(D[x]=D[N],L.lastIndexOf(x)<M)&&L.push(x),-1!==O&&N!=D[N]&&(D[O]=D[N],L.lastIndexOf(O)<M)&&L.push(O);for(N=1;N<k;++N)D[N]===N&&(-1!==O&&D[O]!==O?D[N]=D[O]:-1!==x&&D[x]!==x&&(D[N]=D[x]));for(N=1;N<k;++N)if(0!==A[N].type){if((M=N)!=D[M])for(;M=D[M],_[N]=_[M]+"/"+_[N],0!==M&&-1!==D[M]&&M!=D[M];);D[N]=-1}for(_[0]+="/",N=1;N<k;++N)2!==A[N].type&&(_[N]+="/");p.shift();f={FileIndex:v,FullPaths:b};return t&&t.raw&&(f.raw={header:P,sectors:y}),f}function G(e,t){return new Date(1e3*(J(e,t+4)/1e7*Math.pow(2,32)+J(e,t)/1e7-11644473600))}function N(e,t){var t=t||{},n=t.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=n+"/",e.FileIndex[0]={name:n,type:5}),t.CLSID&&(e.FileIndex[0].clsid=t.CLSID),n=e,t="Sh33tJ5",Q.find(n,"/"+t)||((e=ee(4))[0]=55,e[1]=e[3]=50,e[2]=54,n.FileIndex.push({name:t,type:2,content:e,size:4,L:69,R:69,C:69}),n.FullPaths.push(n.FullPaths[0]+t),O(n))}function O(e,t){N(e);for(var n=!1,r=!1,i=e.FullPaths.length-1;0<=i;--i){var o=e.FileIndex[i];switch(o.type){case 0:r?n=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:r=!0,isNaN(o.R*o.L*o.C)&&(n=!0),-1<o.R&&-1<o.L&&o.R==o.L&&(n=!0);break;default:n=!0}}if(n||t){for(var s=new Date(1987,1,19),a=0,l=[],i=0;i<e.FullPaths.length;++i)0!==e.FileIndex[i].type&&l.push([e.FullPaths[i],e.FileIndex[i]]);for(i=0;i<l.length;++i){for(var u=h(l[i][0]),r=!1,a=0;a<l.length;++a)l[a][0]===u&&(r=!0);r||l.push([u,{name:f(u).replace("/",""),type:1,clsid:p,ct:s,mt:s,content:null}])}for(l.sort(function(e,t){for(var n,e=e[0],t=t[0],r=e.split("/"),i=t.split("/"),o=0,s=Math.min(r.length,i.length);o<s;++o){if(n=r[o].length-i[o].length)return n;if(r[o]!=i[o])return r[o]<i[o]?-1:1}return r.length-i.length}),e.FullPaths=[],e.FileIndex=[],i=0;i<l.length;++i)e.FullPaths[i]=l[i][0],e.FileIndex[i]=l[i][1];for(i=0;i<l.length;++i){var c=e.FileIndex[i],d=e.FullPaths[i];if(c.name=f(d).replace("/",""),c.L=c.R=c.C=-(c.color=1),c.size=c.content?c.content.length:0,c.start=0,c.clsid=c.clsid||p,0===i)c.C=1<l.length?1:-1,c.size=0,c.type=5;else if("/"==d.slice(-1)){for(a=i+1;a<l.length&&h(e.FullPaths[a])!=d;++a);for(c.C=l.length<=a?-1:a,a=i+1;a<l.length&&h(e.FullPaths[a])!=h(d);++a);c.R=l.length<=a?-1:a,c.type=1}else h(e.FullPaths[i+1]||"")==h(d)&&(c.R=i+1),c.type=2}}}function r(e,t){var n=t||{};if(O(e),"zip"==n.fileType){var r=e,t=(t=n)||{},i=[],o=[],s=ee(1),a=t.compression?8:0,l=0,u=0,c=0,d=0,h=0,f=r.FullPaths[0],p=f,g=r.FileIndex[0],m=[],y=0;for(u=1;u<r.FullPaths.length;++u)if(p=r.FullPaths[u].slice(f.length),(g=r.FileIndex[u]).size&&g.content&&"Sh33tJ5"!=p){var v=d,b=ee(p.length);for(c=0;c<p.length;++c)b._W(1,127&p.charCodeAt(c));b=b.slice(0,b.l),m[h]=Ae.buf(g.content,0);var E=g.content;8==a&&(E=function(e){return I?I.deflateRawSync(e):P(e)}(E)),(s=ee(30))._W(4,67324752),s._W(2,20),s._W(2,l),s._W(2,a),g.mt?function(e,t){var n;n=((t="string"==typeof t?new Date(t):t).getHours()<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e._W(2,n),n=(t.getFullYear()-1980<<4|t.getMonth()+1)<<5|t.getDate(),e._W(2,n)}(s,g.mt):s._W(4,0),s._W(-4,8&l?0:m[h]),s._W(4,8&l?0:E.length),s._W(4,8&l?0:g.content.length),s._W(2,b.length),s._W(2,0),d+=s.length,i.push(s),d+=b.length,i.push(b),d+=E.length,i.push(E),8&l&&((s=ee(12))._W(-4,m[h]),s._W(4,E.length),s._W(4,g.content.length),d+=s.l,i.push(s)),(s=ee(46))._W(4,33639248),s._W(2,0),s._W(2,20),s._W(2,l),s._W(2,a),s._W(4,0),s._W(-4,m[h]),s._W(4,E.length),s._W(4,g.content.length),s._W(2,b.length),s._W(2,0),s._W(2,0),s._W(2,0),s._W(2,0),s._W(4,0),s._W(4,v),y+=s.l,o.push(s),y+=b.length,o.push(b),++h}return(s=ee(22))._W(4,101010256),s._W(2,0),s._W(2,0),s._W(2,h),s._W(2,h),s._W(4,y),s._W(4,d),s._W(2,0),we([we(i),we(o),s])}for(var C=function(e){for(var t=0,n=0,r=0;r<e.FileIndex.length;++r){var i=e.FileIndex[r];i.content&&0<(i=i.content.length)&&(i<4096?t+=i+63>>6:n+=i+511>>9)}for(var o=e.FullPaths.length+3>>2,s=t+127>>7,a=(t+7>>3)+n+o+s,l=a+127>>7,u=l<=109?0:Math.ceil((l-109)/127);l<a+l+u+127>>7;)u=++l<=109?0:Math.ceil((l-109)/127);s=[1,u,l,s,o,n,t,0];return e.FileIndex[0].size=t<<6,s[7]=(e.FileIndex[0].start=s[0]+s[1]+s[2]+s[3]+s[4]+s[5])+(s[6]+7>>3),s}(e),w=ee(C[7]<<9),S=0,T=0,S=0;S<8;++S)w._W(1,H[S]);for(S=0;S<8;++S)w._W(2,0);for(w._W(2,62),w._W(2,3),w._W(2,65534),w._W(2,9),w._W(2,6),S=0;S<3;++S)w._W(2,0);for(w._W(4,0),w._W(4,C[2]),w._W(4,C[0]+C[1]+C[2]+C[3]-1),w._W(4,0),w._W(4,4096),w._W(4,C[3]?C[0]+C[1]+C[2]-1:Y),w._W(4,C[3]),w._W(-4,C[1]?C[0]-1:Y),w._W(4,C[1]),S=0;S<109;++S)w._W(-4,S<C[2]?C[1]+S:-1);if(C[1])for(T=0;T<C[1];++T){for(;S<236+127*T;++S)w._W(-4,S<C[2]?C[1]+S:-1);w._W(-4,T===C[1]-1?Y:T+1)}function R(e){for(T+=e;S<T-1;++S)w._W(-4,S+1);e&&(++S,w._W(-4,Y))}T=S=0;for(T+=C[1];S<T;++S)w._W(-4,M.DIFSECT);for(T+=C[2];S<T;++S)w._W(-4,M.FATSECT);R(C[3]),R(C[4]);for(var A=0,_=0,N=e.FileIndex[0];A<e.FileIndex.length;++A)!(N=e.FileIndex[A]).content||(_=N.content.length)<4096||(N.start=T,R(_+511>>9));for(R(C[6]+7>>3);511&w.l;)w._W(-4,M.ENDOFCHAIN);for(A=T=S=0;A<e.FileIndex.length;++A)!(N=e.FileIndex[A]).content||!(_=N.content.length)||4096<=_||(N.start=T,R(_+63>>6));for(;511&w.l;)w._W(-4,M.ENDOFCHAIN);for(S=0;S<C[4]<<2;++S){var x=e.FullPaths[S];if(x&&0!==x.length){N=e.FileIndex[S],0===S&&(N.start=N.size?N.start-1:Y);x=0===S&&n.root||N.name,_=2*(x.length+1);if(w._W(64,x,"utf16le"),w._W(2,_),w._W(1,N.type),w._W(1,N.color),w._W(-4,N.L),w._W(-4,N.R),w._W(-4,N.C),N.clsid)w._W(16,N.clsid,"hex");else for(A=0;A<4;++A)w._W(4,0);w._W(4,N.state||0),w._W(4,0),w._W(4,0),w._W(4,0),w._W(4,0),w._W(4,N.start),w._W(4,N.size),w._W(4,0)}else{for(A=0;A<17;++A)w._W(4,0);for(A=0;A<3;++A)w._W(4,-1);for(A=0;A<12;++A)w._W(4,0)}}for(S=1;S<e.FileIndex.length;++S)if(4096<=(N=e.FileIndex[S]).size){for(w.l=N.start+1<<9,A=0;A<N.size;++A)w._W(1,N.content[A]);for(;511&A;++A)w._W(1,0)}for(S=1;S<e.FileIndex.length;++S)if(0<(N=e.FileIndex[S]).size&&N.size<4096){for(A=0;A<N.size;++A)w._W(1,N.content[A]);for(;63&A;++A)w._W(1,0)}for(;w.l<w.length;)w._W(1,0);return w}e.version="1.1.4";var I,Y=-2,X="d0cf11e0a1b11ae1",H=[208,207,17,224,161,177,26,225],p="00000000000000000000000000000000",M={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Y,FREESECT:-1,HEADER_SIGNATURE:X,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:p,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function a(e){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],b=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],E=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];for(var t,R="undefined"!=typeof Uint8Array,A=R?new Uint8Array(256):[],n=0;n<256;++n)A[n]=255&((t=139536&((t=n)<<1|t<<11)|558144&(t<<5|t<<15))>>16|t>>8|t);function x(e,t){var n=7&t,t=t>>>3;return(e[t]|(n<=5?0:e[1+t]<<8))>>>n&7}function k(e,t){var n=7&t,t=t>>>3;return(e[t]|(n<=3?0:e[1+t]<<8))>>>n&31}function D(e,t){var n=7&t,t=t>>>3;return(e[t]|(n<=1?0:e[1+t]<<8))>>>n&127}function g(e,t,n){var r=7&t,t=t>>>3,i=(1<<n)-1,o=e[t]>>>r;return n<8-r||(o|=e[1+t]<<8-r,n<16-r)||(o|=e[2+t]<<16-r,n<24-r)||(o|=e[3+t]<<24-r),o&i}function m(e,t){var n=e.length,r=t<2*n?2*n:t+5,i=0;if(!(t<=n)){if(T){var o=ne(r);if(e.copy)e.copy(o);else for(;i<e.length;++i)o[i]=e[i];return o}if(R){var s=new Uint8Array(r);if(s.set)s.set(e);else for(;i<e.length;++i)s[i]=e[i];return s}e.length=r}return e}function L(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}l=function(e,t){for(var n=0;n<e.length;){var r=Math.min(65535,e.length-n),i=n+r==e.length;for(t._W(1,+i),t._W(2,r),t._W(2,65535&~r);0<r--;)t[t.l++]=e[n++]}return t.l};var l,P=function(e){var t=ee(50+Math.floor(1.1*e.length)),e=l(e,t);return t.slice(0,e)};function F(e,t,n){for(var r,i=1,o=0,s=0,a=0,l=e.length,u=R?new Uint16Array(32):L(32),o=0;o<32;++o)u[o]=0;for(o=l;o<n;++o)e[o]=0;var l=e.length,c=R?new Uint16Array(l):L(l);for(o=0;o<l;++o)u[r=e[o]]++,i<r&&(i=r),c[o]=0;for(u[0]=0,o=1;o<=i;++o)u[o+16]=a=a+u[o-1]<<1;for(o=0;o<l;++o)0!=(a=e[o])&&(c[o]=u[a+16]++);var d,h,f,p;for(o=0;o<l;++o)if(0!=(d=e[o]))for(h=c[o],f=i,p=void 0,p=A[255&h],a=(f<=8?p>>>8-f:(p=p<<8|A[h>>8&255],f<=16?p>>>16-f:(p<<8|A[h>>16&255])>>>24-f))>>i-d,s=(1<<i+4-d)-1;0<=s;--s)t[a|s<<d]=15&d|o<<4;return i}var y=R?new Uint16Array(512):L(512),v=R?new Uint16Array(32):L(32);if(!R){for(var u=0;u<512;++u)y[u]=0;for(u=0;u<32;++u)v[u]=0}for(var C=[],c=0;c<32;c++)C.push(5);F(C,v,32);for(var d=[],c=0;c<=143;c++)d.push(8);for(;c<=255;c++)d.push(9);for(;c<=279;c++)d.push(7);for(;c<=287;c++)d.push(8);F(d,y,288);var V=R?new Uint16Array(32768):L(32768),W=R?new Uint16Array(32768):L(32768),$=R?new Uint16Array(128):L(128),j=1,z=1;function w(e,t){if(3==e[0]&&!(3&e[1]))return[te(t),2];for(var n=0,r=0,i=ne(t||1<<18),o=0,s=i.length>>>0,a=0,l=0;0==(1&r);)if(r=x(e,n),n+=3,r>>>1==0){7&n&&(n+=8-(7&n));var u=e[n>>>3]|e[1+(n>>>3)]<<8;if(n+=32,!t&&s<o+u&&(s=(i=m(i,o+u)).length),"function"==typeof e.copy)e.copy(i,o,n>>>3,(n>>>3)+u),o+=u,n+=8*u;else for(;0<u--;)i[o++]=e[n>>>3],n+=8}else for(l=r>>>1==1?(a=9,5):(n=function(e,t){for(var n,r,i,o=k(e,t)+257,s=k(e,t+=5)+1,a=(r=t+=5,i=7&t,4+(((n=e)[r=t>>>3]|(i<=4?0:n[1+r]<<8))>>>i&15)),l=(t+=4,0),u=R?new Uint8Array(19):L(19),c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],d=1,h=R?new Uint8Array(8):L(8),f=R?new Uint8Array(8):L(8),p=u.length,g=0;g<a;++g)u[U[g]]=l=x(e,t),d<l&&(d=l),h[l]++,t+=3;var m=0;for(h[0]=0,g=1;g<=d;++g)f[g]=m=m+h[g-1]<<1;for(g=0;g<p;++g)0!=(m=u[g])&&(c[g]=f[m]++);for(var y,g=0;g<p;++g)if(0!=(y=u[g]))for(var m=A[c[g]]>>8-y,v=(1<<7-y)-1;0<=v;--v)$[m|v<<y]=7&y|g<<3;for(var b,E,C,w=[],d=1;w.length<o+s;)switch(m=$[D(e,t)],t+=7&m,m>>>=3){case 16:for(l=3+(C=void 0,C=7&(E=t),((b=e)[E=t>>>3]|(C<=6?0:b[1+E]<<8))>>>C&3),t+=2,m=w[w.length-1];0<l--;)w.push(m);break;case 17:for(l=3+x(e,t),t+=3;0<l--;)w.push(0);break;case 18:for(l=11+D(e,t),t+=7;0<l--;)w.push(0);break;default:w.push(m),d<m&&(d=m)}var S=w.slice(0,o),T=w.slice(o);for(g=o;g<286;++g)S[g]=0;for(g=s;g<30;++g)T[g]=0;return j=F(S,V,286),z=F(T,W,30),t}(e,n),a=j,z),!t&&s<o+32767&&(s=(i=m(i,o+32767)).length);;){var c=g(e,n,a),d=(r>>>1==1?y:V)[c];if(n+=15&d,0==((d>>>=4)>>>8&255))i[o++]=d;else{if(256==d)break;var h=(d-=257)<8?0:d-4>>2,f=(5<h&&(h=0),o+b[d]),h=(0<h&&(f+=g(e,n,h),n+=h),c=g(e,n,l),n+=15&(d=(r>>>1==1?v:W)[c]),(d>>>=4)<4?0:d-2>>1),p=E[d];for(0<h&&(p+=g(e,n,h),n+=h),!t&&s<f&&(s=(i=m(i,f)).length);o<f;)i[o]=i[o-p],++o}}return[t?i:i.slice(0,o),n+7>>>3]}function K(e,t){t=w(e.slice(e.l||0),t);return e.l+=t[1],t[0]}function B(e,t){if(!e)throw new Error(t);"undefined"!=typeof console&&console.error(t)}function q(e,t){for(var n=e,r=(fe(n,0),{FileIndex:[],FullPaths:[]}),i=(N(r,{root:t.root}),n.length-4);(80!=n[i]||75!=n[i+1]||5!=n[i+2]||6!=n[i+3])&&0<=i;)--i;n.l=i+4,n.l+=4;var o=n._R(2),e=(n.l+=6,n._R(4));for(n.l=e,i=0;i<o;++i){n.l+=20;var s=n._R(4),a=n._R(4),l=n._R(2),u=n._R(2),c=n._R(2),d=(n.l+=8,n._R(4)),h=_(n.slice(n.l+l,n.l+l+u)),l=(n.l+=l+u+c,n.l),f=(n.l=d+4,R=A=T=S=w=C=E=b=v=y=m=g=p=d=c=u=f=void 0,n),u=s,c=a,d=r,p=h,g=(f.l+=2,f._R(2)),m=f._R(2),y=function(e){var t=65535&e._R(2),e=65535&e._R(2),n=new Date,r=31&e,i=15&(e>>>=5),e=(e>>>=4,n.setMilliseconds(0),n.setFullYear(1980+e),n.setMonth(i-1),n.setDate(r),31&t),i=63&(t>>>=5);return n.setHours(t>>>=6),n.setMinutes(i),n.setSeconds(e<<1),n}(f);if(8257&g)throw new Error("Unsupported ZIP encryption");for(var v=f._R(4),b=f._R(4),E=f._R(4),C=f._R(2),w=f._R(2),S="",T=0;T<C;++T)S+=String.fromCharCode(f[f.l++]);w&&(((A=_(f.slice(f.l,f.l+w)))[21589]||{}).mt&&(y=A[21589].mt),((p||{})[21589]||{}).mt)&&(y=p[21589].mt),f.l+=w;var R=f.slice(f.l,f.l+b);switch(m){case 8:R=function(e,t){var n,r;return I?(r=(n=new I.InflateRaw)._processChunk(e.slice(e.l),n._finishFlushFlag),e.l+=n.bytesRead,r):K(e,t)}(f,E);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+m)}var A=!1;8&g&&(134695760==(v=f._R(4))&&(v=f._R(4),A=!0),b=f._R(4),E=f._R(4)),b!=u&&B(A,"Bad compressed size: "+u+" != "+b),E!=c&&B(A,"Bad uncompressed size: "+c+" != "+E),p=Ae.buf(R,0),v>>0!=p>>0&&B(A,"Bad CRC32 checksum: "+v+" != "+p),Z(d,S,R,{unsafe:!0,mt:y}),n.l=l}return r}function Z(e,t,n,r){var i,o=r&&r.unsafe,s=(o||N(e),!o&&Q.find(e,t));return s||(i=e.FullPaths[0],i=t.slice(0,i.length)==i?t:("/"!=i.slice(-1)&&(i+="/"),(i+t).replace("//","/")),s={name:f(t),type:2},e.FileIndex.push(s),e.FullPaths.push(i),o)||Q.utils.cfb_gc(e),s.content=n,s.size=n?n.length:0,r&&(r.CLSID&&(s.clsid=r.CLSID),r.mt&&(s.mt=r.mt),r.ct)&&(s.ct=r.ct),s}return e.find=function(e,t){var n=e.FullPaths.map(function(e){return e.toUpperCase()}),r=n.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),i=!1,o=(47===t.charCodeAt(0)?(i=!0,t=n[0].slice(0,-1)+t):i=-1!==t.indexOf("/"),t.toUpperCase()),s=(!0===i?n:r).indexOf(o);if(-1!==s)return e.FileIndex[s];var a=!o.match(Se),o=o.replace(ie,"");for(a&&(o=o.replace(Se,"!")),s=0;s<n.length;++s){if((a?n[s].replace(Se,"!"):n[s]).replace(ie,"")==o)return e.FileIndex[s];if((a?r[s].replace(Se,"!"):r[s]).replace(ie,"")==o)return e.FileIndex[s]}return null},e.read=function(e,t){switch(t&&t.type||"base64"){case"file":return n=e,r=t,o(),s(i.readFileSync(n),r);case"base64":return s(re(S.decode(e)),t);case"binary":return s(re(e),t)}var n,r;return s(e,t)},e.parse=s,e.write=function(e,t){var n=r(e,t);switch(t&&t.type){case"file":return o(),i.writeFileSync(t.filename,n),n;case"binary":return a(n);case"base64":return S.encode(a(n))}return n},e.writeFile=function(e,t,n){o(),e=r(e,n),i.writeFileSync(t,e)},e.utils={cfb_new:function(e){var t={};return N(t,e),t},cfb_add:Z,cfb_del:function(e,t){N(e);var n=Q.find(e,t);if(n)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==n)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,n){N(e);var r=Q.find(e,t);if(r)for(var i=0;i<e.FileIndex.length;++i)if(e.FileIndex[i]==r)return e.FileIndex[i].name=f(n),e.FullPaths[i]=n,!0;return!1},cfb_gc:function(e){O(e,!0)},ReadShift:jt,CheckField:Kt,prep_blob:fe,bconcat:we,use_zlib:function(e){try{var t=new e.InflateRaw;if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");I=e}catch(e){console.error("cannot use native zlib: "+(e.message||e))}},_deflateRaw:P,_inflateRaw:K,consts:M},e}();if("undefined"!=typeof require)try{D=require("fs")}catch(e){}function L(e){if("string"==typeof e)return v(e);if(Array.isArray(e)){var t=e;if("undefined"==typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(t)}return e}function P(e,t,n){if(void 0!==D&&D.writeFileSync)return n?D.writeFileSync(e,t,n):D.writeFileSync(e,t);n="utf8"==n?st(t):t;if("undefined"!=typeof IE_SaveFile)return IE_SaveFile(n,e);if("undefined"!=typeof Blob){n=new Blob([L(n)],{type:"application/octet-stream"});if("undefined"!=typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if("undefined"!=typeof saveAs)return saveAs(n,e);if("undefined"!=typeof URL&&"undefined"!=typeof document&&document.createElement&&URL.createObjectURL){var r=URL.createObjectURL(n);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(r)},6e4),chrome.downloads.download({url:r,filename:e,saveAs:!0});n=document.createElement("a");if(null!=n.download)return n.download=e,n.href=r,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(r)},6e4),r}}if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var i=File(e);return i.open("w"),i.encoding="binary",Array.isArray(t)&&(t=o(t)),i.write(t),i.close(),t}catch(e){if(!e.message||!e.message.match(/onstruct/))throw e}throw new Error("cannot save file "+e)}function ue(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function F(e,t){for(var n=[],r=ue(e),i=0;i!==r.length;++i)null==n[e[r[i]][t]]&&(n[e[r[i]][t]]=r[i]);return n}function H(e){for(var t=[],n=ue(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function U(e){for(var t=[],n=ue(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}var V=new Date(1899,11,30,0,0,0);function j(e,t){var n=e.getTime(),t=(t&&(n-=1263168e5),V.getTime()+6e4*(e.getTimezoneOffset()-V.getTimezoneOffset()));return(n-t)/864e5}var W=new Date,z=V.getTime()+6e4*(W.getTimezoneOffset()-V.getTimezoneOffset()),G=W.getTimezoneOffset();function Y(e){var t=new Date;return t.setTime(24*e*60*60*1e3+z),t.getTimezoneOffset()!==G&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-G)),t}var X=new Date("2017-02-19T19:06:09.000Z"),K=2017==(X=isNaN(X.getFullYear())?new Date("2/19/17"):X).getFullYear();function oe(e,t){var n=new Date(e);return K?(0<t?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n):e instanceof Date?e:1917!=X.getFullYear()||isNaN(n.getFullYear())?(t=e.match(/\d+/g)||["2017","2","19","0","0","0"],t=new Date(+t[0],+t[1]-1,+t[2],+t[3]||0,+t[4]||0,+t[5]||0),-1<e.indexOf("Z")?new Date(t.getTime()-60*t.getTimezoneOffset()*1e3):t):(t=n.getFullYear(),-1<e.indexOf(""+t)||n.setFullYear(n.getFullYear()+100),n)}function q(e){for(var t="",n=0;n!=e.length;++n)t+=String.fromCharCode(e[n]);return t}function _e(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t,n={};for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=_e(e[t]));return n}function Z(e,t){for(var n="";n.length<t;)n+=e;return n}function Ne(e){var n,t=Number(e);return!isNaN(t)||!/\d/.test(e)||(n=1,e=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""}),isNaN(t=Number(e))&&(e=e.replace(/[(](.*)[)]/,function(e,t){return n=-n,t}),isNaN(t=Number(e))))?t:t/n}function xe(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),i=t.getMonth(),o=t.getDate();return isNaN(o)||r<0||8099<r||(!(0<i||1<o)||101==r)&&!e.toLowerCase().match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)&&e.match(/[^-0-9:,\/\\]/)?n:t}var Oe,Ie=5=="abacaba".split(/(:?b)/i).length;function Me(e){return e?e.data?Ce(e.data):e.asNodeBuffer&&T?Ce(e.asNodeBuffer().toString("binary")):e.asBinary?Ce(e.asBinary()):e._data&&e._data.getContent?Ce(q(Array.prototype.slice.call(e._data.getContent(),0))):e.content&&e.type?Ce(q(e.content)):null:null}function ke(e){return e&&".bin"===e.name.slice(-4)?(t=e)?t.data?Ee(t.data):t.asNodeBuffer&&T?t.asNodeBuffer():t._data&&t._data.getContent?"string"==typeof(n=t._data.getContent())?Ee(n):Array.prototype.slice.call(n):t.content&&t.type?t.content:null:null:Me(e);var t,n}function De(e,t){for(var n=e.FullPaths||ue(e.files),r=t.toLowerCase(),i=r.replace(/\//g,"\\"),o=0;o<n.length;++o){var s=n[o].toLowerCase();if(r==s||i==s)return e.files[n[o]]}return null}function Le(e,t){e=De(e,t);if(null==e)throw new Error("Cannot find file "+t+" in zip");return e}function O(e,t,n){if(!n)return ke(Le(e,t));if(!t)return null;try{return O(e,t)}catch(e){return null}}function Pe(e,t,n){if(!n)return Me(Le(e,t));if(!t)return null;try{return Pe(e,t)}catch(e){return null}}function R(e,t,n){e.FullPaths?Q.utils.cfb_add(e,t,n):e.file(t,n)}function Fe(){return Oe?new Oe:Q.utils.cfb_new()}function Be(e,t){if("/"==e.charAt(0))return e.slice(1);for(var n=t.split("/"),r=("/"!=t.slice(-1)&&n.pop(),e.split("/"));0!==r.length;){var i=r.shift();".."===i?n.pop():"."!==i&&n.push(i)}return n.join("/")}"undefined"!=typeof JSZipSync&&(Oe=JSZipSync),"undefined"!=typeof exports&&"undefined"!=typeof module&&module.exports&&void 0===Oe&&(Oe=void 0);var A='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',He=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Ue=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s?[\/\?]?>/gm,Ve=(A.match(Ue)||(Ue=/<[^>]*>/g),/<\w*:/),We=/<(\/?)\w+:/;function se(e,t,n){for(var r={},i=0,o=0;i!==e.length&&32!==(o=e.charCodeAt(i))&&10!==o&&13!==o;++i);if(t||(r[0]=e.slice(0,i)),i!==e.length){var s,a,l=e.match(He),u=0,c=0,d="",h="";if(l)for(c=0;c!=l.length;++c){for(h=l[c],o=0;o!=h.length&&61!==h.charCodeAt(o);++o);for(d=h.slice(0,o).trim();32==h.charCodeAt(o+1);)++o;for(s=34==(i=h.charCodeAt(o+1))||39==i?1:0,s=h.slice(o+1+s,h.length-s),u=0;u!=d.length&&58!==d.charCodeAt(u);++u);u===d.length?(r[d=0<d.indexOf("_")?d.slice(0,d.indexOf("_")):d]=s,n||(r[d.toLowerCase()]=s)):r[a=(5===u&&"xmlns"===d.slice(0,5)?"xmlns":"")+d.slice(u+1)]&&"ext"==d.slice(u-3,u)||(r[a]=s,n)||(r[a.toLowerCase()]=s)}}return r}function $e(e){return e.replace(We,"<$1")}var je,ze,Ge={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ye=H(Ge),ce=(je=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,ze=/_x([\da-fA-F]{4})_/gi,function e(t){var n,t=t+"",r=t.indexOf("<![CDATA[");return-1==r?t.replace(je,function(e,t){return Ge[e]||String.fromCharCode(parseInt(t,-1<e.indexOf("x")?16:10))||e}).replace(ze,function(e,t){return String.fromCharCode(parseInt(t,16))}):(n=t.indexOf("]]>"),e(t.slice(0,r))+t.slice(r+9,n)+e(t.slice(n+3)))}),Xe=/[&<>'"]/g,Ke=/[\u0000-\u0008\u000b-\u001f]/g;function _(e){return(e+"").replace(Xe,function(e){return Ye[e]}).replace(Ke,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function qe(e){return _(e).replace(/ /g,"_x0020_")}var Ze=/[\u0000-\u001f]/g;function Qe(e){return(e+"").replace(Xe,function(e){return Ye[e]}).replace(/\n/g,"<br/>").replace(Ze,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}Je=/&#(\d+);/g;var Je,et=function(e){return e.replace(Je,tt)};function tt(e,t){return String.fromCharCode(parseInt(t,10))}var nt=function(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")};function de(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}var rt,it,ot,he=function(e){for(var t,n,r,i="",o=0,s=0;o<e.length;)(r=e.charCodeAt(o++))<128?i+=String.fromCharCode(r):(t=e.charCodeAt(o++),191<r&&r<224?(s=(31&r)<<6,s|=63&t,i+=String.fromCharCode(s)):(n=e.charCodeAt(o++),r<240?i+=String.fromCharCode((15&r)<<12|(63&t)<<6|63&n):(r=((7&r)<<18|(63&t)<<12|(63&n)<<6|63&(s=e.charCodeAt(o++)))-65536,i=(i+=String.fromCharCode(55296+(r>>>10&1023)))+String.fromCharCode(56320+(1023&r)))));return i},st=function(e){for(var t,n=[],r=0,i=0;r<e.length;)switch(!0){case(i=e.charCodeAt(r++))<128:n.push(String.fromCharCode(i));break;case i<2048:n.push(String.fromCharCode(192+(i>>6))),n.push(String.fromCharCode(128+(63&i)));break;case 55296<=i&&i<57344:i-=55296,t=e.charCodeAt(r++)-56320+(i<<10),n.push(String.fromCharCode(240+(t>>18&7))),n.push(String.fromCharCode(144+(t>>12&63))),n.push(String.fromCharCode(128+(t>>6&63))),n.push(String.fromCharCode(128+(63&t)));break;default:n.push(String.fromCharCode(224+(i>>12))),n.push(String.fromCharCode(128+(i>>6&63))),n.push(String.fromCharCode(128+(63&i)))}return n.join("")},at=(T&&(W=function(e){for(var t,n,r=Buffer.alloc(2*e.length),i=1,o=0,s=0,a=0;a<e.length;a+=i)i=1,(n=e.charCodeAt(a))<128?t=n:n<224?(t=64*(31&n)+(63&e.charCodeAt(a+1)),i=2):n<240?(t=4096*(15&n)+64*(63&e.charCodeAt(a+1))+(63&e.charCodeAt(a+2)),i=3):(i=4,t=262144*(7&n)+4096*(63&e.charCodeAt(a+1))+64*(63&e.charCodeAt(a+2))+(63&e.charCodeAt(a+3)),s=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==s&&(r[o++]=255&s,r[o++]=s>>>8,s=0),r[o++]=t%256,r[o++]=t>>>8;return r.slice(0,o).toString("ucs2")},yn=function(e){return f(e,"binary").toString("utf8")},(he=he(rn="foo bar bazâð£")==W(rn)?W:he)(rn)==yn(rn)&&(he=yn),st=function(e){return f(e,"utf8").toString("binary")}),rt={},function(e,t){var n=e+"|"+(t||"");return rt[n]||(rt[n]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",t||""))}),lt=(it=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}),function(e){for(var t=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),n=0;n<it.length;++n)t=t.replace(it[n][0],it[n][1]);return t}),ut=(ot={},function(e){return void 0!==ot[e]?ot[e]:ot[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}),ct=/<\/?(?:vt:)?variant>/g,dt=/<(?:vt:)([^>]*)>([\s\S]*)</;function ht(e,t){var n=se(e),e=e.match(ut(n.baseType))||[],r=[];if(e.length!=n.size){if(t.WTF)throw new Error("unexpected vector length "+e.length+" != "+n.size)}else e.forEach(function(e){e=e.replace(ct,"").match(dt);e&&r.push({v:he(e[2]),t:e[1]})});return r}var ft=/(^\s|\s$|\n)/;function pt(e,t){return"<"+e+(t.match(ft)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function gt(t){return ue(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function N(e,t,n){return"<"+e+(null!=n?gt(n):"")+(null!=t?(t.match(ft)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function mt(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}var I={dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema",main:["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"]},yt={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};var vt,bt,Et=function(e){for(var t=[],n=0;n<e[0].length;++n)if(e[0][n])for(var r=0,i=e[0][n].length;r<i;r+=10240)t.push.apply(t,e[0][n].slice(r,r+10240));return t},Ct=Et,wt=function(e,t,n){for(var r=[],i=t;i<n;i+=2)r.push(String.fromCharCode(Ut(e,i)));return r.join("").replace(ie,"")},St=wt,Tt=function(e,t,n){for(var r=[],i=t;i<t+n;++i)r.push(("0"+e[i].toString(16)).slice(-2));return r.join("")},Rt=Tt,At=function(e,t,n){for(var r=[],i=t;i<n;i++)r.push(String.fromCharCode(Ht(e,i)));return r.join("")},_t=At,Nt=function(e,t){var n=J(e,t);return 0<n?At(e,t+4,t+4+n-1):""},xt=Nt,Ot=function(e,t){var n=J(e,t);return 0<n?At(e,t+4,t+4+n-1):""},It=Ot,Mt=function(e,t){var n=2*J(e,t);return 0<n?At(e,t+4,t+4+n-1):""},kt=Mt,Dt=vt=function(e,t){var n=J(e,t);return 0<n?wt(e,t+4,t+4+n):""},Lt=function(e,t){var n=J(e,t);return 0<n?At(e,t+4,t+4+n):""},Pt=Lt,Ft=bt=function(e,t){for(var n=e,r=t,e=1-2*(n[r+7]>>>7),t=((127&n[r+7])<<4)+(n[r+6]>>>4&15),i=15&n[r+6],o=5;0<=o;--o)i=256*i+n[r+o];return 2047==t?0==i?1/0*e:NaN:(0==t?t=-1022:(t-=1023,i+=Math.pow(2,52)),e*Math.pow(2,t-52)*i)},Bt=function(e){return Array.isArray(e)},Ht=(T&&(wt=function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(ie,""):St(e,t,n)},Tt=function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):Rt(e,t,n)},Nt=function(e,t){var n;return Buffer.isBuffer(e)?0<(n=e.readUInt32LE(t))?e.toString("utf8",t+4,t+4+n-1):"":xt(e,t)},Ot=function(e,t){var n;return Buffer.isBuffer(e)?0<(n=e.readUInt32LE(t))?e.toString("utf8",t+4,t+4+n-1):"":It(e,t)},Mt=function(e,t){var n;return Buffer.isBuffer(e)?(n=2*e.readUInt32LE(t),e.toString("utf16le",t+4,t+4+n-1)):kt(e,t)},Dt=function(e,t){var n;return Buffer.isBuffer(e)?(n=e.readUInt32LE(t),e.toString("utf16le",t+4,t+4+n)):vt(e,t)},Lt=function(e,t){var n;return Buffer.isBuffer(e)?(n=e.readUInt32LE(t),e.toString("utf8",t+4,t+4+n)):Pt(e,t)},At=function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):_t(e,t,n)},Et=function(e){return 0<e[0].length&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0]):Ct(e)},we=function(e){return Buffer.isBuffer(e[0])?Buffer.concat(e):[].concat.apply([],e)},Ft=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):bt(e,t)},Bt=function(e){return Buffer.isBuffer(e)||Array.isArray(e)}),"undefined"!=typeof cptable&&(wt=function(e,t,n){return cptable.utils.decode(1200,e.slice(t,n)).replace(ie,"")},At=function(e,t,n){return cptable.utils.decode(65001,e.slice(t,n))},Nt=function(e,t){var n=J(e,t);return 0<n?cptable.utils.decode(C,e.slice(t+4,t+4+n-1)):""},Ot=function(e,t){var n=J(e,t);return 0<n?cptable.utils.decode(g,e.slice(t+4,t+4+n-1)):""},Mt=function(e,t){var n=2*J(e,t);return 0<n?cptable.utils.decode(1200,e.slice(t+4,t+4+n-1)):""},Dt=function(e,t){var n=J(e,t);return 0<n?cptable.utils.decode(1200,e.slice(t+4,t+4+n)):""},Lt=function(e,t){var n=J(e,t);return 0<n?cptable.utils.decode(65001,e.slice(t+4,t+4+n)):""}),function(e,t){return e[t]}),Ut=function(e,t){return 256*e[t+1]+e[t]},Vt=function(e,t){e=256*e[t+1]+e[t];return e<32768?e:-1*(65535-e+1)},J=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Wt=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},$t=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function jt(e,t){var n,r,i,o,s,a,l="",u=[];switch(t){case"dbcs":if(a=this.l,T&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(s=0;s<e;++s)l+=String.fromCharCode(Ut(this,a)),a+=2;e*=2;break;case"utf8":l=At(this,this.l,this.l+e);break;case"utf16le":l=wt(this,this.l,this.l+(e*=2));break;case"wstr":if("undefined"==typeof cptable)return jt.call(this,e,"dbcs");l=cptable.utils.decode(g,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=Nt(this,this.l),e=4+J(this,this.l);break;case"lpstr-cp":l=Ot(this,this.l),e=4+J(this,this.l);break;case"lpwstr":l=Mt(this,this.l),e=4+2*J(this,this.l);break;case"lpp4":e=4+J(this,this.l),l=Dt(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+J(this,this.l),l=Lt(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(i=Ht(this,this.l+e++));)u.push(c(i));l=u.join("");break;case"_wstr":for(e=0,l="";0!==(i=Ut(this,this.l+e));)u.push(c(i)),e+=2;e+=2,l=u.join("");break;case"dbcs-cont":for(l="",a=this.l,s=0;s<e;++s){if(this.lens&&-1!==this.lens.indexOf(a))return i=Ht(this,a),this.l=a+1,o=jt.call(this,e-s,i?"dbcs-cont":"sbcs-cont"),u.join("")+o;u.push(c(Ut(this,a))),a+=2}l=u.join(""),e*=2;break;case"cpstr":if("undefined"!=typeof cptable){l=cptable.utils.decode(g,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",a=this.l,s=0;s!=e;++s){if(this.lens&&-1!==this.lens.indexOf(a))return i=Ht(this,a),this.l=a+1,o=jt.call(this,e-s,i?"dbcs-cont":"sbcs-cont"),u.join("")+o;u.push(c(Ht(this,a))),a+=1}l=u.join("");break;default:switch(e){case 1:return n=Ht(this,this.l),this.l++,n;case 2:return n=("i"===t?Vt:Ut)(this,this.l),this.l+=2,n;case 4:case-4:return"i"===t||0==(128&this[this.l+3])?(n=(0<e?Wt:$t)(this,this.l),this.l+=4,n):(r=J(this,this.l),this.l+=4,r);case 8:case-8:if("f"===t)return r=8==e?Ft(this,this.l):Ft([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:l=Tt(this,this.l,e)}}return this.l+=e,l}function zt(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255}function Gt(e,t,n){e[n]=255&t,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255}function Yt(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255}function Xt(e,t,n){var r=0,i=0;if("dbcs"===n){for(i=0;i!=t.length;++i)Yt(this,t.charCodeAt(i),this.l+2*i);r=2*t.length}else if("sbcs"===n){if("undefined"!=typeof cptable&&874==C)for(i=0;i!=t.length;++i){var o=cptable.utils.encode(C,t.charAt(i));this[this.l+i]=o[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=255&t.charCodeAt(i);r=t.length}else{if("hex"===n){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}if("utf16le"===n){for(var s=Math.min(this.l+e,this.length),i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=255&a,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&t;break;case 2:r=2,this[this.l]=255&t,this[this.l+1]=255&(t>>>=8);break;case 3:r=3,this[this.l]=255&t,this[this.l+1]=255&(t>>>=8),this[this.l+2]=255&(t>>>=8);break;case 4:r=4,zt(this,t,this.l);break;case 8:if(r=8,"f"===n){var l=this,u=t,c=this.l,d=(u<0||1/u==-1/0?1:0)<<7,h=0,f=0,p=d?-u:u;isFinite(p)?0==p?h=f=0:(h=Math.floor(Math.log(p)/Math.LN2),f=p*Math.pow(2,52-h),h<=-1023&&(!isFinite(f)||f<Math.pow(2,52))?h=-1022:(f-=Math.pow(2,52),h+=1023)):(h=2047,f=isNaN(u)?26985:0);for(var g=0;g<=5;++g,f/=256)l[c+g]=255&f;l[c+6]=(15&h)<<4|15&f,l[c+7]=h>>4|d;break}case 16:break;case-4:r=4,Gt(this,t,this.l)}}return this.l+=r,this}function Kt(e,t){var n=Tt(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function fe(e,t){e.l=t,e._R=jt,e.chk=Kt,e._W=Xt}function h(e,t){e.l+=t}function ee(e){e=te(e);return fe(e,0),e}function qt(e,t,n){if(e){fe(e,e.l||0);for(var r=e.length,i=0;e.l<r;){128&(i=e._R(1))&&(i=(127&i)+((127&e._R(1))<<7));for(var o,s=Wu[i]||Wu[65535],a=127&(o=e._R(1)),l=1;l<4&&128&o;++l)a+=(127&(o=e._R(1)))<<7*l;var u=e.l+a,c=(s.f||h)(e,a,n);if(e.l=u,t(c,s.n,i))return}}}function Zt(){function t(e){return fe(e=ee(e),0),e}function n(){o&&(o.length>o.l&&((o=o.slice(0,o.l)).l=o.length),0<o.length&&e.push(o),o=null)}function r(e){return o&&e<o.length-o.l?o:(n(),o=t(Math.max(e+1,i)))}var e=[],i=T?256:2048,o=t(i);return{next:r,push:function(e){n(),null==(o=e).l&&(o.l=o.length),r(i)},end:function(){return n(),Et([e])},_bufs:e}}function x(e,t,n,r){var i,t=+$u[t];if(!isNaN(t)){i=1+(128<=t?1:0)+1,128<=(r=r||Wu[t].p||(n||[]).length||0)&&++i,16384<=r&&++i,2097152<=r&&++i;var o=e.next(i);t<=127?o._W(1,t):(o._W(1,128+(127&t)),o._W(1,t>>7));for(var s=0;4!=s;++s){if(!(128<=r)){o._W(1,r);break}o._W(1,128+(127&r)),r>>=7}0<r&&Bt(n)&&e.push(n)}}function Qt(e,t,n){var r=_e(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;256<=r.c;)r.c-=256;for(;65536<=r.r;)r.r-=65536}return r}function Jt(e,t,n){e=_e(e);return e.s=Qt(e.s,t.s,n),e.e=Qt(e.e,t.s,n),e}function en(e,t){if(e.cRel&&e.c<0)for(e=_e(e);e.c<0;)e.c+=8<t?16384:256;if(e.rRel&&e.r<0)for(e=_e(e);e.r<0;)e.r+=8<t?1048576:5<t?65536:16384;var n=me(e);return e.cRel||null==e.cRel||(n=n.replace(/^([A-Z])/,"$$$1")),n=e.rRel||null==e.rRel?n:n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function tn(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(12<=t.biff?1048575:8<=t.biff?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(12<=t.biff?16383:255)||e.e.cRel?en(e.s,t.biff)+":"+en(e.e,t.biff):(e.s.rRel?"":"$")+pe(e.s.r)+":"+(e.e.rRel?"":"$")+pe(e.e.r):(e.s.cRel?"":"$")+ge(e.s.c)+":"+(e.e.cRel?"":"$")+ge(e.e.c)}var nn,W={},rn="undefined"!=typeof crypto?crypto:void 0;if(void 0!==rn)nn=rn;else if("undefined"!=typeof require)try{nn=void 0}catch(e){nn=null}function on(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function pe(e){return""+(e+1)}function sn(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function ge(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function B(e){for(var t=0,n=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);48<=i&&i<=57?t=10*t+(i-48):65<=i&&i<=90&&(n=26*n+(i-64))}return{c:n-1,r:t-1}}function me(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function an(e){var t=e.indexOf(":");return-1==t?{s:B(e),e:B(e)}:{s:B(e.slice(0,t)),e:B(e.slice(t+1))}}function ye(e,t){return void 0===t||"number"==typeof t?ye(e.s,e.e):(e="string"!=typeof e?me(e):e)==(t="string"!=typeof t?me(t):t)?e:e+":"+t}function ve(e){for(var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,i=0,o=e.length,n=0;r<o&&!((i=e.charCodeAt(r)-64)<1||26<i);++r)n=26*n+i;for(t.s.c=--n,n=0;r<o&&!((i=e.charCodeAt(r)-48)<0||9<i);++r)n=10*n+i;if(t.s.r=--n,r===o||58===e.charCodeAt(++r))t.e.c=t.s.c,t.e.r=t.s.r;else{for(n=0;r!=o&&!((i=e.charCodeAt(r)-64)<1||26<i);++r)n=26*n+i;for(t.e.c=--n,n=0;r!=o&&!((i=e.charCodeAt(r)-48)<0||9<i);++r)n=10*n+i;t.e.r=--n}return t}function ln(e,t){var n="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=le.format(e.z,n?j(t):t)}catch(e){}try{return e.w=le.format((e.XF||{}).numFmtId||(n?14:0),n?j(t):t)}catch(e){return""+t}}function un(e,t,n){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),ln(e,null==t?e.v:t))}function cn(e,t){var t=t&&t.sheet?t.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function dn(e,t,n){var r=n||{},i=e?Array.isArray(e):r.dense,o=(null!=ae&&null==i&&(i=ae),e||(i?[]:{})),s=0,a=0,l=(o&&null!=r.origin&&("number"==typeof r.origin?s=r.origin:(s=(n="string"==typeof r.origin?B(r.origin):r.origin).r,a=n.c),o["!ref"]||(o["!ref"]="A1:A1")),{s:{c:1e7,r:1e7},e:{c:0,r:0}});o["!ref"]&&(e=ve(o["!ref"]),l.s.c=e.s.c,l.s.r=e.s.r,l.e.c=Math.max(l.e.c,e.e.c),l.e.r=Math.max(l.e.r,e.e.r),-1==s)&&(l.e.r=s=e.e.r+1);for(var u=0;u!=t.length;++u)if(t[u]){if(!Array.isArray(t[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var c=0;c!=t[u].length;++c)if(void 0!==t[u][c]){var d={v:t[u][c]},h=s+u,f=a+c;if(l.s.r>h&&(l.s.r=h),l.s.c>f&&(l.s.c=f),l.e.r<h&&(l.e.r=h),l.e.c<f&&(l.e.c=f),!t[u][c]||"object"!=typeof t[u][c]||Array.isArray(t[u][c])||t[u][c]instanceof Date)if(Array.isArray(d.v)&&(d.f=t[u][c][1],d.v=d.v[0]),null===d.v)if(d.f)d.t="n";else{if(!r.sheetStubs)continue;d.t="z"}else"number"==typeof d.v?d.t="n":"boolean"==typeof d.v?d.t="b":d.v instanceof Date?(d.z=r.dateNF||le._table[14],r.cellDates?(d.t="d",d.w=le.format(d.z,j(d.v))):(d.t="n",d.v=j(d.v),d.w=le.format(d.z,d.v))):d.t="s";else d=t[u][c];i?(o[h]||(o[h]=[]),o[h][f]&&o[h][f].z&&(d.z=o[h][f].z),o[h][f]=d):(o[f=me({c:f,r:h})]&&o[f].z&&(d.z=o[f].z),o[f]=d)}}return l.s.c<1e7&&(o["!ref"]=ye(l)),o}function hn(e,t){return dn(null,e,t)}function fn(e,t){return(t=t||ee(4))._W(4,e),t}function pn(e){var t=e._R(4);return 0===t?"":e._R(t,"dbcs")}function gn(e,t){var n=!1;return null==t&&(n=!0,t=ee(4+2*e.length)),t._W(4,e.length),0<e.length&&t._W(0,e,"dbcs"),n?t.slice(0,t.l):t}function mn(e,t){var n,r=e.l,i=e._R(1),o=pn(e),s=[],o={t:o,h:o};if(0!=(1&i)){for(var a=e._R(4),l=0;l!=a;++l)s.push({ich:(n=e)._R(2),ifnt:n._R(2)});o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}W.rc4=function(e,t){for(var n=new Array(256),r=0,i=0,o=0,s=0,i=0;256!=i;++i)n[i]=i;for(i=0;256!=i;++i)o=o+n[i]+e[i%e.length].charCodeAt(0)&255,s=n[i],n[i]=n[o],n[o]=s;i=o=0;for(var a=te(t.length),r=0;r!=t.length;++r)o=(o+n[i=i+1&255])%256,s=n[i],n[i]=n[o],n[o]=s,a[r]=t[r]^n[n[i]+n[o]&255];return a},W.md5=function(e){if(nn)return nn.createHash("md5").update(e).digest("hex");throw new Error("Unsupported crypto")};var yn=mn;function vn(e,t){var n,r=!1;return null==t&&(r=!0,t=ee(23+4*e.t.length)),t._W(1,1),gn(e.t,t),t._W(4,1),e={ich:0,ifnt:0},(n=(n=t)||ee(4))._W(2,e.ich||0),n._W(2,e.ifnt||0),r?t.slice(0,t.l):t}function bn(e){var t=e._R(4),n=e._R(2);return n+=e._R(1)<<16,e.l++,{c:t,iStyleRef:n}}function En(e,t){return(t=null==t?ee(8):t)._W(-4,e.c),t._W(3,e.iStyleRef||e.s),t._W(1,0),t}var Cn=pn,wn=gn;function Sn(e){var t=e._R(4);return 0===t||4294967295===t?"":e._R(t,"dbcs")}function Tn(e,t){var n=!1;return null==t&&(n=!0,t=ee(127)),t._W(4,0<e.length?e.length:4294967295),0<e.length&&t._W(0,e,"dbcs"),n?t.slice(0,t.l):t}var Rn=pn,An=Sn,_n=Tn;function Nn(e){var t=e.slice(e.l,e.l+4),n=1&t[0],r=2&t[0],e=(e.l+=4,t[0]&=252,0==r?Ft([0,0,0,0,t[0],t[1],t[2],t[3]],0):Wt(t,0)>>2);return n?e/100:e}function xn(e){var t={s:{},e:{}};return t.s.r=e._R(4),t.e.r=e._R(4),t.s.c=e._R(4),t.e.c=e._R(4),t}var On=xn,In=function(e,t){return(t=t||ee(16))._W(4,e.s.r),t._W(4,e.e.r),t._W(4,e.s.c),t._W(4,e.e.c),t};function Mn(e){return e._R(8,"f")}function kn(e,t){return(t||ee(8))._W(8,e,"f")}function Dn(e,t){var n;t=t||ee(8),!e||e.auto?(t._W(4,0),t._W(4,0)):(null!=e.index?(t._W(1,2),t._W(1,e.index)):null!=e.theme?(t._W(1,6),t._W(1,e.theme)):(t._W(1,5),t._W(1,0)),0<(n=e.tint||0)?n*=32767:n<0&&(n*=32768),t._W(2,n),e.rgb&&null==e.theme?("number"==typeof(n=e.rgb||"FFFFFF")&&(n=("000000"+n.toString(16)).slice(-6)),t._W(1,parseInt(n.slice(0,2),16)),t._W(1,parseInt(n.slice(2,4),16)),t._W(1,parseInt(n.slice(4,6),16)),t._W(1,255)):(t._W(2,0),t._W(1,0),t._W(1,0)))}function Ln(e,t){var n=e._R(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e._R(4)]||""}if(400<n)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e._R(0,1==t?"lpstr":"lpwstr")}var Pn,Fn=12,Bn=[80,81],Hn={1:{n:"CodePage",t:2},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4096|Fn},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{}},Un={1:{n:"CodePage",t:2},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:3},255:{}},Vn={2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}};for(Pn in Vn)Object.prototype.hasOwnProperty.call(Vn,Pn)&&(Hn[Pn]=Un[Pn]=Vn[Pn]);var Wn=F(Hn,"n"),$n=F(Un,"n"),jn={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},zn=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];var Gn,Yn=_e([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map(function(e){return[e>>16&255,e>>8&255,255&e]})),Xn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Kn=U(Xn),qn={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.sheetMetadata":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"TODO","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"vba","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Zn=(ue(Gn={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}}).forEach(function(t){["xlsm","xlam"].forEach(function(e){Gn[t][e]||(Gn[t][e]=Gn[t].xlsx)})}),ue(Gn).forEach(function(t){ue(Gn[t]).forEach(function(e){qn[Gn[t][e]]=t})}),Gn),Qn=function(e){for(var t=[],n=ue(e),r=0;r!==n.length;++r)null==t[e[n[r]]]&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}(qn);function Jn(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],TODO:[],xmlns:""}}I.CT="http://schemas.openxmlformats.org/package/2006/content-types";var er=N("Types",null,{xmlns:I.CT,"xmlns:xsd":I.xsd,"xmlns:xsi":I.xsi}),tr=[["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels",Qn.rels[0]]].map(function(e){return N("Default",null,{Extension:e[0],ContentType:e[1]})});function nr(n,r){function e(e){n[e]&&0<n[e].length&&(o=n[e][0],s[s.length]=N("Override",null,{PartName:("/"==o[0]?"":"/")+o,ContentType:Zn[e][r.bookType||"xlsx"]}))}function t(t){(n[t]||[]).forEach(function(e){s[s.length]=N("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:Zn[t][r.bookType||"xlsx"]})})}function i(t){(n[t]||[]).forEach(function(e){s[s.length]=N("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:Qn[t][0]})})}var o,s=[];s[s.length]=A,s[s.length]=er,s=s.concat(tr);return e("workbooks"),t("sheets"),t("charts"),i("themes"),["strs","styles"].forEach(e),["coreprops","extprops","custprops"].forEach(i),i("vba"),i("comments"),i("drawings"),2<s.length&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var M={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function rr(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ir(e,r){var i,o={"!id":{}};return e&&("/"!==r.charAt(0)&&(r="/"+r),i={},(e.match(Ue)||[]).forEach(function(e){var t,n,e=se(e);"<Relationship"===e[0]&&((t={}).Type=e.Type,t.Target=e.Target,t.Id=e.Id,t.TargetMode=e.TargetMode,n="External"===e.TargetMode?e.Target:Be(e.Target,r),o[n]=t,i[e.Id]=t)}),o["!id"]=i),o}I.RELS="http://schemas.openxmlformats.org/package/2006/relationships";var or=N("Relationships",null,{xmlns:I.RELS});function sr(t){var n=[A,or];return ue(t["!id"]).forEach(function(e){n[n.length]=N("Relationship",null,t["!id"][e])}),2<n.length&&(n[n.length]="</Relationships>",n[1]=n[1].replace("/>",">")),n.join("")}var ar=[M.HLINK,M.XPATH,M.XMISS];function lr(e,t,n,r,i,o){if(i=i||{},e["!id"]||(e["!id"]={}),t<0)for(t=1;e["!id"]["rId"+t];++t);if(i.Id="rId"+t,i.Type=r,i.Target=n,o?i.TargetMode=o:-1<ar.indexOf(i.Type)&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var ur="application/vnd.oasis.opendocument.spreadsheet";function cr(e,t,n){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}dr='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+s.version+"</meta:generator></office:meta></office:document-meta>";var dr,hr=function(){return dr},fr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],pr=(I.CORE_PROPS="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",M.CORE_PROPS="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",function(){for(var e=new Array(fr.length),t=0;t<fr.length;++t){var n=fr[t],n="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}());function gr(e){var t={};e=he(e);for(var n=0;n<fr.length;++n){var r=fr[n],i=e.match(pr[n]);null!=i&&0<i.length&&(t[r[1]]=ce(i[1])),"date"===r[2]&&t[r[1]]&&(t[r[1]]=oe(t[r[1]]))}return t}var mr=N("cp:coreProperties",null,{"xmlns:cp":I.CORE_PROPS,"xmlns:dc":I.dc,"xmlns:dcterms":I.dcterms,"xmlns:dcmitype":I.dcmitype,"xmlns:xsi":I.xsi});function yr(e,t,n,r,i){null==i[e]&&null!=t&&""!==t&&(t=_(i[e]=t),r[r.length]=n?N(e,t,n):pt(e,t))}var vr=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];I.EXT_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",M.EXT_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties";function br(e,t,n,r){var i=[];if("string"==typeof e)i=ht(e,r);else for(var o=0;o<e.length;++o)i=i.concat(e[o].map(function(e){return{v:e}}));var s,a="string"==typeof t?ht(t,r).map(function(e){return e.v}):t,l=0;if(0<a.length)for(var u=0;u!==i.length;u+=2){switch(s=+i[u+1].v,i[u].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":n.Worksheets=s,n.SheetNames=a.slice(l,l+s);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":n.NamedRanges=s,n.DefinedNames=a.slice(l,l+s);break;case"Charts":case"Diagramme":n.Chartsheets=s,n.ChartNames=a.slice(l,l+s)}l+=s}}var Er=N("Properties",null,{xmlns:I.EXT_PROPS,"xmlns:vt":I.vt});I.CUST_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",M.CUST_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties";var Cr=/<[^>]+>[^<]*/g;var wr=N("Properties",null,{xmlns:I.CUST_PROPS,"xmlns:vt":I.vt});function Sr(t){var n,r=[A,wr];return t&&(n=1,ue(t).forEach(function(e){++n,r[r.length]=N("property",function(e,t){switch(typeof e){case"string":var n=N("vt:lpwstr",_(e));return n=t?n.replace(/&quot;/g,"_x0022_"):n;case"number":return N((0|e)==e?"vt:i4":"vt:r8",_(String(e)));case"boolean":return N("vt:bool",e?"true":"false")}if(e instanceof Date)return N("vt:filetime",mt(e));throw new Error("Unable to serialize "+e)}(t[e],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:_(e)})}),2<r.length)&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Tr={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Rr=H(Tr);function Ar(e){var t=e._R(4),e=e._R(4);return new Date(1e3*(e/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function _r(e,t,n){var r=e.l,i=e._R(0,"lpstr-cp");if(n)for(;e.l-r&3;)++e.l;return i}function Nr(e,t,n){var r=e._R(0,"lpwstr");return n&&(e.l+=4-(r.length+1&3)&3),r}function xr(e,t,n){return 31===t?Nr(e):_r(e,0,n)}function Or(e,t,n){return xr(e,t,!1===n?0:4)}function Ir(e){for(var t=e,n=t._R(4),r=[],i=0;i!=n;++i)r[i]=t._R(0,"lpstr-cp").replace(ie,"");return r}function Mr(e){for(var t,n=e._R(4),r=[],i=0;i!=n/2;++i)r.push([Lr(t=e,81),Lr(t,3)]);return r}function kr(e,t){for(var n=e._R(4),r={},i=0;i!=n;++i){var o=e._R(4),s=e._R(4);r[o]=e._R(s,1200===t?"utf16le":"utf8").replace(ie,"").replace(Se,"!"),1200===t&&s%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),r}function Dr(e){var t=e._R(4),n=e.slice(e.l,e.l+t);return e.l+=t,0<(3&t)&&(e.l+=4-(3&t)&3),n}function Lr(e,t,n){var r,i,o=e._R(2),s=n||{};if(e.l+=2,t!==Fn&&o!==t&&-1===Bn.indexOf(t))throw new Error("Expected type "+t+" saw "+o);switch(t===Fn?o:t){case 2:return i=e._R(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e._R(4,"i");case 11:return 0!==e._R(4);case 19:return i=e._R(4);case 30:return _r(e,0,4).replace(ie,"");case 31:return Nr(e);case 64:return Ar(e);case 65:return Dr(e);case 71:return(i={}).Size=(r=e)._R(4),r.l+=i.Size+3-(i.Size-1)%4,i;case 80:return Or(e,o,!s.raw).replace(ie,"");case 81:return function(e,t){if(t)return xr(e,t,0);throw new Error("VtUnalignedString must have positive length")}(e,o).replace(ie,"");case 4108:return Mr(e);case 4126:return Ir(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+o)}}function Pr(e,t){var n,r,i,o=ee(4),s=ee(4);switch(o._W(4,80==e?31:e),e){case 3:s._W(-4,t);break;case 5:(s=ee(8))._W(8,t,"f");break;case 11:s._W(4,t?1:0);break;case 64:r=(n=("string"==typeof(n=t)?new Date(Date.parse(n)):n).getTime()/1e3+11644473600)%Math.pow(2,32),n=(n-r)/Math.pow(2,32),n*=1e7,0<(i=(r*=1e7)/Math.pow(2,32)|0)&&(r%=Math.pow(2,32),n+=i),(i=ee(8))._W(4,r),i._W(4,n),s=i;break;case 31:case 80:for((s=ee(4+2*(t.length+1)+(t.length%2?0:2)))._W(4,t.length+1),s._W(0,t,"dbcs");s.l!=s.length;)s._W(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return we([o,s])}function Fr(e,t){for(var n=e.l,r=e._R(4),i=e._R(4),o=[],s=0,a=0,l=-1,u={},s=0;s!=i;++s){var c=e._R(4),d=e._R(4);o[s]=[c,d+n]}o.sort(function(e,t){return e[1]-t[1]});var h={};for(s=0;s!=i;++s){if(e.l!==o[s][1]){var f=!0;if(0<s&&t)switch(t[o[s-1][0]].t){case 2:e.l+2===o[s][1]&&(e.l+=2,f=!1);break;case 80:case 4108:e.l<=o[s][1]&&(e.l=o[s][1],f=!1)}if((!t||0==s)&&e.l<=o[s][1]&&(f=!1,e.l=o[s][1]),f)throw new Error("Read Error: Expected address "+o[s][1]+" at "+e.l+" :"+s)}if(t){var p=t[o[s][0]];if(h[p.n]=Lr(e,p.t,{raw:!0}),"version"===p.p&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(65535&h[p.n])).slice(-4)),"CodePage"==p.n)switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:be(a=h[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[p.n])}}else if(1===o[s][0]){a=h.CodePage=Lr(e,2);be(a),-1!==l&&(m=e.l,e.l=o[l][1],u=kr(e,a),e.l=m)}else if(0===o[s][0])0===a?(l=s,e.l=o[s+1][1]):u=kr(e,a);else{var g,m=u[o[s][0]];switch(e[e.l]){case 65:e.l+=4,g=Dr(e);break;case 30:case 31:e.l+=4,g=Or(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e._R(4,"i");break;case 19:e.l+=4,g=e._R(4);break;case 5:e.l+=4,g=e._R(8,"f");break;case 11:e.l+=4,g=y(e,4);break;case 64:e.l+=4,g=oe(Ar(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[m]=g}}return e.l=n+r,h}var Br=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"].concat(["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"]);function Hr(e,t,n){var r,i,o,s,a=ee(8),l=[],u=[],c=8,d=0,h=ee(8),f=ee(8);if(h._W(4,2),h._W(4,1200),f._W(4,1),u.push(h),l.push(f),c+=8+h.length,!t){(f=ee(8))._W(4,0),l.unshift(f);var p=[ee(4)];for(p[0]._W(4,e.length),d=0;d<e.length;++d){var g=e[d][0];for((h=ee(8+2*(g.length+1)+(g.length%2?0:2)))._W(4,d+2),h._W(4,g.length+1),h._W(0,g,"dbcs");h.l!=h.length;)h._W(1,0);p.push(h)}h=we(p),u.unshift(h),c+=8+h.length}for(d=0;d<e.length;++d)t&&!t[e[d][0]]||-1<Br.indexOf(e[d][0])||null!=e[d][1]&&(o=e[d][1],r=0,h=t?("version"==(i=n[r=+t[e[d][0]]]).p&&"string"==typeof o&&(o=(+(s=o.split("."))[0]<<16)+(+s[1]||0)),Pr(i.t,o)):(-1==(s=function(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}(o))&&(s=31,o=String(o)),Pr(s,o)),u.push(h),(f=ee(8))._W(4,t?r:2+d),l.push(f),c+=8+h.length);for(var m=8*(u.length+1),d=0;d<u.length;++d)l[d]._W(4,m),m+=u[d].length;return a._W(4,c),a._W(4,u.length),we([a].concat(l).concat(u))}function Ur(e,t,n){e=e.content;if(!e)return{};fe(e,0);var r,i,o=0,s=(e.chk("feff","Byte Order: "),e._R(2),e._R(4)),a=e._R(16);if(a!==Q.utils.consts.HEADER_CLSID&&a!==n)throw new Error("Bad PropertySet CLSID "+a);if(1!==(n=e._R(4))&&2!==n)throw new Error("Unrecognized #Sets: "+n);if(a=e._R(16),i=e._R(4),1===n&&i!==e.l)throw new Error("Length mismatch: "+i+" !== "+e.l);2===n&&(r=e._R(16),o=e._R(4));var l,u,c=Fr(e,t),d={SystemIdentifier:s};for(l in c)d[l]=c[l];if(d.FMTID=a,1!==n){if(o-e.l==2&&(e.l+=2),e.l!==o)throw new Error("Length mismatch 2: "+e.l+" !== "+o);try{u=Fr(e,null)}catch(e){}for(l in u)d[l]=u[l];d.FMTID=[a,r]}return d}function Vr(e,t,n,r,i,o){var s=ee(i?68:48),a=[s],t=(s._W(2,65534),s._W(2,0),s._W(4,842412599),s._W(16,Q.utils.consts.HEADER_CLSID,"hex"),s._W(4,i?2:1),s._W(16,t,"hex"),s._W(4,i?68:48),Hr(e,n,r));return a.push(t),i&&(e=Hr(i,null,null),s._W(16,o,"hex"),s._W(4,68+t.length),a.push(e)),we(a)}function Wr(e,t){return e._R(t),null}function y(e,t){return 1===e._R(t)}function $r(e,t){return(t=t||ee(2))._W(2,+!!e),t}function d(e){return e._R(2,"u")}function jr(e,t){return(t=t||ee(2))._W(2,e),t}function zr(e,t){for(var n=e,e=t,r=d,i=[],o=n.l+e;n.l<o;)i.push(r(n,o-n.l));if(o!==n.l)throw new Error("Slurp error");return i}function Gr(e,t,n){var r=e._R(n&&12<=n.biff?2:1),i="sbcs-cont",o=g,n=(n&&8<=n.biff&&(g=1200),n&&8!=n.biff?12==n.biff&&(i="wstr"):e._R(1)&&(i="dbcs-cont"),2<=n.biff&&n.biff<=5&&(i="cpstr"),r?e._R(r,i):"");return g=o,n}function Yr(e,t,n){if(n){if(2<=n.biff&&n.biff<=5)return e._R(t,"cpstr");if(12<=n.biff)return e._R(t,"dbcs-cont")}return 0===e._R(1)?e._R(t,"sbcs-cont"):e._R(t,"dbcs-cont")}function Xr(e,t,n){var r=e._R(n&&2==n.biff?1:2);return 0===r?(e.l++,""):Yr(e,r,n)}function Kr(e,t,n){var r;return 5<n.biff?Xr(e,0,n):0===(r=e._R(1))?(e.l++,""):e._R(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function qr(e,t,n){return(n=n||ee(3+2*e.length))._W(2,e.length),n._W(1,1),n._W(31,e,"utf16le"),n}function Zr(e){var t,n,r=e._R(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return i=(t=e)._R(4),n=t.l,o=!1,24<i&&(t.l+=i-24,"795881f43b1d7f48af2c825dc4852763"===t._R(16)&&(o=!0),t.l=n),n=t._R((o?i-24:i)>>1,"utf16le").replace(ie,""),o&&(t.l+=24),n;case"0303000000000000c000000000000046":var i=e,o=(i.l+=2,i._R(0,"lpstr-ansi"));if(i.l+=2,57005!=i._R(2))throw new Error("Bad FileMoniker");if(0===i._R(4))return o.replace(/\\/g,"/");if(o=i._R(4),3!=i._R(2))throw new Error("Bad FileMoniker");return i._R(o>>1,"utf16le").replace(ie,"");default:throw new Error("Unsupported Moniker "+r)}}function Qr(e){var t=e._R(4);return 0<t?e._R(t,"utf16le").replace(ie,""):""}function Jr(e){return[e._R(1),e._R(1),e._R(1),e._R(1)]}function ei(e){e=Jr(e);return e[3]=0,e}function ti(e){return{r:e._R(2),c:e._R(2),ixfe:e._R(2)}}function ni(e,t,n,r){return(r=r||ee(6))._W(2,e),r._W(2,t),r._W(2,n||0),r}function ri(e){return[e._R(2),Nn(e)]}function ii(e){var t=e._R(2),n=e._R(2);return{s:{c:e._R(2),r:t},e:{c:e._R(2),r:n}}}function oi(e,t){(t=t||ee(8))._W(2,e.s.r),t._W(2,e.e.r),t._W(2,e.s.c),t._W(2,e.e.c)}function si(e){var t=e._R(2),n=e._R(2);return{s:{c:e._R(1),r:t},e:{c:e._R(1),r:n}}}var ai=si;function li(e){e.l+=4;var t=e._R(2),n=e._R(2),r=e._R(2);return e.l+=12,[n,t,r]}function ui(e){e.l+=2,e.l+=e._R(2)}var ci={0:ui,4:ui,5:ui,6:ui,7:function(e){return e.l+=4,e.cf=e._R(2),{}},8:ui,9:ui,10:ui,11:ui,12:ui,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e._R(2),e.l+=4,t},14:ui,15:ui,16:ui,17:ui,18:ui,19:ui,20:ui,21:li};function di(e,t){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e._R(2),2<=(t-=2)&&(n.dt=e._R(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(6<t)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e._R(t),n}function hi(e,t,n){var r=1536,i=16;switch(n.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}n=ee(i);return n._W(2,r),n._W(2,t),4<i&&n._W(2,29282),6<i&&n._W(2,1997),8<i&&(n._W(2,49161),n._W(2,1),n._W(2,1798),n._W(2,0)),n}function fi(e){for(var t,n,r,i=ee(8),o=(i._W(4,e.Count),i._W(4,e.Unique),[]),s=0;s<e.length;++s)o[s]=(t=e[s],r=n=void 0,t=t.t||"",(n=ee(3))._W(2,t.length),n._W(1,1),(r=ee(2*t.length))._W(2*t.length,t,"utf16le"),we([n,r]));var a=we([i].concat(o));return a.parts=[i.length].concat(o.map(function(e){return e.length})),a}function pi(e,t,n){var r=0,e=(n&&2==n.biff||(r=e._R(2)),e._R(2));return n&&2==n.biff&&(r=1-(e>>15),e&=32767),[{Unsynced:1&r,DyZero:(2&r)>>1,ExAsc:(4&r)>>2,ExDsc:(8&r)>>3},e]}W=Kr;function gi(e,t,n){var t=e.l+t,n=8!=n.biff&&n.biff?2:4,r=e._R(n),n=e._R(n),i=e._R(2),o=e._R(2);return e.l=t,{s:{r:r,c:i},e:{r:n,c:o}}}function mi(e,t,n,r){n=n&&5==n.biff;return(r=r||ee(n?16:20))._W(2,0),e.style?(r._W(2,e.numFmtId||0),r._W(2,65524)):(r._W(2,e.numFmtId||0),r._W(2,t<<4)),r._W(4,0),r._W(4,0),n||r._W(4,0),r._W(2,0),r}function yi(e,t,n){var r=ti(e),n=(2==n.biff&&++e.l,e=(n=e)._R(1),1===n._R(1)?e:1===e);return r.val=n,r.t=!0===n||!1===n?"b":"e",r}function vi(e,t,n,r,i,o){var s=ee(8);return ni(e,t,r,s),e=n,t=o,(r=(r=s)||ee(2))._W(1,+e),r._W(1,"e"==t?1:0),s}function bi(e,t,n){return 0===t?"":Kr(e,0,n)}function Ei(e,t,n){var r,i=e._R(2),i={fBuiltIn:1&i,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return 14849===n.sbcch&&(r=function(e,t,n){e.l+=4;var t=e.l+(t-=4),n=Gr(e,0,n),r=e._R(2);if(r!==(t-=e.l))throw new Error("Malformed AddinUdf: padding = "+t+" != "+r);return e.l+=r,n}(e,t-2,n)),i.body=r||e._R(t-2),"string"==typeof r&&(i.Name=r),i}var Ci=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function wi(e,t,n){var t=e.l+t,r=e._R(2),i=e._R(1),o=e._R(1),s=e._R(n&&2==n.biff?1:2),a=0,o=((!n||5<=n.biff)&&(5!=n.biff&&(e.l+=2),a=e._R(2),5==n.biff&&(e.l+=2),e.l+=4),Yr(e,o,n)),r=(32&r&&(o=Ci[o.charCodeAt(0)]),t-e.l);return n&&2==n.biff&&--r,{chKey:i,Name:o,itab:a,rgce:t==e.l||0===s?[]:function(e,t,n,r){var i,t=e.l+t,r=Ha(e,r,n);t!==e.l&&(i=Ba(e,t-e.l,r,n));return[r,i]}(e,r,n,s)}}function Si(e,t,n){var r;if(n.biff<8)return a=n,3==(r=e)[r.l+1]&&r[r.l]++,3==(r=Gr(r,0,a)).charCodeAt(0)?r.slice(1):r;for(var i,o,s=[],a=e.l+t,l=e._R(8<n.biff?4:2);0!=l--;)s.push((i=e,n.biff,o=8<(o=n).biff?4:2,[i._R(o),i._R(o,"i"),i._R(o,"i")]));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return s}function Ti(e,t,n){var r=ai(e,6);switch(n.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,function(e,t,n){var r,i=e.l+t,o=2==n.biff?1:2,s=e._R(o);if(65535==s)return[[],h(e,t-2)];var a=Ha(e,s,n);t!==s+o&&(r=Ba(e,t-s-o,a,n));return e.l=i,[a,r]}(e,t,n)]}var Ri=[];function Ai(e){for(var t=ee(24),n=B(e[0]),r=(t._W(2,n.r),t._W(2,n.r),t._W(2,n.c),t._W(2,n.c),"d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" ")),i=0;i<16;++i)t._W(1,parseInt(r[i],16));return we([t,function(e){var t=ee(512),n=0,r=e.Target,i=-1<r.indexOf("#")?31:23;switch(r.charAt(0)){case"#":i=28;break;case".":i&=-3}t._W(4,2),t._W(4,i);for(var o=[8,6815827,6619237,4849780,83],n=0;n<o.length;++n)t._W(4,o[n]);if(28==i){for(r=r.slice(1),t._W(4,r.length+1),n=0;n<r.length;++n)t._W(2,r.charCodeAt(n));t._W(2,0)}else if(2&i){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<o.length;++n)t._W(1,parseInt(o[n],16));for(t._W(4,2*(r.length+1)),n=0;n<r.length;++n)t._W(2,r.charCodeAt(n));t._W(2,0)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<o.length;++n)t._W(1,parseInt(o[n],16));for(var s=0;"../"==r.slice(3*s,3*s+3)||"..\\"==r.slice(3*s,3*s+3);)++s;for(t._W(2,s),t._W(4,r.length+1),n=0;n<r.length;++n)t._W(1,255&r.charCodeAt(n));for(t._W(1,0),t._W(2,65535),t._W(2,57005),n=0;n<6;++n)t._W(4,0)}return t.slice(0,t.l)}(e[1])])}function _i(e,t,n){var r,i,o,s,a,l;return n.cellStyles?(l=n&&12<=n.biff?4:2,r=e._R(l),i=e._R(l),o=e._R(l),s=e._R(l),a=e._R(2),2==l&&(e.l+=2),l={s:r,e:i,w:o,ixfe:s,flags:a},(5<=n.biff||!n.biff)&&(l.level=a>>8&7),l):h(e,t)}Ri[8]=function(e,t){var t=e.l+t,n=(e.l+=10,e._R(2)),r=(e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4,e._R(1));return e.l+=r,e.l=t,{fmt:n}};var Ni=ti,xi=zr,Oi=Xr;Ii={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,255:16969},Mi=H({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127}),ki={B:8,C:250,L:1,D:8,"?":0,"":0};var Ii,Mi,ki,Di={versions:[2,3,48,49,131,139,140,245],to_workbook:function(e,t){try{return cn(Li(e,t),t)}catch(e){if(t&&t.WTF)throw e}return{SheetNames:[],Sheets:{}}},to_sheet:Li,from_sheet:function(e,t){if(0<=+(t=t||{}).codepage&&be(+t.codepage),"string"==t.type)throw new Error("Cannot write DBF to JS string");for(var n=Zt(),r=(t=td(e,{header:1,raw:!0,cellDates:!0}))[0],i=t.slice(1),o=0,s=0,a=0,l=1,o=0;o<r.length;++o)if(null!=o){if(++a,"number"==typeof r[o]&&(r[o]=r[o].toString(10)),"string"!=typeof r[o])throw new Error("DBF Invalid column name "+r[o]+" |"+typeof r[o]+"|");if(r.indexOf(r[o])!==o)for(s=0;s<1024;++s)if(-1==r.indexOf(r[o]+"_"+s)){r[o]+="_"+s;break}}var u=ve(e["!ref"]),c=[];for(o=0;o<=u.e.c-u.s.c;++o){var d=[];for(s=0;s<i.length;++s)null!=i[s][o]&&d.push(i[s][o]);if(0==d.length||null==r[o])c[o]="?";else{for(var h="",f="",s=0;s<d.length;++s){switch(typeof d[s]){case"number":f="B";break;case"string":f="C";break;case"boolean":f="L";break;case"object":f=d[s]instanceof Date?"D":"C";break;default:f="C"}if("C"==(h=h&&h!=f?"C":f))break}l+=ki[h]||0,c[o]=h}}var p,g,m=n.next(32);for(m._W(4,318902576),m._W(4,i.length),m._W(2,296+32*a),m._W(2,l),o=0;o<4;++o)m._W(4,0);for(m._W(4,0|(+Mi[C]||3)<<8),s=o=0;o<r.length;++o)null!=r[o]&&(p=n.next(32),g=(r[o].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11),p._W(1,g,"sbcs"),p._W(1,"?"==c[o]?"C":c[o],"sbcs"),p._W(4,s),p._W(1,ki[c[o]]||0),p._W(1,0),p._W(1,2),p._W(4,0),p._W(1,0),p._W(4,0),p._W(4,0),s+=ki[c[o]]||0);var y=n.next(264);for(y._W(4,13),o=0;o<65;++o)y._W(4,0);for(o=0;o<i.length;++o){var v=n.next(l);for(v._W(1,0),s=0;s<r.length;++s)if(null!=r[s])switch(c[s]){case"L":v._W(1,null==i[o][s]?63:i[o][s]?84:70);break;case"B":v._W(8,i[o][s]||0,"f");break;case"D":i[o][s]?(v._W(4,("0000"+i[o][s].getFullYear()).slice(-4),"sbcs"),v._W(2,("00"+(i[o][s].getMonth()+1)).slice(-2),"sbcs"),v._W(2,("00"+i[o][s].getDate()).slice(-2),"sbcs")):v._W(8,"00000000","sbcs");break;case"C":var b=String(i[o][s]||"");for(v._W(1,b,"sbcs"),a=0;a<250-b.length;++a)v._W(1,32)}}return n.next(1)._W(1,26),n.end()}};function Li(e,t){t=t||{};return t.dateNF||(t.dateNF="yyyymmdd"),hn(function(e,t){var n=[],r=te(1);switch(t.type){case"base64":r=re(S.decode(e));break;case"binary":r=re(e);break;case"buffer":case"array":r=e}fe(r,0);var i=r._R(1),o=!1,s=!1,a=!1;switch(i){case 2:case 3:break;case 48:o=s=!0;break;case 49:s=!0;break;case 131:case 139:o=!0;break;case 140:a=o=!0;break;case 245:o=!0;break;default:throw new Error("DBF Unsupported Version: "+i.toString(16))}for(var l=0,u=0,c=(2==i&&(l=r._R(2)),r.l+=3,2!=i&&(l=r._R(4)),2!=i&&(u=r._R(2)),r._R(2)),d=1252,h=(2!=i&&(r.l+=16,r._R(1),0!==r[r.l]&&(d=Ii[r[r.l]]),r.l+=1,r.l+=2),a&&(r.l+=36),[]),f={},p=u-10-(s?264:0),g=a?32:11;2==i?r.l<r.length&&13!=r[r.l]:r.l<p;)switch((f={}).name=cptable.utils.decode(d,r.slice(r.l,r.l+g)).replace(/[\u0000\r\n].*$/g,""),r.l+=g,f.type=String.fromCharCode(r._R(1)),2==i||a||(f.offset=r._R(4)),f.len=r._R(1),2==i&&(f.offset=r._R(2)),f.dec=r._R(1),f.name.length&&h.push(f),2!=i&&(r.l+=a?13:14),f.type){case"B":s&&8==f.len||!t.WTF||console.log("Skipping "+f.name+":"+f.type);break;case"G":case"P":t.WTF&&console.log("Skipping "+f.name+":"+f.type);break;case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":case"0":case"@":case"+":break;default:throw new Error("Unknown Field Type: "+f.type)}if(13!==r[r.l]?r.l=u-1:2==i&&(r.l=521),2!=i){if(13!==r._R(1))throw new Error("DBF Terminator not found "+r.l+" "+r[r.l]);r.l=u}var m=0,y=0;for(n[0]=[],y=0;y!=h.length;++y)n[0][y]=h[y].name;for(;0<l--;)if(42===r[r.l])r.l+=c;else for(++r.l,n[++m]=[],y=y=0;y!=h.length;++y){var v=r.slice(r.l,r.l+h[y].len),b=(r.l+=h[y].len,fe(v,0),cptable.utils.decode(d,v));switch(h[y].type){case"C":n[m][y]=cptable.utils.decode(d,v),n[m][y]=n[m][y].trim();break;case"D":8===b.length?n[m][y]=new Date(+b.slice(0,4),+b.slice(4,6)-1,+b.slice(6,8)):n[m][y]=b;break;case"F":n[m][y]=parseFloat(b.trim());break;case"+":case"I":n[m][y]=a?2147483648^v._R(-4,"i"):v._R(4,"i");break;case"L":switch(b.toUpperCase()){case"Y":case"T":n[m][y]=!0;break;case"N":case"F":n[m][y]=!1;break;case" ":case"?":n[m][y]=!1;break;default:throw new Error("DBF Unrecognized L:|"+b+"|")}break;case"M":if(!o)throw new Error("DBF Unexpected MEMO for type "+i.toString(16));n[m][y]="##MEMO##"+(a?parseInt(b.trim(),10):v._R(4));break;case"N":n[m][y]=+b.replace(/\u0000/g,"").trim();break;case"@":n[m][y]=new Date(v._R(-8,"f")-621356832e5);break;case"T":n[m][y]=new Date(864e5*(v._R(4)-2440588)+v._R(4));break;case"Y":n[m][y]=v._R(4,"i")/1e4;break;case"O":n[m][y]=-v._R(-8,"f");break;case"B":if(s&&8==h[y].len){n[m][y]=v._R(8,"f");break}case"G":case"P":v.l+=h[y].len;break;case"0":if("_NullFlags"===h[y].name)break;default:throw new Error("DBF Unsupported data type "+h[y].type)}}if(2!=i&&r.l<r.length&&26!=r[r.l++])throw new Error("DBF EOF Marker missing "+(r.l-1)+" of "+r.length+" "+r[r.l-1].toString(16));return n=t&&t.sheetRows?n.slice(0,t.sheetRows):n}(e,t),t)}Pi={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,B:180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},Fi=new RegExp("N("+ue(Pi).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),Bi=function(e,t){t=Pi[t];return"number"==typeof t?r(t):t},Hi=function(e,t,n){t=t.charCodeAt(0)-32<<4|n.charCodeAt(0)-48;return 59==t?e:r(t)},Pi["|"]=254;var Pi,Fi,Bi,Hi,Ui={to_workbook:function(e,t){return cn(Wi(e,t),t)},to_sheet:Wi,from_sheet:function(e,t){var n,r,i=["ID;PWXL;N;E"],o=[],s=ve(e["!ref"]),a=Array.isArray(e),l="\r\n";i.push("P;PGeneral"),i.push("F;P0;DG0G8;M255"),e["!cols"]&&(n=i,e["!cols"].forEach(function(e,t){t="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?t+="0":("number"==typeof e.width&&(e.wpx=us(e.width)),"number"==typeof e.wpx&&(e.wch=cs(e.wpx)),"number"==typeof e.wch&&(t+=Math.round(e.wch)))," "!=t.charAt(t.length-1)&&n.push(t)})),e["!rows"]&&(r=i,e["!rows"].forEach(function(e,t){var n="F;";e.hidden?n+="M0;":e.hpt?n+="M"+20*e.hpt+";":e.hpx&&(n+="M"+20*ms(e.hpx)+";"),2<n.length&&r.push(n+"R"+(t+1))})),i.push("B;Y"+(s.e.r-s.s.r+1)+";X"+(s.e.c-s.s.c+1)+";D"+[s.s.c,s.s.r,s.e.c,s.e.r].join(" "));for(var u=s.s.r;u<=s.e.r;++u)for(var c=s.s.c;c<=s.e.c;++c){var d=me({r:u,c:c});(d=a?(e[u]||[])[c]:e[d])&&(null!=d.v||d.f&&!d.F)&&o.push(function(e,t,n){var r="C;Y"+(t+1)+";X"+(n+1)+";K";switch(e.t){case"n":r+=e.v||0,e.f&&!e.F&&(r+=";E"+da(e.f,{r:t,c:n}));break;case"b":r+=e.v?"TRUE":"FALSE";break;case"e":r+=e.w||e.v;break;case"d":r+='"'+(e.w||e.v)+'"';break;case"s":r+='"'+e.v.replace(/"/g,"")+'"'}return r}(d,u,c))}return i.join(l)+l+o.join(l)+l+"E"+l}};function Vi(e,t){var n,r,i=e.split(/[\n\r]+/),o=-1,s=-1,a=0,l=0,u=[],c=[],d=null,e={},h=[],f=[],p=0;for(0<=+t.codepage&&be(+t.codepage);a!==i.length;++a){var g,p=0,m=i[a].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,Hi).replace(Fi,Bi),y=m.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),v=y[0];if(0<m.length)switch(v){case"ID":case"E":case"B":case"O":break;case"P":"P"==y[1].charAt(0)&&c.push(m.slice(3).replace(/;;/g,";"));break;case"C":for(var b=!1,E=!1,l=1;l<y.length;++l)switch(y[l].charAt(0)){case"X":s=parseInt(y[l].slice(1))-1,E=!0;break;case"Y":for(o=parseInt(y[l].slice(1))-1,E||(s=0),r=u.length;r<=o;++r)u[r]=[];break;case"K":'"'===(g=y[l].slice(1)).charAt(0)?g=g.slice(1,g.length-1):"TRUE"===g?g=!0:"FALSE"===g?g=!1:isNaN(Ne(g))?isNaN(xe(g).getDate())||(g=oe(g)):(g=Ne(g),null!==d&&le.is_date(d)&&(g=Y(g))),"undefined"!=typeof cptable&&"string"==typeof g&&"string"!=(t||{}).type&&(t||{}).codepage&&(g=cptable.utils.decode(t.codepage,g)),b=!0;break;case"E":var C=la(y[l].slice(1),{r:o,c:s});u[o][s]=[u[o][s],C];break;default:if(t&&t.WTF)throw new Error("SYLK bad record "+m)}b&&(u[o][s]=g,d=null);break;case"F":var w=0;for(l=1;l<y.length;++l)switch(y[l].charAt(0)){case"X":s=parseInt(y[l].slice(1))-1,++w;break;case"Y":for(o=parseInt(y[l].slice(1))-1,r=u.length;r<=o;++r)u[r]=[];break;case"M":p=parseInt(y[l].slice(1))/20;break;case"F":case"G":break;case"P":d=c[parseInt(y[l].slice(1))];break;case"S":case"D":case"N":break;case"W":for(n=y[l].slice(1).split(" "),r=parseInt(n[0],10);r<=parseInt(n[1],10);++r)p=parseInt(n[2],10),f[r-1]=0===p?{hidden:!0}:{wch:p},ps(f[r-1]);break;case"C":f[s=parseInt(y[l].slice(1))-1]||(f[s]={});break;case"R":h[o=parseInt(y[l].slice(1))-1]||(h[o]={}),0<p?(h[o].hpt=p,h[o].hpx=ys(p)):0===p&&(h[o].hidden=!0);break;default:if(t&&t.WTF)throw new Error("SYLK bad record "+m)}w<1&&(d=null);break;default:if(t&&t.WTF)throw new Error("SYLK bad record "+m)}}return 0<h.length&&(e["!rows"]=h),0<f.length&&(e["!cols"]=f),[u=t&&t.sheetRows?u.slice(0,t.sheetRows):u,e]}function Wi(e,t){var e=function(e,t){switch(t.type){case"base64":return Vi(S.decode(e),t);case"binary":return Vi(e,t);case"buffer":return Vi(e.toString("binary"),t);case"array":return Vi(q(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),n=e[0],r=e[1],i=hn(n,t);return ue(r).forEach(function(e){i[e]=r[e]}),i}var $i={to_workbook:function(e,t){return cn(zi(e,t),t)},to_sheet:zi,from_sheet:function(e){var t=[],n=ve(e["!ref"]),r=Array.isArray(e);Gi(t,"TABLE",0,1,"sheetjs"),Gi(t,"VECTORS",0,n.e.r-n.s.r+1,""),Gi(t,"TUPLES",0,n.e.c-n.s.c+1,""),Gi(t,"DATA",0,0,"");for(var i=n.s.r;i<=n.e.r;++i){Yi(t,-1,0,"BOT");for(var o=n.s.c;o<=n.e.c;++o){var s,a=me({r:i,c:o});if(s=r?(e[i]||[])[o]:e[a])switch(s.t){case"n":var l=s.w;null==(l=l||null==s.v?l:s.v)?s.f&&!s.F?Yi(t,1,0,"="+s.f):Yi(t,1,0,""):Yi(t,0,l,"V");break;case"b":Yi(t,0,s.v?1:0,s.v?"TRUE":"FALSE");break;case"s":Yi(t,1,0,isNaN(s.v)?s.v:'="'+s.v+'"');break;case"d":s.w||(s.w=le.format(s.z||le._table[14],j(oe(s.v)))),Yi(t,0,s.w,"V");break;default:Yi(t,1,0,"")}else Yi(t,1,0,"")}}Yi(t,-1,0,"EOD");return t.join("\r\n")}};function ji(e,t){for(var n=e.split("\n"),r=-1,i=-1,o=0,s=[];o!==n.length;++o)if("BOT"===n[o].trim())s[++r]=[],i=0;else if(!(r<0)){var a=n[o].trim().split(","),l=a[0],u=a[1],c=n[++o].trim();switch(+l){case-1:if("BOT"===c){s[++r]=[],i=0;continue}if("EOD"!==c)throw new Error("Unrecognized DIF special command "+c);break;case 0:"TRUE"===c?s[r][i]=!0:"FALSE"===c?s[r][i]=!1:isNaN(Ne(u))?isNaN(xe(u).getDate())?s[r][i]=u:s[r][i]=oe(u):s[r][i]=Ne(u),++i;break;case 1:c=c.slice(1,c.length-1),s[r][i++]=""!==c?c:null}if("EOD"===c)break}return s=t&&t.sheetRows?s.slice(0,t.sheetRows):s}function zi(e,t){return hn(function(e,t){switch(t.type){case"base64":return ji(S.decode(e),t);case"binary":return ji(e,t);case"buffer":return ji(e.toString("binary"),t);case"array":return ji(q(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),t)}function Gi(e,t,n,r,i){e.push(t),e.push(n+","+r),e.push('"'+i.replace(/"/g,'""')+'"')}function Yi(e,t,n,r){e.push(t+","+n),e.push(1==t?'"'+r.replace(/"/g,'""')+'"':r)}Xi=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),Ki=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",qi=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),Zi="--SocialCalcSpreadsheetControlSave--";var Xi,Ki,qi,Zi,Qi={to_workbook:function(e,t){return cn(eo(e,t),t)},to_sheet:eo,from_sheet:function(e){return[Xi,Ki,qi,Ki,function(e){if(!e||!e["!ref"])return"";for(var t,n,r=[],i=[],o=an(e["!ref"]),s=Array.isArray(e),a=o.s.r;a<=o.e.r;++a)for(var l=o.s.c;l<=o.e.c;++l)if(n=me({r:a,c:l}),(t=s?(e[a]||[])[l]:e[n])&&null!=t.v&&"z"!==t.t){switch(i=["cell",n,"t"],t.t){case"s":case"str":i.push(Ji(t.v));break;case"n":t.f?(i[2]="vtf",i[3]="n",i[4]=t.v,i[5]=Ji(t.f)):(i[2]="v",i[3]=t.v);break;case"b":i[2]="vt"+(t.f?"f":"c"),i[3]="nl",i[4]=t.v?"1":"0",i[5]=Ji(t.f||(t.v?"TRUE":"FALSE"));break;case"d":var u=j(oe(t.v));i[2]="vtc",i[3]="nd",i[4]=""+u,i[5]=t.w||le.format(t.z||le._table[14],u);break;case"e":continue}r.push(i.join(":"))}return r.push("sheet:c:"+(o.e.c-o.s.c+1)+":r:"+(o.e.r-o.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}(e),Zi].join("\n")}};function Ji(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function eo(e,t){return hn(function(e,t){for(var n,r=e.split("\n"),i=-1,o=0,s=[];o!==r.length;++o){var a=r[o].trim().split(":");if("cell"===a[0]){var l=B(a[1]);if(s.length<=l.r)for(i=s.length;i<=l.r;++i)s[i]||(s[i]=[]);switch(i=l.r,n=l.c,a[2]){case"t":s[i][n]=a[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":s[i][n]=+a[3];break;case"vtf":var u=a[a.length-1];case"vtc":"nl"===a[3]?s[i][n]=!!+a[4]:s[i][n]=+a[4],"vtf"==a[2]&&(s[i][n]=[s[i][n],u])}}}return s=t&&t.sheetRows?s.slice(0,t.sheetRows):s}(e,t),t)}to={44:",",9:"\t",59:";"},no={44:3,9:2,59:1};var to,no,ro={to_workbook:function(e,t){return cn(ao(e,t),t)},to_sheet:ao,from_sheet:function(e){for(var t=[],n=ve(e["!ref"]),r=Array.isArray(e),i=n.s.r;i<=n.e.r;++i){for(var o=[],s=n.s.c;s<=n.e.c;++s){var a=me({r:i,c:s});if((a=r?(e[i]||[])[s]:e[a])&&null!=a.v){for(var l=(a.w||(un(a),a.w)||"").slice(0,10);l.length<10;)l+=" ";o.push(l+(0===s?" ":""))}else o.push("          ")}t.push(o.join(""))}return t.join("\n")}};function io(e,t,n,r,i){i.raw?t[n][r]=e:"TRUE"===e?t[n][r]=!0:"FALSE"===e?t[n][r]=!1:""!==e&&(isNaN(Ne(e))?isNaN(xe(e).getDate())?t[n][r]=e:t[n][r]=oe(e):t[n][r]=Ne(e))}function oo(r,e){var i=e||{},e="",o=(null!=ae&&null==i.dense&&(i.dense=ae),i.dense?[]:{}),s={s:{c:0,r:0},e:{c:0,r:0}},a=("sep="==r.slice(0,4)?13==r.charCodeAt(5)&&10==r.charCodeAt(6)?(e=r.charAt(4),r=r.slice(7)):13!=r.charCodeAt(5)&&10!=r.charCodeAt(5)||(e=r.charAt(4),r=r.slice(6)):e=function(e){for(var t={},n=!1,r=0,i=0;r<e.length;++r)34==(i=e.charCodeAt(r))?n=!n:!n&&i in to&&(t[i]=(t[i]||0)+1);for(r in i=[],t)Object.prototype.hasOwnProperty.call(t,r)&&i.push([t[r],r]);if(!i.length)for(r in t=no)Object.prototype.hasOwnProperty.call(t,r)&&i.push([t[r],r]);return i.sort(function(e,t){return e[0]-t[0]||no[e[1]]-no[t[1]]}),to[i.pop()[1]]}(r.slice(0,1024)),0),l=0,u=0,c=0,d=0,h=e.charCodeAt(0),t=!1,f=0,p=(r=r.replace(/\r\n/gm,"\n"),null!=i.dateNF?(e=(e="number"==typeof(e=i.dateNF)?le._table[e]:e).replace(w,"(\\d+)"),new RegExp("^"+e+"$")):null);function n(){var e,t=r.slice(c,d),n={};if(0===(t='"'==t.charAt(0)&&'"'==t.charAt(t.length-1)?t.slice(1,-1).replace(/""/g,'"'):t).length?n.t="z":i.raw||0===t.trim().length?(n.t="s",n.v=t):61==t.charCodeAt(0)?34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(n.t="s",n.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(n.t="n",n.f=t.slice(1)):(n.t="s",n.v=t):"TRUE"==t?(n.t="b",n.v=!0):"FALSE"==t?(n.t="b",n.v=!1):isNaN(u=Ne(t))?!isNaN(xe(t).getDate())||p&&t.match(p)?(n.z=i.dateNF||le._table[14],e=0,p&&t.match(p)&&(t=function(e,r){var i=-1,o=-1,s=-1,a=-1,l=-1,u=-1;(e.match(w)||[]).forEach(function(e,t){var n=parseInt(r[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":i=n;break;case"d":s=n;break;case"h":a=n;break;case"s":u=n;break;case"m":0<=a?l=n:o=n}}),0<=u&&-1==l&&0<=o&&(l=o,o=-1);8==(e=7==(e=(""+(0<=i?i:(new Date).getFullYear())).slice(-4)+"-"+("00"+(1<=o?o:1)).slice(-2)+"-"+("00"+(1<=s?s:1)).slice(-2)).length?"0"+e:e).length&&(e="20"+e);var t=("00"+(0<=a?a:0)).slice(-2)+":"+("00"+(0<=l?l:0)).slice(-2)+":"+("00"+(0<=u?u:0)).slice(-2);return-1==a&&-1==l&&-1==u?e:-1==i&&-1==o&&-1==s?t:e+"T"+t}(i.dateNF,t.match(p)||[]),e=1),i.cellDates?(n.t="d",n.v=oe(t,e)):(n.t="n",n.v=j(oe(t,e))),!1!==i.cellText&&(n.w=le.format(n.z,n.v instanceof Date?j(n.v):n.v)),i.cellNF||delete n.z):(n.t="s",n.v=t):(!(n.t="n")!==i.cellText&&(n.w=t),n.v=u),"z"!=n.t&&(i.dense?(o[a]||(o[a]=[]),o[a][l]=n):o[me({c:l,r:a})]=n),c=d+1,s.e.c<l&&(s.e.c=l),s.e.r<a&&(s.e.r=a),f!=h)return l=0,++a,!!(i.sheetRows&&i.sheetRows<=a);++l}e:for(;d<r.length;++d)switch(f=r.charCodeAt(d)){case 34:t=!t;break;case h:case 10:case 13:if(!t&&n())break e}return 0<d-c&&n(),o["!ref"]=ye(s),o}function so(e,t){return!t||!t.PRN||"sep="==e.slice(0,4)||0<=e.indexOf("\t")||0<=e.indexOf(",")||0<=e.indexOf(";")?oo(e,t):hn(function(e,t){var n=t||{},r=[];if(e&&0!==e.length){for(var i=e.split(/[\r\n]/),o=i.length-1;0<=o&&0===i[o].length;)--o;for(var s=10,a=0,l=0;l<=o;++l)-1==(a=i[l].indexOf(" "))?a=i[l].length:a++,s=Math.max(s,a);for(l=0;l<=o;++l){r[l]=[];var u=0;for(io(i[l].slice(0,s).trim(),r,l,u,n),u=1;u<=(i[l].length-s)/10+1;++u)io(i[l].slice(s+10*(u-1),s+10*u).trim(),r,l,u,n)}n.sheetRows&&(r=r.slice(0,n.sheetRows))}return r}(e,t),t)}function ao(e,t){var n="",r="string"==t.type?[0,0,0,0]:Wc(e,t);switch(t.type){case"base64":n=S.decode(e);break;case"binary":n=e;break;case"buffer":n=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!=typeof cptable?cptable.utils.decode(t.codepage,e):e.toString("binary");break;case"array":n=q(e);break;case"string":n=e;break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]?n=he(n.slice(3)):"binary"==t.type&&"undefined"!=typeof cptable&&t.codepage&&(n=cptable.utils.decode(t.codepage,cptable.utils.encode(1252,n))),"socialcalc:version:"==n.slice(0,19)?Qi.to_sheet("string"==t.type?n:he(n),t):so(n,t)}lo={0:{n:"BOF",f:d},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e){var t={s:{c:0,r:0},e:{c:0,r:0}};return t.s.c=e._R(2),t.s.r=e._R(2),t.e.c=e._R(2),t.e.r=e._R(2),65535==t.s.c&&(t.s.c=t.e.c=t.s.r=t.e.r=0),t}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,n){return(n=fo(e,0,n))[1].v=e._R(2,"i"),n}},14:{n:"NUMBER",f:function(e,t,n){return(n=fo(e,0,n))[1].v=e._R(8,"f"),n}},15:{n:"LABEL",f:po},16:{n:"FORMULA",f:function(e,t,n){var t=e.l+t,r=fo(e,0,n);return r[1].v=e._R(8,"f"),n.qpro?e.l=t:(n=e._R(2),e.l+=n),r}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:po},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},255:{n:"",f:h}},uo={0:{n:"BOF"},1:{n:"EOF"},3:{n:"??"},4:{n:"??"},5:{n:"??"},6:{n:"??"},7:{n:"??"},9:{n:"??"},10:{n:"??"},11:{n:"??"},12:{n:"??"},14:{n:"??"},15:{n:"??"},16:{n:"??"},17:{n:"??"},18:{n:"??"},19:{n:"??"},21:{n:"??"},22:{n:"LABEL16",f:function(e,t){var n=go(e);return n[1].t="s",n[1].v=e._R(t-4,"cstr"),n}},23:{n:"NUMBER17",f:mo},24:{n:"NUMBER18",f:function(e,t){var n=go(e),r=(n[1].v=e._R(2),n[1].v>>1);if(1&n[1].v)switch(7&r){case 1:r=500*(r>>3);break;case 2:r=(r>>3)/20;break;case 4:r=(r>>3)/2e3;break;case 6:r=(r>>3)/16;break;case 7:r=(r>>3)/64;break;default:throw"unknown NUMBER_18 encoding "+(7&r)}return n[1].v=r,n}},25:{n:"FORMULA19",f:function(e,t){var n=mo(e);return e.l+=t-14,n}},26:{n:"??"},27:{n:"??"},28:{n:"??"},29:{n:"??"},30:{n:"??"},31:{n:"??"},33:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var n=go(e),e=e._R(4);return n[1].v=e>>6,n}},39:{n:"NUMBER27",f:yo},40:{n:"FORMULA28",f:function(e,t){var n=yo(e);return e.l+=t-10,n}},255:{n:"",f:h}};var lo,uo,co={to_workbook:function(e,t){switch(t.type){case"base64":return ho(re(S.decode(e)),t);case"binary":return ho(re(e),t);case"buffer":case"array":return ho(e,t)}throw"Unsupported type "+t.type}};function ho(r,e){if(!r)return r;var i=e||{},o=(null!=ae&&null==i.dense&&(i.dense=ae),i.dense?[]:{}),s="Sheet1",a=0,l={},u=[s],c={s:{r:0,c:0},e:{r:0,c:0}},d=i.sheetRows||0;if(2==r[2])i.Enum=lo;else if(26==r[2])i.Enum=uo;else{if(14!=r[2])throw new Error("Unrecognized LOTUS BOF "+r[2]);i.Enum=uo,i.qpro=!0,r.l=0}return function(e,t,n){if(e){fe(e,e.l||0);for(var r=n.Enum||lo;e.l<e.length;){var i=e._R(2),o=r[i]||r[255],s=e._R(2),a=e.l+s,s=(o.f||h)(e,s,n);if(e.l=a,t(s,o.n,i))return}}}(r,function(e,t,n){if(2==r[2])switch(n){case 0:4096<=(i.vers=e)&&(i.qpro=!0);break;case 6:c=e;break;case 15:i.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:case 51:14==n&&112==(112&e[2])&&1<(15&e[2])&&(15&e[2])<15&&(e[1].z=i.dateNF||le._table[14],i.cellDates)&&(e[1].t="d",e[1].v=Y(e[1].v)),i.dense?(o[e[0].r]||(o[e[0].r]=[]),o[e[0].r][e[0].c]=e[1]):o[me(e[0])]=e[1]}else switch(n){case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:e[3]>a&&(o["!ref"]=ye(c),l[s]=o,o=i.dense?[]:{},c={s:{r:0,c:0},e:{r:0,c:0}},a=e[3],s="Sheet"+(a+1),u.push(s)),0<d&&e[0].r>=d||(i.dense?(o[e[0].r]||(o[e[0].r]=[]),o[e[0].r][e[0].c]=e[1]):o[me(e[0])]=e[1],c.e.c<e[0].c&&(c.e.c=e[0].c),c.e.r<e[0].r&&(c.e.r=e[0].r))}},i),o["!ref"]=ye(c),l[s]=o,{SheetNames:u,Sheets:l}}function fo(e,t,n){var r=[{c:0,r:0},{t:"n",v:0},0];return n.qpro&&20768!=n.vers?(r[0].c=e._R(1),e.l++,r[0].r=e._R(2),e.l+=2):(r[2]=e._R(1),r[0].c=e._R(2),r[0].r=e._R(2)),r}function po(e,t,n){var r,t=e.l+t,i=fo(e,0,n);return i[1].t="s",20768==n.vers?(e.l++,r=e._R(1),i[1].v=e._R(r,"utf8")):(n.qpro&&e.l++,i[1].v=e._R(t-e.l,"cstr")),i}function go(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e._R(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function mo(e,t){var n=go(e),r=e._R(4),i=e._R(4),e=e._R(2);return 65535==e?n[1].v=0:n[1].v=(2*(32768&e)-1)*((0<(e=(32767&e)-16446)?i<<e:i>>>-e)+(-32<e?r<<32+e:r>>>-(32+e))),n}function yo(e,t){var n=go(e),e=e._R(8,"f");return n[1].v=e,n}vo=at("t"),bo=at("rPr"),Eo=/<(?:\w+:)?r>/g,Co=/<\/(?:\w+:)?r>/;var vo,bo,Eo,Co,wo=function(e){return e.replace(Eo,"").split(Co).map(So).filter(function(e){return e.v})};function So(e){var t=e.match(vo);return t?(t={t:"s",v:ce(t[1])},(e=e.match(bo))&&(t.s=function(e){var t={},n=e.match(Ue),r=0,i=!1;if(n)for(;r!=n.length;++r){var o=se(n[r]);switch(o[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":"1"!=o.val&&(t.cp=k[parseInt(o.val,10)]);break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=o.val;break;case"<sz":t.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==o.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==o.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":o.rgb&&(t.color=o.rgb.slice(2,8));break;case"<family":t.family=o.val;break;case"<vertAlign":t.valign=o.val;break;case"<scheme":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(47!==o[0].charCodeAt(1)&&!i)throw new Error("Unrecognized rich format "+o[0])}}return t}(e[1])),t):{t:"s",v:""}}To=/(\r\n|\n)/g;var To,Ro=function(e){return e.map(Ao).join("")};function Ao(e){var t,n,r,i=[[],e.v,[]];return e.v?(e.s&&(e=e.s,t=i[0],n=i[2],r=[],e.u&&r.push("text-decoration: underline;"),e.uval&&r.push("text-underline-style:"+e.uval+";"),e.sz&&r.push("font-size:"+e.sz+"pt;"),e.outline&&r.push("text-effect: outline;"),e.shadow&&r.push("text-shadow: auto;"),t.push('<span style="'+r.join("")+'">'),e.b&&(t.push("<b>"),n.push("</b>")),e.i&&(t.push("<i>"),n.push("</i>")),e.strike&&(t.push("<s>"),n.push("</s>")),"superscript"==(r=e.valign||"")||"super"==r?r="sup":"subscript"==r&&(r="sub"),""!=r&&(t.push("<"+r+">"),n.push("</"+r+">")),n.push("</span>")),i[0].join("")+i[1].replace(To,"<br/>")+i[2].join("")):""}var _o=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,No=/<(?:\w+:)?r>/,xo=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Oo(e,t){var t=!t||t.cellHTML,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ce(he(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=he(e),t&&(n.h=Qe(n.t))):e.match(No)&&(n.r=he(e),n.t=ce(he((e.replace(xo,"").match(_o)||[]).join("").replace(Ue,""))),t)&&(n.h=Ro(wo(n.r))),n):{t:""}}var Io=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Mo=/<(?:\w+:)?(?:si|sstItem)>/g,ko=/<\/(?:\w+:)?(?:si|sstItem)>/;M.SST="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings";var Do=/^\s|\s$|[\t\n\r]/;function Lo(e,t){if(!t.bookSST)return"";var n=[A];n[n.length]=N("sst",null,{xmlns:I.main[0],count:e.Count,uniqueCount:e.Unique});for(var r,i,o=0;o!=e.length;++o)null!=e[o]&&(i="<si>",(r=e[o]).r?i+=r.r:(i+="<t",r.t||(r.t=""),r.t.match(Do)&&(i+=' xml:space="preserve"'),i+=">"+_(r.t)+"</t>"),n[n.length]=i+="</si>");return 2<n.length&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}var Po=function(e,t){var n=!1;return null==t&&(n=!0,t=ee(15+4*e.t.length)),t._W(1,0),gn(e.t,t),n?t.slice(0,t.l):t};function Fo(e){var t,n,r=Zt();x(r,"BrtBeginSst",(t=e,(n=n||ee(8))._W(4,t.Count),n._W(4,t.Unique),n));for(var i=0;i<e.length;++i)x(r,"BrtSSTItem",Po(e[i]));return x(r,"BrtEndSst"),r.end()}function Bo(e){if("undefined"!=typeof cptable)return cptable.utils.encode(C,e);for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function Ho(e,t){var n={};return n.Major=e._R(2),n.Minor=e._R(2),4<=t&&(e.l+=t-4),n}function Uo(e){for(var t=[],n=(e.l+=4,e._R(4));0<n--;)t.push(function(e){for(var t=e._R(4),t=e.l+t-4,n={},r=e._R(4),i=[];0<r--;)i.push({t:e._R(4),v:e._R(0,"lpp4")});if(n.name=e._R(0,"lpp4"),n.comps=i,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}(e));return t}function Vo(e){t={},(n=e)._R(4),n.l+=4,t.id=n._R(0,"lpp4"),t.name=n._R(0,"lpp4"),t.R=Ho(n,4),t.U=Ho(n,4),t.W=Ho(n,4);var t,n=t;if(n.ename=e._R(0,"8lpp4"),n.blksz=e._R(4),n.cmode=e._R(4),4!=e._R(4))throw new Error("Bad !Primary record")}function Wo(e,t){var t=e.l+t,n={},r=(n.Flags=63&e._R(4),e.l+=4,n.AlgID=e._R(4),!1);switch(n.AlgID){case 26126:case 26127:case 26128:r=36==n.Flags;break;case 26625:r=4==n.Flags;break;case 0:r=16==n.Flags||4==n.Flags||36==n.Flags;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(r)return n.AlgIDHash=e._R(4),n.KeySize=e._R(4),n.ProviderType=e._R(4),e.l+=8,n.CSPName=e._R(t-e.l>>1,"utf16le"),e.l=t,n;throw new Error("Encryption Flags/AlgID mismatch")}function $o(e,t){var n={},t=e.l+t;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e._R(4),n.VerifierHash=e.slice(e.l,t),e.l=t,n}function jo(e){var t,n,r,i=Ho(e);switch(i.Minor){case 2:return[i.Minor,function(e){if(36!=(63&e._R(4)))throw new Error("EncryptionInfo mismatch");var t=e._R(4),t=Wo(e,t),e=$o(e,e.length-e.l);return{t:"Std",h:t,v:e}}(e)];case 3:return[i.Minor,function(){throw new Error("File is password-protected: ECMA-376 Extensible")}()];case 4:return[i.Minor,(n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"],(t=e).l+=4,t=t._R(t.length-t.l,"utf8"),r={},t.replace(Ue,function(e){var t=se(e);switch($e(t[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(e){r[e]=t[e]});break;case"<dataIntegrity":r.encryptedHmacKey=t.encryptedHmacKey,r.encryptedHmacValue=t.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=t.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(t);break;default:throw t[0]}}),r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+i.Minor)}function zo(e){var t,n=0,r=Bo(e),i=r.length+1,o=te(i);for(o[0]=r.length,t=1;t!=i;++t)o[t]=r[t-1];for(t=i-1;0<=t;--t)n=((0==(16384&n)?0:1)|n<<1&32767)^o[t];return 52811^n}Go=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],Yo=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],Xo=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],Ko=function(e){return 255&(e/2|128*e)};var Go,Yo,Xo,Ko,qo=function(e){for(var t,n=Bo(e),r=function(e){for(var t=Yo[e.length-1],n=104,r=e.length-1;0<=r;--r)for(var i=e[r],o=0;7!=o;++o)64&i&&(t^=Xo[n]),i*=2,--n;return t}(n),i=n.length,o=te(16),s=0;16!=s;++s)o[s]=0;for(1==(1&i)&&(o[i]=Zo(Go[0],r>>8),e=n[n.length-1],o[--i]=Zo(e,255&r));0<i;)o[--i]=Zo(n[i],r>>8),o[--i]=Zo(n[i],255&r);for(t=(i=15)-n.length;0<t;)o[i]=Zo(Go[t],r>>8),--t,o[--i]=Zo(n[i],255&r),--i,--t;return o};function Zo(e,t){return Ko(e^t)}var Qo=function(e){var t=0,n=qo(e);return function(e){e=function(e,t,n,r,i){var o,s;for(i=i||t,r=r||qo(e),o=0;o!=t.length;++o)s=t[o],s^=r[n],i[o]=255&(s>>5|s<<3),++n;return[i,n,r]}("",e,t,n);return t=e[1],e[0]}};function Jo(e,t,n){n=n||{};n.Info=e._R(2),e.l-=2,1===n.Info?n.Data=function(e){var t={},n=t.EncryptionVersionInfo=Ho(e,4);if(1!=n.Major||1!=n.Minor)throw"unrecognized version code "+n.Major+" : "+n.Minor;return t.Salt=e._R(16),t.EncryptedVerifier=e._R(16),t.EncryptedVerifierHash=e._R(16),t}(e):n.Data=function(e,t){var n={},r=n.EncryptionVersionInfo=Ho(e,4);if(t-=4,2!=r.Minor)throw new Error("unrecognized minor version code: "+r.Minor);if(4<r.Major||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);return n.Flags=e._R(4),t-=4,r=e._R(4),t-=4,n.EncryptionHeader=Wo(e,r),n.EncryptionVerifier=$o(e,t-=r),n}(e,t)}var es={to_workbook:function(e,t){return cn(ts(e,t),t)},to_sheet:ts,from_sheet:function(e){for(var t=["{\\rtf1\\ansi"],n=ve(e["!ref"]),r=Array.isArray(e),i=n.s.r;i<=n.e.r;++i){t.push("\\trowd\\trautofit1");for(var o=n.s.c;o<=n.e.c;++o)t.push("\\cellx"+(o+1));for(t.push("\\pard\\intbl"),o=n.s.c;o<=n.e.c;++o){var s=me({r:i,c:o});(s=r?(e[i]||[])[o]:e[s])&&(null!=s.v||s.f&&!s.F)&&(t.push(" "+(s.w||(un(s),s.w))),t.push("\\cell"))}t.push("\\pard\\intbl\\row")}return t.join("")+"}"}};function ts(e,t){switch(t.type){case"base64":return ns(S.decode(e),t);case"binary":return ns(e,t);case"buffer":return ns(e.toString("binary"),t);case"array":return ns(q(e),t)}throw new Error("Unrecognized type "+t.type)}function ns(e,t){t=(t||{}).dense?[]:{};if(e.match(/\\trowd/))return t["!ref"]=ye({s:{c:0,r:0},e:{c:0,r:0}}),t;throw new Error("RTF missing table")}function rs(e){for(var t=0,n=1;3!=t;++t)n=256*n+(255<e[t]?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}function is(e,t){return 0===t?e:((e=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,e=Math.max(t,n,r),i=Math.min(t,n,r),o=e-i;if(0==o)return[0,0,t];var s=0,a=o/(1<(i=e+i)?2-i:i);switch(e){case t:s=((n-r)/o+6)%6;break;case n:s=(r-t)/o+2;break;case r:s=(t-n)/o+4}return[s/6,a,i/2]}((e=(e=e).slice("#"===e[0]?1:0).slice(0,6),[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)])))[2]=t<0?e[2]*(1+t):1-(1-e[2])*(1-t),rs(function(e){var t,n=e[0],r=e[1],e=e[2],i=2*r*(e<.5?e:1-e),o=[e=e-i/2,e,e],s=6*n;if(0!==r)switch(0|s){case 0:case 6:t=i*s,o[0]+=i,o[1]+=t;break;case 1:o[0]+=t=i*(2-s),o[1]+=i;break;case 2:t=i*(s-2),o[1]+=i,o[2]+=t;break;case 3:o[1]+=t=i*(4-s),o[2]+=i;break;case 4:t=i*(s-4),o[2]+=i,o[0]+=t;break;case 5:o[2]+=t=i*(6-s),o[0]+=i}for(var a=0;3!=a;++a)o[a]=Math.round(255*o[a]);return o}(e)))}var os=6,ss=15,as=1,ls=os;function us(e){return Math.floor((e+Math.round(128/ls)/256)*ls)}function cs(e){return Math.floor((e-5)/ls*100+.5)/100}function ds(e){return Math.round((e*ls+5)/ls*256)/256}function hs(e){return ds(cs(us(e)))}function fs(e){var t=Math.abs(e-hs(e)),n=ls;if(.005<t)for(ls=as;ls<ss;++ls)Math.abs(e-hs(e))<=t&&(t=Math.abs(e-hs(e)),n=ls);ls=n}function ps(e){e.width?(e.wpx=us(e.width),e.wch=cs(e.wpx),e.MDW=ls):e.wpx?(e.wch=cs(e.wpx),e.width=ds(e.wch),e.MDW=ls):"number"==typeof e.wch&&(e.width=ds(e.wch),e.wpx=us(e.width),e.MDW=ls),e.customWidth&&delete e.customWidth}var gs=96;function ms(e){return 96*e/gs}function ys(e){return e*gs/96}var vs={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var bs=["numFmtId","fillId","fontId","borderId","xfId"],Es=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];Cs=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,ws=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,Ss=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,Ts=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,Rs=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;var Cs,ws,Ss,Ts,Rs,As=function(e,t,n){var r,i,o,s,a,l,u,c,d,h,f,p,g,m,y,v,b,E,C={};if(e){if(r=(e=e.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(Cs)){var w=r,S=C,T=n;S.NumberFmt=[];for(var R=ue(le._table),A=0;A<R.length;++A)S.NumberFmt[R[A]]=le._table[R[A]];var _=w[0].match(Ue);if(_)for(A=0;A<_.length;++A){var N=se(_[A]);switch($e(N[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":var x=ce(he(N.formatCode)),O=parseInt(N.numFmtId,10);if(S.NumberFmt[O]=x,0<O){if(392<O){for(O=392;60<O&&null!=S.NumberFmt[O];--O);S.NumberFmt[O]=x}le.load(x,O)}break;case"</numFmt>":break;default:if(T.WTF)throw new Error("unrecognized "+N[0]+" in numFmts")}}}(r=e.match(Ts))&&(w=r,o=t,s=n,(i=C).Fonts=[],l=!(a={}),(w[0].match(Ue)||[]).forEach(function(e){var t=se(e);switch($e(t[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":i.Fonts.push(a),a={};break;case"<name":t.val&&(a.name=he(t.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=t.val?de(t.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=t.val?de(t.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(t.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=t.val?de(t.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=t.val?de(t.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=t.val?de(t.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=t.val?de(t.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=t.val?de(t.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":t.val&&(a.sz=+t.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":t.val&&(a.vertAlign=t.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":t.val&&(a.family=parseInt(t.val,10));break;case"<family/>":case"</family>":break;case"<scheme":t.val&&(a.scheme=t.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":"1"!=t.val&&(t.codepage=k[parseInt(t.val,10)]);break;case"<color":if(a.color||(a.color={}),t.auto&&(a.color.auto=de(t.auto)),t.rgb)a.color.rgb=t.rgb.slice(-6);else if(t.indexed){a.color.index=parseInt(t.indexed,10);var n=Yn[a.color.index];if(!(n=81==a.color.index?Yn[1]:n))throw new Error(e);a.color.rgb=n[0].toString(16)+n[1].toString(16)+n[2].toString(16)}else t.theme&&(a.color.theme=parseInt(t.theme,10),t.tint&&(a.color.tint=parseFloat(t.tint)),t.theme)&&o.themeElements&&o.themeElements.clrScheme&&(a.color.rgb=is(o.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(s&&s.WTF&&!l)throw new Error("unrecognized "+t[0]+" in fonts")}})),(r=e.match(Ss))&&(t=r,c=n,(u=C).Fills=[],h=!(d={}),(t[0].match(Ue)||[]).forEach(function(e){var t=se(e);switch($e(t[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":d={},u.Fills.push(d);break;case"</fill>":case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":u.Fills.push(d),d={};break;case"<patternFill":case"<patternFill>":t.patternType&&(d.patternType=t.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":d.bgColor||(d.bgColor={}),t.indexed&&(d.bgColor.indexed=parseInt(t.indexed,10)),t.theme&&(d.bgColor.theme=parseInt(t.theme,10)),t.tint&&(d.bgColor.tint=parseFloat(t.tint)),t.rgb&&(d.bgColor.rgb=t.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":d.fgColor||(d.fgColor={}),t.theme&&(d.fgColor.theme=parseInt(t.theme,10)),t.tint&&(d.fgColor.tint=parseFloat(t.tint)),null!=t.rgb&&(d.fgColor.rgb=t.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":case"</stop>":break;case"<color":case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":h=!0;break;case"</ext>":h=!1;break;default:if(c&&c.WTF&&!h)throw new Error("unrecognized "+t[0]+" in fills")}})),(r=e.match(Rs))&&(t=r,p=n,(f=C).Borders=[],m=!(g={}),(t[0].match(Ue)||[]).forEach(function(e){var t=se(e);switch($e(t[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":g={},t.diagonalUp&&(g.diagonalUp=de(t.diagonalUp)),t.diagonalDown&&(g.diagonalDown=de(t.diagonalDown)),f.Borders.push(g);break;case"</border>":case"<left/>":break;case"<left":case"<left>":case"</left>":case"<right/>":break;case"<right":case"<right>":case"</right>":case"<top/>":break;case"<top":case"<top>":case"</top>":case"<bottom/>":break;case"<bottom":case"<bottom>":case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":break;case"<start":case"<start>":case"<start/>":case"</start>":break;case"<end":case"<end>":case"<end/>":case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":m=!0;break;case"</ext>":m=!1;break;default:if(p&&p.WTF&&!m)throw new Error("unrecognized "+t[0]+" in borders")}})),(r=e.match(ws))&&(t=r,v=n,E=!((y=C).CellXf=[]),(t[0].match(Ue)||[]).forEach(function(e){var t=se(e),n=0;switch($e(t[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(delete(b=t)[0],n=0;n<bs.length;++n)b[bs[n]]&&(b[bs[n]]=parseInt(b[bs[n]],10));for(n=0;n<Es.length;++n)b[Es[n]]&&(b[Es[n]]=de(b[Es[n]]));if(392<b.numFmtId)for(n=392;60<n;--n)if(y.NumberFmt[b.numFmtId]==y.NumberFmt[n]){b.numFmtId=n;break}y.CellXf.push(b);break;case"</xf>":break;case"<alignment":case"<alignment/>":var r={};t.vertical&&(r.vertical=t.vertical),t.horizontal&&(r.horizontal=t.horizontal),null!=t.textRotation&&(r.textRotation=t.textRotation),t.indent&&(r.indent=t.indent),t.wrapText&&(r.wrapText=de(t.wrapText)),b.alignment=r;break;case"</alignment>":case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":E=!0;break;case"</AlternateContent>":E=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":E=!0;break;case"</ext>":E=!1;break;default:if(v&&v.WTF&&!E)throw new Error("unrecognized "+t[0]+" in cellXfs")}}))}return C},_s=N("styleSheet",null,{xmlns:I.main[0],"xmlns:vt":I.vt});function Ns(e,t){var n,r,i,o,s=[A,_s];return e.SSF&&null!=(r=e.SSF,i=["<numFmts>"],[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t=e[0];t<=e[1];++t)null!=r[t]&&(i[i.length]=N("numFmt",null,{numFmtId:t,formatCode:_(r[t])}))}),n=1===i.length?"":(i[i.length]="</numFmts>",i[0]=N("numFmts",null,{count:i.length-2}).replace("/>",">"),i.join("")))&&(s[s.length]=n),s[s.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',s[s.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',s[s.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',s[s.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',e=t.cellXfs,(o=[])[o.length]="<cellXfs/>",e.forEach(function(e){o[o.length]=N("xf",null,e)}),o[o.length]="</cellXfs>",(n=2===o.length?"":(o[0]=N("cellXfs",null,{count:o.length-2}).replace("/>",">"),o.join("")))&&(s[s.length]=n),s[s.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',s[s.length]='<dxfs count="0"/>',s[s.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',2<s.length&&(s[s.length]="</styleSheet>",s[1]=s[1].replace("/>",">")),s.join("")}function xs(e,t){(t=t||ee(153))._W(2,20*e.sz),n=e,r=(r=t)||ee(2),n=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0),r._W(1,n),r._W(1,0),t._W(2,e.bold?700:400);var n=0,r=("superscript"==e.vertAlign?n=1:"subscript"==e.vertAlign&&(n=2),t._W(2,n),t._W(1,e.underline||0),t._W(1,e.family||0),t._W(1,e.charset||0),t._W(1,0),Dn(e.color,t),0);return"major"==e.scheme&&(r=1),"minor"==e.scheme&&(r=2),t._W(1,r),gn(e.name,t),t.length>t.l?t.slice(0,t.l):t}M.STY="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles";var Os=H(["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"]),Is=h;function Ms(e,t){t=t||ee(84);var e=Os[e.patternType],n=(t._W(4,e=null==e?40:e),0);if(40!=e)for(Dn({auto:1},t),Dn({auto:1},t);n<12;++n)t._W(4,0);else{for(;n<4;++n)t._W(4,0);for(;n<12;++n)t._W(4,0)}return t.length>t.l?t.slice(0,t.l):t}function ks(e,t,n){(n=n||ee(16))._W(2,t||0),n._W(2,e.numFmtId||0),n._W(2,0),n._W(2,0),n._W(2,0),n._W(1,0),n._W(1,0);return n._W(1,0),n._W(1,0),n._W(1,0),n._W(1,0),n}function Ds(e,t){(t=t||ee(10))._W(1,0),t._W(1,0),t._W(4,0),t._W(4,0)}var Ls=h;function Ps(o,s){var n;s&&(n=0,[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t=e[0];t<=e[1];++t)null!=s[t]&&++n}),0!=n)&&(x(o,"BrtBeginFmts",fn(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t,n,r,i=e[0];i<=e[1];++i)null!=s[i]&&x(o,"BrtFmt",(n=s[t=i],(r=(r=void 0)||ee(6+4*n.length))._W(2,t),gn(n,r),t=r.length>r.l?r.slice(0,r.l):r,null==r.l&&(r.l=r.length),t))}),x(o,"BrtEndFmts"))}function Fs(e){var t;x(e,"BrtBeginBorders",fn(1)),x(e,"BrtBorder",((t=t||ee(51))._W(1,0),Ds(0,t),Ds(0,t),Ds(0,t),Ds(0,t),Ds(0,t),t.length>t.l?t.slice(0,t.l):t)),x(e,"BrtEndBorders")}function Bs(e){var t,n;x(e,"BrtBeginStyles",fn(1)),x(e,"BrtStyle",(t={xfId:0,builtinId:0,name:"Normal"},(n=n||ee(52))._W(4,t.xfId),n._W(2,1),n._W(1,+t.builtinId),n._W(1,0),Tn(t.name||"",n),n.length>n.l?n.slice(0,n.l):n)),x(e,"BrtEndStyles")}function Hs(e){var t,n,r,i;x(e,"BrtBeginTableStyles",(t=0,n="TableStyleMedium9",r="PivotStyleMedium4",(i=ee(2052))._W(4,t),Tn(n,i),Tn(r,i),i.length>i.l?i.slice(0,i.l):i)),x(e,"BrtEndTableStyles")}function Us(e,t){var n,r=Zt();return x(r,"BrtBeginStyleSheet"),Ps(r,e.SSF),x(e=r,"BrtBeginFonts",fn(1)),x(e,"BrtFont",xs({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),x(e,"BrtEndFonts"),x(e=r,"BrtBeginFills",fn(2)),x(e,"BrtFill",Ms({patternType:"none"})),x(e,"BrtFill",Ms({patternType:"gray125"})),x(e,"BrtEndFills"),Fs(r),x(e=r,"BrtBeginCellStyleXFs",fn(1)),x(e,"BrtXF",ks({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),x(e,"BrtEndCellStyleXFs"),n=r,e=t.cellXfs,x(n,"BrtBeginCellXFs",fn(e.length)),e.forEach(function(e){x(n,"BrtXF",ks(e,0))}),x(n,"BrtEndCellXFs"),Bs(r),x(t=r,"BrtBeginDXFs",fn(0)),x(t,"BrtEndDXFs"),Hs(r),x(r,"BrtEndStyleSheet"),r.end()}M.THEME="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme";var Vs=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Ws(e,n,r){n.themeElements.clrScheme=[];var i={};(e[0].match(Ue)||[]).forEach(function(e){var t=se(e);switch(t[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":i.rgb=t.val;break;case"<a:sysClr":i.rgb=t.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===t[0].charAt(1)?(n.themeElements.clrScheme[Vs.indexOf(t[0])]=i,i={}):i.name=t[0].slice(3,t[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+t[0]+" in clrScheme")}})}function $s(){}function js(){}var zs=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Gs=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Ys=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var Xs=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Ks(e,t){if(!e||0===e.length)return Ks(qs());var n,r,i,o,s,a={};if(n=e.match(Xs))return r=n[0],o=t,(i=a).themeElements={},[["clrScheme",zs,Ws],["fontScheme",Gs,$s],["fmtScheme",Ys,js]].forEach(function(e){if(!(s=r.match(e[1])))throw new Error(e[0]+" not found in themeElements");e[2](s,i,o)}),a.raw=e,a;throw new Error("themeElements not found in theme")}function qs(e,t){return t&&t.themeXLSX?t.themeXLSX:e&&"string"==typeof e.raw?e.raw:((t=[A])[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join(""))}function Zs(e){var t={};switch(t.xclrType=e._R(2),t.nTintShade=e._R(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=h(e,4);break;case 2:t.xclrValue=Jr(e);break;case 3:t.xclrValue=e._R(4);break;case 4:e.l+=4}return e.l+=8,t}function Qs(e){var t=e._R(2),n=e._R(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=Zs(e);break;case 6:r[1]=h(e,n);break;case 14:case 15:r[1]=e._R(1==n?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+n)}return r}M.IMG="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",M.DRAW="http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing";var Js=1024;M.CMNT="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments";var ea=N("comments",null,{xmlns:I.main[0]});function ta(e){var n=[A,ea],r=[];return n.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){e=_(e.a);-1<r.indexOf(e)||(r.push(e),n.push("<author>"+e+"</author>"))})}),n.push("</authors>"),n.push("<commentList>"),e.forEach(function(t){t[1].forEach(function(e){n.push('<comment ref="'+t[0]+'" authorId="'+r.indexOf(_(e.a))+'"><text>'),n.push(pt("t",null==e.t?"":_(e.t))),n.push("</text></comment>")})}),n.push("</commentList>"),2<n.length&&(n[n.length]="</comments>",n[1]=n[1].replace("/>",">")),n.join("")}var na=pn;function ra(e){var i=Zt(),o=[];return x(i,"BrtBeginComments"),x(i,"BrtBeginCommentAuthors"),e.forEach(function(e){e[1].forEach(function(e){-1<o.indexOf(e.a)||(o.push(e.a.slice(0,54)),x(i,"BrtCommentAuthor",gn(e.a.slice(0,54))))})}),x(i,"BrtEndCommentAuthors"),x(i,"BrtBeginCommentList"),e.forEach(function(r){r[1].forEach(function(e){e.iauthor=o.indexOf(e.a);var t,n={s:B(r[0]),e:B(r[0])};x(i,"BrtBeginComment",(n=[n,e],(t=null==t?ee(36):t)._W(4,n[1].iauthor),In(n[0],t),t._W(4,0),t._W(4,0),t._W(4,0),t._W(4,0),t)),e.t&&0<e.t.length&&x(i,"BrtCommentText",vn(e)),x(i,"BrtEndComment"),delete e.iauthor})}),x(i,"BrtEndCommentList"),x(i,"BrtEndComments"),i.end()}var ia="application/vnd.ms-office.vbaProject";var oa=["xlsb","xlsm","xlam","biff8","xla"];M.DS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",M.MS="http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet";sa=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,aa={r:0,c:0};var sa,aa,la=function(e,t){return aa=t,e.replace(sa,ua)};function ua(e,t,n,r){var i=!1,o=!1,n=(0==n.length?o=!0:"["==n.charAt(0)&&(o=!0,n=n.slice(1,-1)),0==r.length?i=!0:"["==r.charAt(0)&&(i=!0,r=r.slice(1,-1)),0<n.length?0|parseInt(n,10):0),r=0<r.length?0|parseInt(r,10):0;return i?r+=aa.c:--r,o?n+=aa.r:--n,t+(i?"":"$")+ge(r)+(o?"":"$")+pe(n)}var ca=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,da=function(e,s){return e.replace(ca,function(e,t,n,r,i,o){r=sn(r)-(n?0:s.c),o=on(o)-(i?0:s.r);return t+"R"+(0==o?"":i?1+o:"["+o+"]")+"C"+(0==r?"":n?1+r:"["+r+"]")})};function ha(e,t,n){var s,t=an(t).s,n=B(n),n={r:n.r-t.r,c:n.c-t.c};return s=n,e.replace(ca,function(e,t,n,r,i,o){return t+("$"==n?n+r:ge(sn(r)+s.c))+("$"==i?i+o:pe(on(o)+s.r))})}function fa(e){return e.replace(/_xlfn\./g,"")}function e(e){e.l+=1}function pa(e,t){e=e._R(1==t?1:2);return[16383&e,e>>14&1,e>>15&1]}function ga(e,t,n){var r=2;if(n){if(2<=n.biff&&n.biff<=5)return ma(e);12==n.biff&&(r=4)}var n=e._R(r),r=e._R(r),i=pa(e,2),e=pa(e,2);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:r,c:e[0],cRel:e[1],rRel:e[2]}}}function ma(e){var t=pa(e,2),n=pa(e,2),r=e._R(1),e=e._R(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:e,cRel:n[1],rRel:n[2]}}}function ya(e,t,n){var r,i;return n&&2<=n.biff&&n.biff<=5?(r=pa(i=e,2),i=i._R(1),{r:r[0],c:i,cRel:r[1],rRel:r[2]}):{r:e._R(n&&12==n.biff?4:2),c:(i=pa(e,2))[0],cRel:i[1],rRel:i[2]}}function va(e){return[e._R(1),e._R(1)]}function ba(e,t,n){var r=0,i=0;12==n.biff?(r=e._R(4),i=e._R(4)):(i=1+e._R(1),r=1+e._R(2)),2<=n.biff&&n.biff<8&&(--r,0==--i)&&(i=256);for(var o=0,s=[];o!=r&&(s[o]=[]);++o)for(var a=0;a!=i;++a)s[o][a]=function(e,t){var n=[e._R(1)];if(12==t)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2}switch(n[0]){case 4:n[1]=y(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:n[1]=Xn[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:n[1]=Mn(e);break;case 2:n[1]=Kr(e,0,{biff:0<t&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}(e,n.biff);return s}function Ea(e,t,n){return e.l+=2,[(r=(e=e)._R(2),e=e._R(2),{r:r,c:255&e,fQuoted:!!(16384&e),cRel:e>>15,rRel:e>>15})];var r}function Ca(e){return e.l+=6,[]}var wa=Ea,Sa=Ca,Ta=Ca,Ra=Ea;function Aa(e){return e.l+=2,[d(e),1&e._R(2)]}var _a=Ea,Na=Aa,xa=Ca,Oa=Ea,Ia=Ea,Ma=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var ka,Da={1:{n:"PtgExp",f:function(e,t,n){return e.l++,n&&12==n.biff?[e._R(4,"i"),0]:[e._R(2),e._R(n&&2==n.biff?1:2)]}},2:{n:"PtgTbl",f:h},3:{n:"PtgAdd",f:e},4:{n:"PtgSub",f:e},5:{n:"PtgMul",f:e},6:{n:"PtgDiv",f:e},7:{n:"PtgPower",f:e},8:{n:"PtgConcat",f:e},9:{n:"PtgLt",f:e},10:{n:"PtgLe",f:e},11:{n:"PtgEq",f:e},12:{n:"PtgGe",f:e},13:{n:"PtgGt",f:e},14:{n:"PtgNe",f:e},15:{n:"PtgIsect",f:e},16:{n:"PtgUnion",f:e},17:{n:"PtgRange",f:e},18:{n:"PtgUplus",f:e},19:{n:"PtgUminus",f:e},20:{n:"PtgPercent",f:e},21:{n:"PtgParen",f:e},22:{n:"PtgMissArg",f:e},23:{n:"PtgStr",f:function(e,t,n){return e.l++,Gr(e,0,n)}},26:{n:"PtgSheet",f:function(e,t,n){return e.l+=5,e.l+=2,e.l+=2==n.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,n){return e.l+=2==n.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,Xn[e._R(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e._R(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e._R(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Mn(e)}},32:{n:"PtgArray",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=2==n.biff?6:12==n.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,t,n){var r=(96&e[e.l])>>5,e=(e.l+=1,e._R(n&&n.biff<=3?1:2));return[el[e],Ja[e],r]}},34:{n:"PtgFuncVar",f:function(e,t,n){var r=e[e.l++],i=e._R(1),n=n&&n.biff<=3?[88==r?-1:0,e._R(1)]:[e[e.l+1]>>7,32767&e._R(2)];return[i,(0===n[0]?Ja:Qa)[n[1]]]}},35:{n:"PtgName",f:function(e,t,n){var r=e._R(1)>>>5&3,i=!n||8<=n.biff?4:2,i=e._R(i);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,i]}},36:{n:"PtgRef",f:function(e,t,n){var r=(96&e[e.l])>>5;return e.l+=1,[r,ya(e,0,n)]}},37:{n:"PtgArea",f:function(e,t,n){return[(96&e[e.l++])>>5,ga(e,2<=n.biff&&n.biff,n)]}},38:{n:"PtgMemArea",f:function(e,t,n){var r=e._R(1)>>>5&3;return e.l+=n&&2==n.biff?3:4,[r,e._R(n&&2==n.biff?1:2)]}},39:{n:"PtgMemErr",f:h},40:{n:"PtgMemNoMem",f:h},41:{n:"PtgMemFunc",f:function(e,t,n){return[e._R(1)>>>5&3,e._R(n&&2==n.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,n){var r=e._R(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,12==n.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=n&&8<n.biff?12:n.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,t,n){var r=(96&e[e.l])>>5;return e.l+=1,[r,function(e,t){var n,r;if(2<=(t=t&&t.biff?t.biff:8)&&t<=5)return s=(a=e)._R(2),a=a._R(1),n=(32768&s)>>15,r=(16384&s)>>14,s&=16383,1==n&&8192<=s&&(s-=16384),1==r&&128<=a&&(a-=256),{r:s,c:a,cRel:r,rRel:n};var i=e._R(12<=t?4:2),o=e._R(2),s=(16384&o)>>14,a=(32768&o)>>15;if(o&=16383,1==a)for(;524287<i;)i-=1048576;if(1==s)for(;8191<o;)o-=16384;return{r:i,c:o,cRel:s,rRel:a}}(e,n)]}},45:{n:"PtgAreaN",f:function(e,t,n){var r,i=(96&e[e.l++])>>5;return e=e,[i,(i=n).biff<8?ma(e):(n=e._R(12==i.biff?4:2),i=e._R(12==i.biff?4:2),r=pa(e,2),e=pa(e,2),{s:{r:n,c:r[0],cRel:r[1],rRel:r[2]},e:{r:i,c:e[0],cRel:e[1],rRel:e[2]}})]}},46:{n:"PtgMemAreaN",f:function(e){return[e._R(1)>>>5&3,e._R(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e._R(1)>>>5&3,e._R(2)]}},57:{n:"PtgNameX",f:function(e,t,n){var r,i,o;return 5==n.biff?(r=(n=e)._R(1)>>>5&3,i=n._R(2,"i"),n.l+=8,o=n._R(2),n.l+=12,[r,i,o]):[e._R(1)>>>5&3,e._R(2),e._R(4)]}},58:{n:"PtgRef3d",f:function(e,t,n){var r=(96&e[e.l])>>5,i=(e.l+=1,e._R(2));return n&&5==n.biff&&(e.l+=12),[r,i,ya(e,0,n)]}},59:{n:"PtgArea3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=e._R(2,"i");if(n)switch(n.biff){case 5:e.l+=12,0;break;case 12:0}return[r,i,ga(e,0,n)]}},60:{n:"PtgRefErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=e._R(2),o=4;if(n)switch(n.biff){case 5:o=15;break;case 12:o=6}return e.l+=o,[r,i]}},61:{n:"PtgAreaErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=e._R(2),o=8;if(n)switch(n.biff){case 5:e.l+=12,o=6;break;case 12:o=12}return e.l+=o,[r,i]}},255:{}},La={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61};for(ka in La)Da[ka]=Da[La[ka]];var Pa={1:{n:"PtgElfLel",f:Aa},2:{n:"PtgElfRw",f:Oa},3:{n:"PtgElfCol",f:wa},6:{n:"PtgElfRwV",f:Ia},7:{n:"PtgElfColV",f:Ra},10:{n:"PtgElfRadical",f:_a},11:{n:"PtgElfRadicalS",f:xa},13:{n:"PtgElfColS",f:Sa},15:{n:"PtgElfColSV",f:Ta},16:{n:"PtgElfRadicalLel",f:Na},25:{n:"PtgList",f:function(e){e.l+=2;var t=e._R(2),n=e._R(2),r=e._R(4),i=e._R(2),e=e._R(2);return{ixti:t,coltype:3&n,rt:Ma[n>>2&31],idx:r,c:i,C:e}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e._R(4)]}},255:{}},Fa={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=n&&2==n.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e._R(n&&2==n.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,n){e.l+=2;for(var r=e._R(n&&2==n.biff?1:2),i=[],o=0;o<=r;++o)i.push(e._R(n&&2==n.biff?1:2));return i}},8:{n:"PtgAttrGoto",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e._R(n&&2==n.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,n){e.l+=n&&2==n.biff?3:4}},32:{n:"PtgAttrBaxcel",f:function(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}},64:{n:"PtgAttrSpace",f:function(e){return e._R(2),va(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e._R(2),va(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e._R(2)]}},255:{}};function Ba(e,t,n,r){if(r.biff<8)return h(e,t);for(var i=e.l+t,o=[],s=0;s!==n.length;++s)switch(n[s][0]){case"PtgArray":n[s][1]=ba(e,0,r),o.push(n[s][1]);break;case"PtgMemArea":n[s][2]=function(e,t){for(var n=e._R(12==t.biff?4:2),r=[],i=0;i!=n;++i)r.push((12==t.biff?On:ii)(e,8));return r}(e,(n[s][1],r)),o.push(n[s][2]);break;case"PtgExp":r&&12==r.biff&&(n[s][1][1]=e._R(4),o.push(n[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[s][0]}return 0!==(t=i-e.l)&&o.push(h(e,t)),o}function Ha(e,t,n){for(var r,i,o=e.l+t,s=[];o!=e.l;)t=o-e.l,i=e[e.l],r=Da[i],(r=24!==i&&25!==i?r:(24===i?Pa:Fa)[e[e.l+1]])&&r.f?s.push([r.n,r.f(e,t,n)]):h(e,t);return s}Fa[33]=Fa[32];var Ua={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"},Va=new RegExp(/[^\w\u4E00-\u9FFF\u3040-\u30FF]/);function Wa(e,t,n){if(!e)return"SH33TJSERR0";if(8<n.biff&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return 1e4<t&&(t-=65536),0==(t=t<0?-t:t)?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var i="";if(8<n.biff)switch(e[r[0]][0]){case 357:return i=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 358:return null!=n.SID?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return i=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[r[0]][0][3]?(i=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function $a(e,t,n){e=Wa(e,t,n),t=n;if(e||t&&t.biff<=5&&2<=t.biff)return Va.test(e)?"'"+e+"'":e;throw new Error("empty sheet name")}function ja(e,t,n,r,i){var o,s,a=i&&i.biff||8,l={s:{c:0,r:0},e:{c:0,r:0}},u=[],c=0,d=0,h="";if(!e[0]||!e[0][0])return"";for(var f=-1,p="",g=0,m=e[0].length;g<m;++g){switch((x=e[0][g])[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(N=u.pop(),o=u.pop(),0<=f){switch(e[0][f][1][0]){case 0:p=Z(" ",e[0][f][1][1]);break;case 1:p=Z("\r",e[0][f][1][1]);break;default:if(p="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}o+=p,f=-1}u.push(o+Ua[x[0]]+N);break;case"PtgIsect":N=u.pop(),o=u.pop(),u.push(o+" "+N);break;case"PtgUnion":N=u.pop(),o=u.pop(),u.push(o+","+N);break;case"PtgRange":N=u.pop(),o=u.pop(),u.push(o+":"+N);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":break;case"PtgRef":y=Qt(x[1][1],l,i),u.push(en(y,a));break;case"PtgRefN":y=n?Qt(x[1][1],n,i):x[1][1],u.push(en(y,a));break;case"PtgRef3d":var c=x[1][1],y=Qt(x[1][2],l,i);h=$a(r,c,i);u.push(h+"!"+en(y,a));break;case"PtgFunc":case"PtgFuncVar":var v=x[1][0],b=x[1][1],v=v||0,E=0==(v&=127)?[]:u.slice(-v);u.length-=v,"User"===b&&(b=E.shift()),u.push(b+"("+E.join(",")+")");break;case"PtgBool":u.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(x[1]);break;case"PtgNum":u.push(String(x[1]));break;case"PtgStr":u.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(x[1]);break;case"PtgAreaN":s=Jt(x[1][1],n?{s:n}:l,i),u.push(tn(s,i));break;case"PtgArea":s=Jt(x[1][1],l,i),u.push(tn(s,i));break;case"PtgArea3d":c=x[1][1],s=x[1][2],h=$a(r,c,i),u.push(h+"!"+tn(s,i));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=x[1][2],v=(r.names||[])[d-1]||(r[0]||[])[d],b=v?v.Name:"SH33TJSNAME"+String(d);b in tl&&(b=tl[b]),u.push(b);break;case"PtgNameX":var C,w,E=x[1][1];d=x[1][2],i.biff<=5?(r[E=E<0?-E:E]&&(C=r[E][d]),u.push((C=C||{Name:"SH33TJSERRY"}).Name)):(w="",14849!=((r[E]||[])[0]||[])[0]&&(1025==((r[E]||[])[0]||[])[0]?r[E][d]&&0<r[E][d].itab&&(w=r.SheetNames[r[E][d].itab-1]+"!"):w=r.SheetNames[d-1]+"!"),r[E]&&r[E][d]?w+=r[E][d].Name:r[0]&&r[0][d]?w+=r[0][d].Name:(A=Wa(r,E,i).split(";;"))[d-1]?w=A[d-1]:w+="SH33TJSERRX",u.push(w));break;case"PtgParen":var S="(",T=")";if(0<=f){switch(p="",e[0][f][1][0]){case 2:S=Z(" ",e[0][f][1][1])+S;break;case 3:S=Z("\r",e[0][f][1][1])+S;break;case 4:T=Z(" ",e[0][f][1][1])+T;break;case 5:T=Z("\r",e[0][f][1][1])+T;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}f=-1}u.push(S+u.pop()+T);break;case"PtgRefErr":case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":y={c:x[1][1],r:x[1][0]};var R={c:n.c,r:n.r};if(r.sharedf[me(y)]){var A=r.sharedf[me(y)];u.push(ja(A,0,R,r,i))}else{for(var _=!1,N=0;N!=r.arrayf.length;++N)if(o=r.arrayf[N],!(y.c<o[0].s.c||y.c>o[0].e.c||y.r<o[0].s.r||y.r>o[0].e.r)){u.push(ja(o[1],0,R,r,i)),_=!0;break}_||u.push(x[1])}break;case"PtgArray":u.push("{"+function(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],i=[],o=0;o<r.length;++o){var s=r[o];s?2===s[0]?i.push('"'+s[1].replace(/"/g,'""')+'"'):i.push(s[1]):i.push("")}t.push(i.join(","))}return t.join(";")}(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":f=g;break;case"PtgTbl":case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(x))}if(3!=i.biff&&0<=f&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][g][0])){var x,O=!0;switch((x=e[0][f])[1][0]){case 4:O=!1;case 0:p=Z(" ",x[1][1]);break;case 5:O=!1;case 1:p=Z("\r",x[1][1]);break;default:if(p="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}u.push((O?p:"")+u.pop()+(O?"":p)),f=-1}}if(1<u.length&&i.WTF)throw new Error("bad formula stack");return u[0]}function za(e,t,n){var r,i,o,s,a,t=e.l+t,l=ti(e),u=(2==n.biff&&++e.l,function(e){var t;if(65535!==Ut(e,e.l+6))return[Mn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e)),c=e._R(1),e=(2!=n.biff&&(e._R(1),5<=n.biff)&&e._R(4),e=t-(t=e).l,n=n,o=t.l+e,s=2==n.biff?1:2,65535==(a=t._R(s))?[[],h(t,e-2)]:(i=Ha(t,a,n),e!==a+s&&(r=Ba(t,e-a-s,i,n)),t.l=o,[i,r]));return{cell:l,val:u[0],formula:e,shared:c>>3&1,tt:u[1]}}function Ga(e,t,n,r,i){for(var t=ni(t,n,i),i=null==(n=e.v)?((i=ee(8))._W(1,3),i._W(1,0),i._W(2,0),i._W(2,0),i._W(2,65535),i):kn("number"==typeof n?n:0),n=ee(6),o=(n._W(2,33),n._W(4,0),ee(e.bf.length)),s=0;s<e.bf.length;++s)o[s]=e.bf[s];return we([t,i,n,o])}function Ya(e,t,n){var r=e._R(4),r=Ha(e,r,n),i=e._R(4);return[r,0<i?Ba(e,i,r,n):null]}var Xa=Ya,Ka=Ya,qa=Ya,Za=Ya,Qa={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ja={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},el={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0},tl={"_xlfn.ACOT":"ACOT","_xlfn.ACOTH":"ACOTH","_xlfn.AGGREGATE":"AGGREGATE","_xlfn.ARABIC":"ARABIC","_xlfn.AVERAGEIF":"AVERAGEIF","_xlfn.AVERAGEIFS":"AVERAGEIFS","_xlfn.BASE":"BASE","_xlfn.BETA.DIST":"BETA.DIST","_xlfn.BETA.INV":"BETA.INV","_xlfn.BINOM.DIST":"BINOM.DIST","_xlfn.BINOM.DIST.RANGE":"BINOM.DIST.RANGE","_xlfn.BINOM.INV":"BINOM.INV","_xlfn.BITAND":"BITAND","_xlfn.BITLSHIFT":"BITLSHIFT","_xlfn.BITOR":"BITOR","_xlfn.BITRSHIFT":"BITRSHIFT","_xlfn.BITXOR":"BITXOR","_xlfn.CEILING.MATH":"CEILING.MATH","_xlfn.CEILING.PRECISE":"CEILING.PRECISE","_xlfn.CHISQ.DIST":"CHISQ.DIST","_xlfn.CHISQ.DIST.RT":"CHISQ.DIST.RT","_xlfn.CHISQ.INV":"CHISQ.INV","_xlfn.CHISQ.INV.RT":"CHISQ.INV.RT","_xlfn.CHISQ.TEST":"CHISQ.TEST","_xlfn.COMBINA":"COMBINA","_xlfn.CONCAT":"CONCAT","_xlfn.CONFIDENCE.NORM":"CONFIDENCE.NORM","_xlfn.CONFIDENCE.T":"CONFIDENCE.T","_xlfn.COT":"COT","_xlfn.COTH":"COTH","_xlfn.COUNTIFS":"COUNTIFS","_xlfn.COVARIANCE.P":"COVARIANCE.P","_xlfn.COVARIANCE.S":"COVARIANCE.S","_xlfn.CSC":"CSC","_xlfn.CSCH":"CSCH","_xlfn.DAYS":"DAYS","_xlfn.DECIMAL":"DECIMAL","_xlfn.ECMA.CEILING":"ECMA.CEILING","_xlfn.ERF.PRECISE":"ERF.PRECISE","_xlfn.ERFC.PRECISE":"ERFC.PRECISE","_xlfn.EXPON.DIST":"EXPON.DIST","_xlfn.F.DIST":"F.DIST","_xlfn.F.DIST.RT":"F.DIST.RT","_xlfn.F.INV":"F.INV","_xlfn.F.INV.RT":"F.INV.RT","_xlfn.F.TEST":"F.TEST","_xlfn.FILTERXML":"FILTERXML","_xlfn.FLOOR.MATH":"FLOOR.MATH","_xlfn.FLOOR.PRECISE":"FLOOR.PRECISE","_xlfn.FORECAST.ETS":"FORECAST.ETS","_xlfn.FORECAST.ETS.CONFINT":"FORECAST.ETS.CONFINT","_xlfn.FORECAST.ETS.SEASONALITY":"FORECAST.ETS.SEASONALITY","_xlfn.FORECAST.ETS.STAT":"FORECAST.ETS.STAT","_xlfn.FORECAST.LINEAR":"FORECAST.LINEAR","_xlfn.FORMULATEXT":"FORMULATEXT","_xlfn.GAMMA":"GAMMA","_xlfn.GAMMA.DIST":"GAMMA.DIST","_xlfn.GAMMA.INV":"GAMMA.INV","_xlfn.GAMMALN.PRECISE":"GAMMALN.PRECISE","_xlfn.GAUSS":"GAUSS","_xlfn.HYPGEOM.DIST":"HYPGEOM.DIST","_xlfn.IFERROR":"IFERROR","_xlfn.IFNA":"IFNA","_xlfn.IFS":"IFS","_xlfn.IMCOSH":"IMCOSH","_xlfn.IMCOT":"IMCOT","_xlfn.IMCSC":"IMCSC","_xlfn.IMCSCH":"IMCSCH","_xlfn.IMSEC":"IMSEC","_xlfn.IMSECH":"IMSECH","_xlfn.IMSINH":"IMSINH","_xlfn.IMTAN":"IMTAN","_xlfn.ISFORMULA":"ISFORMULA","_xlfn.ISO.CEILING":"ISO.CEILING","_xlfn.ISOWEEKNUM":"ISOWEEKNUM","_xlfn.LOGNORM.DIST":"LOGNORM.DIST","_xlfn.LOGNORM.INV":"LOGNORM.INV","_xlfn.MAXIFS":"MAXIFS","_xlfn.MINIFS":"MINIFS","_xlfn.MODE.MULT":"MODE.MULT","_xlfn.MODE.SNGL":"MODE.SNGL","_xlfn.MUNIT":"MUNIT","_xlfn.NEGBINOM.DIST":"NEGBINOM.DIST","_xlfn.NETWORKDAYS.INTL":"NETWORKDAYS.INTL","_xlfn.NIGBINOM":"NIGBINOM","_xlfn.NORM.DIST":"NORM.DIST","_xlfn.NORM.INV":"NORM.INV","_xlfn.NORM.S.DIST":"NORM.S.DIST","_xlfn.NORM.S.INV":"NORM.S.INV","_xlfn.NUMBERVALUE":"NUMBERVALUE","_xlfn.PDURATION":"PDURATION","_xlfn.PERCENTILE.EXC":"PERCENTILE.EXC","_xlfn.PERCENTILE.INC":"PERCENTILE.INC","_xlfn.PERCENTRANK.EXC":"PERCENTRANK.EXC","_xlfn.PERCENTRANK.INC":"PERCENTRANK.INC","_xlfn.PERMUTATIONA":"PERMUTATIONA","_xlfn.PHI":"PHI","_xlfn.POISSON.DIST":"POISSON.DIST","_xlfn.QUARTILE.EXC":"QUARTILE.EXC","_xlfn.QUARTILE.INC":"QUARTILE.INC","_xlfn.QUERYSTRING":"QUERYSTRING","_xlfn.RANK.AVG":"RANK.AVG","_xlfn.RANK.EQ":"RANK.EQ","_xlfn.RRI":"RRI","_xlfn.SEC":"SEC","_xlfn.SECH":"SECH","_xlfn.SHEET":"SHEET","_xlfn.SHEETS":"SHEETS","_xlfn.SKEW.P":"SKEW.P","_xlfn.STDEV.P":"STDEV.P","_xlfn.STDEV.S":"STDEV.S","_xlfn.SUMIFS":"SUMIFS","_xlfn.SWITCH":"SWITCH","_xlfn.T.DIST":"T.DIST","_xlfn.T.DIST.2T":"T.DIST.2T","_xlfn.T.DIST.RT":"T.DIST.RT","_xlfn.T.INV":"T.INV","_xlfn.T.INV.2T":"T.INV.2T","_xlfn.T.TEST":"T.TEST","_xlfn.TEXTJOIN":"TEXTJOIN","_xlfn.UNICHAR":"UNICHAR","_xlfn.UNICODE":"UNICODE","_xlfn.VAR.P":"VAR.P","_xlfn.VAR.S":"VAR.S","_xlfn.WEBSERVICE":"WEBSERVICE","_xlfn.WEIBULL.DIST":"WEIBULL.DIST","_xlfn.WORKDAY.INTL":"WORKDAY.INTL","_xlfn.XOR":"XOR","_xlfn.Z.TEST":"Z.TEST"};function nl(e){return(e=(e=(e=(e=61==(e="of:"==e.slice(0,3)?e.slice(3):e).charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)?e.slice(1):e).replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function rl(e){e=e.split(":");return[e[0].split(".")[0],e[0].split(".")[1]+(1<e.length?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var il={},ol={},sl=(M.WS=["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],"undefined"!=typeof Map);function al(e,t,n){var r=0,i=e.length;if(n){if(sl?n.has(t):Object.prototype.hasOwnProperty.call(n,t))for(var o=sl?n.get(t):n[t];r<o.length;++r)if(e[o[r]].t===t)return e.Count++,o[r]}else for(;r<i;++r)if(e[r].t===t)return e.Count++,r;return e[i]={t:t},e.Count++,e.Unique++,n&&(sl?(n.has(t)||n.set(t,[]),n.get(t)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t])).push(i),i}function ll(e,t){var e={min:e+1,max:e+1},n=-1;return t.MDW&&(ls=t.MDW),null!=t.width?e.customWidth=1:null!=t.wpx?n=cs(t.wpx):null!=t.wch&&(n=t.wch),-1<n?(e.width=ds(n),e.customWidth=1):null!=t.width&&(e.width=t.width),t.hidden&&(e.hidden=!0),e}function ul(e,t){e&&(t="xlml"==t?[1,1,1,1,.5,.5]:[.7,.7,.75,.75,.3,.3],null==e.left&&(e.left=t[0]),null==e.right&&(e.right=t[1]),null==e.top&&(e.top=t[2]),null==e.bottom&&(e.bottom=t[3]),null==e.header&&(e.header=t[4]),null==e.footer)&&(e.footer=t[5])}function cl(e,t,n){var r=n.revssf[null!=t.z?t.z:"General"],i=60,o=e.length;if(null==r&&n.ssf)for(;i<392;++i)if(null==n.ssf[i]){le.load(t.z,i),n.ssf[i]=t.z,n.revssf[t.z]=r=i;break}for(i=0;i!=o;++i)if(e[i].numFmtId===r)return i;return e[o]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function dl(e,t,n,r,i,o){try{r.cellNF&&(e.z=le._table[t])}catch(e){if(r.WTF)throw e}if("z"!==e.t){if("d"===e.t&&"string"==typeof e.v&&(e.v=oe(e.v)),!r||!1!==r.cellText)try{if(null==le._table[t]&&le.load(l[t]||"General",t),"e"===e.t)e.w=e.w||Xn[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=le._general_int(e.v):e.w=le._general_num(e.v);else if("d"===e.t){var s=j(e.v);e.w=(0|s)===s?le._general_int(s):le._general_num(s)}else{if(void 0===e.v)return;e.w=le._general(e.v,ol)}else"d"===e.t?e.w=le.format(t,j(e.v),ol):e.w=le.format(t,e.v,ol)}catch(e){if(r.WTF)throw e}if(r.cellStyles&&null!=n)try{e.s=o.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=is(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF)&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=is(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF)&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb)}catch(e){if(r.WTF&&o.Fills)throw e}}}var hl=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,fl=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,pl=/<(?:\w:)?hyperlink [^>]*>/gm,gl=/"(\w*:\w*)"/,ml=/<(?:\w:)?col\b[^>]*[\/]?>/g,yl=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,vl=/<(?:\w:)?pageMargins[^>]*\/>/g,bl=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,El=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Cl(e,t,n,r,i,o,s){if(!e)return e;r=r||{"!id":{}},null!=ae&&null==t.dense&&(t.dense=ae);var a=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",c="",d=e.match(fl),e=(d?(u=e.slice(0,d.index),c=e.slice(d.index+d[0].length)):u=c=e,u.match(bl)),h=(e&&wl(e[0],0,i,n),(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index),n=(0<h&&(e=u.slice(h,h+50).match(gl))&&(n=a,(e=ve(e=e[1])).s.r<=e.e.r)&&e.s.c<=e.e.c&&0<=e.s.r&&0<=e.s.c&&(n["!ref"]=ye(e)),u.match(El));if(n&&n[1]){var e=n[1],f=i;f.Views||(f.Views=[{}]),(e.match(Rl)||[]).forEach(function(e,t){e=se(e);f.Views[t]||(f.Views[t]={}),de(e.rightToLeft)&&(f.Views[t].RTL=!0)})}n=[];if(t.cellStyles){i=u.match(ml);if(i)for(var p=n,g=i,m=!1,y=0;y!=g.length;++y){var v=se(g[y],!0),b=(v.hidden&&(v.hidden=de(v.hidden)),parseInt(v.min,10)-1),E=parseInt(v.max,10)-1;for(delete v.min,delete v.max,v.width=+v.width,!m&&v.width&&(m=!0,fs(v.width)),ps(v);b<=E;)p[b++]=_e(v)}}d&&kl(d[1],a,t,l,o,s);var e=c.match(yl),C=(e&&(a["!autofilter"]={ref:(e[0].match(/ref="([^"]*)"/)||[])[1]}),[]),w=c.match(hl);if(w)for(h=0;h!=w.length;++h)C[h]=ve(w[h].slice(w[h].indexOf('"')+1));var S,T,u=c.match(pl),i=(u&&!function(e,t,n){for(var r=Array.isArray(e),i=0;i!=t.length;++i){var o=se(he(t[i]),!0);if(!o.ref)return;for(var s=((n||{})["!id"]||[])[o.id],a=(s?(o.Target=s.Target,o.location&&(o.Target+="#"+o.location)):(o.Target="#"+o.location,s={Target:o.Target,TargetMode:"Internal"}),o.Rel=s,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip),ve(o.ref)),l=a.s.r;l<=a.e.r;++l)for(var u=a.s.c;u<=a.e.c;++u){var c=me({c:u,r:l});r?(e[l]||(e[l]=[]),e[l][u]||(e[l][u]={t:"z",v:void 0}),e[l][u].l=o):(e[c]||(e[c]={t:"z",v:void 0}),e[c].l=o)}}}(a,u,r),c.match(vl));return i&&(a["!margins"]=(S=se(i[0]),T={},["left","right","top","bottom","header","footer"].forEach(function(e){S[e]&&(T[e]=parseFloat(S[e]))}),T)),!a["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(a["!ref"]=ye(l)),0<t.sheetRows&&a["!ref"]&&(d=ve(a["!ref"]),t.sheetRows<=+d.e.r)&&(d.e.r=t.sheetRows-1,d.e.r>l.e.r&&(d.e.r=l.e.r),d.e.r<d.s.r&&(d.s.r=d.e.r),d.e.c>l.e.c&&(d.e.c=l.e.c),d.e.c<d.s.c&&(d.s.c=d.e.c),a["!fullref"]=a["!ref"],a["!ref"]=ye(d)),0<n.length&&(a["!cols"]=n),0<C.length&&(a["!merges"]=C),a}function wl(e,t,n,r){e=se(e);n.Sheets[r]||(n.Sheets[r]={}),e.codeName&&(n.Sheets[r].CodeName=e.codeName)}var Sl=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Tl=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];var Rl=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;Al=/<(?:\w+:)?c[ >]/,_l=/<\/(?:\w+:)?row>/,Nl=/r=["']([^"']*)["']/,xl=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,Ol=/ref=["']([^"']*)["']/,Il=at("v"),Ml=at("f");var Al,_l,Nl,xl,Ol,Il,Ml,kl=function(e,t,n,r,i,o){for(var s,a,l,u,c=0,d="",h=[],f=[],p=0,g=0,m="",y=0,v=0,b=0,E=0,C=Array.isArray(o.CellXf),w=[],S=[],P=Array.isArray(t),T=[],R={},A=!1,_=!!n.sheetStubs,N=e.split(_l),x=0,F=N.length;x!=F;++x){var O=(d=N[x].trim()).length;if(0!==O){for(c=0;c<O&&62!==d.charCodeAt(c);++c);if(++c,y=null!=(l=se(d.slice(0,c),!0)).r?parseInt(l.r,10):y+1,v=-1,!(n.sheetRows&&n.sheetRows<y)){r.s.r>y-1&&(r.s.r=y-1),r.e.r<y-1&&(r.e.r=y-1),n&&n.cellStyles&&(A=!(R={}),l.ht&&(A=!0,R.hpt=parseFloat(l.ht),R.hpx=ys(R.hpt)),"1"==l.hidden&&(R.hidden=A=!0),null!=l.outlineLevel&&(A=!0,R.level=+l.outlineLevel),A)&&(T[y-1]=R);for(var h=d.slice(c).split(Al),I=0;I!=h.length&&"<"==h[I].trim().charAt(0);++I);for(h=h.slice(I),c=0;c!=h.length;++c)if(0!==(d=h[c].trim()).length){if(f=d.match(Nl),p=c,d="<c "+("<"==d.slice(g=0,1)?">":"")+d,null!=f&&2===f.length){for(m=f[1],g=p=0;g!=m.length&&!((s=m.charCodeAt(g)-64)<1||26<s);++g)p=26*p+s;v=--p}else++v;for(g=0;g!=d.length&&62!==d.charCodeAt(g);++g);if(++g,(l=se(d.slice(0,g),!0)).r||(l.r=me({r:y-1,c:v})),a={t:""},null!=(f=(m=d.slice(g)).match(Il))&&""!==f[1]&&(a.v=ce(f[1])),n.cellFormula){null!=(f=m.match(Ml))&&""!==f[1]?(a.f=ce(he(f[1])).replace(/\r\n/g,"\n"),n.xlfn||(a.f=fa(a.f)),-1<f[0].indexOf('t="array"')?(a.F=(m.match(Ol)||[])[1],-1<a.F.indexOf(":")&&w.push([ve(a.F),a.F])):-1<f[0].indexOf('t="shared"')&&(M=se(f[0]),L=ce(he(f[1])),n.xlfn||(L=fa(L)),S[parseInt(M.si,10)]=[M,L,l.r])):(f=m.match(/<f[^>]*\/>/))&&S[(M=se(f[0])).si]&&(a.f=ha(S[M.si][1],S[M.si][2],l.r));for(var M,k=B(l.r),g=0;g<w.length;++g)k.r>=w[g][0].s.r&&k.r<=w[g][0].e.r&&k.c>=w[g][0].s.c&&k.c<=w[g][0].e.c&&(a.F=w[g][1])}if(null==l.t&&void 0===a.v)if(a.f||a.F)a.v=0,a.t="n";else{if(!_)continue;a.t="z"}else a.t=l.t||"n";switch(r.s.c>v&&(r.s.c=v),r.e.c<v&&(r.e.c=v),a.t){case"n":if(""==a.v||null==a.v){if(!_)continue;a.t="z"}else a.v=parseFloat(a.v);break;case"s":if(void 0===a.v){if(!_)continue;a.t="z"}else u=il[parseInt(a.v,10)],a.v=u.t,a.r=u.r,n.cellHTML&&(a.h=u.h);break;case"str":a.t="s",a.v=null!=a.v?he(a.v):"",n.cellHTML&&(a.h=Qe(a.v));break;case"inlineStr":f=m.match(xl),a.t="s",null!=f&&(u=Oo(f[1]))?(a.v=u.t,n.cellHTML&&(a.h=u.h)):a.v="";break;case"b":a.v=de(a.v);break;case"d":n.cellDates?a.v=oe(a.v,1):(a.v=j(oe(a.v,1)),a.t="n");break;case"e":n&&!1===n.cellText||(a.w=a.v),a.v=Kn[a.v]}var D,L,b=E=0;C&&void 0!==l.s&&null!=(L=o.CellXf[l.s])&&(null!=L.numFmtId&&(b=L.numFmtId),n.cellStyles)&&null!=L.fillId&&(E=L.fillId),dl(a,b,E,n,i,o),n.cellDates&&C&&"n"==a.t&&le.is_date(le._table[b])&&(a.t="d",a.v=Y(a.v)),P?(t[(D=B(l.r)).r]||(t[D.r]=[]),t[D.r][D.c]=a):t[l.r]=a}}}}0<T.length&&(t["!rows"]=T)};function Dl(e,t){for(var n,r,i=[],o=[],s=ve(e["!ref"]),a=[],l=0,u=0,c=e["!rows"],d=Array.isArray(e),h={r:""},f=-1,u=s.s.c;u<=s.e.c;++u)a[u]=ge(u);for(l=s.s.r;l<=s.e.r;++l){for(o=[],n=pe(l),u=s.s.c;u<=s.e.c;++u){var p=a[u]+n,g=d?(e[l]||[])[u]:e[p];void 0!==g&&null!=(g=function(e,t,n,r){if(void 0===e.v&&"string"!=typeof e.f||"z"===e.t)return"";var i="",o=e.t,s=e.v;if("z"!==e.t)switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Xn[e.v];break;case"d":i=r&&r.cellDates?oe(e.v,-1).toISOString():((e=_e(e)).t="n",""+(e.v=j(oe(e.v)))),void 0===e.z&&(e.z=le._table[14]);break;default:i=e.v}var a=pt("v",_(i)),l={r:t},u=cl(r.cellXfs,e,r);switch(0!==u&&(l.s=u),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:null==e.v?delete e.t:r&&r.bookSST?(a=pt("v",""+al(r.Strings,e.v,r.revStrings)),l.t="s"):l.t="str"}return e.t!=o&&(e.t=o,e.v=s),"string"==typeof e.f&&e.f&&(u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null,a=N("f",_(e.f),u)+(null!=e.v?a:"")),e.l&&n["!links"].push([t,e.l]),e.c&&n["!comments"].push([t,e.c]),N("c",a,l)}(g,p,e,t))&&o.push(g)}(0<o.length||c&&c[l])&&(h={r:n},c&&c[l]&&((r=c[l]).hidden&&(h.hidden=1),f=-1,r.hpx?f=ms(r.hpx):r.hpt&&(f=r.hpt),-1<f&&(h.ht=f,h.customHeight=1),r.level)&&(h.outlineLevel=r.level),i[i.length]=N("row",o.join(""),h))}if(c)for(;l<c.length;++l)c&&c[l]&&(h={r:l+1},(r=c[l]).hidden&&(h.hidden=1),f=-1,r.hpx?f=ms(r.hpx):r.hpt&&(f=r.hpt),-1<f&&(h.ht=f,h.customHeight=1),r.level&&(h.outlineLevel=r.level),i[i.length]=N("row","",h));return i.join("")}var Ll=N("worksheet",null,{xmlns:I.main[0],"xmlns:r":I.r});function Pl(e,t,n,r){var i=[A,Ll],o=n.SheetNames[e],o=n.Sheets[o],s=(o=null==o?{}:o)["!ref"]||"A1",a=ve(s);if(16383<a.e.c||1048575<a.e.r){if(t.WTF)throw new Error("Range "+s+" exceeds format limit A1:XFD1048576");a.e.c=Math.min(a.e.c,16383),a.e.r=Math.min(a.e.c,1048575),s=ye(a)}r=r||{},o["!comments"]=[];var l,u,a=[],c=n,d=e,h=t,f=i,p=!1,g={};if("xlsx"!==h.bookType&&c.vbaraw){h=c.SheetNames[d];try{c.Workbook&&(h=c.Workbook.Sheets[d].CodeName||h)}catch(e){}p=!0,g.codeName=_(h)}p&&(f[f.length]=N("sheetPr",null,g)),i[i.length]=N("dimension",null,{ref:s}),i[i.length]=(c={workbookViewId:"0"},((((d=n)||{}).Workbook||{}).Views||[])[0]&&(c.rightToLeft=d.Workbook.Views[0].RTL?"1":"0"),N("sheetViews",N("sheetView",null,c),{})),t.sheetFormat&&(i[i.length]=N("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=o["!cols"]&&0<o["!cols"].length&&(i[i.length]=function(e){for(var t,n=["<cols>"],r=0;r!=e.length;++r)(t=e[r])&&(n[n.length]=N("col",null,ll(r,t)));return n[n.length]="</cols>",n.join("")}(o["!cols"])),i[h=i.length]="<sheetData/>",o["!links"]=[],null!=o["!ref"]&&0<(p=Dl(o,t)).length&&(i[i.length]=p),i.length>h+1&&(i[i.length]="</sheetData>",i[h]=i[h].replace("/>",">")),null!=o["!protect"]&&(i[i.length]=(l=o["!protect"],u={sheet:1},Sl.forEach(function(e){null!=l[e]&&l[e]&&(u[e]="1")}),Tl.forEach(function(e){null==l[e]||l[e]||(u[e]="0")}),l.password&&(u.password=zo(l.password).toString(16).toUpperCase()),N("sheetProtection",null,u))),null!=o["!autofilter"]&&(i[i.length]=function(e,t,n,r){var i="string"==typeof e.ref?e.ref:ye(e.ref),o=(n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]),n.Workbook.Names);(e=an(i)).s.r==e.e.r&&(e.e.r=an(t["!ref"]).e.r,i=ye(e));for(var s=0;s<o.length;++s){var a=o[s];if("_xlnm._FilterDatabase"==a.Name&&a.Sheet==r){a.Ref="'"+n.SheetNames[r]+"'!"+i;break}}return s==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),N("autoFilter",null,{ref:i})}(o["!autofilter"],o,n,e)),null!=o["!merges"]&&0<o["!merges"].length&&(i[i.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+ye(e[n])+'"/>';return t+"</mergeCells>"}(o["!merges"]));var m,y,v=-1;return 0<o["!links"].length&&(i[i.length]="<hyperlinks>",o["!links"].forEach(function(e){e[1].Target&&(y={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(v=lr(r,-1,_(e[1].Target).replace(/#.*$/,""),M.HLINK),y["r:id"]="rId"+v),-1<(m=e[1].Target.indexOf("#"))&&(y.location=_(e[1].Target.slice(m+1))),e[1].Tooltip&&(y.tooltip=_(e[1].Tooltip)),i[i.length]=N("hyperlink",null,y))}),i[i.length]="</hyperlinks>"),delete o["!links"],null!=o["!margins"]&&(i[i.length]=(ul(f=o["!margins"]),N("pageMargins",null,f))),t&&!t.ignoreEC&&null!=t.ignoreEC||(i[i.length]=pt("ignoredErrors",N("ignoredError",null,{numberStoredAsText:1,sqref:s}))),0<a.length&&(v=lr(r,-1,"../drawings/drawing"+(e+1)+".xml",M.DRAW),i[i.length]=N("drawing",null,{"r:id":"rId"+v}),o["!drawing"]=a),0<o["!comments"].length&&(v=lr(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",M.VML),i[i.length]=N("legacyDrawing",null,{"r:id":"rId"+v}),o["!legacy"]=v),1<i.length&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Fl(e,t,n,r){n=function(e,t,n){for(var r=ee(145),i=(n["!rows"]||[])[e]||{},o=(r._W(4,e),r._W(4,0),320),o=(i.hpx?o=20*ms(i.hpx):i.hpt&&(o=20*i.hpt),r._W(2,o),r._W(1,0),0),s=(i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),r._W(1,o),r._W(1,0),0),i=r.l,a=(r.l+=4,{r:e,c:0}),l=0;l<16;++l)if(!(t.s.c>l+1<<10||t.e.c<l<<10)){for(var u=-1,c=-1,d=l<<10;d<l+1<<10;++d)a.c=d,(Array.isArray(n)?(n[a.r]||[])[a.c]:n[me(a)])&&(u<0&&(u=d),c=d);u<0||(++s,r._W(4,u),r._W(4,c))}return o=r.l,r.l=i,r._W(4,s),r.l=o,r.length>r.l?r.slice(0,r.l):r}(r,n,t);(17<n.length||(t["!rows"]||[])[r])&&x(e,"BrtRowHdr",n)}var Oa=On,Bl=In;function Hl(e,t,n){En(t,n=null==n?ee(12):n);var t=e.v,e=n,r=(null==e&&(e=ee(4)),0),i=0,o=100*t;if(t==(0|t)&&-(1<<29)<=t&&t<1<<29?i=1:o==(0|o)&&-(1<<29)<=o&&o<1<<29&&(r=i=1),i)return e._W(-4,((r?o:t)<<2)+(r+2)),n;throw new Error("unsupported RkNumber "+t)}var wa=On,Ul=In;var Vl=["left","right","top","bottom","header","footer"];function Wl(e,t,n,r,i,o){if(void 0!==t.v){var s="";switch(t.t){case"b":s=t.v?"1":"0";break;case"d":(t=_e(t)).z=t.z||le._table[14],t.v=j(oe(t.v)),t.t="n";break;case"n":case"e":s=""+t.v;break;default:s=t.v}var a,l,u,c,d,h,f,p={r:n,c:r};switch(p.s=cl(i.cellXfs,t,i),t.l&&o["!links"].push([me(p),t.l]),t.c&&o["!comments"].push([me(p),t.c]),t.t){case"s":case"str":return void(i.bookSST?(s=al(i.Strings,t.v,i.revStrings),p.t="s",p.v=s,x(e,"BrtCellIsst",(En(d=p,h=null==h?ee(12):h),h._W(4,d.v),h))):(p.t="str",x(e,"BrtCellSt",(d=t,En(p,c=null==c?ee(12+4*d.v.length):c),gn(d.v,c),c.length>c.l?c.slice(0,c.l):c))));case"n":return void(t.v==(0|t.v)&&-1e3<t.v&&t.v<1e3?x(e,"BrtCellRk",Hl(t,p)):x(e,"BrtCellReal",(l=t,En(p,u=null==u?ee(16):u),kn(l.v,u),u)));case"b":return p.t="b",void x(e,"BrtCellBool",(l=t,En(p,a=null==a?ee(9):a),a._W(1,l.v?1:0),a));case"e":p.t="e"}x(e,"BrtCellBlank",En(p,f=null==f?ee(8):f))}}function $l(t,e){var n,r;e&&e["!merges"]&&(x(t,"BrtBeginMergeCells",(n=e["!merges"].length,(r=null==r?ee(4):r)._W(4,n),r)),e["!merges"].forEach(function(e){x(t,"BrtMergeCell",Ul(e))}),x(t,"BrtEndMergeCells"))}function jl(i,e){e&&e["!cols"]&&(x(i,"BrtBeginColInfos"),e["!cols"].forEach(function(e,t){var n,r;e&&x(i,"BrtColInfo",(t=t,e=e,null==n&&(n=ee(18)),r=ll(t,e),n._W(-4,t),n._W(-4,t),n._W(4,256*(r.width||10)),n._W(4,0),t=0,e.hidden&&(t|=1),"number"==typeof r.width&&(t|=2),e.level&&(t|=e.level<<8),n._W(2,t),n))}),x(i,"BrtEndColInfos"))}function zl(e,t){var n;t&&t["!ref"]&&(x(e,"BrtBeginCellIgnoreECs"),x(e,"BrtCellIgnoreEC",(t=ve(t["!ref"]),(n=ee(24))._W(4,4),n._W(4,1),In(t,n),n)),x(e,"BrtEndCellIgnoreECs"))}function Gl(r,e,i){e["!links"].forEach(function(e){var t,n;e[1].Target&&(t=lr(i,-1,e[1].Target.replace(/#.*$/,""),M.HLINK),x(r,"BrtHLink",(t=t,n=ee(50+4*((e=e)[1].Target.length+(e[1].Tooltip||"").length)),In({s:B(e[0]),e:B(e[0])},n),_n("rId"+t,n),gn((-1==(t=e[1].Target.indexOf("#"))?"":e[1].Target.slice(t+1))||"",n),gn(e[1].Tooltip||"",n),gn("",n),n.slice(0,n.l))))}),delete e["!links"]}function Yl(e,t,n){var r,i;x(e,"BrtBeginWsViews"),x(e,"BrtBeginWsView",(n=n,null==r&&(r=ee(30)),i=924,(((n||{}).Views||[])[0]||{}).RTL&&(i|=32),r._W(2,i),r._W(4,0),r._W(4,0),r._W(4,0),r._W(1,0),r._W(1,0),r._W(2,0),r._W(2,100),r._W(2,0),r._W(2,0),r._W(2,0),r._W(4,0),r)),x(e,"BrtEndWsView"),x(e,"BrtEndWsViews")}function Xl(e,t){var n,r;t["!protect"]&&x(e,"BrtSheetProtection",(n=t["!protect"],(r=null==r?ee(66):r)._W(2,n.password?zo(n.password):0),r._W(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?r._W(4,null==n[e[0]]||n[e[0]]?0:1):r._W(4,null!=n[e[0]]&&n[e[0]]?0:1)}),r))}function Kl(e,t,n,r){var i=Zt(),o=n.SheetNames[e],s=n.Sheets[o]||{};try{n&&n.Workbook&&(o=n.Workbook.Sheets[e].CodeName||o)}catch(e){}var a,l,u=ve(s["!ref"]||"A1");if(16383<u.e.c||1048575<u.e.r){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}s["!links"]=[],s["!comments"]=[],x(i,"BrtBeginSheet"),n.vbaraw&&x(i,"BrtWsProp",function(e,t){null==t&&(t=ee(84+4*e.length));for(var n=0;n<3;++n)t._W(1,0);return Dn({auto:1},t),t._W(-4,-1),t._W(-4,-1),wn(e,t),t.slice(0,t.l)}(o)),x(i,"BrtWsDim",Bl(u)),Yl(i,0,n.Workbook),jl(i,s);var c,d=i,h=s,f=t,p=ve(h["!ref"]||"A1"),g=[],m=(x(d,"BrtBeginSheetData"),Array.isArray(h)),y=p.e.r;h["!rows"]&&(y=Math.max(p.e.r,h["!rows"].length-1));for(var v=p.s.r;v<=y;++v)if(c=pe(v),Fl(d,h,p,v),v<=p.e.r)for(var b=p.s.c;b<=p.e.c;++b){v===p.s.r&&(g[b]=ge(b));var E=m?(h[v]||[])[b]:h[g[b]+c];E&&Wl(d,E,v,b,f,h)}x(d,"BrtEndSheetData"),Xl(i,s);var o=i,u=s,C=n,w=e;if(u["!autofilter"]){var n=u["!autofilter"],S="string"==typeof n.ref?n.ref:ye(n.ref),T=(C.Workbook||(C.Workbook={Sheets:[]}),C.Workbook.Names||(C.Workbook.Names=[]),C.Workbook.Names),n=an(S);n.s.r==n.e.r&&(n.e.r=an(u["!ref"]).e.r,S=ye(n));for(var R=0;R<T.length;++R){var A=T[R];if("_xlnm._FilterDatabase"==A.Name&&A.Sheet==w){A.Ref="'"+C.SheetNames[w]+"'!"+S;break}}R==T.length&&T.push({Name:"_xlnm._FilterDatabase",Sheet:w,Ref:"'"+C.SheetNames[w]+"'!"+S}),x(o,"BrtBeginAFilter",In(ve(S))),x(o,"BrtEndAFilter")}return $l(i,s),Gl(i,s,r),s["!margins"]&&x(i,"BrtMargins",(a=s["!margins"],null==l&&(l=ee(48)),ul(a),Vl.forEach(function(e){kn(a[e],l)}),l)),t&&!t.ignoreEC&&null!=t.ignoreEC||zl(i,s),u=i,n=e,o=r,0<(t=s)["!comments"].length&&(o=lr(o,-1,"../drawings/vmlDrawing"+(n+1)+".vml",M.VML),x(u,"BrtLegacyDrawing",_n("rId"+o)),t["!legacy"]=o),x(i,"BrtEndSheet"),i.end()}function ql(e,t,n,r,i,o){var s,a,l,u,c=o||{"!type":"chart"};return e?(l="A",u={s:{r:2e6,c:2e6},e:{r:a=s=0,c:0}},(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){n=[],r=(e=e).match(/^<c:numCache>/),(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){e=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);e&&(n[+e[1]]=r?+e[2]:e[2])}),i=ce((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]),(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){t=e.replace(/<.*?>/g,"")});var t,n,r,i,o=[n,i,t];u.s.r=u.s.c=0,u.e.c=s,l=ge(s),o[0].forEach(function(e,t){c[l+pe(t)]={t:"n",v:e,z:o[1]},a=t}),u.e.r<a&&(u.e.r=a),++s}),0<s&&(c["!ref"]=ye(u)),c):o}M.CHART="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",M.CHARTEX="http://schemas.microsoft.com/office/2014/relationships/chartEx",M.CS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet";N("chartsheet",null,{xmlns:I.main[0],"xmlns:r":I.r});var Zl=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Ql=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Jl=[],eu=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function tu(e,t){for(var n=0;n!=e.length;++n)for(var r=e[n],i=0;i!=t.length;++i){var o=t[i];if(null==r[o[0]])r[o[0]]=o[1];else switch(o[2]){case"bool":"string"==typeof r[o[0]]&&(r[o[0]]=de(r[o[0]]));break;case"int":"string"==typeof r[o[0]]&&(r[o[0]]=parseInt(r[o[0]],10))}}}function nu(e,t){for(var n=0;n!=t.length;++n){var r=t[n];if(null==e[r[0]])e[r[0]]=r[1];else switch(r[2]){case"bool":"string"==typeof e[r[0]]&&(e[r[0]]=de(e[r[0]]));break;case"int":"string"==typeof e[r[0]]&&(e[r[0]]=parseInt(e[r[0]],10))}}}function ru(e){nu(e.WBProps,Zl),nu(e.CalcPr,eu),tu(e.WBView,Ql),tu(e.Sheets,Jl),ol.date1904=de(e.WBProps.date1904)}var iu="][*?/\\".split("");function ou(t,n){if(31<t.length){if(n)return;throw new Error("Sheet names cannot exceed 31 chars")}iu.forEach(function(e){if(-1!=t.indexOf(e)){if(!n)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");0}})}function su(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var i,o,s,t=e.Workbook&&e.Workbook.Sheets||[];i=e.SheetNames,o=t,s=!!e.vbaraw,i.forEach(function(e,t){ou(e);for(var n=0;n<t;++n)if(e==i[n])throw new Error("Duplicate Sheet Name: "+e);if(s){var r=o&&o[t]&&o[t].CodeName||e;if(95==r.charCodeAt(0)&&22<r.length)throw new Error("Bad Code Name: Worksheet"+r)}});for(var n=0;n<e.SheetNames.length;++n){r=void 0;a=void 0;l=void 0;var r=e.Sheets[e.SheetNames[n]];e.SheetNames[n];var a=n;if(r&&r["!ref"]){var l=ve(r["!ref"]);if(l.e.c<l.s.c||l.e.r<l.s.r)throw new Error("Bad range ("+a+"): "+r["!ref"])}}}var au=/<\w+:workbook/;var lu=N("workbook",null,{xmlns:I.main[0],"xmlns:r":I.r});function uu(t){var n=[A],e=(n[n.length]=lu,t.Workbook&&0<(t.Workbook.Names||[]).length),r={codeName:"ThisWorkbook"},i=(t.Workbook&&t.Workbook.WBProps&&(Zl.forEach(function(e){null!=t.Workbook.WBProps[e[0]]&&t.Workbook.WBProps[e[0]]!=e[1]&&(r[e[0]]=t.Workbook.WBProps[e[0]])}),t.Workbook.WBProps.CodeName)&&(r.codeName=t.Workbook.WBProps.CodeName,delete r.CodeName),n[n.length]=N("workbookPr",null,r),t.Workbook&&t.Workbook.Sheets||[]),o=0;if(i&&i[0]&&i[0].Hidden){for(n[n.length]="<bookViews>",o=0;o!=t.SheetNames.length&&i[o]&&i[o].Hidden;++o);o==t.SheetNames.length&&(o=0),n[n.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',n[n.length]="</bookViews>"}for(n[n.length]="<sheets>",o=0;o!=t.SheetNames.length;++o){var s={name:_(t.SheetNames[o].slice(0,31))};if(s.sheetId=""+(o+1),s["r:id"]="rId"+(o+1),i[o])switch(i[o].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden"}n[n.length]=N("sheet",null,s)}return n[n.length]="</sheets>",e&&(n[n.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(e){var t={name:e.Name};e.Comment&&(t.comment=e.Comment),null!=e.Sheet&&(t.localSheetId=""+e.Sheet),e.Hidden&&(t.hidden="1"),e.Ref&&(n[n.length]=N("definedName",_(e.Ref),t))}),n[n.length]="</definedNames>"),2<n.length&&(n[n.length]="</workbook>",n[1]=n[1].replace("/>",">")),n.join("")}function cu(e,t){x(e,"BrtBeginBundleShs");for(var n,r=0;r!=t.SheetNames.length;++r){var i={Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};x(e,"BrtBundleSh",(i=i,(n=(n=void 0)||ee(127))._W(4,i.Hidden),n._W(4,i.iTabID),_n(i.strRelID,n),gn(i.name.slice(0,31),n),n.length>n.l?n.slice(0,n.l):n))}x(e,"BrtEndBundleShs")}function du(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var n,r=t.Workbook.Sheets,i=0,o=-1,s=-1;i<r.length;++i)!r[i]||!r[i].Hidden&&-1==o?o=i:1==r[i].Hidden&&-1==s&&(s=i);o<s||(x(e,"BrtBeginBookViews"),x(e,"BrtBookView",(t=o,(n=n||ee(29))._W(-4,0),n._W(-4,460),n._W(4,28800),n._W(4,17600),n._W(4,500),n._W(4,t),n._W(4,t),n._W(1,120),n.length>n.l?n.slice(0,n.l):n)),x(e,"BrtEndBookViews"))}}function hu(e,t){var n,r,i,o=Zt();return x(o,"BrtBeginBook"),x(o,"BrtFileVersion",function(e){e=e||ee(127);for(var t=0;4!=t;++t)e._W(4,0);return gn("SheetJS",e),gn(s.version,e),gn(s.version,e),gn("7262",e),e.length=e.l,e.length>e.l?e.slice(0,e.l):e}()),x(o,"BrtWbProp",(n=e.Workbook&&e.Workbook.WBProps||null,r=r||ee(72),i=0,n&&n.filterPrivacy&&(i|=8),r._W(4,i),r._W(4,0),wn(n&&n.CodeName||"ThisWorkbook",r),r.slice(0,r.l))),du(o,e),cu(o,e),x(o,"BrtEndBook"),o.end()}function fu(e,t,n){if(".bin"===t.slice(-4))return t=e,i={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=!(o=[]),(r=(r=n)||{}).biff=12,a=[],(l=[[]]).SheetNames=[],l.XTI=[],qt(t,function(e,t,n){switch(n){case 156:l.SheetNames.push(e.name),i.Sheets.push(e);break;case 153:i.WBProps=e;break;case 39:null!=e.Sheet&&(r.SID=e.Sheet),e.Ref=ja(e.Ptg,0,null,l,r),delete r.SID,delete e.Ptg,a.push(e);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([n,e]):l[0]=[n,e],l[l.length-1].XTI=[];break;case 362:0===l.length&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(e),l.XTI=l.XTI.concat(e);break;case 361:break;case 3072:case 3073:case 2071:case 534:case 677:case 158:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:o.push(t),s=!0;break;case 36:o.pop(),s=!1;break;case 37:o.push(t),s=!0;break;case 38:o.pop(),s=!1;break;case 16:break;default:if(!(0<(t||"").indexOf("Begin"))&&!(0<(t||"").indexOf("End"))&&(!s||r.WTF&&"BrtACBegin"!=o[o.length-1]&&"BrtFRTBegin"!=o[o.length-1]))throw new Error("Unexpected record "+n+" "+t)}},r),ru(i),i.Names=a,i.supbooks=l,i;var r,i,o,s,a,l,u=e,c=n;if(!u)throw new Error("Could not find file");var d={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},h=!1,f="xmlns",p={},g=0;if(u.replace(Ue,function(e,t){var n=se(e);switch($e(n[0])){case"<?xml":break;case"<workbook":e.match(au)&&(f="xmlns"+e.match(/<(\w+):/)[1]),d.xmlns=n[f];break;case"</workbook>":break;case"<fileVersion":delete n[0],d.AppVersion=n;break;case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Zl.forEach(function(e){if(null!=n[e[0]])switch(e[2]){case"bool":d.WBProps[e[0]]=de(n[e[0]]);break;case"int":d.WBProps[e[0]]=parseInt(n[e[0]],10);break;default:d.WBProps[e[0]]=n[e[0]]}}),n.codeName&&(d.WBProps.CodeName=he(n.codeName));break;case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete n[0],d.WBView.push(n);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(n.state){case"hidden":n.Hidden=1;break;case"veryHidden":n.Hidden=2;break;default:n.Hidden=0}delete n.state,n.name=ce(he(n.name)),delete n[0],d.Sheets.push(n);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":break;case"<definedNames>":case"<definedNames":h=!0;break;case"</definedNames>":h=!1;break;case"<definedName":(p={}).Name=he(n.name),n.comment&&(p.Comment=n.comment),n.localSheetId&&(p.Sheet=+n.localSheetId),de(n.hidden||"0")&&(p.Hidden=!0),g=t+e.length;break;case"</definedName>":p.Ref=ce(he(u.slice(g,t))),d.Names.push(p);break;case"<definedName/>":break;case"<calcPr":case"<calcPr/>":delete n[0],d.CalcPr=n;break;case"</calcPr>":case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":h=!0;break;case"</ext>":h=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":h=!0;break;case"</AlternateContent>":h=!1;break;case"<revisionPtr":break;default:if(!h&&c.WTF)throw new Error("unrecognized "+n[0]+" in workbook")}return e}),-1===I.main.indexOf(d.xmlns))throw new Error("Unknown Namespace: "+d.xmlns);return ru(d),d}function pu(e,t,n,r,i,o,s,a){if(".bin"!==t.slice(-4))return Cl(e,r,n,i,o,s,a);var t=e,e=r,l=n,u=i,c=o,P=s,d=a;if(!t)return t;var h,f,p,g,m,y,v,b,E,C,w=e||{},S=(u=u||{"!id":{}},null!=ae&&null==w.dense&&(w.dense=ae),w.dense?[]:{}),T={s:{r:2e6,c:2e6},e:{r:0,c:0}},R=[],A=!1,_=!1,N=[],x=(w.biff=12,w["!row"]=0),O=!1,I=[],F={},M=w.supbooks||c.supbooks||[[]];if(M.sharedf=F,M.arrayf=I,M.SheetNames=c.SheetNames||c.Sheets.map(function(e){return e.name}),!w.supbooks&&(w.supbooks=M,c.Names))for(var k=0;k<c.Names.length;++k)M[0][k+1]=c.Names[k];var D=[],L=[],B=!1;return qt(t,function(e,t,n){if(!_)switch(n){case 148:h=e;break;case 0:f=e,w.sheetRows&&w.sheetRows<=f.r&&(_=!0),E=pe(m=f.r),w["!row"]=f.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=ys(e.hpt)),L[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:switch(p={t:e[2]},e[2]){case"n":p.v=e[1];break;case"s":b=il[e[1]],p.v=b.t,p.r=b.r;break;case"b":p.v=!!e[1];break;case"e":p.v=e[1],!1!==w.cellText&&(p.w=Xn[p.v]);break;case"str":p.t="s",p.v=e[1]}if((g=d.CellXf[e[0].iStyleRef])&&dl(p,g.numFmtId,null,w,P,d),y=e[0].c,w.dense?(S[m]||(S[m]=[]),S[m][y]=p):S[ge(y)+E]=p,w.cellFormula){for(O=!1,x=0;x<I.length;++x){var r=I[x];f.r>=r[0].s.r&&f.r<=r[0].e.r&&y>=r[0].s.c&&y<=r[0].e.c&&(p.F=ye(r[0]),O=!0)}!O&&3<e.length&&(p.f=e[3])}T.s.r>f.r&&(T.s.r=f.r),T.s.c>y&&(T.s.c=y),T.e.r<f.r&&(T.e.r=f.r),T.e.c<y&&(T.e.c=y),w.cellDates&&g&&"n"==p.t&&le.is_date(le._table[g.numFmtId])&&(i=le.parse_date_code(p.v))&&(p.t="d",p.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u));break;case 1:w.sheetStubs&&!A&&(p={t:"z",v:void 0},y=e[0].c,w.dense?(S[m]||(S[m]=[]),S[m][y]=p):S[ge(y)+E]=p,T.s.r>f.r&&(T.s.r=f.r),T.s.c>y&&(T.s.c=y),T.e.r<f.r&&(T.e.r=f.r),T.e.c<y)&&(T.e.c=y);break;case 176:N.push(e);break;case 494:var i;for((i=u["!id"][e.relId])?(e.Target=i.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=i):""==e.relId&&(e.Target="#"+e.loc),m=e.rfx.s.r;m<=e.rfx.e.r;++m)for(y=e.rfx.s.c;y<=e.rfx.e.c;++y)w.dense?(S[m]||(S[m]=[]),S[m][y]||(S[m][y]={t:"z",v:void 0}),S[m][y].l=e):(v=me({c:y,r:m}),S[v]||(S[v]={t:"z",v:void 0}),S[v].l=e);break;case 426:w.cellFormula&&(I.push(e),(C=w.dense?S[m][y]:S[ge(y)+E]).f=ja(e[1],0,{r:f.r,c:y},M,w),C.F=ye(e[0]));break;case 427:w.cellFormula&&(F[me(e[0].s)]=e[1],(C=w.dense?S[m][y]:S[ge(y)+E]).f=ja(e[1],0,{r:f.r,c:y},M,w));break;case 60:if(w.cellStyles)for(;e.e>=e.s;)D[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},B||(B=!0,fs(e.w/256)),ps(D[e.e+1]);break;case 161:S["!autofilter"]={ref:ye(e)};break;case 476:S["!margins"]=e;break;case 147:c.Sheets[l]||(c.Sheets[l]={}),e.name&&(c.Sheets[l].CodeName=e.name);break;case 137:c.Views||(c.Views=[{}]),c.Views[0]||(c.Views[0]={}),e.RTL&&(c.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:case 151:break;case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 49:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 152:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:A=!0;break;case 36:A=!1;break;case 37:R.push(t),A=!0;break;case 38:R.pop(),A=!1;break;default:if(!(0<(t||"").indexOf("Begin"))&&!(0<(t||"").indexOf("End"))&&(!A||w.WTF))throw new Error("Unexpected record "+n+" "+t)}},w),delete w.supbooks,delete w["!row"],!S["!ref"]&&(T.s.r<2e6||h&&(0<h.e.r||0<h.e.c||0<h.s.r||0<h.s.c))&&(S["!ref"]=ye(h||T)),w.sheetRows&&S["!ref"]&&(e=ve(S["!ref"]),w.sheetRows<=+e.e.r)&&(e.e.r=w.sheetRows-1,e.e.r>T.e.r&&(e.e.r=T.e.r),e.e.r<e.s.r&&(e.s.r=e.e.r),e.e.c>T.e.c&&(e.e.c=T.e.c),e.e.c<e.s.c&&(e.s.c=e.e.c),S["!fullref"]=S["!ref"],S["!ref"]=ye(e)),0<N.length&&(S["!merges"]=N),0<D.length&&(S["!cols"]=D),0<L.length&&(S["!rows"]=L),S}function gu(e,t,n,r,i,o){if(".bin"===t.slice(-4)){var t=e,s=r,a=n,r=i,l=o;if(!t)return t;r=r||{"!id":{}};var u={"!type":"chart","!drawel":null,"!rel":""},c=[],d=!1;return qt(t,function(e,t,n){switch(n){case 550:u["!rel"]=e;break;case 651:l.Sheets[a]||(l.Sheets[a]={}),e.name&&(l.Sheets[a].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:d=!0;break;case 36:d=!1;break;case 37:c.push(t);break;case 38:c.pop();break;default:if(0<(t||"").indexOf("Begin"))c.push(t);else if(0<(t||"").indexOf("End"))c.pop();else if(!d||s.WTF)throw new Error("Unexpected record "+n+" "+t)}},s),r["!id"][u["!rel"]]&&(u["!drawel"]=r["!id"][u["!rel"]]),u}t=e,r=n,e=i,n=o;if(!t)return t;e=e||{"!id":{}};i={"!type":"chart","!drawel":null,"!rel":""},o=t.match(bl);return o&&wl(o[0],0,n,r),(o=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),e["!id"][i["!rel"]]&&(i["!drawel"]=e["!id"][i["!rel"]]),i}function mu(e,t,n,r){if(".bin"!==t.slice(-4))return As(e,n,r);var i,t=e,o=n,s=r,a={NumberFmt:[]};for(i in le._table)a.NumberFmt[i]=le._table[i];a.CellXf=[];var l=[],u=!(a.Fonts=[]);return qt(t,function(e,t,n){switch(n){case 44:a.NumberFmt[e[0]]=e[1],le.load(e[1],e[0]);break;case 43:a.Fonts.push(e),null!=e.color.theme&&o&&o.themeElements&&o.themeElements.clrScheme&&(e.color.rgb=is(o.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:break;case 47:"BrtBeginCellXFs"==l[l.length-1]&&a.CellXf.push(e);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:u=!0;break;case 36:u=!1;break;case 37:l.push(t),u=!0;break;case 38:l.pop(),u=!1;break;default:if(0<(t||"").indexOf("Begin"))l.push(t);else if(0<(t||"").indexOf("End"))l.pop();else if(!u||s.WTF&&"BrtACBegin"!=l[l.length-1])throw new Error("Unexpected record "+n+" "+t)}}),a}function yu(e,t,n){if(".bin"===t.slice(-4))return r=n,o=!(i=[]),qt(e,function(e,t,n){switch(n){case 159:i.Count=e[0],i.Unique=e[1];break;case 19:i.push(e);break;case 160:return 1;case 35:o=!0;break;case 36:o=!1;break;default:if(0<t.indexOf("Begin")||t.indexOf("End"),!o||r.WTF)throw new Error("Unexpected record "+n+" "+t)}}),i;var r,i,o,t=e,s=n,a=[],l="";if(t){t=t.match(Io);if(t){for(var l=t[2].replace(Mo,"").split(ko),u=0;u!=l.length;++u){var c=Oo(l[u].trim(),s);null!=c&&(a[a.length]=c)}t=se(t[1]),a.Count=t.count,a.Unique=t.uniqueCount}}return a}function vu(e,t,n){var r,i,o,s,a,l,u,c;return".bin"===t.slice(-4)?(r=n,i=[],o=[],a=!(s={}),qt(e,function(e,t,n){switch(n){case 632:o.push(e);break;case 635:s=e;break;case 637:s.t=e.t,s.h=e.h,s.r=e.r;break;case 636:s.author=o[s.iauthor],delete s.iauthor,r.sheetRows&&s.rfx&&r.sheetRows<=s.rfx.r||(s.t||(s.t=""),delete s.rfx,i.push(s));break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:case 38:break;default:if(!(0<(t||"").indexOf("Begin"))&&!(0<(t||"").indexOf("End"))&&(!a||r.WTF))throw new Error("Unexpected record "+n+" "+t)}}),i):(l=n,(t=e).match(/<(?:\w+:)?comments *\/>/)?[]:(u=[],c=[],(n=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/))&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(e){""!==e&&""!==e.trim()&&(e=e.match(/<(?:\w+:)?author[^>]*>(.*)/))&&u.push(e[1])}),(n=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/))&&n[1]&&n[1].split(/<\/\w*:?comment>/).forEach(function(e){var t,n;""!==e&&""!==e.trim()&&(n=e.match(/<(?:\w+:)?comment[^>]*>/))&&(t={author:(n=se(n[0])).authorId&&u[n.authorId]||"sheetjsghost",ref:n.ref,guid:n.guid},n=B(n.ref),l.sheetRows&&l.sheetRows<=n.r||(e=!!(n=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/))&&!!n[1]&&Oo(n[1])||{r:"",t:"",h:""},t.r=e.r,"<t></t>"==e.r&&(e.t=e.h=""),t.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),l.cellHTML&&(t.h=e.h),c.push(t)))}),c))}function bu(e,t){var r,n,i;return".bin"===t.slice(-4)?(r=[],qt(e,function(e,t,n){if(63===n)r.push(e);else if(!(0<(t||"").indexOf("Begin")||0<(t||"").indexOf("End")))throw new Error("Unexpected record "+n+" "+t)}),r):(i=[],(t=e)&&(n=1,(t.match(Ue)||[]).forEach(function(e){var t=se(e);switch(t[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete t[0],t.i?n=t.i:t.i=n,i.push(t)}})),i)}function Eu(e,t,n,r){if(".bin"===n.slice(-4)){n=e,e=r;if(!n)return n;var i=e||{},o=!1;qt(n,function(e,t,n){switch(n){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!(0<(t||"").indexOf("Begin"))&&!(0<(t||"").indexOf("End"))&&(!o||i.WTF))throw new Error("Unexpected record "+n.toString(16)+" "+t)}},i)}}var Cu=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,wu=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Su(e,t){var n=e.split(/\s+/),r=[];if(t||(r[0]=n[0]),1!==n.length){var i,o,s,a=e.match(Cu);if(a)for(s=0;s!=a.length;++s)-1===(o=(i=a[s].match(wu))[1].indexOf(":"))?r[i[1]]=i[2].slice(1,i[2].length-1):r["xmlns:"===i[1].slice(0,6)?"xmlns"+i[1].slice(6):i[1].slice(o+1)]=i[2].slice(1,i[2].length-1)}return r}function Tu(e,t,n){if("z"!==e.t){if(!n||!1!==n.cellText)try{"e"===e.t?e.w=e.w||Xn[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=le._general_int(e.v):e.w=le._general_num(e.v):e.w=le._general(e.v):e.w=(r=t||"General",i=e.v,"General"===(r=Re[r]||ce(r))?le._general(i):le.format(r,i))}catch(e){if(n.WTF)throw e}var r,i;try{var o,s=Re[t]||t||"General";n.cellNF&&(e.z=s),n.cellDates&&"n"==e.t&&le.is_date(s)&&(o=le.parse_date_code(e.v))&&(e.t="d",e.v=new Date(o.y,o.m-1,o.d,o.H,o.M,o.S,o.u))}catch(e){if(n.WTF)throw e}}}function Ru(e){if(T&&Buffer.isBuffer(e))return e.toString("utf8");if("string"==typeof e)return e;if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array)return he(o(b(e)));throw new Error("Bad input format: expected Buffer or string")}var Au=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm;function _u(P,e){var t,n=e||{},r=(Te(le),Ce(Ru(P))),F=(r="binary"!=n.type&&"array"!=n.type&&"base64"!=n.type?r:"undefined"!=typeof cptable?cptable.utils.decode(65001,Ee(r)):he(r)).slice(0,1024).toLowerCase(),B=!1;if(-1==F.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(e){0<=F.indexOf("<"+e)&&(B=!0)}),B)return ic.to_workbook(r,n);for(var i,o,s,a,l,u,c,d=[],H=(null!=ae&&null==n.dense&&(n.dense=ae),{}),U=[],h=n.dense?[]:{},f="",p={},g={},V=Su('<Data ss:Type="String">'),W=0,m=0,y=0,v={s:{r:2e6,c:2e6},e:{r:0,c:0}},$={},b={},j="",z=0,E=[],G={},Y={},C=0,X=[],w=[],S={},T=[],K=!1,q=[],R=[],A={},_=0,Z=0,N={Sheets:[],WBProps:{date1904:!1}},Q={},J=(Au.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/gm,""),"");t=Au.exec(r);)switch(t[3]=(J=t[3]).toLowerCase()){case"data":if("data"==J)if("/"===t[1]){if((i=d.pop())[0]!==t[3])throw new Error("Bad state: "+i.join("|"))}else"/"!==t[0].charAt(t[0].length-2)&&d.push([t[3],!0]);else d[d.length-1][1]||("/"===t[1]?function(e,t,n,r,i,o,s,a,l,u){var c="General",d=r.StyleID,h={},f=(u=u||{},[]),p=0;for(void 0===(d=void 0===d&&a?a.StyleID:d)&&s&&(d=s.StyleID);void 0!==o[d]&&(o[d].nf&&(c=o[d].nf),o[d].Interior&&f.push(o[d].Interior),o[d].Parent);)d=o[d].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=de(e);break;case"String":r.t="s",r.r=et(ce(e)),r.v=-1<e.indexOf("<")?ce(t||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),r.v=(oe(e)-new Date(Date.UTC(1899,11,30)))/864e5,r.v!=r.v?r.v=ce(e):r.v<60&&(r.v=r.v-1),c&&"General"!=c||(c="yyyy-mm-dd");case"Number":void 0===r.v&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=Kn[e],!1!==u.cellText&&(r.w=e);break;default:""==e&&""==t?r.t="z":(r.t="s",r.v=et(t||e))}if(Tu(r,c,u),!1!==u.cellFormula)if(r.Formula){a=ce(r.Formula);61==a.charCodeAt(0)&&(a=a.slice(1)),r.f=la(a,i),delete r.Formula,"RC"==r.ArrayRange?r.F=la("RC:RC",i):r.ArrayRange&&(r.F=la(r.ArrayRange,i),l.push([ve(r.F),r.F]))}else for(p=0;p<l.length;++p)i.r>=l[p][0].s.r&&i.r<=l[p][0].e.r&&i.c>=l[p][0].s.c&&i.c<=l[p][0].e.c&&(r.F=l[p][1]);u.cellStyles&&(f.forEach(function(e){!h.patternType&&e.patternType&&(h.patternType=e.patternType)}),r.s=h),void 0!==r.StyleID&&(r.ixfe=r.StyleID)}(r.slice(W,t.index),j,V,"comment"==d[d.length-1][0]?S:p,{c:m,r:y},$,T[m],g,q,n):(j="",V=Su(t[0]),W=t.index+t[0].length));break;case"cell":if("/"===t[1])if(0<w.length&&(p.c=w),(!n.sheetRows||n.sheetRows>y)&&void 0!==p.v&&(n.dense?(h[y]||(h[y]=[]),h[y][m]=p):h[ge(m)+pe(y)]=p),p.HRef&&(p.l={Target:p.HRef},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(_=m+(0|parseInt(p.MergeAcross,10)),Z=y+(0|parseInt(p.MergeDown,10)),E.push({s:{c:m,r:y},e:{c:_,r:Z}})),n.sheetStubs)if(p.MergeAcross||p.MergeDown){for(var x=m;x<=_;++x)for(var O=y;O<=Z;++O)(m<x||y<O)&&(n.dense?(h[O]||(h[O]=[]),h[O][x]={t:"z"}):h[ge(x)+pe(O)]={t:"z"});m=_+1}else++m;else p.MergeAcross?m=_+1:++m;else(m=(p=function(e){var t=e.split(/\s+/),n={};if(1!==t.length){var r,i,o,s=e.match(Cu);if(s)for(o=0;o!=s.length;++o)-1===(i=(r=s[o].match(wu))[1].indexOf(":"))?n[r[1]]=r[2].slice(1,r[2].length-1):n["xmlns:"===r[1].slice(0,6)?"xmlns"+r[1].slice(6):r[1].slice(i+1)]=r[2].slice(1,r[2].length-1)}return n}(t[0])).Index?+p.Index-1:m)<v.s.c&&(v.s.c=m),m>v.e.c&&(v.e.c=m),"/>"===t[0].slice(-2)&&++m,w=[];break;case"row":"/"===t[1]||"/>"===t[0].slice(-2)?(y<v.s.r&&(v.s.r=y),y>v.e.r&&(v.e.r=y),"/>"===t[0].slice(-2)&&(g=Su(t[0])).Index&&(y=+g.Index-1),m=0,++y):((g=Su(t[0])).Index&&(y=+g.Index-1),A={},"0"!=g.AutoFitHeight&&!g.Height||(A.hpx=parseInt(g.Height,10),A.hpt=ms(A.hpx),R[y]=A),"1"==g.Hidden&&(A.hidden=!0,R[y]=A));break;case"worksheet":if("/"===t[1]){if((i=d.pop())[0]!==t[3])throw new Error("Bad state: "+i.join("|"));U.push(f),v.s.r<=v.e.r&&v.s.c<=v.e.c&&(h["!ref"]=ye(v),n.sheetRows)&&n.sheetRows<=v.e.r&&(h["!fullref"]=h["!ref"],v.e.r=n.sheetRows-1,h["!ref"]=ye(v)),E.length&&(h["!merges"]=E),0<T.length&&(h["!cols"]=T),0<R.length&&(h["!rows"]=R),H[f]=h}else y=m=0,d.push([t[3],!(v={s:{r:2e6,c:2e6},e:{r:0,c:0}})]),i=Su(t[0]),f=ce(i.Name),h=n.dense?[]:{},E=[],q=[],R=[],N.Sheets.push(Q={name:f,Hidden:0});break;case"table":if("/"===t[1]){if((i=d.pop())[0]!==t[3])throw new Error("Bad state: "+i.join("|"))}else{if("/>"==t[0].slice(-2))break;Su(t[0]),d.push([t[3],!1]),K=!(T=[])}break;case"style":"/"===t[1]?(l=$,u=b,(c=n).cellStyles&&u.Interior&&(c=u.Interior).Pattern&&(c.patternType=vs[c.Pattern]||c.Pattern),l[u.ID]=u):b=Su(t[0]);break;case"numberformat":b.nf=ce(Su(t[0]).Format||"General"),Re[b.nf]&&(b.nf=Re[b.nf]);for(var I=0;392!=I&&le._table[I]!=b.nf;++I);if(392==I)for(I=57;392!=I;++I)if(null==le._table[I]){le.load(b.nf,I);break}break;case"column":if("table"===d[d.length-1][0]){if((o=Su(t[0])).Hidden&&(o.hidden=!0,delete o.Hidden),o.Width&&(o.wpx=parseInt(o.Width,10)),!K&&10<o.wpx){K=!0,ls=os;for(var ee=0;ee<T.length;++ee)T[ee]&&ps(T[ee])}K&&ps(o),T[o.Index-1||T.length]=o;for(var te=0;te<+o.Span;++te)T[T.length]=_e(o)}break;case"namedrange":"/"!==t[1]&&(N.Names||(N.Names=[]),l={Name:(c=se(t[0])).Name,Ref:la(c.RefersTo.slice(1),{r:0,c:0})},0<N.Sheets.length&&(l.Sheet=N.Sheets.length-1),N.Names.push(l));break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":break;case"font":"/>"!==t[0].slice(-2)&&("/"===t[1]?j+=r.slice(z,t.index):z=t.index+t[0].length);break;case"interior":n.cellStyles&&(b.Interior=Su(t[0]));break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":"/>"!==t[0].slice(-2)&&("/"===t[1]?(u=G,s=J,a=r.slice(C,t.index),u[s=Rr[s]||s]=a):C=t.index+t[0].length);break;case"paragraphs":break;case"styles":case"workbook":if("/"===t[1]){if((i=d.pop())[0]!==t[3])throw new Error("Bad state: "+i.join("|"))}else d.push([t[3],!1]);break;case"comment":if("/"===t[1]){if((i=d.pop())[0]!==t[3])throw new Error("Bad state: "+i.join("|"));(s=S).t=s.v||"",s.t=s.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),s.v=s.w=s.ixfe=void 0,w.push(S)}else d.push([t[3],!1]),i=Su(t[0]),S={a:i.Author};break;case"autofilter":if("/"===t[1]){if((i=d.pop())[0]!==t[3])throw new Error("Bad state: "+i.join("|"))}else"/"!==t[0].charAt(t[0].length-2)&&(a=Su(t[0]),h["!autofilter"]={ref:la(a.Range).replace(/\$/g,"")},d.push([t[3],!0]));break;case"name":break;case"datavalidation":if("/"===t[1]){if((i=d.pop())[0]!==t[3])throw new Error("Bad state: "+i.join("|"))}else"/"!==t[0].charAt(t[0].length-2)&&d.push([t[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===t[1]){if((i=d.pop())[0]!==t[3])throw new Error("Bad state: "+i.join("|"))}else"/"!==t[0].charAt(t[0].length-2)&&d.push([t[3],!0]);break;default:if(0==d.length&&"document"==t[3])return pc(r,n);if(0==d.length&&"uof"==t[3])return pc(r,n);var M=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(t[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:M=!1}break;case"componentoptions":switch(t[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:M=!1}break;case"excelworkbook":switch(t[3]){case"date1904":N.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:M=!1}break;case"workbookoptions":switch(t[3]){case"owcversion":case"height":case"width":break;default:M=!1}break;case"worksheetoptions":switch(t[3]){case"visible":if("/>"!==t[0].slice(-2))if("/"===t[1])switch(r.slice(C,t.index)){case"SheetHidden":Q.Hidden=1;break;case"SheetVeryHidden":Q.Hidden=2}else C=t.index+t[0].length;break;case"header":h["!margins"]||ul(h["!margins"]={},"xlml"),h["!margins"].header=se(t[0]).Margin;break;case"footer":h["!margins"]||ul(h["!margins"]={},"xlml"),h["!margins"].footer=se(t[0]).Margin;break;case"pagemargins":var k=se(t[0]);h["!margins"]||ul(h["!margins"]={},"xlml"),k.Top&&(h["!margins"].top=k.Top),k.Left&&(h["!margins"].left=k.Left),k.Right&&(h["!margins"].right=k.Right),k.Bottom&&(h["!margins"].bottom=k.Bottom);break;case"displayrighttoleft":N.Views||(N.Views=[]),N.Views[0]||(N.Views[0]={}),N.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":break;case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"nosummaryrowsbelowdetail":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"nosummarycolumnsrightdetail":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;default:M=!1}break;case"pivottable":case"pivotcache":switch(t[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:M=!1}break;case"pagebreaks":switch(t[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:M=!1}break;case"autofilter":switch(t[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:M=!1}break;case"querytable":switch(t[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:M=!1}break;case"datavalidation":switch(t[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:M=!1}break;case"sorting":case"conditionalformatting":switch(t[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:M=!1}break;case"mapinfo":case"schema":case"data":switch(t[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:M=!1}break;case"smarttags":break;default:M=!1}if(!M&&!t[3].match(/!\[CDATA/)){if(!d[d.length-1][1])throw"Unrecognized tag: "+t[3]+"|"+d.join("|");if("customdocumentproperties"===d[d.length-1][0]){if("/>"!==t[0].slice(-2))if("/"===t[1]){L=D=ie=re=ne=void 0;var ne=Y,re=J,ie=X,D=r.slice(C,t.index),L=D;switch((ie[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":L=de(D);break;case"i2":case"int":L=parseInt(D,10);break;case"r4":case"float":L=parseFloat(D);break;case"date":case"dateTime.tz":L=oe(D);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+ie[0])}ne[ce(re)]=L}else C=(X=t).index+t[0].length}else if(n.WTF)throw"Unrecognized tag: "+t[3]+"|"+d.join("|")}}e={};return n.bookSheets||n.bookProps||(e.Sheets=H),e.SheetNames=U,e.Workbook=N,e.SSF=le.get_table(),e.Props=G,e.Custprops=Y,e}function Nu(e,t){switch(Dc(t=t||{}),t.type||"base64"){case"base64":return _u(S.decode(e),t);case"binary":case"buffer":case"file":return _u(e,t);case"array":return _u(o(e),t)}}function xu(e,t){var n,r,i,o,s,a,l,u=[];return e.Props&&u.push((n=e.Props,r=t,i=[],ue(Tr).map(function(e){for(var t=0;t<fr.length;++t)if(fr[t][1]==e)return fr[t];for(t=0;t<vr.length;++t)if(vr[t][1]==e)return vr[t];throw e}).forEach(function(e){var t;null!=n[e[1]]&&(t=(r&&r.Props&&null!=r.Props[e[1]]?r.Props:n)[e[1]],"number"==typeof(t="date"===e[2]?new Date(t).toISOString().replace(/\.\d*Z/,"Z"):t)?t=String(t):!0===t||!1===t?t=t?"1":"0":t instanceof Date&&(t=new Date(t).toISOString().replace(/\.\d*Z/,"")),i.push(pt(Tr[e[1]]||e[1],t)))}),N("DocumentProperties",i.join(""),{xmlns:yt.o}))),e.Custprops&&u.push((o=e.Props,s=e.Custprops,a=["Worksheets","SheetNames"],t="CustomDocumentProperties",l=[],o&&ue(o).forEach(function(e){if(Object.prototype.hasOwnProperty.call(o,e)){for(var t=0;t<fr.length;++t)if(e==fr[t][1])return;for(t=0;t<vr.length;++t)if(e==vr[t][1])return;for(t=0;t<a.length;++t)if(e==a[t])return;var n="string",r="number"==typeof(r=o[e])?(n="float",String(r)):!0===r||!1===r?(n="boolean",r?"1":"0"):String(r);l.push(N(qe(e),r,{"dt:dt":n}))}}),s&&ue(s).forEach(function(e){var t,n;!Object.prototype.hasOwnProperty.call(s,e)||o&&Object.prototype.hasOwnProperty.call(o,e)||(t="string",n="number"==typeof(n=s[e])?(t="float",String(n)):!0===n||!1===n?(t="boolean",n?"1":"0"):n instanceof Date?(t="dateTime.tz",n.toISOString()):String(n),l.push(N(qe(e),n,{"dt:dt":t})))}),"<"+t+' xmlns="'+yt.o+'">'+l.join("")+"</"+t+">")),u.join("")}function Ou(e){return N("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+da(e.Ref,{r:0,c:0})})}function Iu(e,t,n,r,i,o,s){if(!e||null==e.v&&null==e.f)return"";var a={};if(e.f&&(a["ss:Formula"]="="+_(da(e.f,s))),e.F&&e.F.slice(0,t.length)==t&&(t=B(e.F.slice(t.length+1)),a["ss:ArrayRange"]="RC:R"+(t.r==s.r?"":"["+(t.r-s.r)+"]")+"C"+(t.c==s.c?"":"["+(t.c-s.c)+"]")),e.l&&e.l.Target&&(a["ss:HRef"]=_(e.l.Target),e.l.Tooltip)&&(a["x:HRefScreenTip"]=_(e.l.Tooltip)),n["!merges"])for(var l=n["!merges"],u=0;u!=l.length;++u)l[u].s.c==s.c&&l[u].s.r==s.r&&(l[u].e.c>l[u].s.c&&(a["ss:MergeAcross"]=l[u].e.c-l[u].s.c),l[u].e.r>l[u].s.r)&&(a["ss:MergeDown"]=l[u].e.r-l[u].s.r);var c="",d="";switch(e.t){case"z":if(r.sheetStubs)break;return"";case"n":c="Number",d=String(e.v);break;case"b":c="Boolean",d=e.v?"1":"0";break;case"e":c="Error",d=Xn[e.v];break;case"d":c="DateTime",d=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||le._table[14]);break;case"s":c="String",d=((e.v||"")+"").replace(Xe,function(e){return Ye[e]}).replace(Ze,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}t=cl(r.cellXfs,e,r),a["ss:StyleID"]="s"+(21+t),a["ss:Index"]=s.c+1,n=null!=e.v?d:"",t="z"==e.t?"":'<Data ss:Type="'+c+'">'+n+"</Data>";return 0<(e.c||[]).length&&(t+=e.c.map(function(e){var t=N("ss:Data",nt(e.t||""),{xmlns:"http://www.w3.org/TR/REC-html40"});return N("Comment",t,{"ss:Author":e.a})}).join("")),N("Cell",t,a)}function Mu(e,t){if(!e["!ref"])return"";for(var n,r,i=ve(e["!ref"]),o=e["!merges"]||[],s=0,a=[],l=(e["!cols"]&&e["!cols"].forEach(function(e,t){ps(e);var n=!!e.width,r=ll(t,e),t={"ss:Index":t+1};n&&(t["ss:Width"]=us(r.width)),e.hidden&&(t["ss:Hidden"]="1"),a.push(N("Column",null,t))}),Array.isArray(e)),u=i.s.r;u<=i.e.r;++u){for(var c=[(n=u,r=(e["!rows"]||[])[u],n='<Row ss:Index="'+(n+1)+'"',r&&(r.hpt&&!r.hpx&&(r.hpx=ys(r.hpt)),r.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden)&&(n+=' ss:Hidden="1"'),n+">")],d=i.s.c;d<=i.e.c;++d){for(var h,f,p,g=!1,s=0;s!=o.length;++s)if(!(o[s].s.c>d||o[s].s.r>u||o[s].e.c<d||o[s].e.r<u)){o[s].s.c==d&&o[s].s.r==u||(g=!0);break}g||(f=me(h={r:u,c:d}),p=l?(e[u]||[])[d]:e[f],c.push(Iu(p,f,e,t,0,0,h)))}c.push("</Row>"),2<c.length&&a.push(c.join(""))}return a.join("")}function ku(e,t,n){var r=[],i=n.SheetNames[e],i=n.Sheets[i],o=i?function(e,t,n){if(!e)return"";if(!((n||{}).Workbook||{}).Names)return"";for(var r=n.Workbook.Names,i=[],o=0;o<r.length;++o){var s=r[o];s.Sheet!=t||s.Name.match(/^_xlfn\./)||i.push(Ou(s))}return i.join("")}(i,e,n):"";return 0<o.length&&r.push("<Names>"+o+"</Names>"),0<(o=i?Mu(i,t):"").length&&r.push("<Table>"+o+"</Table>"),r.push(function(t,e,n){if(!t)return"";var r=[];if(t["!margins"]&&(r.push("<PageSetup>"),t["!margins"].header&&r.push(N("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&r.push(N("Footer",null,{"x:Margin":t["!margins"].footer})),r.push(N("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),r.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[e])if(n.Workbook.Sheets[e].Hidden)r.push(N("Visible",1==n.Workbook.Sheets[e].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<e&&(!n.Workbook.Sheets[i]||n.Workbook.Sheets[i].Hidden);++i);i==e&&r.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&r.push("<DisplayRightToLeft/>"),t["!protect"]&&(r.push(pt("ProtectContents","True")),t["!protect"].objects&&r.push(pt("ProtectObjects","True")),t["!protect"].scenarios&&r.push(pt("ProtectScenarios","True")),null==t["!protect"].selectLockedCells||t["!protect"].selectLockedCells?null==t["!protect"].selectUnlockedCells||t["!protect"].selectUnlockedCells||r.push(pt("EnableSelection","UnlockedCells")):r.push(pt("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(e){t["!protect"][e[0]]&&r.push("<"+e[1]+"/>")})),0==r.length?"":N("WorksheetOptions",r.join(""),{xmlns:yt.x})}(i,e,n)),r.join("")}function Du(e,t){t=t||{},e.SSF||(e.SSF=le.get_table()),e.SSF&&(Te(le),le.load_table(e.SSF),t.revssf=U(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],cl(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(xu(e,t)),n.push(""),n.push(""),n.push("");for(var r,i=0;i<e.SheetNames.length;++i)n.push(N("Worksheet",ku(i,t,e),{"ss:Name":_(e.SheetNames[i])}));return n[2]=(r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'],t.cellXfs.forEach(function(e,t){var n=[],e=(n.push(N("NumberFormat",null,{"ss:Format":_(le._table[e.numFmtId])})),{"ss:ID":"s"+(21+t)});r.push(N("Style",n.join(""),e))}),N("Styles",r.join(""))),n[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var i=t[r];null!=i.Sheet||i.Name.match(/^_xlfn\./)||n.push(Ou(i))}return N("Names",n.join(""))}(e),A+N("Workbook",n.join(""),{xmlns:yt.ss,"xmlns:o":yt.o,"xmlns:x":yt.x,"xmlns:ss":yt.ss,"xmlns:dt":yt.dt,"xmlns:html":yt.html})}function Lu(e){var t,e=e.content;e.l=28,e._R(0,"lpstr-ansi"),Ln(e,1),e.length-e.l<=4||0==(t=e._R(4))||40<t||(e.l-=4,e._R(0,"lpstr-ansi"),e.length-e.l<=4)||1907505652!==(t=e._R(4))||(Ln(e,2),0==(t=e._R(4)))||40<t||(e.l-=4,e._R(0,"lpwstr"))}function Pu(e,t,n){if("z"!==e.t&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=le._table[r])}catch(e){if(t.WTF)throw e}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||Xn[e.v]:0===r||"General"==r?"n"===e.t?(0|e.v)===e.v?e.w=le._general_int(e.v):e.w=le._general_num(e.v):e.w=le._general(e.v):e.w=le.format(r,e.v,{date1904:!!n})}catch(e){if(t.WTF)throw e}t.cellDates&&r&&"n"==e.t&&le.is_date(le._table[r]||String(r))&&(n=le.parse_date_code(e.v))&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}function Fu(e,t,n){return{v:e,ixfe:t,t:n}}function Bu(e,t){function n(e,t,n){if(!(1<S)&&(p=!(n.sheetRows&&e.r>=n.sheetRows)&&p)){var r,i,o;if(n.cellStyles&&t.XF&&t.XF.data&&(i=n,o=(r=t).XF.data)&&o.patternType&&i&&i.cellStyles&&(r.s={},r.s.patternType=o.patternType,(i=rs(z(o.icvFore)))&&(r.s.fgColor={rgb:i}),i=rs(z(o.icvBack)))&&(r.s.bgColor={rgb:i}),delete t.ixfe,delete t.XF,V=me(P=e),u&&u.s&&u.e||(u={s:{r:0,c:0},e:{r:0,c:0}}),e.r<u.s.r&&(u.s.r=e.r),e.c<u.s.c&&(u.s.c=e.c),e.r+1>u.e.r&&(u.e.r=e.r+1),e.c+1>u.e.c&&(u.e.c=e.c+1),n.cellFormula&&t.f)for(var s=0;s<f.length;++s)if(!(f[s][0].s.c>e.c||f[s][0].s.r>e.r||f[s][0].e.c<e.c||f[s][0].e.r<e.r)){t.F=ye(f[s][0]),f[s][0].s.c==e.c&&f[s][0].s.r==e.r||delete t.f,t.f&&(t.f=""+ja(f[s][1],0,e,w,y));break}n.dense?(a[e.r]||(a[e.r]=[]),a[e.r][e.c]=t):a[V]=t}}for(var P,r,i,F,B,o,s={opts:{}},H={},a=(null!=ae&&null==t.dense&&(t.dense=ae),t.dense?[]:{}),l={},u={},c=null,d=[],h="",U={},V="",W={},f=[],p=!0,g=[],$=[],m={Sheets:[],WBProps:{date1904:!1},Views:[{}]},j={},z=function(e){return!(e<8)&&e<64&&$[e-8]||Yn[e]},y={enc:!1,sbcch:0,snames:[],sharedf:W,arrayf:f,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf},v=(t.password&&(y.password=t.password),[]),b=[],E=[],C=[],G=!1,w=[],Y=(w.SheetNames=y.snames,w.sharedf=y.sharedf,w.arrayf=y.arrayf,w.names=[],w.XTI=[],""),S=0,T=0,R=[],X=[],K=(be(y.codepage=1200),!1);e.l<e.length-1;){var q=e.l,A=e._R(2);if(0===A&&"EOF"===Y)break;var _=e.l===e.length?0:e._R(2),N=ju[A];if(N&&N.f){if(t.bookSheets&&"BoundSheet8"===Y&&"BoundSheet8"!==N.n)break;if(Y=N.n,2===N.r||12==N.r){var Z=e._R(2);if(_-=2,!y.enc&&Z!==A&&((255&Z)<<8|Z>>8)!==A)throw new Error("rt mismatch: "+Z+"!="+A);12==N.r&&(e.l+=10,_-=10)}var x,Q,O,I={},I="EOF"===N.n?N.f(e,_,y):function(e,t,n,r){var i=n,o=[],s=t.slice(t.l,t.l+i);if(r&&r.enc&&r.enc.insitu)switch(e.n){case"BOF":case"FilePass":case"FileLock":case"InterfaceHdr":case"RRDInfo":case"RRDHead":case"UsrExcl":break;default:0!==s.length&&r.enc.insitu(s)}o.push(s),t.l+=i;for(var a=ju[Ut(t,t.l)],l=0;null!=a&&"Continue"===a.n.slice(0,8);)i=Ut(t,t.l+2),l=t.l+4,"ContinueFrt"==a.n?l+=4:"ContinueFrt"==a.n.slice(0,11)&&(l+=12),o.push(t.slice(l,t.l+4+i)),t.l+=4+i,a=ju[Ut(t,t.l)];var u=we(o),c=(fe(u,0),0);u.lens=[];for(var d=0;d<o.length;++d)u.lens.push(c),c+=o[d].length;return e.f(u,u.length,r)}(N,e,_,y),J=N.n;if(0!=S||"BOF"==J)switch(J){case"Date1904":s.opts.Date1904=m.WBProps.date1904=I;break;case"WriteProtect":s.opts.WriteProtect=!0;break;case"FilePass":if(y.enc||(e.l=0),y.enc=I,!t.password)throw new Error("File is password-protected");if(null==I.valid)throw new Error("Encryption scheme unsupported");if(I.valid)break;throw new Error("Password is incorrect");case"WriteAccess":y.lastuser=I;break;case"FileSharing":break;case"CodePage":var M=Number(I);switch(M){case 21010:M=1200;break;case 32768:M=1e4;break;case 32769:M=1252}be(y.codepage=M),K=!0;break;case"RRTabId":y.rrtabid=I;break;case"WinProtect":y.winlocked=I;break;case"Template":case"BookBool":case"UsesELFs":case"MTRSettings":break;case"RefreshAll":case"CalcCount":case"CalcDelta":case"CalcIter":case"CalcMode":case"CalcPrecision":case"CalcSaveRecalc":s.opts[J]=I;break;case"CalcRefMode":y.CalcRefMode=I;break;case"Uncalced":break;case"ForceFullCalculation":s.opts.FullCalc=I;break;case"WsBool":I.fDialog&&(a["!type"]="dialog");break;case"XF":g.push(I);break;case"ExtSST":case"BookExt":case"RichTextStream":case"BkHim":break;case"SupBook":w.push([I]),w[w.length-1].XTI=[];break;case"ExternName":w[w.length-1].push(I);break;case"Index":break;case"Lbl":o={Name:I.Name,Ref:ja(I.rgce,0,null,w,y)},0<I.itab&&(o.Sheet=I.itab-1),w.names.push(o),w[0]||(w[0]=[],w[0].XTI=[]),w[w.length-1].push(I),"_xlnm._FilterDatabase"==I.Name&&0<I.itab&&I.rgce&&I.rgce[0]&&I.rgce[0][0]&&"PtgArea3d"==I.rgce[0][0][0]&&(X[I.itab-1]={ref:ye(I.rgce[0][0][1][2])});break;case"ExternCount":y.ExternCount=I;break;case"ExternSheet":0==w.length&&(w[0]=[],w[0].XTI=[]),w[w.length-1].XTI=w[w.length-1].XTI.concat(I),w.XTI=w.XTI.concat(I);break;case"NameCmt":y.biff<8||null!=o&&(o.Comment=I[1]);break;case"Protect":a["!protect"]=I;break;case"Password":0!==I&&y.WTF&&console.error("Password verifier: "+I);break;case"Prot4Rev":case"Prot4RevPass":break;case"BoundSheet8":l[I.pos]=I,y.snames.push(I.name);break;case"EOF":--S||(u.e&&(0<u.e.r&&0<u.e.c&&(u.e.r--,u.e.c--,a["!ref"]=ye(u),t.sheetRows&&t.sheetRows<=u.e.r&&(x=u.e.r,u.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=ye(u),u.e.r=x),u.e.r++,u.e.c++),0<v.length&&(a["!merges"]=v),0<b.length&&(a["!objects"]=b),0<E.length&&(a["!cols"]=E),0<C.length&&(a["!rows"]=C),m.Sheets.push(j)),""===h?U=a:H[h]=a,a=t.dense?[]:{});break;case"BOF":8===y.biff&&(y.biff={9:2,521:3,1033:4}[A]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[I.BIFFVer]||8),8==y.biff&&0==I.BIFFVer&&16==I.dt&&(y.biff=2),S++||(p=!0,a=t.dense?[]:{},y.biff<8&&!K&&(K=!0,be(y.codepage=t.codepage||1252)),y.biff<5?(""===h&&(h="Sheet1"),u={s:{r:0,c:0},e:{r:0,c:0}},x={pos:e.l-_,name:h},l[x.pos]=x,y.snames.push(h)):h=(l[q]||{name:""}).name,32==I.dt&&(a["!type"]="chart"),64==I.dt&&(a["!type"]="macro"),v=[],b=[],y.arrayf=f=[],E=[],0,G=!(C=[]),j={Hidden:(l[q]||{hs:0}).hs,name:h});break;case"Number":case"BIFF2NUM":case"BIFF2INT":"chart"==a["!type"]&&(t.dense?(a[I.r]||[])[I.c]:a[me({c:I.c,r:I.r})])&&++I.c,D={ixfe:I.ixfe,XF:g[I.ixfe]||{},v:I.val,t:"n"},0<T&&(D.z=R[D.ixfe>>8&31]),Pu(D,t,s.opts.Date1904),n({c:I.c,r:I.r},D,t);break;case"BoolErr":D={ixfe:I.ixfe,XF:g[I.ixfe],v:I.val,t:I.t},0<T&&(D.z=R[D.ixfe>>8&31]),Pu(D,t,s.opts.Date1904),n({c:I.c,r:I.r},D,t);break;case"RK":D={ixfe:I.ixfe,XF:g[I.ixfe],v:I.rknum,t:"n"},0<T&&(D.z=R[D.ixfe>>8&31]),Pu(D,t,s.opts.Date1904),n({c:I.c,r:I.r},D,t);break;case"MulRk":for(var k=I.c;k<=I.C;++k){var ee=I.rkrec[k-I.c][0],D={ixfe:ee,XF:g[ee],v:I.rkrec[k-I.c][1],t:"n"};0<T&&(D.z=R[D.ixfe>>8&31]),Pu(D,t,s.opts.Date1904),n({c:k,r:I.r},D,t)}break;case"Formula":"String"==I.val?c=I:((D=Fu(I.val,I.cell.ixfe,I.tt)).XF=g[D.ixfe],t.cellFormula&&(!((O=I.formula)&&O[0]&&O[0][0]&&"PtgExp"==O[0][0][0])||W[Q=me({r:te=O[0][0][1][0],c:O=O[0][0][1][1]})]?D.f=""+ja(I.formula,0,I.cell,w,y):D.F=((t.dense?(a[te]||[])[O]:a[Q])||{}).F),0<T&&(D.z=R[D.ixfe>>8&31]),Pu(D,t,s.opts.Date1904),n(I.cell,D,t),c=I);break;case"String":if(!c)throw new Error("String record expects Formula");(D=Fu(c.val=I,c.cell.ixfe,"s")).XF=g[D.ixfe],t.cellFormula&&(D.f=""+ja(c.formula,0,c.cell,w,y)),0<T&&(D.z=R[D.ixfe>>8&31]),Pu(D,t,s.opts.Date1904),n(c.cell,D,t),c=null;break;case"Array":f.push(I);var te=me(I[0].s),L=t.dense?(a[I[0].s.r]||[])[I[0].s.c]:a[te];if(t.cellFormula&&L){if(!c)break;if(!te||!L)break;L.f=""+ja(I[1],0,I[0],w,y),L.F=ye(I[0])}break;case"ShrFmla":if(p&&(t.cellFormula&&V)){if(!c)break;W[me(c.cell)]=I[0],((L=t.dense?(a[c.cell.r]||[])[c.cell.c]:a[me(c.cell)])||{}).f=""+ja(I[0],0,P,w,y)}break;case"LabelSst":D=Fu(d[I.isst].t,I.ixfe,"s"),d[I.isst].h&&(D.h=d[I.isst].h),D.XF=g[D.ixfe],0<T&&(D.z=R[D.ixfe>>8&31]),Pu(D,t,s.opts.Date1904),n({c:I.c,r:I.r},D,t);break;case"Blank":t.sheetStubs&&(D={ixfe:I.ixfe,XF:g[I.ixfe],t:"z"},0<T&&(D.z=R[D.ixfe>>8&31]),Pu(D,t,s.opts.Date1904),n({c:I.c,r:I.r},D,t));break;case"MulBlank":if(t.sheetStubs)for(var ne=I.c;ne<=I.C;++ne){var re=I.ixfe[ne-I.c];D={ixfe:re,XF:g[re],t:"z"},0<T&&(D.z=R[D.ixfe>>8&31]),Pu(D,t,s.opts.Date1904),n({c:ne,r:I.r},D,t)}break;case"RString":case"Label":case"BIFF2STR":(D=Fu(I.val,I.ixfe,"s")).XF=g[D.ixfe],0<T&&(D.z=R[D.ixfe>>8&31]),Pu(D,t,s.opts.Date1904),n({c:I.c,r:I.r},D,t);break;case"Dimensions":1===S&&(u=I);break;case"SST":d=I;break;case"Format":if(4==y.biff){R[T++]=I[1];for(var ie=0;ie<T+163&&le._table[ie]!=I[1];++ie);163<=ie&&le.load(I[1],T+163)}else le.load(I[1],I[0]);break;case"BIFF2FORMAT":R[T++]=I;for(var oe=0;oe<T+163&&le._table[oe]!=I;++oe);163<=oe&&le.load(I,T+163);break;case"MergeCells":v=v.concat(I);break;case"Obj":b[I.cmo[0]]=y.lastobj=I;break;case"TxO":y.lastobj.TxO=I;break;case"ImData":y.lastobj.ImData=I;break;case"HLink":for(i=I[0].s.r;i<=I[0].e.r;++i)for(r=I[0].s.c;r<=I[0].e.c;++r)(L=t.dense?(a[i]||[])[r]:a[me({c:r,r:i})])&&(L.l=I[1]);break;case"HLinkTooltip":for(i=I[0].s.r;i<=I[0].e.r;++i)for(r=I[0].s.c;r<=I[0].e.c;++r)(L=t.dense?(a[i]||[])[r]:a[me({c:r,r:i})])&&L.l&&(L.l.Tooltip=I[1]);break;case"Note":y.biff<=5&&2<=y.biff||(L=t.dense?(a[I[0].r]||[])[I[0].c]:a[me(I[0])],O=b[I[2]],L||(L=t.dense?(a[I[0].r]||(a[I[0].r]=[]),a[I[0].r][I[0].c]={t:"z"}):a[me(I[0])]={t:"z"},u.e.r=Math.max(u.e.r,I[0].r),u.s.r=Math.min(u.s.r,I[0].r),u.e.c=Math.max(u.e.c,I[0].c),u.s.c=Math.min(u.s.c,I[0].c)),L.c||(L.c=[]),Q={a:I[1],t:O.TxO.t},L.c.push(Q));break;default:switch(N.n){case"ClrtClient":break;case"XFExt":I.ixfe,I.ext.forEach(function(e){e[0]});break;case"DefColWidth":0;break;case"DefaultRowHeight":I[1];break;case"ColInfo":if(y.cellStyles)for(;I.e>=I.s;)E[I.e--]={width:I.w/256},G||(G=!0,fs(I.w/256)),ps(E[I.e+1]);break;case"Row":var se={};null!=I.level&&((C[I.r]=se).level=I.level),I.hidden&&((C[I.r]=se).hidden=!0),I.hpt&&((C[I.r]=se).hpt=I.hpt,se.hpx=ys(I.hpt));break;case"LeftMargin":case"RightMargin":case"TopMargin":case"BottomMargin":a["!margins"]||ul(a["!margins"]={}),a["!margins"][J.slice(0,-6).toLowerCase()]=I;break;case"Setup":a["!margins"]||ul(a["!margins"]={}),a["!margins"].header=I.header,a["!margins"].footer=I.footer;break;case"Window2":I.RTL&&(m.Views[0].RTL=!0);break;case"Header":case"Footer":case"HCenter":case"VCenter":case"Pls":case"GCW":case"LHRecord":case"DBCell":case"EntExU2":case"SxView":case"Sxvd":case"SXVI":case"SXVDEx":case"SxIvd":case"SXString":case"Sync":case"Addin":case"SXDI":case"SXLI":case"SXEx":case"QsiSXTag":case"Selection":case"Feat":break;case"FeatHdr":case"FeatHdr11":break;case"Feature11":case"Feature12":case"List12":break;case"Country":F=I;break;case"RecalcId":case"DxGCol":break;case"Fbi":case"Fbi2":case"GelFrame":case"Font":case"XFCRC":case"Style":case"StyleExt":break;case"Palette":$=I;break;case"Theme":B=I;break;case"ScenarioProtect":case"ObjProtect":case"CondFmt12":case"Table":case"TableStyles":case"TableStyle":case"TableStyleElement":case"SXStreamID":case"SXVS":case"DConRef":case"SXAddl":case"DConBin":case"DConName":case"SXPI":case"SxFormat":case"SxSelect":case"SxRule":case"SxFilt":case"SxItm":case"SxDXF":case"ScenMan":case"DCon":case"CellWatch":case"PrintRowCol":case"PrintGrid":case"PrintSize":case"XCT":case"CRN":case"Scl":case"SheetExt":case"SheetExtOptional":case"ObNoMacros":case"ObProj":break;case"CodeName":h?j.CodeName=I||j.name:m.WBProps.CodeName=I||"ThisWorkbook";break;case"GUIDTypeLib":case"WOpt":case"PhoneticInfo":case"OleObjectSize":break;case"DXF":case"DXFN":case"DXFN12":case"DXFN12List":case"DXFN12NoCB":break;case"Dv":case"DVal":break;case"BRAI":case"Series":case"SeriesText":case"DConn":case"DbOrParamQry":case"DBQueryExt":case"OleDbConn":case"ExtString":case"IFmtRecord":break;case"CondFmt":case"CF":case"CF12":case"CFEx":case"Excel9File":case"Units":break;case"InterfaceHdr":case"Mms":case"InterfaceEnd":case"DSF":case"BuiltInFnGroupCount":break;case"Window1":case"HideObj":case"GridSet":case"Guts":case"UserBView":case"UserSViewBegin":case"UserSViewEnd":case"Pane":break;default:switch(N.n){case"Dat":case"Begin":case"End":case"StartBlock":case"EndBlock":case"Frame":case"Area":case"Axis":case"AxisLine":case"Tick":break;case"AxesUsed":case"CrtLayout12":case"CrtLayout12A":case"CrtLink":case"CrtLine":case"CrtMlFrt":case"CrtMlFrtContinue":break;case"LineFormat":case"AreaFormat":case"Chart":case"Chart3d":case"Chart3DBarShape":case"ChartFormat":case"ChartFrtInfo":break;case"PlotArea":case"PlotGrowth":break;case"SeriesList":case"SerParent":case"SerAuxTrend":break;case"DataFormat":case"SerToCrt":case"FontX":break;case"CatSerRange":case"AxcExt":case"SerFmt":case"ShtProps":break;case"DefaultText":case"Text":case"CatLab":case"DataLabExtContents":break;case"Legend":case"LegendException":break;case"Pie":case"Scatter":break;case"PieFormat":case"MarkerFormat":break;case"StartObject":case"EndObject":break;case"AlRuns":case"ObjectLink":case"SIIndex":break;case"AttachedLabel":case"YMult":break;case"Line":case"Bar":case"Surf":case"AxisParent":case"Pos":case"ValueRange":case"SXViewEx9":case"SXViewLink":case"PivotChartBits":case"SBaseRef":case"TextPropsStream":case"LnExt":case"MkrExt":case"CrtCoopt":break;case"Qsi":case"Qsif":case"Qsir":case"QsiSXTag":case"TxtQry":case"FilterMode":break;case"AutoFilter":case"AutoFilterInfo":case"AutoFilter12":case"DropDownObjIds":case"Sort":case"SortData":case"ShapePropsStream":break;case"MsoDrawing":case"MsoDrawingGroup":case"MsoDrawingSelection":break;case"WebPub":case"AutoWebPub":break;case"HeaderFooter":case"HFPicture":case"PLV":case"HorizontalPageBreaks":case"VerticalPageBreaks":break;case"Backup":case"CompressPictures":case"Compat12":break;case"Continue":case"ContinueFrt12":break;case"FrtFontList":case"FrtWrapper":break;default:switch(N.n){case"TabIdConf":case"Radar":case"RadarArea":case"DropBar":case"Intl":case"CoordList":case"SerAuxErrBar":break;case"BIFF2FONTCLR":case"BIFF2FMTCNT":case"BIFF2FONTXTRA":break;case"BIFF2XF":case"BIFF3XF":case"BIFF4XF":break;case"BIFF4FMTCNT":case"BIFF2ROW":case"BIFF2WINDOW2":break;case"SCENARIO":case"DConBin":case"PicF":case"DataLabExt":case"Lel":case"BopPop":case"BopPopCustom":case"RealTimeData":case"Name":break;case"LHNGraph":case"FnGroupName":case"AddMenu":case"LPr":break;case"ListObj":case"ListField":case"RRSort":case"BigName":break;case"ToolbarHdr":case"ToolbarEnd":case"DDEObjName":case"FRTArchId$":break;default:if(t.WTF)throw"Unrecognized Record "+N.n}}}}}else e.l+=_}return s.SheetNames=ue(l).sort(function(e,t){return Number(e)-Number(t)}).map(function(e){return l[e].name}),t.bookSheets||(s.Sheets=H),s.Sheets&&X.forEach(function(e,t){s.Sheets[s.SheetNames[t]]["!autofilter"]=e}),s.Preamble=U,s.Strings=d,s.SSF=le.get_table(),y.enc&&(s.Encryption=y.enc),B&&(s.Themes=B),s.Metadata={},void 0!==F&&(s.Metadata.Country=F),0<w.names.length&&(m.Names=w.names),s.Workbook=m,s}var Hu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Uu(e,t){var n,r,i;if(Dc(t=t||{}),m(),t.codepage&&p(t.codepage),e.FullPaths){if(Q.find(e,"/encryption"))throw new Error("File is password-protected");o=Q.find(e,"!CompObj"),s=Q.find(e,"/Workbook")||Q.find(e,"/Book")}else{switch(t.type){case"base64":e=re(S.decode(e));break;case"binary":e=re(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}fe(e,0),s={content:e}}if(o&&Lu(o),t.bookProps&&!t.bookSheets)n={};else{var o=T?"buffer":"array";if(s&&s.content)n=Bu(s.content,t);else{if(!((s=Q.find(e,"PerfectOffice_MAIN"))&&s.content||(s=Q.find(e,"NativeContent_MAIN"))&&s.content))throw new Error("Cannot find Workbook stream");n=co.to_workbook(s.content,(t.type=o,t))}t.bookVBA&&e.FullPaths&&Q.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=(r=e,i=Q.utils.cfb_new({root:"R"}),r.FullPaths.forEach(function(e,t){"/"!==e.slice(-1)&&e.match(/_VBA_PROJECT_CUR/)&&(e=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,""),Q.utils.cfb_add(i,e,r.FileIndex[t].content))}),Q.write(i)))}var s={};if(e.FullPaths){var o=e,a=s,l=t,u=Q.find(o,"!DocumentSummaryInformation");if(u&&0<u.size)try{var c,d=Ur(u,Hn,Hu.DSI);for(c in d)a[c]=d[c]}catch(e){if(l.WTF)throw e}if((u=Q.find(o,"!SummaryInformation"))&&0<u.size)try{var h,f=Ur(u,Un,Hu.SI);for(h in f)null==a[h]&&(a[h]=f[h])}catch(e){if(l.WTF)throw e}a.HeadingPairs&&a.TitlesOfParts&&(br(a.HeadingPairs,a.TitlesOfParts,a,l),delete a.HeadingPairs,delete a.TitlesOfParts)}return n.Props=n.Custprops=s,t.bookFiles&&(n.cfb=e),n}function Vu(e,t){var n,r,i=t||{},t=Q.utils.cfb_new({root:"R"}),o="/Workbook";switch(i.bookType||"xls"){case"xls":i.bookType="biff8";case"xla":i.bookType||(i.bookType="xla");case"biff8":o="/Workbook",i.biff=8;break;case"biff5":o="/Book",i.biff=5;break;default:throw new Error("invalid type "+i.bookType+" for XLS CFB")}if(Q.utils.cfb_add(t,o,tc(e,i)),8==i.biff&&(e.Props||e.Custprops)){var s,a=e,l=t,u=[],c=[],d=[],h=0;if(a.Props)for(s=ue(a.Props),h=0;h<s.length;++h)(Object.prototype.hasOwnProperty.call(Wn,s[h])?u:Object.prototype.hasOwnProperty.call($n,s[h])?c:d).push([s[h],a.Props[s[h]]]);if(a.Custprops)for(s=ue(a.Custprops),h=0;h<s.length;++h)Object.prototype.hasOwnProperty.call(a.Props||{},s[h])||(Object.prototype.hasOwnProperty.call(Wn,s[h])?u:Object.prototype.hasOwnProperty.call($n,s[h])?c:d).push([s[h],a.Custprops[s[h]]]);for(var f=[],h=0;h<d.length;++h)-1<Br.indexOf(d[h][0])||null!=d[h][1]&&f.push(d[h]);c.length&&Q.utils.cfb_add(l,"/SummaryInformation",Vr(c,Hu.SI,$n,Un)),(u.length||f.length)&&Q.utils.cfb_add(l,"/DocumentSummaryInformation",Vr(u,Hu.DSI,Wn,Hn,f.length?f:null,Hu.UDI))}return 8==i.biff&&e.vbaraw&&(n=t,(r=Q.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})).FullPaths.forEach(function(e,t){0!=t&&"/"!==(e=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/")).slice(-1)&&Q.utils.cfb_add(n,e,r.FileIndex[t].content)})),t}var Wu={0:{n:"BrtRowHdr",f:function(e,t){var n={},t=e.l+t,r=(n.r=e._R(4),e.l+=4,e._R(2)),i=(e.l+=1,e._R(1));return e.l=t,7&i&&(n.level=7&i),16&i&&(n.hidden=!0),32&i&&(n.hpt=r/20),n}},1:{n:"BrtCellBlank",f:function(e){return[bn(e)]}},2:{n:"BrtCellRk",f:function(e){return[bn(e),Nn(e),"n"]}},3:{n:"BrtCellError",f:function(e){return[bn(e),e._R(1),"e"]}},4:{n:"BrtCellBool",f:function(e){return[bn(e),e._R(1),"b"]}},5:{n:"BrtCellReal",f:function(e){return[bn(e),Mn(e),"n"]}},6:{n:"BrtCellSt",f:function(e){return[bn(e),pn(e),"str"]}},7:{n:"BrtCellIsst",f:function(e){return[bn(e),e._R(4),"s"]}},8:{n:"BrtFmlaString",f:function(e,t,n){var r,t=e.l+t,i=bn(e),o=(i.r=n["!row"],pn(e)),o=[i,o,"str"];return n.cellFormula?(e.l+=2,r=Ka(e,t-e.l,n),o[3]=ja(r,0,i,n.supbooks,n)):e.l=t,o}},9:{n:"BrtFmlaNum",f:function(e,t,n){var r,t=e.l+t,i=bn(e),o=(i.r=n["!row"],Mn(e)),o=[i,o,"n"];return n.cellFormula?(e.l+=2,r=Ka(e,t-e.l,n),o[3]=ja(r,0,i,n.supbooks,n)):e.l=t,o}},10:{n:"BrtFmlaBool",f:function(e,t,n){var r,t=e.l+t,i=bn(e),o=(i.r=n["!row"],e._R(1)),o=[i,o,"b"];return n.cellFormula?(e.l+=2,r=Ka(e,t-e.l,n),o[3]=ja(r,0,i,n.supbooks,n)):e.l=t,o}},11:{n:"BrtFmlaError",f:function(e,t,n){var r,t=e.l+t,i=bn(e),o=(i.r=n["!row"],e._R(1)),o=[i,o,"e"];return n.cellFormula?(e.l+=2,r=Ka(e,t-e.l,n),o[3]=ja(r,0,i,n.supbooks,n)):e.l=t,o}},16:{n:"BrtFRTArchID$",f:function(e,t){var n={};return e._R(4),n.ArchID=e._R(4),e.l+=t-8,n}},19:{n:"BrtSSTItem",f:mn},20:{n:"BrtPCDIMissing"},21:{n:"BrtPCDINumber"},22:{n:"BrtPCDIBoolean"},23:{n:"BrtPCDIError"},24:{n:"BrtPCDIString"},25:{n:"BrtPCDIDatetime"},26:{n:"BrtPCDIIndex"},27:{n:"BrtPCDIAMissing"},28:{n:"BrtPCDIANumber"},29:{n:"BrtPCDIABoolean"},30:{n:"BrtPCDIAError"},31:{n:"BrtPCDIAString"},32:{n:"BrtPCDIADatetime"},33:{n:"BrtPCRRecord"},34:{n:"BrtPCRRecordDt"},35:{n:"BrtFRTBegin"},36:{n:"BrtFRTEnd"},37:{n:"BrtACBegin"},38:{n:"BrtACEnd"},39:{n:"BrtName",f:function(e,t,n){var t=e.l+t,r=(e.l+=4,e.l+=1,e._R(4)),i=Rn(e),n=qa(e,0,n),o=Sn(e),e=(e.l=t,{Name:i,Ptg:n});return r<268435455&&(e.Sheet=r),o&&(e.Comment=o),e}},40:{n:"BrtIndexRowBlock"},42:{n:"BrtIndexBlock"},43:{n:"BrtFont",f:function(e,t,n){var r={};switch(r.sz=e._R(2)/20,o=(i=e)._R(1),i.l++,(i={fBold:1&o,fItalic:2&o,fUnderline:4&o,fStrikeout:8&o,fOutline:16&o,fShadow:32&o,fCondense:64&o,fExtend:128&o}).fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1),700===e._R(2)&&(r.bold=1),e._R(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var i,o=e._R(1);switch(0!=o&&(r.underline=o),0<(i=e._R(1))&&(r.family=i),0<(o=e._R(1))&&(r.charset=o),e.l++,r.color=function(e){var t={},n=e._R(1)>>>1,r=e._R(1),i=e._R(2,"i"),o=e._R(1),s=e._R(1),a=e._R(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:var l=Yn[t.index=r];l&&(t.rgb=rs(l));break;case 2:t.rgb=rs([o,s,a]);break;case 3:t.theme=r}return 0!=i&&(t.tint=0<i?i/32767:i/32768),t}(e),e._R(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=pn(e),r}},44:{n:"BrtFmt",f:function(e,t){return[e._R(2),pn(e)]}},45:{n:"BrtFill",f:Is},46:{n:"BrtBorder",f:Ls},47:{n:"BrtXF",f:function(e,t){var t=e.l+t,n=e._R(2),r=e._R(2);return e.l=t,{ixfe:n,numFmtId:r}}},48:{n:"BrtStyle"},49:{n:"BrtCellMeta"},50:{n:"BrtValueMeta"},51:{n:"BrtMdb"},52:{n:"BrtBeginFmd"},53:{n:"BrtEndFmd"},54:{n:"BrtBeginMdx"},55:{n:"BrtEndMdx"},56:{n:"BrtBeginMdxTuple"},57:{n:"BrtEndMdxTuple"},58:{n:"BrtMdxMbrIstr"},59:{n:"BrtStr"},60:{n:"BrtColInfo",f:_i},62:{n:"BrtCellRString"},63:{n:"BrtCalcChainItem$",f:function(e){var t={},n=(t.i=e._R(4),{});return n.r=e._R(4),n.c=e._R(4),t.r=me(n),2&(n=e._R(1))&&(t.l="1"),8&n&&(t.a="1"),t}},64:{n:"BrtDVal",f:function(){}},65:{n:"BrtSxvcellNum"},66:{n:"BrtSxvcellStr"},67:{n:"BrtSxvcellBool"},68:{n:"BrtSxvcellErr"},69:{n:"BrtSxvcellDate"},70:{n:"BrtSxvcellNil"},128:{n:"BrtFileVersion"},129:{n:"BrtBeginSheet"},130:{n:"BrtEndSheet"},131:{n:"BrtBeginBook",f:h,p:0},132:{n:"BrtEndBook"},133:{n:"BrtBeginWsViews"},134:{n:"BrtEndWsViews"},135:{n:"BrtBeginBookViews"},136:{n:"BrtEndBookViews"},137:{n:"BrtBeginWsView",f:function(e){var t=e._R(2);return e.l+=28,{RTL:32&t}}},138:{n:"BrtEndWsView"},139:{n:"BrtBeginCsViews"},140:{n:"BrtEndCsViews"},141:{n:"BrtBeginCsView"},142:{n:"BrtEndCsView"},143:{n:"BrtBeginBundleShs"},144:{n:"BrtEndBundleShs"},145:{n:"BrtBeginSheetData"},146:{n:"BrtEndSheetData"},147:{n:"BrtWsProp",f:function(e,t){var n={};return e.l+=19,n.name=Cn(e,t-19),n}},148:{n:"BrtWsDim",f:Oa,p:16},151:{n:"BrtPane",f:function(){}},152:{n:"BrtSel"},153:{n:"BrtWbProp",f:function(e,t){var n={},r=e._R(4);return n.defaultThemeVersion=e._R(4),0<(t=8<t?pn(e):"").length&&(n.CodeName=t),n.autoCompressPictures=!!(65536&r),n.backupFile=!!(64&r),n.checkCompatibility=!!(4096&r),n.date1904=!!(1&r),n.filterPrivacy=!!(8&r),n.hidePivotFieldList=!!(1024&r),n.promptedSolutions=!!(16&r),n.publishItems=!!(2048&r),n.refreshAllConnections=!!(262144&r),n.saveExternalLinkValues=!!(128&r),n.showBorderUnselectedTables=!!(4&r),n.showInkAnnotation=!!(32&r),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(32768&r),n.updateLinks=["userSet","never","always"][r>>8&3],n}},154:{n:"BrtWbFactoid"},155:{n:"BrtFileRecover"},156:{n:"BrtBundleSh",f:function(e,t){var n={};return n.Hidden=e._R(4),n.iTabID=e._R(4),n.strRelID=An(e,t-8),n.name=pn(e),n}},157:{n:"BrtCalcProp"},158:{n:"BrtBookView"},159:{n:"BrtBeginSst",f:function(e){return[e._R(4),e._R(4)]}},160:{n:"BrtEndSst"},161:{n:"BrtBeginAFilter",f:On},162:{n:"BrtEndAFilter"},163:{n:"BrtBeginFilterColumn"},164:{n:"BrtEndFilterColumn"},165:{n:"BrtBeginFilters"},166:{n:"BrtEndFilters"},167:{n:"BrtFilter"},168:{n:"BrtColorFilter"},169:{n:"BrtIconFilter"},170:{n:"BrtTop10Filter"},171:{n:"BrtDynamicFilter"},172:{n:"BrtBeginCustomFilters"},173:{n:"BrtEndCustomFilters"},174:{n:"BrtCustomFilter"},175:{n:"BrtAFilterDateGroupItem"},176:{n:"BrtMergeCell",f:wa},177:{n:"BrtBeginMergeCells"},178:{n:"BrtEndMergeCells"},179:{n:"BrtBeginPivotCacheDef"},180:{n:"BrtEndPivotCacheDef"},181:{n:"BrtBeginPCDFields"},182:{n:"BrtEndPCDFields"},183:{n:"BrtBeginPCDField"},184:{n:"BrtEndPCDField"},185:{n:"BrtBeginPCDSource"},186:{n:"BrtEndPCDSource"},187:{n:"BrtBeginPCDSRange"},188:{n:"BrtEndPCDSRange"},189:{n:"BrtBeginPCDFAtbl"},190:{n:"BrtEndPCDFAtbl"},191:{n:"BrtBeginPCDIRun"},192:{n:"BrtEndPCDIRun"},193:{n:"BrtBeginPivotCacheRecords"},194:{n:"BrtEndPivotCacheRecords"},195:{n:"BrtBeginPCDHierarchies"},196:{n:"BrtEndPCDHierarchies"},197:{n:"BrtBeginPCDHierarchy"},198:{n:"BrtEndPCDHierarchy"},199:{n:"BrtBeginPCDHFieldsUsage"},200:{n:"BrtEndPCDHFieldsUsage"},201:{n:"BrtBeginExtConnection"},202:{n:"BrtEndExtConnection"},203:{n:"BrtBeginECDbProps"},204:{n:"BrtEndECDbProps"},205:{n:"BrtBeginECOlapProps"},206:{n:"BrtEndECOlapProps"},207:{n:"BrtBeginPCDSConsol"},208:{n:"BrtEndPCDSConsol"},209:{n:"BrtBeginPCDSCPages"},210:{n:"BrtEndPCDSCPages"},211:{n:"BrtBeginPCDSCPage"},212:{n:"BrtEndPCDSCPage"},213:{n:"BrtBeginPCDSCPItem"},214:{n:"BrtEndPCDSCPItem"},215:{n:"BrtBeginPCDSCSets"},216:{n:"BrtEndPCDSCSets"},217:{n:"BrtBeginPCDSCSet"},218:{n:"BrtEndPCDSCSet"},219:{n:"BrtBeginPCDFGroup"},220:{n:"BrtEndPCDFGroup"},221:{n:"BrtBeginPCDFGItems"},222:{n:"BrtEndPCDFGItems"},223:{n:"BrtBeginPCDFGRange"},224:{n:"BrtEndPCDFGRange"},225:{n:"BrtBeginPCDFGDiscrete"},226:{n:"BrtEndPCDFGDiscrete"},227:{n:"BrtBeginPCDSDTupleCache"},228:{n:"BrtEndPCDSDTupleCache"},229:{n:"BrtBeginPCDSDTCEntries"},230:{n:"BrtEndPCDSDTCEntries"},231:{n:"BrtBeginPCDSDTCEMembers"},232:{n:"BrtEndPCDSDTCEMembers"},233:{n:"BrtBeginPCDSDTCEMember"},234:{n:"BrtEndPCDSDTCEMember"},235:{n:"BrtBeginPCDSDTCQueries"},236:{n:"BrtEndPCDSDTCQueries"},237:{n:"BrtBeginPCDSDTCQuery"},238:{n:"BrtEndPCDSDTCQuery"},239:{n:"BrtBeginPCDSDTCSets"},240:{n:"BrtEndPCDSDTCSets"},241:{n:"BrtBeginPCDSDTCSet"},242:{n:"BrtEndPCDSDTCSet"},243:{n:"BrtBeginPCDCalcItems"},244:{n:"BrtEndPCDCalcItems"},245:{n:"BrtBeginPCDCalcItem"},246:{n:"BrtEndPCDCalcItem"},247:{n:"BrtBeginPRule"},248:{n:"BrtEndPRule"},249:{n:"BrtBeginPRFilters"},250:{n:"BrtEndPRFilters"},251:{n:"BrtBeginPRFilter"},252:{n:"BrtEndPRFilter"},253:{n:"BrtBeginPNames"},254:{n:"BrtEndPNames"},255:{n:"BrtBeginPName"},256:{n:"BrtEndPName"},257:{n:"BrtBeginPNPairs"},258:{n:"BrtEndPNPairs"},259:{n:"BrtBeginPNPair"},260:{n:"BrtEndPNPair"},261:{n:"BrtBeginECWebProps"},262:{n:"BrtEndECWebProps"},263:{n:"BrtBeginEcWpTables"},264:{n:"BrtEndECWPTables"},265:{n:"BrtBeginECParams"},266:{n:"BrtEndECParams"},267:{n:"BrtBeginECParam"},268:{n:"BrtEndECParam"},269:{n:"BrtBeginPCDKPIs"},270:{n:"BrtEndPCDKPIs"},271:{n:"BrtBeginPCDKPI"},272:{n:"BrtEndPCDKPI"},273:{n:"BrtBeginDims"},274:{n:"BrtEndDims"},275:{n:"BrtBeginDim"},276:{n:"BrtEndDim"},277:{n:"BrtIndexPartEnd"},278:{n:"BrtBeginStyleSheet"},279:{n:"BrtEndStyleSheet"},280:{n:"BrtBeginSXView"},281:{n:"BrtEndSXVI"},282:{n:"BrtBeginSXVI"},283:{n:"BrtBeginSXVIs"},284:{n:"BrtEndSXVIs"},285:{n:"BrtBeginSXVD"},286:{n:"BrtEndSXVD"},287:{n:"BrtBeginSXVDs"},288:{n:"BrtEndSXVDs"},289:{n:"BrtBeginSXPI"},290:{n:"BrtEndSXPI"},291:{n:"BrtBeginSXPIs"},292:{n:"BrtEndSXPIs"},293:{n:"BrtBeginSXDI"},294:{n:"BrtEndSXDI"},295:{n:"BrtBeginSXDIs"},296:{n:"BrtEndSXDIs"},297:{n:"BrtBeginSXLI"},298:{n:"BrtEndSXLI"},299:{n:"BrtBeginSXLIRws"},300:{n:"BrtEndSXLIRws"},301:{n:"BrtBeginSXLICols"},302:{n:"BrtEndSXLICols"},303:{n:"BrtBeginSXFormat"},304:{n:"BrtEndSXFormat"},305:{n:"BrtBeginSXFormats"},306:{n:"BrtEndSxFormats"},307:{n:"BrtBeginSxSelect"},308:{n:"BrtEndSxSelect"},309:{n:"BrtBeginISXVDRws"},310:{n:"BrtEndISXVDRws"},311:{n:"BrtBeginISXVDCols"},312:{n:"BrtEndISXVDCols"},313:{n:"BrtEndSXLocation"},314:{n:"BrtBeginSXLocation"},315:{n:"BrtEndSXView"},316:{n:"BrtBeginSXTHs"},317:{n:"BrtEndSXTHs"},318:{n:"BrtBeginSXTH"},319:{n:"BrtEndSXTH"},320:{n:"BrtBeginISXTHRws"},321:{n:"BrtEndISXTHRws"},322:{n:"BrtBeginISXTHCols"},323:{n:"BrtEndISXTHCols"},324:{n:"BrtBeginSXTDMPS"},325:{n:"BrtEndSXTDMPs"},326:{n:"BrtBeginSXTDMP"},327:{n:"BrtEndSXTDMP"},328:{n:"BrtBeginSXTHItems"},329:{n:"BrtEndSXTHItems"},330:{n:"BrtBeginSXTHItem"},331:{n:"BrtEndSXTHItem"},332:{n:"BrtBeginMetadata"},333:{n:"BrtEndMetadata"},334:{n:"BrtBeginEsmdtinfo"},335:{n:"BrtMdtinfo"},336:{n:"BrtEndEsmdtinfo"},337:{n:"BrtBeginEsmdb"},338:{n:"BrtEndEsmdb"},339:{n:"BrtBeginEsfmd"},340:{n:"BrtEndEsfmd"},341:{n:"BrtBeginSingleCells"},342:{n:"BrtEndSingleCells"},343:{n:"BrtBeginList"},344:{n:"BrtEndList"},345:{n:"BrtBeginListCols"},346:{n:"BrtEndListCols"},347:{n:"BrtBeginListCol"},348:{n:"BrtEndListCol"},349:{n:"BrtBeginListXmlCPr"},350:{n:"BrtEndListXmlCPr"},351:{n:"BrtListCCFmla"},352:{n:"BrtListTrFmla"},353:{n:"BrtBeginExternals"},354:{n:"BrtEndExternals"},355:{n:"BrtSupBookSrc",f:An},357:{n:"BrtSupSelf"},358:{n:"BrtSupSame"},359:{n:"BrtSupTabs"},360:{n:"BrtBeginSupBook"},361:{n:"BrtPlaceholderName"},362:{n:"BrtExternSheet",f:Si},363:{n:"BrtExternTableStart"},364:{n:"BrtExternTableEnd"},366:{n:"BrtExternRowHdr"},367:{n:"BrtExternCellBlank"},368:{n:"BrtExternCellReal"},369:{n:"BrtExternCellBool"},370:{n:"BrtExternCellError"},371:{n:"BrtExternCellString"},372:{n:"BrtBeginEsmdx"},373:{n:"BrtEndEsmdx"},374:{n:"BrtBeginMdxSet"},375:{n:"BrtEndMdxSet"},376:{n:"BrtBeginMdxMbrProp"},377:{n:"BrtEndMdxMbrProp"},378:{n:"BrtBeginMdxKPI"},379:{n:"BrtEndMdxKPI"},380:{n:"BrtBeginEsstr"},381:{n:"BrtEndEsstr"},382:{n:"BrtBeginPRFItem"},383:{n:"BrtEndPRFItem"},384:{n:"BrtBeginPivotCacheIDs"},385:{n:"BrtEndPivotCacheIDs"},386:{n:"BrtBeginPivotCacheID"},387:{n:"BrtEndPivotCacheID"},388:{n:"BrtBeginISXVIs"},389:{n:"BrtEndISXVIs"},390:{n:"BrtBeginColInfos"},391:{n:"BrtEndColInfos"},392:{n:"BrtBeginRwBrk"},393:{n:"BrtEndRwBrk"},394:{n:"BrtBeginColBrk"},395:{n:"BrtEndColBrk"},396:{n:"BrtBrk"},397:{n:"BrtUserBookView"},398:{n:"BrtInfo"},399:{n:"BrtCUsr"},400:{n:"BrtUsr"},401:{n:"BrtBeginUsers"},403:{n:"BrtEOF"},404:{n:"BrtUCR"},405:{n:"BrtRRInsDel"},406:{n:"BrtRREndInsDel"},407:{n:"BrtRRMove"},408:{n:"BrtRREndMove"},409:{n:"BrtRRChgCell"},410:{n:"BrtRREndChgCell"},411:{n:"BrtRRHeader"},412:{n:"BrtRRUserView"},413:{n:"BrtRRRenSheet"},414:{n:"BrtRRInsertSh"},415:{n:"BrtRRDefName"},416:{n:"BrtRRNote"},417:{n:"BrtRRConflict"},418:{n:"BrtRRTQSIF"},419:{n:"BrtRRFormat"},420:{n:"BrtRREndFormat"},421:{n:"BrtRRAutoFmt"},422:{n:"BrtBeginUserShViews"},423:{n:"BrtBeginUserShView"},424:{n:"BrtEndUserShView"},425:{n:"BrtEndUserShViews"},426:{n:"BrtArrFmla",f:function(e,t,n){var t=e.l+t,r=xn(e),i=e._R(1);return(r=[r])[2]=i,n.cellFormula?(i=Xa(e,t-e.l,n),r[1]=i):e.l=t,r}},427:{n:"BrtShrFmla",f:function(e,t,n){var t=e.l+t,r=[On(e,16)];return n.cellFormula&&(n=Za(e,t-e.l,n),r[1]=n),e.l=t,r}},428:{n:"BrtTable"},429:{n:"BrtBeginExtConnections"},430:{n:"BrtEndExtConnections"},431:{n:"BrtBeginPCDCalcMems"},432:{n:"BrtEndPCDCalcMems"},433:{n:"BrtBeginPCDCalcMem"},434:{n:"BrtEndPCDCalcMem"},435:{n:"BrtBeginPCDHGLevels"},436:{n:"BrtEndPCDHGLevels"},437:{n:"BrtBeginPCDHGLevel"},438:{n:"BrtEndPCDHGLevel"},439:{n:"BrtBeginPCDHGLGroups"},440:{n:"BrtEndPCDHGLGroups"},441:{n:"BrtBeginPCDHGLGroup"},442:{n:"BrtEndPCDHGLGroup"},443:{n:"BrtBeginPCDHGLGMembers"},444:{n:"BrtEndPCDHGLGMembers"},445:{n:"BrtBeginPCDHGLGMember"},446:{n:"BrtEndPCDHGLGMember"},447:{n:"BrtBeginQSI"},448:{n:"BrtEndQSI"},449:{n:"BrtBeginQSIR"},450:{n:"BrtEndQSIR"},451:{n:"BrtBeginDeletedNames"},452:{n:"BrtEndDeletedNames"},453:{n:"BrtBeginDeletedName"},454:{n:"BrtEndDeletedName"},455:{n:"BrtBeginQSIFs"},456:{n:"BrtEndQSIFs"},457:{n:"BrtBeginQSIF"},458:{n:"BrtEndQSIF"},459:{n:"BrtBeginAutoSortScope"},460:{n:"BrtEndAutoSortScope"},461:{n:"BrtBeginConditionalFormatting"},462:{n:"BrtEndConditionalFormatting"},463:{n:"BrtBeginCFRule"},464:{n:"BrtEndCFRule"},465:{n:"BrtBeginIconSet"},466:{n:"BrtEndIconSet"},467:{n:"BrtBeginDatabar"},468:{n:"BrtEndDatabar"},469:{n:"BrtBeginColorScale"},470:{n:"BrtEndColorScale"},471:{n:"BrtCFVO"},472:{n:"BrtExternValueMeta"},473:{n:"BrtBeginColorPalette"},474:{n:"BrtEndColorPalette"},475:{n:"BrtIndexedColor"},476:{n:"BrtMargins",f:function(t){var n={};return Vl.forEach(function(e){n[e]=Mn(t)}),n}},477:{n:"BrtPrintOptions"},478:{n:"BrtPageSetup"},479:{n:"BrtBeginHeaderFooter"},480:{n:"BrtEndHeaderFooter"},481:{n:"BrtBeginSXCrtFormat"},482:{n:"BrtEndSXCrtFormat"},483:{n:"BrtBeginSXCrtFormats"},484:{n:"BrtEndSXCrtFormats"},485:{n:"BrtWsFmtInfo",f:function(){}},486:{n:"BrtBeginMgs"},487:{n:"BrtEndMGs"},488:{n:"BrtBeginMGMaps"},489:{n:"BrtEndMGMaps"},490:{n:"BrtBeginMG"},491:{n:"BrtEndMG"},492:{n:"BrtBeginMap"},493:{n:"BrtEndMap"},494:{n:"BrtHLink",f:function(e,t){var t=e.l+t,n=On(e,16),r=Sn(e),i=pn(e),o=pn(e),s=pn(e),e=(e.l=t,{rfx:n,relId:r,loc:i,display:s});return o&&(e.Tooltip=o),e}},495:{n:"BrtBeginDCon"},496:{n:"BrtEndDCon"},497:{n:"BrtBeginDRefs"},498:{n:"BrtEndDRefs"},499:{n:"BrtDRef"},500:{n:"BrtBeginScenMan"},501:{n:"BrtEndScenMan"},502:{n:"BrtBeginSct"},503:{n:"BrtEndSct"},504:{n:"BrtSlc"},505:{n:"BrtBeginDXFs"},506:{n:"BrtEndDXFs"},507:{n:"BrtDXF"},508:{n:"BrtBeginTableStyles"},509:{n:"BrtEndTableStyles"},510:{n:"BrtBeginTableStyle"},511:{n:"BrtEndTableStyle"},512:{n:"BrtTableStyleElement"},513:{n:"BrtTableStyleClient"},514:{n:"BrtBeginVolDeps"},515:{n:"BrtEndVolDeps"},516:{n:"BrtBeginVolType"},517:{n:"BrtEndVolType"},518:{n:"BrtBeginVolMain"},519:{n:"BrtEndVolMain"},520:{n:"BrtBeginVolTopic"},521:{n:"BrtEndVolTopic"},522:{n:"BrtVolSubtopic"},523:{n:"BrtVolRef"},524:{n:"BrtVolNum"},525:{n:"BrtVolErr"},526:{n:"BrtVolStr"},527:{n:"BrtVolBool"},528:{n:"BrtBeginCalcChain$"},529:{n:"BrtEndCalcChain$"},530:{n:"BrtBeginSortState"},531:{n:"BrtEndSortState"},532:{n:"BrtBeginSortCond"},533:{n:"BrtEndSortCond"},534:{n:"BrtBookProtection"},535:{n:"BrtSheetProtection"},536:{n:"BrtRangeProtection"},537:{n:"BrtPhoneticInfo"},538:{n:"BrtBeginECTxtWiz"},539:{n:"BrtEndECTxtWiz"},540:{n:"BrtBeginECTWFldInfoLst"},541:{n:"BrtEndECTWFldInfoLst"},542:{n:"BrtBeginECTwFldInfo"},548:{n:"BrtFileSharing"},549:{n:"BrtOleSize"},550:{n:"BrtDrawing",f:An},551:{n:"BrtLegacyDrawing"},552:{n:"BrtLegacyDrawingHF"},553:{n:"BrtWebOpt"},554:{n:"BrtBeginWebPubItems"},555:{n:"BrtEndWebPubItems"},556:{n:"BrtBeginWebPubItem"},557:{n:"BrtEndWebPubItem"},558:{n:"BrtBeginSXCondFmt"},559:{n:"BrtEndSXCondFmt"},560:{n:"BrtBeginSXCondFmts"},561:{n:"BrtEndSXCondFmts"},562:{n:"BrtBkHim"},564:{n:"BrtColor"},565:{n:"BrtBeginIndexedColors"},566:{n:"BrtEndIndexedColors"},569:{n:"BrtBeginMRUColors"},570:{n:"BrtEndMRUColors"},572:{n:"BrtMRUColor"},573:{n:"BrtBeginDVals"},574:{n:"BrtEndDVals"},577:{n:"BrtSupNameStart"},578:{n:"BrtSupNameValueStart"},579:{n:"BrtSupNameValueEnd"},580:{n:"BrtSupNameNum"},581:{n:"BrtSupNameErr"},582:{n:"BrtSupNameSt"},583:{n:"BrtSupNameNil"},584:{n:"BrtSupNameBool"},585:{n:"BrtSupNameFmla"},586:{n:"BrtSupNameBits"},587:{n:"BrtSupNameEnd"},588:{n:"BrtEndSupBook"},589:{n:"BrtCellSmartTagProperty"},590:{n:"BrtBeginCellSmartTag"},591:{n:"BrtEndCellSmartTag"},592:{n:"BrtBeginCellSmartTags"},593:{n:"BrtEndCellSmartTags"},594:{n:"BrtBeginSmartTags"},595:{n:"BrtEndSmartTags"},596:{n:"BrtSmartTagType"},597:{n:"BrtBeginSmartTagTypes"},598:{n:"BrtEndSmartTagTypes"},599:{n:"BrtBeginSXFilters"},600:{n:"BrtEndSXFilters"},601:{n:"BrtBeginSXFILTER"},602:{n:"BrtEndSXFilter"},603:{n:"BrtBeginFills"},604:{n:"BrtEndFills"},605:{n:"BrtBeginCellWatches"},606:{n:"BrtEndCellWatches"},607:{n:"BrtCellWatch"},608:{n:"BrtBeginCRErrs"},609:{n:"BrtEndCRErrs"},610:{n:"BrtCrashRecErr"},611:{n:"BrtBeginFonts"},612:{n:"BrtEndFonts"},613:{n:"BrtBeginBorders"},614:{n:"BrtEndBorders"},615:{n:"BrtBeginFmts"},616:{n:"BrtEndFmts"},617:{n:"BrtBeginCellXFs"},618:{n:"BrtEndCellXFs"},619:{n:"BrtBeginStyles"},620:{n:"BrtEndStyles"},625:{n:"BrtBigName"},626:{n:"BrtBeginCellStyleXFs"},627:{n:"BrtEndCellStyleXFs"},628:{n:"BrtBeginComments"},629:{n:"BrtEndComments"},630:{n:"BrtBeginCommentAuthors"},631:{n:"BrtEndCommentAuthors"},632:{n:"BrtCommentAuthor",f:na},633:{n:"BrtBeginCommentList"},634:{n:"BrtEndCommentList"},635:{n:"BrtBeginComment",f:function(e){var t={},n=(t.iauthor=e._R(4),On(e,16));return t.rfx=n.s,t.ref=me(n.s),e.l+=16,t}},636:{n:"BrtEndComment"},637:{n:"BrtCommentText",f:yn},638:{n:"BrtBeginOleObjects"},639:{n:"BrtOleObject"},640:{n:"BrtEndOleObjects"},641:{n:"BrtBeginSxrules"},642:{n:"BrtEndSxRules"},643:{n:"BrtBeginActiveXControls"},644:{n:"BrtActiveX"},645:{n:"BrtEndActiveXControls"},646:{n:"BrtBeginPCDSDTCEMembersSortBy"},648:{n:"BrtBeginCellIgnoreECs"},649:{n:"BrtCellIgnoreEC"},650:{n:"BrtEndCellIgnoreECs"},651:{n:"BrtCsProp",f:function(e,t){return e.l+=10,{name:pn(e)}}},652:{n:"BrtCsPageSetup"},653:{n:"BrtBeginUserCsViews"},654:{n:"BrtEndUserCsViews"},655:{n:"BrtBeginUserCsView"},656:{n:"BrtEndUserCsView"},657:{n:"BrtBeginPcdSFCIEntries"},658:{n:"BrtEndPCDSFCIEntries"},659:{n:"BrtPCDSFCIEntry"},660:{n:"BrtBeginListParts"},661:{n:"BrtListPart"},662:{n:"BrtEndListParts"},663:{n:"BrtSheetCalcProp"},664:{n:"BrtBeginFnGroup"},665:{n:"BrtFnGroup"},666:{n:"BrtEndFnGroup"},667:{n:"BrtSupAddin"},668:{n:"BrtSXTDMPOrder"},669:{n:"BrtCsProtection"},671:{n:"BrtBeginWsSortMap"},672:{n:"BrtEndWsSortMap"},673:{n:"BrtBeginRRSort"},674:{n:"BrtEndRRSort"},675:{n:"BrtRRSortItem"},676:{n:"BrtFileSharingIso"},677:{n:"BrtBookProtectionIso"},678:{n:"BrtSheetProtectionIso"},679:{n:"BrtCsProtectionIso"},680:{n:"BrtRangeProtectionIso"},681:{n:"BrtDValList"},1024:{n:"BrtRwDescent"},1025:{n:"BrtKnownFonts"},1026:{n:"BrtBeginSXTupleSet"},1027:{n:"BrtEndSXTupleSet"},1028:{n:"BrtBeginSXTupleSetHeader"},1029:{n:"BrtEndSXTupleSetHeader"},1030:{n:"BrtSXTupleSetHeaderItem"},1031:{n:"BrtBeginSXTupleSetData"},1032:{n:"BrtEndSXTupleSetData"},1033:{n:"BrtBeginSXTupleSetRow"},1034:{n:"BrtEndSXTupleSetRow"},1035:{n:"BrtSXTupleSetRowItem"},1036:{n:"BrtNameExt"},1037:{n:"BrtPCDH14"},1038:{n:"BrtBeginPCDCalcMem14"},1039:{n:"BrtEndPCDCalcMem14"},1040:{n:"BrtSXTH14"},1041:{n:"BrtBeginSparklineGroup"},1042:{n:"BrtEndSparklineGroup"},1043:{n:"BrtSparkline"},1044:{n:"BrtSXDI14"},1045:{n:"BrtWsFmtInfoEx14"},1046:{n:"BrtBeginConditionalFormatting14"},1047:{n:"BrtEndConditionalFormatting14"},1048:{n:"BrtBeginCFRule14"},1049:{n:"BrtEndCFRule14"},1050:{n:"BrtCFVO14"},1051:{n:"BrtBeginDatabar14"},1052:{n:"BrtBeginIconSet14"},1053:{n:"BrtDVal14",f:function(){}},1054:{n:"BrtBeginDVals14"},1055:{n:"BrtColor14"},1056:{n:"BrtBeginSparklines"},1057:{n:"BrtEndSparklines"},1058:{n:"BrtBeginSparklineGroups"},1059:{n:"BrtEndSparklineGroups"},1061:{n:"BrtSXVD14"},1062:{n:"BrtBeginSXView14"},1063:{n:"BrtEndSXView14"},1064:{n:"BrtBeginSXView16"},1065:{n:"BrtEndSXView16"},1066:{n:"BrtBeginPCD14"},1067:{n:"BrtEndPCD14"},1068:{n:"BrtBeginExtConn14"},1069:{n:"BrtEndExtConn14"},1070:{n:"BrtBeginSlicerCacheIDs"},1071:{n:"BrtEndSlicerCacheIDs"},1072:{n:"BrtBeginSlicerCacheID"},1073:{n:"BrtEndSlicerCacheID"},1075:{n:"BrtBeginSlicerCache"},1076:{n:"BrtEndSlicerCache"},1077:{n:"BrtBeginSlicerCacheDef"},1078:{n:"BrtEndSlicerCacheDef"},1079:{n:"BrtBeginSlicersEx"},1080:{n:"BrtEndSlicersEx"},1081:{n:"BrtBeginSlicerEx"},1082:{n:"BrtEndSlicerEx"},1083:{n:"BrtBeginSlicer"},1084:{n:"BrtEndSlicer"},1085:{n:"BrtSlicerCachePivotTables"},1086:{n:"BrtBeginSlicerCacheOlapImpl"},1087:{n:"BrtEndSlicerCacheOlapImpl"},1088:{n:"BrtBeginSlicerCacheLevelsData"},1089:{n:"BrtEndSlicerCacheLevelsData"},1090:{n:"BrtBeginSlicerCacheLevelData"},1091:{n:"BrtEndSlicerCacheLevelData"},1092:{n:"BrtBeginSlicerCacheSiRanges"},1093:{n:"BrtEndSlicerCacheSiRanges"},1094:{n:"BrtBeginSlicerCacheSiRange"},1095:{n:"BrtEndSlicerCacheSiRange"},1096:{n:"BrtSlicerCacheOlapItem"},1097:{n:"BrtBeginSlicerCacheSelections"},1098:{n:"BrtSlicerCacheSelection"},1099:{n:"BrtEndSlicerCacheSelections"},1100:{n:"BrtBeginSlicerCacheNative"},1101:{n:"BrtEndSlicerCacheNative"},1102:{n:"BrtSlicerCacheNativeItem"},1103:{n:"BrtRangeProtection14"},1104:{n:"BrtRangeProtectionIso14"},1105:{n:"BrtCellIgnoreEC14"},1111:{n:"BrtList14"},1112:{n:"BrtCFIcon"},1113:{n:"BrtBeginSlicerCachesPivotCacheIDs"},1114:{n:"BrtEndSlicerCachesPivotCacheIDs"},1115:{n:"BrtBeginSlicers"},1116:{n:"BrtEndSlicers"},1117:{n:"BrtWbProp14"},1118:{n:"BrtBeginSXEdit"},1119:{n:"BrtEndSXEdit"},1120:{n:"BrtBeginSXEdits"},1121:{n:"BrtEndSXEdits"},1122:{n:"BrtBeginSXChange"},1123:{n:"BrtEndSXChange"},1124:{n:"BrtBeginSXChanges"},1125:{n:"BrtEndSXChanges"},1126:{n:"BrtSXTupleItems"},1128:{n:"BrtBeginSlicerStyle"},1129:{n:"BrtEndSlicerStyle"},1130:{n:"BrtSlicerStyleElement"},1131:{n:"BrtBeginStyleSheetExt14"},1132:{n:"BrtEndStyleSheetExt14"},1133:{n:"BrtBeginSlicerCachesPivotCacheID"},1134:{n:"BrtEndSlicerCachesPivotCacheID"},1135:{n:"BrtBeginConditionalFormattings"},1136:{n:"BrtEndConditionalFormattings"},1137:{n:"BrtBeginPCDCalcMemExt"},1138:{n:"BrtEndPCDCalcMemExt"},1139:{n:"BrtBeginPCDCalcMemsExt"},1140:{n:"BrtEndPCDCalcMemsExt"},1141:{n:"BrtPCDField14"},1142:{n:"BrtBeginSlicerStyles"},1143:{n:"BrtEndSlicerStyles"},1144:{n:"BrtBeginSlicerStyleElements"},1145:{n:"BrtEndSlicerStyleElements"},1146:{n:"BrtCFRuleExt"},1147:{n:"BrtBeginSXCondFmt14"},1148:{n:"BrtEndSXCondFmt14"},1149:{n:"BrtBeginSXCondFmts14"},1150:{n:"BrtEndSXCondFmts14"},1152:{n:"BrtBeginSortCond14"},1153:{n:"BrtEndSortCond14"},1154:{n:"BrtEndDVals14"},1155:{n:"BrtEndIconSet14"},1156:{n:"BrtEndDatabar14"},1157:{n:"BrtBeginColorScale14"},1158:{n:"BrtEndColorScale14"},1159:{n:"BrtBeginSxrules14"},1160:{n:"BrtEndSxrules14"},1161:{n:"BrtBeginPRule14"},1162:{n:"BrtEndPRule14"},1163:{n:"BrtBeginPRFilters14"},1164:{n:"BrtEndPRFilters14"},1165:{n:"BrtBeginPRFilter14"},1166:{n:"BrtEndPRFilter14"},1167:{n:"BrtBeginPRFItem14"},1168:{n:"BrtEndPRFItem14"},1169:{n:"BrtBeginCellIgnoreECs14"},1170:{n:"BrtEndCellIgnoreECs14"},1171:{n:"BrtDxf14"},1172:{n:"BrtBeginDxF14s"},1173:{n:"BrtEndDxf14s"},1177:{n:"BrtFilter14"},1178:{n:"BrtBeginCustomFilters14"},1180:{n:"BrtCustomFilter14"},1181:{n:"BrtIconFilter14"},1182:{n:"BrtPivotCacheConnectionName"},2048:{n:"BrtBeginDecoupledPivotCacheIDs"},2049:{n:"BrtEndDecoupledPivotCacheIDs"},2050:{n:"BrtDecoupledPivotCacheID"},2051:{n:"BrtBeginPivotTableRefs"},2052:{n:"BrtEndPivotTableRefs"},2053:{n:"BrtPivotTableRef"},2054:{n:"BrtSlicerCacheBookPivotTables"},2055:{n:"BrtBeginSxvcells"},2056:{n:"BrtEndSxvcells"},2057:{n:"BrtBeginSxRow"},2058:{n:"BrtEndSxRow"},2060:{n:"BrtPcdCalcMem15"},2067:{n:"BrtQsi15"},2068:{n:"BrtBeginWebExtensions"},2069:{n:"BrtEndWebExtensions"},2070:{n:"BrtWebExtension"},2071:{n:"BrtAbsPath15"},2072:{n:"BrtBeginPivotTableUISettings"},2073:{n:"BrtEndPivotTableUISettings"},2075:{n:"BrtTableSlicerCacheIDs"},2076:{n:"BrtTableSlicerCacheID"},2077:{n:"BrtBeginTableSlicerCache"},2078:{n:"BrtEndTableSlicerCache"},2079:{n:"BrtSxFilter15"},2080:{n:"BrtBeginTimelineCachePivotCacheIDs"},2081:{n:"BrtEndTimelineCachePivotCacheIDs"},2082:{n:"BrtTimelineCachePivotCacheID"},2083:{n:"BrtBeginTimelineCacheIDs"},2084:{n:"BrtEndTimelineCacheIDs"},2085:{n:"BrtBeginTimelineCacheID"},2086:{n:"BrtEndTimelineCacheID"},2087:{n:"BrtBeginTimelinesEx"},2088:{n:"BrtEndTimelinesEx"},2089:{n:"BrtBeginTimelineEx"},2090:{n:"BrtEndTimelineEx"},2091:{n:"BrtWorkBookPr15"},2092:{n:"BrtPCDH15"},2093:{n:"BrtBeginTimelineStyle"},2094:{n:"BrtEndTimelineStyle"},2095:{n:"BrtTimelineStyleElement"},2096:{n:"BrtBeginTimelineStylesheetExt15"},2097:{n:"BrtEndTimelineStylesheetExt15"},2098:{n:"BrtBeginTimelineStyles"},2099:{n:"BrtEndTimelineStyles"},2100:{n:"BrtBeginTimelineStyleElements"},2101:{n:"BrtEndTimelineStyleElements"},2102:{n:"BrtDxf15"},2103:{n:"BrtBeginDxfs15"},2104:{n:"brtEndDxfs15"},2105:{n:"BrtSlicerCacheHideItemsWithNoData"},2106:{n:"BrtBeginItemUniqueNames"},2107:{n:"BrtEndItemUniqueNames"},2108:{n:"BrtItemUniqueName"},2109:{n:"BrtBeginExtConn15"},2110:{n:"BrtEndExtConn15"},2111:{n:"BrtBeginOledbPr15"},2112:{n:"BrtEndOledbPr15"},2113:{n:"BrtBeginDataFeedPr15"},2114:{n:"BrtEndDataFeedPr15"},2115:{n:"BrtTextPr15"},2116:{n:"BrtRangePr15"},2117:{n:"BrtDbCommand15"},2118:{n:"BrtBeginDbTables15"},2119:{n:"BrtEndDbTables15"},2120:{n:"BrtDbTable15"},2121:{n:"BrtBeginDataModel"},2122:{n:"BrtEndDataModel"},2123:{n:"BrtBeginModelTables"},2124:{n:"BrtEndModelTables"},2125:{n:"BrtModelTable"},2126:{n:"BrtBeginModelRelationships"},2127:{n:"BrtEndModelRelationships"},2128:{n:"BrtModelRelationship"},2129:{n:"BrtBeginECTxtWiz15"},2130:{n:"BrtEndECTxtWiz15"},2131:{n:"BrtBeginECTWFldInfoLst15"},2132:{n:"BrtEndECTWFldInfoLst15"},2133:{n:"BrtBeginECTWFldInfo15"},2134:{n:"BrtFieldListActiveItem"},2135:{n:"BrtPivotCacheIdVersion"},2136:{n:"BrtSXDI15"},2137:{n:"BrtBeginModelTimeGroupings"},2138:{n:"BrtEndModelTimeGroupings"},2139:{n:"BrtBeginModelTimeGrouping"},2140:{n:"BrtEndModelTimeGrouping"},2141:{n:"BrtModelTimeGroupingCalcCol"},3072:{n:"BrtUid"},3073:{n:"BrtRevisionPtr"},5095:{n:"BrtBeginCalcFeatures"},5096:{n:"BrtEndCalcFeatures"},5097:{n:"BrtCalcFeature"},65535:{n:""}},$u=F(Wu,"n"),ju={3:{n:"BIFF2NUM",f:function(e){var t=ti(e),e=(++e.l,Mn(e));return t.t="n",t.val=e,t}},4:{n:"BIFF2STR",f:function(e,t,n){var r=ti(e),e=(++e.l,Kr(e,0,n));return r.t="str",r.val=e,r}},6:{n:"Formula",f:za},9:{n:"BOF",f:di},10:{n:"EOF",f:Wr},12:{n:"CalcCount",f:d},13:{n:"CalcMode",f:d},14:{n:"CalcPrecision",f:y},15:{n:"CalcRefMode",f:y},16:{n:"CalcDelta",f:Mn},17:{n:"CalcIter",f:y},18:{n:"Protect",f:y},19:{n:"Password",f:d},20:{n:"Header",f:bi},21:{n:"Footer",f:bi},23:{n:"ExternSheet",f:Si},24:{n:"Lbl",f:wi},25:{n:"WinProtect",f:y},26:{n:"VerticalPageBreaks"},27:{n:"HorizontalPageBreaks"},28:{n:"Note",f:function(e,t,n){var r,i,o,s,a;if(!(n.biff<8))return r=e._R(2),i=e._R(2),o=e._R(2),s=e._R(2),a=Kr(e,0,n),n.biff<8&&e._R(1),[{r:r,c:i},a,s,o]}},29:{n:"Selection"},34:{n:"Date1904",f:y},35:{n:"ExternName",f:Ei},36:{n:"COLWIDTH"},38:{n:"LeftMargin",f:Mn},39:{n:"RightMargin",f:Mn},40:{n:"TopMargin",f:Mn},41:{n:"BottomMargin",f:Mn},42:{n:"PrintRowCol",f:y},43:{n:"PrintGrid",f:y},47:{n:"FilePass",f:function(e,t,n){var r={Type:8<=n.biff?e._R(2):0};return r.Type?Jo(e,t-2,r):(t=e,n.biff,e=n,n=r,t={key:d(t),verificationBytes:d(t)},e.password&&(t.verifier=zo(e.password)),n.valid=t.verificationBytes===t.verifier,n.valid&&(n.insitu=Qo(e.password))),r}},49:{n:"Font",f:function(e,t,n){var r={dyHeight:e._R(2),fl:e._R(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return r.name=Gr(e,0,n),r}},51:{n:"PrintSize",f:d},60:{n:"Continue"},61:{n:"Window1",f:function(e){return{Pos:[e._R(2),e._R(2)],Dim:[e._R(2),e._R(2)],Flags:e._R(2),CurTab:e._R(2),FirstTab:e._R(2),Selected:e._R(2),TabRatio:e._R(2)}}},64:{n:"Backup",f:y},65:{n:"Pane",f:function(){}},66:{n:"CodePage",f:d},77:{n:"Pls"},80:{n:"DCon"},81:{n:"DConRef"},82:{n:"DConName"},85:{n:"DefColWidth",f:d},89:{n:"XCT"},90:{n:"CRN"},91:{n:"FileSharing"},92:{n:"WriteAccess",f:function(e,t,n){var r;return n.enc?(e.l+=t,""):(r=e.l,n=Kr(e,0,n),e._R(t+r-e.l),n)}},93:{n:"Obj",f:function(e,t,n){var r,i,o,s,a,l;return n&&n.biff<8?(r=t,n=n,(l=e).l+=4,i=l._R(2),o=l._R(2),s=l._R(2),l.l+=2,l.l+=2,l.l+=2,l.l+=2,l.l+=2,l.l+=2,l.l+=2,l.l+=2,l.l+=2,l.l+=6,r-=36,(a=[]).push((Ri[i]||h)(l,r,n)),{cmo:[o,i,s],ft:a}):{cmo:l=li(e),ft:function(t,e){for(var n=t.l+e,r=[];t.l<n;){var i=t._R(2);t.l-=2;try{r.push(ci[i](t,n-t.l))}catch(e){return t.l=n,r}}return t.l!=n&&(t.l=n),r}(e,t-22,l[1])}}},94:{n:"Uncalced"},95:{n:"CalcSaveRecalc",f:y},96:{n:"Template"},97:{n:"Intl"},99:{n:"ObjProtect",f:y},125:{n:"ColInfo",f:_i},128:{n:"Guts",f:function(e){if(e.l+=4,0!==(e=[e._R(2),e._R(2)])[0]&&e[0]--,0!==e[1]&&e[1]--,7<e[0]||7<e[1])throw new Error("Bad Gutters: "+e.join("|"));return e}},129:{n:"WsBool",f:function(e,t,n){return{fDialog:16&(n&&8==n.biff||2==t?e._R(2):(e.l+=t,0))}}},130:{n:"GridSet",f:d},131:{n:"HCenter",f:y},132:{n:"VCenter",f:y},133:{n:"BoundSheet8",f:function(e,t,n){var r=e._R(4),i=3&e._R(1),o=e._R(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule"}return e=Gr(e,0,n),{pos:r,hs:i,dt:o,name:e=0===e.length?"Sheet1":e}}},134:{n:"WriteProtect"},140:{n:"Country",f:function(e){var t=[0,0],n=e._R(2);return t[0]=jn[n]||n,n=e._R(2),t[1]=jn[n]||n,t}},141:{n:"HideObj",f:d},144:{n:"Sort"},146:{n:"Palette",f:function(e){for(var t=e._R(2),n=[];0<t--;)n.push(ei(e));return n}},151:{n:"Sync"},152:{n:"LPr"},153:{n:"DxGCol"},154:{n:"FnGroupName"},155:{n:"FilterMode"},156:{n:"BuiltInFnGroupCount",f:d},157:{n:"AutoFilterInfo"},158:{n:"AutoFilter"},160:{n:"Scl",f:xi},161:{n:"Setup",f:function(e,t){var n={};return t<32||(e.l+=16,n.header=Mn(e),n.footer=Mn(e),e.l+=2),n}},174:{n:"ScenMan"},175:{n:"SCENARIO"},176:{n:"SxView"},177:{n:"Sxvd"},178:{n:"SXVI"},180:{n:"SxIvd"},181:{n:"SXLI"},182:{n:"SXPI"},184:{n:"DocRoute"},185:{n:"RecipName"},189:{n:"MulRk",f:function(e,t){for(var n=e.l+t-2,t=e._R(2),r=e._R(2),i=[];e.l<n;)i.push(ri(e));if(e.l!==n)throw new Error("MulRK read error");var o=e._R(2);if(i.length!=o-r+1)throw new Error("MulRK length mismatch");return{r:t,c:r,C:o,rkrec:i}}},190:{n:"MulBlank",f:function(e,t){for(var n=e.l+t-2,t=e._R(2),r=e._R(2),i=[];e.l<n;)i.push(e._R(2));if(e.l!==n)throw new Error("MulBlank read error");var o=e._R(2);if(i.length!=o-r+1)throw new Error("MulBlank length mismatch");return{r:t,c:r,C:o,ixfe:i}}},193:{n:"Mms",f:Wr},197:{n:"SXDI"},198:{n:"SXDB"},199:{n:"SXFDB"},200:{n:"SXDBB"},201:{n:"SXNum"},202:{n:"SxBool",f:y},203:{n:"SxErr"},204:{n:"SXInt"},205:{n:"SXString"},206:{n:"SXDtr"},207:{n:"SxNil"},208:{n:"SXTbl"},209:{n:"SXTBRGIITM"},210:{n:"SxTbpg"},211:{n:"ObProj"},213:{n:"SXStreamID"},215:{n:"DBCell"},216:{n:"SXRng"},217:{n:"SxIsxoper"},218:{n:"BookBool",f:d},220:{n:"DbOrParamQry"},221:{n:"ScenarioProtect",f:y},222:{n:"OleObjectSize"},224:{n:"XF",f:function(e,t,n){var r,i,o,s,a={};return a.ifnt=e._R(2),a.numFmtId=e._R(2),a.flags=e._R(2),a.fStyle=a.flags>>2&1,a.data=(n=n,r={},i=(e=e)._R(4),o=e._R(4),s=e._R(4),e=e._R(2),r.patternType=zn[s>>26],n.cellStyles&&(r.alc=7&i,r.fWrap=i>>3&1,r.alcV=i>>4&7,r.fJustLast=i>>7&1,r.trot=i>>8&255,r.cIndent=i>>16&15,r.fShrinkToFit=i>>20&1,r.iReadOrder=i>>22&2,r.fAtrNum=i>>26&1,r.fAtrFnt=i>>27&1,r.fAtrAlc=i>>28&1,r.fAtrBdr=i>>29&1,r.fAtrPat=i>>30&1,r.fAtrProt=i>>31&1,r.dgLeft=15&o,r.dgRight=o>>4&15,r.dgTop=o>>8&15,r.dgBottom=o>>12&15,r.icvLeft=o>>16&127,r.icvRight=o>>23&127,r.grbitDiag=o>>30&3,r.icvTop=127&s,r.icvBottom=s>>7&127,r.icvDiag=s>>14&127,r.dgDiag=s>>21&15,r.icvFore=127&e,r.icvBack=e>>7&127,r.fsxButton=e>>14&1),r),a}},225:{n:"InterfaceHdr",f:function(e,t){return 0!==t&&e._R(2),1200}},226:{n:"InterfaceEnd",f:Wr},227:{n:"SXVS"},229:{n:"MergeCells",f:function(e,t){for(var n=[],r=e._R(2);r--;)n.push(ii(e,t));return n}},233:{n:"BkHim"},235:{n:"MsoDrawingGroup"},236:{n:"MsoDrawing"},237:{n:"MsoDrawingSelection"},239:{n:"PhoneticInfo"},240:{n:"SxRule"},241:{n:"SXEx"},242:{n:"SxFilt"},244:{n:"SxDXF"},245:{n:"SxItm"},246:{n:"SxName"},247:{n:"SxSelect"},248:{n:"SXPair"},249:{n:"SxFmla"},251:{n:"SxFormat"},252:{n:"SST",f:function(e,t){for(var n,r,i,o,s,a,l,u,c,d=e.l+t,t=e._R(4),h=e._R(4),f=[],p=0;p!=h&&e.l<d;++p)f.push((o=l=c=u=l=a=s=o=i=r=void 0,i=g,g=1200,o=(n=e)._R(2),s=4&(l=n._R(1)),a=8&l,l=1+(1&l),u=0,c={},a&&(u=n._R(2)),s&&(r=n._R(4)),l=2==l?"dbcs-cont":"sbcs-cont",o=0===o?"":n._R(o,l),a&&(n.l+=4*u),s&&(n.l+=r),c.t=o,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),g=i,c));return f.Count=t,f.Unique=h,f}},253:{n:"LabelSst",f:function(e){var t=ti(e);return t.isst=e._R(4),t}},255:{n:"ExtSST",f:function(e,t){var n={};return n.dsst=e._R(2),e.l+=t-2,n}},256:{n:"SXVDEx"},259:{n:"SXFormula"},290:{n:"SXDBEx"},311:{n:"RRDInsDel"},312:{n:"RRDHead"},315:{n:"RRDChgCell"},317:{n:"RRTabId",f:zr},318:{n:"RRDRenSheet"},319:{n:"RRSort"},320:{n:"RRDMove"},330:{n:"RRFormat"},331:{n:"RRAutoFmt"},333:{n:"RRInsertSh"},334:{n:"RRDMoveBegin"},335:{n:"RRDMoveEnd"},336:{n:"RRDInsDelBegin"},337:{n:"RRDInsDelEnd"},338:{n:"RRDConflict"},339:{n:"RRDDefName"},340:{n:"RRDRstEtxp"},351:{n:"LRng"},352:{n:"UsesELFs",f:y},353:{n:"DSF",f:Wr},401:{n:"CUsr"},402:{n:"CbUsr"},403:{n:"UsrInfo"},404:{n:"UsrExcl"},405:{n:"FileLock"},406:{n:"RRDInfo"},407:{n:"BCUsrs"},408:{n:"UsrChk"},425:{n:"UserBView"},426:{n:"UserSViewBegin"},427:{n:"UserSViewEnd"},428:{n:"RRDUserView"},429:{n:"Qsi"},430:{n:"SupBook",f:function(e,t,n){var r=e.l+t,t=e._R(2),i=e._R(2);if(1025==(n.sbcch=i)||14849==i)return[i,t];if(i<1||255<i)throw new Error("Unexpected SupBook type: "+i);for(var n=Yr(e,i),o=[];r>e.l;)o.push(Xr(e));return[i,t,n,o]}},431:{n:"Prot4Rev",f:y},432:{n:"CondFmt"},433:{n:"CF"},434:{n:"DVal"},437:{n:"DConBin"},438:{n:"TxO",f:function(t,n,e){var r,i=t.l,o="";try{t.l+=4;var s=(e.lastobj||{cmo:[0,0]}).cmo[1],a=(-1==[0,5,7,11,12,14].indexOf(s)?t.l+=6:((r=t)._R(1),r.l++,r._R(2),r.l+=2,0),t._R(2)),l=(t._R(2),d(t),t._R(2));t.l+=l;for(var u=1;u<t.lens.length-1;++u){if(t.l-i!=t.lens[u])throw new Error("TxO: bad continue record");var c=t[t.l];if((o+=Yr(t,t.lens[u+1]-t.lens[u]-1)).length>=(c?a:2*a))break}if(o.length!==a&&o.length!==2*a)throw new Error("cchText: "+a+" != "+o.length);return t.l=i+n,{t:o}}catch(e){return t.l=i+n,{t:o}}}},439:{n:"RefreshAll",f:y},440:{n:"HLink",f:function(e,t){var n=ii(e,8);return e.l+=16,[n,function(e,t){var t=e.l+t,n=e._R(4);if(2!==n)throw new Error("Unrecognized streamVersion: "+n);n=e._R(2),e.l+=2;var r,i,o,s,a,l,u="";16&n&&(r=Qr(e,e.l)),128&n&&(i=Qr(e,e.l)),257==(257&n)&&(o=Qr(e,e.l)),1==(257&n)&&(s=Zr(e,e.l)),8&n&&(u=Qr(e,e.l)),32&n&&(a=e._R(16)),64&n&&(l=Ar(e)),e.l=t;(n=i||o||s||"")&&u&&(n+="#"+u),e={Target:n=n||"#"+u};return a&&(e.guid=a),l&&(e.time=l),r&&(e.Tooltip=r),e}(e,t-24)]}},441:{n:"Lel"},442:{n:"CodeName",f:Xr},443:{n:"SXFDBType"},444:{n:"Prot4RevPass",f:d},445:{n:"ObNoMacros"},446:{n:"Dv"},448:{n:"Excel9File",f:Wr},449:{n:"RecalcId",f:function(e){return e._R(2),e._R(4)},r:2},450:{n:"EntExU2",f:Wr},512:{n:"Dimensions",f:gi},513:{n:"Blank",f:Ni},515:{n:"Number",f:function(e){var t=ti(e),e=Mn(e);return t.val=e,t}},516:{n:"Label",f:function(e,t,n){e.l;var r=ti(e),e=(2==n.biff&&e.l++,Xr(e,e.l,n));return r.val=e,r}},517:{n:"BoolErr",f:yi},518:{n:"Formula",f:za},519:{n:"String",f:Oi},520:{n:"Row",f:function(e){var t={},n=(t.r=e._R(2),t.c=e._R(2),t.cnt=e._R(2)-t.c,e._R(2)),r=(e.l+=4,e._R(1));return e.l+=3,7&r&&(t.level=7&r),32&r&&(t.hidden=!0),64&r&&(t.hpt=n/20),t}},523:{n:"Index"},545:{n:"Array",f:Ti},549:{n:"DefaultRowHeight",f:pi},566:{n:"Table"},574:{n:"Window2",f:function(e,t,n){return n&&2<=n.biff&&n.biff<5?{}:{RTL:64&e._R(2)}}},638:{n:"RK",f:function(e){var t=e._R(2),n=e._R(2),e=ri(e);return{r:t,c:n,ixfe:e[0],rknum:e[1]}}},659:{n:"Style"},1030:{n:"Formula",f:za},1048:{n:"BigName"},1054:{n:"Format",f:function(e,t,n){return[e._R(2),Kr(e,0,n)]}},1084:{n:"ContinueBigName"},1212:{n:"ShrFmla",f:function(e,t,n){var r=si(e),i=(e.l++,e._R(1));return[function(e,t,n){var r,i=e.l+t,o=e._R(2),s=Ha(e,o,n);if(65535==o)return[[],h(e,t-2)];t!==o+2&&(r=Ba(e,i-o-2,s,n));return[s,r]}(e,t-=8,n),i,r]}},2048:{n:"HLinkTooltip",f:function(e,t){return e._R(2),[ii(e,8),e._R((t-10)/2,"dbcs-cont").replace(ie,"")]}},2049:{n:"WebPub"},2050:{n:"QsiSXTag"},2051:{n:"DBQueryExt"},2052:{n:"ExtString"},2053:{n:"TxtQry"},2054:{n:"Qsir"},2055:{n:"Qsif"},2056:{n:"RRDTQSIF"},2057:{n:"BOF",f:di},2058:{n:"OleDbConn"},2059:{n:"WOpt"},2060:{n:"SXViewEx"},2061:{n:"SXTH"},2062:{n:"SXPIEx"},2063:{n:"SXVDTEx"},2064:{n:"SXViewEx9"},2066:{n:"ContinueFrt"},2067:{n:"RealTimeData"},2128:{n:"ChartFrtInfo"},2129:{n:"FrtWrapper"},2130:{n:"StartBlock"},2131:{n:"EndBlock"},2132:{n:"StartObject"},2133:{n:"EndObject"},2134:{n:"CatLab"},2135:{n:"YMult"},2136:{n:"SXViewLink"},2137:{n:"PivotChartBits"},2138:{n:"FrtFontList"},2146:{n:"SheetExt"},2147:{n:"BookExt",r:12},2148:{n:"SXAddl"},2149:{n:"CrErr"},2150:{n:"HFPicture"},2151:{n:"FeatHdr",f:Wr},2152:{n:"Feat"},2154:{n:"DataLabExt"},2155:{n:"DataLabExtContents"},2156:{n:"CellWatch"},2161:{n:"FeatHdr11"},2162:{n:"Feature11"},2164:{n:"DropDownObjIds"},2165:{n:"ContinueFrt11"},2166:{n:"DConn"},2167:{n:"List12"},2168:{n:"Feature12"},2169:{n:"CondFmt12"},2170:{n:"CF12"},2171:{n:"CFEx"},2172:{n:"XFCRC",f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e._R(2),t.crc=e._R(4),t},r:12},2173:{n:"XFExt",f:function(e,t){e.l,e.l+=2;for(var n=e._R(2),r=(e.l+=2,e._R(2)),i=[];0<r--;)i.push(Qs(e,e.l));return{ixfe:n,ext:i}},r:12},2174:{n:"AutoFilter12"},2175:{n:"ContinueFrt12"},2180:{n:"MDTInfo"},2181:{n:"MDXStr"},2182:{n:"MDXTuple"},2183:{n:"MDXSet"},2184:{n:"MDXProp"},2185:{n:"MDXKPI"},2186:{n:"MDB"},2187:{n:"PLV"},2188:{n:"Compat12",f:y,r:12},2189:{n:"DXF"},2190:{n:"TableStyles",r:12},2191:{n:"TableStyle"},2192:{n:"TableStyleElement"},2194:{n:"StyleExt"},2195:{n:"NamePublish"},2196:{n:"NameCmt",f:function(e,t,n){var r,i;if(!(n.biff<8))return r=e._R(2),i=e._R(2),[Yr(e,r,n),Yr(e,i,n)];e.l+=t},r:12},2197:{n:"SortData"},2198:{n:"Theme",f:function(e,t,n){var t=e.l+t,r=e._R(4);if(124226!==r)if(n.cellStyles&&Oe){var i,r=e.slice(e.l);e.l=t;try{i=new Oe(r)}catch(e){return}r=Pe(i,"theme/theme/theme1.xml",!0);if(r)return Ks(r,n)}else e.l=t},r:12},2199:{n:"GUIDTypeLib"},2200:{n:"FnGrp12"},2201:{n:"NameFnGrp12"},2202:{n:"MTRSettings",f:function(e){return[0!==e._R(4),0!==e._R(4),e._R(4)]},r:12},2203:{n:"CompressPictures",f:Wr},2204:{n:"HeaderFooter"},2205:{n:"CrtLayout12"},2206:{n:"CrtMlFrt"},2207:{n:"CrtMlFrtContinue"},2211:{n:"ForceFullCalculation",f:function(e){t=(r=e)._R(2),n=r._R(2),r.l+=8;var t,n,r={type:t,flags:n};if(2211!=r.type)throw new Error("Invalid Future Record "+r.type);return 0!==e._R(4)}},2212:{n:"ShapePropsStream"},2213:{n:"TextPropsStream"},2214:{n:"RichTextStream"},2215:{n:"CrtLayout12A"},4097:{n:"Units"},4098:{n:"Chart"},4099:{n:"Series"},4102:{n:"DataFormat"},4103:{n:"LineFormat"},4105:{n:"MarkerFormat"},4106:{n:"AreaFormat"},4107:{n:"PieFormat"},4108:{n:"AttachedLabel"},4109:{n:"SeriesText"},4116:{n:"ChartFormat"},4117:{n:"Legend"},4118:{n:"SeriesList"},4119:{n:"Bar"},4120:{n:"Line"},4121:{n:"Pie"},4122:{n:"Area"},4123:{n:"Scatter"},4124:{n:"CrtLine"},4125:{n:"Axis"},4126:{n:"Tick"},4127:{n:"ValueRange"},4128:{n:"CatSerRange"},4129:{n:"AxisLine"},4130:{n:"CrtLink"},4132:{n:"DefaultText"},4133:{n:"Text"},4134:{n:"FontX",f:d},4135:{n:"ObjectLink"},4146:{n:"Frame"},4147:{n:"Begin"},4148:{n:"End"},4149:{n:"PlotArea"},4154:{n:"Chart3d"},4156:{n:"PicF"},4157:{n:"DropBar"},4158:{n:"Radar"},4159:{n:"Surf"},4160:{n:"RadarArea"},4161:{n:"AxisParent"},4163:{n:"LegendException"},4164:{n:"ShtProps",f:function(e,t,n){var r={area:!1};return 5!=n.biff?e.l+=t:(n=e._R(1),e.l+=3,16&n&&(r.area=!0)),r}},4165:{n:"SerToCrt"},4166:{n:"AxesUsed"},4168:{n:"SBaseRef"},4170:{n:"SerParent"},4171:{n:"SerAuxTrend"},4174:{n:"IFmtRecord"},4175:{n:"Pos"},4176:{n:"AlRuns"},4177:{n:"BRAI"},4187:{n:"SerAuxErrBar"},4188:{n:"ClrtClient",f:function(e){for(var t=e._R(2),n=[];0<t--;)n.push(ei(e));return n}},4189:{n:"SerFmt"},4191:{n:"Chart3DBarShape"},4192:{n:"Fbi"},4193:{n:"BopPop"},4194:{n:"AxcExt"},4195:{n:"Dat"},4196:{n:"PlotGrowth"},4197:{n:"SIIndex"},4198:{n:"GelFrame"},4199:{n:"BopPopCustom"},4200:{n:"Fbi2"},0:{n:"Dimensions",f:gi},2:{n:"BIFF2INT",f:function(e){var t=ti(e),e=(++e.l,e._R(2));return t.t="n",t.val=e,t}},5:{n:"BoolErr",f:yi},7:{n:"String",f:function(e){var t=e._R(1);return 0===t?(e.l++,""):e._R(t,"sbcs-cont")}},8:{n:"BIFF2ROW"},11:{n:"Index"},22:{n:"ExternCount",f:d},30:{n:"BIFF2FORMAT",f:W},31:{n:"BIFF2FMTCNT"},32:{n:"BIFF2COLINFO"},33:{n:"Array",f:Ti},37:{n:"DefaultRowHeight",f:pi},50:{n:"BIFF2FONTXTRA",f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},52:{n:"DDEObjName"},62:{n:"BIFF2WINDOW2"},67:{n:"BIFF2XF"},69:{n:"BIFF2FONTCLR"},86:{n:"BIFF4FMTCNT"},126:{n:"RK"},127:{n:"ImData",f:function(e){var t=e._R(2),n=e._R(2),r=e._R(4),t={fmt:t,env:n,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,t}},135:{n:"Addin"},136:{n:"Edg"},137:{n:"Pub"},145:{n:"Sub"},148:{n:"LHRecord"},149:{n:"LHNGraph"},150:{n:"Sound"},169:{n:"CoordList"},171:{n:"GCW"},188:{n:"ShrFmla"},191:{n:"ToolbarHdr"},192:{n:"ToolbarEnd"},194:{n:"AddMenu"},195:{n:"DelMenu"},214:{n:"RString",f:function(e,t,n){var t=e.l+t,r=ti(e),i=e._R(2),i=Yr(e,i,n);return e.l=t,r.t="str",r.val=i,r}},223:{n:"UDDesc"},234:{n:"TabIdConf"},354:{n:"XL5Modify"},421:{n:"FileSharing2"},521:{n:"BOF",f:di},536:{n:"Lbl",f:wi},547:{n:"ExternName",f:Ei},561:{n:"Font"},579:{n:"BIFF3XF"},1033:{n:"BOF",f:di},1091:{n:"BIFF4XF"},2157:{n:"FeatInfo"},2163:{n:"FeatInfo11"},2177:{n:"SXAddl12"},2240:{n:"AutoWebPub"},2241:{n:"ListObj"},2242:{n:"ListField"},2243:{n:"ListDV"},2244:{n:"ListCondFmt"},2245:{n:"ListCF"},2246:{n:"FMQry"},2247:{n:"FMSQry"},2248:{n:"PLV"},2249:{n:"LnExt"},2250:{n:"MkrExt"},2251:{n:"CrtCoopt"},2262:{n:"FRTArchId$",r:12},29282:{}},zu=F(ju,"n");function E(e,t,n,r){var i,t=+t||+zu[t];isNaN(t)||(r=r||(n||[]).length||0,(i=e.next(4))._W(2,t),i._W(2,r),0<r&&Bt(n)&&e.push(n))}function Gu(e,t,n){return(e=e||ee(7))._W(2,t),e._W(2,n),e._W(2,0),e._W(1,0),e}function Yu(e,t,n,r){if(null!=t.v)switch(t.t){case"d":case"n":var i="d"==t.t?j(oe(t.v)):t.v;return void(i==(0|i)&&0<=i&&i<65536?E(e,2,(u=n,c=r,d=i,Gu(h=ee(9),u,c),h._W(2,d),h)):E(e,3,(u=n,c=r,d=i,Gu(h=ee(15),u,c),h._W(8,d,"f"),h)));case"b":case"e":return void E(e,5,(i=n,o=r,s=t.v,a=t.t,Gu(l=ee(9),i,o),"e"==a?(l._W(1,s),l._W(1,1)):(l._W(1,s?1:0),l._W(1,0)),l));case"s":case"str":return void E(e,4,(o=n,a=r,s=t.v,Gu(l=ee(8+2*s.length),o,a),l._W(1,s.length),l._W(s.length,s,"sbcs"),l.l<l.length?l.slice(0,l.l):l))}var o,s,a,l,u,c,d,h;E(e,1,Gu(null,n,r))}function Xu(e,t){for(var n=t||{},t=(null!=ae&&null==n.dense&&(n.dense=ae),Zt()),r=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==n.sheet&&(r=i);if(0==r&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);E(t,9,hi(0,16,n));var o=t,s=e.Sheets[e.SheetNames[r]],a=n,l=Array.isArray(s),u=ve(s["!ref"]||"A1"),c=[];if(255<u.e.c||16383<u.e.r){if(a.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");u.e.c=Math.min(u.e.c,255),u.e.r=Math.min(u.e.c,16383),p=ye(u)}for(var d=u.s.r;d<=u.e.r;++d)for(var h=pe(d),f=u.s.c;f<=u.e.c;++f){d===u.s.r&&(c[f]=ge(f));var p=c[f]+h,g=l?(s[d]||[])[f]:s[p];g&&Yu(o,g,d,f)}return E(t,10),t.end()}function Ku(e,t,n){var r,i;E(e,"Font",(r=(e={sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"}).name||"Arial",(i=ee((n=(n=n)&&5==n.biff)?15+r.length:16+2*r.length))._W(2,20*(e.sz||12)),i._W(4,0),i._W(2,400),i._W(4,0),i._W(2,0),i._W(1,r.length),n||i._W(1,1),i._W((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i))}function qu(s,a,l){a&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t,n,r,i,o=e[0];o<=e[1];++o)null!=a[o]&&E(s,"Format",(n=a[t=o],i=void 0,r=(r=l)&&5==r.biff,(i=i||ee(r?3+n.length:5+2*n.length))._W(2,t),i._W(r?1:2,n.length),r||i._W(1,1),i._W((r?1:2)*n.length,n,r?"sbcs":"utf16le"),null==(t=i.length>i.l?i.slice(0,i.l):i).l&&(t.l=t.length),t))})}function Zu(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];E(e,"HLink",Ai(r)),r[1].Tooltip&&E(e,"HLinkTooltip",function(e){var t=e[1].Tooltip,n=ee(10+2*(t.length+1)),e=(n._W(2,2048),B(e[0]));n._W(2,e.r),n._W(2,e.r),n._W(2,e.c),n._W(2,e.c);for(var r=0;r<t.length;++r)n._W(2,t.charCodeAt(r));return n._W(2,0),n}(r))}delete t["!links"]}function Qu(e,t,n,r,i){var o,s,a,l,u,c,d,h,f,p,g=16+cl(i.cellXfs,t,i);if(null!=t.v||t.bf)if(t.bf)E(e,"Formula",Ga(t,n,r,0,g));else switch(t.t){case"d":case"n":var m="d"==t.t?j(oe(t.v)):t.v;E(e,"Number",(p=n,d=r,m=m,h=g,f=ee(14),ni(p,d,h,f),kn(m,f),f));break;case"b":case"e":E(e,517,vi(n,r,t.v,g,0,t.t));break;case"s":case"str":i.bookSST?(p=al(i.Strings,t.v,i.revStrings),E(e,"LabelSst",(d=n,h=r,m=p,f=g,c=ee(10),ni(d,h,f,c),c._W(4,m),c))):E(e,"Label",(c=n,o=r,s=t.v,a=g,u=ee(+(l=!(l=i)||8==l.biff)+8+(1+l)*s.length),ni(c,o,a,u),u._W(2,s.length),l&&u._W(1,1),u._W((1+l)*s.length,s,l?"utf16le":"sbcs"),u));break;default:E(e,"Blank",ni(n,r,g))}else E(e,"Blank",ni(n,r,g))}function Ju(e,t,n){var r=Zt(),i=n.SheetNames[e],o=n.Sheets[i]||{},n=(n||{}).Workbook||{},e=(n.Sheets||[])[e]||{},s=Array.isArray(o),a=8==t.biff,l=[],u=ve(o["!ref"]||"A1"),c=a?65536:16384;if(255<u.e.c||u.e.r>=c){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");u.e.c=Math.min(u.e.c,255),u.e.r=Math.min(u.e.c,c-1)}E(r,2057,hi(0,16,t)),E(r,"CalcMode",jr(1)),E(r,"CalcCount",jr(100)),E(r,"CalcRefMode",$r(!0)),E(r,"CalcIter",$r(!1)),E(r,"CalcDelta",kn(.001)),E(r,"CalcSaveRecalc",$r(!0)),E(r,"PrintRowCol",$r(!1)),E(r,"PrintGrid",$r(!1)),E(r,"GridSet",jr(1)),E(r,"Guts",(c=[0,0],(y=ee(8))._W(4,0),y._W(2,c[0]?c[0]+1:0),y._W(2,c[1]?c[1]+1:0),y)),E(r,"HCenter",$r(!1)),E(r,"VCenter",$r(!1)),E(r,512,(c=u,(m=ee(2*(y=8!=(y=t).biff&&y.biff?2:4)+6))._W(y,c.s.r),m._W(y,c.e.r+1),m._W(2,c.s.c),m._W(2,c.e.c+1),m._W(2,0),m)),a&&(o["!links"]=[]);for(var d=u.s.r;d<=u.e.r;++d)for(var h=pe(d),f=u.s.c;f<=u.e.c;++f){d===u.s.r&&(l[f]=ge(f));var p=l[f]+h,g=s?(o[d]||[])[f]:o[p];g&&(Qu(r,g,d,f,t),a)&&g.l&&o["!links"].push([p,g.l])}var m,y=e.CodeName||e.name||i;return a&&E(r,"Window2",(c=(n.Views||[])[0],m=ee(18),e=1718,c&&c.RTL&&(e|=64),m._W(2,e),m._W(4,0),m._W(4,64),m._W(4,0),m._W(4,0),m)),a&&(o["!merges"]||[]).length&&E(r,"MergeCells",function(e){var t=ee(2+8*e.length);t._W(2,e.length);for(var n=0;n<e.length;++n)oi(e[n],t);return t}(o["!merges"])),a&&Zu(r,o),E(r,"CodeName",qr(y)),a&&(i=r,n=o,(c=ee(19))._W(4,2151),c._W(4,0),c._W(4,0),c._W(2,3),c._W(1,1),c._W(4,0),E(i,"FeatHdr",c),(c=ee(39))._W(4,2152),c._W(4,0),c._W(4,0),c._W(2,3),c._W(1,0),c._W(4,0),c._W(2,1),c._W(4,4),c._W(2,0),oi(ve(n["!ref"]||"A1"),c),c._W(4,4),E(i,"Feat",c)),E(r,"EOF"),r.end()}function ec(e,t,n){for(var r=Zt(),i=(e||{}).Workbook||{},o=i.Sheets||[],i=i.WBProps||{},s=8==n.biff,a=5==n.biff,l=(E(r,2057,hi(0,5,n)),"xla"==n.bookType&&E(r,"Addin"),E(r,"InterfaceHdr",s?jr(1200):null),E(r,"Mms",function(e,t){t=t||ee(e);for(var n=0;n<e;++n)t._W(1,0);return t}(2)),a&&E(r,"ToolbarHdr"),a&&E(r,"ToolbarEnd"),E(r,"InterfaceEnd"),E(r,"WriteAccess",function(e){var t=!e||8==e.biff,n=ee(t?112:54);for(n._W(8==e.biff?2:1,7),t&&n._W(1,0),n._W(4,859007059),n._W(4,5458548|(t?0:536870912));n.l<n.length;)n._W(1,t?0:32);return n}(n)),E(r,"CodePage",jr(s?1200:1252)),s&&E(r,"DSF",jr(0)),s&&E(r,"Excel9File"),E(r,"RRTabId",function(e){for(var t=ee(2*e),n=0;n<e;++n)t._W(2,n+1);return t}(e.SheetNames.length)),s&&e.vbaraw&&E(r,"ObProj"),s&&e.vbaraw&&E(r,"CodeName",qr(i.CodeName||"ThisWorkbook")),E(r,"BuiltInFnGroupCount",jr(17)),E(r,"WinProtect",$r(!1)),E(r,"Protect",$r(!1)),E(r,"Password",jr(0)),s&&E(r,"Prot4Rev",$r(!1)),s&&E(r,"Prot4RevPass",jr(0)),E(r,"Window1",((a=ee(18))._W(2,0),a._W(2,0),a._W(2,29280),a._W(2,17600),a._W(2,56),a._W(2,0),a._W(2,0),a._W(2,1),a._W(2,500),a)),E(r,"Backup",$r(!1)),E(r,"HideObj",jr(0)),E(r,"Date1904",$r("true"==((i=e).Workbook&&i.Workbook.WBProps&&de(i.Workbook.WBProps.date1904)?"true":"false"))),E(r,"CalcPrecision",$r(!0)),s&&E(r,"RefreshAll",$r(!1)),E(r,"BookBool",jr(0)),Ku(r,0,n),qu(r,e.SSF,n),r),u=n,c=0;c<16;++c)E(l,"XF",mi({numFmtId:0,style:!0},0,u));u.cellXfs.forEach(function(e){E(l,"XF",mi(e,0,u))}),s&&E(r,"UsesELFs",$r(!1));for(var a=r.end(),i=Zt(),r=(s&&E(i,"Country",((b=b||ee(4))._W(2,1),b._W(2,1),b)),s&&n.Strings&&!function(e,t,n,r){var i=r||(n||[]).length||0;if(i<=8224)return E(e,t,n,i);if(r=+t||+zu[t],!isNaN(r)){for(var o=n.parts||[],s=0,a=0,l=0;l+(o[s]||8224)<=8224;)l+=o[s]||8224,s++;var u=e.next(4);for(u._W(2,r),u._W(2,l),e.push(n.slice(a,a+l)),a+=l;a<i;){for((u=e.next(4))._W(2,60),l=0;l+(o[s]||8224)<=8224;)l+=o[s]||8224,s++;u._W(2,l),e.push(n.slice(a,a+l)),a+=l}}}(i,"SST",fi(n.Strings)),E(i,"EOF"),i.end()),d=Zt(),h=0,f=0,f=0;f<e.SheetNames.length;++f)h+=(s?12:11)+(s?2:1)*e.SheetNames[f].length;var p,g,m,y=a.length+h+r.length;for(f=0;f<e.SheetNames.length;++f){var v=o[f]||{};E(d,"BoundSheet8",(v={pos:y,hs:v.Hidden||0,dt:0,name:e.SheetNames[f]},m=g=void 0,g=!(p=n)||8<=p.biff?2:1,(m=ee(8+g*v.name.length))._W(4,v.pos),m._W(1,v.hs||0),m._W(1,v.dt),m._W(1,v.name.length),8<=p.biff&&m._W(1,1),m._W(g*v.name.length,v.name,p.biff<8?"sbcs":"utf16le"),(g=m.slice(0,m.l)).l=m.l,g)),y+=t[f].length}var b=d.end();if(h!=b.length)throw new Error("BS8 "+h+" != "+b.length);i=[];return a.length&&i.push(a),b.length&&i.push(b),r.length&&i.push(r),Et([i])}function tc(e,t){var n=t||{};switch(n.biff||2){case 8:case 5:var r=e,i=t||{},o=[];r&&!r.SSF&&(r.SSF=le.get_table()),r&&r.SSF&&(Te(le),le.load_table(r.SSF),i.revssf=U(r.SSF),i.revssf[r.SSF[65535]]=0,i.ssf=r.SSF),i.Strings=[],i.Strings.Count=0,i.Strings.Unique=0,Lc(i),i.cellXfs=[],cl(i.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var s=0;s<r.SheetNames.length;++s)o[o.length]=Ju(s,i,r);return o.unshift(ec(r,o,i)),Et([o]);case 4:case 3:case 2:return Xu(e,t)}throw new Error("invalid type "+n.bookType+" for BIFF")}var nc,rc,ic={to_workbook:function(e,t){return cn(oc(e,t),t)},to_sheet:oc,_row:sc,BEGIN:nc='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',END:rc="</body></html>",_preamble:ac,from_sheet:function(e,t){var n=t||{},t=null!=n.header?n.header:nc,r=null!=n.footer?n.footer:rc,i=[t],o=an(e["!ref"]);n.dense=Array.isArray(e),i.push(ac(0,0,n));for(var s=o.s.r;s<=o.e.r;++s)i.push(sc(e,o,s,n));return i.push("</table>"+r),i.join("")}};function oc(e,t){var n=t||{},r=(null!=ae&&null==n.dense&&(n.dense=ae),n.dense?[]:{}),t=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!t)throw new Error("Invalid HTML: could not find <table>");for(var i=e.match(/<\/table/i),o=t.index,s=i&&i.index||e.length,a=function(e,t,n){if(Ie||"string"==typeof t)return e.split(t);for(var r=e.split(t),i=[r[0]],o=1;o<r.length;++o)i.push(n),i.push(r[o]);return i}(e.slice(o,s),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,u=0,c={s:{r:1e7,c:1e7},e:{r:0,c:0}},d=[],o=0;o<a.length;++o){var h=a[o].trim(),f=h.slice(0,3).toLowerCase();if("<tr"==f){if(++l,n.sheetRows&&n.sheetRows<=l){--l;break}u=0}else if("<td"==f||"<th"==f)for(var p=h.split(/<\/t[dh]>/i),s=0;s<p.length;++s){var g=p[s].trim();if(g.match(/<t[dh]/i)){for(var m=g,y=0;"<"==m.charAt(0)&&-1<(y=m.indexOf(">"));)m=m.slice(y+1);for(var v=0;v<d.length;++v){var b=d[v];b.s.c==u&&b.s.r<l&&l<=b.e.r&&(u=b.e.c+1,v=-1)}var g=se(g.slice(0,g.indexOf(">"))),E=g.colspan?+g.colspan:1,C=((1<(C=+g.rowspan)||1<E)&&d.push({s:{r:l,c:u},e:{r:l+(C||1)-1,c:u+E-1}}),g.t||"");m.length?(m=lt(m),c.s.r>l&&(c.s.r=l),c.e.r<l&&(c.e.r=l),c.s.c>u&&(c.s.c=u),c.e.c<u&&(c.e.c=u),m.length&&(g={t:"s",v:m},!n.raw&&m.trim().length&&"s"!=C&&("TRUE"===m?g={t:"b",v:!0}:"FALSE"===m?g={t:"b",v:!1}:isNaN(Ne(m))?isNaN(xe(m).getDate())||(g={t:"d",v:oe(m)},(g=n.cellDates?g:{t:"n",v:j(g.v)}).z=n.dateNF||le._table[14]):g={t:"n",v:Ne(m)}),n.dense?(r[l]||(r[l]=[]),r[l][u]=g):r[me({r:l,c:u})]=g,u+=E)):u+=E}}}return r["!ref"]=ye(c),d.length&&(r["!merges"]=d),r}function sc(e,t,n,r){for(var i=e["!merges"]||[],o=[],s=t.s.c;s<=t.e.c;++s){for(var a,l,u,c,d=0,h=0,f=0;f<i.length;++f)if(!(i[f].s.r>n||i[f].s.c>s||i[f].e.r<n||i[f].e.c<s)){if(i[f].s.r<n||i[f].s.c<s){d=-1;break}d=i[f].e.r-i[f].s.r+1,h=i[f].e.c-i[f].s.c+1;break}d<0||(a=me({r:n,c:s}),u=(l=r.dense?(e[n]||[])[s]:e[a])&&null!=l.v&&(l.h||Qe(l.w||(un(l),l.w)||""))||"",c={},1<d&&(c.rowspan=d),1<h&&(c.colspan=h),c.t=l&&l.t||"z",r.editable&&(u='<span contenteditable="true">'+u+"</span>"),c.id=(r.id||"sjs")+"-"+a,"z"!=c.t&&(c.v=l.v,null!=l.z)&&(c.z=l.z),o.push(N("td",u,c)))}return"<tr>"+o.join("")+"</tr>"}function ac(e,t,n){return[].join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function lc(e,t,n){var r,i=n||{},o=(null!=ae&&(i.dense=ae),0),s=0,a=(null!=i.origin&&("number"==typeof i.origin?o=i.origin:(o=(n="string"==typeof i.origin?B(i.origin):i.origin).r,s=n.c)),t.getElementsByTagName("tr")),l=Math.min(i.sheetRows||1e7,a.length),u={s:{r:0,c:0},e:{r:o,c:s}},c=(e["!ref"]&&(n=an(e["!ref"]),u.s.r=Math.min(u.s.r,n.s.r),u.s.c=Math.min(u.s.c,n.s.c),u.e.r=Math.max(u.e.r,n.e.r),u.e.c=Math.max(u.e.c,n.e.c),-1==o)&&(u.e.r=o=n.e.r+1),[]),d=0,h=e["!rows"]||(e["!rows"]=[]),f=0,p=0,g=0,m=0;for(e["!cols"]||(e["!cols"]=[]);f<a.length&&p<l;++f){var y=a[f];if(cc(y)){if(i.display)continue;h[p]={hidden:!0}}for(var v=y.children,g=m=0;g<v.length;++g){var b=v[g];if(!i.display||!cc(b)){for(var E=b.hasAttribute("v")?b.getAttribute("v"):lt(b.innerHTML),C=b.getAttribute("z"),d=0;d<c.length;++d){var w=c[d];w.s.c==m+s&&w.s.r<p+o&&p+o<=w.e.r&&(m=w.e.c+1-s,d=-1)}r=+b.getAttribute("colspan")||1,(1<(S=+b.getAttribute("rowspan")||1)||1<r)&&c.push({s:{r:p+o,c:m+s},e:{r:p+o+(S||1)-1,c:m+s+(r||1)-1}});var S={t:"s",v:E},b=b.getAttribute("t")||"";null!=E&&(0==E.length?S.t=b||"z":i.raw||0==E.trim().length||"s"==b||("TRUE"===E?S={t:"b",v:!0}:"FALSE"===E?S={t:"b",v:!1}:isNaN(Ne(E))?isNaN(xe(E).getDate())||(S={t:"d",v:oe(E)},(S=i.cellDates?S:{t:"n",v:j(S.v)}).z=i.dateNF||le._table[14]):S={t:"n",v:Ne(E)})),void 0===S.z&&null!=C&&(S.z=C),i.dense?(e[p+o]||(e[p+o]=[]),e[p+o][m+s]=S):e[me({c:m+s,r:p+o})]=S,u.e.c<m+s&&(u.e.c=m+s),m+=r}}++p}return c.length&&(e["!merges"]=(e["!merges"]||[]).concat(c)),u.e.r=Math.max(u.e.r,p-1+o),e["!ref"]=ye(u),l<=p&&(e["!fullref"]=ye((u.e.r=a.length-f+p-1+o,u))),e}function uc(e,t){return lc((t||{}).dense?[]:{},e,t)}function cc(e){var t="",n=(n=e).ownerDocument.defaultView&&"function"==typeof n.ownerDocument.defaultView.getComputedStyle?n.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null;return"none"===(t=(t=n?n(e).getPropertyValue("display"):t)||e.style.display)}dc={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};var dc,hc=function(P,e){var t,n,r,i,o=e||{},s=(null!=ae&&null==o.dense&&(o.dense=ae),Ru(P)),a=[],F={name:""},B=0,l={},u=[],c=o.dense?[]:{},d={value:""},h="",f=0,p=[],g=-1,m=-1,y={s:{r:1e6,c:1e7},e:{r:0,c:0}},v=0,b=[],H={},E=0,C=0,w=[],S=1,T=1,R=[],U={Names:[]},A={},_=["",""],N=[],x={},V="",W=0,O=!1,$=!1,I=0;for(Au.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");r=Au.exec(s);)switch(r[3]=r[3].replace(/_.*$/,"")){case"table":case"工作表":"/"===r[1]?(y.e.c>=y.s.c&&y.e.r>=y.s.r?c["!ref"]=ye(y):c["!ref"]="A1:A1",0<o.sheetRows&&o.sheetRows<=y.e.r&&(c["!fullref"]=c["!ref"],y.e.r=o.sheetRows-1,c["!ref"]=ye(y)),b.length&&(c["!merges"]=b),w.length&&(c["!rows"]=w),n.name=n["名称"]||n.name,"undefined"!=typeof JSON&&JSON.stringify(n),u.push(n.name),l[n.name]=c,$=!1):"/"!==r[0].charAt(r[0].length-2)&&(n=se(r[0],!1),g=m=-1,y.s.r=y.s.c=1e7,y.e.r=y.e.c=0,c=o.dense?[]:{},b=[],w=[],$=!0);break;case"table-row-group":"/"===r[1]?--v:++v;break;case"table-row":case"行":if("/"===r[1])g+=S,S=1;else{if((M=se(r[0],!1))["行号"]?g=M["行号"]-1:-1==g&&(g=0),(S=+M["number-rows-repeated"]||1)<10)for(I=0;I<S;++I)0<v&&(w[g+I]={level:v});m=-1}break;case"covered-table-cell":"/"!==r[1]&&++m,o.sheetStubs&&(o.dense?(c[g]||(c[g]=[]),c[g][m]={t:"z"}):c[me({r:g,c:m})]={t:"z"}),h="",p=[];break;case"table-cell":case"数据":if("/"===r[0].charAt(r[0].length-2))++m,d=se(r[0],!1),T=parseInt(d["number-columns-repeated"]||"1",10),i={t:"z",v:null},d.formula&&0!=o.cellFormula&&(i.f=nl(ce(d.formula))),"string"==(d["数据类型"]||d["value-type"])&&(i.t="s",i.v=ce(d["string-value"]||""),o.dense?(c[g]||(c[g]=[]),c[g][m]=i):c[me({r:g,c:m})]=i),m+=T-1;else if("/"!==r[1]){var T=1,M=S?g+S-1:g;if(++m>y.e.c&&(y.e.c=m),m<y.s.c&&(y.s.c=m),g<y.s.r&&(y.s.r=g),M>y.e.r&&(y.e.r=M),N=[],i={t:(d=se(r[0],!(x={})))["数据类型"]||d["value-type"],v:null},o.cellFormula)if(d.formula&&(d.formula=ce(d.formula)),d["number-matrix-columns-spanned"]&&d["number-matrix-rows-spanned"]&&(E=parseInt(d["number-matrix-rows-spanned"],10)||0,C=parseInt(d["number-matrix-columns-spanned"],10)||0,i.F=ye(H={s:{r:g,c:m},e:{r:g+E-1,c:m+C-1}}),R.push([H,i.F])),d.formula)i.f=nl(d.formula);else for(I=0;I<R.length;++I)g>=R[I][0].s.r&&g<=R[I][0].e.r&&m>=R[I][0].s.c&&m<=R[I][0].e.c&&(i.F=R[I][1]);switch((d["number-columns-spanned"]||d["number-rows-spanned"])&&(E=parseInt(d["number-rows-spanned"],10)||0,C=parseInt(d["number-columns-spanned"],10)||0,b.push(H={s:{r:g,c:m},e:{r:g+E-1,c:m+C-1}})),d["number-columns-repeated"]&&(T=parseInt(d["number-columns-repeated"],10)),i.t){case"boolean":i.t="b",i.v=de(d["boolean-value"]);break;case"float":case"percentage":case"currency":i.t="n",i.v=parseFloat(d.value);break;case"date":i.t="d",i.v=oe(d["date-value"]),o.cellDates||(i.t="n",i.v=j(i.v)),i.z="m/d/yy";break;case"time":i.t="n",i.v=function(e){var t=0,n=0,r=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=i.length;++o)if(i[o]){switch(3<o&&(r=!0),i[o].slice(i[o].length-(n=1))){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[o].slice(i[o].length-1));case"D":n*=24;case"H":n*=60;case"M":if(!r)throw new Error("Unsupported ISO Duration Field: M");n*=60}t+=n*parseInt(i[o],10)}return t}(d["time-value"])/86400;break;case"number":i.t="n",i.v=parseFloat(d["数据数值"]);break;default:if("string"!==i.t&&"text"!==i.t&&i.t)throw new Error("Unsupported value type "+i.t);i.t="s",null!=d["string-value"]&&(h=ce(d["string-value"]),p=[])}}else{if(O=!1,"s"===i.t&&(i.v=h||"",p.length&&(i.R=p),O=0==f),A.Target&&(i.l=A),0<N.length&&(i.c=N,N=[]),h&&!1!==o.cellText&&(i.w=h),O&&(i.t="z",delete i.v),(!O||o.sheetStubs)&&!(o.sheetRows&&o.sheetRows<=g))for(var k=0;k<S;++k){if(T=parseInt(d["number-columns-repeated"]||"1",10),o.dense)for(c[g+k]||(c[g+k]=[]),c[g+k][m]=0==k?i:_e(i);0<--T;)c[g+k][m+T]=_e(i);else for(c[me({r:g+k,c:m})]=i;0<--T;)c[me({r:g+k,c:m+T})]=_e(i);y.e.c<=m&&(y.e.c=m)}m+=(T=parseInt(d["number-columns-repeated"]||"1",10))-1,T=0,i={},h="",p=[]}A={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":if("/"===r[1]){if((t=a.pop())[0]!==r[3])throw"Bad state: "+t}else"/"!==r[0].charAt(r[0].length-2)&&a.push([r[3],!0]);break;case"annotation":if("/"===r[1]){if((t=a.pop())[0]!==r[3])throw"Bad state: "+t;x.t=h,p.length&&(x.R=p),x.a=V,N.push(x)}else"/"!==r[0].charAt(r[0].length-2)&&a.push([r[3],!1]);h=V="",f=W=0,p=[];break;case"creator":"/"===r[1]?V=s.slice(W,r.index):W=r.index+r[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===r[1]){if((t=a.pop())[0]!==r[3])throw"Bad state: "+t}else"/"!==r[0].charAt(r[0].length-2)&&a.push([r[3],!1]);h="",f=0,p=[];break;case"scientific-number":case"currency-symbol":case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===r[1]){if(F.name,(t=a.pop())[0]!==r[3])throw"Bad state: "+t}else"/"!==r[0].charAt(r[0].length-2)&&(F=se(r[0],!1),a.push([r[3],!0]));break;case"script":case"libraries":case"automatic-styles":case"master-styles":break;case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":D=se(r[0],!1),dc[r[3]]["long"===D.style?1:0]}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":D=se(r[0],!1),dc[r[3]]["long"===D.style?1:0]}break;case"boolean-style":case"boolean":case"text-style":break;case"text":if("/>"!==r[0].slice(-2))if("/"===r[1])switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":s.slice(B,r.index)}else B=r.index+r[0].length;break;case"named-range":var D,_=rl((D=se(r[0],!1))["cell-range-address"]),L={Name:D.name,Ref:_[0]+"!"+_[1]};$&&(L.Sheet=u.length),U.Names.push(L);break;case"text-content":case"text-properties":case"embedded-text":break;case"body":case"电子表格":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":break;case"p":case"文本串":"/"!==r[1]||d&&d["string-value"]?(se(r[0],!1),f=r.index+r[0].length):(L=function(e){e=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,t){return Array(parseInt(t,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[ce(e.replace(/<[^>]*>/g,""))]}(s.slice(f,r.index)),h=(0<h.length?h+"\n":"")+L[0]);break;case"s":break;case"database-range":if("/"!==r[1])try{l[(_=rl(se(r[0])["target-range-address"]))[0]]["!autofilter"]={ref:_[1]}}catch(e){}break;case"date":case"object":break;case"title":case"标题":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":break;case"a":if("/"!==r[1]){if(!(A=se(r[0],!1)).href)break;A.Target=A.href,delete A.href,"#"==A.Target.charAt(0)&&-1<A.Target.indexOf(".")&&(_=rl(A.Target.slice(1)),A.Target="#"+_[0]+"!"+_[1])}break;case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;default:switch(r[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(o.WTF)throw new Error(r)}}e={Sheets:l,SheetNames:u,Workbook:U};return o.bookSheets&&delete e.Sheets,e};function fc(e,t){t=t||{};var n=!!De(e,"objectdata");if(n)for(var r,i,o=O(e,"META-INF/manifest.xml"),s=t,a=Ru(o);r=Au.exec(a);)switch(r[3]){case"manifest":break;case"file-entry":if("/"==(i=se(r[0],!1)).path&&i.type!==ur)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(s&&s.WTF)throw r}o=Pe(e,"content.xml");if(o)return t=hc(n?o:he(o),t),De(e,"meta.xml")&&(t.Props=gr(O(e,"meta.xml"))),t;throw new Error("Missing content.xml in "+(n?"ODS":"UOF")+" file")}function pc(e,t){return hc(e,t)}gc="<office:document-styles "+gt({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+"></office:document-styles>";var gc,mc,yc,vc,bc=function(){return A+gc},Ec=function(e,t){var n=[A],r=gt({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),i=gt({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?n.push("<office:document"+r+i+">\n"):n.push("<office:document-content"+r+">\n"),(i=n).push(" <office:automatic-styles>\n"),i.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),i.push('   <number:month number:style="long"/>\n'),i.push("   <number:text>/</number:text>\n"),i.push('   <number:day number:style="long"/>\n'),i.push("   <number:text>/</number:text>\n"),i.push("   <number:year/>\n"),i.push("  </number:date-style>\n"),i.push('  <style:style style:name="ta1" style:family="table">\n'),i.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),i.push("  </style:style>\n"),i.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),i.push(" </office:automatic-styles>\n"),n.push("  <office:body>\n"),n.push("    <office:spreadsheet>\n");for(var o=0;o!=e.SheetNames.length;++o)n.push(Cc(e.Sheets[e.SheetNames[o]],e,o));return n.push("    </office:spreadsheet>\n"),n.push("  </office:body>\n"),"fods"==t.bookType?n.push("</office:document>"):n.push("</office:document-content>"),n.join("")};function Cc(e,t,n){for(var r=[],i=(r.push('      <table:table table:name="'+_(t.SheetNames[n])+'" table:style-name="ta1">\n'),0),o=0,s=an(e["!ref"]),a=e["!merges"]||[],l=0,u=Array.isArray(e),i=0;i<s.s.r;++i)r.push("        <table:table-row></table:table-row>\n");for(;i<=s.e.r;++i){for(r.push("        <table:table-row>\n"),o=0;o<s.s.c;++o)r.push(yc);for(;o<=s.e.c;++o){for(var c=!1,d={},h="",l=0;l!=a.length;++l)if(!(a[l].s.c>o||a[l].s.r>i||a[l].e.c<o||a[l].e.r<i)){a[l].s.c==o&&a[l].s.r==i||(c=!0),d["table:number-columns-spanned"]=a[l].e.c-a[l].s.c+1,d["table:number-rows-spanned"]=a[l].e.r-a[l].s.r+1;break}if(c)r.push(vc);else{var f=me({r:i,c:o}),p=u?(e[i]||[])[o]:e[f];if(p&&p.f&&(d["table:formula"]=_(("of:="+p.f.replace(ca,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),p.F)&&p.F.slice(0,f.length)==f&&(f=an(p.F),d["table:number-matrix-columns-spanned"]=f.e.c-f.s.c+1,d["table:number-matrix-rows-spanned"]=f.e.r-f.s.r+1),p){switch(p.t){case"b":h=p.v?"TRUE":"FALSE",d["office:value-type"]="boolean",d["office:boolean-value"]=p.v?"true":"false";break;case"n":h=p.w||String(p.v||0),d["office:value-type"]="float",d["office:value"]=p.v||0;break;case"s":case"str":h=null==p.v?"":p.v,d["office:value-type"]="string";break;case"d":h=p.w||oe(p.v).toISOString(),d["office:value-type"]="date",d["office:date-value"]=oe(p.v).toISOString(),d["table:style-name"]="ce1";break;default:r.push(yc);continue}var g,f=mc(h);p.l&&p.l.Target&&(f=N("text:a",f,{"xlink:href":g="#"==(g=p.l.Target).charAt(0)?"#"+g.slice(1).replace(/\./,"!"):g})),r.push("          "+N("table:table-cell",N("text:p",f,{}),d)+"\n")}else r.push(yc)}}r.push("        </table:table-row>\n")}return r.push("      </table:table>\n"),r.join("")}function wc(e,t){var n,r,i,o;return"fods"==t.bookType?Ec(e,t):(o="",r=[],i=[],R(n=Fe(),o="mimetype","application/vnd.oasis.opendocument.spreadsheet"),R(n,o="content.xml",Ec(e,t)),r.push([o,"text/xml"]),i.push([o,"ContentFile"]),R(n,o="styles.xml",bc(e,t)),r.push([o,"text/xml"]),i.push([o,"StylesFile"]),R(n,o="meta.xml",hr()),r.push([o,"text/xml"]),i.push([o,"MetadataFile"]),R(n,o="manifest.rdf",function(e){var t=[A];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var n=0;n!=e.length;++n)t.push(cr(e[n][0],e[n][1])),t.push(['  <rdf:Description rdf:about="">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e[n][0]+'"/>\n',"  </rdf:Description>\n"].join(""));return t.push(cr("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(i)),r.push([o,"application/rdf+xml"]),R(n,o="META-INF/manifest.xml",function(e){var t=[A];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(r)),n)}function Sc(r){return function(e,t){var n=function(e,t){if(!t)return 0;if(-1==(e=e.SheetNames.indexOf(t)))throw new Error("Sheet not found: "+t);return e}(e,t.sheet);return r.from_sheet(e.Sheets[e.SheetNames[n]],t,e)}}var Tc=Sc(ic),Rc=Sc({from_sheet:id}),Ac=Sc(void 0!==Ui?Ui:{}),_c=Sc(void 0!==$i?$i:{}),Nc=Sc(void 0!==ro?ro:{}),xc=Sc(void 0!==es?es:{}),Oc=Sc({from_sheet:od}),Ic=Sc(void 0!==Di?Di:{}),Mc=Sc(void 0!==Qi?Qi:{});function kc(r){return function(e){for(var t=0;t!=r.length;++t){var n=r[t];void 0===e[n[0]]&&(e[n[0]]=n[1]),"n"===n[2]&&(e[n[0]]=Number(e[n[0]]))}}}var Dc=function(e){kc([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)},Lc=kc([["cellDates",!(vc="          <table:covered-table-cell/>\n")],["bookSST",!(yc="          <table:table-cell />\n")],["bookType","xlsx"],["compression",!(mc=function(e){return _(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"<text:line-break/>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")})],["WTF",!1]]);function Pc(t,e){if(!t)return 0;try{t=e.map(function(e){return e.id||(e.id=e.strRelID),[e.name,t["!id"][e.id].Target,(e=t["!id"][e.id].Type,-1<M.WS.indexOf(e)?"sheet":M.CS&&e==M.CS?"chart":M.DS&&e==M.DS?"dialog":M.MS&&e==M.MS?"macro":e&&e.length?e:"sheet")]})}catch(e){return null}return t&&0!==t.length?t:null}function Fc(t,n,e,s,r,a,i,o,l,u,c,d){try{a[s]=ir(Pe(t,e,!0),n);var h,f,p,g,m,y=O(t,n);switch(o){case"sheet":m=pu(y,n,r,l,a[s],u,c,d);break;case"chart":(m=gu(y,n,r,l,a[s],u))&&m["!drawel"]&&(f=rr(h=Be(m["!drawel"].Target,n)),b=Pe(t,h,!0),E=ir(Pe(t,f,!0),h),g=rr(p=Be(b?(b=(b.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1],E["!id"][b].Target):"??",h)),m=ql(Pe(t,p,!0),0,0,ir(Pe(t,g,!0),p),0,m));break;case"macro":a[s],n.slice(-4),m={"!type":"macro"};break;case"dialog":a[s],n.slice(-4),m={"!type":"dialog"};break;default:throw new Error("Unrecognized sheet type "+o)}i[s]=m;var v;a&&a[s]&&ue(a[s]).forEach(function(e){var r,i,o;a[s][e].Type==M.CMNT&&(e=Be(a[s][e].Target,n),v=vu(O(t,e,!0),e,l))&&v.length&&(r=m,e=v,o=Array.isArray(r),e.forEach(function(e){var t=B(e.ref),n=((i=o?(r[t.r]||(r[t.r]=[]),r[t.r][t.c]):r[e.ref])||(i={t:"z"},o?r[t.r][t.c]=i:r[e.ref]=i,(n=ve(r["!ref"]||"BDWGO1000001:A1")).s.r>t.r&&(n.s.r=t.r),n.e.r<t.r&&(n.e.r=t.r),n.s.c>t.c&&(n.s.c=t.c),n.e.c<t.c&&(n.e.c=t.c),(t=ye(n))!==r["!ref"]&&(r["!ref"]=t)),i.c||(i.c=[]),{a:e.author,t:e.t,r:e.r});e.h&&(n.h=e.h),i.c.push(n)}))})}catch(e){if(l.WTF)throw e}var b,E}function Bc(e){return"/"==e.charAt(0)?e.slice(1):e}function Hc(t,n){if(Te(le),Dc(n=n||{}),De(t,"META-INF/manifest.xml"))return fc(t,n);if(De(t,"objectdata.xml"))return fc(t,n);if(De(t,"Index/Document.iwa"))throw new Error("Unsupported NUMBERS file");var e=function(e){for(var t=e.FullPaths||ue(e.files),n=[],r=0;r<t.length;++r)"/"!=t[r].slice(-1)&&n.push(t[r]);return n.sort()}(t),r=function(e){var n=Jn();if(e&&e.match){var r={};if((e.match(Ue)||[]).forEach(function(e){var t=se(e);switch(t[0].replace(Ve,"<")){case"<?xml":break;case"<Types":n.xmlns=t["xmlns"+(t[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[t.Extension]=t.ContentType;break;case"<Override":void 0!==n[qn[t.ContentType]]&&n[qn[t.ContentType]].push(t.PartName)}}),n.xmlns!==I.CT)throw new Error("Unknown Namespace: "+n.xmlns);n.calcchain=0<n.calcchains.length?n.calcchains[0]:"",n.sst=0<n.strs.length?n.strs[0]:"",n.style=0<n.styles.length?n.styles[0]:"",n.defaults=r,delete n.calcchains}return n}(Pe(t,"[Content_Types].xml")),i=!1;if(0===r.workbooks.length&&O(t,o="xl/workbook.xml",!0)&&r.workbooks.push(o),0===r.workbooks.length){if(!O(t,o="xl/workbook.bin",!0))throw new Error("Could not find workbook");r.workbooks.push(o),i=!0}"bin"==r.workbooks[0].slice(-3)&&(i=!0);var o,s={},a={};if(!n.bookSheets&&!n.bookProps){if(il=[],r.sst)try{il=yu(O(t,Bc(r.sst)),r.sst,n)}catch(e){if(n.WTF)throw e}n.cellStyles&&r.themes.length&&(o=Pe(t,r.themes[0].replace(/^\//,""),!0)||"",r.themes[0],s=Ks(o,n)),r.style&&(a=mu(O(t,Bc(r.style)),r.style,s,n))}r.links.map(function(e){try{ir(Pe(t,rr(Bc(e))),e);return Eu(O(t,Bc(e)),0,e,n)}catch(e){}});var l,u,c,d=fu(O(t,Bc(r.workbooks[0])),r.workbooks[0],n),h={},f="",p=(r.coreprops.length&&((f=O(t,Bc(r.coreprops[0]),!0))&&(h=gr(f)),0!==r.extprops.length)&&(f=O(t,Bc(r.extprops[0]),!0))&&(p=n,c={},u=(u=h)||{},l=he(l=f),vr.forEach(function(e){var t=(l.match(at(e[0]))||[])[1];switch(e[2]){case"string":t&&(u[e[1]]=ce(t));break;case"bool":u[e[1]]="true"===t;break;case"raw":var n=l.match(new RegExp("<"+e[0]+"[^>]*>([\\s\\S]*?)</"+e[0]+">"));n&&0<n.length&&(c[e[1]]=n[1])}}),c.HeadingPairs)&&c.TitlesOfParts&&br(c.HeadingPairs,c.TitlesOfParts,u,p),{}),f=(n.bookSheets&&!n.bookProps||0!==r.custprops.length&&(f=Pe(t,Bc(r.custprops[0]),!0))&&(p=function(e,t){var n={},r="",i=e.match(Cr);if(i)for(var o=0;o!=i.length;++o){var s=i[o],a=se(s);switch(a[0]){case"<?xml":case"<Properties":break;case"<property":r=ce(a.name);break;case"</property>":r=null;break;default:if(0===s.indexOf("<vt:")){var l=s.split(">"),u=l[0].slice(4),c=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":n[r]=ce(c);break;case"bool":n[r]=de(c);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(c,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(c);break;case"filetime":case"date":n[r]=oe(c);break;case"cy":case"error":n[r]=ce(c);break;default:"/"!=u.slice(-1)&&t.WTF&&"undefined"!=typeof console&&console.warn("Unexpected",s,u,l)}}else if("</"!==s.slice(0,2)&&t.WTF)throw new Error(s)}}return n}(f,n)),{});if(!n.bookSheets&&!n.bookProps||(d.Sheets?y=d.Sheets.map(function(e){return e.name}):h.Worksheets&&0<h.SheetNames.length&&(y=h.SheetNames),n.bookProps&&(f.Props=h,f.Custprops=p),n.bookSheets&&void 0!==y&&(f.SheetNames=y),n.bookSheets?!f.SheetNames:!n.bookProps)){var g,m,y={},v={},b=(n.bookDeps&&r.calcchain&&(v=bu(O(t,Bc(r.calcchain)),r.calcchain)),0),E={},C=d.Sheets;h.Worksheets=C.length,h.SheetNames=[];for(var w=0;w!=C.length;++w)h.SheetNames[w]=C[w].name;var S=i?"bin":"xml",i=r.workbooks[0].lastIndexOf("/"),T=(r.workbooks[0].slice(0,i+1)+"_rels/"+r.workbooks[0].slice(i+1)+".rels").replace(/^\//,"");De(t,T)||(T="xl/_rels/workbook."+S+".rels");for(var R=(R=ir(Pe(t,T,!0),T))&&Pc(R,d.Sheets),A=O(t,"xl/worksheets/sheet.xml",!0)?1:0,b=0;b!=h.Worksheets;++b){var _="sheet";if(R&&R[b]?(g="xl/"+R[b][1].replace(/[\/]?xl\//,""),De(t,g)||(g=R[b][1]),De(t,g)||(g=T.replace(/_rels\/.*$/,"")+R[b][1]),_=R[b][2]):g=(g="xl/worksheets/sheet"+(b+1-A)+"."+S).replace(/sheet0\./,"sheet."),m=g.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&null!=n.sheets)switch(typeof n.sheets){case"number":if(b!=n.sheets)continue;break;case"string":if(h.SheetNames[b].toLowerCase()!=n.sheets.toLowerCase())continue;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var N=!1,x=0;x!=n.sheets.length;++x)"number"==typeof n.sheets[x]&&n.sheets[x]==b&&(N=1),"string"==typeof n.sheets[x]&&n.sheets[x].toLowerCase()==h.SheetNames[b].toLowerCase()&&(N=1);if(!N)continue}}Fc(t,g,m,h.SheetNames[b],b,E,y,_,n,d,s,a)}f={Directory:r,Workbook:d,Props:h,Custprops:p,Deps:v,Sheets:y,SheetNames:h.SheetNames,Strings:il,Styles:a,Themes:s,SSF:le.get_table()},n&&n.bookFiles&&(f.keys=e,f.files=t.files),n&&n.bookVBA&&(0<r.vba.length?f.vbaraw=O(t,Bc(r.vba[0]),!0):r.defaults&&r.defaults.bin===ia&&(f.vbaraw=O(t,"xl/vbaProject.bin",!0)))}return f}function Uc(e,t){var t=t||{},n="Workbook",r=Q.find(e,n);try{if(n="/!DataSpaces/Version",!(r=Q.find(e,n))||!r.content)throw new Error("ECMA-376 Encrypted file missing "+n);if((s=r.content)._R(0,"lpp4"),Ho(s,4),Ho(s,4),Ho(s,4),n="/!DataSpaces/DataSpaceMap",!(r=Q.find(e,n))||!r.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Uo(r.content);if(1!==i.length||1!==i[0].comps.length||0!==i[0].comps[0].t||"StrongEncryptionDataSpace"!==i[0].name||"EncryptedPackage"!==i[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(r=Q.find(e,n))||!r.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=function(e){for(var t=[],n=(e.l+=4,e._R(4));0<n--;)t.push(e._R(0,"lpp4"));return t}(r.content);if(1!=o.length||"StrongEncryptionTransform"!=o[0])throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(r=Q.find(e,n))||!r.content)throw new Error("ECMA-376 Encrypted file missing "+n);Vo(r.content)}catch(e){}if(!(r=Q.find(e,n="/EncryptionInfo"))||!r.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=jo(r.content),n="/EncryptedPackage";if(!(r=Q.find(e,n))||!r.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(4==s[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(s[1],r.content,t.password||"",t);if(2==s[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(s[1],r.content,t.password||"",t);throw new Error("File is password-protected")}function Vc(e,t){if(Js=1024,"ods"==t.bookType)return wc(e,t);e&&!e.SSF&&(e.SSF=le.get_table()),e&&e.SSF&&(Te(le),le.load_table(e.SSF),t.revssf=U(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,sl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n,r,i,o,s,a,l,u,c="xlsb"==t.bookType?"bin":"xml",d=-1<oa.indexOf(t.bookType),h=Jn(),f=(Lc(t=t||{}),Fe()),p="",g=0;if(t.cellXfs=[],cl(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),R(f,p="docProps/core.xml",function(e,t){var n=t||{},r=[A,mr],i={};if(e||n.Props){e&&(null!=e.CreatedDate&&yr("dcterms:created","string"==typeof e.CreatedDate?e.CreatedDate:mt(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),null!=e.ModifiedDate)&&yr("dcterms:modified","string"==typeof e.ModifiedDate?e.ModifiedDate:mt(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i);for(var o=0;o!=fr.length;++o){var s=fr[o],a=n.Props&&null!=n.Props[s[1]]?n.Props[s[1]]:e?e[s[1]]:null;!0===a?a="1":!1===a?a="0":"number"==typeof a&&(a=String(a)),null!=a&&yr(s[0],a,null,r,i)}2<r.length&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">"))}return r.join("")}(e.Props,t)),h.coreprops.push(p),lr(t.rels,2,p,M.CORE_PROPS),p="docProps/app.xml",!e.Props||!e.Props.SheetNames)if(e.Workbook&&e.Workbook.Sheets){for(var m=[],y=0;y<e.SheetNames.length;++y)2!=(e.Workbook.Sheets[y]||{}).Hidden&&m.push(e.SheetNames[y]);e.Props.SheetNames=m}else e.Props.SheetNames=e.SheetNames;for(e.Props.Worksheets=e.Props.SheetNames.length,R(f,p,(n=e.Props,r=[],i=N,(n=n||{}).Application="SheetJS",r[r.length]=A,r[r.length]=Er,vr.forEach(function(e){if(void 0!==n[e[1]]){var t;switch(e[2]){case"string":t=_(String(n[e[1]]));break;case"bool":t=n[e[1]]?"true":"false"}void 0!==t&&(r[r.length]=i(e[0],t))}}),r[r.length]=i("HeadingPairs",i("vt:vector",i("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+i("vt:variant",i("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=i("TitlesOfParts",i("vt:vector",n.SheetNames.map(function(e){return"<vt:lpstr>"+_(e)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),2<r.length&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join(""))),h.extprops.push(p),lr(t.rels,3,p,M.EXT_PROPS),e.Custprops!==e.Props&&0<ue(e.Custprops||{}).length&&(R(f,p="docProps/custom.xml",Sr(e.Custprops)),h.custprops.push(p),lr(t.rels,4,p,M.CUST_PROPS)),g=1;g<=e.SheetNames.length;++g){var v,b,E,C={"!id":{}},w=e.Sheets[e.SheetNames[g-1]];(w||{})["!type"];R(f,p="xl/worksheets/sheet"+g+"."+c,(b=g-1,v=t,E=e,o=C,(".bin"===p.slice(-4)?Kl:Pl)(b,v,E,o))),h.sheets.push(p),lr(t.wbrels,-1,"worksheets/sheet"+g+"."+c,M.WS[0]),w&&(b=!1,(v=w["!comments"])&&0<v.length&&(R(f,E="xl/comments"+g+"."+c,(o=v,v=t,(".bin"===E.slice(-4)?ra:ta)(o,v))),h.comments.push(E),lr(C,-1,"../comments"+g+"."+c,M.CMNT),b=!0),w["!legacy"]&&b&&R(f,"xl/drawings/vmlDrawing"+g+".vml",function(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[N("xml",null,{"xmlns:v":yt.v,"xmlns:o":yt.o,"xmlns:x":yt.x,"xmlns:mv":yt.mv}).replace(/\/>/,">"),N("o:shapelayout",N("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),N("v:shapetype",[N("v:stroke",null,{joinstyle:"miter"}),N("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Js<1e3*e;)Js+=1e3;return t.forEach(function(e){var t=B(e[0]),n={color2:"#BEFF82",type:"gradient"},r=("gradient"==n.type&&(n.angle="-180"),"gradient"==n.type?N("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null),r=N("v:fill",r,n);++Js,i=i.concat(["<v:shape"+gt({id:"_x0000_s"+Js,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",r,N("v:shadow",null,{on:"t",obscured:"t"}),N("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",pt("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),pt("x:AutoFill","False"),pt("x:Row",String(t.r)),pt("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}(g,w["!comments"])),delete w["!comments"],delete w["!legacy"]),C["!id"].rId1&&R(f,rr(p),sr(C))}return null!=t.Strings&&0<t.Strings.length&&(R(f,p="xl/sharedStrings."+c,(s=t.Strings,a=t,(".bin"===p.slice(-4)?Fo:Lo)(s,a))),h.strs.push(p),lr(t.wbrels,-1,"sharedStrings."+c,M.SST)),R(f,p="xl/workbook."+c,(s=e,a=t,(".bin"===p.slice(-4)?hu:uu)(s,a))),h.workbooks.push(p),lr(t.rels,1,p,M.WB),R(f,p="xl/theme/theme1.xml",qs(e.Themes,t)),h.themes.push(p),lr(t.wbrels,-1,"theme/theme1.xml",M.THEME),R(f,p="xl/styles."+c,(l=e,u=t,(".bin"===p.slice(-4)?Us:Ns)(l,u))),h.styles.push(p),lr(t.wbrels,-1,"styles."+c,M.STY),e.vbaraw&&d&&(R(f,p="xl/vbaProject.bin",e.vbaraw),h.vba.push(p),lr(t.wbrels,-1,"vbaProject.bin",M.VBA)),R(f,"[Content_Types].xml",nr(h,t)),R(f,"_rels/.rels",sr(t.rels)),R(f,"xl/_rels/workbook."+c+".rels",sr(t.wbrels)),delete t.revssf,delete t.ssf,f}function Wc(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=S.decode(e.slice(0,12));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function $c(e,t){var n=e,t=t||{};return t.type||(t.type=T&&Buffer.isBuffer(e)?"buffer":"base64"),Hc(function(e,t){var n;if(Oe)switch(t.type){case"base64":n=new Oe(e,{base64:!0});break;case"binary":case"array":n=new Oe(e,{base64:!1});break;case"buffer":n=new Oe(e);break;default:throw new Error("Unrecognized type "+t.type)}else switch(t.type){case"base64":n=Q.read(e,{type:"base64"});break;case"binary":n=Q.read(e,{type:"binary"});break;case"buffer":case"array":n=Q.read(e,{type:"buffer"});break;default:throw new Error("Unrecognized type "+t.type)}return n}(n,t),t)}function jc(e,t){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return Nu(e.slice(n),t);default:break e}return ro.to_workbook(e,t)}function zc(e,t,n,r){return r?(n.type="string",ro.to_workbook(e,n)):ro.to_workbook(t,n)}function Gc(e,t){if(m(),"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return Gc(new Uint8Array(e),t);var n,r=e,i=!1,o=t||{};if(o.cellStyles&&(o.cellNF=!0,o.sheetStubs=!0),ol={},o.dateNF&&(ol.dateNF=o.dateNF),o.type||(o.type=T&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==o.type&&(o.type=T?"buffer":"binary",r=function(e){if(void 0!==D)return D.readFileSync(e);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var t=File(e),n=(t.open("r"),t.encoding="binary",t.read());return t.close(),n}catch(e){if(!e.message||!e.message.match(/onstruct/))throw e}throw new Error("Cannot access file "+e)}(e)),"string"==o.type&&(i=!0,o.type="binary",o.codepage=65001,r=(t=e).match(/[^\x00-\x7F]/)?st(t):t),"array"==o.type&&"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){t=new ArrayBuffer(3),t=new Uint8Array(t);if(t.foo="bar",!t.foo)return(o=_e(o)).type="array",Gc(b(r),o)}switch((n=Wc(r,o))[0]){case 208:if(207===n[1]&&17===n[2]&&224===n[3]&&161===n[4]&&177===n[5]&&26===n[6]&&225===n[7])return s=Q.read(r,o),a=o,(Q.find(s,"EncryptedPackage")?Uc:Uu)(s,a);break;case 9:if(n[1]<=4)return Uu(r,o);break;case 60:return Nu(r,o);case 73:if(68!==n[1])break;var s=r,a=o,l=a||{},u=!!l.WTF;l.WTF=!0;try{var c=Ui.to_workbook(s,l);return l.WTF=u,c}catch(e){if(l.WTF=u,!e.message.match(/SYLK bad record ID/)&&u)throw e;return ro.to_workbook(s,a)}return;case 84:if(65===n[1]&&66===n[2]&&76===n[3])return $i.to_workbook(r,o);break;case 80:return 75===n[1]&&n[2]<9&&n[3]<9?$c(r,o):zc(e,r,o,i);case 239:return 60===n[3]?Nu(r,o):zc(e,r,o,i);case 255:if(254===n[1])return c=r,"base64"==(l=o).type&&(c=S.decode(c)),c=cptable.utils.decode(1200,c.slice(2),"str"),l.type="binary",jc(c,l);break;case 0:if(0===n[1]&&2<=n[2]&&0===n[3])return co.to_workbook(r,o);break;case 3:case 131:case 139:case 140:return Di.to_workbook(r,o);case 123:if(92===n[1]&&114===n[2]&&116===n[3])return es.to_workbook(r,o);break;case 10:case 13:case 32:var d=r,h=o,f="",u=Wc(d,h);switch(h.type){case"base64":f=S.decode(d);break;case"binary":f=d;break;case"buffer":f=d.toString("binary");break;case"array":f=q(d);break;default:throw new Error("Unrecognized type "+h.type)}return jc(f=239==u[0]&&187==u[1]&&191==u[2]?he(f):f,h)}return-1<Di.versions.indexOf(n[0])&&n[2]<=12&&n[3]<=31?Di.to_workbook(r,o):zc(e,r,o,i)}function Yc(e,t){t=t||{};return t.type="file",Gc(e,t)}function Xc(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return P(t.file,Q.write(e,{type:T?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Q.write(e,t)}function Kc(e,t,n){var r=(n=n||"")+e;switch(t.type){case"base64":return S.encode(st(r));case"binary":return st(r);case"string":return e;case"file":return P(t.file,r,"utf8");case"buffer":return T?f(r,"utf8"):Kc(r,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function qc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return"base64"==t.type?S.encode(n):"string"==t.type?he(n):n;case"file":return P(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Zc(e,t){m(),su(e);var n=t||{};if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),"array"==n.type)return n.type="binary",t=Zc(e,n),n.type="array",v(t);switch(n.bookType||"xlsb"){case"xml":case"xlml":return Kc(Du(e,n),n);case"slk":case"sylk":return Kc(Ac(e,n),n);case"htm":case"html":return Kc(Tc(e,n),n);case"txt":var r=Oc(e,n),i=n;switch(i.type){case"base64":return S.encode(r);case"binary":case"string":return r;case"file":return P(i.file,r,"binary");case"buffer":return T?f(r,"binary"):r.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+i.type);case"csv":return Kc(Rc(e,n),n,"\ufeff");case"dif":return Kc(_c(e,n),n);case"dbf":return qc(Ic(e,n),n);case"prn":return Kc(Nc(e,n),n);case"rtf":return Kc(xc(e,n),n);case"eth":return Kc(Mc(e,n),n);case"fods":return Kc(wc(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),qc(tc(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),Xc(Vu(e,o=(o=n)||{}),o);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"ods":var o=e,s=(a=n)||{},a=Vc(o,s),l={};if(s.compression&&(l.compression="DEFLATE"),s.password)l.type=T?"nodebuffer":"string";else switch(s.type){case"base64":l.type="base64";break;case"binary":l.type="string";break;case"string":throw new Error("'string' output type invalid for '"+s.bookType+"' files");case"buffer":case"file":l.type=T?"nodebuffer":"string";break;default:throw new Error("Unrecognized type "+s.type)}return o=a.FullPaths?Q.write(a,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[l.type]||l.type}):a.generate(l),s.password&&"undefined"!=typeof encrypt_agile?Xc(encrypt_agile(o,s.password),s):"file"===s.type?P(s.file,o):"string"==s.type?he(o):o;default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function Qc(e){var t;e.bookType||((t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase()).match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType)}function Jc(e,t,n){n=n||{};return n.type="file",n.file=t,Qc(n),Zc(e,n)}function ed(e,t,n,r,i,o,s,a){var l=pe(n),u=a.defval,c=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),d=!0,h=1===i?[]:{};if(1!==i)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:n,enumerable:!1})}catch(e){h.__rowNum__=n}else h.__rowNum__=n;if(!s||e[n])for(var f=t.s.c;f<=t.e.c;++f){var p=s?e[n][f]:e[r[f]+l];if(void 0===p||void 0===p.t)void 0!==u&&null!=o[f]&&(h[o[f]]=u);else{var g=p.v;switch(p.t){case"z":if(null==g)break;continue;case"e":g=void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=o[f]){if(null==g)if(void 0!==u)h[o[f]]=u;else{if(!c||null!==g)continue;h[o[f]]=null}else h[o[f]]=c||a.rawNumbers&&"n"==p.t?g:un(p,g,a);null!=g&&(d=!1)}}}return{row:h,isempty:d}}function td(e,t){if(null==e||null==e["!ref"])return[];var n,r={t:"n",v:0},i=0,o=1,s=[],a="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},c=null!=u.range?u.range:e["!ref"];switch(1===u.header?i=1:"A"===u.header?i=2:Array.isArray(u.header)?i=3:null==u.header&&(i=0),typeof c){case"string":l=ve(c);break;case"number":(l=ve(e["!ref"])).s.r=c;break;default:l=c}0<i&&(o=0);var d=pe(l.s.r),h=[],f=[],p=0,g=0,m=Array.isArray(e),y=l.s.r,v=0,b=0;for(m&&!e[y]&&(e[y]=[]),v=l.s.c;v<=l.e.c;++v)switch(h[v]=ge(v),r=m?e[y][v]:e[h[v]+d],i){case 1:s[v]=v-l.s.c;break;case 2:s[v]=h[v];break;case 3:s[v]=u.header[v-l.s.c];break;default:for(a=n=un(r=null==r?{w:"__EMPTY",t:"s"}:r,null,u),b=g=0;b<s.length;++b)s[b]==a&&(a=n+"_"+ ++g);s[v]=a}for(y=l.s.r+o;y<=l.e.r;++y){var E=ed(e,l,y,h,i,s,m,u);!1!==E.isempty&&(1===i?!1===u.blankrows:!u.blankrows)||(f[p++]=E.row)}return f.length=p,f}var nd=/"/g;function rd(e,t,n,r,i,o,s,a){for(var l=!0,u=[],c="",d=pe(n),h=t.s.c;h<=t.e.c;++h)if(r[h]){var f=a.dense?(e[n]||[])[h]:e[r[h]+d];if(null==f)c="";else if(null!=f.v){for(var p,l=!1,c=""+(a.rawNumbers&&"n"==f.t?f.v:un(f,null,a)),g=0;g!==c.length;++g)if((p=c.charCodeAt(g))===i||p===o||34===p||a.forceQuotes){c='"'+c.replace(nd,'""')+'"';break}"ID"==c&&(c='"ID"')}else null==f.f||f.F?c="":(l=!1,0<=(c="="+f.f).indexOf(",")&&(c='"'+c.replace(nd,'""')+'"'));u.push(c)}return!1===a.blankrows&&l?null:u.join(s)}function id(e,t){var n=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";for(var i=ve(e["!ref"]),o=void 0!==r.FS?r.FS:",",s=o.charCodeAt(0),a=void 0!==r.RS?r.RS:"\n",l=a.charCodeAt(0),u=new RegExp(("|"==o?"\\|":o)+"+$"),c="",d=[],h=(r.dense=Array.isArray(e),r.skipHidden&&e["!cols"]||[]),f=r.skipHidden&&e["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(h[p]||{}).hidden||(d[p]=ge(p));for(var g=i.s.r;g<=i.e.r;++g)(f[g]||{}).hidden||null!=(c=rd(e,i,g,d,s,l,o,r))&&(r.strip&&(c=c.replace(u,"")),n.push(c+a));return delete r.dense,n.join("")}function od(e,t){(t=t||{}).FS="\t",t.RS="\n";e=id(e,t);return"undefined"==typeof cptable||"string"==t.type?e:(t=cptable.utils.encode(1200,e,"str"),String.fromCharCode(255)+String.fromCharCode(254)+t)}function sd(e){var t,n="",r="";if(null==e||null==e["!ref"])return[];for(var i,o=ve(e["!ref"]),s=[],a=[],l=Array.isArray(e),u=o.s.c;u<=o.e.c;++u)s[u]=ge(u);for(var c=o.s.r;c<=o.e.r;++c)for(i=pe(c),u=o.s.c;u<=o.e.c;++u)if(n=s[u]+i,r="",void 0!==(t=l?(e[c]||[])[u]:e[n])){if(null!=t.F){if(n=t.F,!t.f)continue;r=t.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}a[a.length]=n+"="+r}return a}function ad(e,t,n){var s,a=n||{},l=+!a.skipHeader,u=e||{},c=0,d=0,e=(u&&null!=a.origin&&("number"==typeof a.origin?c=a.origin:(n="string"==typeof a.origin?B(a.origin):a.origin,c=n.r,d=n.c)),{s:{c:0,r:0},e:{c:d,r:c+t.length-1+l}}),h=(u["!ref"]?(n=ve(u["!ref"]),e.e.c=Math.max(e.e.c,n.e.c),e.e.r=Math.max(e.e.r,n.e.r),-1==c&&(c=n.e.r+1,e.e.r=c+t.length-1+l)):-1==c&&(c=0,e.e.r=t.length-1+l),a.header||[]),f=0,r=(t.forEach(function(i,o){ue(i).forEach(function(e){-1==(f=h.indexOf(e))&&(h[f=h.length]=e);var e=i[e],t="z",n="",r=me({c:d+f,r:c+o+l});s=cd.sheet_get_cell(u,r),!e||"object"!=typeof e||e instanceof Date?("number"==typeof e?t="n":"boolean"==typeof e?t="b":"string"==typeof e?t="s":e instanceof Date&&(t="d",a.cellDates||(t="n",e=j(e)),n=a.dateNF||le._table[14]),s?(s.t=t,s.v=e,delete s.w,delete s.R,n&&(s.z=n)):u[r]=s={t:t,v:e},n&&(s.z=n)):u[r]=e})}),e.e.c=Math.max(e.e.c,d+h.length-1),pe(c));if(l)for(f=0;f<h.length;++f)u[ge(f+d)+r]={t:"s",v:h[f]};return u["!ref"]=ye(e),u}var ld,ud,cd={encode_col:ge,encode_row:pe,encode_cell:me,encode_range:ye,decode_col:sn,decode_row:on,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:B,decode_range:an,format_cell:un,get_formulae:sd,make_csv:id,make_json:td,make_formulae:sd,sheet_add_aoa:dn,sheet_add_json:ad,sheet_add_dom:lc,aoa_to_sheet:hn,json_to_sheet:function(e,t){return ad(null,e,t)},table_to_sheet:uc,table_to_book:function(e,t){return cn(uc(e,t),t)},sheet_to_csv:id,sheet_to_txt:od,sheet_to_json:td,sheet_to_html:ic.from_sheet,sheet_to_formulae:sd,sheet_to_row_object_array:td};function dd(e,t,n){null!=e[t]?e[t]:e[t]=n}function hd(e,t,n){var r;return"string"==typeof t?Array.isArray(e)?(e[(r=B(t)).r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})):e[t]||(e[t]={t:"z"}):hd(e,me("number"!=typeof t?t:{r:t,c:n||0}))}(ld=cd).consts=ld.consts||{},ld.sheet_get_cell=hd,ld.book_new=function(){return{SheetNames:[],Sheets:{}}},ld.book_append_sheet=function(e,t,n){if(!n)for(var r=1;r<=65535&&-1!=e.SheetNames.indexOf(n="Sheet"+r);++r,n=void 0);if(!n||65535<=e.SheetNames.length)throw new Error("Too many worksheets");if(ou(n),0<=e.SheetNames.indexOf(n))throw new Error("Worksheet with name |"+n+"| already exists!");e.SheetNames.push(n),e.Sheets[n]=t},ld.book_set_sheet_visibility=function(e,t,n){dd(e,"Workbook",{}),dd(e.Workbook,"Sheets",[]);t=function(e,t){if("number"==typeof t){if(0<=t&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"!=typeof t)throw new Error("Cannot find sheet |"+t+"|");if(-1<(e=e.SheetNames.indexOf(t)))return e;throw new Error("Cannot find sheet name |"+t+"|")}(e,t);switch(dd(e.Workbook.Sheets,t,{}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[t].Hidden=n},[["SHEET_VISIBLE",0],["SHEET_HIDDEN",1],["SHEET_VERY_HIDDEN",2]].forEach(function(e){ld.consts[e[0]]=e[1]}),ld.cell_set_number_format=function(e,t){return e.z=t,e},ld.cell_set_hyperlink=function(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e},ld.cell_set_internal_link=function(e,t,n){return ld.cell_set_hyperlink(e,"#"+t,n)},ld.cell_add_comment=function(e,t,n){e.c||(e.c=[]),e.c.push({t:t,a:n||"SheetJS"})},ld.sheet_set_array_formula=function(e,t,n){for(var r="string"!=typeof t?t:ve(t),i="string"==typeof t?t:ye(t),o=r.s.r;o<=r.e.r;++o)for(var s=r.s.c;s<=r.e.c;++s){var a=hd(e,o,s);a.t="n",a.F=i,delete a.v,o==r.s.r&&s==r.s.c&&(a.f=n)}return e},T&&"undefined"!=typeof require&&(ud={}.Readable,s.stream={to_json:function(t,e){var n=ud({objectMode:!0});if(null==t||null==t["!ref"])n.push(null);else{var r,i={t:"n",v:0},o=0,s=1,a=[],l="",u={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},d=null!=c.range?c.range:t["!ref"];switch(1===c.header?o=1:"A"===c.header?o=2:Array.isArray(c.header)&&(o=3),typeof d){case"string":u=ve(d);break;case"number":(u=ve(t["!ref"])).s.r=d;break;default:u=d}0<o&&(s=0);var h=pe(u.s.r),f=[],p=0,g=Array.isArray(t),m=u.s.r,y=0,v=0;for(g&&!t[m]&&(t[m]=[]),y=u.s.c;y<=u.e.c;++y)switch(f[y]=ge(y),i=g?t[m][y]:t[f[y]+h],o){case 1:a[y]=y-u.s.c;break;case 2:a[y]=f[y];break;case 3:a[y]=c.header[y-u.s.c];break;default:for(l=r=un(i=null==i?{w:"__EMPTY",t:"s"}:i,null,c),v=p=0;v<a.length;++v)a[v]==l&&(l=r+"_"+ ++p);a[y]=l}m=u.s.r+s,n._read=function(){if(m>u.e.r)return n.push(null);for(;m<=u.e.r;){var e=ed(t,u,m,f,o,a,g,c);if(++m,!1===e.isempty||(1===o?!1!==c.blankrows:c.blankrows)){n.push(e.row);break}}}}return n},to_html:function(e,t){var n=ud(),r=t||{},t=null!=r.header?r.header:ic.BEGIN,i=null!=r.footer?r.footer:ic.END,o=(n.push(t),an(e["!ref"])),s=(r.dense=Array.isArray(e),n.push(ic._preamble(e,o,r)),o.s.r),a=!1;return n._read=function(){if(s>o.e.r)return a||(a=!0,n.push("</table>"+i)),n.push(null);for(;s<=o.e.r;){n.push(ic._row(e,o,s,r)),++s;break}},n},to_csv:function(e,t){var n=ud(),r=null==t?{}:t;if(null==e||null==e["!ref"])n.push(null);else{for(var i=ve(e["!ref"]),o=void 0!==r.FS?r.FS:",",s=o.charCodeAt(0),a=void 0!==r.RS?r.RS:"\n",l=a.charCodeAt(0),u=new RegExp(("|"==o?"\\|":o)+"+$"),c="",d=[],h=(r.dense=Array.isArray(e),r.skipHidden&&e["!cols"]||[]),f=r.skipHidden&&e["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(h[p]||{}).hidden||(d[p]=ge(p));var g=i.s.r,m=!1;n._read=function(){if(!m)return m=!0,n.push("\ufeff");for(;g<=i.e.r;)if(!(f[++g-1]||{}).hidden&&null!=(c=rd(e,i,g-1,d,s,l,o,r))){r.strip&&(c=c.replace(u,"")),n.push(c+a);break}return g>i.e.r?n.push(null):void 0}}return n}}),s.parse_xlscfb=Uu,s.parse_zip=Hc,s.read=Gc,s.readFile=Yc,s.readFileSync=Yc,s.write=Zc,s.writeFile=Jc,s.writeFileSync=Jc,s.writeFileAsync=function(e,t,n,r){var i=n||{};return i.type="file",i.file=e,Qc(i),i.type="buffer",r instanceof Function||(r=n),D.writeFile(e,Zc(t,i),r)},s.utils=cd,s.SSF=le,void 0!==Q&&(s.CFB=Q)}"undefined"!=typeof exports?make_xlsx_lib(exports):"undefined"!=typeof module&&module.exports?make_xlsx_lib(module.exports):"function"==typeof define&&define.amd?define(function(){return XLSX.version||make_xlsx_lib(XLSX),XLSX}):make_xlsx_lib(XLSX);var XLS=XLSX,ODS=XLSX,getGlobal=(!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Handsontable",[],t):"object"==typeof exports?exports.Handsontable=t():e.Handsontable=t()}("undefined"!=typeof self?self:this,()=>(()=>{var n=[(e,t,n)=>{"use strict";n.r(t),n.d(t,{AlwaysDense:()=>s.AlwaysDense,AlwaysSparse:()=>s.AlwaysSparse,ArraySize:()=>r.ArraySize,CellError:()=>i.CellError,CellType:()=>i.CellType,CellValueDetailedType:()=>i.CellValueDetailedType,CellValueType:()=>i.CellValueType,ConfigValueTooBigError:()=>a.ConfigValueTooBigError,ConfigValueTooSmallError:()=>a.ConfigValueTooSmallError,DenseSparseChooseBasedOnThreshold:()=>s.DenseSparseChooseBasedOnThreshold,DetailedCellError:()=>o.DetailedCellError,ErrorType:()=>i.ErrorType,EvaluationSuspendedError:()=>a.EvaluationSuspendedError,ExpectedOneOfValuesError:()=>a.ExpectedOneOfValuesError,ExpectedValueOfTypeError:()=>a.ExpectedValueOfTypeError,ExportedCellChange:()=>l.ExportedCellChange,ExportedNamedExpressionChange:()=>l.ExportedNamedExpressionChange,FunctionArgumentType:()=>d.FunctionArgumentType,FunctionPlugin:()=>d.FunctionPlugin,FunctionPluginValidationError:()=>a.FunctionPluginValidationError,HyperFormula:()=>u.HyperFormula,InvalidAddressError:()=>a.InvalidAddressError,InvalidArgumentsError:()=>a.InvalidArgumentsError,LanguageAlreadyRegisteredError:()=>a.LanguageAlreadyRegisteredError,LanguageNotRegisteredError:()=>a.LanguageNotRegisteredError,MissingTranslationError:()=>a.MissingTranslationError,NamedExpressionDoesNotExistError:()=>a.NamedExpressionDoesNotExistError,NamedExpressionNameIsAlreadyTakenError:()=>a.NamedExpressionNameIsAlreadyTakenError,NamedExpressionNameIsInvalidError:()=>a.NamedExpressionNameIsInvalidError,NoOperationToRedoError:()=>a.NoOperationToRedoError,NoOperationToUndoError:()=>a.NoOperationToUndoError,NoRelativeAddressesAllowedError:()=>a.NoRelativeAddressesAllowedError,NoSheetWithIdError:()=>a.NoSheetWithIdError,NoSheetWithNameError:()=>a.NoSheetWithNameError,NotAFormulaError:()=>a.NotAFormulaError,NothingToPasteError:()=>a.NothingToPasteError,ProtectedFunctionTranslationError:()=>a.ProtectedFunctionTranslationError,SheetNameAlreadyTakenError:()=>a.SheetNameAlreadyTakenError,SheetSizeLimitExceededError:()=>a.SheetSizeLimitExceededError,SimpleRangeValue:()=>f.SimpleRangeValue,SourceLocationHasArrayError:()=>a.SourceLocationHasArrayError,TargetLocationHasArrayError:()=>a.TargetLocationHasArrayError,UnableToParseError:()=>a.UnableToParseError,default:()=>g});var r=n(1),i=n(3),o=n(98),t=n(99),s=n(103),a=n(77),l=n(126),u=n(108),c=n(144),d=n(145),h=n(146),f=n(69);class p extends u.HyperFormula{}p.HyperFormula=u.HyperFormula,p.ErrorType=i.ErrorType,p.CellError=i.CellError,p.CellType=i.CellType,p.CellValueType=i.CellValueType,p.CellValueDetailedType=i.CellValueDetailedType,p.DetailedCellError=o.DetailedCellError,p.ExportedCellChange=l.ExportedCellChange,p.ExportedNamedExpressionChange=l.ExportedNamedExpressionChange,p.ConfigValueTooBigError=a.ConfigValueTooBigError,p.ConfigValueTooSmallError=a.ConfigValueTooSmallError,p.EvaluationSuspendedError=a.EvaluationSuspendedError,p.ExpectedOneOfValuesError=a.ExpectedOneOfValuesError,p.ExpectedValueOfTypeError=a.ExpectedValueOfTypeError,p.ArraySize=r.ArraySize,p.SimpleRangeValue=f.SimpleRangeValue,p.FunctionPlugin=d.FunctionPlugin,p.FunctionArgumentType=d.FunctionArgumentType,p.FunctionPluginValidationError=a.FunctionPluginValidationError,p.InvalidAddressError=a.InvalidAddressError,p.InvalidArgumentsError=a.InvalidArgumentsError,p.LanguageNotRegisteredError=a.LanguageNotRegisteredError,p.LanguageAlreadyRegisteredError=a.LanguageAlreadyRegisteredError,p.MissingTranslationError=a.MissingTranslationError,p.NamedExpressionDoesNotExistError=a.NamedExpressionDoesNotExistError,p.NamedExpressionNameIsAlreadyTakenError=a.NamedExpressionNameIsAlreadyTakenError,p.NamedExpressionNameIsInvalidError=a.NamedExpressionNameIsInvalidError,p.NoOperationToRedoError=a.NoOperationToRedoError,p.NoOperationToUndoError=a.NoOperationToUndoError,p.NoRelativeAddressesAllowedError=a.NoRelativeAddressesAllowedError,p.NoSheetWithIdError=a.NoSheetWithIdError,p.NoSheetWithNameError=a.NoSheetWithNameError,p.NotAFormulaError=a.NotAFormulaError,p.NothingToPasteError=a.NothingToPasteError,p.ProtectedFunctionTranslationError=a.ProtectedFunctionTranslationError,p.SheetNameAlreadyTakenError=a.SheetNameAlreadyTakenError,p.SheetSizeLimitExceededError=a.SheetSizeLimitExceededError,p.SourceLocationHasArrayError=a.SourceLocationHasArrayError,p.TargetLocationHasArrayError=a.TargetLocationHasArrayError,p.UnableToParseError=a.UnableToParseError;t=t.Config.defaultConfig.language;u.HyperFormula.registerLanguage(t,c.default),u.HyperFormula.languages[c.default.langCode]=c.default;for(const m of Object.getOwnPropertyNames(h))m.startsWith("_")||u.HyperFormula.registerFunctionPlugin(h[m]);const g=p;window.HyperFormula=n(0).default},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ArraySize:()=>h,ArraySizePredictor:()=>r});var c=n(2),l=n(93),u=n(94),d=n(7);class h{constructor(e,t,n=!1){if(this.width=e,this.height=t,this.isRef=n,e<=0||t<=0)throw Error("Incorrect array size")}static fromArray(e){return new h(0<e.length?e[0].length:0,e.length)}static error(){return new h(1,1,!0)}static scalar(){return new h(1,1,!1)}isScalar(){return this.width<=1&&this.height<=1||this.isRef}}class r{constructor(e,t){this.config=e,this.functionRegistry=t}checkArraySize(e,t){return this.checkArraySizeForAst(e,{formulaAddress:t,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,t){switch(e.type){case d.AstNodeType.FUNCTION_CALL:return this.checkArraySizeForFunction(e,t);case d.AstNodeType.COLUMN_RANGE:case d.AstNodeType.ROW_RANGE:case d.AstNodeType.CELL_RANGE:var n=c.AbsoluteCellRange.fromAstOrUndef(e,t.formulaAddress);return void 0===n?h.error():new h(n.width(),n.height(),!0);case d.AstNodeType.ARRAY:var r=[],i=[];for(const u of e.args){var o=u.map(e=>this.checkArraySizeForAst(e,t)),s=Math.min(...o.map(e=>e.height)),o=o.reduce((e,t)=>e+t.width,0);r.push(s),i.push(o)}var n=r.reduce((e,t)=>e+t,0),a=Math.min(...i);return new h(a,n);case d.AstNodeType.STRING:case d.AstNodeType.NUMBER:return h.scalar();case d.AstNodeType.CELL_REFERENCE:return new h(1,1,!0);case d.AstNodeType.DIV_OP:case d.AstNodeType.CONCATENATE_OP:case d.AstNodeType.EQUALS_OP:case d.AstNodeType.GREATER_THAN_OP:case d.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case d.AstNodeType.LESS_THAN_OP:case d.AstNodeType.LESS_THAN_OR_EQUAL_OP:case d.AstNodeType.MINUS_OP:case d.AstNodeType.NOT_EQUAL_OP:case d.AstNodeType.PLUS_OP:case d.AstNodeType.POWER_OP:case d.AstNodeType.TIMES_OP:a=this.checkArraySizeForAst(e.left,t),n=this.checkArraySizeForAst(e.right,t);return!t.arraysFlag&&(1<a.height||1<a.width||1<n.height||1<n.width)?h.error():(a=a,n=n,new h(Math.max(a.width,n.width),Math.max(a.height,n.height)));case d.AstNodeType.MINUS_UNARY_OP:case d.AstNodeType.PLUS_UNARY_OP:case d.AstNodeType.PERCENT_OP:var l=this.checkArraySizeForAst(e.value,t);return!t.arraysFlag&&(1<l.height||1<l.width)?h.error():(l=l,new h(l.width,l.height));case d.AstNodeType.PARENTHESIS:return this.checkArraySizeForAst(e.expression,t);default:d.AstNodeType.EMPTY;return h.error()}}checkArraySizeForFunction(e,t){const n=this.functionRegistry.getMetadata(e.procedureName);var r=this.functionRegistry.getArraySizeFunction(e.procedureName);if(void 0!==r)return r(e,t);var i=e.args.map(e=>{return this.checkArraySizeForAst(e,new l.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(e=null===n||void 0===n?void 0:n.arrayFunction)&&e))});if(void 0===n||n.expandRanges||!t.arraysFlag||n.vectorizationForbidden||void 0===n.parameters)return new h(1,1);var o=[...n.parameters];if(void 0===n.repeatLastArgs&&o.length<i.length)return h.error();if(void 0!==n.repeatLastArgs&&o.length<i.length&&(i.length-o.length)%n.repeatLastArgs!=0)return h.error();for(;o.length<i.length;)o.push(...o.slice(o.length-n.repeatLastArgs));let s=1,a=1;for(let e=0;e<i.length;e++)o[e].argumentType!==u.FunctionArgumentType.RANGE&&o[e].argumentType!==u.FunctionArgumentType.ANY&&(a=Math.max(a,i[e].height),s=Math.max(s,i[e].width));return new h(s,a)}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{AbsoluteCellRange:()=>u,AbsoluteColumnRange:()=>c,AbsoluteRowRange:()=>d,WRONG_RANGE_SIZE:()=>a,isSimpleCellRange:()=>function(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"start"in e&&(0,s.isSimpleCellAddress)(e.start)&&"end"in e&&(0,s.isSimpleCellAddress)(e.end)},simpleCellRange:()=>l});var s=n(3),i=n(77),r=n(7),o=n(71);const a="AbsoluteCellRange: Wrong range size";const l=(e,t)=>({start:e,end:t});class u{constructor(e,t){if(e.sheet!==t.sheet)throw new i.SheetsNotEqual(e.sheet,t.sheet);this.start=(0,s.simpleCellAddress)(e.sheet,e.col,e.row),this.end=(0,s.simpleCellAddress)(t.sheet,t.col,t.row)}get sheet(){return this.start.sheet}static fromSimpleCellAddresses(e,t){if(e.sheet!==t.sheet)throw new i.SheetsNotEqual(e.sheet,t.sheet);var n=t.col-e.col,r=t.row-e.row;return Number.isFinite(r)&&Number.isFinite(n)?new u(e,t):Number.isFinite(r)?new d(e.sheet,e.row,t.row):new c(e.sheet,e.col,t.col)}static fromAst(e,t){return e.type===r.AstNodeType.CELL_RANGE?u.fromCellRange(e,t):e.type===r.AstNodeType.COLUMN_RANGE?c.fromColumnRange(e,t):d.fromRowRangeAst(e,t)}static fromAstOrUndef(e,t){try{return u.fromAst(e,t)}catch(e){}}static fromCellRange(e,t){return new u(e.start.toSimpleCellAddress(t),e.end.toSimpleCellAddress(t))}static spanFrom(e,t,n){e=u.spanFromOrUndef(e,t,n);if(void 0===e)throw new Error(a);return e}static spanFromOrUndef(e,t,n){return!Number.isFinite(t)&&Number.isFinite(n)?0!==e.col?void 0:new d(e.sheet,e.row,e.row+n-1):!Number.isFinite(n)&&Number.isFinite(t)?0!==e.row?void 0:new c(e.sheet,e.col,e.col+t-1):Number.isFinite(n)&&Number.isFinite(t)?new u(e,(0,s.simpleCellAddress)(e.sheet,e.col+t-1,e.row+n-1)):void 0}static fromCoordinates(e,t,n,r,i){return new u((0,s.simpleCellAddress)(e,t,n),(0,s.simpleCellAddress)(e,r,i))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return this.start.sheet==e.start.sheet&&!(this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}addressInRange(e){return this.sheet===e.sheet&&this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}columnInRange(e){return this.sheet===e.sheet&&this.start.col<=e.col&&this.end.col>=e.col}rowInRange(e){return this.sheet===e.sheet&&this.start.row<=e.row&&this.end.row>=e.row}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet===e.start.sheet){var t=Math.max(this.start.row,e.start.row),n=Math.min(this.end.row,e.end.row),r=Math.max(this.start.col,e.start.col),e=Math.min(this.end.col,e.end.col);if(!(n<t||e<r))return new u((0,s.simpleCellAddress)(this.sheet,r,t),(0,s.simpleCellAddress)(this.sheet,e,n))}}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,t){return u.spanFrom((0,s.simpleCellAddress)(this.sheet,this.start.col+e,this.start.row+t),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof o.RowsSpan?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return this.width()<=0||this.height()<=0}rangeWithSameWidth(e,t){return u.spanFrom((0,s.simpleCellAddress)(this.sheet,this.start.col,e),this.width(),t)}rangeWithSameHeight(e,t){return u.spanFrom((0,s.simpleCellAddress)(this.sheet,e,this.start.row),t,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},`+this.end.row}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){var n=[];for(let t=0;t<this.height();++t){n[t]=[];for(let e=0;e<this.width();++e){var r=(0,s.simpleCellAddress)(this.sheet,this.start.col+e,this.start.row+t);n[t].push(r)}}return n}withStart(e){return new u(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return(0,s.equalSimpleCellAddress)(this.start,e.start)&&(0,s.equalSimpleCellAddress)(this.end,e.end)}addressesArrayMap(t,n){var r=[];let i=this.start.row;for(;i<=this.effectiveEndRow(t);){let e=this.start.col;for(var o=[];e<=this.effectiveEndColumn(t);)o.push(n((0,s.simpleCellAddress)(this.start.sheet,e,i))),e++;r.push(o),i++}return r}addresses(e){var t=[];let n=this.start.row;for(var r=this.effectiveEndRow(e),i=this.effectiveEndColumn(e);n<=r;){let e=this.start.col;for(;e<=i;)t.push((0,s.simpleCellAddress)(this.start.sheet,e,n)),e++;n++}return t}*addressesWithDirection(e,t,n){if(0<e)if(0<t){let t=this.effectiveEndRow(n);for(;t>=this.start.row;){let e=this.effectiveEndColumn(n);for(;e>=this.start.col;)yield(0,s.simpleCellAddress)(this.start.sheet,e,t),--e;--t}}else{let t=this.start.row;for(;t<=this.effectiveEndRow(n);){let e=this.effectiveEndColumn(n);for(;e>=this.start.col;)yield(0,s.simpleCellAddress)(this.start.sheet,e,t),--e;t+=1}}else if(0<t){let t=this.effectiveEndRow(n);for(;t>=this.start.row;){let e=this.start.col;for(;e<=this.effectiveEndColumn(n);)yield(0,s.simpleCellAddress)(this.start.sheet,e,t),e+=1;--t}}else{let t=this.start.row;for(;t<=this.effectiveEndRow(n);){let e=this.start.col;for(;e<=this.effectiveEndColumn(n);)yield(0,s.simpleCellAddress)(this.start.sheet,e,t),e+=1;t+=1}}}getAddress(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return(0,s.simpleCellAddress)(this.start.sheet,this.start.col+e,this.start.row+t)}exceedsSheetSizeLimits(e,t){return this.end.col>=e||this.end.row>=t}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,t){if(!(e>this.end.row)){if(t<this.start.row)return this.shiftByRows(-(t-e+1));e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}removeColumns(e,t){if(!(e>this.end.col)){if(t<this.start.col)return this.shiftByColumns(-(t-e+1));e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}}class c extends u{constructor(e,t,n){super((0,s.simpleCellAddress)(e,t,0),(0,s.simpleCellAddress)(e,n,Number.POSITIVE_INFINITY))}static fromColumnRange(e,t){var n=e.start.toSimpleColumnAddress(t),e=e.end.toSimpleColumnAddress(t);if(n.sheet!==e.sheet)throw new i.SheetsNotEqual(n.sheet,e.sheet);return new c(n.sheet,n.col,e.col)}shouldBeRemoved(){return this.width()<=0}shiftByRows(e){}expandByRows(e){}shifted(e,t){return new c(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,t){return new c(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,t){}}class d extends u{constructor(e,t,n){super((0,s.simpleCellAddress)(e,0,t),(0,s.simpleCellAddress)(e,Number.POSITIVE_INFINITY,n))}static fromRowRangeAst(e,t){var n=e.start.toSimpleRowAddress(t),e=e.end.toSimpleRowAddress(t);if(n.sheet!==e.sheet)throw new i.SheetsNotEqual(n.sheet,e.sheet);return new d(n.sheet,n.row,e.row)}shouldBeRemoved(){return this.height()<=0}shiftByColumns(e){}expandByColumns(e){}shifted(e,t){return new d(this.sheet,this.start.row+t,this.end.row+t)}rangeWithSameWidth(e,t){return new d(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.row>=t}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,t){}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{CellError:()=>v,CellType:()=>i,CellValueDetailedType:()=>f,CellValueJustNumber:()=>s,CellValueNoNumber:()=>o,CellValueType:()=>h,CellValueTypeOrd:()=>p,ErrorType:()=>r,absoluteSheetReference:()=>_,addressKey:()=>A,equalSimpleCellAddress:()=>N,getCellType:()=>d,getCellValueDetailedType:()=>m,getCellValueFormat:()=>y,getCellValueType:()=>g,invalidSimpleCellAddress:()=>T,invalidSimpleColumnAddress:()=>w,invalidSimpleRowAddress:()=>E,isSimpleCellAddress:()=>function(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"col"in e&&"number"==typeof e.col&&"row"in e&&"number"==typeof e.row&&"sheet"in e&&"number"==typeof e.sheet},movedSimpleCellAddress:()=>R,simpleCellAddress:()=>S,simpleColumnAddress:()=>C,simpleRowAddress:()=>b});var r,i,o,s,a=n(4),l=n(61),u=n(70),c=n(69);(t=r=r||{}).DIV_BY_ZERO="DIV_BY_ZERO",t.NAME="NAME",t.VALUE="VALUE",t.NUM="NUM",t.NA="NA",t.CYCLE="CYCLE",t.REF="REF",t.SPILL="SPILL",t.LIC="LIC",t.ERROR="ERROR",(n=i=i||{}).FORMULA="FORMULA",n.VALUE="VALUE",n.ARRAY="ARRAY",n.EMPTY="EMPTY",n.ARRAYFORMULA="ARRAYFORMULA";const d=(e,t)=>e instanceof a.ArrayVertex?e.isLeftCorner(t)?i.ARRAYFORMULA:i.ARRAY:e instanceof a.FormulaCellVertex||e instanceof a.ParsingErrorVertex?i.FORMULA:e instanceof a.ValueCellVertex?i.VALUE:i.EMPTY,h=((t=o=o||{}).EMPTY="EMPTY",t.NUMBER="NUMBER",t.STRING="STRING",t.BOOLEAN="BOOLEAN",t.ERROR="ERROR",(s=s||{}).NUMBER="NUMBER",Object.assign(Object.assign({},o),s)),f=Object.assign(Object.assign({},o),u.NumberType),p=e=>{switch(e){case h.EMPTY:return 0;case h.NUMBER:return 1;case h.STRING:return 2;case h.BOOLEAN:return 3;case h.ERROR:return 4}throw new Error("Cell value not computed")},g=e=>{if(e===u.EmptyValue)return h.EMPTY;if(e instanceof v||e instanceof c.SimpleRangeValue)return h.ERROR;if("string"==typeof e)return h.STRING;if((0,u.isExtendedNumber)(e))return h.NUMBER;if("boolean"==typeof e)return h.BOOLEAN;throw new Error("Cell value not computed")},m=e=>((0,u.isExtendedNumber)(e)?(0,u.getTypeOfExtendedNumber):g)(e),y=e=>{if((0,u.isExtendedNumber)(e))return(0,u.getFormatOfExtendedNumber)(e)};class v{constructor(e,t,n){this.type=e,this.message=t,this.root=n}static parsingError(){return new v(r.ERROR,l.ErrorMessage.ParseError)}attachRootVertex(e){return void 0===this.root?new v(this.type,this.message,e):this}}const b=(e,t)=>({sheet:e,row:t}),E=e=>e.row<0,C=(e,t)=>({sheet:e,col:t}),w=e=>e.col<0,S=(e,t,n)=>({sheet:e,col:t,row:n}),T=e=>e.col<0||e.row<0,R=(e,t,n,r)=>S(t,e.col+n,e.row+r),A=e=>`${e.sheet},${e.row},`+e.col;const _=(e,t)=>{return null!=(e=e.sheet)?e:t.sheet},N=(e,t)=>e.sheet===t.sheet&&e.col===t.col&&e.row===t.row},(e,t,n)=>{"use strict";n.r(t),n.d(t,{AddressMapping:()=>i.AddressMapping,ArrayMapping:()=>l.ArrayMapping,ArrayVertex:()=>u.ArrayVertex,DenseStrategy:()=>g.DenseStrategy,DependencyGraph:()=>r.DependencyGraph,EmptyCellVertex:()=>c.EmptyCellVertex,FormulaCellVertex:()=>u.FormulaCellVertex,Graph:()=>o.Graph,ParsingErrorVertex:()=>h.ParsingErrorVertex,RangeMapping:()=>s.RangeMapping,RangeVertex:()=>f.RangeVertex,SheetMapping:()=>a.SheetMapping,SparseStrategy:()=>p.SparseStrategy,ValueCellVertex:()=>d.ValueCellVertex});var r=n(5),i=n(76),o=n(83),s=n(84),a=n(85),l=n(78),u=n(80),c=n(88),d=n(89),h=n(90),f=n(82),p=n(91),g=n(92)},(e,t,n)=>{"use strict";n.r(t),n.d(t,{DependencyGraph:()=>C});var l=n(2),u=n(6),f=n(3),c=n(68),r=n(61),d=n(70),i=n(69),h=n(7),p=n(71),o=n(72),g=n(4),s=n(76),a=n(78),m=n(79),y=n(80),v=n(83),b=n(84),E=n(85);class C{constructor(e,t,n,r,i,o,s,a){this.addressMapping=e,this.rangeMapping=t,this.sheetMapping=n,this.arrayMapping=r,this.stats=i,this.lazilyTransformingAstService=o,this.functionRegistry=s,this.namedExpressions=a,this.changes=c.ContentChanges.empty(),this.dependencyQueryAddresses=e=>{if(e instanceof g.RangeVertex)return this.rangeDependencyQuery(e).map(([e])=>e);e=this.formulaDependencyQuery(e);if(void 0===e)return[];{const[t,n]=e;return n.map(e=>e instanceof h.NamedExpressionDependency?this.namedExpressions.namedExpressionOrPlaceholder(e.name,t.sheet).address:(0,f.isSimpleCellAddress)(e)?e:(0,l.simpleCellRange)(e.start,e.end))}},this.dependencyQueryVertices=e=>{if(e instanceof g.RangeVertex)return this.rangeDependencyQuery(e);e=this.formulaDependencyQuery(e);if(void 0===e)return[];{const[n,t]=e;return t.map(e=>{var t;return e instanceof l.AbsoluteCellRange?[e.start,this.rangeMapping.fetchRange(e.start,e.end)]:e instanceof h.NamedExpressionDependency?[(t=this.namedExpressions.namedExpressionOrPlaceholder(e.name,n.sheet)).address,this.addressMapping.fetchCell(t.address)]:[e,this.addressMapping.fetchCell(e)]})}},this.rangeDependencyQuery=e=>{var t=[],{smallerRangeVertex:n,restRange:r}=this.rangeMapping.findSmallerRange(e.range);let i;void 0!==n&&this.graph.adjacentNodes(n).has(e)?(i=r,t.push([new l.AbsoluteCellRange(n.start,n.end),n])):i=e.range;for(const s of i.addresses(this)){var o=this.addressMapping.getCell(s);void 0!==o&&t.push([s,o])}return t},this.formulaDependencyQuery=e=>{let t,n;if(e instanceof y.FormulaVertex)return n=e.getAddress(this.lazilyTransformingAstService),t=e.getFormula(this.lazilyTransformingAstService),e=(0,h.collectDependencies)(t,this.functionRegistry),[n,(0,u.absolutizeDependencies)(e,n)]},this.graph=new v.Graph(this.dependencyQueryVertices)}static buildEmpty(e,t,n,r,i){return new C(new s.AddressMapping(t.chooseAddressMappingPolicy),new b.RangeMapping,new E.SheetMapping(t.translationPackage),new a.ArrayMapping,i,e,n,r)}setFormulaToCell(e,t,n,r,i,o){t=y.FormulaVertex.fromAst(t,e,r,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(t),this.processCellDependencies(n,t),this.graph.markNodeAsSpecialRecentlyChanged(t),i&&this.markAsVolatile(t),o&&this.markAsDependentOnStructureChange(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,t){var n=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(n,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsSpecialRecentlyChanged(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,t){var n=this.shrinkPossibleArrayAndGetCell(e);return n instanceof g.ArrayVertex&&this.arrayMapping.removeArray(n.getRange()),n instanceof g.ValueCellVertex?n.getValues().rawValue!==t.rawValue&&(n.setValues(t),this.graph.markNodeAsSpecialRecentlyChanged(n)):(t=new g.ValueCellVertex(t.parsedValue,t.rawValue),this.exchangeOrAddGraphNode(n,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsSpecialRecentlyChanged(t)),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){var t,n=this.shrinkPossibleArrayAndGetCell(e);return void 0===n?c.ContentChanges.empty():(0<this.graph.adjacentNodes(n).size?(t=new g.EmptyCellVertex,this.exchangeGraphNode(n,t),0===this.graph.adjacentNodesCount(t)?(this.removeVertex(t),this.addressMapping.removeCell(e)):(this.graph.markNodeAsSpecialRecentlyChanged(t),this.addressMapping.setCell(e,t))):(this.removeVertex(n),this.addressMapping.removeCell(e)),this.getAndClearContentChanges())}ensureThatVertexIsNonArrayCellVertex(e){if(e instanceof g.ArrayVertex)throw new Error("Illegal operation")}clearRecentlyChangedVertices(){this.graph.clearSpecialNodesRecentlyChanged()}verticesToRecompute(){return new Set([...this.graph.specialNodesRecentlyChanged,...this.volatileVertices()])}processCellDependencies(e,a){e.forEach(t=>{if(t instanceof l.AbsoluteCellRange){var n=t;let e=this.getRange(n.start,n.end);void 0===e&&(e=new g.RangeVertex(n),this.rangeMapping.setRange(e)),this.graph.addNode(e),n.isFinite()||this.graph.markNodeAsInfiniteRange(e);var{smallerRangeVertex:r,restRange:i}=this.rangeMapping.findSmallerRange(n);if(void 0!==r){if(this.graph.addEdge(r,e),e.bruteForce){e.bruteForce=!1;for(const o of n.addresses(this))this.graph.removeEdge(this.fetchCell(o),e)}}else e.bruteForce=!0;r=this.arrayMapping.getArray(i);if(void 0!==r)this.graph.addEdge(r,e);else for(const s of i.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(s),e);this.graph.addEdge(e,a),n.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(e)}else t instanceof h.NamedExpressionDependency?(r=a.getAddress(this.lazilyTransformingAstService).sheet,i=this.fetchNamedExpressionVertex(t.name,r),this.graph.addEdge(i,a)):this.graph.addEdge(this.fetchCellOrCreateEmpty(t),a)})}fetchNamedExpressionVertex(e,t){e=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(e.address)}exchangeNode(e,t){var n=this.fetchCellOrCreateEmpty(e),t=this.fetchCellOrCreateEmpty(t);this.addressMapping.removeCell(e),this.exchangeGraphNode(n,t)}correctInfiniteRangesDependency(e){let t=void 0;for(const r of this.graph.infiniteRanges){var n=r;n.range.addressInRange(e)&&(t=null!==t&&void 0!==t?t:this.fetchCellOrCreateEmpty(e),this.graph.addEdge(t,n))}}fetchCellOrCreateEmpty(e){let t=this.addressMapping.getCell(e);return void 0===t&&(t=new g.EmptyCellVertex,this.graph.addNode(t),this.addressMapping.setCell(e,t)),t}removeRows(r){this.stats.measure(o.StatType.ADJUSTING_GRAPH,()=>{for(var[e,t]of this.addressMapping.entriesFromRowsSpan(r)){for(const n of this.graph.adjacentNodes(t))this.graph.markNodeAsSpecialRecentlyChanged(n);if(t instanceof g.ArrayVertex){if(!t.isLeftCorner(e))continue;this.shrinkArrayToCorner(t),this.arrayMapping.removeArray(t.getRange())}this.removeVertex(t)}}),this.stats.measure(o.StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeRows(r)});var e=this.stats.measure(o.StatType.ADJUSTING_RANGES,()=>{var e=this.truncateRanges(r,e=>e.row);return this.getArrayVerticesRelatedToRanges(e)});return this.stats.measure(o.StatType.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterRemovingRows(r.sheet,r.rowStart,r.numberOfRows)}),this.addStructuralNodesToChangeSet(),{affectedArrays:e,contentChanges:this.getAndClearContentChanges()}}removeSheet(t){this.clearSheet(t);for(var[e,n]of this.addressMapping.sheetEntries(t)){for(const r of this.graph.adjacentNodes(n))this.graph.markNodeAsSpecialRecentlyChanged(r);this.removeVertex(n),this.addressMapping.removeCell(e)}this.stats.measure(o.StatType.ADJUSTING_RANGES,()=>{for(const e of this.rangeMapping.removeRangesInSheet(t))this.removeVertex(e);this.stats.measure(o.StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeSheet(t)})})}clearSheet(e){var t,n,r=new Set;for([t,n]of this.addressMapping.sheetEntries(e))n instanceof g.ArrayVertex?r.add(n):this.setCellEmpty(t);for(const i of r.values())this.setArrayEmpty(i);this.addStructuralNodesToChangeSet()}removeColumns(r){this.stats.measure(o.StatType.ADJUSTING_GRAPH,()=>{for(var[e,t]of this.addressMapping.entriesFromColumnsSpan(r)){for(const n of this.graph.adjacentNodes(t))this.graph.markNodeAsSpecialRecentlyChanged(n);if(t instanceof g.ArrayVertex){if(!t.isLeftCorner(e))continue;this.shrinkArrayToCorner(t),this.arrayMapping.removeArray(t.getRange())}this.removeVertex(t)}}),this.stats.measure(o.StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeColumns(r)});var e=this.stats.measure(o.StatType.ADJUSTING_RANGES,()=>{var e=this.truncateRanges(r,e=>e.col);return this.getArrayVerticesRelatedToRanges(e)});return this.stats.measure(o.StatType.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterRemovingColumns(r.sheet,r.columnStart,r.numberOfColumns)),this.addStructuralNodesToChangeSet(),{affectedArrays:e,contentChanges:this.getAndClearContentChanges()}}addRows(t){this.stats.measure(o.StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addRows(t.sheet,t.rowStart,t.numberOfRows)});var e=this.stats.measure(o.StatType.ADJUSTING_RANGES,()=>{var e=this.rangeMapping.moveAllRangesInSheetAfterRowByRows(t.sheet,t.rowStart,t.numberOfRows);return this.fixRangesWhenAddingRows(t.sheet,t.rowStart,t.numberOfRows),this.getArrayVerticesRelatedToRanges(e.verticesWithChangedSize)});this.stats.measure(o.StatType.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterAddingRow(t.sheet,t.rowStart,t.numberOfRows)});for(const n of this.addressMapping.verticesFromRowsSpan(t))this.graph.markNodeAsSpecialRecentlyChanged(n);return this.addStructuralNodesToChangeSet(),{affectedArrays:e}}addColumns(t){this.stats.measure(o.StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addColumns(t.sheet,t.columnStart,t.numberOfColumns)});var e=this.stats.measure(o.StatType.ADJUSTING_RANGES,()=>{var e=this.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(t.sheet,t.columnStart,t.numberOfColumns);return this.fixRangesWhenAddingColumns(t.sheet,t.columnStart,t.numberOfColumns),this.getArrayVerticesRelatedToRanges(e.verticesWithChangedSize)});this.stats.measure(o.StatType.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterAddingColumn(t.sheet,t.columnStart,t.numberOfColumns));for(const n of this.addressMapping.verticesFromColumnsSpan(t))this.graph.markNodeAsSpecialRecentlyChanged(n);return this.addStructuralNodesToChangeSet(),{affectedArrays:e,contentChanges:this.getAndClearContentChanges()}}ensureNoArrayInRange(e){if(this.arrayMapping.isFormulaArrayInRange(e))throw Error("It is not possible to move / replace cells with array")}isThereSpaceForArray(e){var t=e.getRangeOrUndef();if(void 0===t)return!1;for(const r of t.addresses(this)){var n=this.addressMapping.getCell(r);if(void 0!==n&&!(n instanceof g.EmptyCellVertex)&&n!==e)return!1}return!0}moveCells(n,e,r,i){for(const a of n.addressesWithDirection(e,r,this)){var o=(0,f.simpleCellAddress)(i,a.col+e,a.row+r);let t=this.addressMapping.getCell(a);var s=this.addressMapping.getCell(o);if(this.addressMapping.removeCell(a),void 0!==t){this.graph.markNodeAsSpecialRecentlyChanged(t),this.addressMapping.setCell(o,t);let e=void 0;for(const l of this.graph.adjacentNodes(t))l instanceof g.RangeVertex&&!n.containsRange(l.range)&&(e=null!==e&&void 0!==e?e:this.fetchCellOrCreateEmpty(a),this.graph.addEdge(e,l),this.graph.removeEdge(t,l));e&&(this.graph.markNodeAsSpecialRecentlyChanged(e),this.addressMapping.setCell(a,e))}if(void 0!==s){void 0===t&&this.addressMapping.removeCell(o);for(const u of this.graph.adjacentNodes(s))t=null!==t&&void 0!==t?t:this.fetchCellOrCreateEmpty(o),this.graph.addEdge(t,u),this.graph.markNodeAsSpecialRecentlyChanged(t);this.removeVertex(s)}}for(const c of this.rangeMapping.rangeVerticesContainedInRange(n))for(const d of this.graph.adjacentNodes(c))if(d instanceof g.RangeVertex&&!n.containsRange(d.range)){this.graph.removeEdge(c,d);for(const h of c.range.addresses(this)){var t=this.fetchCellOrCreateEmpty(h);this.graph.addEdge(t,d),this.addressMapping.setCell(h,t),this.graph.markNodeAsSpecialRecentlyChanged(t)}}this.rangeMapping.moveRangesInsideSourceRange(n,e,r,i)}setArrayEmpty(e){var t=l.AbsoluteCellRange.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),n=this.graph.adjacentNodes(e);for(const o of t.addresses(this))this.addressMapping.removeCell(o);for(const s of n.values()){var r=(0,m.collectAddressesDependentToRange)(this.functionRegistry,s,e.getRange(),this.lazilyTransformingAstService,this);for(const a of r){var i=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(i,s)}0<r.length&&this.graph.markNodeAsSpecialRecentlyChanged(s)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,t){this.graph.addNode(t),this.addressMapping.setCell(e,t)}addArrayVertex(e,t){this.graph.addNode(t),this.setAddressMappingForArrayVertex(t,e)}*arrayFormulaNodes(){for(const e of this.graph.nodes)e instanceof g.ArrayVertex&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}existsVertex(e){return this.addressMapping.has(e)}fetchCell(e){return this.addressMapping.fetchCell(e)}getCell(e){return this.addressMapping.getCell(e)}getCellValue(e){return this.addressMapping.getCellValue(e)}getRawValue(e){return this.addressMapping.getRawValue(e)}getScalarValue(e){e=this.addressMapping.getCellValue(e);return e instanceof i.SimpleRangeValue?new f.CellError(f.ErrorType.VALUE,r.ErrorMessage.ScalarExpected):e}existsEdge(e,t){return this.graph.existsEdge(e,t)}getSheetId(e){return this.sheetMapping.fetch(e)}getSheetHeight(e){return this.addressMapping.getHeight(e)}getSheetWidth(e){return this.addressMapping.getWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}setArray(e,t){this.arrayMapping.setArray(e,t)}getRange(e,t){return this.rangeMapping.getRange(e,t)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsSpecial(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(const e of this.graph.nodes.values())e instanceof g.FormulaCellVertex&&e.ensureRecentData(this.lazilyTransformingAstService)}volatileVertices(){return this.graph.specialNodes}getArrayVerticesRelatedToRanges(e){e=e.map(e=>this.graph.hasNode(e)?Array.from(this.graph.adjacentNodes(e)).filter(e=>e instanceof g.ArrayVertex):[]);return new Set(...e)}*rawValuesFromRange(e){for(const n of e.addresses(this)){var t=this.getScalarValue(n);t!==d.EmptyValue&&(yield[(0,d.getRawValue)(t),n])}}*entriesFromRange(e){for(const t of e.addresses(this))yield[t,this.getCell(t)]}exchangeGraphNode(e,t){this.graph.addNode(t);var n=this.graph.adjacentNodes(e);this.removeVertex(e),n.forEach(e=>{this.graph.hasNode(e)&&this.graph.addEdge(t,e)})}exchangeOrAddGraphNode(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNode(t)}computeListOfValuesInRange(e){var t=[];for(const r of e.addresses(this)){var n=this.getScalarValue(r);t.push(n)}return t}shrinkArrayToCorner(n){this.cleanAddressMappingUnderArray(n);for(const o of this.adjacentArrayVertices(n)){let e,t=!1;for(var[r,i]of e=o instanceof y.FormulaVertex?this.formulaDirectDependenciesToArray(o,n):this.rangeDirectDependenciesToArray(o,n))n.isLeftCorner(r)&&(t=!0),this.graph.addEdge(i,o),this.graph.markNodeAsSpecialRecentlyChanged(i);t||this.graph.removeEdge(n,o)}this.graph.markNodeAsSpecialRecentlyChanged(n)}isArrayInternalCell(e){var t=this.getCell(e);return t instanceof g.ArrayVertex&&!t.isLeftCorner(e)}getAndClearContentChanges(){var e=this.changes;return this.changes=c.ContentChanges.empty(),e}getAdjacentNodesAddresses(e){e=this.graph.adjacentNodes(e);const t=[];return e.forEach(e=>{e instanceof g.RangeVertex?t.push((0,l.simpleCellRange)(e.start,e.end)):t.push(e.getAddress(this.lazilyTransformingAstService))}),t}correctInfiniteRangesDependenciesByRangeVertex(e){for(const n of this.graph.infiniteRanges){var t=n,t=e.range.intersectionWith(t.range);if(void 0!==t)for(const r of t.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(r),n)}}cleanAddressMappingUnderArray(e){for(const n of e.getRange().addresses(this)){var t=e.getArrayCellValue(n);this.getCell(n)===e?e.isLeftCorner(n)?this.changes.addChange(new f.CellError(f.ErrorType.REF),n,t):(this.addressMapping.removeCell(n),this.changes.addChange(d.EmptyValue,n,t)):this.changes.addChange(d.EmptyValue,n,t)}}*formulaDirectDependenciesToArray(e,t){var[,e]=null!=(e=this.formulaDependencyQuery(e))?e:[];if(void 0!==e)for(const n of e)if(!(n instanceof h.NamedExpressionDependency||n instanceof l.AbsoluteCellRange)&&t.getRange().addressInRange(n)){const e=this.fetchCellOrCreateEmpty(n);yield[n,e]}}*rangeDirectDependenciesToArray(e,t){var n,e=this.rangeMapping.findSmallerRange(e.range)["restRange"];for(const r of e.addresses(this))t.getRange().addressInRange(r)&&(n=this.fetchCellOrCreateEmpty(r),yield[r,n])}*adjacentArrayVertices(e){for(const t of this.graph.adjacentNodes(e))(t instanceof y.FormulaVertex||t instanceof g.RangeVertex)&&(yield t)}addStructuralNodesToChangeSet(){for(const e of this.graph.specialNodesStructuralChanges)this.graph.markNodeAsSpecialRecentlyChanged(e)}fixRangesWhenAddingRows(e,t,n){for(const o of Array.from(this.rangeMapping.rangesInSheet(e)))if(o.range.includesRow(t+n))if(o.bruteForce)for(const s of o.range.rangeWithSameWidth(t,n).addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(s),o);else{let e=o,t=this.rangeMapping.findSmallerRange(e.range);if(void 0===t.smallerRangeVertex){for(;void 0===t.smallerRangeVertex;){var r=new g.RangeVertex(l.AbsoluteCellRange.spanFrom(e.range.start,e.range.width(),e.range.height()-1)),i=(this.rangeMapping.setRange(r),this.graph.addNode(r),new l.AbsoluteCellRange((0,f.simpleCellAddress)(e.range.start.sheet,e.range.start.col,e.range.end.row),e.range.end));this.addAllFromRange(i,e),this.graph.addEdge(r,e),e=r,t=this.rangeMapping.findSmallerRange(e.range)}this.graph.addEdge(t.smallerRangeVertex,e),this.addAllFromRange(t.restRange,e),this.graph.removeEdge(t.smallerRangeVertex,o)}}}addAllFromRange(e,t){for(const n of e.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(n),t)}fixRangesWhenAddingColumns(t,n,r){for(const i of this.rangeMapping.rangesInSheet(t))if(i.range.includesColumn(n+r)){let e;for(const o of(e=i.bruteForce?i.range.rangeWithSameHeight(n,r):l.AbsoluteCellRange.spanFrom((0,f.simpleCellAddress)(t,n,i.range.end.row),r,1)).addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(o),i)}}exchangeOrAddFormulaVertex(e){var t,n=e.getAddress(this.lazilyTransformingAstService),r=l.AbsoluteCellRange.spanFrom(n,e.width,e.height),i=this.shrinkPossibleArrayAndGetCell(n);if(e instanceof g.ArrayVertex&&this.setArray(r,e),this.exchangeOrAddGraphNode(i,e),this.addressMapping.setCell(n,e),e instanceof g.ArrayVertex){if(!this.isThereSpaceForArray(e))return;for(const o of r.addresses(this))e.isLeftCorner(o)||(t=this.getCell(o),this.exchangeOrAddGraphNode(t,e))}for(const s of r.addresses(this))this.addressMapping.setCell(s,e)}setAddressMappingForArrayVertex(e,t){if(this.addressMapping.setCell(t,e),e instanceof g.ArrayVertex){t=l.AbsoluteCellRange.spanFromOrUndef(t,e.width,e.height);if(void 0!==t&&(this.setArray(t,e),this.isThereSpaceForArray(e)))for(const n of t.addresses(this))this.addressMapping.setCell(n,e)}}truncateRanges(e,t){var n,r,{verticesToRemove:e,verticesToMerge:t,verticesWithChangedSize:i}=this.rangeMapping.truncateRanges(e,t);for([n,r]of t)this.mergeRangeVertices(n,r);for(const o of e)this.removeVertexAndCleanupDependencies(o);return i}fixArraysAfterAddingRow(n,r,i){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(n,r,i),!(r<=0))for(var[,o]of this.arrayMapping.arraysInRows(p.RowsSpan.fromRowStartAndEnd(n,r-1,r-1))){var s=o.getRange();for(let t=s.start.col;t<=s.end.col;++t)for(let e=r;e<=s.end.row;++e){var a=(0,f.simpleCellAddress)(n,t,e),l=(0,f.simpleCellAddress)(n,t,e+i),u=o.getArrayCellValue(a);this.addressMapping.moveCell(l,a),this.changes.addChange(d.EmptyValue,l,u)}}}fixArraysAfterRemovingRows(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,-n),!(t<=0))for(var[,r]of this.arrayMapping.arraysInRows(p.RowsSpan.fromRowStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(r))for(const i of r.getRange().addresses(this))this.addressMapping.setCell(i,r);else this.setNoSpaceIfArray(r)}fixArraysAfterAddingColumn(n,r,i){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(n,r,i),!(r<=0))for(var[,o]of this.arrayMapping.arraysInCols(p.ColumnsSpan.fromColumnStartAndEnd(n,r-1,r-1))){var s=o.getRange();for(let t=s.start.row;t<=s.end.row;++t)for(let e=r;e<=s.end.col;++e){var a=(0,f.simpleCellAddress)(n,e,t),l=(0,f.simpleCellAddress)(n,e+i,t),u=o.getArrayCellValue(a);this.addressMapping.moveCell(l,a),this.changes.addChange(d.EmptyValue,l,u)}}}fixArraysAfterRemovingColumns(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,-n),!(t<=0))for(var[,r]of this.arrayMapping.arraysInCols(p.ColumnsSpan.fromColumnStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(r))for(const i of r.getRange().addresses(this))this.addressMapping.setCell(i,r);else this.setNoSpaceIfArray(r)}shrinkPossibleArrayAndGetCell(e){var t=this.getCell(e);return t instanceof g.ArrayVertex?(this.setNoSpaceIfArray(t),this.getCell(e)):t}setNoSpaceIfArray(e){e instanceof g.ArrayVertex&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof g.RangeVertex&&this.rangeMapping.removeRange(e)}mergeRangeVertices(t,e){var n=this.graph.adjacentNodes(e);this.removeVertexAndCleanupDependencies(e),this.graph.softRemoveEdge(t,e),n.forEach(e=>{this.graph.hasNode(e)&&this.graph.addEdge(t,e)})}removeVertexAndCleanupDependencies(e){const t=new Set(this.graph.removeNode(e));for(;0<t.size;){var n=t.values().next().value,[n,r]=(t.delete(n),n);this.graph.hasNode(r)&&0===this.graph.adjacentNodesCount(r)&&((r instanceof g.RangeVertex||r instanceof g.EmptyCellVertex)&&this.graph.removeNode(r).forEach(e=>t.add(e)),r instanceof g.RangeVertex?this.rangeMapping.removeRange(r):r instanceof g.EmptyCellVertex&&this.addressMapping.removeCell(n))}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{absolutizeDependencies:()=>s,filterDependenciesOutOfScope:()=>a});var r=n(2),i=n(3),o=n(7);const s=(e,t)=>e.map(e=>e.absolutize(t)),a=e=>e.filter(e=>e instanceof o.NamedExpressionDependency||(e instanceof r.AbsoluteCellRange?!((0,i.invalidSimpleCellAddress)(e.start)||(0,i.invalidSimpleCellAddress)(e.end)):!(0,i.invalidSimpleCellAddress)(e)))},(e,t,n)=>{"use strict";n.r(t),n.d(t,{AddressDependency:()=>d.AddressDependency,AstNodeType:()=>u.AstNodeType,CellAddress:()=>i.CellAddress,CellRangeDependency:()=>d.CellRangeDependency,ColumnRangeDependency:()=>d.ColumnRangeDependency,FormulaLexer:()=>l.FormulaLexer,NamedExpressionDependency:()=>d.NamedExpressionDependency,ParserWithCaching:()=>o.ParserWithCaching,ParsingErrorType:()=>u.ParsingErrorType,RowRangeDependency:()=>d.RowRangeDependency,Unparser:()=>c.Unparser,buildCellErrorAst:()=>u.buildCellErrorAst,buildCellRangeAst:()=>u.buildCellRangeAst,buildLexerConfig:()=>a.buildLexerConfig,buildParsingErrorAst:()=>u.buildParsingErrorAst,buildProcedureAst:()=>u.buildProcedureAst,cellAddressFromString:()=>r.cellAddressFromString,collectDependencies:()=>s.collectDependencies,simpleCellAddressFromString:()=>r.simpleCellAddressFromString,simpleCellAddressToString:()=>r.simpleCellAddressToString,simpleCellRangeFromString:()=>r.simpleCellRangeFromString,simpleCellRangeToString:()=>r.simpleCellRangeToString});var r=n(8),i=n(9),o=n(13),s=n(66),a=n(62),l=n(60),u=n(57),c=n(65),d=n(67)},(e,t,n)=>{"use strict";n.r(t),n.d(t,{cellAddressFromString:()=>f,columnAddressFromString:()=>p,columnIndexToLabel:()=>C,rowAddressFromString:()=>g,sheetIndexToString:()=>w,simpleCellAddressFromString:()=>m,simpleCellAddressToString:()=>v,simpleCellRangeFromString:()=>y,simpleCellRangeToString:()=>b});var i=n(2),o=n(3),s=n(9),a=n(10),l=n(12),u=n(11);const c=new RegExp(`^(${l.SHEET_NAME_PATTERN})?(\\${l.ABSOLUTE_OPERATOR}?)([A-Za-z]+)(\\${l.ABSOLUTE_OPERATOR}?)([0-9]+)$`),d=new RegExp(`^(${l.SHEET_NAME_PATTERN})?(\\${l.ABSOLUTE_OPERATOR}?)([A-Za-z]+)$`),h=new RegExp(`^(${l.SHEET_NAME_PATTERN})?(\\${l.ABSOLUTE_OPERATOR}?)([0-9]+)$`),r=new RegExp(`^${l.UNQUOTED_SHEET_NAME_PATTERN}$`),f=(e,t,n)=>{var t=c.exec(t),r=E(t[6]);let i=S(t,e);if(void 0!==i)return null===i&&(i=void 0),e=Number(t[8])-1,t[5]===l.ABSOLUTE_OPERATOR&&t[7]===l.ABSOLUTE_OPERATOR?s.CellAddress.absolute(r,e,i):t[5]===l.ABSOLUTE_OPERATOR?s.CellAddress.absoluteCol(r,e-n.row,i):t[7]===l.ABSOLUTE_OPERATOR?s.CellAddress.absoluteRow(r-n.col,e,i):s.CellAddress.relative(r-n.col,e-n.row,i)},p=(e,t,n)=>{t=d.exec(t);let r=S(t,e);if(void 0!==r)return null===r&&(r=void 0),e=E(t[6]),t[5]===l.ABSOLUTE_OPERATOR?a.ColumnAddress.absolute(e,r):a.ColumnAddress.relative(e-n.col,r)},g=(e,t,n)=>{t=h.exec(t);let r=S(t,e);if(void 0!==r)return null===r&&(r=void 0),e=Number(t[6])-1,t[5]===l.ABSOLUTE_OPERATOR?u.RowAddress.absolute(e,r):u.RowAddress.relative(e-n.row,r)},m=(e,t,n)=>{var t=c.exec(t),r=E(t[6]);let i=S(t,e);if(void 0!==i)return null===i&&(i=n),e=Number(t[8])-1,(0,o.simpleCellAddress)(i,r,e)},y=(e,t,n)=>{t=t.split(l.RANGE_OPERATOR);if(2===t.length){var[t,r]=t,t=m(e,t,n);if(void 0!==t){n=m(e,r,t.sheet);if(void 0!==n&&t.sheet===n.sheet)return(0,i.simpleCellRange)(t,n)}}},v=(e,t,n)=>{var r=C(t.col),e=w(t.sheet,e);if(void 0!==e)return n!==t.sheet?e+"!"+r+(t.row+1):""+r+(t.row+1)},b=(e,t,n)=>{n=v(e,t.start,n),e=v(e,t.end,t.start.sheet);if(void 0!==n&&void 0!==e)return""+n+l.RANGE_OPERATOR+e};function E(e){return 1===e.length?e.toUpperCase().charCodeAt(0)-65:e.split("").reduce((e,t)=>26*e+(t.toUpperCase().charCodeAt(0)-64),0)-1}function C(e){let t="";for(;0<=e;)t=String.fromCharCode(e%26+97)+t,e=Math.floor(e/26)-1;return t.toUpperCase()}function w(e,t){let n=t(e);if(void 0!==n)return r.test(n)?n:`'${n=n.replace(/'/g,"''")}'`}function S(e,t){var n;let r=null!=(n=e[3])?n:e[2];return r?t(r=r.replace(/''/g,"'")):null}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{CellAddress:()=>l,CellReferenceType:()=>r});var r,i=n(3),o=n(8),s=n(10),a=n(11);(t=r=r||{}).CELL_REFERENCE_RELATIVE="CELL_REFERENCE",t.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",t.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",t.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW";class l{constructor(e,t,n,r){this.col=e,this.row=t,this.type=n,this.sheet=r}static fromColAndRow(e,t,n){return(e.isColumnAbsolute()&&t.isRowAbsolute()?l.absolute:e.isColumnAbsolute()?l.absoluteCol:t.isRowAbsolute()?l.absoluteRow:l.relative).bind(this)(e.col,t.row,n)}static relative(e,t,n){return new l(e,t,r.CELL_REFERENCE_RELATIVE,n)}static absolute(e,t,n){return new l(e,t,r.CELL_REFERENCE_ABSOLUTE,n)}static absoluteCol(e,t,n){return new l(e,t,r.CELL_REFERENCE_ABSOLUTE_COL,n)}static absoluteRow(e,t,n){return new l(e,t,r.CELL_REFERENCE_ABSOLUTE_ROW,n)}toSimpleCellAddress(e){var t=(0,i.absoluteSheetReference)(this,e);return this.type===r.CELL_REFERENCE_ABSOLUTE?(0,i.simpleCellAddress)(t,this.col,this.row):this.type===r.CELL_REFERENCE_ABSOLUTE_ROW?(0,i.simpleCellAddress)(t,e.col+this.col,this.row):this.type===r.CELL_REFERENCE_ABSOLUTE_COL?(0,i.simpleCellAddress)(t,this.col,e.row+this.row):(0,i.simpleCellAddress)(t,e.col+this.col,e.row+this.row)}toColumnAddress(){var e=this.isColumnRelative()?s.ReferenceType.RELATIVE:s.ReferenceType.ABSOLUTE;return new s.ColumnAddress(e,this.col,this.sheet)}toRowAddress(){var e=this.isRowRelative()?s.ReferenceType.RELATIVE:s.ReferenceType.ABSOLUTE;return new a.RowAddress(e,this.row,this.sheet)}toSimpleColumnAddress(e){var t=(0,i.absoluteSheetReference)(this,e);let n=this.col;return this.isColumnRelative()&&(n+=e.col),(0,i.simpleColumnAddress)(t,n)}toSimpleRowAddress(e){var t=(0,i.absoluteSheetReference)(this,e);let n=this.row;return this.isRowRelative()&&(n+=e.row),(0,i.simpleRowAddress)(t,n)}isRowAbsolute(){return this.type===r.CELL_REFERENCE_ABSOLUTE||this.type===r.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===r.CELL_REFERENCE_ABSOLUTE||this.type===r.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===r.CELL_REFERENCE_RELATIVE||this.type===r.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===r.CELL_REFERENCE_RELATIVE||this.type===r.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===r.CELL_REFERENCE_ABSOLUTE&&void 0!==this.sheet}shiftedByRows(e){return new l(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new l(this.col+e,this.row,this.type,this.sheet)}moved(e,t,n){e=void 0===this.sheet?void 0:e;return new l(this.col+t,this.row+n,this.type,e)}withSheet(e){return new l(this.col,this.row,this.type,e)}isInvalid(e){return(0,i.invalidSimpleCellAddress)(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,t){e=this.isColumnAbsolute()?this.col:this.col+e,t=this.isRowAbsolute()?this.row:this.row+t;return new l(e,t,this.type,this.sheet)}shiftAbsoluteDimensions(e,t){e=this.isColumnRelative()?this.col:this.col+e,t=this.isRowRelative()?this.row:this.row+t;return new l(e,t,this.type,this.sheet)}hash(e){var t=e&&void 0!==this.sheet?"#"+this.sheet:"";switch(this.type){case r.CELL_REFERENCE_RELATIVE:return t+`#${this.row}R`+this.col;case r.CELL_REFERENCE_ABSOLUTE:return t+`#${this.row}A`+this.col;case r.CELL_REFERENCE_ABSOLUTE_COL:return t+`#${this.row}AC`+this.col;case r.CELL_REFERENCE_ABSOLUTE_ROW:return t+`#${this.row}AR`+this.col}}unparse(e){var t,n,e=this.toSimpleCellAddress(e);if(!(0,i.invalidSimpleCellAddress)(e))return t=(0,o.columnIndexToLabel)(e.col),n=this.type===r.CELL_REFERENCE_ABSOLUTE||this.type===r.CELL_REFERENCE_ABSOLUTE_ROW?"$":"",(this.type===r.CELL_REFERENCE_ABSOLUTE||this.type===r.CELL_REFERENCE_ABSOLUTE_COL?"$":"")+t+n+(e.row+1)}exceedsSheetSizeLimits(e,t){return this.row>=t||this.col>=e}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ColumnAddress:()=>s,ReferenceType:()=>r});var r,i=n(3),o=n(8);(t=r=r||{}).RELATIVE="RELATIVE",t.ABSOLUTE="ABSOLUTE";class s{constructor(e,t,n){this.type=e,this.col=t,this.sheet=n}static absolute(e,t){return new s(r.ABSOLUTE,e,t)}static relative(e,t){return new s(r.RELATIVE,e,t)}static compareByAbsoluteAddress(n){return(e,t)=>e.toSimpleColumnAddress(n).col-t.toSimpleColumnAddress(n).col}isColumnAbsolute(){return this.type===r.ABSOLUTE}isColumnRelative(){return this.type===r.RELATIVE}isAbsolute(){return this.type===r.ABSOLUTE&&void 0!==this.sheet}moved(e,t,n){e=void 0===this.sheet?void 0:e;return new s(this.type,this.col+t,e)}shiftedByColumns(e){return new s(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){var t=(0,i.absoluteSheetReference)(this,e);let n=this.col;return this.isColumnRelative()&&(n=e.col+this.col),(0,i.simpleColumnAddress)(t,n)}shiftRelativeDimensions(e,t){e=this.isColumnRelative()?this.col+e:this.col;return new s(this.type,e,this.sheet)}shiftAbsoluteDimensions(e,t){e=this.isColumnAbsolute()?this.col+e:this.col;return new s(this.type,e,this.sheet)}withSheet(e){return new s(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){var t=e&&void 0!==this.sheet?"#"+this.sheet:"";switch(this.type){case r.RELATIVE:return t+"#COLR"+this.col;case r.ABSOLUTE:return t+"#COLA"+this.col}}unparse(e){var e=this.toSimpleColumnAddress(e);if(!(0,i.invalidSimpleColumnAddress)(e))return e=(0,o.columnIndexToLabel)(e.col),(this.type===r.ABSOLUTE?"$":"")+e}exceedsSheetSizeLimits(e){return this.col>=e}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{RowAddress:()=>o});var r=n(3),i=n(10);class o{constructor(e,t,n){this.type=e,this.row=t,this.sheet=n}static absolute(e,t){return new o(i.ReferenceType.ABSOLUTE,e,t)}static relative(e,t){return new o(i.ReferenceType.RELATIVE,e,t)}static compareByAbsoluteAddress(n){return(e,t)=>e.toSimpleRowAddress(n).row-t.toSimpleRowAddress(n).row}isRowAbsolute(){return this.type===i.ReferenceType.ABSOLUTE}isRowRelative(){return this.type===i.ReferenceType.RELATIVE}isAbsolute(){return this.type===i.ReferenceType.ABSOLUTE&&void 0!==this.sheet}moved(e,t,n){e=void 0===this.sheet?void 0:e;return new o(this.type,this.row+n,e)}shiftedByRows(e){return new o(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){var t=(0,r.absoluteSheetReference)(this,e);let n=this.row;return this.isRowRelative()&&(n=e.row+this.row),(0,r.simpleRowAddress)(t,n)}shiftRelativeDimensions(e,t){t=this.isRowRelative()?this.row+t:this.row;return new o(this.type,t,this.sheet)}shiftAbsoluteDimensions(e,t){t=this.isRowAbsolute()?this.row+t:this.row;return new o(this.type,t,this.sheet)}withSheet(e){return new o(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){var t=e&&void 0!==this.sheet?"#"+this.sheet:"";switch(this.type){case i.ReferenceType.RELATIVE:return t+"#ROWR"+this.row;case i.ReferenceType.ABSOLUTE:return t+"#ROWA"+this.row}}unparse(e){e=this.toSimpleRowAddress(e);if(!(0,r.invalidSimpleRowAddress)(e))return(this.type===i.ReferenceType.ABSOLUTE?"$":"")+(e.row+1)}exceedsSheetSizeLimits(e){return this.row>=e}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ABSOLUTE_OPERATOR:()=>i,ALL_DIGITS_ARRAY:()=>v,ALL_UNICODE_LETTERS_ARRAY:()=>b,ALL_WHITESPACE_PATTERN:()=>o,CELL_REFERENCE_PATTERN:()=>h,CELL_REFERENCE_WITH_NEXT_CHARACTER_PATTERN:()=>m,COLUMN_REFERENCE_PATTERN:()=>f,NAMED_EXPRESSION_PATTERN:()=>y,NON_RESERVED_CHARACTER_PATTERN:()=>l,ODFF_WHITESPACE_PATTERN:()=>s,QUOTED_SHEET_NAME_PATTERN:()=>c,R1C1_CELL_REFERENCE_PATTERN:()=>g,RANGE_OPERATOR:()=>r,ROW_REFERENCE_PATTERN:()=>p,SHEET_NAME_PATTERN:()=>d,UNICODE_LETTER_PATTERN:()=>a,UNQUOTED_SHEET_NAME_PATTERN:()=>u});const r=":",i="$",o="\\s+",s="[ \\t\\n\\r]+",a="A-Za-zÀ-ʯ",l=a+"0-9_.",u=`[${a}0-9_]+`,c="'(((?!').|'')*)'",d=`(${u}|${c})!`,h=`(${d})?\\${i}?[A-Za-z]+\\${i}?[0-9]+`,f=`(${d})?\\${i}?[A-Za-z]+`,p=`(${d})?\\${i}?[0-9]+`,g="[rR][0-9]*[cC][0-9]*",m=`(${h})[^${l}]`,y=`[${a}_][${l}]*`,v=["0","1","2","3","4","5","6","7","8","9"],b=[...Array.from(Array(26)).map((e,t)=>t+"A".charCodeAt(0)),...Array.from(Array(26)).map((e,t)=>t+"a".charCodeAt(0)),...Array.from(Array(496)).map((e,t)=>t+192)].map(e=>String.fromCharCode(e))},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ParserWithCaching:()=>g});var d=n(14),r=n(3),s=n(7),h=n(8),i=n(57),o=n(58),a=n(59),l=n(60),f=n(62),u=n(65),c=n(10),p=n(11);class g{constructor(e,t,n){this.config=e,this.functionRegistry=t,this.sheetMapping=n,this.statsCacheUsed=0,this.lexerConfig=(0,f.buildLexerConfig)(e),this.lexer=new l.FormulaLexer(this.lexerConfig),this.formulaParser=new l.FormulaParser(this.lexerConfig,this.sheetMapping),this.cache=new a.Cache(this.functionRegistry)}parse(e,t){this.formulaAddress=t;e=this.tokenizeFormula(e);if(0<e.errors.length)return n=e.errors.map(e=>({type:i.ParsingErrorType.LexingError,message:e.message})),{ast:(0,s.buildParsingErrorAst)(),errors:n,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]};var n=this.computeHashFromTokens(e.tokens,t);let r=this.cache.get(n);if(void 0!==r)++this.statsCacheUsed;else{e=this.bindWhitespacesToTokens(e.tokens),e=this.formulaParser.parseFromTokens(e,t);if(0<e.errors.length)return Object.assign(Object.assign({},e),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});r=this.cache.set(n,e.ast)}var{ast:t,hasVolatileFunction:n,hasStructuralChangeFunction:e}=r,t=this.convertReversedRangesToRegularRanges(t);return{ast:t,errors:[],hasVolatileFunction:n,hasStructuralChangeFunction:e,dependencies:(0,s.collectDependencies)(t,this.functionRegistry)}}convertReversedRangesToRegularRanges(e){switch(e.type){case s.AstNodeType.EMPTY:case s.AstNodeType.NUMBER:case s.AstNodeType.STRING:case s.AstNodeType.ERROR:case s.AstNodeType.ERROR_WITH_RAW_INPUT:case s.AstNodeType.CELL_REFERENCE:case s.AstNodeType.NAMED_EXPRESSION:return e;case s.AstNodeType.CELL_RANGE:var{start:t,end:n}=e,t=this.orderCellRangeEnds(t,n);return Object.assign(Object.assign({},e),{start:t.start,end:t.end});case s.AstNodeType.COLUMN_RANGE:var{start:n,end:t}=e,n=this.orderColumnRangeEnds(n,t);return Object.assign(Object.assign({},e),{start:n.start,end:n.end});case s.AstNodeType.ROW_RANGE:var{start:t,end:n}=e,t=this.orderRowRangeEnds(t,n);return Object.assign(Object.assign({},e),{start:t.start,end:t.end});case s.AstNodeType.PERCENT_OP:case s.AstNodeType.PLUS_UNARY_OP:case s.AstNodeType.MINUS_UNARY_OP:n=this.convertReversedRangesToRegularRanges(e.value);return Object.assign(Object.assign({},e),{value:n});case s.AstNodeType.CONCATENATE_OP:case s.AstNodeType.EQUALS_OP:case s.AstNodeType.NOT_EQUAL_OP:case s.AstNodeType.LESS_THAN_OP:case s.AstNodeType.GREATER_THAN_OP:case s.AstNodeType.LESS_THAN_OR_EQUAL_OP:case s.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case s.AstNodeType.MINUS_OP:case s.AstNodeType.PLUS_OP:case s.AstNodeType.TIMES_OP:case s.AstNodeType.DIV_OP:case s.AstNodeType.POWER_OP:t=this.convertReversedRangesToRegularRanges(e.left),n=this.convertReversedRangesToRegularRanges(e.right);return Object.assign(Object.assign({},e),{left:t,right:n});case s.AstNodeType.PARENTHESIS:t=this.convertReversedRangesToRegularRanges(e.expression);return Object.assign(Object.assign({},e),{expression:t});case s.AstNodeType.FUNCTION_CALL:n=e.args.map(e=>this.convertReversedRangesToRegularRanges(e));return Object.assign(Object.assign({},e),{args:n});case s.AstNodeType.ARRAY:t=e.args.map(e=>e.map(e=>this.convertReversedRangesToRegularRanges(e)));return Object.assign(Object.assign({},e),{args:t})}}orderCellRangeEnds(e,t){var e=[e,t],[t,n]=e.map(e=>e.toColumnAddress()).sort(c.ColumnAddress.compareByAbsoluteAddress(this.formulaAddress)),[r,i]=e.map(e=>e.toRowAddress()).sort(p.RowAddress.compareByAbsoluteAddress(this.formulaAddress)),[e,o]=e.map(e=>e.sheet).sort(g.compareSheetIds.bind(this));return{start:s.CellAddress.fromColAndRow(t,r,e),end:s.CellAddress.fromColAndRow(n,i,o)}}orderColumnRangeEnds(e,t){var e=[e,t],[t,n]=e.sort(c.ColumnAddress.compareByAbsoluteAddress(this.formulaAddress)),[e,r]=e.map(e=>e.sheet).sort(g.compareSheetIds.bind(this));return{start:new c.ColumnAddress(t.type,t.col,e),end:new c.ColumnAddress(n.type,n.col,r)}}orderRowRangeEnds(e,t){var e=[e,t],[t,n]=e.sort(p.RowAddress.compareByAbsoluteAddress(this.formulaAddress)),[e,r]=e.map(e=>e.sheet).sort(g.compareSheetIds.bind(this));return{start:new p.RowAddress(t.type,t.row,e),end:new p.RowAddress(n.type,n.row,r)}}static compareSheetIds(e,t){return(e=null!=e?e:1/0)-(t=null!=t?t:1/0)}fetchCachedResultForAst(e){e=this.computeHashFromAst(e);return this.fetchCachedResult(e)}fetchCachedResult(e){var t,n,r,e=this.cache.get(e);if(void 0===e)throw new Error("There is no AST with such key in the cache");return{ast:e,hasVolatileFunction:t,hasStructuralChangeFunction:n,relativeDependencies:r}=e,{ast:e,errors:[],hasVolatileFunction:t,hasStructuralChangeFunction:n,dependencies:r}}computeHashFromTokens(e,t){let n="",r=0;for(;r<e.length;){var i,o,s,a,l,u,c=e[r];n=(0,d.tokenMatcher)(c,f.CellReference)?void 0===(i=(0,h.cellAddressFromString)(this.sheetMapping,c.image,t))?n.concat(c.image):n.concat(i.hash(!0)):(0,d.tokenMatcher)(c,f.ProcedureName)?(i=c.image.toUpperCase().slice(0,-1),o=null!=(o=this.lexerConfig.functionMapping[i])?o:i,n.concat(o,"(")):(0,d.tokenMatcher)(c,f.ColumnRange)?([o,a]=c.image.split(":"),s=(0,h.columnAddressFromString)(this.sheetMapping,o,t),a=(0,h.columnAddressFromString)(this.sheetMapping,a,t),void 0===s||void 0===a?n.concat("!REF"):n.concat(s.hash(!0),":",a.hash(!0))):(0,d.tokenMatcher)(c,f.RowRange)?([s,a]=c.image.split(":"),l=(0,h.rowAddressFromString)(this.sheetMapping,s,t),u=(0,h.rowAddressFromString)(this.sheetMapping,a,t),void 0===l||void 0===u?n.concat("!REF"):n.concat(l.hash(!0),":",u.hash(!0))):n.concat(c.image),r++}return n}rememberNewAst(e){var t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case s.AstNodeType.EMPTY:return e.leadingWhitespace||"";case s.AstNodeType.NUMBER:return(0,i.imageWithWhitespace)((0,u.formatNumber)(e.value,this.config.decimalSeparator),e.leadingWhitespace);case s.AstNodeType.STRING:return(0,i.imageWithWhitespace)('"'+e.value+'"',e.leadingWhitespace);case s.AstNodeType.NAMED_EXPRESSION:return(0,i.imageWithWhitespace)(e.expressionName,e.leadingWhitespace);case s.AstNodeType.FUNCTION_CALL:var t=e.args.map(e=>this.computeHashOfAstNode(e)).join(this.config.functionArgSeparator),t=e.procedureName+"("+t+(0,i.imageWithWhitespace)(")",e.internalWhitespace);return(0,i.imageWithWhitespace)(t,e.leadingWhitespace);case s.AstNodeType.CELL_REFERENCE:return(0,i.imageWithWhitespace)(e.reference.hash(!0),e.leadingWhitespace);case s.AstNodeType.COLUMN_RANGE:case s.AstNodeType.ROW_RANGE:case s.AstNodeType.CELL_RANGE:var t=e.start.hash(e.sheetReferenceType!==i.RangeSheetReferenceType.RELATIVE),n=e.end.hash(e.sheetReferenceType===i.RangeSheetReferenceType.BOTH_ABSOLUTE);return(0,i.imageWithWhitespace)(t+":"+n,e.leadingWhitespace);case s.AstNodeType.MINUS_UNARY_OP:return(0,i.imageWithWhitespace)("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case s.AstNodeType.PLUS_UNARY_OP:return(0,i.imageWithWhitespace)("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case s.AstNodeType.PERCENT_OP:return this.computeHashOfAstNode(e.value)+(0,i.imageWithWhitespace)("%",e.leadingWhitespace);case s.AstNodeType.ERROR:t=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:r.ErrorType.ERROR);return(0,i.imageWithWhitespace)(t,e.leadingWhitespace);case s.AstNodeType.ERROR_WITH_RAW_INPUT:return(0,i.imageWithWhitespace)(e.rawInput,e.leadingWhitespace);case s.AstNodeType.ARRAY:n=e.args.map(e=>e.map(e=>this.computeHashOfAstNode(e)).join(",")).join(";");return(0,i.imageWithWhitespace)("{"+n+(0,i.imageWithWhitespace)("}",e.internalWhitespace),e.leadingWhitespace);case s.AstNodeType.PARENTHESIS:t="("+this.computeHashOfAstNode(e.expression)+(0,i.imageWithWhitespace)(")",e.internalWhitespace);return(0,i.imageWithWhitespace)(t,e.leadingWhitespace);default:return this.computeHashOfAstNode(e.left)+(0,i.imageWithWhitespace)(o.binaryOpTokenMap[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(t){var n=[],e=t[0];(0,d.tokenMatcher)(e,this.lexerConfig.WhiteSpace)||n.push(e);for(let e=1;e<t.length;++e){var r,i=t[e];(0,d.tokenMatcher)(i,this.lexerConfig.WhiteSpace)||(r=t[e-1],(0,d.tokenMatcher)(r,this.lexerConfig.WhiteSpace)&&(i.leadingWhitespace=r),n.push(i))}return n}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Alternation:()=>c.Alternation,CstParser:()=>i.CstParser,EMPTY_ALT:()=>i.EMPTY_ALT,EOF:()=>s.EOF,EarlyExitException:()=>l.EarlyExitException,EmbeddedActionsParser:()=>i.EmbeddedActionsParser,Flat:()=>c.Flat,GAstVisitor:()=>d.GAstVisitor,Lexer:()=>o.Lexer,LexerDefinitionErrorType:()=>o.LexerDefinitionErrorType,MismatchedTokenException:()=>l.MismatchedTokenException,NoViableAltException:()=>l.NoViableAltException,NonTerminal:()=>c.NonTerminal,NotAllInputParsedException:()=>l.NotAllInputParsedException,Option:()=>c.Option,Parser:()=>i.Parser,ParserDefinitionErrorType:()=>i.ParserDefinitionErrorType,Repetition:()=>c.Repetition,RepetitionMandatory:()=>c.RepetitionMandatory,RepetitionMandatoryWithSeparator:()=>c.RepetitionMandatoryWithSeparator,RepetitionWithSeparator:()=>c.RepetitionWithSeparator,Rule:()=>c.Rule,Terminal:()=>c.Terminal,VERSION:()=>r.VERSION,assignOccurrenceIndices:()=>h.assignOccurrenceIndices,clearCache:()=>function(){console.warn("The clearCache function was 'soft' removed from the Chevrotain API.\n\t It performs no action other than printing this message.\n\t Please avoid using it as it will be completely removed in the future")},createSyntaxDiagramsCode:()=>f.createSyntaxDiagramsCode,createToken:()=>s.createToken,createTokenInstance:()=>s.createTokenInstance,defaultGrammarResolverErrorProvider:()=>a.defaultGrammarResolverErrorProvider,defaultGrammarValidatorErrorProvider:()=>a.defaultGrammarValidatorErrorProvider,defaultLexerErrorProvider:()=>u.defaultLexerErrorProvider,defaultParserErrorProvider:()=>a.defaultParserErrorProvider,generateParserFactory:()=>p.generateParserFactory,generateParserModule:()=>p.generateParserModule,isRecognitionException:()=>l.isRecognitionException,resolveGrammar:()=>h.resolveGrammar,serializeGrammar:()=>c.serializeGrammar,serializeProduction:()=>c.serializeProduction,tokenLabel:()=>s.tokenLabel,tokenMatcher:()=>s.tokenMatcher,tokenName:()=>s.tokenName,validateGrammar:()=>h.validateGrammar});var r=n(15),i=n(16),o=n(22),s=n(21),a=n(35),l=n(42),u=n(28),c=n(20),d=n(31),h=n(39),f=n(54),p=n(55)},(e,t,n)=>{"use strict";n.r(t),n.d(t,{VERSION:()=>r});var r="6.5.0"},(e,t,n)=>{"use strict";n.r(t),n.d(t,{CstParser:()=>A,DEFAULT_PARSER_CONFIG:()=>C,DEFAULT_RULE_CONFIG:()=>w,EMPTY_ALT:()=>function(e){void 0===e&&(e=void 0);return function(){return e}},END_OF_FILE:()=>E,EmbeddedActionsParser:()=>x,Parser:()=>S,ParserDefinitionErrorType:()=>i});var r,i,o=n(17),s=n(18),t=n(21),a=n(33),l=n(35),u=n(39),c=n(41),d=n(43),h=n(44),f=n(47),p=n(48),g=n(49),m=n(50),y=n(51),v=n(52),n=n(53),b=(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),E=(0,t.createTokenInstance)(t.EOF,"",NaN,NaN,NaN,NaN,NaN,NaN),C=(Object.freeze(E),Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:l.defaultParserErrorProvider,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1})),w=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});(t=i=i||{})[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",t[t.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",t[t.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",t[t.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",t[t.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",t[t.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",t[t.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",t[t.TOO_MANY_ALTS=14]="TOO_MANY_ALTS";T.performSelfAnalysis=function(e){e.performSelfAnalysis()},T.prototype.performSelfAnalysis=function(){var r=this;this.TRACE_INIT("performSelfAnalysis",function(){r.selfAnalysisDone=!0;var e,t=r.className,n=(r.TRACE_INIT("toFastProps",function(){(0,o.toFastProperties)(r)}),r.TRACE_INIT("Grammar Recording",function(){try{r.enableRecording(),(0,o.forEach)(r.definedRulesNames,function(e){var t=r[e].originalGrammarAction,n=void 0;r.TRACE_INIT(e+" Rule",function(){n=r.topLevelRuleRecord(e,t)}),r.gastProductionsCache[e]=n})}finally{r.disableRecording()}}),[]);if(r.TRACE_INIT("Grammar Resolving",function(){n=(0,u.resolveGrammar)({rules:(0,o.values)(r.gastProductionsCache)}),r.definitionErrors.push.apply(r.definitionErrors,n)}),r.TRACE_INIT("Grammar Validations",function(){var e;(0,o.isEmpty)(n)&&!1===r.skipValidations&&(e=(0,u.validateGrammar)({rules:(0,o.values)(r.gastProductionsCache),maxLookahead:r.maxLookahead,tokenTypes:(0,o.values)(r.tokensMap),ignoredIssues:r.ignoredIssues,errMsgProvider:l.defaultGrammarValidatorErrorProvider,grammarName:t}),r.definitionErrors.push.apply(r.definitionErrors,e))}),(0,o.isEmpty)(r.definitionErrors)&&(r.recoveryEnabled&&r.TRACE_INIT("computeAllProdsFollows",function(){var e=(0,s.computeAllProdsFollows)((0,o.values)(r.gastProductionsCache));r.resyncFollows=e}),r.TRACE_INIT("ComputeLookaheadFunctions",function(){r.preComputeLookaheadFunctions((0,o.values)(r.gastProductionsCache))})),r.TRACE_INIT("expandAllNestedRuleNames",function(){var e=(0,a.expandAllNestedRuleNames)((0,o.values)(r.gastProductionsCache),r.fullRuleNameToShort);r.allRuleNames=e.allRuleNames}),!T.DEFER_DEFINITION_ERRORS_HANDLING&&!(0,o.isEmpty)(r.definitionErrors))throw e=(0,o.map)(r.definitionErrors,function(e){return e.message}),new Error("Parser Definition Errors detected:\n "+e.join("\n-------------------------------\n"))})},T.DEFER_DEFINITION_ERRORS_HANDLING=!1;var S=T;function T(e,t){void 0===t&&(t=C),this.ignoredIssues=C.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;this.initErrorHandler(t),this.initLexerAdapter(),this.initLooksAhead(t),this.initRecognizerEngine(e,t),this.initRecoverable(t),this.initTreeBuilder(t),this.initContentAssist(),this.initGastRecorder(t),this.initPerformanceTracer(t),(0,o.has)(t,"ignoredIssues")&&t.ignoredIssues!==C.ignoredIssues&&(0,o.PRINT_WARNING)("The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.\n\tPlease use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead."),this.ignoredIssues=((0,o.has)(t,"ignoredIssues")?t:C).ignoredIssues,this.skipValidations=((0,o.has)(t,"skipValidations")?t:C).skipValidations}(0,o.applyMixins)(S,[c.Recoverable,d.LooksAhead,h.TreeBuilder,f.LexerAdapter,g.RecognizerEngine,p.RecognizerApi,m.ErrorHandler,y.ContentAssist,v.GastRecorder,n.PerformanceTracer]);b(_,R=S);var R,A=_;function _(e,t){t=(0,o.cloneObj)(t=void 0===t?C:t);return t.outputCst=!0,R.call(this,e,t)||this}b(O,N=S);var N,x=O;function O(e,t){t=(0,o.cloneObj)(t=void 0===t?C:t);return t.outputCst=!1,N.call(this,e,t)||this}},(P,e,t)=>{"use strict";function n(e){return e&&0===e.length}function l(e){return null==e?[]:Object.keys(e)}function u(e){for(var t=[],n=Object.keys(e),r=0;r<n.length;r++)t.push(e[n[r]]);return t}function r(e,t){for(var n=[],r=l(e),i=0;i<r.length;i++){var o=r[i];n.push(t.call(null,e[o],o))}return n}function i(e,t){for(var n=[],r=0;r<e.length;r++)n.push(t.call(null,e[r],r));return n}function o(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?t=t.concat(o(r)):t.push(r)}return t}function s(e){return n(e)?void 0:e[0]}function a(e){var t=e&&e.length;return t?e[t-1]:void 0}function c(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t.call(null,e[n],n);else{if(!I(e))throw Error("non exhaustive match");for(var r=l(e),n=0;n<r.length;n++){var i=r[n],o=e[i];t.call(null,o,i)}}}function d(e){return"string"==typeof e}function h(e){return void 0===e}function f(e){return e instanceof Function}function p(e,t){return e.slice(t=void 0===t?1:t,e.length)}function g(e,t){return e.slice(0,e.length-(t=void 0===t?1:t))}function m(e,t){var n=[];if(Array.isArray(e))for(var r=0;r<e.length;r++){var i=e[r];t.call(null,i)&&n.push(i)}return n}function y(e,t){return m(e,function(e){return!t(e)})}function v(e,t){for(var n=Object.keys(e),r={},i=0;i<n.length;i++){var o=n[i],s=e[o];t(s)&&(r[o]=s)}return r}function b(e,t){return!!I(e)&&e.hasOwnProperty(t)}function E(e,t){return void 0!==S(e,function(e){return e===t})}function C(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}function w(e){var t,n={};for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n}function S(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(t.call(null,r))return r}}function T(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r];t.call(null,i)&&n.push(i)}return n}function R(e,t,n){for(var r=Array.isArray(e),i=r?e:u(e),o=r?[]:l(e),s=n,a=0;a<i.length;a++)s=t.call(null,s,i[a],r?a:o[a]);return s}function A(e){return y(e,function(e){return null==e})}function _(e,r){void 0===r&&(r=function(e){return e});var i=[];return R(e,function(e,t){var n=r(t);return E(i,n)?e:(i.push(n),e.concat(t))},[])}function N(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=[null].concat(t);return Function.bind.apply(e,r)}function x(e){return Array.isArray(e)}function O(e){return e instanceof RegExp}function I(e){return e instanceof Object}function M(e,t){for(var n=0;n<e.length;n++)if(!t(e[n],n))return!1;return!0}function k(e,t){return y(e,function(e){return E(t,e)})}function D(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return!0;return!1}function F(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}function B(e,n){e=C(e);return e.sort(function(e,t){return n(e)-n(t)}),e}function H(e,t){if(e.length!==t.length)throw Error("can't zipObject with different number of keys and values!");for(var n={},r=0;r<e.length;r++)n[e[r]]=t[r];return n}function U(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++)for(var i=t[r],o=l(i),s=0;s<o.length;s++){var a=o[s];e[a]=i[a]}return e}function L(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++){var i=t[r];if(!h(i))for(var o=l(i),s=0;s<o.length;s++){var a=o[s];b(e,a)||(e[a]=i[a])}}return e}function V(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return L.apply(null,[{}].concat(e))}function W(e,r){var i={};return c(e,function(e){var t=r(e),n=i[t];n?n.push(e):i[t]=[e]}),i}function $(e,t){for(var n=w(e),r=l(t),i=0;i<r.length;i++){var o=r[i],s=t[o];n[o]=s}return n}function j(){}function z(e){return e}function G(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];t.push(void 0!==r?r:void 0)}return t}function Y(e){console&&console.error&&console.error("Error: "+e)}function X(e){console&&console.warn&&console.warn("Warning: "+e)}function K(){return"function"==typeof Map}function q(i,e){e.forEach(function(n){var r=n.prototype;Object.getOwnPropertyNames(r).forEach(function(e){var t;"constructor"!==e&&((t=Object.getOwnPropertyDescriptor(r,e))&&(t.get||t.set)?Object.defineProperty(i.prototype,e,t):i.prototype[e]=n.prototype[e])})})}function Z(e){function t(){}t.prototype=e;var n=new t;function r(){n.bar}return r(),r(),e}function Q(e){return e[e.length-1]}function J(e){var t=(new Date).getTime(),e=e();return{time:(new Date).getTime()-t,value:e}}t.r(e),t.d(e,{IDENTITY:()=>z,NOOP:()=>j,PRINT_ERROR:()=>Y,PRINT_WARNING:()=>X,applyMixins:()=>q,assign:()=>U,assignNoOverwrite:()=>L,cloneArr:()=>C,cloneObj:()=>w,compact:()=>A,contains:()=>E,defaults:()=>V,difference:()=>k,drop:()=>p,dropRight:()=>g,every:()=>M,filter:()=>m,find:()=>S,findAll:()=>T,first:()=>s,flatten:()=>o,forEach:()=>c,groupBy:()=>W,has:()=>b,indexOf:()=>F,isArray:()=>x,isES2015MapSupported:()=>K,isEmpty:()=>n,isFunction:()=>f,isObject:()=>I,isRegExp:()=>O,isString:()=>d,isUndefined:()=>h,keys:()=>l,last:()=>a,map:()=>i,mapValues:()=>r,merge:()=>$,packArray:()=>G,partial:()=>N,peek:()=>Q,pick:()=>v,reduce:()=>R,reject:()=>y,some:()=>D,sortBy:()=>B,timer:()=>J,toFastProperties:()=>Z,uniq:()=>_,values:()=>u,zipObject:()=>H})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ResyncFollowsWalker:()=>u,buildBetweenProdsFollowPrefix:()=>d,buildInProdFollowPrefix:()=>function(e){return e.terminalType.name+e.idx+a.IN},computeAllProdsFollows:()=>function(e){var t={};return(0,s.forEach)(e,function(e){e=new u(e).startWalking();(0,s.assign)(t,e)}),t}});var r,i,t=n(19),o=n(29),s=n(17),a=n(32),l=n(20),n=(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=(i=t.RestWalker,n(c,i),c.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},c.prototype.walkTerminal=function(e,t,n){},c.prototype.walkProdRef=function(e,t,n){e=d(e.referencedRule,e.idx)+this.topProd.name,t=t.concat(n),n=new l.Flat({definition:t}),t=(0,o.first)(n);this.follows[e]=t},c);function c(e){var t=i.call(this)||this;return t.topProd=e,t.follows={},t}function d(e,t){return e.name+t+a.IN}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{RestWalker:()=>r});var o=n(17),s=n(20),r=(i.prototype.walk=function(n,r){var i=this;void 0===r&&(r=[]),(0,o.forEach)(n.definition,function(e,t){t=(0,o.drop)(n.definition,t+1);if(e instanceof s.NonTerminal)i.walkProdRef(e,t,r);else if(e instanceof s.Terminal)i.walkTerminal(e,t,r);else if(e instanceof s.Flat)i.walkFlat(e,t,r);else if(e instanceof s.Option)i.walkOption(e,t,r);else if(e instanceof s.RepetitionMandatory)i.walkAtLeastOne(e,t,r);else if(e instanceof s.RepetitionMandatoryWithSeparator)i.walkAtLeastOneSep(e,t,r);else if(e instanceof s.RepetitionWithSeparator)i.walkManySep(e,t,r);else if(e instanceof s.Repetition)i.walkMany(e,t,r);else{if(!(e instanceof s.Alternation))throw Error("non exhaustive match");i.walkOr(e,t,r)}})},i.prototype.walkTerminal=function(e,t,n){},i.prototype.walkProdRef=function(e,t,n){},i.prototype.walkFlat=function(e,t,n){t=t.concat(n);this.walk(e,t)},i.prototype.walkOption=function(e,t,n){t=t.concat(n);this.walk(e,t)},i.prototype.walkAtLeastOne=function(e,t,n){t=[new s.Option({definition:e.definition})].concat(t,n);this.walk(e,t)},i.prototype.walkAtLeastOneSep=function(e,t,n){t=a(e,t,n);this.walk(e,t)},i.prototype.walkMany=function(e,t,n){t=[new s.Option({definition:e.definition})].concat(t,n);this.walk(e,t)},i.prototype.walkManySep=function(e,t,n){t=a(e,t,n);this.walk(e,t)},i.prototype.walkOr=function(e,t,n){var r=this,i=t.concat(n);(0,o.forEach)(e.definition,function(e){e=new s.Flat({definition:[e]});r.walk(e,i)})},i);function i(){}function a(e,t,n){return[new s.Option({definition:[new s.Terminal({terminalType:e.separator})].concat(e.definition)})].concat(t,n)}},(P,e,t)=>{"use strict";t.r(e),t.d(e,{AbstractProduction:()=>n,Alternation:()=>I,Flat:()=>f,NonTerminal:()=>a,Option:()=>m,Repetition:()=>R,RepetitionMandatory:()=>b,RepetitionMandatoryWithSeparator:()=>w,RepetitionWithSeparator:()=>N,Rule:()=>c,Terminal:()=>k,serializeGrammar:()=>function(e){return(0,i.map)(e,L)},serializeProduction:()=>L});var r,i=t(17),F=t(21),e=(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),n=(o.prototype.accept=function(t){t.visit(this),(0,i.forEach)(this.definition,function(e){e.accept(t)})},o);function o(e){this.definition=e}e(l,s=n),Object.defineProperty(l.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(e){},enumerable:!0,configurable:!0}),l.prototype.accept=function(e){e.visit(this)};var s,a=l;function l(e){var t=s.call(this,[])||this;return t.idx=1,(0,i.assign)(t,(0,i.pick)(e,function(e){return void 0!==e})),t}e(d,u=n);var u,c=d;function d(e){var t=u.call(this,e.definition)||this;return(t.orgText="",i.assign)(t,(0,i.pick)(e,function(e){return void 0!==e})),t}e(p,h=n);var h,f=p;function p(e){var t=h.call(this,e.definition)||this;return(t.ignoreAmbiguities=!1,i.assign)(t,(0,i.pick)(e,function(e){return void 0!==e})),t}e(y,g=n);var g,m=y;function y(e){var t=g.call(this,e.definition)||this;return t.idx=1,(0,i.assign)(t,(0,i.pick)(e,function(e){return void 0!==e})),t}e(E,v=n);var v,b=E;function E(e){var t=v.call(this,e.definition)||this;return t.idx=1,(0,i.assign)(t,(0,i.pick)(e,function(e){return void 0!==e})),t}e(S,C=n);var C,w=S;function S(e){var t=C.call(this,e.definition)||this;return t.idx=1,(0,i.assign)(t,(0,i.pick)(e,function(e){return void 0!==e})),t}e(A,T=n);var T,R=A;function A(e){var t=T.call(this,e.definition)||this;return t.idx=1,(0,i.assign)(t,(0,i.pick)(e,function(e){return void 0!==e})),t}e(x,_=n);var _,N=x;function x(e){var t=_.call(this,e.definition)||this;return t.idx=1,(0,i.assign)(t,(0,i.pick)(e,function(e){return void 0!==e})),t}e(M,O=n);var O,I=M;function M(e){var t=O.call(this,e.definition)||this;return t.idx=1,t.ignoreAmbiguities=!1,(t.hasPredicates=!1,i.assign)(t,(0,i.pick)(e,function(e){return void 0!==e})),t}D.prototype.accept=function(e){e.visit(this)};var k=D;function D(e){this.idx=1,(0,i.assign)(this,(0,i.pick)(e,function(e){return void 0!==e}))}function L(e){function t(e){return(0,i.map)(e,L)}if(e instanceof a)return{type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};if(e instanceof f)return{type:"Flat",definition:t(e.definition)};if(e instanceof m)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof b)return{type:"RepetitionMandatory",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof w)return{type:"RepetitionMandatoryWithSeparator",name:e.name,idx:e.idx,separator:L(new k({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof N)return{type:"RepetitionWithSeparator",name:e.name,idx:e.idx,separator:L(new k({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof R)return{type:"Repetition",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof I)return{type:"Alternation",name:e.name,idx:e.idx,definition:t(e.definition)};var n,r;if(e instanceof k)return n={type:"Terminal",name:e.terminalType.name,label:(0,F.tokenLabel)(e.terminalType),idx:e.idx},r=e.terminalType.PATTERN,e.terminalType.PATTERN&&(n.pattern=(0,i.isRegExp)(r)?r.source:r),n;if(e instanceof c)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{EOF:()=>m,createToken:()=>g,createTokenInstance:()=>function(e,t,n,r,i,o,s,a){return{image:t,startOffset:n,endOffset:r,startLine:i,endLine:o,startColumn:s,endColumn:a,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}},hasTokenLabel:()=>o,tokenLabel:()=>function(e){return o(e)?e.LABEL:e.name},tokenMatcher:()=>function(e,t){return(0,i.tokenStructuredMatcher)(e,t)},tokenName:()=>function(e){return e.name}});var r=n(17),t=n(22),i=n(27);function o(e){return(0,r.isString)(e.LABEL)&&""!==e.LABEL}var s="parent",a="categories",l="label",u="group",c="push_mode",d="pop_mode",h="longer_alt",f="line_breaks",p="start_chars_hint";function g(e){var t=e.pattern,n={};if(n.name=e.name,(0,r.isUndefined)(t)||(n.PATTERN=t),(0,r.has)(e,s))throw"The parent property is no longer supported.\nSee: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.";return(0,r.has)(e,a)&&(n.CATEGORIES=e[a]),(0,i.augmentTokenTypes)([n]),(0,r.has)(e,l)&&(n.LABEL=e[l]),(0,r.has)(e,u)&&(n.GROUP=e[u]),(0,r.has)(e,d)&&(n.POP_MODE=e[d]),(0,r.has)(e,c)&&(n.PUSH_MODE=e[c]),(0,r.has)(e,h)&&(n.LONGER_ALT=e[h]),(0,r.has)(e,f)&&(n.LINE_BREAKS=e[f]),(0,r.has)(e,p)&&(n.START_CHARS_HINT=e[p]),n}var m=g({name:"EOF",pattern:t.Lexer.NA});(0,i.augmentTokenTypes)([m])},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Lexer:()=>i,LexerDefinitionErrorType:()=>r});var r,Z=n(23),Q=n(17),a=n(27),t=n(28),l=n(26),u=((n=r=r||{})[n.MISSING_PATTERN=0]="MISSING_PATTERN",n[n.INVALID_PATTERN=1]="INVALID_PATTERN",n[n.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",n[n.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",n[n.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",n[n.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",n[n.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",n[n.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",n[n.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",n[n.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",n[n.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",n[n.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",n[n.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",n[n.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",n[n.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",n[n.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",{deferDefinitionErrorsHandling:!(n[n.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"),positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:t.defaultLexerErrorProvider,traceInitPerf:!1,skipValidations:!1}),i=(Object.freeze(u),o.prototype.tokenize=function(e,t){if(void 0===t&&(t=this.defaultMode),(0,Q.isEmpty)(this.lexerDefinitionErrors))return this.tokenizeInternal(e,t);throw e=(0,Q.map)(this.lexerDefinitionErrors,function(e){return e.message}).join("-----------------------\n"),new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+e)},o.prototype.tokenizeInternal=function(e,P){var t,n,r,i,F,o,s=this,a=e,B=a.length,l=0,u=0,H=this.hasCustom?0:Math.floor(e.length/10),c=new Array(H),d=[],h=this.trackStartLines?1:void 0,f=this.trackStartLines?1:void 0,p=(0,Z.cloneEmptyGroups)(this.emptyGroups),U=this.trackStartLines,g=this.config.lineTerminatorsPattern,m=0,y=[],v=[],b=[],V=[],E=(Object.freeze(V),void 0);function W(){return y}function $(e){e=(0,Z.charCodeToOptimizedIndex)(e),e=v[e];return void 0===e?V:e}function j(e){var t;1===b.length&&void 0===e.tokenType.PUSH_MODE?(t=s.config.errorMessageProvider.buildUnableToPopLexerModeMessage(e),d.push({offset:e.startOffset,line:void 0!==e.startLine?e.startLine:void 0,column:void 0!==e.startColumn?e.startColumn:void 0,length:e.image.length,message:t})):(b.pop(),e=(0,Q.last)(b),y=s.patternIdxToConfig[e],v=s.charCodeToPatternIdxToConfig[e],m=y.length,t=s.canModeBeOptimized[e]&&!1===s.config.safeMode,E=v&&t?$:W)}function z(e){b.push(e),v=this.charCodeToPatternIdxToConfig[e],y=this.patternIdxToConfig[e],m=y.length,m=y.length;e=this.canModeBeOptimized[e]&&!1===this.config.safeMode;E=v&&e?$:W}for(z.call(this,P);l<B;){for(var C=null,G=a.charCodeAt(l),Y=E(G),X=Y.length,w=0;w<X;w++){var S,T,R,A,_=(S=Y[w]).pattern,N=null;if(!1!==(D=S.short)?G===D&&(C=_):!0===S.isCustom?null!==(o=_.exec(a,l,c,p))?(C=o[0],void 0!==o.payload&&(N=o.payload)):C=null:(this.updateLastIndex(_,l),C=this.match(_,e,l)),null!==C){void 0!==(A=S.longerAlt)&&(T=(A=y[A]).pattern,!(R=null)===A.isCustom?null!==(o=T.exec(a,l,c,p))?(n=o[0],void 0!==o.payload&&(R=o.payload)):n=null:(this.updateLastIndex(T,l),n=this.match(T,e,l)),n)&&n.length>C.length&&(C=n,N=R,S=A);break}}if(null!==C){if(M=C.length,void 0!==(I=S.group)&&(r=S.tokenTypeIdx,r=this.createTokenInstance(C,l,r,S.tokenType,h,f,M),this.handlePayload(r,N),!1===I?u=this.addToken(c,u,r):p[I].push(r)),e=this.chopInput(e,M),l+=M,f=this.computeNewColumn(f,M),!0===U&&!0===S.canLineTerminator){var K,x=0,O=void 0;for(g.lastIndex=0;!0===(K=g.test(C))&&(O=g.lastIndex-1,x++),!0===K;);0!==x&&(h+=x,this.updateTokenEndLineColumnLocation(r,I,O,x,h,f=M-O,M))}this.handleModes(S,j,z,r)}else{for(var I=l,M=h,q=f,k=!1;!k&&l<B;)for(a.charCodeAt(l),e=this.chopInput(e,1),l++,t=0;t<m;t++){var D,L=y[t],_=L.pattern;if(!1!==(D=L.short)?a.charCodeAt(l)===D&&(k=!0):k=!0===L.isCustom?null!==_.exec(a,l,c,p):(this.updateLastIndex(_,l),null!==_.exec(e)),!0===k)break}F=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(a,I,i=l-I,M,q),d.push({offset:I,line:M,column:q,length:i,message:F})}}return this.hasCustom||(c.length=u),{tokens:c,groups:p,errors:d}},o.prototype.handleModes=function(e,t,n,r){var i;!0===e.pop?(i=e.push,t(r),void 0!==i&&n.call(this,i)):void 0!==e.push&&n.call(this,e.push)},o.prototype.chopInput=function(e,t){return e.substring(t)},o.prototype.updateLastIndex=function(e,t){e.lastIndex=t},o.prototype.updateTokenEndLineColumnLocation=function(e,t,n,r,i,o,s){void 0!==t&&(n=(t=n===s-1)?-1:0,1===r&&!0==t||(e.endLine=i+n,e.endColumn=o-1-n))},o.prototype.computeNewColumn=function(e,t){return e+t},o.prototype.createTokenInstance=function(){for(var e=0;e<arguments.length;e++)e,0;return null},o.prototype.createOffsetOnlyToken=function(e,t,n,r){return{image:e,startOffset:t,tokenTypeIdx:n,tokenType:r}},o.prototype.createStartOnlyToken=function(e,t,n,r,i,o){return{image:e,startOffset:t,startLine:i,startColumn:o,tokenTypeIdx:n,tokenType:r}},o.prototype.createFullToken=function(e,t,n,r,i,o,s){return{image:e,startOffset:t,endOffset:t+s-1,startLine:i,endLine:i,startColumn:o,endColumn:o+s-1,tokenTypeIdx:n,tokenType:r}},o.prototype.addToken=function(e,t,n){return 666},o.prototype.addTokenUsingPush=function(e,t,n){return e.push(n),t},o.prototype.addTokenUsingMemberAccess=function(e,t,n){return e[t]=n,++t},o.prototype.handlePayload=function(e,t){},o.prototype.handlePayloadNoCustom=function(e,t){},o.prototype.handlePayloadWithCustom=function(e,t){null!==t&&(e.payload=t)},o.prototype.match=function(e,t,n){return null},o.prototype.matchWithTest=function(e,t,n){return!0===e.test(t)?t.substring(n,e.lastIndex):null},o.prototype.matchWithExec=function(e,t){e=e.exec(t);return null!==e?e[0]:e},o.prototype.TRACE_INIT=function(e,t){var n,r,i,o;return!0===this.traceInitPerf?(this.traceInitIndent++,n=new Array(this.traceInitIndent+1).join("\t"),this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--\x3e <"+e+">"),r=(i=(0,Q.timer)(t)).time,i=i.value,o=10<r?console.warn:console.log,this.traceInitIndent<this.traceInitMaxIdent&&o(n+"<-- <"+e+"> time: "+r+"ms"),this.traceInitIndent--,i):t()},o.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",o.NA=/NOT_APPLICABLE/,o);function o(i,o){var s=this;if(void 0===o&&(o=u),this.lexerDefinition=i,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},"boolean"==typeof o)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=(0,Q.merge)(u,o);var e=this.config.traceInitPerf;!0===e?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"==typeof e&&(this.traceInitMaxIdent=e,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var n,e,t=!0,r=(s.TRACE_INIT("Lexer Config handling",function(){if(s.config.lineTerminatorsPattern===u.lineTerminatorsPattern)s.config.lineTerminatorsPattern=Z.LineTerminatorOptimizedTester;else if(s.config.lineTerminatorCharacters===u.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(o.safeMode&&o.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');s.trackStartLines=/full|onlyStart/i.test(s.config.positionTracking),s.trackEndLines=/full/i.test(s.config.positionTracking),(0,Q.isArray)(i)?((n={modes:{}}).modes[Z.DEFAULT_MODE]=(0,Q.cloneArr)(i),n[Z.DEFAULT_MODE]=Z.DEFAULT_MODE):n=(t=!1,Q.cloneObj)(i)}),!1===s.config.skipValidations&&(s.TRACE_INIT("performRuntimeChecks",function(){s.lexerDefinitionErrors=s.lexerDefinitionErrors.concat((0,Z.performRuntimeChecks)(n,s.trackStartLines,s.config.lineTerminatorCharacters))}),s.TRACE_INIT("performWarningRuntimeChecks",function(){s.lexerDefinitionWarning=s.lexerDefinitionWarning.concat((0,Z.performWarningRuntimeChecks)(n,s.trackStartLines,s.config.lineTerminatorCharacters))})),n.modes=n.modes||{},(0,Q.forEach)(n.modes,function(e,t){n.modes[t]=(0,Q.reject)(e,function(e){return(0,Q.isUndefined)(e)})}),(0,Q.keys)(n.modes));if((0,Q.forEach)(n.modes,function(t,n){s.TRACE_INIT("Mode: <"+n+"> processing",function(){var e;s.modes.push(n),!1===s.config.skipValidations&&s.TRACE_INIT("validatePatterns",function(){s.lexerDefinitionErrors=s.lexerDefinitionErrors.concat((0,Z.validatePatterns)(t,r))}),(0,Q.isEmpty)(s.lexerDefinitionErrors)&&((0,a.augmentTokenTypes)(t),s.TRACE_INIT("analyzeTokenTypes",function(){e=(0,Z.analyzeTokenTypes)(t,{lineTerminatorCharacters:s.config.lineTerminatorCharacters,positionTracking:o.positionTracking,ensureOptimizations:o.ensureOptimizations,safeMode:o.safeMode,tracer:s.TRACE_INIT.bind(s)})}),s.patternIdxToConfig[n]=e.patternIdxToConfig,s.charCodeToPatternIdxToConfig[n]=e.charCodeToPatternIdxToConfig,s.emptyGroups=(0,Q.merge)(s.emptyGroups,e.emptyGroups),s.hasCustom=e.hasCustom||s.hasCustom,s.canModeBeOptimized[n]=e.canBeOptimized)})}),s.defaultMode=n.defaultMode,!(0,Q.isEmpty)(s.lexerDefinitionErrors)&&!s.config.deferDefinitionErrorsHandling)throw e=(0,Q.map)(s.lexerDefinitionErrors,function(e){return e.message}).join("-----------------------\n"),new Error("Errors detected in definition of Lexer:\n"+e);(0,Q.forEach)(s.lexerDefinitionWarning,function(e){(0,Q.PRINT_WARNING)(e.message)}),s.TRACE_INIT("Choosing sub-methods implementations",function(){if(Z.SUPPORT_STICKY?(s.chopInput=Q.IDENTITY,s.match=s.matchWithTest):(s.updateLastIndex=Q.NOOP,s.match=s.matchWithExec),t&&(s.handleModes=Q.NOOP),!1===s.trackStartLines&&(s.computeNewColumn=Q.IDENTITY),!1===s.trackEndLines&&(s.updateTokenEndLineColumnLocation=Q.NOOP),/full/i.test(s.config.positionTracking))s.createTokenInstance=s.createFullToken;else if(/onlyStart/i.test(s.config.positionTracking))s.createTokenInstance=s.createStartOnlyToken;else{if(!/onlyOffset/i.test(s.config.positionTracking))throw Error('Invalid <positionTracking> config option: "'+s.config.positionTracking+'"');s.createTokenInstance=s.createOffsetOnlyToken}s.hasCustom?(s.addToken=s.addTokenUsingPush,s.handlePayload=s.handlePayloadWithCustom):(s.addToken=s.addTokenUsingMemberAccess,s.handlePayload=s.handlePayloadNoCustom)}),s.TRACE_INIT("Failed Optimization Warnings",function(){var e=(0,Q.reduce)(s.canModeBeOptimized,function(e,t,n){return!1===t&&e.push(n),e},[]);if(o.ensureOptimizations&&!(0,Q.isEmpty)(e))throw Error("Lexer Modes: < "+e.join(", ")+' > cannot be optimized.\n\t Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n\t Or inspect the console log for details on how to resolve these issues.')}),s.TRACE_INIT("clearRegExpParserCache",function(){(0,l.clearRegExpParserCache)()}),s.TRACE_INIT("toFastProperties",function(){(0,Q.toFastProperties)(s)})})}},(P,e,t)=>{"use strict";t.r(e),t.d(e,{DEFAULT_MODE:()=>a,LineTerminatorOptimizedTester:()=>F,MODES:()=>l,SUPPORT_STICKY:()=>w,addStartOfInput:()=>A,addStickyFlag:()=>_,analyzeTokenTypes:()=>function(e,o){var n,r,i,s,a,l,u,c,d,h,t,f,p=(o=(0,b.defaults)(o,{useSticky:w,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:function(e,t){return t()}})).tracer,g=(p("initCharCodeToOptimizedIndexMap",function(){if((0,b.isEmpty)(L)){L=new Array(65536);for(var e=0;e<65536;e++)L[e]=255<e?255+~~(e/255):e}}),p("Reject Lexer.NA",function(){n=(0,b.reject)(e,function(e){return e[C]===v.Lexer.NA})}),!1),m=(p("Transform Patterns",function(){r=(g=!1,b.map)(n,function(e){var t,e=e[C];if((0,b.isRegExp)(e))return 1===(t=e.source).length&&"^"!==t&&"$"!==t&&"."!==t?t:2!==t.length||"\\"!==t[0]||(0,b.contains)(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],t[1])?(o.useSticky?_:A)(e):t[1];if((0,b.isFunction)(e))return g=!0,{exec:e};if((0,b.has)(e,"exec"))return g=!0,e;if("string"==typeof e)return 1===e.length?e:(t=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),e=new RegExp(t),(o.useSticky?_:A)(e));throw Error("non exhaustive match")})}),p("misc mapping",function(){i=(0,b.map)(n,function(e){return e.tokenTypeIdx}),s=(0,b.map)(n,function(e){e=e.GROUP;if(e!==v.Lexer.SKIPPED){if((0,b.isString)(e))return e;if((0,b.isUndefined)(e))return!1;throw Error("non exhaustive match")}}),a=(0,b.map)(n,function(e){e=e.LONGER_ALT;if(e)return(0,b.indexOf)(n,e)}),l=(0,b.map)(n,function(e){return e.PUSH_MODE}),u=(0,b.map)(n,function(e){return(0,b.has)(e,"POP_MODE")})}),p("Line Terminator Handling",function(){var t=M(o.lineTerminatorCharacters);c=(0,b.map)(n,function(e){return!1}),"onlyOffset"!==o.positionTracking&&(c=(0,b.map)(n,function(e){return(0,b.has)(e,"LINE_BREAKS")?e.LINE_BREAKS:!1===O(e,t)?(0,E.canMatchCharCode)(t,e.PATTERN):void 0}))}),p("Misc Mapping #2",function(){d=(0,b.map)(n,N),h=(0,b.map)(r,x),t=(0,b.reduce)(n,function(e,t){t=t.GROUP;return(0,b.isString)(t)&&t!==v.Lexer.SKIPPED&&(e[t]=[]),e},{}),f=(0,b.map)(r,function(e,t){return{pattern:r[t],longerAlt:a[t],canLineTerminator:c[t],isCustom:d[t],short:h[t],group:s[t],push:l[t],pop:u[t],tokenTypeIdx:i[t],tokenType:n[t]}})}),!0),y=[];o.safeMode||p("First Char Optimization",function(){y=(0,b.reduce)(n,function(t,e,n){var r,i;return"string"==typeof e.PATTERN?(i=D(e.PATTERN.charCodeAt(0)),k(t,i,f[n])):(0,b.isArray)(e.START_CHARS_HINT)?(0,b.forEach)(e.START_CHARS_HINT,function(e){e=D("string"==typeof e?e.charCodeAt(0):e);r!==e&&k(t,r=e,f[n])}):(0,b.isRegExp)(e.PATTERN)?e.PATTERN.unicode?(m=!1,o.ensureOptimizations&&(0,b.PRINT_ERROR)(E.failedOptimizationPrefixMsg+"\tUnable to analyze < "+e.PATTERN.toString()+" > pattern.\n\tThe regexp unicode flag is not currently supported by the regexp-to-ast library.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE")):(i=(0,E.getOptimizedStartCodesIndices)(e.PATTERN,o.ensureOptimizations),(0,b.isEmpty)(i)&&(m=!1),(0,b.forEach)(i,function(e){k(t,e,f[n])})):(o.ensureOptimizations&&(0,b.PRINT_ERROR)(E.failedOptimizationPrefixMsg+"\tTokenType: <"+e.name+"> is using a custom token pattern without providing <start_chars_hint> parameter.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE"),m=!1),t},[])});return p("ArrayPacking",function(){y=(0,b.packArray)(y)}),{emptyGroups:t,patternIdxToConfig:f,charCodeToPatternIdxToConfig:y,hasCustom:g,canBeOptimized:m}},buildLineBreakIssueMessage:()=>I,charCodeToOptimizedIndex:()=>D,cloneEmptyGroups:()=>function(n){var r={},e=(0,b.keys)(n);return(0,b.forEach)(e,function(e){var t=n[e];if(!(0,b.isArray)(t))throw Error("non exhaustive match");r[e]=[]}),r},disableSticky:()=>function(){w=!1},enableSticky:()=>function(){w=!0},findDuplicatePatterns:()=>y,findEmptyMatchRegExps:()=>f,findEndOfInputAnchor:()=>h,findInvalidGroupType:()=>S,findInvalidPatterns:()=>c,findMissingPatterns:()=>u,findModesThatDoNotExist:()=>T,findStartOfInputAnchor:()=>g,findUnreachablePatterns:()=>R,findUnsupportedFlags:()=>m,isCustomPattern:()=>N,isShortPattern:()=>x,minOptimizationVal:()=>n,performRuntimeChecks:()=>function(e,t,n){var r=[];(0,b.has)(e,a)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+a+"> property in its definition\n",type:v.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE});(0,b.has)(e,l)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+l+"> property in its definition\n",type:v.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY});(0,b.has)(e,l)&&(0,b.has)(e,a)&&!(0,b.has)(e.modes,e.defaultMode)&&r.push({message:"A MultiMode Lexer cannot be initialized with a "+a+": <"+e.defaultMode+">which does not exist\n",type:v.LexerDefinitionErrorType.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST});(0,b.has)(e,l)&&(0,b.forEach)(e.modes,function(e,n){(0,b.forEach)(e,function(e,t){(0,b.isUndefined)(e)&&r.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:<"+n+"> at index: <"+t+">\n",type:v.LexerDefinitionErrorType.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})});return r},performWarningRuntimeChecks:()=>function(e,t,n){var r=[],i=!1,e=(0,b.compact)((0,b.flatten)((0,b.mapValues)(e.modes,function(e){return e}))),e=(0,b.reject)(e,function(e){return e[C]===v.Lexer.NA}),o=M(n);t&&(0,b.forEach)(e,function(e){var t=O(e,o);!1!==t?(t={message:I(e,t),type:t.issue,tokenType:e},r.push(t)):(0,b.has)(e,"LINE_BREAKS")?!0===e.LINE_BREAKS&&(i=!0):(0,E.canMatchCharCode)(o,e.PATTERN)&&(i=!0)});t&&!i&&r.push({message:"Warning: No LINE_BREAKS Found.\n\tThis Lexer has been defined to track line and column information,\n\tBut none of the Token Types can be identified as matching a line terminator.\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n\tfor details.",type:v.LexerDefinitionErrorType.NO_LINE_BREAKS_FLAGS});return r},validatePatterns:()=>function(e,t){var n=[],e=u(e),e=(n=n.concat(e.errors),c(e.valid)),r=e.valid;return n=(n=(n=(n=(n=n.concat(e.errors)).concat(function(e){var t=[],e=(0,b.filter)(e,function(e){return(0,b.isRegExp)(e[C])});return t=(t=(t=(t=(t=t.concat(h(e))).concat(g(e))).concat(m(e))).concat(y(e))).concat(f(e))}(r))).concat(S(r))).concat(T(r,t))).concat(R(r))}});var r,i=t(24),v=t(22),b=t(17),E=t(25),o=t(26),s=(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),C="PATTERN",a="defaultMode",l="modes",w="boolean"==typeof new RegExp("(?:)").sticky;function u(e){var t=(0,b.filter)(e,function(e){return!(0,b.has)(e,C)});return{errors:(0,b.map)(t,function(e){return{message:"Token Type: ->"+e.name+"<- missing static 'PATTERN' property",type:v.LexerDefinitionErrorType.MISSING_PATTERN,tokenTypes:[e]}}),valid:(0,b.difference)(e,t)}}function c(e){var t=(0,b.filter)(e,function(e){e=e[C];return!((0,b.isRegExp)(e)||(0,b.isFunction)(e)||(0,b.has)(e,"exec")||(0,b.isString)(e))});return{errors:(0,b.map)(t,function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:v.LexerDefinitionErrorType.INVALID_PATTERN,tokenTypes:[e]}}),valid:(0,b.difference)(e,t)}}var d=/[^\\][\$]/;function h(e){t=i.BaseRegExpVisitor,s(n,t),n.prototype.visitEndAnchor=function(e){this.found=!0};var t,r=n;function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.found=!1,e}e=(0,b.filter)(e,function(t){t=t[C];try{var e=(0,o.getRegExpAst)(t),n=new r;return n.visit(e),n.found}catch(e){return d.test(t.source)}});return(0,b.map)(e,function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n\tSee sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:v.LexerDefinitionErrorType.EOI_ANCHOR_FOUND,tokenTypes:[e]}})}function f(e){e=(0,b.filter)(e,function(e){return e[C].test("")});return(0,b.map)(e,function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' must not match an empty string",type:v.LexerDefinitionErrorType.EMPTY_MATCH_PATTERN,tokenTypes:[e]}})}var p=/[^\\[][\^]|^\^/;function g(e){t=i.BaseRegExpVisitor,s(n,t),n.prototype.visitStartAnchor=function(e){this.found=!0};var t,r=n;function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.found=!1,e}e=(0,b.filter)(e,function(t){t=t[C];try{var e=(0,o.getRegExpAst)(t),n=new r;return n.visit(e),n.found}catch(e){return p.test(t.source)}});return(0,b.map)(e,function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:v.LexerDefinitionErrorType.SOI_ANCHOR_FOUND,tokenTypes:[e]}})}function m(e){e=(0,b.filter)(e,function(e){e=e[C];return e instanceof RegExp&&(e.multiline||e.global)});return(0,b.map)(e,function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:v.LexerDefinitionErrorType.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[e]}})}function y(e){var r=[],t=(0,b.map)(e,function(n){return(0,b.reduce)(e,function(e,t){return n.PATTERN.source!==t.PATTERN.source||(0,b.contains)(r,t)||t.PATTERN===v.Lexer.NA||(r.push(t),e.push(t)),e},[])}),t=(0,b.compact)(t),t=(0,b.filter)(t,function(e){return 1<e.length});return(0,b.map)(t,function(e){var t=(0,b.map)(e,function(e){return e.name});return{message:"The same RegExp pattern ->"+(0,b.first)(e).PATTERN+"<-has been used in all of the following Token Types: "+t.join(", ")+" <-",type:v.LexerDefinitionErrorType.DUPLICATE_PATTERNS_FOUND,tokenTypes:e}})}function S(e){e=(0,b.filter)(e,function(e){return!!(0,b.has)(e,"GROUP")&&(e=e.GROUP)!==v.Lexer.SKIPPED&&e!==v.Lexer.NA&&!(0,b.isString)(e)});return(0,b.map)(e,function(e){return{message:"Token Type: ->"+e.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:v.LexerDefinitionErrorType.INVALID_GROUP_TYPE_FOUND,tokenTypes:[e]}})}function T(e,t){e=(0,b.filter)(e,function(e){return void 0!==e.PUSH_MODE&&!(0,b.contains)(t,e.PUSH_MODE)});return(0,b.map)(e,function(e){return{message:"Token Type: ->"+e.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+e.PUSH_MODE+"<-which does not exist",type:v.LexerDefinitionErrorType.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[e]}})}function R(e){var o=[],t=(0,b.reduce)(e,function(e,t,n){var r,i=t.PATTERN;return i!==v.Lexer.NA&&((0,b.isString)(i)?e.push({str:i,idx:n,tokenType:t}):(0,b.isRegExp)(i)&&(r=i,void 0===(0,b.find)([".","\\","[","]","|","^","$","(",")","?","*","+","{"],function(e){return-1!==r.source.indexOf(e)}))&&e.push({str:i.source,idx:n,tokenType:t})),e},[]);return(0,b.forEach)(e,function(r,i){(0,b.forEach)(t,function(e){var t=e.str,n=e.idx,e=e.tokenType;i<n&&function(e,t){{var n;if((0,b.isRegExp)(t))return null!==(n=t.exec(e))&&0===n.index;if((0,b.isFunction)(t))return t(e,0,[],{});if((0,b.has)(t,"exec"))return t.exec(e,0,[],{});if("string"==typeof t)return t===e;throw Error("non exhaustive match")}}(t,r.PATTERN)&&(n="Token: ->"+e.name+"<- can never be matched.\nBecause it appears AFTER the Token Type ->"+r.name+"<-in the lexer's definition.\nSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE",o.push({message:n,type:v.LexerDefinitionErrorType.UNREACHABLE_PATTERN,tokenTypes:[r,e]}))})}),o}function A(e){var t=e.ignoreCase?"i":"";return new RegExp("^(?:"+e.source+")",t)}function _(e){var t=e.ignoreCase?"iy":"y";return new RegExp(""+e.source,t)}function N(e){e=e.PATTERN;if((0,b.isRegExp)(e))return!1;if((0,b.isFunction)(e))return!0;if((0,b.has)(e,"exec"))return!0;if((0,b.isString)(e))return!1;throw Error("non exhaustive match")}function x(e){return!(!(0,b.isString)(e)||1!==e.length)&&e.charCodeAt(0)}var F={test:function(e){for(var t=e.length,n=this.lastIndex;n<t;n++){var r=e.charCodeAt(n);if(10===r)return this.lastIndex=n+1,!0;if(13===r)return 10===e.charCodeAt(n+1)?this.lastIndex=n+2:this.lastIndex=n+1,!0}return!1},lastIndex:0};function O(e,t){if((0,b.has)(e,"LINE_BREAKS"))return!1;if((0,b.isRegExp)(e.PATTERN)){try{(0,E.canMatchCharCode)(t,e.PATTERN)}catch(e){return{issue:v.LexerDefinitionErrorType.IDENTIFY_TERMINATOR,errMsg:e.message}}return!1}if((0,b.isString)(e.PATTERN))return!1;if(N(e))return{issue:v.LexerDefinitionErrorType.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function I(e,t){if(t.issue===v.LexerDefinitionErrorType.IDENTIFY_TERMINATOR)return"Warning: unable to identify line terminator usage in pattern.\n\tThe problem is in the <"+e.name+"> Token Type\n\t Root cause: "+t.errMsg+".\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(t.issue===v.LexerDefinitionErrorType.CUSTOM_LINE_BREAK)return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n\tThe problem is in the <"+e.name+"> Token Type\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function M(e){return(0,b.map)(e,function(e){return(0,b.isString)(e)&&0<e.length?e.charCodeAt(0):e})}function k(e,t,n){void 0===e[t]?e[t]=[n]:e[t].push(n)}var n=256;function D(e){return e<n?e:L[e]}var L=[]},function(e,t){var n;void 0!==(t="function"==typeof(n=function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(e){this.idx=e.idx;this.input=e.input;this.groupIdx=e.groupIdx},e.prototype.pattern=function(e){this.idx=0;this.input=e;this.groupIdx=0;this.consumeChar("/");var t=this.disjunction();this.consumeChar("/");var n={type:"Flags",global:false,ignoreCase:false,multiLine:false,unicode:false,sticky:false};while(this.isRegExpFlag())switch(this.popChar()){case"g":i(n,"global");break;case"i":i(n,"ignoreCase");break;case"m":i(n,"multiLine");break;case"u":i(n,"unicode");break;case"y":i(n,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:n,value:t}},e.prototype.disjunction=function(){var e=[];e.push(this.alternative());while(this.peekChar()==="|"){this.consumeChar("|");e.push(this.alternative())}return{type:"Disjunction",value:e}},e.prototype.alternative=function(){var e=[];while(this.isTerm())e.push(this.term());return{type:"Alternative",value:e}},e.prototype.term=function(){if(this.isAssertion())return this.assertion();else return this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var e;switch(this.popChar()){case"=":e="Lookahead";break;case"!":e="NegativeLookahead";break}l(e);var t=this.disjunction();this.consumeChar(")");return{type:e,value:t}}u()},e.prototype.quantifier=function(e){var t;switch(this.popChar()){case"*":t={atLeast:0,atMost:Infinity};break;case"+":t={atLeast:1,atMost:Infinity};break;case"?":t={atLeast:0,atMost:1};break;case"{":var n=this.integerIncludingZero();switch(this.popChar()){case"}":t={atLeast:n,atMost:n};break;case",":var r;if(this.isDigit()){r=this.integerIncludingZero();t={atLeast:n,atMost:r}}else t={atLeast:n,atMost:Infinity};this.consumeChar("}");break}if(e===true&&t===undefined)return undefined;l(t);break}if(e===true&&t===undefined)return undefined;l(t);if(this.peekChar(0)==="?"){this.consumeChar("?");t.greedy=false}else t.greedy=true;t.type="Quantifier";return t},e.prototype.atom=function(){var e;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group();break}if(e===undefined&&this.isPatternCharacter())e=this.patternCharacter();l(e);if(this.isQuantifier())e.quantifier=this.quantifier();return e},e.prototype.dotAll=function(){this.consumeChar(".");return{type:"Set",complement:true,value:[s("\n"),s("\r"),s("\u2028"),s("\u2029")]}},e.prototype.atomEscape=function(){this.consumeChar("\\");switch(this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){var e=this.positiveInteger();return{type:"GroupBackReference",value:e}},e.prototype.characterClassEscape=function(){var e;var t=false;switch(this.popChar()){case"d":e=c;break;case"D":e=c;t=true;break;case"s":e=h;break;case"S":e=h;t=true;break;case"w":e=d;break;case"W":e=d;t=true;break}l(e);return{type:"Set",value:e,complement:t}},e.prototype.controlEscapeAtom=function(){var e;switch(this.popChar()){case"f":e=s("\f");break;case"n":e=s("\n");break;case"r":e=s("\r");break;case"t":e=s("\t");break;case"v":e=s("\v");break}l(e);return{type:"Character",value:e}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var e=this.popChar();if(/[a-zA-Z]/.test(e)===false)throw Error("Invalid ");var t=e.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:t}},e.prototype.nulCharacterAtom=function(){this.consumeChar("0");return{type:"Character",value:s("\0")}},e.prototype.hexEscapeSequenceAtom=function(){this.consumeChar("x");return this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){this.consumeChar("u");return this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){var e=this.popChar();return{type:"Character",value:s(e)}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var e=this.popChar();return{type:"Character",value:s(e)}}},e.prototype.characterClass=function(){var e=[];var t=false;this.consumeChar("[");if(this.peekChar(0)==="^"){this.consumeChar("^");t=true}while(this.isClassAtom()){var n=this.classAtom();var r=n.type==="Character";if(r&&this.isRangeDash()){this.consumeChar("-");var i=this.classAtom();var o=i.type==="Character";if(o){if(i.value<n.value)throw Error("Range out of order in character class");e.push({from:n.value,to:i.value})}else{a(n.value,e);e.push(s("-"));a(i.value,e)}}else a(n.value,e)}this.consumeChar("]");return{type:"Set",complement:t,value:e}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){this.consumeChar("\\");switch(this.peekChar()){case"b":this.consumeChar("b");return{type:"Character",value:s("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var e=true;this.consumeChar("(");switch(this.peekChar(0)){case"?":this.consumeChar("?");this.consumeChar(":");e=false;break;default:this.groupIdx++;break}var t=this.disjunction();this.consumeChar(")");var n={type:"Group",capturing:e,value:t};if(e)n.idx=this.groupIdx;return n},e.prototype.positiveInteger=function(){var e=this.popChar();if(n.test(e)===false)throw Error("Expecting a positive integer");while(t.test(this.peekChar(0)))e+=this.popChar();return parseInt(e,10)},e.prototype.integerIncludingZero=function(){var e=this.popChar();if(t.test(e)===false)throw Error("Expecting an integer");while(t.test(this.peekChar(0)))e+=this.popChar();return parseInt(e,10)},e.prototype.patternCharacter=function(){var e=this.popChar();switch(e){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:s(e)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return true;default:return false}},e.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},e.prototype.isDigit=function(){return t.test(this.peekChar(0))},e.prototype.isClassAtom=function(e){if(e===undefined)e=0;switch(this.peekChar(e)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return false;default:return true}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return true;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return true;default:return false}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return true;case"\\":switch(this.peekChar(1)){case"b":case"B":return true;default:return false}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return false}},e.prototype.isQuantifier=function(){var e=this.saveState();try{return this.quantifier(true)!==undefined}catch(e){return false}finally{this.restoreState(e)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return false;default:return true}},e.prototype.parseHexDigits=function(e){var t="";for(var n=0;n<e;n++){var r=this.popChar();if(o.test(r)===false)throw Error("Expecting a HexDecimal digits");t+=r}var i=parseInt(t,16);return{type:"Character",value:i}},e.prototype.peekChar=function(e){if(e===undefined)e=0;return this.input[this.idx+e]},e.prototype.popChar=function(){var e=this.peekChar(0);this.consumeChar();return e},e.prototype.consumeChar=function(e){if(e!==undefined&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var o=/[0-9a-fA-F]/,t=/[0-9]/,n=/[1-9]/,r;function s(e){return e.charCodeAt(0)}function a(e,t){if(e.length!==undefined)e.forEach(function(e){t.push(e)});else t.push(e)}function i(e,t){if(e[t]===true)throw"duplicate flag "+t;e[t]=true}function l(e){if(e===undefined)throw Error("Internal Error - Should never get here!")}function u(){throw Error("Internal Error - Should never get here!")}for(var c=[],r=s("0");r<=s("9");r++)c.push(r);var d=[s("_")].concat(c);for(r=s("a");r<=s("z");r++)d.push(r);for(r=s("A");r<=s("Z");r++)d.push(r);var h=[s(" "),s("\f"),s("\n"),s("\r"),s("\t"),s("\v"),s("\t"),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s("\u2028"),s("\u2029"),s(" "),s(" "),s("　"),s("\ufeff")];function f(){}return f.prototype.visitChildren=function(e){for(var t in e){var n=e[t];if(e.hasOwnProperty(t))if(n.type!==undefined)this.visit(n);else if(Array.isArray(n))n.forEach(function(e){this.visit(e)},this)}},f.prototype.visit=function(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e);break}this.visitChildren(e)},f.prototype.visitPattern=function(e){},f.prototype.visitFlags=function(e){},f.prototype.visitDisjunction=function(e){},f.prototype.visitAlternative=function(e){},f.prototype.visitStartAnchor=function(e){},f.prototype.visitEndAnchor=function(e){},f.prototype.visitWordBoundary=function(e){},f.prototype.visitNonWordBoundary=function(e){},f.prototype.visitLookahead=function(e){},f.prototype.visitNegativeLookahead=function(e){},f.prototype.visitCharacter=function(e){},f.prototype.visitSet=function(e){},f.prototype.visitGroup=function(e){},f.prototype.visitGroupBackReference=function(e){},f.prototype.visitQuantifier=function(e){},{RegExpParser:e,BaseRegExpVisitor:f,VERSION:"0.4.0"}})?n.apply(t,[]):n)&&(e.exports=t)},(e,t,n)=>{"use strict";n.r(t),n.d(t,{canMatchCharCode:()=>function(t,e){{var n,r;return e instanceof RegExp?(n=(0,s.getRegExpAst)(e),(r=new g(t)).visit(n),r.found):void 0!==(0,o.find)(e,function(e){return(0,o.contains)(t,e.charCodeAt(0))})}},failedOptimizationPrefixMsg:()=>a,firstCharOptimizedIndices:()=>c,getOptimizedStartCodesIndices:()=>function(t,n){void 0===n&&(n=!1);try{var r=(0,s.getRegExpAst)(t);return c(r.value,{},r.flags.ignoreCase)}catch(e){e.message===u?n&&(0,o.PRINT_WARNING)(a+"\tUnable to optimize: < "+t.toString()+" >\n\tComplement Sets cannot be automatically optimized.\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details."):(r=n?"\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.":"",(0,o.PRINT_ERROR)(a+"\n\tFailed parsing: < "+t.toString()+" >\n\tUsing the regexp-to-ast library version: "+i.VERSION+"\n\tPlease open an issue at: https://github.com/bd82/regexp-to-ast/issues"+r))}return[]}});var r,i=n(24),o=n(17),s=n(26),l=n(23),t=(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u="Complement Sets are not supported for first char optimization",a='Unable to use "first char" lexer optimizations:\n';function c(e,s,a){switch(e.type){case"Disjunction":for(var t=0;t<e.value.length;t++)c(e.value[t],s,a);break;case"Alternative":for(var n=e.value,t=0;t<n.length;t++){var r=n[t];switch(r.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var i=r;switch(i.type){case"Character":d(i.value,s,a);break;case"Set":if(!0===i.complement)throw Error(u);(0,o.forEach)(i.value,function(e){if("number"==typeof e)d(e,s,a);else{var t=e;if(!0===a)for(var n=t.from;n<=t.to;n++)d(n,s,a);else{for(n=t.from;n<=t.to&&n<l.minOptimizationVal;n++)d(n,s,a);if(t.to>=l.minOptimizationVal)for(var e=t.from>=l.minOptimizationVal?t.from:l.minOptimizationVal,r=t.to,e=(0,l.charCodeToOptimizedIndex)(e),i=(0,l.charCodeToOptimizedIndex)(r),o=e;o<=i;o++)s[o]=o}}});break;case"Group":c(i.value,s,a);break;default:throw Error("Non Exhaustive Match")}r=void 0!==i.quantifier&&0===i.quantifier.atLeast;if("Group"===i.type&&!1===f(i)||"Group"!==i.type&&!1==r)break}break;default:throw Error("non exhaustive match!")}return(0,o.values)(s)}function d(e,t,n){var r,i=(0,l.charCodeToOptimizedIndex)(e);t[i]=i,!0===n&&(i=e,n=t,(e=(i=String.fromCharCode(i)).toUpperCase())!==i?(r=(0,l.charCodeToOptimizedIndex)(e.charCodeAt(0)),n[r]=r):(e=i.toLowerCase())!==i&&(r=(0,l.charCodeToOptimizedIndex)(e.charCodeAt(0)),n[r]=r))}function h(e,n){return(0,o.find)(e.value,function(e){var t;return"number"==typeof e?(0,o.contains)(n,e):(t=e,void 0!==(0,o.find)(n,function(e){return t.from<=e&&e<=t.to}))})}function f(e){return!(!e.quantifier||0!==e.quantifier.atLeast)||!!e.value&&((0,o.isArray)(e.value)?(0,o.every)(e.value,f):f(e.value))}p=i.BaseRegExpVisitor,t(m,p),m.prototype.visitChildren=function(e){if(!0!==this.found){switch(e.type){case"Lookahead":return void this.visitLookahead(e);case"NegativeLookahead":return void this.visitNegativeLookahead(e)}p.prototype.visitChildren.call(this,e)}},m.prototype.visitCharacter=function(e){(0,o.contains)(this.targetCharCodes,e.value)&&(this.found=!0)},m.prototype.visitSet=function(e){e.complement?void 0===h(e,this.targetCharCodes)&&(this.found=!0):void 0!==h(e,this.targetCharCodes)&&(this.found=!0)};var p,g=m;function m(e){var t=p.call(this)||this;return t.targetCharCodes=e,t.found=!1,t}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{clearRegExpParserCache:()=>function(){r={}},getRegExpAst:()=>function(e){e=e.toString();{var t;return r.hasOwnProperty(e)?r[e]:(t=i.pattern(e),r[e]=t)}}});var t=n(24),r={},i=new t.RegExpParser},(e,t,n)=>{"use strict";n.r(t),n.d(t,{assignCategoriesMapProp:()=>u,assignCategoriesTokensProp:()=>l,assignTokenDefaultProps:()=>a,augmentTokenTypes:()=>function(e){e=s(e);a(e),u(e),l(e),(0,o.forEach)(e,function(e){e.isParent=0<e.categoryMatches.length})},expandCategories:()=>s,hasCategoriesProperty:()=>h,hasExtendingTokensTypesMapProperty:()=>p,hasExtendingTokensTypesProperty:()=>f,hasShortKeyProperty:()=>d,isTokenType:()=>function(e){return(0,o.has)(e,"tokenTypeIdx")},singleAssignCategoriesToksMap:()=>c,tokenIdxToClass:()=>i,tokenShortNameIdx:()=>r,tokenStructuredMatcher:()=>function(e,t){e=e.tokenTypeIdx;return e===t.tokenTypeIdx||!0===t.isParent&&!0===t.categoryMatchesMap[e]},tokenStructuredMatcherNoCategories:()=>function(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}});var o=n(17);var r=1,i={};function s(e){for(var t=(0,o.cloneArr)(e),n=e,r=!0;r;){var n=(0,o.compact)((0,o.flatten)((0,o.map)(n,function(e){return e.CATEGORIES}))),i=(0,o.difference)(n,t),t=t.concat(i);(0,o.isEmpty)(i)?r=!1:n=i}return t}function a(e){(0,o.forEach)(e,function(e){d(e)||((i[r]=e).tokenTypeIdx=r++),h(e)&&!(0,o.isArray)(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),h(e)||(e.CATEGORIES=[]),f(e)||(e.categoryMatches=[]),p(e)||(e.categoryMatchesMap={})})}function l(e){(0,o.forEach)(e,function(n){n.categoryMatches=[],(0,o.forEach)(n.categoryMatchesMap,function(e,t){n.categoryMatches.push(i[t].tokenTypeIdx)})})}function u(e){(0,o.forEach)(e,function(e){c([],e)})}function c(n,r){(0,o.forEach)(n,function(e){r.categoryMatchesMap[e.tokenTypeIdx]=!0}),(0,o.forEach)(r.CATEGORIES,function(e){var t=n.concat(r);(0,o.contains)(t,e)||c(t,e)})}function d(e){return(0,o.has)(e,"tokenTypeIdx")}function h(e){return(0,o.has)(e,"CATEGORIES")}function f(e){return(0,o.has)(e,"categoryMatches")}function p(e){return(0,o.has)(e,"categoryMatchesMap")}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{defaultLexerErrorProvider:()=>r});var r={buildUnableToPopLexerModeMessage:function(e){return"Unable to pop Lexer Mode after encountering Token ->"+e.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(e,t,n,r,i){return"unexpected character: ->"+e.charAt(t)+"<- at offset: "+t+", skipped "+n+" characters."}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{first:()=>u,firstForBranching:()=>o,firstForSequence:()=>i,firstForTerminal:()=>s});var a=n(17),r=n(20),l=n(30);function u(e){if(e instanceof r.NonTerminal)return u(e.referencedRule);if(e instanceof r.Terminal)return s(e);if((0,l.isSequenceProd)(e))return i(e);if((0,l.isBranchingProd)(e))return o(e);throw Error("non exhaustive match")}function i(e){for(var t,n=[],r=e.definition,i=0,o=r.length>i,s=!0;o&&s;)t=r[i],s=(0,l.isOptionalProd)(t),n=n.concat(u(t)),o=r.length>(i+=1);return(0,a.uniq)(n)}function o(e){e=(0,a.map)(e.definition,u);return(0,a.uniq)((0,a.flatten)(e))}function s(e){return[e.terminalType]}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{DslMethodsCollectorVisitor:()=>a,collectMethods:()=>function(e){u.reset(),e.accept(u);e=u.dslMethods;return u.reset(),e},getProductionDslName:()=>function(e){{if(e instanceof o.NonTerminal)return"SUBRULE";if(e instanceof o.Option)return"OPTION";if(e instanceof o.Alternation)return"OR";if(e instanceof o.RepetitionMandatory)return"AT_LEAST_ONE";if(e instanceof o.RepetitionMandatoryWithSeparator)return"AT_LEAST_ONE_SEP";if(e instanceof o.RepetitionWithSeparator)return"MANY_SEP";if(e instanceof o.Repetition)return"MANY";if(e instanceof o.Terminal)return"CONSUME";throw Error("non exhaustive match")}},isBranchingProd:()=>function(e){return e instanceof o.Alternation},isOptionalProd:()=>function t(e,n){void 0===n&&(n=[]);var r=e instanceof o.Option||e instanceof o.Repetition||e instanceof o.RepetitionWithSeparator;if(r)return!0;return e instanceof o.Alternation?(0,i.some)(e.definition,function(e){return t(e,n)}):!(e instanceof o.NonTerminal&&(0,i.contains)(n,e))&&e instanceof o.AbstractProduction&&(e instanceof o.NonTerminal&&n.push(e),(0,i.every)(e.definition,function(e){return t(e,n)}))},isSequenceProd:()=>function(e){return e instanceof o.Flat||e instanceof o.Option||e instanceof o.Repetition||e instanceof o.RepetitionMandatory||e instanceof o.RepetitionMandatoryWithSeparator||e instanceof o.RepetitionWithSeparator||e instanceof o.Terminal||e instanceof o.Rule}});var r,i=n(17),o=n(20),t=n(31),n=(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});s=t.GAstVisitor,n(l,s),l.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},l.prototype.visitTerminal=function(e){var t=e.terminalType.name+this.separator+"Terminal";(0,i.has)(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},l.prototype.visitNonTerminal=function(e){var t=e.nonTerminalName+this.separator+"Terminal";(0,i.has)(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},l.prototype.visitOption=function(e){this.dslMethods.option.push(e)},l.prototype.visitRepetitionWithSeparator=function(e){this.dslMethods.repetitionWithSeparator.push(e)},l.prototype.visitRepetitionMandatory=function(e){this.dslMethods.repetitionMandatory.push(e)},l.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)},l.prototype.visitRepetition=function(e){this.dslMethods.repetition.push(e)},l.prototype.visitAlternation=function(e){this.dslMethods.alternation.push(e)};var s,a=l;function l(){var e=null!==s&&s.apply(this,arguments)||this;return e.separator="-",e.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},e}var u=new a},(e,t,n)=>{"use strict";n.r(t),n.d(t,{GAstVisitor:()=>i});var r=n(20),i=(o.prototype.visit=function(e){var t=e;switch(t.constructor){case r.NonTerminal:return this.visitNonTerminal(t);case r.Flat:return this.visitFlat(t);case r.Option:return this.visitOption(t);case r.RepetitionMandatory:return this.visitRepetitionMandatory(t);case r.RepetitionMandatoryWithSeparator:return this.visitRepetitionMandatoryWithSeparator(t);case r.RepetitionWithSeparator:return this.visitRepetitionWithSeparator(t);case r.Repetition:return this.visitRepetition(t);case r.Alternation:return this.visitAlternation(t);case r.Terminal:return this.visitTerminal(t);case r.Rule:return this.visitRule(t);default:throw Error("non exhaustive match")}},o.prototype.visitNonTerminal=function(e){},o.prototype.visitFlat=function(e){},o.prototype.visitOption=function(e){},o.prototype.visitRepetition=function(e){},o.prototype.visitRepetitionMandatory=function(e){},o.prototype.visitRepetitionMandatoryWithSeparator=function(e){},o.prototype.visitRepetitionWithSeparator=function(e){},o.prototype.visitAlternation=function(e){},o.prototype.visitTerminal=function(e){},o.prototype.visitRule=function(e){},o);function o(){}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{IN:()=>r});var r="_~IN~_"},(e,t,n)=>{"use strict";n.r(t),n.d(t,{NamedDSLMethodsCollectorVisitor:()=>o,addNoneTerminalToCst:()=>function(e,t,n){void 0===e.children[t]?e.children[t]=[n]:e.children[t].push(n)},addTerminalToCst:()=>function(e,t,n){void 0===e.children[n]?e.children[n]=[t]:e.children[n].push(t)},expandAllNestedRuleNames:()=>function(e,n){var r={allRuleNames:[]};return(0,s.forEach)(e,function(t){var e=n[t.name],e=(r.allRuleNames.push(t.name),new o(e));t.accept(e),(0,s.forEach)(e.result,function(e){e.def,e.key;e=e.name;r.allRuleNames.push(t.name+e)})}),r},setNodeLocationFull:()=>function(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset==!0&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)},setNodeLocationOnlyOffset:()=>function(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset==!0&&(e.endOffset=t.endOffset)}});var r,s=n(17),a=n(34),l=n(20),t=n(31),n=(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});i=t.GAstVisitor,n(u,i),u.prototype.collectNamedDSLMethod=function(e,t,n){if(!(0,s.isUndefined)(e.name)){var r=void 0;if(e instanceof l.Option||e instanceof l.Repetition||e instanceof l.RepetitionMandatory||e instanceof l.Alternation)r=new t({definition:e.definition,idx:e.idx});else{if(!(e instanceof l.RepetitionMandatoryWithSeparator||e instanceof l.RepetitionWithSeparator))throw Error("non exhaustive match");r=new t({definition:e.definition,idx:e.idx,separator:e.separator})}t=[r],r=(0,a.getKeyForAutomaticLookahead)(this.ruleIdx,n,e.idx);this.result.push({def:t,key:r,name:e.name,orgProd:e})}},u.prototype.visitOption=function(e){this.collectNamedDSLMethod(e,l.Option,a.OPTION_IDX)},u.prototype.visitRepetition=function(e){this.collectNamedDSLMethod(e,l.Repetition,a.MANY_IDX)},u.prototype.visitRepetitionMandatory=function(e){this.collectNamedDSLMethod(e,l.RepetitionMandatory,a.AT_LEAST_ONE_IDX)},u.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.collectNamedDSLMethod(e,l.RepetitionMandatoryWithSeparator,a.AT_LEAST_ONE_SEP_IDX)},u.prototype.visitRepetitionWithSeparator=function(e){this.collectNamedDSLMethod(e,l.RepetitionWithSeparator,a.MANY_SEP_IDX)},u.prototype.visitAlternation=function(r){var i=this,o=(this.collectNamedDSLMethod(r,l.Alternation,a.OR_IDX),1<r.definition.length);(0,s.forEach)(r.definition,function(e,t){var n;(0,s.isUndefined)(e.name)||(n=e.definition,n=o?[new l.Option({definition:e.definition})]:e.definition,t=(0,a.getKeyForAltIndex)(i.ruleIdx,a.OR_IDX,r.idx,t),i.result.push({def:n,key:t,name:e.name,orgProd:e}))})};var i,o=u;function u(e){var t=i.call(this)||this;return t.result=[],t.ruleIdx=e,t}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{AT_LEAST_ONE_IDX:()=>c,AT_LEAST_ONE_SEP_IDX:()=>h,BITS_FOR_ALT_IDX:()=>s,BITS_FOR_METHOD_TYPE:()=>r,BITS_FOR_OCCURRENCE_IDX:()=>i,BITS_FOR_RULE_IDX:()=>o,MANY_IDX:()=>u,MANY_SEP_IDX:()=>d,OPTION_IDX:()=>l,OR_IDX:()=>a,getKeyForAltIndex:()=>function(e,t,n,r){return n|t|e|r+1<<p},getKeyForAutomaticLookahead:()=>f});var r=4,i=8,o=12,s=8,a=1<<i,l=2<<i,u=3<<i,c=4<<i,d=5<<i,h=6<<i;function f(e,t,n){return n|t|e}var p=32-s},(e,t,n)=>{"use strict";n.r(t),n.d(t,{defaultGrammarResolverErrorProvider:()=>u,defaultGrammarValidatorErrorProvider:()=>c,defaultParserErrorProvider:()=>l});var i=n(21),o=n(17),s=n(20),a=n(30),r=n(36),l={buildMismatchTokenMessage:function(e){var t=e.expected,n=e.actual;e.previous,e.ruleName;return"Expecting "+((0,i.hasTokenLabel)(t)?"--\x3e "+(0,i.tokenLabel)(t)+" <--":"token of type --\x3e "+t.name+" <--")+" but found --\x3e '"+n.image+"' <--"},buildNotAllInputParsedMessage:function(e){var t=e.firstRedundant;e.ruleName;return"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage:function(e){var t=e.expectedPathsPerAlt,n=e.actual,r=(e.previous,e.customUserDescription),e=(e.ruleName,"Expecting: "),n="\nbut found: '"+(0,o.first)(n).image+"'";return r?e+r+n:(r=(0,o.reduce)(t,function(e,t){return e.concat(t)},[]),t=(0,o.map)(r,function(e){return"["+(0,o.map)(e,function(e){return(0,i.tokenLabel)(e)}).join(", ")+"]"}),e+("one of these possible Token sequences:\n"+(0,o.map)(t,function(e,t){return"  "+(t+1)+". "+e}).join("\n"))+n)},buildEarlyExitMessage:function(e){var t=e.expectedIterationPaths,n=e.actual,r=e.customUserDescription,e=(e.ruleName,"Expecting: "),n="\nbut found: '"+(0,o.first)(n).image+"'";return r?e+r+n:e+("expecting at least one iteration which starts with one of these possible Token sequences::\n  <"+(0,o.map)(t,function(e){return"["+(0,o.map)(e,function(e){return(0,i.tokenLabel)(e)}).join(",")+"]"}).join(" ,")+">")+n}},u=(Object.freeze(l),{buildRuleNotFoundError:function(e,t){return"Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\ninside top level rule: ->"+e.name+"<-"}}),c={buildDuplicateFoundError:function(e,t){var e=e.name,n=(0,o.first)(t),r=n.idx,i=(0,a.getProductionDslName)(n),n=(n=n)instanceof s.Terminal?n.terminalType.name:n instanceof s.NonTerminal?n.nonTerminalName:"",i="->"+i+(0<r?r:"")+"<- "+(n?"with argument: ->"+n+"<-":"")+"\n                  appears more than once ("+t.length+" times) in the top level rule: ->"+e+"<-.                  \n                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  ";return i=(i=i.replace(/[ \t]+/g," ")).replace(/\s\s+/g,"\n")},buildInvalidNestedRuleNameError:function(e,t){return"Invalid nested rule name: ->"+t.name+"<- inside rule: ->"+e.name+"<-\nit must match the pattern: ->"+r.validNestedRuleName.toString()+"<-.\nNote that this means a nested rule name must start with the '$'(dollar) sign."},buildDuplicateNestedRuleNameError:function(e,t){return"Duplicate nested rule name: ->"+(0,o.first)(t).name+"<- inside rule: ->"+e.name+"<-\nA nested name must be unique in the scope of a top level grammar rule."},buildNamespaceConflictError:function(e){return"Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+e.name+">.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter."},buildAlternationPrefixAmbiguityError:function(e){var t=(0,o.map)(e.prefixPath,function(e){return(0,i.tokenLabel)(e)}).join(", "),n=0===e.alternation.idx?"":e.alternation.idx;return"Ambiguous alternatives: <"+e.ambiguityIndices.join(" ,")+"> due to common lookahead prefix\nin <OR"+n+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\nSee: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details."},buildAlternationAmbiguityError:function(e){var t=(0,o.map)(e.prefixPath,function(e){return(0,i.tokenLabel)(e)}).join(", "),n=0===e.alternation.idx?"":e.alternation.idx,n="Ambiguous Alternatives Detected: <"+e.ambiguityIndices.join(" ,")+"> in <OR"+n+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\n";return n+="See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details."},buildEmptyRepetitionError:function(e){var t=(0,a.getProductionDslName)(e.repetition);return 0!==e.repetition.idx&&(t+=e.repetition.idx),"The repetition <"+t+"> within Rule <"+e.topLevelRule.name+"> can never consume any tokens.\nThis could lead to an infinite loop."},buildTokenNameError:function(e){return"Invalid Grammar Token name: ->"+e.tokenType.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildEmptyAlternationError:function(e){return"Ambiguous empty alternative: <"+(e.emptyChoiceIdx+1)+"> in <OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\nOnly the last alternative may be an empty alternative."},buildTooManyAlternativesError:function(e){return"An Alternation cannot have more than 256 alternatives:\n<OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\n has "+(e.alternation.definition.length+1)+" alternatives."},buildLeftRecursionError:function(e){var t=e.topLevelRule.name;return"Left Recursion found in grammar.\nrule: <"+t+"> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n "+(t+" --\x3e "+o.map(e.leftRecursionPath,function(e){return e.name}).concat([t]).join(" --\x3e "))+"\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring."},buildInvalidRuleNameError:function(e){return"Invalid grammar rule name: ->"+e.topLevelRule.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildDuplicateRuleNameError:function(e){var t=e.topLevelRule instanceof s.Rule?e.topLevelRule.name:e.topLevelRule;return"Duplicate definition, rule: ->"+t+"<- is already defined in the grammar: ->"+e.grammarName+"<-"}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{OccurrenceValidationCollector:()=>S,RepetionCollector:()=>m,checkPrefixAlternativesAmbiguities:()=>D,getFirstNoneTerminal:()=>c,identifyProductionForDuplicates:()=>C,validNestedRuleName:()=>u,validTermsPattern:()=>l,validateAmbiguousAlternationAlternatives:()=>O,validateEmptyOrAlternative:()=>x,validateGrammar:()=>function(t,n,e,r,o,i){var s=y.map(t,function(e){return r=e,i=o,e=new S,r.accept(e),e=e.allProductions,e=y.groupBy(e,C),e=y.pick(e,function(e){return 1<e.length}),y.map(y.values(e),function(e){var t=y.first(e),e=i.buildDuplicateFoundError(r,e),n=(0,b.getProductionDslName)(t),e={message:e,type:v.ParserDefinitionErrorType.DUPLICATE_PRODUCTIONS,ruleName:r.name,dslName:n,occurrence:t.idx},n=w(t);return n&&(e.parameter=n),e});var r,i}),a=y.map(t,function(e){return N(e,e,o)}),l=[],u=[],c=[];(0,y.every)(a,y.isEmpty)&&(l=(0,y.map)(t,function(e){return x(e,o)}),u=(0,y.map)(t,function(e){return O(e,n,r,o)}),c=k(t,n,o));var d=function(e,t,n){var r=[],i=(0,y.map)(t,function(e){return e.name});return(0,y.forEach)(e,function(e){var t=e.name;(0,y.contains)(i,t)&&(e=n.buildNamespaceConflictError(e),r.push({message:e,type:v.ParserDefinitionErrorType.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:t}))}),r}(t,e,o),e=y.map(e,function(e){return A(e,o)}),h=function(e,n){var r=[];return(0,y.forEach)(e,function(t){var e=new E.NamedDSLMethodsCollectorVisitor(""),e=(t.accept(e),(0,y.map)(e.result,function(e){return e.orgProd}));r.push((0,y.map)(e,function(e){return R(t,e,n)}))}),(0,y.flatten)(r)}(t,o),f=function(e,n){var r=[];return(0,y.forEach)(e,function(t){var e=new E.NamedDSLMethodsCollectorVisitor(""),e=(t.accept(e),(0,y.groupBy)(e.result,function(e){return e.name})),e=(0,y.pick)(e,function(e){return 1<e.length});(0,y.forEach)((0,y.values)(e),function(e){e=(0,y.map)(e,function(e){return e.orgProd}),e=n.buildDuplicateNestedRuleNameError(t,e);r.push({message:e,type:v.ParserDefinitionErrorType.DUPLICATE_NESTED_NAME,ruleName:t.name})})}),r}(t,o),p=(0,y.map)(t,function(e){return M(e,o)}),g=(0,y.map)(t,function(e){return T(e,o)}),m=(0,y.map)(t,function(e){return _(e,t,i,o)});return y.flatten(s.concat(e,h,f,c,a,l,u,d,p,g,m))},validateNestedRuleName:()=>R,validateNoLeftRecursion:()=>N,validateRuleDoesNotAlreadyExist:()=>_,validateRuleIsOverridden:()=>function(e,t,n){var r=[];y.contains(t,e)||r.push({message:"Invalid rule override, rule: ->"+e+"<- cannot be overridden in the grammar: ->"+n+"<-as it is not defined in any of the super grammars ",type:v.ParserDefinitionErrorType.INVALID_RULE_OVERRIDE,ruleName:e});return r},validateRuleName:()=>T,validateSomeNonEmptyLookaheadPath:()=>k,validateTokenName:()=>A,validateTooManyAlts:()=>M});var r,y=n(17),v=n(16),b=n(30),h=n(37),E=n(33),o=n(38),i=n(20),t=n(31),n=(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function C(e){return(0,b.getProductionDslName)(e)+"_#_"+e.idx+"_#_"+w(e)}function w(e){return e instanceof i.Terminal?e.terminalType.name:e instanceof i.NonTerminal?e.nonTerminalName:""}s=t.GAstVisitor,n(a,s),a.prototype.visitNonTerminal=function(e){this.allProductions.push(e)},a.prototype.visitOption=function(e){this.allProductions.push(e)},a.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},a.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},a.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},a.prototype.visitRepetition=function(e){this.allProductions.push(e)},a.prototype.visitAlternation=function(e){this.allProductions.push(e)},a.prototype.visitTerminal=function(e){this.allProductions.push(e)};var s,S=a;function a(){var e=null!==s&&s.apply(this,arguments)||this;return e.allProductions=[],e}var l=/^[a-zA-Z_]\w*$/,u=new RegExp(l.source.replace("^","^\\$"));function T(e,t){var n=[],r=e.name;return r.match(l)||n.push({message:t.buildInvalidRuleNameError({topLevelRule:e,expectedPattern:l}),type:v.ParserDefinitionErrorType.INVALID_RULE_NAME,ruleName:r}),n}function R(e,t,n){var r=[];return t.name.match(u)||(n=n.buildInvalidNestedRuleNameError(e,t),r.push({message:n,type:v.ParserDefinitionErrorType.INVALID_NESTED_RULE_NAME,ruleName:e.name})),r}function A(e,t){var n=[];return e.name.match(l)||n.push({message:t.buildTokenNameError({tokenType:e,expectedPattern:l}),type:v.ParserDefinitionErrorType.INVALID_TOKEN_NAME}),n}function _(n,e,t,r){var i=[];return 1<(0,y.reduce)(e,function(e,t){return t.name===n.name?e+1:e},0)&&(e=r.buildDuplicateRuleNameError({topLevelRule:n,grammarName:t}),i.push({message:e,type:v.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:n.name})),i}function N(n,e,r,i){void 0===i&&(i=[]);var t,o=[],e=c(e.definition);return y.isEmpty(e)?[]:(t=n.name,y.contains(e,n)&&o.push({message:r.buildLeftRecursionError({topLevelRule:n,leftRecursionPath:i}),type:v.ParserDefinitionErrorType.LEFT_RECURSION,ruleName:t}),t=y.difference(e,i.concat([n])),e=y.map(t,function(e){var t=y.cloneArr(i);return t.push(e),N(n,e,r,t)}),o.concat(y.flatten(e)))}function c(e){var t=[];if(y.isEmpty(e))return t;var n=y.first(e);if(n instanceof i.NonTerminal)t.push(n.referencedRule);else if(n instanceof i.Flat||n instanceof i.Option||n instanceof i.RepetitionMandatory||n instanceof i.RepetitionMandatoryWithSeparator||n instanceof i.RepetitionWithSeparator||n instanceof i.Repetition)t=t.concat(c(n.definition));else if(n instanceof i.Alternation)t=y.flatten(y.map(n.definition,function(e){return c(e.definition)}));else if(!(n instanceof i.Terminal))throw Error("non exhaustive match");var n=(0,b.isOptionalProd)(n),r=1<e.length;return n&&r?(n=y.drop(e),t.concat(c(n))):t}d=t.GAstVisitor,n(p,d),p.prototype.visitAlternation=function(e){this.alternations.push(e)};var d,f=p;function p(){var e=null!==d&&d.apply(this,arguments)||this;return e.alternations=[],e}function x(r,i){var e=new f,e=(r.accept(e),e.alternations);return y.reduce(e,function(e,n){var t=y.dropRight(n.definition),t=y.map(t,function(e,t){e=(0,o.nextPossibleTokensAfter)([e],[],null,1);return y.isEmpty(e)?{message:i.buildEmptyAlternationError({topLevelRule:r,alternation:n,emptyChoiceIdx:t}),type:v.ParserDefinitionErrorType.NONE_LAST_EMPTY_ALT,ruleName:r.name,occurrence:n.idx,alternative:t+1}:null});return e.concat(y.compact(t))},[])}function O(u,c,e,d){var t=new f,t=(u.accept(t),t.alternations),n=e[u.name];return n&&(t=(0,y.reject)(t,function(e){return n[(0,b.getProductionDslName)(e)+(0===e.idx?"":e.idx)]})),t=(0,y.reject)(t,function(e){return!0===e.ignoreAmbiguities}),y.reduce(t,function(e,t){var o,s,n,r,a,i=t.idx,l=t.maxLookahead||c,i=(0,h.getLookaheadPathsForOr)(i,u,l,t),l=(o=i,s=t,n=u,r=d,a=[],l=(0,y.reduce)(o,function(e,t,i){return!0!==s.definition[i].ignoreAmbiguities&&(0,y.forEach)(t,function(n){var r=[i];(0,y.forEach)(o,function(e,t){i!==t&&(0,h.containsPath)(e,n)&&!0!==s.definition[t].ignoreAmbiguities&&r.push(t)}),1<r.length&&!(0,h.containsPath)(a,n)&&(a.push(n),e.push({alts:r,path:n}))}),e},[]),y.map(l,function(e){var t=(0,y.map)(e.alts,function(e){return e+1});return{message:r.buildAlternationAmbiguityError({topLevelRule:n,alternation:s,ambiguityIndices:t,prefixPath:e.path}),type:v.ParserDefinitionErrorType.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:s.idx,alternatives:[e.alts]}})),i=D(i,t,u,d);return e.concat(l,i)},[])}g=t.GAstVisitor,n(I,g),I.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},I.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},I.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},I.prototype.visitRepetition=function(e){this.allProductions.push(e)};var g,m=I;function I(){var e=null!==g&&g.apply(this,arguments)||this;return e.allProductions=[],e}function M(n,r){var e=new f,e=(n.accept(e),e.alternations);return y.reduce(e,function(e,t){return 255<t.definition.length&&e.push({message:r.buildTooManyAlternativesError({topLevelRule:n,alternation:t}),type:v.ParserDefinitionErrorType.TOO_MANY_ALTS,ruleName:n.name,occurrence:t.idx}),e},[])}function k(e,o,s){var a=[];return(0,y.forEach)(e,function(i){var e=new m,e=(i.accept(e),e.allProductions);(0,y.forEach)(e,function(e){var t=(0,h.getProdType)(e),n=e.maxLookahead||o,r=e.idx,r=(0,h.getLookaheadPathsForOptionalProd)(r,i,t,n)[0];(0,y.isEmpty)((0,y.flatten)(r))&&(t=s.buildEmptyRepetitionError({topLevelRule:i,repetition:e}),a.push({message:t,type:v.ParserDefinitionErrorType.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name}))})}),a}function D(e,i,o,s){var n=[],a=(0,y.reduce)(e,function(e,t,n){t=(0,y.map)(t,function(e){return{idx:n,path:e}});return e.concat(t)},[]);return(0,y.forEach)(a,function(e){var r,t;!0!==i.definition[e.idx].ignoreAmbiguities&&(r=e.idx,t=e.path,e=(0,y.findAll)(a,function(e){return!0!==i.definition[e.idx].ignoreAmbiguities&&e.idx<r&&(0,h.isStrictPrefixOfPath)(e.path,t)}),e=(0,y.map)(e,function(e){var t=[e.idx+1,r+1],n=0===i.idx?"":i.idx;return{message:s.buildAlternationPrefixAmbiguityError({topLevelRule:o,alternation:i,ambiguityIndices:t,prefixPath:e.path}),type:v.ParserDefinitionErrorType.AMBIGUOUS_PREFIX_ALTS,ruleName:o.name,occurrence:n,alternatives:t}}),n=n.concat(e))}),n}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{PROD_TYPE:()=>i,areTokenCategoriesNotUsed:()=>S,buildAlternativesLookAheadFunc:()=>function(d,e,h,t){var f=d.length,n=(0,g.every)(d,function(e){return(0,g.every)(e,function(e){return 1===e.length})});{var r;return e?function(e){for(var t=(0,g.map)(e,function(e){return e.GATE}),n=0;n<f;n++){var r=d[n],i=r.length,o=t[n];if(void 0===o||!1!==o.call(this))e:for(var s=0;s<i;s++){for(var a=r[s],l=a.length,u=0;u<l;u++){var c=this.LA(u+1);if(!1===h(c,a[u]))continue e}return n}}}:n&&!t?(e=(0,g.map)(d,function(e){return(0,g.flatten)(e)}),r=(0,g.reduce)(e,function(t,e,n){return(0,g.forEach)(e,function(e){(0,g.has)(t,e.tokenTypeIdx)||(t[e.tokenTypeIdx]=n),(0,g.forEach)(e.categoryMatches,function(e){(0,g.has)(t,e)||(t[e]=n)})}),t},[]),function(){var e=this.LA(1);return r[e.tokenTypeIdx]}):function(){for(var e=0;e<f;e++){var t=d[e],n=t.length;e:for(var r=0;r<n;r++){for(var i=t[r],o=i.length,s=0;s<o;s++){var a=this.LA(s+1);if(!1===h(a,i[s]))continue e}return e}}}}},buildLookaheadFuncForOptionalProd:()=>function(e,t,n,r,i,o){e=C(e,t,i,n),t=S(e)?s.tokenStructuredMatcherNoCategories:s.tokenStructuredMatcher;return o(e[0],t,r)},buildLookaheadFuncForOr:()=>function(e,t,n,r,i,o){e=E(e,t,n),t=S(e)?s.tokenStructuredMatcherNoCategories:s.tokenStructuredMatcher;return o(e,r,t,i)},buildSingleAlternativeLookaheadFunction:()=>function(o,s,e){var t=(0,g.every)(o,function(e){return 1===e.length}),a=o.length;{var n,r;return t&&!e?1===(t=(0,g.flatten)(o)).length&&(0,g.isEmpty)(t[0].categoryMatches)?(n=t[0].tokenTypeIdx,function(){return this.LA(1).tokenTypeIdx===n}):(r=(0,g.reduce)(t,function(t,e,n){return t[e.tokenTypeIdx]=!0,(0,g.forEach)(e.categoryMatches,function(e){t[e]=!0}),t},[]),function(){var e=this.LA(1);return!0===r[e.tokenTypeIdx]}):function(){e:for(var e=0;e<a;e++){for(var t=o[e],n=t.length,r=0;r<n;r++){var i=this.LA(r+1);if(!1===s(i,t[r]))continue e}return!0}return!1}}},containsPath:()=>w,getLookaheadPathsForOptionalProd:()=>C,getLookaheadPathsForOr:()=>E,getProdType:()=>function(e){{if(e instanceof a.Option)return i.OPTION;if(e instanceof a.Repetition)return i.REPETITION;if(e instanceof a.RepetitionMandatory)return i.REPETITION_MANDATORY;if(e instanceof a.RepetitionMandatoryWithSeparator)return i.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof a.RepetitionWithSeparator)return i.REPETITION_WITH_SEPARATOR;if(e instanceof a.Alternation)return i.ALTERNATION;throw Error("non exhaustive match")}},isStrictPrefixOfPath:()=>function(e,n){return e.length<n.length&&(0,g.every)(e,function(e,t){t=n[t];return e===t||t.categoryMatchesMap[e.tokenTypeIdx]})},lookAheadSequenceFromAlternatives:()=>b});var r,i,o,g=n(17),m=n(38),t=n(19),s=n(27),a=n(20),n=n(31),l=(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});(o=i=i||{})[o.OPTION=0]="OPTION",o[o.REPETITION=1]="REPETITION",o[o.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",o[o.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",o[o.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",o[o.ALTERNATION=5]="ALTERNATION";u=t.RestWalker,l(d,u),d.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},d.prototype.checkIsTarget=function(e,t,n,r){return e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.restDef=n.concat(r),!0)},d.prototype.walkOption=function(e,t,n){this.checkIsTarget(e,i.OPTION,t,n)||u.prototype.walkOption.call(this,e,t,n)},d.prototype.walkAtLeastOne=function(e,t,n){this.checkIsTarget(e,i.REPETITION_MANDATORY,t,n)||u.prototype.walkOption.call(this,e,t,n)},d.prototype.walkAtLeastOneSep=function(e,t,n){this.checkIsTarget(e,i.REPETITION_MANDATORY_WITH_SEPARATOR,t,n)||u.prototype.walkOption.call(this,e,t,n)},d.prototype.walkMany=function(e,t,n){this.checkIsTarget(e,i.REPETITION,t,n)||u.prototype.walkOption.call(this,e,t,n)},d.prototype.walkManySep=function(e,t,n){this.checkIsTarget(e,i.REPETITION_WITH_SEPARATOR,t,n)||u.prototype.walkOption.call(this,e,t,n)};var u,c=d;function d(e,t,n){var r=u.call(this)||this;return r.topProd=e,r.targetOccurrence=t,r.targetProdType=n,r}h=n.GAstVisitor,l(p,h),p.prototype.checkIsTarget=function(e,t){e.idx!==this.targetOccurrence||this.targetProdType!==t||void 0!==this.targetRef&&e!==this.targetRef||(this.result=e.definition)},p.prototype.visitOption=function(e){this.checkIsTarget(e,i.OPTION)},p.prototype.visitRepetition=function(e){this.checkIsTarget(e,i.REPETITION)},p.prototype.visitRepetitionMandatory=function(e){this.checkIsTarget(e,i.REPETITION_MANDATORY)},p.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.checkIsTarget(e,i.REPETITION_MANDATORY_WITH_SEPARATOR)},p.prototype.visitRepetitionWithSeparator=function(e){this.checkIsTarget(e,i.REPETITION_WITH_SEPARATOR)},p.prototype.visitAlternation=function(e){this.checkIsTarget(e,i.ALTERNATION)};var h,f=p;function p(e,t,n){var r=h.call(this)||this;return r.targetOccurrence=e,r.targetProdType=t,r.targetRef=n,r.result=[],r}function y(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=[];return t}function v(e){for(var t=[""],n=0;n<e.length;n++){for(var r=e[n],i=[],o=0;o<t.length;o++){var s=t[o];i.push(s+"_"+r.tokenTypeIdx);for(var a=0;a<r.categoryMatches.length;a++){var l="_"+r.categoryMatches[a];i.push(s+l)}}t=i}return t}function b(e,u){for(var e=(0,g.map)(e,function(e){return(0,m.possiblePathsFrom)([e],1)}),c=y(e.length),d=(0,g.map)(e,function(e){var t={};return(0,g.forEach)(e,function(e){e=v(e.partialPath);(0,g.forEach)(e,function(e){t[e]=!0})}),t}),h=e,f=1;f<=u;f++)for(var p=h,h=y(p.length),t=function(t){for(var e=p[t],n=0;n<e.length;n++){var r=e[n].partialPath,i=e[n].suffixDef,o=v(r);if(function(e,t,n){for(var r=0;r<e.length;r++)if(r!==n)for(var i=e[r],o=0;o<t.length;o++)if(!0===i[t[o]])return!1;return!0}(d,o,t)||(0,g.isEmpty)(i)||r.length===u){var s=c[t];if(!1===w(s,r)){s.push(r);for(var a=0;a<o.length;a++){var l=o[a];d[t][l]=!0}}}else{s=(0,m.possiblePathsFrom)(i,f+1,r);h[t]=h[t].concat(s),(0,g.forEach)(s,function(e){e=v(e.partialPath);(0,g.forEach)(e,function(e){d[t][e]=!0})})}}},n=0;n<p.length;n++)t(n);return c}function E(e,t,n,r){e=new f(e,i.ALTERNATION,r);return t.accept(e),b(e.result,n)}function C(e,t,n,r){var i=new f(e,n),i=(t.accept(i),i.result),t=new c(t,e,n).startWalking();return b([new a.Flat({definition:i}),new a.Flat({definition:t})],r)}function w(e,t){e:for(var n=0;n<e.length;n++){var r=e[n];if(r.length===t.length){for(var i=0;i<r.length;i++){var o=t[i],s=r[i];if(!1==(o===s||void 0!==s.categoryMatchesMap[o.tokenTypeIdx]))continue e}return!0}}return!1}function S(e){return(0,g.every)(e,function(e){return(0,g.every)(e,function(e){return(0,g.every)(e,function(e){return(0,g.isEmpty)(e.categoryMatches)})})})}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{AbstractNextPossibleTokensWalker:()=>s,AbstractNextTerminalAfterProductionWalker:()=>h,NextAfterTokenWalker:()=>u,NextTerminalAfterAtLeastOneSepWalker:()=>T,NextTerminalAfterAtLeastOneWalker:()=>C,NextTerminalAfterManySepWalker:()=>v,NextTerminalAfterManyWalker:()=>g,nextPossibleTokensAfter:()=>function(e,t,n,r){var i="EXIT_NONE_TERMINAL",o=[i],s="EXIT_ALTERNATIVE",a=!1,l=t.length,u=l-r-1,c=[],d=[];d.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});for(;!(0,N.isEmpty)(d);){var h=d.pop();if(h===s)a&&(0,N.last)(d).idx<=u&&d.pop();else{var f=h.def,p=h.idx,g=h.ruleStack,m=h.occurrenceStack;if(!(0,N.isEmpty)(f)){var y=f[0];if(y===i){var v={idx:p,def:(0,N.drop)(f),ruleStack:(0,N.dropRight)(g),occurrenceStack:(0,N.dropRight)(m)};d.push(v)}else if(y instanceof x.Terminal)if(p<l-1){var h=p+1,b=t[h];n(b,y.terminalType)&&(v={idx:h,def:(0,N.drop)(f),ruleStack:g,occurrenceStack:m},d.push(v))}else{if(p!==l-1)throw Error("non exhaustive match");c.push({nextTokenType:y.terminalType,nextTokenOccurrence:y.idx,ruleStack:g,occurrenceStack:m}),a=!0}else if(y instanceof x.NonTerminal){b=(0,N.cloneArr)(g),h=(b.push(y.nonTerminalName),(0,N.cloneArr)(m)),v=(h.push(y.idx),{idx:p,def:y.definition.concat(o,(0,N.drop)(f)),ruleStack:b,occurrenceStack:h});d.push(v)}else if(y instanceof x.Option){var E={idx:p,def:(0,N.drop)(f),ruleStack:g,occurrenceStack:m},C=(d.push(E),d.push(s),{idx:p,def:y.definition.concat((0,N.drop)(f)),ruleStack:g,occurrenceStack:m});d.push(C)}else if(y instanceof x.RepetitionMandatory){var w=new x.Repetition({definition:y.definition,idx:y.idx}),S=y.definition.concat([w],(0,N.drop)(f)),v={idx:p,def:S,ruleStack:g,occurrenceStack:m};d.push(v)}else if(y instanceof x.RepetitionMandatoryWithSeparator){var T=new x.Terminal({terminalType:y.separator}),w=new x.Repetition({definition:[T].concat(y.definition),idx:y.idx}),S=y.definition.concat([w],(0,N.drop)(f)),v={idx:p,def:S,ruleStack:g,occurrenceStack:m};d.push(v)}else if(y instanceof x.RepetitionWithSeparator){var E={idx:p,def:(0,N.drop)(f),ruleStack:g,occurrenceStack:m},T=(d.push(E),d.push(s),new x.Terminal({terminalType:y.separator})),R=new x.Repetition({definition:[T].concat(y.definition),idx:y.idx}),S=y.definition.concat([R],(0,N.drop)(f)),C={idx:p,def:S,ruleStack:g,occurrenceStack:m};d.push(C)}else if(y instanceof x.Repetition){E={idx:p,def:(0,N.drop)(f),ruleStack:g,occurrenceStack:m},R=(d.push(E),d.push(s),new x.Repetition({definition:y.definition,idx:y.idx})),S=y.definition.concat([R],(0,N.drop)(f)),C={idx:p,def:S,ruleStack:g,occurrenceStack:m};d.push(C)}else if(y instanceof x.Alternation)for(var A=y.definition.length-1;0<=A;A--){var _=y.definition[A],_={idx:p,def:_.definition.concat((0,N.drop)(f)),ruleStack:g,occurrenceStack:m};d.push(_),d.push(s)}else if(y instanceof x.Flat)d.push({idx:p,def:y.definition.concat((0,N.drop)(f)),ruleStack:g,occurrenceStack:m});else{if(!(y instanceof x.Rule))throw Error("non exhaustive match");d.push(function(e,t,n,r){n=(0,N.cloneArr)(n),n.push(e.name),r=(0,N.cloneArr)(r);return r.push(1),{idx:t,def:e.definition,ruleStack:n,occurrenceStack:r}}(y,p,g,m))}}}}return c},possiblePathsFrom:()=>function t(n,r,i){void 0===i&&(i=[]);i=(0,N.cloneArr)(i);var o=[];var s=0;function a(e){return e.concat((0,N.drop)(n,s+1))}function l(e){e=t(a(e),r,i);return o.concat(e)}for(;i.length<r&&s<n.length;){var e=n[s];if(e instanceof x.Flat)return l(e.definition);if(e instanceof x.NonTerminal)return l(e.definition);if(e instanceof x.Option)o=l(e.definition);else{if(e instanceof x.RepetitionMandatory)return u=e.definition.concat([new x.Repetition({definition:e.definition})]),l(u);if(e instanceof x.RepetitionMandatoryWithSeparator)return u=[new x.Flat({definition:e.definition}),new x.Repetition({definition:[new x.Terminal({terminalType:e.separator})].concat(e.definition)})],l(u);if(e instanceof x.RepetitionWithSeparator){var u=e.definition.concat([new x.Repetition({definition:[new x.Terminal({terminalType:e.separator})].concat(e.definition)})]);o=l(u)}else if(e instanceof x.Repetition){u=e.definition.concat([new x.Repetition({definition:e.definition})]);o=l(u)}else{if(e instanceof x.Alternation)return(0,N.forEach)(e.definition,function(e){o=l(e.definition)}),o;if(!(e instanceof x.Terminal))throw Error("non exhaustive match");i.push(e.terminalType)}}s++}o.push({partialPath:i,suffixDef:(0,N.drop)(n,s)});return o}});var r,i,t=n(19),N=n(17),o=n(29),x=n(20),n=(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=(i=t.RestWalker,n(a,i),a.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=(0,N.cloneArr)(this.path.ruleStack).reverse(),this.occurrenceStack=(0,N.cloneArr)(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},a.prototype.walk=function(e,t){void 0===t&&(t=[]),this.found||i.prototype.walk.call(this,e,t)},a.prototype.walkProdRef=function(e,t,n){e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence&&(t=t.concat(n),this.updateExpectedNext(),this.walk(e.referencedRule,t))},a.prototype.updateExpectedNext=function(){(0,N.isEmpty)(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},a);function a(e,t){var n=i.call(this)||this;return n.topProd=e,n.path=t,n.possibleTokTypes=[],n.nextProductionName="",n.nextProductionOccurrence=0,n.found=!1,n.isAtEndOfPath=!1,n}n(c,l=s),c.prototype.walkTerminal=function(e,t,n){this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found&&(e=t.concat(n),t=new x.Flat({definition:e}),this.possibleTokTypes=(0,o.first)(t),this.found=!0)};var l,u=c;function c(e,t){e=l.call(this,e,t)||this;return e.path=t,e.nextTerminalName="",e.nextTerminalOccurrence=0,e.nextTerminalName=e.path.lastTok.name,e.nextTerminalOccurrence=e.path.lastTokOccurrence,e}d=t.RestWalker,n(f,d),f.prototype.startWalking=function(){return this.walk(this.topRule),this.result};var d,h=f;function f(e,t){var n=d.call(this)||this;return n.topRule=e,n.occurrence=t,n.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},n}n(m,p=h),m.prototype.walkMany=function(e,t,n){var r;e.idx===this.occurrence?(r=(0,N.first)(t.concat(n)),this.result.isEndOfRule=void 0===r,r instanceof x.Terminal&&(this.result.token=r.terminalType,this.result.occurrence=r.idx)):p.prototype.walkMany.call(this,e,t,n)};var p,g=m;function m(){return null!==p&&p.apply(this,arguments)||this}n(b,y=h),b.prototype.walkManySep=function(e,t,n){var r;e.idx===this.occurrence?(r=(0,N.first)(t.concat(n)),this.result.isEndOfRule=void 0===r,r instanceof x.Terminal&&(this.result.token=r.terminalType,this.result.occurrence=r.idx)):y.prototype.walkManySep.call(this,e,t,n)};var y,v=b;function b(){return null!==y&&y.apply(this,arguments)||this}n(w,E=h),w.prototype.walkAtLeastOne=function(e,t,n){var r;e.idx===this.occurrence?(r=(0,N.first)(t.concat(n)),this.result.isEndOfRule=void 0===r,r instanceof x.Terminal&&(this.result.token=r.terminalType,this.result.occurrence=r.idx)):E.prototype.walkAtLeastOne.call(this,e,t,n)};var E,C=w;function w(){return null!==E&&E.apply(this,arguments)||this}n(R,S=h),R.prototype.walkAtLeastOneSep=function(e,t,n){var r;e.idx===this.occurrence?(r=(0,N.first)(t.concat(n)),this.result.isEndOfRule=void 0===r,r instanceof x.Terminal&&(this.result.token=r.terminalType,this.result.occurrence=r.idx)):S.prototype.walkAtLeastOneSep.call(this,e,t,n)};var S,T=R;function R(){return null!==S&&S.apply(this,arguments)||this}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{assignOccurrenceIndices:()=>function(e){(0,r.forEach)(e.rules,function(e){var t=new a.DslMethodsCollectorVisitor;e.accept(t),(0,r.forEach)(t.dslMethods,function(e){(0,r.forEach)(e,function(e,t){e.idx=t+1})})})},resolveGrammar:()=>function(e){e=(0,r.defaults)(e,{errMsgProvider:s.defaultGrammarResolverErrorProvider});var t={};return(0,r.forEach)(e.rules,function(e){t[e.name]=e}),(0,i.resolveGrammar)(t,e.errMsgProvider)},validateGrammar:()=>function(e){return e=(0,r.defaults)(e,{errMsgProvider:s.defaultGrammarValidatorErrorProvider,ignoredIssues:{}}),(0,o.validateGrammar)(e.rules,e.maxLookahead,e.tokenTypes,e.ignoredIssues,e.errMsgProvider,e.grammarName)}});var r=n(17),i=n(40),o=n(36),s=n(35),a=n(30)},(e,t,n)=>{"use strict";n.r(t),n.d(t,{GastRefResolverVisitor:()=>a,resolveGrammar:()=>function(e,t){e=new a(e,t);return e.resolveRefs(),e.errors}});var r,i=n(16),o=n(17),t=n(31),n=(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});s=t.GAstVisitor,n(l,s),l.prototype.resolveRefs=function(){var t=this;(0,o.forEach)((0,o.values)(this.nameToTopRule),function(e){(t.currTopLevel=e).accept(t)})},l.prototype.visitNonTerminal=function(e){var t=this.nameToTopRule[e.nonTerminalName];t?e.referencedRule=t:(t=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e),this.errors.push({message:t,type:i.ParserDefinitionErrorType.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName}))};var s,a=l;function l(e,t){var n=s.call(this)||this;return n.nameToTopRule=e,n.errMsgProvider=t,n.errors=[],n}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{EOF_FOLLOW_KEY:()=>o,IN_RULE_RECOVERY_EXCEPTION:()=>s,InRuleRecoveryException:()=>a,Recoverable:()=>l,attemptInRepetitionRecovery:()=>d});var u=n(21),h=n(17),f=n(42),r=n(32),i=n(16),o={},s="InRuleRecoveryException";function a(e){this.name=s,this.message=e}a.prototype=Error.prototype;c.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=((0,h.has)(e,"recoveryEnabled")?e:i.DEFAULT_PARSER_CONFIG).recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=d)},c.prototype.getTokenToInsert=function(e){e=(0,u.createTokenInstance)(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return e.isInsertedInRecovery=!0,e},c.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},c.prototype.tryInRepetitionRecovery=function(e,t,n,r){for(var i=this,o=this.findReSyncTokenType(),s=this.exportLexerState(),a=[],l=!1,u=this.LA(1),c=this.LA(1),d=function(){var e=i.LA(0),e=i.errorMessageProvider.buildMismatchTokenMessage({expected:r,actual:u,previous:e,ruleName:i.getCurrRuleFullName()}),e=new f.MismatchedTokenException(e,u,i.LA(0));e.resyncedTokens=(0,h.dropRight)(a),i.SAVE_ERROR(e)};!l;){if(this.tokenMatcher(c,r))return void d();if(n.call(this))return d(),void e.apply(this,t);this.tokenMatcher(c,o)?l=!0:(c=this.SKIP_TOKEN(),this.addToResyncTokens(c,a))}this.importLexerState(s)},c.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,n){return!1!==n&&void 0!==e&&void 0!==t&&!this.tokenMatcher(this.LA(1),e)&&!this.isBackTracking()&&!this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t))},c.prototype.getFollowsForInRuleRecovery=function(e,t){e=this.getCurrentGrammarPath(e,t);return this.getNextPossibleTokenTypes(e)},c.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e))return t=this.SKIP_TOKEN(),this.consumeToken(),t;throw new a("sad sad panda")},c.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},c.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var n,r=this;return!!this.canTokenTypeBeInsertedInRecovery(e)&&!(0,h.isEmpty)(t)&&(n=this.LA(1),void 0!==(0,h.find)(t,function(e){return r.tokenMatcher(n,e)}))},c.prototype.canRecoverWithSingleTokenDeletion=function(e){return this.tokenMatcher(this.LA(2),e)},c.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),t=this.getFollowSetFromFollowKey(t);return(0,h.contains)(t,e)},c.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),n=2;;){var r=t.tokenType;if((0,h.contains)(e,r))return r;t=this.LA(n),n++}},c.prototype.getCurrFollowKey=function(){var e,t,n;return 1===this.RULE_STACK.length?o:(e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName(),{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(n)})},c.prototype.buildFullFollowKeyStack=function(){var n=this,r=this.RULE_STACK,i=this.RULE_OCCURRENCE_STACK;return(0,h.isEmpty)(this.LAST_EXPLICIT_RULE_STACK)||(r=(0,h.map)(this.LAST_EXPLICIT_RULE_STACK,function(e){return n.RULE_STACK[e]}),i=(0,h.map)(this.LAST_EXPLICIT_RULE_STACK,function(e){return n.RULE_OCCURRENCE_STACK[e]})),(0,h.map)(r,function(e,t){return 0===t?o:{ruleName:n.shortRuleNameToFullName(e),idxInCallingRule:i[t],inRule:n.shortRuleNameToFullName(r[t-1])}})},c.prototype.flattenFollowSet=function(){var t=this,e=(0,h.map)(this.buildFullFollowKeyStack(),function(e){return t.getFollowSetFromFollowKey(e)});return(0,h.flatten)(e)},c.prototype.getFollowSetFromFollowKey=function(e){return e===o?[u.EOF]:(e=e.ruleName+e.idxInCallingRule+r.IN+e.inRule,this.resyncFollows[e])},c.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,u.EOF)||t.push(e),t},c.prototype.reSyncTo=function(e){for(var t=[],n=this.LA(1);!1===this.tokenMatcher(n,e);)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,t);return(0,h.dropRight)(t)},c.prototype.attemptInRepetitionRecovery=function(e,t,n,r,i,o,s){},c.prototype.getCurrentGrammarPath=function(e,t){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:(0,h.cloneArr)(this.RULE_OCCURRENCE_STACK),lastTok:e,lastTokOccurrence:t}},c.prototype.getHumanReadableRuleStack=function(){var t=this;return(0,h.isEmpty)(this.LAST_EXPLICIT_RULE_STACK)?(0,h.map)(this.RULE_STACK,function(e){return t.shortRuleNameToFullName(e)}):(0,h.map)(this.LAST_EXPLICIT_RULE_STACK,function(e){return t.shortRuleNameToFullName(t.RULE_STACK[e])})};var l=c;function c(){}function d(e,t,n,r,i,o,s){var r=this.getKeyForAutomaticLookahead(r,i),a=this.firstAfterRepMap[r],o=(void 0===a&&(l=this.getCurrRuleFullName(),a=new o(this.getGAstProductions()[l],i).startWalking(),this.firstAfterRepMap[r]=a),a.token),l=a.occurrence,i=a.isEndOfRule;1===this.RULE_STACK.length&&i&&void 0===o&&(o=u.EOF,l=1),this.shouldInRepetitionRecoveryBeTried(o,l,s)&&this.tryInRepetitionRecovery(e,t,n,o)}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{EarlyExitException:()=>h,MismatchedTokenException:()=>u,NoViableAltException:()=>c,NotAllInputParsedException:()=>d,isRecognitionException:()=>function(e){return(0,r.contains)(l,e.name)}});var r=n(17),i="MismatchedTokenException",o="NoViableAltException",s="EarlyExitException",a="NotAllInputParsedException",l=[i,o,s,a];function u(e,t,n){this.name=i,this.message=e,this.token=t,this.previousToken=n,this.resyncedTokens=[]}function c(e,t,n){this.name=o,this.message=e,this.token=t,this.previousToken=n,this.resyncedTokens=[]}function d(e,t){this.name=a,this.message=e,this.token=t,this.resyncedTokens=[]}function h(e,t,n){this.name=s,this.message=e,this.token=t,this.previousToken=n,this.resyncedTokens=[]}Object.freeze(l),u.prototype=Error.prototype,c.prototype=Error.prototype,d.prototype=Error.prototype,h.prototype=Error.prototype},(e,t,n)=>{"use strict";n.r(t),n.d(t,{LooksAhead:()=>i});var l=n(37),u=n(17),r=n(16),c=n(34),d=n(30),i=(o.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=((0,u.has)(e,"dynamicTokensEnabled")?e:r.DEFAULT_PARSER_CONFIG).dynamicTokensEnabled,this.maxLookahead=((0,u.has)(e,"maxLookahead")?e:r.DEFAULT_PARSER_CONFIG).maxLookahead,this.lookAheadFuncsCache=(0,u.isES2015MapSupported)()?new Map:[],(0,u.isES2015MapSupported)()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},o.prototype.preComputeLookaheadFunctions=function(e){var a=this;(0,u.forEach)(e,function(s){a.TRACE_INIT(s.name+" Rule Lookahead",function(){var e=(0,d.collectMethods)(s),t=e.alternation,n=e.repetition,r=e.option,i=e.repetitionMandatory,o=e.repetitionMandatoryWithSeparator,e=e.repetitionWithSeparator;(0,u.forEach)(t,function(n){var e=0===n.idx?"":n.idx;a.TRACE_INIT(""+(0,d.getProductionDslName)(n)+e,function(){var e=(0,l.buildLookaheadFuncForOr)(n.idx,s,n.maxLookahead||a.maxLookahead,n.hasPredicates,a.dynamicTokensEnabled,a.lookAheadBuilderForAlternatives),t=(0,c.getKeyForAutomaticLookahead)(a.fullRuleNameToShort[s.name],c.OR_IDX,n.idx);a.setLaFuncCache(t,e)})}),(0,u.forEach)(n,function(e){a.computeLookaheadFunc(s,e.idx,c.MANY_IDX,l.PROD_TYPE.REPETITION,e.maxLookahead,(0,d.getProductionDslName)(e))}),(0,u.forEach)(r,function(e){a.computeLookaheadFunc(s,e.idx,c.OPTION_IDX,l.PROD_TYPE.OPTION,e.maxLookahead,(0,d.getProductionDslName)(e))}),(0,u.forEach)(i,function(e){a.computeLookaheadFunc(s,e.idx,c.AT_LEAST_ONE_IDX,l.PROD_TYPE.REPETITION_MANDATORY,e.maxLookahead,(0,d.getProductionDslName)(e))}),(0,u.forEach)(o,function(e){a.computeLookaheadFunc(s,e.idx,c.AT_LEAST_ONE_SEP_IDX,l.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,e.maxLookahead,(0,d.getProductionDslName)(e))}),(0,u.forEach)(e,function(e){a.computeLookaheadFunc(s,e.idx,c.MANY_SEP_IDX,l.PROD_TYPE.REPETITION_WITH_SEPARATOR,e.maxLookahead,(0,d.getProductionDslName)(e))})})})},o.prototype.computeLookaheadFunc=function(n,r,i,o,s,e){var a=this;this.TRACE_INIT(""+e+(0===r?"":r),function(){var e=(0,l.buildLookaheadFuncForOptionalProd)(r,n,s||a.maxLookahead,a.dynamicTokensEnabled,o,a.lookAheadBuilderForOptional),t=(0,c.getKeyForAutomaticLookahead)(a.fullRuleNameToShort[n.name],i,r);a.setLaFuncCache(t,e)})},o.prototype.lookAheadBuilderForOptional=function(e,t,n){return(0,l.buildSingleAlternativeLookaheadFunction)(e,t,n)},o.prototype.lookAheadBuilderForAlternatives=function(e,t,n,r){return(0,l.buildAlternativesLookAheadFunc)(e,t,n,r)},o.prototype.getKeyForAutomaticLookahead=function(e,t){var n=this.getLastExplicitRuleShortName();return(0,c.getKeyForAutomaticLookahead)(n,e,t)},o.prototype.getLaFuncFromCache=function(e){},o.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},o.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},o.prototype.setLaFuncCache=function(e,t){},o.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},o.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},o);function o(){}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{TreeBuilder:()=>l});var i=n(33),r=n(17),o=n(45),s=n(34),a=n(16),l=(u.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=((0,r.has)(e,"outputCst")?e:a.DEFAULT_PARSER_CONFIG).outputCst,this.nodeLocationTracking=((0,r.has)(e,"nodeLocationTracking")?e:a.DEFAULT_PARSER_CONFIG).nodeLocationTracking,this.outputCst)if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=i.setNodeLocationFull,this.setNodeLocationFromNode=i.setNodeLocationFull,this.cstPostRule=r.NOOP,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=r.NOOP,this.setNodeLocationFromNode=r.NOOP,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=i.setNodeLocationOnlyOffset,this.setNodeLocationFromNode=i.setNodeLocationOnlyOffset,this.cstPostRule=r.NOOP,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=r.NOOP,this.setNodeLocationFromNode=r.NOOP,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else{if(!/none/i.test(this.nodeLocationTracking))throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"');this.setNodeLocationFromToken=r.NOOP,this.setNodeLocationFromNode=r.NOOP,this.cstPostRule=r.NOOP,this.setInitialNodeLocation=r.NOOP}else this.cstInvocationStateUpdate=r.NOOP,this.cstFinallyStateUpdate=r.NOOP,this.cstPostTerminal=r.NOOP,this.cstPostNonTerminal=r.NOOP,this.cstPostRule=r.NOOP,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst},u.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},u.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},u.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},u.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},u.prototype.cstNestedInvocationStateUpdate=function(e,t){e={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(e),this.CST_STACK.push(e)},u.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);e={name:e,children:{}};this.setInitialNodeLocation(e),this.CST_STACK.push(e)},u.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},u.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},u.prototype.cstPostRuleFull=function(e){var t=this.LA(0),e=e.location;e.startOffset<=t.startOffset==!0?(e.endOffset=t.endOffset,e.endLine=t.endLine,e.endColumn=t.endColumn):(e.startOffset=NaN,e.startLine=NaN,e.startColumn=NaN)},u.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),e=e.location;e.startOffset<=t.startOffset==!0?e.endOffset=t.endOffset:e.startOffset=NaN},u.prototype.cstPostTerminal=function(e,t){var n=this.CST_STACK[this.CST_STACK.length-1];(0,i.addTerminalToCst)(n,t,e),this.setNodeLocationFromToken(n.location,t)},u.prototype.cstPostNonTerminal=function(e,t){var n;!0!==this.isBackTracking()&&(n=this.CST_STACK[this.CST_STACK.length-1],(0,i.addNoneTerminalToCst)(n,t,e),this.setNodeLocationFromNode(n.location,e.location))},u.prototype.getBaseCstVisitorConstructor=function(){var e;return(0,r.isUndefined)(this.baseCstVisitorConstructor)?(e=(0,o.createBaseSemanticVisitorConstructor)(this.className,this.allRuleNames),this.baseCstVisitorConstructor=e):this.baseCstVisitorConstructor},u.prototype.getBaseCstVisitorConstructorWithDefaults=function(){var e;return(0,r.isUndefined)(this.baseCstVisitorWithDefaultsConstructor)?(e=(0,o.createBaseVisitorConstructorWithDefaults)(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor()),this.baseCstVisitorWithDefaultsConstructor=e):this.baseCstVisitorWithDefaultsConstructor},u.prototype.nestedRuleBeforeClause=function(e,t){if(void 0!==e.NAME)return e=e.NAME,this.nestedRuleInvocationStateUpdate(e,t),e},u.prototype.nestedAltBeforeClause=function(e,t,n,r){var i=this.getLastExplicitRuleShortName(),i=(0,s.getKeyForAltIndex)(i,n,t,r);if(void 0!==e.NAME)return n=e.NAME,this.nestedRuleInvocationStateUpdate(n,i),{shortName:i,nestedName:n}},u.prototype.nestedRuleFinallyClause=function(e,t){var n=this.CST_STACK,r=n[n.length-1],n=(this.nestedRuleFinallyStateUpdate(),n[n.length-1]);(0,i.addNoneTerminalToCst)(n,t,r),this.setNodeLocationFromNode(n.location,r.location)},u.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},u.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},u.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},u.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},u.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},u.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},u.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},u.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},u);function u(){}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{CstVisitorDefinitionError:()=>i,createBaseSemanticVisitorConstructor:()=>function(e,t){function n(){}return(0,o.defineNameProp)(n,e+"BaseSemantics"),((n.prototype={visit:function(e,t){if((0,u.isArray)(e)&&(e=e[0]),!(0,u.isUndefined)(e))return void 0!==e.fullName?this[e.fullName](e.children,t):this[e.name](e.children,t)},validateVisitor:function(){var e=r(this,t);if(!(0,u.isEmpty)(e))throw e=(0,u.map)(e,function(e){return e.msg}),Error("Errors Detected in CST Visitor <"+(0,o.functionName)(this.constructor)+">:\n\t"+e.join("\n\n").replace(/\n/g,"\n\t"))}}).constructor=n)._RULE_NAMES=t,n},createBaseVisitorConstructorWithDefaults:()=>function(e,t,n){function r(){}(0,o.defineNameProp)(r,e+"BaseSemanticsWithDefaults");var i=Object.create(n.prototype);return(0,u.forEach)(t,function(e){i[e]=a}),(r.prototype=i).constructor=r},defaultVisit:()=>a,validateMissingCstMethods:()=>l,validateRedundantMethods:()=>d,validateVisitor:()=>r});var i,u=n(17),o=n(46),s=n(36);function a(e,t){for(var n=(0,u.keys)(e),r=n.length,i=0;i<r;i++)for(var o=e[n[i]],s=o.length,a=0;a<s;a++){var l=o[a];void 0===l.tokenTypeIdx&&(void 0!==l.fullName?this[l.fullName](l.children,t):this[l.name](l.children,t))}}function r(e,t){var n=l(e,t),e=d(e,t);return n.concat(e)}function l(t,e){e=(0,u.map)(e,function(e){if(!(0,u.isFunction)(t[e]))return{msg:"Missing visitor method: <"+e+"> on "+(0,o.functionName)(t.constructor)+" CST Visitor.",type:i.MISSING_METHOD,methodName:e}});return(0,u.compact)(e)}(t=i=i||{})[t.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",t[t.MISSING_METHOD=1]="MISSING_METHOD";var c=["constructor","visit","validateVisitor"];function d(e,t){var n,r=[];for(n in e)s.validTermsPattern.test(n)&&(0,u.isFunction)(e[n])&&!(0,u.contains)(c,n)&&!(0,u.contains)(t,n)&&r.push({msg:"Redundant visitor method: <"+n+"> on "+(0,o.functionName)(e.constructor)+" CST Visitor\nThere is no Grammar Rule corresponding to this method's name.\nFor utility methods on visitor classes use methods names that do not match /"+s.validTermsPattern.source+"/.",type:i.REDUNDANT_METHOD,methodName:n});return r}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{classNameFromInstance:()=>function(e){return s(e.constructor)},defineNameProp:()=>function(e,t){var n=Object.getOwnPropertyDescriptor(e,o);if((0,r.isUndefined)(n)||n.configurable)return Object.defineProperty(e,o,{enumerable:!1,configurable:!0,writable:!1,value:t}),!0;return!1},functionName:()=>s});var r=n(17);var i=/^\s*function\s*(\S*)\s*\(/,o="name";function s(e){var t=e.name;return t||e.toString().match(i)[1]}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{LexerAdapter:()=>i});var r=n(16),i=(o.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(o.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),o.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):r.END_OF_FILE},o.prototype.LA=function(e){e=this.currIdx+e;return e<0||this.tokVectorLength<=e?r.END_OF_FILE:this.tokVector[e]},o.prototype.consumeToken=function(){this.currIdx++},o.prototype.exportLexerState=function(){return this.currIdx},o.prototype.importLexerState=function(e){this.currIdx=e},o.prototype.resetLexerState=function(){this.currIdx=-1},o.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},o.prototype.getLexerPosition=function(){return this.exportLexerState()},o);function o(){}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{RecognizerApi:()=>u});var i=n(17),r=n(42),o=n(16),s=n(35),a=n(36),l=n(20),u=(c.prototype.ACTION=function(e){return e.call(this)},c.prototype.consume=function(e,t,n){return this.consumeInternal(t,e,n)},c.prototype.subrule=function(e,t,n){return this.subruleInternal(t,e,n)},c.prototype.option=function(e,t){return this.optionInternal(t,e)},c.prototype.or=function(e,t){return this.orInternal(t,e)},c.prototype.many=function(e,t){return this.manyInternal(e,t)},c.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},c.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},c.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},c.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},c.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},c.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},c.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},c.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},c.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},c.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},c.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},c.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},c.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},c.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},c.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},c.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},c.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},c.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},c.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},c.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},c.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},c.prototype.OPTION=function(e){return this.optionInternal(e,0)},c.prototype.OPTION1=function(e){return this.optionInternal(e,1)},c.prototype.OPTION2=function(e){return this.optionInternal(e,2)},c.prototype.OPTION3=function(e){return this.optionInternal(e,3)},c.prototype.OPTION4=function(e){return this.optionInternal(e,4)},c.prototype.OPTION5=function(e){return this.optionInternal(e,5)},c.prototype.OPTION6=function(e){return this.optionInternal(e,6)},c.prototype.OPTION7=function(e){return this.optionInternal(e,7)},c.prototype.OPTION8=function(e){return this.optionInternal(e,8)},c.prototype.OPTION9=function(e){return this.optionInternal(e,9)},c.prototype.OR=function(e){return this.orInternal(e,0)},c.prototype.OR1=function(e){return this.orInternal(e,1)},c.prototype.OR2=function(e){return this.orInternal(e,2)},c.prototype.OR3=function(e){return this.orInternal(e,3)},c.prototype.OR4=function(e){return this.orInternal(e,4)},c.prototype.OR5=function(e){return this.orInternal(e,5)},c.prototype.OR6=function(e){return this.orInternal(e,6)},c.prototype.OR7=function(e){return this.orInternal(e,7)},c.prototype.OR8=function(e){return this.orInternal(e,8)},c.prototype.OR9=function(e){return this.orInternal(e,9)},c.prototype.MANY=function(e){this.manyInternal(0,e)},c.prototype.MANY1=function(e){this.manyInternal(1,e)},c.prototype.MANY2=function(e){this.manyInternal(2,e)},c.prototype.MANY3=function(e){this.manyInternal(3,e)},c.prototype.MANY4=function(e){this.manyInternal(4,e)},c.prototype.MANY5=function(e){this.manyInternal(5,e)},c.prototype.MANY6=function(e){this.manyInternal(6,e)},c.prototype.MANY7=function(e){this.manyInternal(7,e)},c.prototype.MANY8=function(e){this.manyInternal(8,e)},c.prototype.MANY9=function(e){this.manyInternal(9,e)},c.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},c.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},c.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},c.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},c.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},c.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},c.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},c.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},c.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},c.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},c.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},c.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},c.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},c.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},c.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},c.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},c.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},c.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},c.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},c.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},c.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},c.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},c.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},c.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},c.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},c.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},c.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},c.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},c.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},c.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},c.prototype.RULE=function(e,t,n){void 0===n&&(n=o.DEFAULT_RULE_CONFIG),(0,i.contains)(this.definedRulesNames,e)&&(r={message:s.defaultGrammarValidatorErrorProvider.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:o.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:e},this.definitionErrors.push(r)),this.definedRulesNames.push(e);var r=this.defineRule(e,t,n);return this[e]=r},c.prototype.OVERRIDE_RULE=function(e,t,n){void 0===n&&(n=o.DEFAULT_RULE_CONFIG);var r=(r=[]).concat((0,a.validateRuleIsOverridden)(e,this.definedRulesNames,this.className)),r=(this.definitionErrors.push.apply(this.definitionErrors,r),this.defineRule(e,t,n));return this[e]=r},c.prototype.BACKTRACK=function(t,n){return function(){this.isBackTrackingStack.push(1);var e=this.saveRecogState();try{return t.apply(this,n),!0}catch(e){if((0,r.isRecognitionException)(e))return!1;throw e}finally{this.reloadRecogState(e),this.isBackTrackingStack.pop()}}},c.prototype.getGAstProductions=function(){return this.gastProductionsCache},c.prototype.getSerializedGastProductions=function(){return(0,l.serializeGrammar)((0,i.values)(this.gastProductionsCache))},c);function c(){}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{RecognizerEngine:()=>f});var l=n(17),u=n(34),s=n(42),c=n(37),d=n(38),a=n(16),r=n(41),i=n(21),o=n(27),h=n(46),f=(p.prototype.initRecognizerEngine=function(e,t){if(this.className=(0,h.classNameFromInstance)(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=o.tokenStructuredMatcherNoCategories,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},(0,l.has)(t,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0\n\tFor Further details.");if((0,l.isArray)(e)){if((0,l.isEmpty)(e))throw Error("A Token Vocabulary cannot be empty.\n\tNote that the first argument for the parser constructor\n\tis no longer a Token vector (since v4.0).");if("number"==typeof e[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0\n\tFor Further details.")}if((0,l.isArray)(e))this.tokensMap=(0,l.reduce)(e,function(e,t){return e[t.name]=t,e},{});else if((0,l.has)(e,"modes")&&(0,l.every)((0,l.flatten)((0,l.values)(e.modes)),o.isTokenType)){t=(0,l.flatten)((0,l.values)(e.modes)),t=(0,l.uniq)(t);this.tokensMap=(0,l.reduce)(t,function(e,t){return e[t.name]=t,e},{})}else{if(!(0,l.isObject)(e))throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap=(0,l.cloneObj)(e)}this.tokensMap.EOF=i.EOF;t=(0,l.every)((0,l.values)(e),function(e){return(0,l.isEmpty)(e.categoryMatches)});this.tokenMatcher=t?o.tokenStructuredMatcherNoCategories:o.tokenStructuredMatcher,(0,o.augmentTokenTypes)((0,l.values)(this.tokensMap))},p.prototype.defineRule=function(n,r,e){if(this.selfAnalysisDone)throw Error("Grammar rule <"+n+"> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var i=((0,l.has)(e,"resyncEnabled")?e:a.DEFAULT_RULE_CONFIG).resyncEnabled,o=((0,l.has)(e,"recoveryValueFunc")?e:a.DEFAULT_RULE_CONFIG).recoveryValueFunc,s=this.ruleShortNameIdx<<u.BITS_FOR_METHOD_TYPE+u.BITS_FOR_OCCURRENCE_IDX;this.ruleShortNameIdx++,this.shortRuleNameToFull[s]=n,this.fullRuleNameToShort[n]=s;return(e=function(e,t){return this.ruleInvocationStateUpdate(s,n,e=void 0===e?0:e),function(e){try{var t;return!0===this.outputCst?(r.apply(this,e),t=this.CST_STACK[this.CST_STACK.length-1],this.cstPostRule(t),t):r.apply(this,e)}catch(e){return this.invokeRuleCatch(e,i,o)}finally{this.ruleFinallyStateUpdate()}}.call(this,t)}).ruleName=n,e.originalGrammarAction=r,e},p.prototype.invokeRuleCatch=function(e,t,n){var r=1===this.RULE_STACK.length,t=t&&!this.isBackTracking()&&this.recoveryEnabled;if((0,s.isRecognitionException)(e)){var i=e;if(t){var o,t=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(t))return i.resyncedTokens=this.reSyncTo(t),this.outputCst?((o=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,o):n();this.outputCst&&((o=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,i.partialCstResult=o)}else if(r)return this.moveToTerminatedState(),n();throw i}throw e},p.prototype.optionInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(u.OPTION_IDX,t),r=this.nestedRuleBeforeClause(e,n);try{return this.optionInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},p.prototype.optionInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(u.OPTION_IDX,t);return this.optionInternalLogic(e,t,n)},p.prototype.optionInternalLogic=function(e,t,n){var r,i,o,s=this,n=this.getLaFuncFromCache(n);if(void 0!==e.DEF?(i=e.DEF,void 0!==(o=e.GATE)&&(r=n,n=function(){return o.call(s)&&r.call(s)})):i=e,!0===n.call(this))return i.call(this)},p.prototype.atLeastOneInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(u.AT_LEAST_ONE_IDX,e),r=this.nestedRuleBeforeClause(t,n);try{return this.atLeastOneInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},p.prototype.atLeastOneInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(u.AT_LEAST_ONE_IDX,e);this.atLeastOneInternalLogic(e,t,n)},p.prototype.atLeastOneInternalLogic=function(e,t,n){var r,i,o,s=this,a=this.getLaFuncFromCache(n);if(void 0!==t.DEF?(i=t.DEF,void 0!==(o=t.GATE)&&(r=a,a=function(){return o.call(s)&&r.call(s)})):i=t,!0!==a.call(this))throw this.raiseEarlyExitException(e,c.PROD_TYPE.REPETITION_MANDATORY,t.ERR_MSG);for(var l=this.doSingleRepetition(i);!0===a.call(this)&&!0===l;)l=this.doSingleRepetition(i);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],a,u.AT_LEAST_ONE_IDX,e,d.NextTerminalAfterAtLeastOneWalker)},p.prototype.atLeastOneSepFirstInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(u.AT_LEAST_ONE_SEP_IDX,e),r=this.nestedRuleBeforeClause(t,n);try{this.atLeastOneSepFirstInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},p.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(u.AT_LEAST_ONE_SEP_IDX,e);this.atLeastOneSepFirstInternalLogic(e,t,n)},p.prototype.atLeastOneSepFirstInternalLogic=function(e,t,n){var r=this,i=t.DEF,o=t.SEP;if(!0!==this.getLaFuncFromCache(n).call(this))throw this.raiseEarlyExitException(e,c.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG);i.call(this);for(n=function(){return r.tokenMatcher(r.LA(1),o)};!0===this.tokenMatcher(this.LA(1),o);)this.CONSUME(o),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,n,i,d.NextTerminalAfterAtLeastOneSepWalker],n,u.AT_LEAST_ONE_SEP_IDX,e,d.NextTerminalAfterAtLeastOneSepWalker)},p.prototype.manyInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(u.MANY_IDX,e),r=this.nestedRuleBeforeClause(t,n);try{return this.manyInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},p.prototype.manyInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(u.MANY_IDX,e);return this.manyInternalLogic(e,t,n)},p.prototype.manyInternalLogic=function(e,t,n){for(var r,i,o,s=this,a=this.getLaFuncFromCache(n),l=(void 0!==t.DEF?(i=t.DEF,void 0!==(o=t.GATE)&&(r=a,a=function(){return o.call(s)&&r.call(s)})):i=t,!0);!0===a.call(this)&&!0===l;)l=this.doSingleRepetition(i);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],a,u.MANY_IDX,e,d.NextTerminalAfterManyWalker,l)},p.prototype.manySepFirstInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(u.MANY_SEP_IDX,e),r=this.nestedRuleBeforeClause(t,n);try{this.manySepFirstInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},p.prototype.manySepFirstInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(u.MANY_SEP_IDX,e);this.manySepFirstInternalLogic(e,t,n)},p.prototype.manySepFirstInternalLogic=function(e,t,n){var r=this,i=t.DEF,o=t.SEP;if(!0===this.getLaFuncFromCache(n).call(this)){i.call(this);for(t=function(){return r.tokenMatcher(r.LA(1),o)};!0===this.tokenMatcher(this.LA(1),o);)this.CONSUME(o),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,t,i,d.NextTerminalAfterManySepWalker],t,u.MANY_SEP_IDX,e,d.NextTerminalAfterManySepWalker)}},p.prototype.repetitionSepSecondInternal=function(e,t,n,r,i){for(;n();)this.CONSUME(t),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,n,r,i],n,u.AT_LEAST_ONE_SEP_IDX,e,i)},p.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();return e.call(this),t<this.getLexerPosition()},p.prototype.orInternalNoCst=function(e,t){var n=(0,l.isArray)(e)?e:e.DEF,r=this.getKeyForAutomaticLookahead(u.OR_IDX,t),r=this.getLaFuncFromCache(r).call(this,n);if(void 0!==r)return n[r].ALT.call(this);this.raiseNoAltException(t,e.ERR_MSG)},p.prototype.orInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(u.OR_IDX,t),r=this.nestedRuleBeforeClause(e,n);try{var i=(0,l.isArray)(e)?e:e.DEF,o=this.getLaFuncFromCache(n).call(this,i);if(void 0!==o){var s=i[o],a=this.nestedAltBeforeClause(s,t,u.OR_IDX,o);try{return s.ALT.call(this)}finally{void 0!==a&&this.nestedRuleFinallyClause(a.shortName,a.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},p.prototype.ruleFinallyStateUpdate=function(){var e,t;this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()&&(e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new s.NotAllInputParsedException(t,e)))},p.prototype.subruleInternal=function(t,e,n){try{var r=void 0!==n?n.ARGS:void 0,i=t.call(this,e,r);return this.cstPostNonTerminal(i,void 0!==n&&void 0!==n.LABEL?n.LABEL:t.ruleName),i}catch(e){this.subruleInternalError(e,n,t.ruleName)}},p.prototype.subruleInternalError=function(e,t,n){throw(0,s.isRecognitionException)(e)&&void 0!==e.partialCstResult&&(this.cstPostNonTerminal(e.partialCstResult,void 0!==t&&void 0!==t.LABEL?t.LABEL:n),delete e.partialCstResult),e},p.prototype.consumeInternal=function(t,n,e){var r;try{var i=this.LA(1);!0===this.tokenMatcher(i,t)?(this.consumeToken(),r=i):this.consumeInternalError(t,i,e)}catch(e){r=this.consumeInternalRecovery(t,n,e)}return this.cstPostTerminal(void 0!==e&&void 0!==e.LABEL?e.LABEL:t.name,r),r},p.prototype.consumeInternalError=function(e,t,n){var r=this.LA(0),n=void 0!==n&&n.ERR_MSG?n.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:r,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new s.MismatchedTokenException(n,t,r))},p.prototype.consumeInternalRecovery=function(e,t,n){if(!this.recoveryEnabled||"MismatchedTokenException"!==n.name||this.isBackTracking())throw n;t=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,t)}catch(e){throw e.name===r.IN_RULE_RECOVERY_EXCEPTION?n:e}},p.prototype.saveRecogState=function(){var e=this.errors,t=(0,l.cloneArr)(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},p.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},p.prototype.ruleInvocationStateUpdate=function(e,t,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},p.prototype.isBackTracking=function(){return 0!==this.isBackTrackingStack.length},p.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},p.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},p.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),i.EOF)},p.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},p);function p(){}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ErrorHandler:()=>o});var a=n(42),r=n(17),l=n(37),i=n(16),o=(s.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=(0,r.defaults)(e.errorMessageProvider,i.DEFAULT_PARSER_CONFIG.errorMessageProvider)},s.prototype.SAVE_ERROR=function(e){if((0,a.isRecognitionException)(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:(0,r.cloneArr)(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(s.prototype,"errors",{get:function(){return(0,r.cloneArr)(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),s.prototype.raiseEarlyExitException=function(e,t,n){for(var r=this.getCurrRuleFullName(),i=this.getGAstProductions()[r],e=(0,l.getLookaheadPathsForOptionalProd)(e,i,t,this.maxLookahead)[0],o=[],s=1;s<=this.maxLookahead;s++)o.push(this.LA(s));i=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:e,actual:o,previous:this.LA(0),customUserDescription:n,ruleName:r});throw this.SAVE_ERROR(new a.EarlyExitException(i,this.LA(1),this.LA(0)))},s.prototype.raiseNoAltException=function(e,t){for(var n=this.getCurrRuleFullName(),n=this.getGAstProductions()[n],e=(0,l.getLookaheadPathsForOr)(e,n,this.maxLookahead),r=[],i=1;i<=this.maxLookahead;i++)r.push(this.LA(i));n=this.LA(0),e=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:e,actual:r,previous:n,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new a.NoViableAltException(e,this.LA(1),n))},s);function s(){}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ContentAssist:()=>o});var r=n(38),i=n(17),o=(s.prototype.initContentAssist=function(){},s.prototype.computeContentAssist=function(e,t){var n=this.gastProductionsCache[e];if((0,i.isUndefined)(n))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return(0,r.nextPossibleTokensAfter)([n],t,this.tokenMatcher,this.maxLookahead)},s.prototype.getNextPossibleTokenTypes=function(e){var t=(0,i.first)(e.ruleStack),t=this.getGAstProductions()[t];return new r.NextAfterTokenWalker(t,e).startWalking()},s);function s(){}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{GastRecorder:()=>h});var a=n(17),l=n(20),t=n(22),o=n(27),r=n(21),i=n(16),n=n(34),u={description:"This Object indicates the Parser is during Recording Phase"},s=(Object.freeze(u),Math.pow(2,n.BITS_FOR_OCCURRENCE_IDX)-1),n=(0,r.createToken)({name:"RECORDING_PHASE_TOKEN",pattern:t.Lexer.NA}),c=((0,o.augmentTokenTypes)([n]),(0,r.createTokenInstance)(n,"This IToken indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1)),d=(Object.freeze(c),{name:"This CSTNode indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",children:{}}),h=(f.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},f.prototype.enableRecording=function(){var t=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var e=0;e<10;e++)!function(n){var e=0<n?n:"";t["CONSUME"+e]=function(e,t){return this.consumeInternalRecord(e,n,t)},t["SUBRULE"+e]=function(e,t){return this.subruleInternalRecord(e,n,t)},t["OPTION"+e]=function(e){return this.optionInternalRecord(e,n)},t["OR"+e]=function(e){return this.orInternalRecord(e,n)},t["MANY"+e]=function(e){this.manyInternalRecord(n,e)},t["MANY_SEP"+e]=function(e){this.manySepFirstInternalRecord(n,e)},t["AT_LEAST_ONE"+e]=function(e){this.atLeastOneInternalRecord(n,e)},t["AT_LEAST_ONE_SEP"+e]=function(e){this.atLeastOneSepFirstInternalRecord(n,e)}}(e);t.consume=function(e,t,n){return this.consumeInternalRecord(t,e,n)},t.subrule=function(e,t,n){return this.subruleInternalRecord(t,e,n)},t.option=function(e,t){return this.optionInternalRecord(t,e)},t.or=function(e,t){return this.orInternalRecord(t,e)},t.many=function(e,t){this.manyInternalRecord(e,t)},t.atLeastOne=function(e,t){this.atLeastOneInternalRecord(e,t)},t.ACTION=t.ACTION_RECORD,t.BACKTRACK=t.BACKTRACK_RECORD,t.LA=t.LA_RECORD})},f.prototype.disableRecording=function(){var n=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var e=0;e<10;e++){var t=0<e?e:"";delete n["CONSUME"+t],delete n["SUBRULE"+t],delete n["OPTION"+t],delete n["OR"+t],delete n["MANY"+t],delete n["MANY_SEP"+t],delete n["AT_LEAST_ONE"+t],delete n["AT_LEAST_ONE_SEP"+t]}delete n.consume,delete n.subrule,delete n.option,delete n.or,delete n.many,delete n.atLeastOne,delete n.ACTION,delete n.BACKTRACK,delete n.LA})},f.prototype.ACTION_RECORD=function(e){},f.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},f.prototype.LA_RECORD=function(e){return i.END_OF_FILE},f.prototype.topLevelRuleRecord=function(e,t){try{var n=new l.Rule({definition:[],name:e});return n.name=e,this.recordingProdStack.push(n),t.call(this),this.recordingProdStack.pop(),n}catch(e){if(!0!==e.KNOWN_RECORDER_ERROR)try{e.message=e.message+'\n\t This error was thrown during the "grammar recording phase" For more info see:\n\thttps://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording'}catch(e){}throw e}},f.prototype.optionInternalRecord=function(e,t){return p.call(this,l.Option,e,t)},f.prototype.atLeastOneInternalRecord=function(e,t){p.call(this,l.RepetitionMandatory,t,e)},f.prototype.atLeastOneSepFirstInternalRecord=function(e,t){p.call(this,l.RepetitionMandatoryWithSeparator,t,e,!0)},f.prototype.manyInternalRecord=function(e,t){p.call(this,l.Repetition,t,e)},f.prototype.manySepFirstInternalRecord=function(e,t){p.call(this,l.RepetitionWithSeparator,t,e,!0)},f.prototype.orInternalRecord=function(e,t){return function(e,t){var n=this,r=(m(t),(0,a.peek)(this.recordingProdStack)),i=!1===(0,a.isArray)(e),o=!1==i?e:e.DEF,s=new l.Alternation({definition:[],idx:t,ignoreAmbiguities:i&&!0===e.IGNORE_AMBIGUITIES});(0,a.has)(e,"NAME")&&(s.name=e.NAME);(0,a.has)(e,"MAX_LOOKAHEAD")&&(s.maxLookahead=e.MAX_LOOKAHEAD);t=(0,a.some)(o,function(e){return(0,a.isFunction)(e.GATE)});return s.hasPredicates=t,r.definition.push(s),(0,a.forEach)(o,function(e){var t=new l.Flat({definition:[]});s.definition.push(t),(0,a.has)(e,"NAME")&&(t.name=e.NAME),(0,a.has)(e,"IGNORE_AMBIGUITIES")?t.ignoreAmbiguities=e.IGNORE_AMBIGUITIES:(0,a.has)(e,"GATE")&&(t.ignoreAmbiguities=!0),n.recordingProdStack.push(t),e.ALT.call(n),n.recordingProdStack.pop()}),u}.call(this,e,t)},f.prototype.subruleInternalRecord=function(e,t,n){var r,i;if(m(t),e&&!1!==(0,a.has)(e,"ruleName"))return r=(0,a.peek)(this.recordingProdStack),i=e.ruleName,i=new l.NonTerminal({idx:t,nonTerminalName:i,referencedRule:void 0}),r.definition.push(i),this.outputCst?d:u;throw(r=new Error("<SUBRULE"+g(t)+"> argument is invalid expecting a Parser method reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">")).KNOWN_RECORDER_ERROR=!0,r},f.prototype.consumeInternalRecord=function(e,t,n){var r,i;if(m(t),(0,o.hasShortKeyProperty)(e))return r=(0,a.peek)(this.recordingProdStack),i=new l.Terminal({idx:t,terminalType:e}),r.definition.push(i),c;throw(r=new Error("<CONSUME"+g(t)+"> argument is invalid expecting a TokenType reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">")).KNOWN_RECORDER_ERROR=!0,r},f);function f(){}function p(e,t,n,r){void 0===r&&(r=!1),m(n);var i=(0,a.peek)(this.recordingProdStack),o=(0,a.isFunction)(t)?t:t.DEF,e=new e({definition:[],idx:n});return(0,a.has)(t,"NAME")&&(e.name=t.NAME),r&&(e.separator=t.SEP),(0,a.has)(t,"MAX_LOOKAHEAD")&&(e.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(e),o.call(this),i.definition.push(e),this.recordingProdStack.pop(),u}function g(e){return 0===e?"":""+e}function m(e){if(e<0||s<e)throw(e=new Error("Invalid DSL Method idx value: <"+e+">\n\tIdx value must be a none negative value smaller than "+(s+1))).KNOWN_RECORDER_ERROR=!0,e}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{PerformanceTracer:()=>i});var s=n(17),r=n(16),i=(o.prototype.initPerformanceTracer=function(e){var t;(0,s.has)(e,"traceInitPerf")?(e=e.traceInitPerf,this.traceInitMaxIdent=(t="number"==typeof e)?e:1/0,this.traceInitPerf=t?0<e:e):(this.traceInitMaxIdent=0,this.traceInitPerf=r.DEFAULT_PARSER_CONFIG.traceInitPerf),this.traceInitIndent=-1},o.prototype.TRACE_INIT=function(e,t){var n,r,i,o;return!0===this.traceInitPerf?(this.traceInitIndent++,n=new Array(this.traceInitIndent+1).join("\t"),this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--\x3e <"+e+">"),r=(i=(0,s.timer)(t)).time,i=i.value,o=10<r?console.warn:console.log,this.traceInitIndent<this.traceInitMaxIdent&&o(n+"<-- <"+e+"> time: "+r+"ms"),this.traceInitIndent--,i):t()},o);function o(){}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{createSyntaxDiagramsCode:()=>function(e,t){var t=void 0===t?{}:t,n=t.resourceBase,n=void 0===n?"https://unpkg.com/chevrotain@"+r.VERSION+"/diagrams/":n,t=t.css,t=void 0===t?"https://unpkg.com/chevrotain@"+r.VERSION+"/diagrams/diagrams.css":t,t="\n<link rel='stylesheet' href='"+t+"'>\n",n="\n<script src='"+n+"vendor/railroad-diagrams.js'><\/script>\n<script src='"+n+"src/diagrams_builder.js'><\/script>\n<script src='"+n+"src/diagrams_behavior.js'><\/script>\n<script src='"+n+"src/main.js'><\/script>\n",e="\n<script>\n    window.serializedGrammar = "+JSON.stringify(e,null,"  ")+";\n<\/script>\n";return'\n\x3c!-- This is a generated file --\x3e\n<!DOCTYPE html>\n<meta charset="utf-8">\n<style>\n  body {\n    background-color: hsl(30, 20%, 95%)\n  }\n</style>\n\n'+t+n+'\n<div id="diagrams" align="center"></div>    \n'+e+'\n<script>\n    var diagramsDiv = document.getElementById("diagrams");\n    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);\n<\/script>\n'}});var r=n(15)},(e,t,r)=>{"use strict";r.r(t),r.d(t,{generateParserFactory:()=>function(t){var e=(0,i.genWrapperFunction)({name:t.name,rules:t.rules}),n=new Function("tokenVocabulary","config","chevrotain",e);return function(e){return n(t.tokenVocabulary,e,r(14))}},generateParserModule:()=>function(e){return(0,i.genUmdModule)({name:e.name,rules:e.rules})}});var i=r(56)},(e,t,n)=>{"use strict";n.r(t),n.d(t,{genAllRules:()=>a,genAlternation:()=>d,genClass:()=>s,genNonTerminal:()=>c,genRule:()=>l,genSingleAlt:()=>h,genTerminal:()=>u,genUmdModule:()=>function(e){return"\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['chevrotain'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory(require('chevrotain'));\n    } else {\n        // Browser globals (root is window)\n        root.returnExports = factory(root.b);\n    }\n}(typeof self !== 'undefined' ? self : this, function (chevrotain) {\n\n"+s(e)+"\n    \nreturn {\n    "+e.name+": "+e.name+" \n}\n}));\n"},genWrapperFunction:()=>function(e){return"    \n"+s(e)+"\nreturn new "+e.name+"(tokenVocabulary, config)    \n"}});var r=n(17),i=n(20),o="\n";function s(e){return"\nfunction "+e.name+"(tokenVocabulary, config) {\n    // invoke super constructor\n    // No support for embedded actions currently, so we can 'hardcode'\n    // The use of CstParser.\n    chevrotain.CstParser.call(this, tokenVocabulary, config)\n\n    const $ = this\n\n    "+a(e.rules)+"\n\n    // very important to call this after all the rules have been defined.\n    // otherwise the parser may not work correctly as it will lack information\n    // derived during the self analysis phase.\n    this.performSelfAnalysis(this)\n}\n\n// inheritance as implemented in javascript in the previous decade... :(\n"+e.name+".prototype = Object.create(chevrotain.CstParser.prototype)\n"+e.name+".prototype.constructor = "+e.name+"    \n    "}function a(e){return(0,r.map)(e,function(e){return l(e,1)}).join("\n")}function l(e,t){var n=m(t,'$.RULE("'+e.name+'", function() {')+o;return(n+=g(e.definition,t+1))+(m(t+1,"})")+o)}function u(e,t){var n=e.terminalType.name;return m(t,"$.CONSUME"+e.idx+"(this.tokensMap."+n+")"+o)}function c(e,t){return m(t,"$.SUBRULE"+e.idx+"($."+e.nonTerminalName+")"+o)}function d(e,t){var n=m(t,"$.OR"+e.idx+"([")+o;return(n+=(0,r.map)(e.definition,function(e){return h(e,t+1)}).join(","+o))+(o+m(t,"])"+o))}function h(e,t){var n=m(t,"{")+o;return e.name&&(n+=m(t+1,'NAME: "'+e.name+'",')+o),n=(n=(n=(n+=m(t+1,"ALT: function() {")+o)+g(e.definition,t+1))+(m(t+1,"}")+o))+m(t,"}")}function f(e,t,n){e=m(n,"$."+(e+t.idx)+"(");return t.name||t.separator?(e+="{"+o,t.name&&(e+=m(n+1,'NAME: "'+t.name+'"')+","+o),t.separator&&(e+=m(n+1,"SEP: this.tokensMap."+t.separator.name)+","+o),e=(e+="DEF: "+p(t.definition,n+2)+o)+(m(n,"}")+o)):e+=p(t.definition,n+1),e+=m(n,")")+o}function p(e,t){var n="function() {"+o;return(n+=g(e,t))+(m(t,"}")+o)}function g(e,t){var n="";return(0,r.forEach)(e,function(e){n+=function(e,t){if(e instanceof i.NonTerminal)return c(e,t);if(e instanceof i.Option)return f("OPTION",e,t);if(e instanceof i.RepetitionMandatory)return f("AT_LEAST_ONE",e,t);if(e instanceof i.RepetitionMandatoryWithSeparator)return f("AT_LEAST_ONE_SEP",e,t);if(e instanceof i.RepetitionWithSeparator)return f("MANY_SEP",e,t);if(e instanceof i.Repetition)return f("MANY",e,t);if(e instanceof i.Alternation)return d(e,t);if(e instanceof i.Terminal)return u(e,t);if(e instanceof i.Flat)return g(e.definition,t);throw Error("non exhaustive match")}(e,t+1)}),n}function m(e,t){return Array(4*e+1).join(" ")+t}},(P,e,t)=>{"use strict";t.r(e),t.d(e,{AstNodeType:()=>o,ParsingErrorType:()=>n,RangeSheetReferenceType:()=>r,buildArrayAst:()=>O,buildCellErrorAst:()=>k,buildCellRangeAst:()=>d,buildCellReferenceAst:()=>c,buildColumnRangeAst:()=>h,buildConcatenateOpAst:()=>p,buildDivOpAst:()=>T,buildEmptyArgAst:()=>a,buildEqualsOpAst:()=>g,buildErrorWithRawInputAst:()=>D,buildGreaterThanOpAst:()=>y,buildGreaterThanOrEqualOpAst:()=>b,buildLessThanOpAst:()=>v,buildLessThanOrEqualOpAst:()=>E,buildMinusOpAst:()=>w,buildMinusUnaryOpAst:()=>A,buildNamedExpressionAst:()=>I,buildNotEqualOpAst:()=>m,buildNumberAst:()=>l,buildParenthesisAst:()=>M,buildParsingErrorAst:()=>F,buildPercentOpAst:()=>N,buildPlusOpAst:()=>C,buildPlusUnaryOpAst:()=>_,buildPowerOpAst:()=>R,buildProcedureAst:()=>x,buildRowRangeAst:()=>f,buildStringAst:()=>u,buildTimesOpAst:()=>S,imageWithWhitespace:()=>function(e,t){return(null!=t?t:"")+e},parsingError:()=>s});var n,o,r,i=t(3);const s=(e,t)=>({type:e,message:t}),a=((e=n=n||{}).LexingError="LexingError",e.ParserError="ParsingError",e.StaticOffsetError="StaticOffsetError",e.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",e.RangeOffsetNotAllowed="RangeOffsetNotAllowed",(t=o=o||{}).EMPTY="EMPTY",t.NUMBER="NUMBER",t.STRING="STRING",t.MINUS_UNARY_OP="MINUS_UNARY_OP",t.PLUS_UNARY_OP="PLUS_UNARY_OP",t.PERCENT_OP="PERCENT_OP",t.CONCATENATE_OP="CONCATENATE_OP",t.EQUALS_OP="EQUALS_OP",t.NOT_EQUAL_OP="NOT_EQUAL_OP",t.GREATER_THAN_OP="GREATER_THAN_OP",t.LESS_THAN_OP="LESS_THAN_OP",t.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",t.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",t.PLUS_OP="PLUS_OP",t.MINUS_OP="MINUS_OP",t.TIMES_OP="TIMES_OP",t.DIV_OP="DIV_OP",t.POWER_OP="POWER_OP",t.FUNCTION_CALL="FUNCTION_CALL",t.NAMED_EXPRESSION="NAMED_EXPRESSION",t.PARENTHESIS="PARENTHESES",t.CELL_REFERENCE="CELL_REFERENCE",t.CELL_RANGE="CELL_RANGE",t.COLUMN_RANGE="COLUMN_RANGE",t.ROW_RANGE="ROW_RANGE",t.ERROR="ERROR",t.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",t.ARRAY="ARRAY",(e=r=r||{})[e.RELATIVE=0]="RELATIVE",e[e.START_ABSOLUTE=1]="START_ABSOLUTE",e[e.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE",e=>({type:o.EMPTY,leadingWhitespace:null==e?void 0:e.image})),l=(e,t)=>({type:o.NUMBER,value:e,leadingWhitespace:null==t?void 0:t.image}),u=e=>{return{type:o.STRING,value:e.image.slice(1,-1),leadingWhitespace:null==(e=e.leadingWhitespace)?void 0:e.image}},c=(e,t)=>({type:o.CELL_REFERENCE,reference:e,leadingWhitespace:null==t?void 0:t.image}),d=(e,t,n,r)=>(L(e,t,n),{type:o.CELL_RANGE,start:e,end:t,sheetReferenceType:n,leadingWhitespace:r}),h=(e,t,n,r)=>(L(e,t,n),{type:o.COLUMN_RANGE,start:e,end:t,sheetReferenceType:n,leadingWhitespace:null==r?void 0:r.image}),f=(e,t,n,r)=>(L(e,t,n),{type:o.ROW_RANGE,start:e,end:t,sheetReferenceType:n,leadingWhitespace:null==r?void 0:r.image}),p=(e,t,n)=>({type:o.CONCATENATE_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}),g=(e,t,n)=>({type:o.EQUALS_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}),m=(e,t,n)=>({type:o.NOT_EQUAL_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}),y=(e,t,n)=>({type:o.GREATER_THAN_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}),v=(e,t,n)=>({type:o.LESS_THAN_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}),b=(e,t,n)=>({type:o.GREATER_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}),E=(e,t,n)=>({type:o.LESS_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}),C=(e,t,n)=>({type:o.PLUS_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}),w=(e,t,n)=>({type:o.MINUS_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}),S=(e,t,n)=>({type:o.TIMES_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}),T=(e,t,n)=>({type:o.DIV_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}),R=(e,t,n)=>({type:o.POWER_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}),A=(e,t)=>({type:o.MINUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}),_=(e,t)=>({type:o.PLUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}),N=(e,t)=>({type:o.PERCENT_OP,value:e,leadingWhitespace:null==t?void 0:t.image}),x=(e,t,n,r,i)=>({type:o.FUNCTION_CALL,procedureName:e,args:t,leadingWhitespace:null==n?void 0:n.image,internalWhitespace:null==r?void 0:r.image,hyperlink:i}),O=(e,t,n)=>({type:o.ARRAY,args:e,leadingWhitespace:null==t?void 0:t.image,internalWhitespace:null==n?void 0:n.image}),I=(e,t)=>({type:o.NAMED_EXPRESSION,expressionName:e,leadingWhitespace:null==t?void 0:t.image}),M=(e,t,n)=>({type:o.PARENTHESIS,expression:e,leadingWhitespace:null==t?void 0:t.image,internalWhitespace:null==n?void 0:n.image}),k=(e,t)=>({type:o.ERROR,error:e,leadingWhitespace:null==t?void 0:t.image}),D=(e,t,n)=>({type:o.ERROR_WITH_RAW_INPUT,error:t,rawInput:e,leadingWhitespace:null==n?void 0:n.image}),F=()=>({type:o.ERROR,error:i.CellError.parsingError()});function L(e,t,n){if(void 0!==e.sheet&&void 0===t.sheet||void 0===e.sheet&&void 0!==t.sheet)throw new Error("Start address inconsistent with end address");if(void 0===e.sheet&&n!==r.RELATIVE||void 0!==e.sheet&&n===r.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{binaryOpTokenMap:()=>r});t=n(57);const r={[t.AstNodeType.PLUS_OP]:"+",[t.AstNodeType.MINUS_OP]:"-",[t.AstNodeType.TIMES_OP]:"*",[t.AstNodeType.DIV_OP]:"/",[t.AstNodeType.CONCATENATE_OP]:"&",[t.AstNodeType.POWER_OP]:"^",[t.AstNodeType.EQUALS_OP]:"=",[t.AstNodeType.NOT_EQUAL_OP]:"<>",[t.AstNodeType.GREATER_THAN_OP]:">",[t.AstNodeType.GREATER_THAN_OR_EQUAL_OP]:">=",[t.AstNodeType.LESS_THAN_OP]:"<",[t.AstNodeType.LESS_THAN_OR_EQUAL_OP]:"<="}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Cache:()=>i,doesContainFunctions:()=>o});var r=n(7);class i{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,t){t={ast:t,relativeDependencies:(0,r.collectDependencies)(t,this.functionRegistry),hasVolatileFunction:o(t,this.functionRegistry.isFunctionVolatile),hasStructuralChangeFunction:o(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange)};return this.cache.set(e,t),t}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,t){var n=this.cache.get(e);return void 0!==n?n.ast:(this.set(e,t),t)}}const o=(e,t)=>{switch(e.type){case r.AstNodeType.EMPTY:case r.AstNodeType.NUMBER:case r.AstNodeType.STRING:case r.AstNodeType.ERROR:case r.AstNodeType.ERROR_WITH_RAW_INPUT:case r.AstNodeType.CELL_REFERENCE:case r.AstNodeType.CELL_RANGE:case r.AstNodeType.COLUMN_RANGE:case r.AstNodeType.ROW_RANGE:case r.AstNodeType.NAMED_EXPRESSION:return!1;case r.AstNodeType.PERCENT_OP:case r.AstNodeType.PLUS_UNARY_OP:case r.AstNodeType.MINUS_UNARY_OP:return o(e.value,t);case r.AstNodeType.CONCATENATE_OP:case r.AstNodeType.EQUALS_OP:case r.AstNodeType.NOT_EQUAL_OP:case r.AstNodeType.LESS_THAN_OP:case r.AstNodeType.GREATER_THAN_OP:case r.AstNodeType.LESS_THAN_OR_EQUAL_OP:case r.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case r.AstNodeType.MINUS_OP:case r.AstNodeType.PLUS_OP:case r.AstNodeType.TIMES_OP:case r.AstNodeType.DIV_OP:case r.AstNodeType.POWER_OP:return o(e.left,t)||o(e.right,t);case r.AstNodeType.PARENTHESIS:return o(e.expression,t);case r.AstNodeType.FUNCTION_CALL:return!!t(e.procedureName)||e.args.some(e=>o(e,t));case r.AstNodeType.ARRAY:return e.args.some(e=>e.some(e=>o(e,t)))}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{FormulaLexer:()=>i,FormulaParser:()=>l});var r=n(14),u=n(3),c=n(61),s=n(8),d=n(57),h=n(9),a=n(62);class l extends r.EmbeddedActionsParser{constructor(e,t){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",()=>this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:(0,r.EMPTY_ALT)((0,d.buildEmptyArgAst)())}])),this.procedureExpression=this.RULE("procedureExpression",()=>{var e=this.CONSUME(a.ProcedureName),t=e.image.toUpperCase().slice(0,-1),n=null!=(n=this.lexerConfig.functionMapping[t])?n:t;const r=[];let i=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY(()=>{var e=this.CONSUME(this.lexerConfig.ArgSeparator);i.type===d.AstNodeType.EMPTY&&(i.leadingWhitespace=null==(e=e.leadingWhitespace)?void 0:e.image),r.push(i),i=this.SUBRULE2(this.booleanExpressionOrEmpty)}),r.push(i),1===r.length&&r[0].type===d.AstNodeType.EMPTY&&(r.length=0);t=this.CONSUME(a.RParen);return(0,d.buildProcedureAst)(n,r,e.leadingWhitespace,t.leadingWhitespace)}),this.namedExpressionExpression=this.RULE("namedExpressionExpression",()=>{var e=this.CONSUME(a.NamedExpression);return(0,d.buildNamedExpressionAst)(e.image,e.leadingWhitespace)}),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",()=>{const e=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(a.LParen),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{e.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(a.RParen),this.handleOffsetHeuristic(e)}),this.columnRangeExpression=this.RULE("columnRangeExpression",()=>{var e=this.CONSUME(a.ColumnRange);const[t,n]=e.image.split(":");var r,i=this.ACTION(()=>(0,s.columnAddressFromString)(this.sheetMapping,t,this.formulaAddress)),o=this.ACTION(()=>(0,s.columnAddressFromString)(this.sheetMapping,n,this.formulaAddress));return void 0===i||void 0===o?(0,d.buildCellErrorAst)(new u.CellError(u.ErrorType.REF)):i.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||o.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)?(0,d.buildErrorWithRawInputAst)(e.image,new u.CellError(u.ErrorType.NAME),e.leadingWhitespace):void 0===i.sheet&&void 0!==o.sheet?this.parsingError(d.ParsingErrorType.ParserError,"Malformed range expression"):({firstEnd:i,secondEnd:o,sheetRefType:r}=l.fixSheetIdsForRangeEnds(i,o),(0,d.buildColumnRangeAst)(i,o,r,e.leadingWhitespace))}),this.rowRangeExpression=this.RULE("rowRangeExpression",()=>{var e=this.CONSUME(a.RowRange);const[t,n]=e.image.split(":");var r,i=this.ACTION(()=>(0,s.rowAddressFromString)(this.sheetMapping,t,this.formulaAddress)),o=this.ACTION(()=>(0,s.rowAddressFromString)(this.sheetMapping,n,this.formulaAddress));return void 0===i||void 0===o?(0,d.buildCellErrorAst)(new u.CellError(u.ErrorType.REF)):i.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||o.exceedsSheetSizeLimits(this.lexerConfig.maxRows)?(0,d.buildErrorWithRawInputAst)(e.image,new u.CellError(u.ErrorType.NAME),e.leadingWhitespace):void 0===i.sheet&&void 0!==o.sheet?this.parsingError(d.ParsingErrorType.ParserError,"Malformed range expression"):({firstEnd:i,secondEnd:o,sheetRefType:r}=l.fixSheetIdsForRangeEnds(i,o),(0,d.buildRowRangeAst)(i,o,r,e.leadingWhitespace))}),this.cellReference=this.RULE("cellReference",()=>{const e=this.CONSUME(a.CellReference);var t=this.ACTION(()=>(0,s.cellAddressFromString)(this.sheetMapping,e.image,this.formulaAddress));return void 0===t?(0,d.buildErrorWithRawInputAst)(e.image,new u.CellError(u.ErrorType.REF),e.leadingWhitespace):t.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?(0,d.buildErrorWithRawInputAst)(e.image,new u.CellError(u.ErrorType.NAME),e.leadingWhitespace):(0,d.buildCellReferenceAst)(t,e.leadingWhitespace)}),this.endRangeReference=this.RULE("endRangeReference",e=>{const t=this.CONSUME(a.CellReference);var n=this.ACTION(()=>(0,s.cellAddressFromString)(this.sheetMapping,e.image,this.formulaAddress)),r=this.ACTION(()=>(0,s.cellAddressFromString)(this.sheetMapping,t.image,this.formulaAddress));return void 0===n||void 0===r?this.ACTION(()=>(0,d.buildErrorWithRawInputAst)(e.image+":"+t.image,new u.CellError(u.ErrorType.REF),e.leadingWhitespace)):n.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||r.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION(()=>(0,d.buildErrorWithRawInputAst)(e.image+":"+t.image,new u.CellError(u.ErrorType.NAME),e.leadingWhitespace)):this.buildCellRange(n,r,null==(n=e.leadingWhitespace)?void 0:n.image)}),this.endOfRangeExpression=this.RULE("endOfRangeExpression",n=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[n]})},{ALT:()=>{var e=this.SUBRULE(this.offsetProcedureExpression),t=this.ACTION(()=>(0,s.cellAddressFromString)(this.sheetMapping,n.image,this.formulaAddress));return void 0===t?(0,d.buildCellErrorAst)(new u.CellError(u.ErrorType.REF)):e.type===d.AstNodeType.CELL_REFERENCE?this.buildCellRange(t,e.reference,null==(t=n.leadingWhitespace)?void 0:t.image):this.parsingError(d.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.cellRangeExpression=this.RULE("cellRangeExpression",()=>{var e=this.CONSUME(a.CellReference);return this.CONSUME2(a.RangeSeparator),this.SUBRULE(this.endOfRangeExpression,{ARGS:[e]})}),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",e=>{const t=this.CONSUME(a.CellReference);var n=this.ACTION(()=>(0,s.cellAddressFromString)(this.sheetMapping,t.image,this.formulaAddress));return void 0===n?this.ACTION(()=>(0,d.buildCellErrorAst)(new u.CellError(u.ErrorType.REF))):this.buildCellRange(e.reference,n,e.leadingWhitespace)}),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",t=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[t]})},{ALT:()=>{var e=this.SUBRULE(this.offsetProcedureExpression);return e.type===d.AstNodeType.CELL_REFERENCE?this.buildCellRange(t.reference,e.reference,t.leadingWhitespace):this.parsingError(d.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.offsetExpression=this.RULE("offsetExpression",()=>{const e=this.SUBRULE(this.offsetProcedureExpression);let t;return this.OPTION(()=>{this.CONSUME(a.RangeSeparator),t=e.type===d.AstNodeType.CELL_RANGE?this.parsingError(d.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here"):this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[e]})}),void 0!==t?t:e}),this.insideArrayExpression=this.RULE("insideArrayExpression",()=>{const e=[[]];return e[e.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY(()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),e[e.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),e.push([]),e[e.length-1].push(this.SUBRULE3(this.booleanExpression))}}])}),(0,d.buildArrayAst)(e)}),this.parenthesisExpression=this.RULE("parenthesisExpression",()=>{var e=this.CONSUME(a.LParen),t=this.SUBRULE(this.booleanExpression),n=this.CONSUME(a.RParen);return(0,d.buildParenthesisAst)(t,e.leadingWhitespace,n.leadingWhitespace)}),this.arrayExpression=this.RULE("arrayExpression",()=>this.OR([{ALT:()=>{var e=this.CONSUME(a.ArrayLParen),t=this.SUBRULE(this.insideArrayExpression),n=this.CONSUME(a.ArrayRParen);return(0,d.buildArrayAst)(t.args,e.leadingWhitespace,n.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}])),this.numericStringToNumber=e=>{e=e.replace(this.lexerConfig.decimalSeparator,".");return Number(e)},this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",()=>{var e;return this.OR(null!=(e=this.atomicExpCache)?e:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{var e=this.CONSUME(this.lexerConfig.NumberLiteral);return(0,d.buildNumberAst)(this.numericStringToNumber(e.image),e.leadingWhitespace)}},{ALT:()=>{var e=this.CONSUME(a.StringLiteral);return(0,d.buildStringAst)(e)}},{ALT:()=>{var e=this.CONSUME(a.ErrorLiteral),t=e.image.toUpperCase(),t=this.lexerConfig.errorMapping[t];return t?(0,d.buildCellErrorAst)(new u.CellError(t),e.leadingWhitespace):this.parsingError(d.ParsingErrorType.ParserError,"Unknown error literal")}}])}),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",()=>{var e=this.SUBRULE(this.positiveAtomicExpression),t=this.OPTION(()=>this.CONSUME(a.PercentOp));return t?(0,d.buildPercentOpAst)(e,t.leadingWhitespace):e}),this.atomicExpression=this.RULE("atomicExpression",()=>this.OR([{ALT:()=>{var e=this.CONSUME(a.AdditionOp),t=this.SUBRULE(this.atomicExpression);return(0,r.tokenMatcher)(e,a.PlusOp)?(0,d.buildPlusUnaryOpAst)(t,e.leadingWhitespace):(0,r.tokenMatcher)(e,a.MinusOp)?(0,d.buildMinusUnaryOpAst)(t,e.leadingWhitespace):(this.customParsingError=(0,d.parsingError)(d.ParsingErrorType.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}])),this.powerExpression=this.RULE("powerExpression",()=>{let n=this.SUBRULE(this.atomicExpression);return this.MANY(()=>{var e=this.CONSUME(a.PowerOp),t=this.SUBRULE2(this.atomicExpression);(0,r.tokenMatcher)(e,a.PowerOp)?n=(0,d.buildPowerOpAst)(n,t,e.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.multiplicationExpression=this.RULE("multiplicationExpression",()=>{let n=this.SUBRULE(this.powerExpression);return this.MANY(()=>{var e=this.CONSUME(a.MultiplicationOp),t=this.SUBRULE2(this.powerExpression);(0,r.tokenMatcher)(e,a.TimesOp)?n=(0,d.buildTimesOpAst)(n,t,e.leadingWhitespace):(0,r.tokenMatcher)(e,a.DivOp)?n=(0,d.buildDivOpAst)(n,t,e.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.additionExpression=this.RULE("additionExpression",()=>{let n=this.SUBRULE(this.multiplicationExpression);return this.MANY(()=>{var e=this.CONSUME(a.AdditionOp),t=this.SUBRULE2(this.multiplicationExpression);(0,r.tokenMatcher)(e,a.PlusOp)?n=(0,d.buildPlusOpAst)(n,t,e.leadingWhitespace):(0,r.tokenMatcher)(e,a.MinusOp)?n=(0,d.buildMinusOpAst)(n,t,e.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.concatenateExpression=this.RULE("concatenateExpression",()=>{let n=this.SUBRULE(this.additionExpression);return this.MANY(()=>{var e=this.CONSUME(a.ConcatenateOp),t=this.SUBRULE2(this.additionExpression);n=(0,d.buildConcatenateOpAst)(n,t,e.leadingWhitespace)}),n}),this.booleanExpression=this.RULE("booleanExpression",()=>{let n=this.SUBRULE(this.concatenateExpression);return this.MANY(()=>{var e=this.CONSUME(a.BooleanOp),t=this.SUBRULE2(this.concatenateExpression);(0,r.tokenMatcher)(e,a.EqualsOp)?n=(0,d.buildEqualsOpAst)(n,t,e.leadingWhitespace):(0,r.tokenMatcher)(e,a.NotEqualOp)?n=(0,d.buildNotEqualOpAst)(n,t,e.leadingWhitespace):(0,r.tokenMatcher)(e,a.GreaterThanOp)?n=(0,d.buildGreaterThanOpAst)(n,t,e.leadingWhitespace):(0,r.tokenMatcher)(e,a.LessThanOp)?n=(0,d.buildLessThanOpAst)(n,t,e.leadingWhitespace):(0,r.tokenMatcher)(e,a.GreaterThanOrEqualOp)?n=(0,d.buildGreaterThanOrEqualOpAst)(n,t,e.leadingWhitespace):(0,r.tokenMatcher)(e,a.LessThanOrEqualOp)?n=(0,d.buildLessThanOrEqualOpAst)(n,t,e.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.formula=this.RULE("formula",()=>(this.CONSUME(a.EqualsOp),this.SUBRULE(this.booleanExpression))),this.lexerConfig=e,this.sheetMapping=t,this.formulaAddress=(0,u.simpleCellAddress)(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,t){this.input=e;let n=this.formulaWithContext(t),r=[];return this.customParsingError&&r.push(this.customParsingError),r=r.concat(this.errors.map(e=>({type:d.ParsingErrorType.ParserError,message:e.message}))),{ast:n=0<r.length?(0,d.buildParsingErrorAst)():n,errors:r}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,t,n){var r;return void 0===e.sheet&&void 0!==t.sheet?this.parsingError(d.ParsingErrorType.ParserError,"Malformed range expression"):({firstEnd:e,secondEnd:t,sheetRefType:r}=l.fixSheetIdsForRangeEnds(e,t),(0,d.buildCellRangeAst)(e,t,r,n))}static fixSheetIdsForRangeEnds(e,t){var n=l.rangeSheetReferenceType(e.sheet,t.sheet);return{firstEnd:e,secondEnd:void 0!==e.sheet&&void 0===t.sheet?t.withSheet(e.sheet):t,sheetRefType:n}}handleOffsetHeuristic(e){var t=e[0];if(t.type!==d.AstNodeType.CELL_REFERENCE)return this.parsingError(d.ParsingErrorType.StaticOffsetError,"First argument to OFFSET is not a reference");var n=e[1];let r;if(n.type===d.AstNodeType.NUMBER&&Number.isInteger(n.value))r=n.value;else if(n.type===d.AstNodeType.PLUS_UNARY_OP&&n.value.type===d.AstNodeType.NUMBER&&Number.isInteger(n.value.value))r=n.value.value;else{if(n.type!==d.AstNodeType.MINUS_UNARY_OP||n.value.type!==d.AstNodeType.NUMBER||!Number.isInteger(n.value.value))return this.parsingError(d.ParsingErrorType.StaticOffsetError,"Second argument to OFFSET is not a static number");r=-n.value.value}n=e[2];let i;if(n.type===d.AstNodeType.NUMBER&&Number.isInteger(n.value))i=n.value;else if(n.type===d.AstNodeType.PLUS_UNARY_OP&&n.value.type===d.AstNodeType.NUMBER&&Number.isInteger(n.value.value))i=n.value.value;else{if(n.type!==d.AstNodeType.MINUS_UNARY_OP||n.value.type!==d.AstNodeType.NUMBER||!Number.isInteger(n.value.value))return this.parsingError(d.ParsingErrorType.StaticOffsetError,"Third argument to OFFSET is not a static number");i=-n.value.value}n=e[3];let o;if(void 0===n)o=1;else{if(n.type!==d.AstNodeType.NUMBER)return this.parsingError(d.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is not a static number");if((o=n.value)<1)return this.parsingError(d.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(o))return this.parsingError(d.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is not integer")}n=e[4];let s;if(void 0===n)s=1;else{if(n.type!==d.AstNodeType.NUMBER)return this.parsingError(d.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is not a static number");if((s=n.value)<1)return this.parsingError(d.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(s))return this.parsingError(d.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is not integer")}e=new h.CellAddress(t.reference.col+i,t.reference.row+r,t.reference.type);let a=e.col,l=e.row;return t.reference.type!==h.CellReferenceType.CELL_REFERENCE_RELATIVE&&t.reference.type!==h.CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL||(l+=this.formulaAddress.row),t.reference.type!==h.CellReferenceType.CELL_REFERENCE_RELATIVE&&t.reference.type!==h.CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW||(a+=this.formulaAddress.col),a<0||l<0?(0,d.buildCellErrorAst)(new u.CellError(u.ErrorType.REF,c.ErrorMessage.OutOfSheet)):1===s&&1===o?(0,d.buildCellReferenceAst)(e):(n=new h.CellAddress(e.col+s-1,e.row+o-1,e.type),(0,d.buildCellRangeAst)(e,n,d.RangeSheetReferenceType.RELATIVE))}parsingError(e,t){return this.customParsingError=(0,d.parsingError)(e,t),(0,d.buildParsingErrorAst)()}static rangeSheetReferenceType(e,t){return void 0===e?d.RangeSheetReferenceType.RELATIVE:void 0===t?d.RangeSheetReferenceType.START_ABSOLUTE:d.RangeSheetReferenceType.BOTH_ABSOLUTE}}class i{constructor(e){this.lexerConfig=e,this.lexer=new r.Lexer(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){var e=this.lexer.tokenize(e),t=e.tokens,t=this.trimTrailingWhitespaces(t);return t=this.skipWhitespacesInsideRanges(t),t=this.skipWhitespacesBeforeArgSeparators(t),e.tokens=t,e}skipWhitespacesInsideRanges(e){return i.filterTokensByNeighbors(e,(e,t,n)=>((0,r.tokenMatcher)(e,a.CellReference)||(0,r.tokenMatcher)(e,a.RangeSeparator))&&(0,r.tokenMatcher)(t,this.lexerConfig.WhiteSpace)&&((0,r.tokenMatcher)(n,a.CellReference)||(0,r.tokenMatcher)(n,a.RangeSeparator)))}skipWhitespacesBeforeArgSeparators(e){return i.filterTokensByNeighbors(e,(e,t,n)=>!(0,r.tokenMatcher)(e,this.lexerConfig.ArgSeparator)&&(0,r.tokenMatcher)(t,this.lexerConfig.WhiteSpace)&&(0,r.tokenMatcher)(n,this.lexerConfig.ArgSeparator))}static filterTokensByNeighbors(e,t){if(e.length<3)return e;let n=0;for(var r=[e[n++]];n<e.length-1;)t(e[n-1],e[n],e[n+1])||r.push(e[n]),++n;return r.push(e[n]),r}trimTrailingWhitespaces(e){return 0<e.length&&(0,r.tokenMatcher)(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ErrorMessage:()=>r});class r{}r.DistinctSigns="Distinct signs.",r.WrongArgNumber="Wrong number of arguments.",r.EmptyArg="Empty function argument.",r.EmptyArray="Empty array not allowed.",r.ArrayDimensions="Array dimensions are not compatible.",r.NoSpaceForArrayResult="No space for array result.",r.ValueSmall="Value too small.",r.ValueLarge="Value too large.",r.BadCriterion="Incorrect criterion.",r.RangeManySheets="Range spans more than one sheet.",r.CellRangeExpected="Cell range expected.",r.WrongDimension="Wrong range dimension.",r.ScalarExpected="Cell range not allowed.",r.NumberCoercion="Value cannot be coerced to number.",r.NumberExpected="Number argument expected.",r.IntegerExpected="Value needs to be an integer.",r.BadMode="Mode not recognized.",r.DateBounds="Date outside of bounds.",r.OutOfSheet="Resulting reference is out of the sheet.",r.WrongType="Wrong type of argument.",r.NaN="NaN or infinite value encountered.",r.EqualLength="Ranges need to be of equal length.",r.Negative="Value cannot be negative.",r.NotBinary="String does not represent a binary number.",r.NotOctal="String does not represent an octal number.",r.NotHex="String does not represent a hexadecimal number.",r.EndStartPeriod="End period needs to be at least start period.",r.CellRefExpected="Cell reference expected.",r.EmptyRange="Empty range not allowed.",r.BadRef="Address is not correct.",r.NumberRange="Number-only range expected.",r.ValueNotFound="Value not found.",r.ValueBaseLarge="Value in base too large.",r.ValueBaseSmall="Value in base too small.",r.ValueBaseLong="Value in base too long.",r.NegativeLength="Length cannot be negative.",r.PatternNotFound="Pattern not found.",r.OneValue="Needs at least one value.",r.TwoValues="Range needs to contain at least two elements.",r.ThreeValues="Range needs to contain at least three elements.",r.IndexBounds="Index out of bounds.",r.IndexLarge="Index too large.",r.Formula="Expected formula.",r.NegativeCount="Count cannot be negative.",r.ParseError="Parsing error.",r.SheetRef="Sheet does not exist.",r.PeriodLong="Period number cannot exceed life length.",r.InvalidDate="Invalid date.",r.BitshiftLong="Result of bitshift is too long.",r.EmptyString="Empty-string argument not allowed.",r.LengthBounds="Length out of bounds.",r.NegativeTime="Time cannot be negative.",r.NoDefault="No default option.",r.NoConditionMet="None of the conditions were met.",r.Selector="Selector cannot exceed the number of arguments.",r.StartEndDate="Start date needs to be earlier than end date.",r.IncorrectDateTime="String does not represent correct DateTime.",r.CharacterCodeBounds="Character code out of bounds.",r.NonZero="Argument cannot be 0.",r.LessThanOne="Argument cannot be less than 1.",r.WeekendString="Incorrect weekend bitmask string.",r.InvalidRoman="Invalid roman numeral.",r.WrongOrder="Wrong order of values.",r.ComplexNumberExpected="Complex number expected.",r.ShouldBeIorJ="Should be 'i' or 'j'.",r.SizeMismatch="Array dimensions mismatched.",r.FunctionName=e=>`Function name ${e} not recognized.`,r.NamedExpressionName=e=>`Named expression ${e} not recognized.`,r.LicenseKey=e=>`License key is ${e}.`},(e,t,n)=>{"use strict";n.r(t),n.d(t,{AdditionOp:()=>f,ArrayLParen:()=>I,ArrayRParen:()=>M,BooleanOp:()=>C,CellReference:()=>H,ColumnRange:()=>P,ConcatenateOp:()=>N,DivOp:()=>v,EqualsOp:()=>w,ErrorLiteral:()=>D,GreaterThanOp:()=>T,GreaterThanOrEqualOp:()=>A,LParen:()=>x,LessThanOp:()=>R,LessThanOrEqualOp:()=>_,MinusOp:()=>g,MultiplicationOp:()=>m,NamedExpression:()=>U,NotEqualOp:()=>S,PercentOp:()=>E,PlusOp:()=>p,PowerOp:()=>b,ProcedureName:()=>B,RParen:()=>O,RangeSeparator:()=>L,RowRange:()=>F,StringLiteral:()=>k,TimesOp:()=>y,buildLexerConfig:()=>r});var d=n(14),h=n(12),t=n(63),n=n(64);const f=(0,d.createToken)({name:"AdditionOp",pattern:d.Lexer.NA}),p=(0,d.createToken)({name:"PlusOp",pattern:/\+/,categories:f}),g=(0,d.createToken)({name:"MinusOp",pattern:/-/,categories:f}),m=(0,d.createToken)({name:"MultiplicationOp",pattern:d.Lexer.NA}),y=(0,d.createToken)({name:"TimesOp",pattern:/\*/,categories:m}),v=(0,d.createToken)({name:"DivOp",pattern:/\//,categories:m}),b=(0,d.createToken)({name:"PowerOp",pattern:/\^/}),E=(0,d.createToken)({name:"PercentOp",pattern:/%/}),C=(0,d.createToken)({name:"BooleanOp",pattern:d.Lexer.NA}),w=(0,d.createToken)({name:"EqualsOp",pattern:/=/,categories:C}),S=(0,d.createToken)({name:"NotEqualOp",pattern:/<>/,categories:C}),T=(0,d.createToken)({name:"GreaterThanOp",pattern:/>/,categories:C}),R=(0,d.createToken)({name:"LessThanOp",pattern:/</,categories:C}),A=(0,d.createToken)({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:C}),_=(0,d.createToken)({name:"LessThanOrEqualOp",pattern:/<=/,categories:C}),N=(0,d.createToken)({name:"ConcatenateOp",pattern:/&/}),x=(0,d.createToken)({name:"LParen",pattern:/\(/}),O=(0,d.createToken)({name:"RParen",pattern:/\)/}),I=(0,d.createToken)({name:"ArrayLParen",pattern:/{/}),M=(0,d.createToken)({name:"ArrayRParen",pattern:/}/}),k=(0,d.createToken)({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),D=(0,d.createToken)({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),L=(0,d.createToken)({name:"RangeSeparator",pattern:new RegExp(h.RANGE_OPERATOR)}),P=(0,d.createToken)({name:"ColumnRange",pattern:new RegExp(""+h.COLUMN_REFERENCE_PATTERN+h.RANGE_OPERATOR+h.COLUMN_REFERENCE_PATTERN)}),F=(0,d.createToken)({name:"RowRange",pattern:new RegExp(""+h.ROW_REFERENCE_PATTERN+h.RANGE_OPERATOR+h.ROW_REFERENCE_PATTERN)}),B=(0,d.createToken)({name:"ProcedureName",pattern:new RegExp(`([${h.UNICODE_LETTER_PATTERN}][${h.NON_RESERVED_CHARACTER_PATTERN}]*)\\(`)});t=new t.CellReferenceMatcher;const H=(0,d.createToken)({name:"CellReference",pattern:t.match.bind(t),start_chars_hint:t.POSSIBLE_START_CHARACTERS,line_breaks:!1});t=new n.NamedExpressionMatcher;const U=(0,d.createToken)({name:"NamedExpression",pattern:t.match.bind(t),start_chars_hint:t.POSSIBLE_START_CHARACTERS,line_breaks:!1}),r=e=>{var t=e.translationPackage.getFunctionTranslation("OFFSET"),n=e.errorMapping,r=e.translationPackage.buildFunctionMapping(),i=new RegExp("standard"===e.ignoreWhiteSpace?h.ODFF_WHITESPACE_PATTERN:h.ALL_WHITESPACE_PATTERN),i=(0,d.createToken)({name:"WhiteSpace",pattern:i}),o=(0,d.createToken)({name:"ArrayRowSep",pattern:e.arrayRowSeparator}),s=(0,d.createToken)({name:"ArrayColSep",pattern:e.arrayColumnSeparator}),a=(0,d.createToken)({name:"NumberLiteral",pattern:new RegExp(`(([${e.decimalSeparator}]\\d+)|(\\d+([${e.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),t=(0,d.createToken)({name:"OffsetProcedureName",pattern:new RegExp(t,"i")});let l,u;u=e.functionArgSeparator===e.arrayColumnSeparator?(l=s,[]):e.functionArgSeparator===e.arrayRowSeparator?(l=o,[]):[l=(0,d.createToken)({name:"ArgSeparator",pattern:e.functionArgSeparator})];var c=[i,p,g,y,v,b,w,S,E,A,_,T,R,x,O,I,M,t,B,L,...u,P,F,a,k,D,N,C,f,m,H,U,o,s];return{ArgSeparator:l,NumberLiteral:a,OffsetProcedureName:t,ArrayRowSeparator:o,ArrayColSeparator:s,WhiteSpace:i,allTokens:c,errorMapping:n,functionMapping:r,decimalSeparator:e.decimalSeparator,maxColumns:e.maxColumns,maxRows:e.maxRows}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{CellReferenceMatcher:()=>i});var r=n(12);class i{constructor(){this.POSSIBLE_START_CHARACTERS=[...r.ALL_UNICODE_LETTERS_ARRAY,...r.ALL_DIGITS_ARRAY,r.ABSOLUTE_OPERATOR,"'","_"],this.cellReferenceRegexp=new RegExp(r.CELL_REFERENCE_WITH_NEXT_CHARACTER_PATTERN,"y")}match(e,t){this.cellReferenceRegexp.lastIndex=t;t=this.cellReferenceRegexp.exec(e+"@");return null==t||null==t[1]?null:(t[0]=t[1],t)}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{NamedExpressionMatcher:()=>i});var r=n(12);class i{constructor(){this.POSSIBLE_START_CHARACTERS=[...r.ALL_UNICODE_LETTERS_ARRAY,"_"],this.namedExpressionRegexp=new RegExp(r.NAMED_EXPRESSION_PATTERN,"y"),this.r1c1CellRefRegexp=new RegExp(`^${r.R1C1_CELL_REFERENCE_PATTERN}$`)}match(e,t){this.namedExpressionRegexp.lastIndex=t;t=this.namedExpressionRegexp.exec(e);return null==t||null==t[0]||this.r1c1CellRefRegexp.test(t[0])?null:t}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Unparser:()=>l,formatNumber:()=>u});var o=n(3),r=n(0),i=n(8),s=n(57),a=n(58);class l{constructor(e,t,n,r){this.config=e,this.lexerConfig=t,this.sheetMappingFn=n,this.namedExpressions=r}unparse(e,t){return"="+this.unparseAst(e,t)}unparseAst(t,n){switch(t.type){case s.AstNodeType.EMPTY:return(0,s.imageWithWhitespace)("",t.leadingWhitespace);case s.AstNodeType.NUMBER:return(0,s.imageWithWhitespace)(u(t.value,this.config.decimalSeparator),t.leadingWhitespace);case s.AstNodeType.STRING:return(0,s.imageWithWhitespace)('"'+t.value+'"',t.leadingWhitespace);case s.AstNodeType.FUNCTION_CALL:var r=t.args.map(e=>void 0!==e?this.unparseAst(e,n):"").join(this.config.functionArgSeparator),r=(this.config.translationPackage.isFunctionTranslated(t.procedureName)?this.config.translationPackage.getFunctionTranslation(t.procedureName):t.procedureName)+"("+r+(0,s.imageWithWhitespace)(")",t.internalWhitespace);return(0,s.imageWithWhitespace)(r,t.leadingWhitespace);case s.AstNodeType.NAMED_EXPRESSION:r=null==(r=this.namedExpressions.nearestNamedExpression(t.expressionName,n.sheet))?void 0:r.displayName;return(0,s.imageWithWhitespace)(r||t.expressionName,t.leadingWhitespace);case s.AstNodeType.CELL_REFERENCE:{let e;return e=void 0!==t.reference.sheet?this.unparseSheetName(t.reference.sheet)+"!":"",e+=null!=(r=t.reference.unparse(n))?r:this.config.translationPackage.getErrorTranslation(o.ErrorType.REF),(0,s.imageWithWhitespace)(e,t.leadingWhitespace)}case s.AstNodeType.COLUMN_RANGE:case s.AstNodeType.ROW_RANGE:case s.AstNodeType.CELL_RANGE:return(0,s.imageWithWhitespace)(this.formatRange(t,n),t.leadingWhitespace);case s.AstNodeType.PLUS_UNARY_OP:r=this.unparseAst(t.value,n);return(0,s.imageWithWhitespace)("+",t.leadingWhitespace)+r;case s.AstNodeType.MINUS_UNARY_OP:r=this.unparseAst(t.value,n);return(0,s.imageWithWhitespace)("-",t.leadingWhitespace)+r;case s.AstNodeType.PERCENT_OP:return this.unparseAst(t.value,n)+(0,s.imageWithWhitespace)("%",t.leadingWhitespace);case s.AstNodeType.ERROR:r=this.config.translationPackage.getErrorTranslation(t.error?t.error.type:o.ErrorType.ERROR);return(0,s.imageWithWhitespace)(r,t.leadingWhitespace);case s.AstNodeType.ERROR_WITH_RAW_INPUT:return(0,s.imageWithWhitespace)(t.rawInput,t.leadingWhitespace);case s.AstNodeType.PARENTHESIS:r="("+this.unparseAst(t.expression,n)+(0,s.imageWithWhitespace)(")",t.internalWhitespace);return(0,s.imageWithWhitespace)(r,t.leadingWhitespace);case s.AstNodeType.ARRAY:r="{"+t.args.map(e=>e.map(e=>this.unparseAst(e,n)).join(this.config.arrayColumnSeparator)).join(this.config.arrayRowSeparator)+(0,s.imageWithWhitespace)("}",t.internalWhitespace);return(0,s.imageWithWhitespace)(r,t.leadingWhitespace);default:var r=this.unparseAst(t.left,n),e=this.unparseAst(t.right,n);return r+(0,s.imageWithWhitespace)(a.binaryOpTokenMap[t.type],t.leadingWhitespace)+e}}unparseSheetName(e){var t=(0,i.sheetIndexToString)(e,this.sheetMappingFn);if(void 0===t)throw new r.NoSheetWithIdError(e);return t}formatRange(e,t){let n="",r="";void 0!==e.start.sheet&&e.sheetReferenceType!==s.RangeSheetReferenceType.RELATIVE&&(n=this.unparseSheetName(e.start.sheet)+"!"),void 0!==e.end.sheet&&e.sheetReferenceType===s.RangeSheetReferenceType.BOTH_ABSOLUTE&&(r=this.unparseSheetName(e.end.sheet)+"!");var i=e.start.unparse(t),e=e.end.unparse(t);return void 0===i||void 0===e?this.config.translationPackage.getErrorTranslation(o.ErrorType.REF):""+n+i+":"+r+e}}function u(e,t){return e.toString().replace(".",t)}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{collectDependencies:()=>r});var o=n(7);const s=(e,t,n,r)=>{switch(e.type){case o.AstNodeType.EMPTY:case o.AstNodeType.NUMBER:case o.AstNodeType.STRING:case o.AstNodeType.ERROR:return;case o.AstNodeType.NAMED_EXPRESSION:return void(r&&n.push(new o.NamedExpressionDependency(e.expressionName)));case o.AstNodeType.CELL_REFERENCE:return void(r&&n.push(new o.AddressDependency(e.reference)));case o.AstNodeType.CELL_RANGE:return void(r&&e.start.sheet===e.end.sheet&&n.push(new o.CellRangeDependency(e.start,e.end)));case o.AstNodeType.COLUMN_RANGE:return void(r&&e.start.sheet===e.end.sheet&&n.push(new o.ColumnRangeDependency(e.start,e.end)));case o.AstNodeType.ROW_RANGE:return void(r&&e.start.sheet===e.end.sheet&&n.push(new o.RowRangeDependency(e.start,e.end)));case o.AstNodeType.PERCENT_OP:case o.AstNodeType.PLUS_UNARY_OP:case o.AstNodeType.MINUS_UNARY_OP:return void s(e.value,t,n,!0);case o.AstNodeType.CONCATENATE_OP:case o.AstNodeType.EQUALS_OP:case o.AstNodeType.NOT_EQUAL_OP:case o.AstNodeType.LESS_THAN_OP:case o.AstNodeType.GREATER_THAN_OP:case o.AstNodeType.LESS_THAN_OR_EQUAL_OP:case o.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case o.AstNodeType.MINUS_OP:case o.AstNodeType.PLUS_OP:case o.AstNodeType.TIMES_OP:case o.AstNodeType.DIV_OP:case o.AstNodeType.POWER_OP:return s(e.left,t,n,!0),void s(e.right,t,n,!0);case o.AstNodeType.PARENTHESIS:return void s(e.expression,t,n,r);case o.AstNodeType.FUNCTION_CALL:{const i=!t.doesFunctionNeedArgumentToBeComputed(e.procedureName);e.args.forEach(e=>s(e,t,n,i))}}},r=(e,t)=>{var n=new Array;return s(e,t,n,!0),n}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{AddressDependency:()=>i,CellRangeDependency:()=>o,ColumnRangeDependency:()=>s,NamedExpressionDependency:()=>l,RowRangeDependency:()=>a});var r=n(2);class i{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}}class o{constructor(e,t){this.start=e,this.end=t}absolutize(e){return new r.AbsoluteCellRange(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}class s{constructor(e,t){this.start=e,this.end=t}absolutize(e){var t=this.start.toSimpleColumnAddress(e),e=this.end.toSimpleColumnAddress(e);return new r.AbsoluteColumnRange(t.sheet,t.col,e.col)}}class a{constructor(e,t){this.start=e,this.end=t}absolutize(e){var t=this.start.toSimpleRowAddress(e),e=this.end.toSimpleRowAddress(e);return new r.AbsoluteRowRange(t.sheet,t.row,e.row)}}class l{constructor(e){this.name=e}absolutize(e){return this}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ContentChanges:()=>r});var i=n(3),o=n(69);class r{constructor(){this.changes=new Map}static empty(){return new r}addAll(e){for(const t of e.changes.values())this.add(t.address,t);return this}addChange(e,t,n){this.addInterpreterValue(e,t,n)}exportChanges(t){let n=[];return this.changes.forEach(e=>{e=t.exportChange(e);Array.isArray(e)?n=n.concat(e):n.push(e)}),n}getChanges(){return Array.from(this.changes.values())}isEmpty(){return 0===this.changes.size}add(e,t){var n=t.value;if(n instanceof o.SimpleRangeValue)for(const r of n.effectiveAddressesFromData(e))this.changes.delete(`${r.sheet},${r.col},`+r.row);this.changes.set((0,i.addressKey)(e),t)}addInterpreterValue(e,t,n){this.add(t,{address:t,value:e,oldValue:n})}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{SimpleRangeValue:()=>a});var i=n(1),o=n(3),r=n(61),s=n(70);class a{constructor(e,t,n,r){this._data=e,this.range=t,this.dependencyGraph=n,this._hasOnlyNumbers=r,this.size=void 0===e?new i.ArraySize(t.effectiveWidth(n),t.effectiveHeight(n)):new i.ArraySize(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,t,n){return new a(e,t,n,!0)}static onlyNumbers(e){return new a(e,void 0,void 0,!0)}static onlyValues(e){return new a(e,void 0,void 0,void 0)}static onlyRange(e,t){return new a(void 0,e,t,void 0)}static fromScalar(e){return new a([[e]],void 0,void 0,void 0)}isAdHoc(){return void 0===this.range}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();var n=[];for(let t=0;t<this._data.length;t++)for(let e=0;e<this._data[0].length;e++)n.push(this._data[t][e]);return n}*effectiveAddressesFromData(n){for(let t=0;t<this.data.length;++t){var r=this.data[t];for(let e=0;e<r.length;++e)yield(0,o.simpleCellAddress)(n.sheet,n.col+e,n.row+t)}}*entriesFromTopLeftCorner(n){this.ensureThatComputed();for(let t=0;t<this.size.height;++t)for(let e=0;e<this.size.width;++e)yield[this._data[t][e],(0,o.simpleCellAddress)(n.sheet,n.col+e,n.row+t)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(void 0===this._hasOnlyNumbers){this._hasOnlyNumbers=!0;for(const e of this.data)for(const t of e)if("number"!=typeof t)return this._hasOnlyNumbers=!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),null!=(e=this._data)?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){void 0===this._data&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,e=>{e=this.dependencyGraph.getCellValue(e);return e instanceof a?(this._hasOnlyNumbers=!1,new o.CellError(o.ErrorType.VALUE,r.ErrorMessage.ScalarExpected)):((0,s.isExtendedNumber)(e)||(this._hasOnlyNumbers=!1),e)}))}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{CurrencyNumber:()=>s,DateNumber:()=>o,DateTimeNumber:()=>l,EmptyValue:()=>r,NumberType:()=>c,PercentNumber:()=>u,RichNumber:()=>i,TimeNumber:()=>a,cloneNumber:()=>function(e,t){return"number"==typeof e?t:((t=e.fromNumber(t)).format=e.format,t)},getFormatOfExtendedNumber:()=>function(e){if(e instanceof i)return e.format},getRawValue:()=>function(e){return e instanceof i?e.val:e},getTypeFormatOfExtendedNumber:()=>function(e){return e instanceof i?{type:e.getDetailedType(),format:e.format}:{type:c.NUMBER_RAW}},getTypeOfExtendedNumber:()=>function(e){return e instanceof i?e.getDetailedType():c.NUMBER_RAW},isExtendedNumber:()=>function(e){return"number"==typeof e||e instanceof i}});const r=Symbol("Empty value");class i{constructor(e,t){this.val=e,this.format=t}fromNumber(e){return new this.constructor(e)}}class o extends i{getDetailedType(){return c.NUMBER_DATE}}class s extends i{getDetailedType(){return c.NUMBER_CURRENCY}}class a extends i{getDetailedType(){return c.NUMBER_TIME}}class l extends i{getDetailedType(){return c.NUMBER_DATETIME}}class u extends i{getDetailedType(){return c.NUMBER_PERCENT}}var c;(n=c=c||{}).NUMBER_RAW="NUMBER_RAW",n.NUMBER_DATE="NUMBER_DATE",n.NUMBER_TIME="NUMBER_TIME",n.NUMBER_DATETIME="NUMBER_DATETIME",n.NUMBER_CURRENCY="NUMBER_CURRENCY",n.NUMBER_PERCENT="NUMBER_PERCENT"},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ColumnsSpan:()=>i,RowsSpan:()=>r});class r{constructor(e,t,n){if(this.sheet=e,this.rowStart=t,this.rowEnd=n,t<0)throw Error("Starting row cant be less than 0");if(n<t)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,t,n){return new r(e,t,t+n-1)}static fromRowStartAndEnd(e,t,n){return new r(e,t,n)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");var t=Math.max(this.rowStart,e.rowStart),e=Math.min(this.rowEnd,e.rowEnd);return e<t?null:new r(this.sheet,t,e)}firstRow(){return new r(this.sheet,this.rowStart,this.rowStart)}}class i{constructor(e,t,n){if(this.sheet=e,this.columnStart=t,this.columnEnd=n,t<0)throw Error("Starting column cant be less than 0");if(n<t)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,t,n){return new i(e,t,t+n-1)}static fromColumnStartAndEnd(e,t,n){return new i(e,t,n)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");var t=Math.max(this.columnStart,e.columnStart),e=Math.min(this.columnEnd,e.columnEnd);return e<t?null:new i(this.sheet,t,e)}firstColumn(){return new i(this.sheet,this.columnStart,this.columnStart)}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{EmptyStatistics:()=>r.EmptyStatistics,StatType:()=>o.StatType,Statistics:()=>i.Statistics});var r=n(73),i=n(74),o=n(75)},(e,t,n)=>{"use strict";n.r(t),n.d(t,{EmptyStatistics:()=>r});class r extends n(74).Statistics{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Statistics:()=>i});var r=n(75);class i{constructor(){this.stats=new Map([[r.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,0],[r.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e=(null!=(e=this.stats.get(r.StatType.CRITERION_FUNCTION_FULL_CACHE_USED))?e:0)+1;this.stats.set(r.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,e)}incrementCriterionFunctionPartialCacheUsed(){var e=(null!=(e=this.stats.get(r.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED))?e:0)+1;this.stats.set(r.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,e)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(r.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(r.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var t=Date.now(),n=this.startTimes.get(e);if(!n)throw Error(`Statistics ${e} not started`);var r=null!=(r=this.stats.get(e))?r:0;this.stats.set(e,r+=t-n),this.startTimes.delete(e)}measure(e,t){this.start(e);t=t();return this.end(e),t}snapshot(){return new Map(this.stats)}}},(e,t,n)=>{"use strict";var r;n.r(t),n.d(t,{StatType:()=>r}),(n=r=r||{}).BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",n.PARSER="PARSER",n.GRAPH_BUILD="GRAPH_BUILD",n.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",n.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",n.TOP_SORT="TOP_SORT",n.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",n.EVALUATION="EVALUATION",n.VLOOKUP="VLOOKUP",n.TRANSFORM_ASTS="TRANSFORM_ASTS",n.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",n.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",n.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",n.ADJUSTING_RANGES="ADJUSTING_RANGES",n.ADJUSTING_GRAPH="ADJUSTING_GRAPH",n.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",n.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"},(e,t,n)=>{"use strict";n.r(t),n.d(t,{AddressMapping:()=>s});var i=n(77),r=n(70),o=n(4);class s{constructor(e){this.policy=e,this.mapping=new Map}getCell(e){var t=this.mapping.get(e.sheet);if(void 0===t)throw new i.NoSheetWithIdError(e.sheet);return t.getCell(e)}fetchCell(e){var t=this.mapping.get(e.sheet);if(void 0===t)throw new i.NoSheetWithIdError(e.sheet);t=t.getCell(e);if(t)return t;throw Error("Vertex for address missing in AddressMapping")}strategyFor(e){var t=this.mapping.get(e);if(void 0===t)throw new i.NoSheetWithIdError(e);return t}addSheet(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}autoAddSheet(e,t,n){var{height:n,width:r,fill:i}=n,i=this.policy.call(i);this.addSheet(e,new i(r,n))}getCellValue(e){var t=this.getCell(e);return void 0===t?r.EmptyValue:t instanceof o.ArrayVertex?t.getArrayCellValue(e):t.getCellValue()}getRawValue(e){var t=this.getCell(e);return t instanceof o.ValueCellVertex?t.getValues().rawValue:t instanceof o.ArrayVertex?t.getArrayCellRawValue(e):null}setCell(e,t){var n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized");n.setCell(e,t)}moveCell(e,t){var n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized.");if(e.sheet!==t.sheet)throw Error("Cannot move cells between sheets.");if(n.has(t))throw new Error("Cannot move cell. Destination already occupied.");n=n.getCell(e);if(void 0===n)throw new Error("Cannot move cell. No cell with such address.");this.setCell(t,n),this.removeCell(e)}removeCell(e){var t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}has(e){var t=this.mapping.get(e.sheet);return void 0!==t&&t.has(e)}getHeight(e){var t=this.mapping.get(e);if(void 0===t)throw new i.NoSheetWithIdError(e);return t.getHeight()}getWidth(e){var t=this.mapping.get(e);if(t)return t.getWidth();throw new i.NoSheetWithIdError(e)}addRows(e,t,n){var r=this.mapping.get(e);if(void 0===r)throw new i.NoSheetWithIdError(e);r.addRows(t,n)}removeRows(e){var t=this.mapping.get(e.sheet);if(void 0===t)throw new i.NoSheetWithIdError(e.sheet);t.removeRows(e)}removeSheet(e){this.mapping.delete(e)}addColumns(e,t,n){var r=this.mapping.get(e);if(void 0===r)throw new i.NoSheetWithIdError(e);r.addColumns(t,n)}removeColumns(e){var t=this.mapping.get(e.sheet);if(void 0===t)throw new i.NoSheetWithIdError(e.sheet);t.removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.mapping.get(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(var[e,t]of this.mapping.entries())yield*t.getEntries(e)}*sheetEntries(e){var t=this.mapping.get(e);if(void 0===t)throw new i.NoSheetWithIdError(e);yield*t.getEntries(e)}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{AliasAlreadyExisting:()=>D,ConfigValueEmpty:()=>E,ConfigValueTooBigError:()=>w,ConfigValueTooSmallError:()=>C,EvaluationSuspendedError:()=>T,ExpectedOneOfValuesError:()=>S,ExpectedValueOfTypeError:()=>b,FunctionPluginValidationError:()=>x,InvalidAddressError:()=>l,InvalidArgumentsError:()=>u,LanguageAlreadyRegisteredError:()=>N,LanguageNotRegisteredError:()=>_,MissingTranslationError:()=>R,NamedExpressionDoesNotExistError:()=>f,NamedExpressionNameIsAlreadyTakenError:()=>d,NamedExpressionNameIsInvalidError:()=>h,NoOperationToRedoError:()=>g,NoOperationToUndoError:()=>p,NoRelativeAddressesAllowedError:()=>k,NoSheetWithIdError:()=>r,NoSheetWithNameError:()=>i,NotAFormulaError:()=>a,NothingToPasteError:()=>m,ProtectedFunctionError:()=>O,ProtectedFunctionTranslationError:()=>A,SheetNameAlreadyTakenError:()=>o,SheetSizeLimitExceededError:()=>s,SheetsNotEqual:()=>c,SourceLocationHasArrayError:()=>I,TargetLocationHasArrayError:()=>M,UnableToParseError:()=>v});class r extends Error{constructor(e){super("There's no sheet with id = "+e)}}class i extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}}class o extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}}class s extends Error{constructor(){super("Sheet size limit exceeded")}}class a extends Error{constructor(){super("This is not a formula")}}class l extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}}class u extends Error{constructor(e){super("Invalid arguments, expected "+e)}}class c extends Error{constructor(e,t){super(`Sheets ${e} and ${t} are not equal.`)}}class d extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}}class h extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}}class f extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}}class p extends Error{constructor(){super("There is no operation to undo")}}class g extends Error{constructor(){super("There is no operation to redo")}}class m extends Error{constructor(){super("There is nothing to paste")}}function y(e,t){switch(typeof t){case"function":case"symbol":return t.toString();case"bigint":return"BigInt("+t.toString()+")";default:return t instanceof RegExp?"RegExp("+t.toString()+")":t}}class v extends Error{constructor(e){super("Unable to parse value: "+JSON.stringify(e,y,4))}}class b extends Error{constructor(e,t){super(`Expected value of type: ${e} for config parameter: `+t)}}class E extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}}class C extends Error{constructor(e,t){super(`Config parameter ${e} should be at least `+t)}}class w extends Error{constructor(e,t){super(`Config parameter ${e} should be at most `+t)}}class S extends Error{constructor(e,t){super(`Expected one of ${e} for config parameter: `+t)}}class T extends Error{constructor(){super("Computations are suspended")}}class R extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}}class A extends Error{constructor(e){super("Cannot register translation for function with id: "+e)}}class _ extends Error{constructor(){super("Language not registered.")}}class N extends Error{constructor(){super("Language already registered.")}}class x extends Error{static functionNotDeclaredInPlugin(e,t){return new x(`Function with id ${e} not declared in plugin `+t)}static functionMethodNotFound(e,t){return new x(`Function method ${e} not found in plugin `+t)}}class O extends Error{static cannotRegisterFunctionWithId(e){return new O("Cannot register function with id "+e)}static cannotUnregisterFunctionWithId(e){return new O("Cannot unregister function with id "+e)}static cannotUnregisterProtectedPlugin(){return new O("Cannot unregister protected plugin")}}class I extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}}class M extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}}class k extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}}class D extends Error{constructor(e,t){super(`Alias id ${e} in plugin ${t} already defined as a function or alias.`)}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ArrayMapping:()=>i});var r=n(3);class i{constructor(){this.arrayMapping=new Map}getArray(e){var t=this.getArrayByCorner(e.start);if(null!=t&&t.getRange().sameAs(e))return t}getArrayByCorner(e){return this.arrayMapping.get((0,r.addressKey)(e))}setArray(e,t){this.arrayMapping.set((0,r.addressKey)(e.start),t)}removeArray(e){"string"==typeof e?this.arrayMapping.delete(e):this.arrayMapping.delete((0,r.addressKey)(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(var[t,n]of this.arrayMapping.entries())n.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[t,n])}*arraysInCols(e){for(var[t,n]of this.arrayMapping.entries())n.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[t,n])}isFormulaArrayInRow(e,t){for(const n of this.arrayMapping.values())if(n.spansThroughSheetRows(e,t))return!0;return!1}isFormulaArrayInAllRows(e){let t=!0;for(const n of e.rows())this.isFormulaArrayInRow(e.sheet,n)||(t=!1);return t}isFormulaArrayInColumn(e,t){for(const n of this.arrayMapping.values())if(n.spansThroughSheetColumn(e,t))return!0;return!1}isFormulaArrayInAllColumns(e){let t=!0;for(const n of e.columns())this.isFormulaArrayInColumn(e.sheet,n)||(t=!1);return t}isFormulaArrayInRange(e){for(const t of this.arrayMapping.values())if(t.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(const t of this.arrayMapping.values())if(t.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,r,i){this.updateArrayVerticesInSheet(e,(e,t)=>{var n=t.getRange();return r<=n.start.row?[n.shifted(0,i),t]:void 0})}moveArrayVerticesAfterColumnByColumns(e,r,i){this.updateArrayVerticesInSheet(e,(e,t)=>{var n=t.getRange();return r<=n.start.col?[n.shifted(i,0),t]:void 0})}updateArrayVerticesInSheet(e,t){var n,r,i,o=Array();for([n,r]of this.arrayMapping.entries())r.sheet===e&&void 0!==(i=t(n,r))&&(this.removeArray(n),o.push(i));o.forEach(([e,t])=>{this.setArray(e,t)})}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{collectAddressesDependentToRange:()=>r});var l=n(7),u=n(80),c=n(82);const r=(e,t,n,r,i)=>{var o;if(t instanceof c.RangeVertex)return void 0!==(o=t.range.intersectionWith(n))?Array.from(o.addresses(i)):[];let s,a;return t instanceof u.FormulaVertex?(s=t.getFormula(r),a=t.getAddress(r),(0,l.collectDependencies)(s,e).filter(e=>e instanceof l.AddressDependency).map(e=>e.dependency.toSimpleCellAddress(a)).filter(e=>n.addressInRange(e))):[]}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ArrayVertex:()=>d,FormulaCellVertex:()=>h,FormulaVertex:()=>c});var r=n(2),i=n(1),o=n(81),s=n(3),a=n(61),l=n(70),u=n(71);class c{constructor(e,t,n){this.formula=e,this.cellAddress=t,this.version=n}get width(){return 1}get height(){return 1}static fromAst(e,t,n,r){return n.isScalar()?new h(e,t,r):new d(e,t,n,r)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){var t,n;this.version!=e.version()&&([e,t,n]=e.applyTransformations(this.formula,this.cellAddress,this.version),this.formula=e,this.cellAddress=t,this.version=n)}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}class d extends c{constructor(e,t,n,r=0){super(e,t,r),n.isRef?this.array=new o.ErroredArray(new s.CellError(s.ErrorType.REF,a.ErrorMessage.NoSpaceForArrayResult),i.ArraySize.error()):this.array=new o.NotComputedArray(n)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){var t;return e instanceof s.CellError?this.setErrorValue(e):((t=o.ArrayValue.fromInterpreterValue(e)).resize(this.array.size),this.array=t),e}getCellValue(){if(this.array instanceof o.NotComputedArray)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof o.NotComputedArray))return this.array.simpleRangeValue()}getArrayCellValue(e){var t=e.col-this.cellAddress.col,e=e.row-this.cellAddress.row;try{return this.array.get(t,e)}catch(e){return new s.CellError(s.ErrorType.REF)}}getArrayCellRawValue(e){e=this.getArrayCellValue(e);if(!(e instanceof s.CellError||e===l.EmptyValue))return(0,l.getRawValue)(e)}setArrayCellValue(e,t){var n=e.col-this.cellAddress.col,e=e.row-this.cellAddress.row;this.array instanceof o.ArrayValue&&this.array.set(n,e,t)}setNoSpace(){return this.array=new o.ErroredArray(new s.CellError(s.ErrorType.SPILL,a.ErrorMessage.NoSpaceForArrayResult),i.ArraySize.error()),this.getCellValue()}getRange(){return r.AbsoluteCellRange.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return r.AbsoluteCellRange.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,t,n=t){return this.cellAddress.sheet===e&&this.cellAddress.row<=n&&t<this.cellAddress.row+this.height}spansThroughSheetColumn(e,t,n=t){return this.cellAddress.sheet===e&&this.cellAddress.col<=n&&t<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof o.NotComputedArray)}columnsFromArray(){return u.ColumnsSpan.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return u.RowsSpan.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return(0,s.equalSimpleCellAddress)(this.cellAddress,e)}setErrorValue(e){this.array=new o.ErroredArray(e,this.array.size)}}class h extends c{constructor(e,t,n){super(e,t,n)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(void 0!==this.cachedCellValue)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return void 0!==this.cachedCellValue}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ArrayValue:()=>a,ErroredArray:()=>l,NotComputedArray:()=>s});var r=n(1),i=n(70),o=n(69);class s{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,t){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}}class a{constructor(e){this.size=new r.ArraySize(0<e.length?e[0].length:0,e.length),this.array=e}static fromInterpreterValue(e){return e instanceof o.SimpleRangeValue?new a(e.data):new a([[e]])}simpleRangeValue(){return o.SimpleRangeValue.onlyValues(this.array)}addRows(e,t){this.array.splice(e,0,...this.nullArrays(t,this.width())),this.size.height+=t}addColumns(t,n){for(let e=0;e<this.height();e++)this.array[e].splice(t,0,...new Array(n).fill(i.EmptyValue));this.size.width+=n}removeRows(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Array index out of bound");t=t-e+1;this.array.splice(e,t),this.size.height-=t}removeColumns(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Array index out of bound");var n=t-e+1;for(const r of this.array)r.splice(e,n);this.size.width-=n}nullArrays(t,n){var r=[];for(let e=0;e<t;++e)r.push(new Array(n).fill(i.EmptyValue));return r}get(e,t){if(this.outOfBound(e,t))throw Error("Array index out of bound");return this.array[t][e]}set(e,t,n){if(this.outOfBound(e,t))throw Error("Array index out of bound");this.array[t][e]=n}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height)throw Error("Resizing to smaller array");if(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width)throw Error("Resizing to smaller array")}outOfBound(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}class l{constructor(e,t){this.error=e,this.size=t}get(e,t){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{RangeVertex:()=>r});class r{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,t){this.functionCache.set(e,t)}getCriterionFunctionValue(e,t){return null==(e=this.getCriterionFunctionValues(e).get(t))?void 0:e[0]}getCriterionFunctionValues(e){return null!=(e=this.criterionFunctionCache.get(e))?e:new Map}setCriterionFunctionValues(e,t){this.criterionFunctionCache.set(e,t)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach(e=>e.criterionFunctionCache.clear()),this.dependentCacheRanges.clear()}getStart(){return this.start}getEnd(){return this.end}}},(e,t,n)=>{"use strict";var p;n.r(t),n.d(t,{Graph:()=>r}),(n=p=p||{})[n.ON_STACK=0]="ON_STACK",n[n.PROCESSED=1]="PROCESSED",n[n.POPPED=2]="POPPED";class r{constructor(e){this.dependencyQuery=e,this.nodes=new Set,this.specialNodes=new Set,this.specialNodesStructuralChanges=new Set,this.specialNodesRecentlyChanged=new Set,this.infiniteRanges=new Set,this.edges=new Map}addNode(e){this.nodes.add(e),this.edges.has(e)||this.edges.set(e,new Set)}addEdge(e,t){if(!this.nodes.has(e))throw new Error("Unknown node "+e);if(!this.nodes.has(t))throw new Error("Unknown node "+t);this.edges.get(e).add(t)}removeEdge(e,t){if(!this.existsEdge(e,t))throw new Error("Edge does not exist");this.edges.get(e).delete(t)}softRemoveEdge(e,t){null!=(e=this.edges.get(e))&&e.delete(t)}removeIncomingEdges(t){this.edges.forEach(e=>{e.delete(t)})}adjacentNodes(e){return this.edges.get(e)}adjacentNodesCount(e){return this.adjacentNodes(e).size}hasNode(e){return this.nodes.has(e)}nodesCount(){return this.nodes.size}edgesCount(){let t=0;return this.edges.forEach(e=>t+=e.size),t}removeNode(e){for(const t of this.adjacentNodes(e).values())this.markNodeAsSpecialRecentlyChanged(t);return this.edges.delete(e),this.nodes.delete(e),this.specialNodes.delete(e),this.specialNodesRecentlyChanged.delete(e),this.specialNodesStructuralChanges.delete(e),this.infiniteRanges.delete(e),this.removeDependencies(e)}markNodeAsSpecial(e){this.specialNodes.add(e)}markNodeAsSpecialRecentlyChanged(e){this.nodes.has(e)&&this.specialNodesRecentlyChanged.add(e)}markNodeAsChangingWithStructure(e){this.specialNodesStructuralChanges.add(e)}clearSpecialNodesRecentlyChanged(){this.specialNodesRecentlyChanged.clear()}markNodeAsInfiniteRange(e){this.infiniteRanges.add(e)}existsEdge(e,t){return null!=(e=null==(e=this.edges.get(e))?void 0:e.has(t))&&e}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(Array.from(this.nodes),()=>!0,()=>{})}getTopSortedWithSccSubgraphFrom(e,t,n){const s=new Map,a=new Map,l=new Map,u=new Set,c=new Map,d=[];let h=0;const f=new Set,r=(e.reverse(),e.forEach(e=>{if(void 0===c.get(e)){const i=[e];var n=[];for(c.set(e,p.ON_STACK);0<i.length;){const o=i[i.length-1];switch(c.get(o)){case p.ON_STACK:s.set(o,h),a.set(o,h),n.push(o),h++,this.adjacentNodes(o).forEach(e=>{void 0===s.get(e)&&(i.push(e),l.set(e,o),c.set(e,p.ON_STACK))}),c.set(o,p.PROCESSED);break;case p.PROCESSED:{let t;if(t=s.get(o),this.adjacentNodes(o).forEach(e=>{u.has(e)||(t=l.get(e)===o?Math.min(t,a.get(e)):Math.min(t,s.get(e)))}),a.set(o,t),t===s.get(o)){for(var r=[];r.push(n[n.length-1]),n.pop(),r[r.length-1]!==o;);r.forEach(e=>{u.add(e)}),d.push(...r),1<r.length&&r.forEach(e=>{f.add(e)})}i.pop(),c.set(o,p.POPPED);break}case p.POPPED:i.pop()}}}}),new Set(e)),i=[],o=[];return d.reverse(),d.forEach(e=>{f.has(e)||this.adjacentNodes(e).has(e)?(o.push(e),n(e),this.adjacentNodes(e).forEach(e=>r.add(e))):(i.push(e),r.has(e)&&t(e)&&this.adjacentNodes(e).forEach(e=>r.add(e)))}),{sorted:i,cycled:o}}getDependencies(n){const r=[];return this.edges.forEach((e,t)=>{e.has(n)&&r.push(t)}),r}removeDependencies(e){var t,n,r=this.dependencyQuery(e);for([t,n]of r)this.softRemoveEdge(n,e);return r}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{RangeMapping:()=>o});var r=n(2),i=n(3);class o{constructor(){this.rangeMapping=new Map}getMappingSize(e){return null!=(e=null==(e=this.rangeMapping.get(e))?void 0:e.size)?e:0}setRange(e){let t=this.rangeMapping.get(e.getStart().sheet);void 0===t&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));var n=f(e.getStart(),e.getEnd());t.set(n,e)}removeRange(e){var t=e.getStart().sheet,n=this.rangeMapping.get(t);void 0!==n&&(e=f(e.getStart(),e.getEnd()),n.delete(e),0===n.size)&&this.rangeMapping.delete(t)}getRange(e,t){var n=this.rangeMapping.get(e.sheet),e=f(e,t);return null==n?void 0:n.get(e)}fetchRange(e,t){e=this.getRange(e,t);if(e)return e;throw Error("Range does not exist")}truncateRanges(e,n){var t,r,i=Array(),o=Array(),s=Array(),a=e.sheet;for([t,r]of this.entriesFromSheet(e.sheet)){var l=r.range;e.start<=n(r.range.end)&&(l.removeSpan(e),l.shouldBeRemoved()?(this.removeByKey(a,t),i.push(r)):o.push([t,r]),s.push(r))}var u=[];o.sort((e,t)=>p(e[1],t[1],n));for(const[d,h]of o){var c=f((c=h.range).start,c.end);c!==d&&(c=this.getByKey(a,c),this.removeByKey(a,d),void 0!==c&&h!=c?u.push([c,h]):this.setRange(h))}return{verticesToRemove:i,verticesToMerge:u,verticesWithChangedSize:s}}moveAllRangesInSheetAfterRowByRows(e,n,r){return this.updateVerticesFromSheet(e,(e,t)=>n<=t.start.row?(t.range.shiftByRows(r),{changedSize:!1,vertex:t}):n>t.start.row&&n<=t.end.row?(t.range.expandByRows(r),{changedSize:!0,vertex:t}):void 0)}moveAllRangesInSheetAfterColumnByColumns(e,n,r){return this.updateVerticesFromSheet(e,(e,t)=>n<=t.start.col?(t.range.shiftByColumns(r),{changedSize:!1,vertex:t}):n>t.start.col&&n<=t.end.col?(t.range.expandByColumns(r),{changedSize:!0,vertex:t}):void 0)}moveRangesInsideSourceRange(n,r,i,o){this.updateVerticesFromSheet(n.sheet,(e,t)=>{if(n.containsRange(t.range))return t.range.shiftByColumns(r),t.range.shiftByRows(i),t.range.moveToSheet(o),{changedSize:!1,vertex:t}})}removeRangesInSheet(e){var t;return this.rangeMapping.has(e)?(t=this.rangeMapping.get(e).values(),this.rangeMapping.delete(e),t):[][Symbol.iterator]()}*rangesInSheet(e){e=this.rangeMapping.get(e);e&&(yield*e.values())}*rangeVerticesContainedInRange(e){for(const t of this.rangesInSheet(e.sheet))e.containsRange(t.range)&&(yield t)}findSmallerRange(e){if(1<e.height()&&Number.isFinite(e.height())){var t=(0,i.simpleCellAddress)(e.end.sheet,e.end.col,e.end.row-1),t=this.getRange(e.start,t);if(void 0!==t)return{smallerRangeVertex:t,restRange:r.AbsoluteCellRange.fromSimpleCellAddresses((0,i.simpleCellAddress)(e.start.sheet,e.start.col,e.end.row),e.end)}}return{restRange:e}}*entriesFromSheet(e){e=this.rangeMapping.get(e);e&&(yield*e.entries())}removeByKey(e,t){this.rangeMapping.get(e).delete(t)}getByKey(e,t){return null==(e=this.rangeMapping.get(e))?void 0:e.get(t)}updateVerticesFromSheet(e,t){var n,r,i=Array();for([n,r]of this.entriesFromSheet(e)){var o=t(n,r);void 0!==o&&(this.removeByKey(e,n),i.push(o))}return i.forEach(e=>{this.setRange(e.vertex)}),{verticesWithChangedSize:i.filter(e=>e.changedSize).map(e=>e.vertex)}}}function f(e,t){return`${e.col},${e.row},${t.col},`+t.row}const p=(e,t,n)=>{var r=n(e.range.start),i=n(e.range.start);return r===i?n(e.range.end)-n(t.range.end):r-i}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{SheetMapping:()=>a});var i=n(77),r=n(86);function o(e){return e.toLowerCase()}class s{constructor(e,t){this.id=e,this.displayName=t}get canonicalName(){return o(this.displayName)}}class a{constructor(e){this.languages=e,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=e=>{var t=this.mappingFromCanonicalName.get(o(e));if(void 0===t)throw new i.NoSheetWithNameError(e);return t.id},this.get=e=>{return null==(e=this.mappingFromCanonicalName.get(o(e)))?void 0:e.id},this.fetchDisplayName=e=>this.fetchSheetById(e).displayName,this.sheetNamePrefix=e.getUITranslation(r.UIElement.NEW_SHEET_PREFIX)}addSheet(e=""+this.sheetNamePrefix+(this.lastSheetId+2)){var t=o(e);if(this.mappingFromCanonicalName.has(t))throw new i.SheetNameAlreadyTakenError(e);this.lastSheetId++;t=new s(this.lastSheetId,e);return this.store(t),t.id}removeSheet(e){var t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}getDisplayName(e){return null==(e=this.mappingFromId.get(e))?void 0:e.displayName}*displayNames(){for(const e of this.mappingFromCanonicalName.values())yield e.displayName}numberOfSheets(){return this.mappingFromCanonicalName.size}hasSheetWithId(e){return this.mappingFromId.has(e)}hasSheetWithName(e){return this.mappingFromCanonicalName.has(o(e))}renameSheet(e,t){var e=this.fetchSheetById(e),n=e.displayName;if(n!==t){var r=this.mappingFromCanonicalName.get(o(t));if(void 0!==r&&r.id!==e.id)throw new i.SheetNameAlreadyTakenError(t);r=e.canonicalName;return this.mappingFromCanonicalName.delete(r),e.displayName=t,this.store(e),n}}sheetNames(){return Array.from(this.mappingFromId.values()).map(e=>e.displayName)}store(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}fetchSheetById(e){var t=this.mappingFromId.get(e);if(void 0===t)throw new i.NoSheetWithIdError(e);return t}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{TranslationPackage:()=>i.TranslationPackage,UIElement:()=>r,buildTranslationPackage:()=>i.buildTranslationPackage});var r,i=n(87);(r=r||{}).NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"},(e,t,n)=>{"use strict";n.r(t),n.d(t,{TranslationPackage:()=>s,buildTranslationPackage:()=>function(e){return new s(Object.assign({},e.functions),Object.assign({},e.errors),Object.assign({},e.ui))}});var r=n(3),i=n(77),o=n(86);class s{constructor(e,t,n){this.functions=e,this.errors=t,this.ui=n,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce((e,t)=>(e[this.functions[t]]=t,e),{})}buildErrorMapping(){return Object.keys(this.errors).reduce((e,t)=>(e[this.errors[t]]=t,e),{})}isFunctionTranslated(e){return void 0!==this.functions[e]}getFunctionTranslations(e){var t=[];for(const n of e)this.isFunctionTranslated(n)&&t.push(this.functions[n]);return t}getFunctionTranslation(e){var t=this.functions[e];if(void 0===t)throw new i.MissingTranslationError("functions."+e);return t}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===r.ErrorType.LIC)return`#${r.ErrorType.LIC}!`;var t=this.errors[e];if(void 0===t)throw new i.MissingTranslationError("errors."+e);return t}getUITranslation(e){var t=this.ui[e];if(void 0===t)throw new i.MissingTranslationError("ui."+e);return t}checkUI(){for(const e of Object.values(o.UIElement))if(!(e in this.ui))throw new i.MissingTranslationError("ui."+e)}checkErrors(){for(const e of Object.values(r.ErrorType))if(!(e in this.errors)&&e!==r.ErrorType.LIC)throw new i.MissingTranslationError("errors."+e)}checkFunctionTranslations(e){var t=new Set(Object.getOwnPropertyNames(e));for(const n of Object.getOwnPropertyNames(this._protectedTranslations))if(t.has(n))throw new i.ProtectedFunctionTranslationError(n)}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{EmptyCellVertex:()=>i});var r=n(70);class i{constructor(){}getCellValue(){return r.EmptyValue}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ValueCellVertex:()=>r});class r{constructor(e,t){this.parsedValue=e,this.rawValue=t}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}setCellValue(e){throw Error("SetCellValue is deprecated for ValueCellVertex")}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ParsingErrorVertex:()=>i});var r=n(3);class i{constructor(e,t){this.errors=e,this.rawInput=t}getCellValue(){return r.CellError.parsingError()}getFormula(){return this.rawInput}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{SparseStrategy:()=>r});var o=n(3);class r{constructor(e,t){this.width=e,this.height=t,this.mapping=new Map}getCell(e){var t;return null==(t=this.mapping.get(e.col))?void 0:t.get(e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let n=this.mapping.get(e.col);n||(n=new Map,this.mapping.set(e.col,n)),n.set(e.row,t)}has(e){var t;return!(null==(t=this.mapping.get(e.col))||!t.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var t;null!=(t=this.mapping.get(e.col))&&t.delete(e.row)}addRows(i,o){this.mapping.forEach(n=>{const r=new Map;n.forEach((e,t)=>{i<=t&&(r.set(t+o,e),n.delete(t))}),r.forEach((e,t)=>{n.set(t,e)})}),this.height+=o}addColumns(n,r){const i=new Map;this.mapping.forEach((e,t)=>{n<=t&&(i.set(t+r,e),this.mapping.delete(t))}),i.forEach((e,t)=>{this.mapping.set(t,e)}),this.width+=r}removeRows(i){this.mapping.forEach(n=>{const r=new Map;n.forEach((e,t)=>{t>=i.rowStart&&(n.delete(t),t>i.rowEnd)&&r.set(t-i.numberOfRows,e)}),r.forEach((e,t)=>{n.set(t,e)})});var e=Math.min(this.height-1,i.rowEnd),e=Math.max(0,e-i.rowStart+1);this.height=Math.max(0,this.height-e)}removeColumns(n){const r=new Map;this.mapping.forEach((e,t)=>{t>=n.columnStart&&(this.mapping.delete(t),t>n.columnEnd)&&r.set(t-n.numberOfColumns,e)}),r.forEach((e,t)=>{this.mapping.set(t,e)});var e=Math.min(this.width-1,n.columnEnd),e=Math.max(0,e-n.columnStart+1);this.width=Math.max(0,this.width-e)}*getEntries(e){for(var[t,n]of this.mapping)for(var[r,i]of n)yield[(0,o.simpleCellAddress)(e,t,r),i]}*verticesFromColumn(e){e=this.mapping.get(e);if(void 0!==e)for(var[t,n]of e)yield n}*verticesFromRow(e){for(const n of this.mapping.values()){var t=n.get(e);void 0!==t&&(yield t)}}*verticesFromColumnsSpan(e){for(const i of e.columns()){var t=this.mapping.get(i);if(void 0!==t)for(var[n,r]of t)yield r}}*verticesFromRowsSpan(e){for(const n of this.mapping.values())for(const r of e.rows()){var t=n.get(r);void 0!==t&&(yield t)}}*entriesFromRowsSpan(e){for(var[t,n]of this.mapping.entries())for(const i of e.rows()){var r=n.get(i);void 0!==r&&(yield[(0,o.simpleCellAddress)(e.sheet,t,i),r])}}*entriesFromColumnsSpan(e){for(const i of e.columns()){var t=this.mapping.get(i);if(void 0!==t)for(var[n,r]of t.entries())yield[(0,o.simpleCellAddress)(e.sheet,i,n),r]}}*vertices(){for(var[e,t]of this.mapping)for(var[n,r]of t)void 0!==r&&(yield r)}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{DenseStrategy:()=>r});var i=n(3);class r{constructor(t,n){this.width=t,this.height=n,this.mapping=new Array(n);for(let e=0;e<n;e++)this.mapping[e]=new Array(t)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}has(e){var t=this.mapping[e.row];return!!t&&!!t[e.col]}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){void 0!==this.mapping[e.row]&&delete this.mapping[e.row][e.col]}addRows(e,t){var n=[];for(let e=0;e<t;e++)n.push(new Array(this.width));this.mapping.splice(e,0,...n),this.height+=t}addColumns(t,n){for(let e=0;e<this.height;e++)this.mapping[e].splice(t,0,...new Array(n));this.width+=n}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);var t=Math.min(this.height-1,e.rowEnd),t=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-t)}removeColumns(t){for(let e=0;e<this.height;e++)this.mapping[e].splice(t.columnStart,t.numberOfColumns);var e=Math.min(this.width-1,t.columnEnd),e=Math.max(0,e-t.columnStart+1);this.width=Math.max(0,this.width-e)}*getEntries(n){for(let t=0;t<this.height;++t)for(let e=0;e<this.width;++e){var r=this.getCellVertex(e,t);r&&(yield[(0,i.simpleCellAddress)(n,e,t),r])}}*verticesFromColumn(t){for(let e=0;e<this.height;++e){var n=this.getCellVertex(t,e);n&&(yield n)}}*verticesFromRow(t){for(let e=0;e<this.width;++e){var n=this.getCellVertex(e,t);n&&(yield n)}}*verticesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let e=0;e<this.height;++e){var n=this.getCellVertex(t,e);n&&(yield n)}}*verticesFromRowsSpan(n){for(let t=0;t<this.width;++t)for(let e=n.rowStart;e<=n.rowEnd;++e){var r=this.getCellVertex(t,e);r&&(yield r)}}*entriesFromRowsSpan(n){for(let t=0;t<this.width;++t)for(let e=n.rowStart;e<=n.rowEnd;++e){var r=this.getCellVertex(t,e);r&&(yield[(0,i.simpleCellAddress)(n.sheet,t,e),r])}}*entriesFromColumnsSpan(n){for(let t=n.columnStart;t<=n.columnEnd;++t)for(let e=0;e<this.height;++e){var r=this.getCellVertex(t,e);r&&(yield[(0,i.simpleCellAddress)(n.sheet,t,e),r])}}*vertices(){for(let t=0;t<this.height;++t)for(let e=0;e<this.width;++e){var n=this.getCellVertex(e,t);n&&(yield n)}}getCellVertex(e,t){return null==(t=this.mapping[t])?void 0:t[e]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{InterpreterState:()=>r});class r{constructor(e,t,n){this.formulaAddress=e,this.arraysFlag=t,this.formulaVertex=n}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{FunctionArgumentType:()=>l,FunctionPlugin:()=>r});var l,u=n(2),c=n(3),d=n(61),h=n(7),a=n(95),f=n(70),p=n(69);(t=l=l||{}).STRING="STRING",t.NUMBER="NUMBER",t.BOOLEAN="BOOLEAN",t.SCALAR="SCALAR",t.NOERROR="NOERROR",t.RANGE="RANGE",t.INTEGER="INTEGER",t.COMPLEX="COMPLEX",t.ANY="ANY";class r{constructor(e){this.coerceScalarToNumberOrError=e=>this.arithmeticHelper.coerceScalarToNumberOrError(e),this.runFunction=(e,n,r,i)=>{var e=this.evaluateArguments(e,n,r);const o=e.map(([e])=>e),s=e.map(([,e])=>e),a=this.buildMetadataForEachArgumentValue(o.length,r),l=n.arraysFlag&&!r.vectorizationForbidden;if(!this.isNumberOfArgumentValuesValid(a,o.length))return new c.CellError(c.ErrorType.NA,d.ErrorMessage.WrongArgNumber);const[t,u]=l?this.calculateSizeOfVectorizedResultArray(o,a):[1,1];return 1===t&&1===u?(e=this.vectorizeAndBroadcastArgumentsIfNecessary(l,o,a,0,0),this.calculateSingleCellOfResultArray(n,e,a,s,i,r.returnNumberType)):(e=[...Array(t).keys()].map(t=>[...Array(u).keys()].map(e=>{e=this.vectorizeAndBroadcastArgumentsIfNecessary(l,o,a,t,e),e=this.calculateSingleCellOfResultArray(n,e,a,s,i,r.returnNumberType);if(e instanceof p.SimpleRangeValue)throw new Error("Function returning array cannot be vectorized.");return e})),p.SimpleRangeValue.onlyValues(e))},this.runFunctionWithReferenceArgument=(e,t,n,r,i,o=()=>new c.CellError(c.ErrorType.NA,d.ErrorMessage.CellRefExpected))=>{if(0===e.length)return this.returnNumberWrapper(r(),n.returnNumberType);if(1<e.length)return new c.CellError(c.ErrorType.NA,d.ErrorMessage.WrongArgNumber);let s=e[0];for(;s.type===h.AstNodeType.PARENTHESIS;)s=s.expression;let a;if(s.type===h.AstNodeType.CELL_REFERENCE)a=s.reference.toSimpleCellAddress(t.formulaAddress);else if(s.type===h.AstNodeType.CELL_RANGE||s.type===h.AstNodeType.COLUMN_RANGE||s.type===h.AstNodeType.ROW_RANGE)try{a=u.AbsoluteCellRange.fromAst(s,t.formulaAddress).start}catch(e){return new c.CellError(c.ErrorType.REF,d.ErrorMessage.CellRefExpected)}return void 0!==a?this.returnNumberWrapper(i(a),n.returnNumberType):this.runFunction(e,t,n,o)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,t){return this.interpreter.evaluateAst(e,t)}arraySizeForAst(e,t){return this.arraySizePredictor.checkArraySizeForAst(e,t)}listOfScalarValues(e,t){var n=[];for(const i of e){var r=this.evaluateAst(i,t);if(r instanceof p.SimpleRangeValue)for(const o of r.valuesFromTopLeftCorner())n.push([o,!0]);else n.push([r,!1])}return n}coerceToType(e,t,n){let r;if(e instanceof p.SimpleRangeValue)switch(t.argumentType){case l.RANGE:case l.ANY:r=e;break;default:var i=(0,a.coerceRangeToScalar)(e,n);if(void 0===i)return;e=i}if(!(e instanceof p.SimpleRangeValue))switch(t.argumentType){case l.INTEGER:case l.NUMBER:var o=this.coerceScalarToNumberOrError(e);if((0,f.isExtendedNumber)(o)){var s=(0,f.getRawValue)(o);if(void 0!==t.maxValue&&s>t.maxValue)return new c.CellError(c.ErrorType.NUM,d.ErrorMessage.ValueLarge);if(void 0!==t.minValue&&s<t.minValue)return new c.CellError(c.ErrorType.NUM,d.ErrorMessage.ValueSmall);if(void 0!==t.lessThan&&s>=t.lessThan)return new c.CellError(c.ErrorType.NUM,d.ErrorMessage.ValueLarge);if(void 0!==t.greaterThan&&s<=t.greaterThan)return new c.CellError(c.ErrorType.NUM,d.ErrorMessage.ValueSmall);if(t.argumentType===l.INTEGER&&!Number.isInteger(s))return new c.CellError(c.ErrorType.NUM,d.ErrorMessage.IntegerExpected)}r=o;break;case l.STRING:r=(0,a.coerceScalarToString)(e);break;case l.BOOLEAN:r=(0,a.coerceScalarToBoolean)(e);break;case l.SCALAR:case l.NOERROR:case l.ANY:r=e;break;case l.RANGE:if(e instanceof c.CellError)return e;r=(0,a.coerceToRange)(e);break;case l.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex((0,f.getRawValue)(e))}return t.passSubtype||void 0===r?r:(0,f.getRawValue)(r)}calculateSingleCellOfResultArray(e,t,n,r,i,o){e=this.coerceArgumentsToRequiredTypes(e,t,n,r);return e instanceof c.CellError?e:(t=i(...e),this.returnNumberWrapper(t,o))}coerceArgumentsToRequiredTypes(t,n,r,i){var o=[];for(let e=0;e<r.length;e++){var s=r[e],a=void 0!==n[e]?n[e]:null==s?void 0:s.defaultValue;if(void 0===a)o.push(void 0);else{a=this.coerceToType(a,s,t);if(void 0===a&&!i[e])return new c.CellError(c.ErrorType.VALUE,d.ErrorMessage.WrongType);if(a instanceof c.CellError&&s.argumentType!==l.SCALAR)return a;o.push(a)}}return o}vectorizeAndBroadcastArgumentsIfNecessary(n,e,r,i,o){return e.map((e,t)=>n&&this.isRangePassedAsAScalarArgument(e,r[t])?this.vectorizeAndBroadcastRangeArgument(e,i,o):e)}vectorizeAndBroadcastRangeArgument(e,t,n){t=1===e.height()?0:t,n=1===e.width()?0:n;return null==(e=e.data[t])?void 0:e[n]}evaluateArguments(e,t,n){return n.expandRanges?this.listOfScalarValues(e,t):e.map(e=>[this.evaluateAst(e,t),!1])}buildMetadataForEachArgumentValue(e,t){var n=t.parameters?[...t.parameters]:[];if(void 0!==t.repeatLastArgs&&Number.isInteger(t.repeatLastArgs)&&0<t.repeatLastArgs)for(;e>n.length;)n.push(...n.slice(n.length-t.repeatLastArgs));return n}isNumberOfArgumentValuesValid(e,t){return!(t>e.length)&&(!(t<e.length)||e.slice(t).every(e=>(null==e?void 0:e.optionalArg)||void 0!==(null==e?void 0:e.defaultValue)))}calculateSizeOfVectorizedResultArray(e,n){e=e.filter((e,t)=>this.isRangePassedAsAScalarArgument(e,n[t]));return[Math.max(1,...e.map(e=>e.height())),Math.max(1,...e.map(e=>e.width()))]}isRangePassedAsAScalarArgument(e,t){return null!=e&&null!=t&&e instanceof p.SimpleRangeValue&&![l.RANGE,l.ANY].includes(t.argumentType)}metadata(e){var t=this.constructor.implementedFunctions[e];if(void 0!==t)return t;throw new Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,t,n){return void 0!==t&&(0,f.isExtendedNumber)(e)?this.arithmeticHelper.ExtendedNumberFactory((0,f.getRawValue)(e),{type:t,format:n}):e}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ArithmeticHelper:()=>d,coerceBooleanToNumber:()=>h,coerceComplexToString:()=>function([e,t],n){if(!isFinite(e)||!isFinite(t))return new l.CellError(l.ErrorType.NUM,i.ErrorMessage.NaN);if(n=null!=n?n:s,0===t)return""+e;n=""+(-1===t||1===t?"":Math.abs(t))+n;return 0!==e?e+(t<0?"-":"+")+n:(t<0?"-":"")+n},coerceEmptyToValue:()=>f,coerceRangeToScalar:()=>function(e,t){if(e.isAdHoc())return null==(n=e.data[0])?void 0:n[0];var n=e.range;if(t.formulaAddress.sheet===n.sheet)if(1===n.width()){var r=t.formulaAddress.row-n.start.row;if(0<=r&&r<n.height())return e.data[r][0]}else if(1===n.height()){r=t.formulaAddress.col-n.start.col;if(0<=r&&r<n.width())return e.data[0][r]}return},coerceScalarToBoolean:()=>function(e){return e instanceof l.CellError||"boolean"==typeof e?e:e!==u.EmptyValue&&((0,u.isExtendedNumber)(e)?0!==(0,u.getRawValue)(e):"TRUE"===(e=e.toUpperCase())||"FALSE"!==e&&""!==e&&void 0)},coerceScalarToString:()=>function(e){return e instanceof l.CellError||"string"==typeof e?e:e===u.EmptyValue?"":(0,u.isExtendedNumber)(e)?(0,u.getRawValue)(e).toString():e?"TRUE":"FALSE"},coerceToRange:()=>function(e){return e instanceof c.SimpleRangeValue?e:c.SimpleRangeValue.fromScalar(e)},coerceToRangeNumbersOrError:()=>function(e){return e instanceof c.SimpleRangeValue&&e.hasOnlyNumbers()||e instanceof l.CellError?e:(0,u.isExtendedNumber)(e)?c.SimpleRangeValue.fromScalar(e):null},fixNegativeZero:()=>function(e){return 0===e?0:e},forceNormalizeString:()=>function(e){return E(e.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")},isNumberOverflow:()=>function(e){return isNaN(e)||e===1/0||e===-1/0},normalizeString:()=>E,numberCmp:()=>p,zeroIfEmpty:()=>function(e){return e===u.EmptyValue?0:e}});var t=n(96),r=n.n(t),l=n(3),i=n(61),o=n(97),u=n(70),c=n(69);const s="i",a=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;class d{constructor(e,t,n){this.config=e,this.dateTimeHelper=t,this.numberLiteralsHelper=n,this.lt=(e,t)=>this.compare(e,t)<0,this.leq=(e,t)=>this.compare(e,t)<=0,this.gt=(e,t)=>0<this.compare(e,t),this.geq=(e,t)=>0<=this.compare(e,t),this.eq=(e,t)=>0===this.compare(e,t),this.neq=(e,t)=>0!==this.compare(e,t),this.pow=(e,t)=>Math.pow((0,u.getRawValue)(e),(0,u.getRawValue)(t)),this.addWithEpsilonRaw=(e,t)=>{t=e+t;return Math.abs(t)<this.actualEps*Math.abs(e)?0:t},this.addWithEpsilon=(e,t)=>{var n=v(e,t);return this.ExtendedNumberFactory(this.addWithEpsilonRaw((0,u.getRawValue)(e),(0,u.getRawValue)(t)),n)},this.unaryMinus=e=>(0,u.cloneNumber)(e,-(0,u.getRawValue)(e)),this.unaryPlus=e=>e,this.unaryPercent=e=>new u.PercentNumber((0,u.getRawValue)(e)/100),this.concat=(e,t)=>e.concat(t),this.nonstrictadd=(e,t)=>e instanceof l.CellError?e:t instanceof l.CellError?t:"number"==typeof e?"number"==typeof t?this.addWithEpsilonRaw(e,t):e:"number"==typeof t?t:0,this.subtract=(e,t)=>{var n=v(e,t),e=(0,u.getRawValue)(e);let r=e-(0,u.getRawValue)(t);return Math.abs(r)<this.actualEps*Math.abs(e)&&(r=0),this.ExtendedNumberFactory(r,n)},this.divide=(e,t)=>{var n=(0,u.getRawValue)(e),r=(0,u.getRawValue)(t);return 0===r?new l.CellError(l.ErrorType.DIV_BY_ZERO):(e=b(e,t),this.ExtendedNumberFactory(n/r,e))},this.multiply=(e,t)=>{var n=b(e,t);return this.ExtendedNumberFactory((0,u.getRawValue)(e)*(0,u.getRawValue)(t),n)},this.manyToExactComplex=e=>{var t,n=[];for(const r of e){if(r instanceof l.CellError)return r;!(0,u.isExtendedNumber)(r)&&"string"!=typeof r||(t=this.coerceScalarToComplex(r))instanceof l.CellError||n.push(t)}return n},this.coerceNumbersExactRanges=e=>this.manyToNumbers(e,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=e=>this.manyToNumbers(e,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=e=>{var t=[];for(const n of e){if(n instanceof l.CellError)return n;(0,u.isExtendedNumber)(n)&&t.push((0,u.getRawValue)(n))}return t},this.manyToOnlyNumbersDropNulls=e=>{var t=[];for(const n of e){if(n instanceof l.CellError)return n;if((0,u.isExtendedNumber)(n))t.push((0,u.getRawValue)(n));else if(n!==u.EmptyValue)return new l.CellError(l.ErrorType.VALUE,i.ErrorMessage.NumberExpected)}return t},this.manyToCoercedNumbersDropNulls=e=>{var t,n=[];for(const r of e){if(r instanceof l.CellError)return r;r!==u.EmptyValue&&(t=this.coerceScalarToNumberOrError(r),(0,u.isExtendedNumber)(t))&&n.push((0,u.getRawValue)(t))}return n},this.collator=(0,o.collatorFromConfig)(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){const t=this.buildRegex(e);return e=>"string"==typeof e&&t.test(this.normalizeString(e))}neqMatcherFunction(e){const t=this.buildRegex(e);return e=>!("string"==typeof e&&t.test(this.normalizeString(e)))}searchString(e,t){e=this.buildRegex(e,!1).exec(t);return null!=(t=null==e?void 0:e.index)?t:-1}requiresRegex(t){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let e=0;e<t.length;e++){var n=t.charAt(e);if(g(n)||this.config.useRegularExpressions&&y(n))return!0}return!1}floatCmp(e,t){var e=(0,u.getRawValue)(e),t=(0,u.getRawValue)(t),n=1+this.actualEps;return 0<=t&&t<=e*n&&e<=t*n||t<=0&&e*n<=t&&t*n<=e?0:t<e?1:-1}coerceScalarToNumberOrError(e){return e instanceof l.CellError||null!=(e=this.coerceToMaybeNumber(e))?e:new l.CellError(l.ErrorType.VALUE,i.ErrorMessage.NumberCoercion)}coerceToMaybeNumber(e){var t;return null!=(t=this.coerceNonDateScalarToMaybeNumber(e))?t:"string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){var t;return e===u.EmptyValue?0:"string"==typeof e?""===e?0:void 0!==(t=this.coerceStringToMaybePercentNumber(e))?t:void 0!==(t=this.coerceStringToMaybeCurrencyNumber(e))?t:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim()):(0,u.isExtendedNumber)(e)?e:"boolean"==typeof e?Number(e):void 0}coerceStringToMaybePercentNumber(e){e=e.trim();if(e.endsWith("%")){e=e.slice(0,e.length-1).trim(),e=this.numberLiteralsHelper.numericStringToMaybeNumber(e);if(void 0!==e)return new u.PercentNumber(e/100)}}coerceStringToMaybeCurrencyNumber(e){e=this.currencyMatcher(e.trim());if(void 0!==e){var[e,t]=e,t=this.numberLiteralsHelper.numericStringToMaybeNumber(t);if(void 0!==t)return new u.CurrencyNumber(t,e)}}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length).trim()];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length).trim()]}}coerceComplexExactRanges(e){var t=[];for(const o of e)if(o instanceof c.SimpleRangeValue)t.push(o);else if(o!==u.EmptyValue){var n=this.coerceScalarToComplex(o);if(n instanceof l.CellError)return n;t.push(n)}var r=[];for(const s of t)if(s instanceof c.SimpleRangeValue){var i=this.manyToExactComplex(s.valuesFromTopLeftCorner());if(i instanceof l.CellError)return i;r.push(...i)}else r.push(s);return r}coerceScalarToComplex(e){return e instanceof l.CellError?e:e===u.EmptyValue?[0,0]:(0,u.isExtendedNumber)(e)?[(0,u.getRawValue)(e),0]:"string"==typeof e?this.coerceStringToComplex(e):new l.CellError(l.ErrorType.NUM,i.ErrorMessage.ComplexNumberExpected)}ExtendedNumberFactory(e,t){var{type:t,format:n}=t;switch(t){case u.NumberType.NUMBER_RAW:return e;case u.NumberType.NUMBER_CURRENCY:return new u.CurrencyNumber(e,null!=n?n:this.config.currencySymbol[0]);case u.NumberType.NUMBER_DATE:return new u.DateNumber(e,n);case u.NumberType.NUMBER_DATETIME:return new u.DateTimeNumber(e,n);case u.NumberType.NUMBER_TIME:return new u.TimeNumber(e,n);case u.NumberType.NUMBER_PERCENT:return new u.PercentNumber(e,n)}}buildRegex(e,t=!0){e=this.normalizeString(e);let n,r=this.config.useWildcards,i=this.config.useRegularExpressions;if(i)try{RegExp(e)}catch(e){i=!1,r=!1}return n=(i?function(t,n){let r="";for(let e=0;e<t.length;e++){var i=t.charAt(e);g(i)||y(i)?r+=i:r+=n?i:i.toLowerCase()}return r}:r?function(t,n){let r="";for(let e=0;e<t.length;e++){var i,o=t.charAt(e);"~"===o?e==t.length-1?r+="~":(g(i=t.charAt(e+1))||y(i)?r+="\\"+i:r+=i,e++):g(o)?r+="."+o:y(o)?r+="\\"+o:r+=n?o:o.toLowerCase()}return r}:function(t,n){let r="";for(let e=0;e<t.length;e++){var i=t.charAt(e);g(i)||y(i)?r+="\\"+i:r+=n?i:i.toLowerCase()}return r})(e,this.config.caseSensitive),this.config.matchWholeCell&&t?RegExp("^("+n+")$"):RegExp(n)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),e=this.config.accentSensitive?e:E(e,"nfd").replace(/[\u0300-\u036f]/g,"")}compare(e,t){if("string"==typeof e||"string"==typeof t){var n="string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):e,r="string"==typeof t?this.dateTimeHelper.dateStringToDateNumber(t):t;if((0,u.isExtendedNumber)(n)&&(0,u.isExtendedNumber)(r))return this.floatCmp(n,r)}return e===u.EmptyValue?e=f(t):t===u.EmptyValue&&(t=f(e)),"string"==typeof e&&"string"==typeof t?this.stringCmp(e,t):"boolean"==typeof e&&"boolean"==typeof t?p(h(e),h(t)):(0,u.isExtendedNumber)(e)&&(0,u.isExtendedNumber)(t)?this.floatCmp(e,t):e===u.EmptyValue&&t===u.EmptyValue?0:p((0,l.CellValueTypeOrd)((0,l.getCellValueType)(e)),(0,l.CellValueTypeOrd)((0,l.getCellValueType)(t)))}stringCmp(e,t){return this.collator.compare(e,t)}manyToNumbers(e,t){var n=[];for(const s of e)if(s instanceof c.SimpleRangeValue)n.push(s);else{var r=(0,u.getRawValue)(this.coerceScalarToNumberOrError(s));if(r instanceof l.CellError)return r;n.push(r)}var i=[];for(const a of n)if(a instanceof c.SimpleRangeValue){var o=t(a.valuesFromTopLeftCorner());if(o instanceof l.CellError)return o;i.push(...o)}else i.push(a);return i}coerceStringToComplex(e){e=a.exec(e);if(null===e)return new l.CellError(l.ErrorType.NUM,i.ErrorMessage.ComplexNumberExpected);let t;if((t=void 0!==e[6]?"-"===e[1]?[0,-1]:[0,1]:this.parseComplexToken(e[1]+e[3],e[5]))instanceof l.CellError)return t;if(void 0===e[8])return t;let n;return(n=void 0!==e[14]?"-"===e[9]?[0,-1]:[0,1]:this.parseComplexToken(e[9]+e[11],e[13]))instanceof l.CellError?n:""!==e[5]||""===e[13]?new l.CellError(l.ErrorType.NUM,i.ErrorMessage.ComplexNumberExpected):"+"===e[8]?[t[0]+n[0],t[1]+n[1]]:[t[0]-n[0],t[1]-n[1]]}parseComplexToken(e,t){e=(0,u.getRawValue)(this.coerceNonDateScalarToMaybeNumber(e));return void 0===e?new l.CellError(l.ErrorType.NUM,i.ErrorMessage.ComplexNumberExpected):""===t?[e,0]:[0,e]}}function h(e){return Number(e)}function f(e){return"string"==typeof e?"":(0,u.isExtendedNumber)(e)?0:"boolean"!=typeof e&&u.EmptyValue}function p(e,t){e=(0,u.getRawValue)(e),t=(0,u.getRawValue)(t);return t<e?1:e<t?-1:0}function g(e){return["*","?"].includes(e)}const m=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function y(e){return m.includes(e)}function v(e,t){var{type:e,format:n}=(0,u.getTypeFormatOfExtendedNumber)(e),{type:t,format:r}=(0,u.getTypeFormatOfExtendedNumber)(t);if(e===u.NumberType.NUMBER_RAW)return{type:t,format:r};if(t!==u.NumberType.NUMBER_RAW){if(!(e!==u.NumberType.NUMBER_DATETIME&&e!==u.NumberType.NUMBER_DATE||t!==u.NumberType.NUMBER_DATETIME&&t!==u.NumberType.NUMBER_DATE))return{type:u.NumberType.NUMBER_RAW};if(e===u.NumberType.NUMBER_TIME){if(t===u.NumberType.NUMBER_DATE)return{type:u.NumberType.NUMBER_DATETIME,format:r+" "+n};if(t===u.NumberType.NUMBER_DATETIME)return{type:u.NumberType.NUMBER_DATETIME,format:r}}if(t===u.NumberType.NUMBER_TIME){if(e===u.NumberType.NUMBER_DATE)return{type:u.NumberType.NUMBER_DATETIME,format:n+" "+r};if(e===u.NumberType.NUMBER_DATETIME)return{type:u.NumberType.NUMBER_DATETIME,format:n}}}return{type:e,format:n}}function b(e,t){let{type:n,format:r}=(0,u.getTypeFormatOfExtendedNumber)(e),{type:i,format:o}=(0,u.getTypeFormatOfExtendedNumber)(t);return n===u.NumberType.NUMBER_PERCENT&&(n=u.NumberType.NUMBER_RAW,r=void 0),i===u.NumberType.NUMBER_PERCENT&&(i=u.NumberType.NUMBER_RAW,o=void 0),n===u.NumberType.NUMBER_RAW?{type:i,format:o}:i===u.NumberType.NUMBER_RAW?{type:n,format:r}:{type:u.NumberType.NUMBER_RAW}}function E(e,t){return"function"==typeof e.normalize?e.normalize(t.toUpperCase()):r()[t](e)}},function(f){!function(){"use strict";for(var i=[null,0,{}],a=function(e,t){this.codepoint=e,this.feature=t},o={},s=[],e=0;e<=255;++e)s[e]=0;function n(e){this.str=e,this.cursor=0}function r(e,t){this.it=e,this.canonical=t,this.resBuf=[]}function l(e){this.it=e,this.resBuf=[]}function u(e){this.it=e,this.procBuf=[],this.resBuf=[],this.lastClass=null}function t(e,t){for(var n,r=d(e,t),i="";n=r.next();)i+=n.toString();return i}var c=[function(e,t,n){return t<60||13311<t&&t<42607?new a(t,i):e(t,n)},function(e,t,n){var r=o[t];return r||(r=e(t,n)).feature&&10<++s[t>>8&255]&&(o[t]=r),r},function(e,t,n){return n?e(t,n):new a(t,null)},function(e,t,n){if(t<4352||4371<=t&&t<44032||55204<t)return e(t,n);if(4352<=t&&t<4371){for(var r={},i=21*(t-4352),o=0;o<21;++o)r[4449+o]=44032+28*(o+i);return new a(t,[,,r])}var s=[];if(0!=(n=(e=t-44032)%28))s[0]=[44032+e-n,4519+n];else for(s[0]=[4352+Math.floor(e/588),4449+Math.floor(e%588/28)],s[2]={},o=1;o<28;++o)s[2][4519+o]=t+o;return new a(t,s)},function(e,t,n){var r=(a.udata[65280&t]||{})[t];return new a(t,r||i)}],d=(a.fromCharCode=c.reduceRight(function(n,r){return function(e,t){return r(n,e,t)}},null),a.isHighSurrogate=function(e){return 55296<=e&&e<=56319},a.isLowSurrogate=function(e){return 56320<=e&&e<=57343},a.prototype.prepFeature=function(){this.feature||(this.feature=a.fromCharCode(this.codepoint,!0).feature)},a.prototype.toString=function(){var e;return this.codepoint<65536?String.fromCharCode(this.codepoint):(e=this.codepoint-65536,String.fromCharCode(Math.floor(e/1024)+55296,e%1024+56320))},a.prototype.getDecomp=function(){return this.prepFeature(),this.feature[0]||null},a.prototype.isCompatibility=function(){return this.prepFeature(),!!this.feature[1]&&256&this.feature[1]},a.prototype.isExclude=function(){return this.prepFeature(),!!this.feature[1]&&512&this.feature[1]},a.prototype.getCanonicalClass=function(){return this.prepFeature(),this.feature[1]?255&this.feature[1]:0},a.prototype.getComposite=function(e){return this.prepFeature(),this.feature[2]&&(e=this.feature[2][e.codepoint])?a.fromCharCode(e):null},n.prototype.next=function(){var e,t;return this.str&&this.cursor<this.str.length?(e=this.str.charCodeAt(this.cursor++),a.isHighSurrogate(e)&&this.cursor<this.str.length&&a.isLowSurrogate(t=this.str.charCodeAt(this.cursor))&&(e=1024*(e-55296)+(t-56320)+65536,++this.cursor),a.fromCharCode(e)):this.str=null},r.prototype.next=function(){if(0===this.resBuf.length){var e=this.it.next();if(!e)return null;this.resBuf=function e(t,n){var r=n.getDecomp();if(!r||t&&n.isCompatibility())return[n];for(var i=[],o=0;o<r.length;++o)var s=e(t,a.fromCharCode(r[o])),i=i.concat(s);return i}(this.canonical,e)}return this.resBuf.shift()},l.prototype.next=function(){if(0===this.resBuf.length)do{var e=this.it.next();if(!e)break;var t=e.getCanonicalClass(),n=this.resBuf.length;if(0!==t)for(;0<n;--n)if(this.resBuf[n-1].getCanonicalClass()<=t)break}while(this.resBuf.splice(n,0,e),0!==t);return this.resBuf.shift()},u.prototype.next=function(){for(;0===this.resBuf.length;){var e,t,n=this.it.next();if(!n){this.resBuf=this.procBuf,this.procBuf=[];break}0===this.procBuf.length?(this.lastClass=n.getCanonicalClass(),this.procBuf.push(n)):(e=this.procBuf[0].getComposite(n),t=n.getCanonicalClass(),e&&(this.lastClass<t||0===this.lastClass)?this.procBuf[0]=e:(0===t&&(this.resBuf=this.procBuf,this.procBuf=[]),this.lastClass=t,this.procBuf.push(n)))}return this.resBuf.shift()},function(e,t){switch(e){case"NFD":return new l(new r(new n(t),!0));case"NFKD":return new l(new r(new n(t),!1));case"NFC":return new u(new l(new r(new n(t),!0)));case"NFKC":return new u(new l(new r(new n(t),!1)))}throw e+" is invalid"});a.udata={0:{60:[,,{824:8814}],61:[,,{824:8800}],62:[,,{824:8815}],65:[,,{768:192,769:193,770:194,771:195,772:256,774:258,775:550,776:196,777:7842,778:197,780:461,783:512,785:514,803:7840,805:7680,808:260}],66:[,,{775:7682,803:7684,817:7686}],67:[,,{769:262,770:264,775:266,780:268,807:199}],68:[,,{775:7690,780:270,803:7692,807:7696,813:7698,817:7694}],69:[,,{768:200,769:201,770:202,771:7868,772:274,774:276,775:278,776:203,777:7866,780:282,783:516,785:518,803:7864,807:552,808:280,813:7704,816:7706}],70:[,,{775:7710}],71:[,,{769:500,770:284,772:7712,774:286,775:288,780:486,807:290}],72:[,,{770:292,775:7714,776:7718,780:542,803:7716,807:7720,814:7722}],73:[,,{768:204,769:205,770:206,771:296,772:298,774:300,775:304,776:207,777:7880,780:463,783:520,785:522,803:7882,808:302,816:7724}],74:[,,{770:308}],75:[,,{769:7728,780:488,803:7730,807:310,817:7732}],76:[,,{769:313,780:317,803:7734,807:315,813:7740,817:7738}],77:[,,{769:7742,775:7744,803:7746}],78:[,,{768:504,769:323,771:209,775:7748,780:327,803:7750,807:325,813:7754,817:7752}],79:[,,{768:210,769:211,770:212,771:213,772:332,774:334,775:558,776:214,777:7886,779:336,780:465,783:524,785:526,795:416,803:7884,808:490}],80:[,,{769:7764,775:7766}],82:[,,{769:340,775:7768,780:344,783:528,785:530,803:7770,807:342,817:7774}],83:[,,{769:346,770:348,775:7776,780:352,803:7778,806:536,807:350}],84:[,,{775:7786,780:356,803:7788,806:538,807:354,813:7792,817:7790}],85:[,,{768:217,769:218,770:219,771:360,772:362,774:364,776:220,777:7910,778:366,779:368,780:467,783:532,785:534,795:431,803:7908,804:7794,808:370,813:7798,816:7796}],86:[,,{771:7804,803:7806}],87:[,,{768:7808,769:7810,770:372,775:7814,776:7812,803:7816}],88:[,,{775:7818,776:7820}],89:[,,{768:7922,769:221,770:374,771:7928,772:562,775:7822,776:376,777:7926,803:7924}],90:[,,{769:377,770:7824,775:379,780:381,803:7826,817:7828}],97:[,,{768:224,769:225,770:226,771:227,772:257,774:259,775:551,776:228,777:7843,778:229,780:462,783:513,785:515,803:7841,805:7681,808:261}],98:[,,{775:7683,803:7685,817:7687}],99:[,,{769:263,770:265,775:267,780:269,807:231}],100:[,,{775:7691,780:271,803:7693,807:7697,813:7699,817:7695}],101:[,,{768:232,769:233,770:234,771:7869,772:275,774:277,775:279,776:235,777:7867,780:283,783:517,785:519,803:7865,807:553,808:281,813:7705,816:7707}],102:[,,{775:7711}],103:[,,{769:501,770:285,772:7713,774:287,775:289,780:487,807:291}],104:[,,{770:293,775:7715,776:7719,780:543,803:7717,807:7721,814:7723,817:7830}],105:[,,{768:236,769:237,770:238,771:297,772:299,774:301,776:239,777:7881,780:464,783:521,785:523,803:7883,808:303,816:7725}],106:[,,{770:309,780:496}],107:[,,{769:7729,780:489,803:7731,807:311,817:7733}],108:[,,{769:314,780:318,803:7735,807:316,813:7741,817:7739}],109:[,,{769:7743,775:7745,803:7747}],110:[,,{768:505,769:324,771:241,775:7749,780:328,803:7751,807:326,813:7755,817:7753}],111:[,,{768:242,769:243,770:244,771:245,772:333,774:335,775:559,776:246,777:7887,779:337,780:466,783:525,785:527,795:417,803:7885,808:491}],112:[,,{769:7765,775:7767}],114:[,,{769:341,775:7769,780:345,783:529,785:531,803:7771,807:343,817:7775}],115:[,,{769:347,770:349,775:7777,780:353,803:7779,806:537,807:351}],116:[,,{775:7787,776:7831,780:357,803:7789,806:539,807:355,813:7793,817:7791}],117:[,,{768:249,769:250,770:251,771:361,772:363,774:365,776:252,777:7911,778:367,779:369,780:468,783:533,785:535,795:432,803:7909,804:7795,808:371,813:7799,816:7797}],118:[,,{771:7805,803:7807}],119:[,,{768:7809,769:7811,770:373,775:7815,776:7813,778:7832,803:7817}],120:[,,{775:7819,776:7821}],121:[,,{768:7923,769:253,770:375,771:7929,772:563,775:7823,776:255,777:7927,778:7833,803:7925}],122:[,,{769:378,770:7825,775:380,780:382,803:7827,817:7829}],160:[[32],256],168:[[32,776],256,{768:8173,769:901,834:8129}],170:[[97],256],175:[[32,772],256],178:[[50],256],179:[[51],256],180:[[32,769],256],181:[[956],256],184:[[32,807],256],185:[[49],256],186:[[111],256],188:[[49,8260,52],256],189:[[49,8260,50],256],190:[[51,8260,52],256],192:[[65,768]],193:[[65,769]],194:[[65,770],,{768:7846,769:7844,771:7850,777:7848}],195:[[65,771]],196:[[65,776],,{772:478}],197:[[65,778],,{769:506}],198:[,,{769:508,772:482}],199:[[67,807],,{769:7688}],200:[[69,768]],201:[[69,769]],202:[[69,770],,{768:7872,769:7870,771:7876,777:7874}],203:[[69,776]],204:[[73,768]],205:[[73,769]],206:[[73,770]],207:[[73,776],,{769:7726}],209:[[78,771]],210:[[79,768]],211:[[79,769]],212:[[79,770],,{768:7890,769:7888,771:7894,777:7892}],213:[[79,771],,{769:7756,772:556,776:7758}],214:[[79,776],,{772:554}],216:[,,{769:510}],217:[[85,768]],218:[[85,769]],219:[[85,770]],220:[[85,776],,{768:475,769:471,772:469,780:473}],221:[[89,769]],224:[[97,768]],225:[[97,769]],226:[[97,770],,{768:7847,769:7845,771:7851,777:7849}],227:[[97,771]],228:[[97,776],,{772:479}],229:[[97,778],,{769:507}],230:[,,{769:509,772:483}],231:[[99,807],,{769:7689}],232:[[101,768]],233:[[101,769]],234:[[101,770],,{768:7873,769:7871,771:7877,777:7875}],235:[[101,776]],236:[[105,768]],237:[[105,769]],238:[[105,770]],239:[[105,776],,{769:7727}],241:[[110,771]],242:[[111,768]],243:[[111,769]],244:[[111,770],,{768:7891,769:7889,771:7895,777:7893}],245:[[111,771],,{769:7757,772:557,776:7759}],246:[[111,776],,{772:555}],248:[,,{769:511}],249:[[117,768]],250:[[117,769]],251:[[117,770]],252:[[117,776],,{768:476,769:472,772:470,780:474}],253:[[121,769]],255:[[121,776]]},256:{256:[[65,772]],257:[[97,772]],258:[[65,774],,{768:7856,769:7854,771:7860,777:7858}],259:[[97,774],,{768:7857,769:7855,771:7861,777:7859}],260:[[65,808]],261:[[97,808]],262:[[67,769]],263:[[99,769]],264:[[67,770]],265:[[99,770]],266:[[67,775]],267:[[99,775]],268:[[67,780]],269:[[99,780]],270:[[68,780]],271:[[100,780]],274:[[69,772],,{768:7700,769:7702}],275:[[101,772],,{768:7701,769:7703}],276:[[69,774]],277:[[101,774]],278:[[69,775]],279:[[101,775]],280:[[69,808]],281:[[101,808]],282:[[69,780]],283:[[101,780]],284:[[71,770]],285:[[103,770]],286:[[71,774]],287:[[103,774]],288:[[71,775]],289:[[103,775]],290:[[71,807]],291:[[103,807]],292:[[72,770]],293:[[104,770]],296:[[73,771]],297:[[105,771]],298:[[73,772]],299:[[105,772]],300:[[73,774]],301:[[105,774]],302:[[73,808]],303:[[105,808]],304:[[73,775]],306:[[73,74],256],307:[[105,106],256],308:[[74,770]],309:[[106,770]],310:[[75,807]],311:[[107,807]],313:[[76,769]],314:[[108,769]],315:[[76,807]],316:[[108,807]],317:[[76,780]],318:[[108,780]],319:[[76,183],256],320:[[108,183],256],323:[[78,769]],324:[[110,769]],325:[[78,807]],326:[[110,807]],327:[[78,780]],328:[[110,780]],329:[[700,110],256],332:[[79,772],,{768:7760,769:7762}],333:[[111,772],,{768:7761,769:7763}],334:[[79,774]],335:[[111,774]],336:[[79,779]],337:[[111,779]],340:[[82,769]],341:[[114,769]],342:[[82,807]],343:[[114,807]],344:[[82,780]],345:[[114,780]],346:[[83,769],,{775:7780}],347:[[115,769],,{775:7781}],348:[[83,770]],349:[[115,770]],350:[[83,807]],351:[[115,807]],352:[[83,780],,{775:7782}],353:[[115,780],,{775:7783}],354:[[84,807]],355:[[116,807]],356:[[84,780]],357:[[116,780]],360:[[85,771],,{769:7800}],361:[[117,771],,{769:7801}],362:[[85,772],,{776:7802}],363:[[117,772],,{776:7803}],364:[[85,774]],365:[[117,774]],366:[[85,778]],367:[[117,778]],368:[[85,779]],369:[[117,779]],370:[[85,808]],371:[[117,808]],372:[[87,770]],373:[[119,770]],374:[[89,770]],375:[[121,770]],376:[[89,776]],377:[[90,769]],378:[[122,769]],379:[[90,775]],380:[[122,775]],381:[[90,780]],382:[[122,780]],383:[[115],256,{775:7835}],416:[[79,795],,{768:7900,769:7898,771:7904,777:7902,803:7906}],417:[[111,795],,{768:7901,769:7899,771:7905,777:7903,803:7907}],431:[[85,795],,{768:7914,769:7912,771:7918,777:7916,803:7920}],432:[[117,795],,{768:7915,769:7913,771:7919,777:7917,803:7921}],439:[,,{780:494}],452:[[68,381],256],453:[[68,382],256],454:[[100,382],256],455:[[76,74],256],456:[[76,106],256],457:[[108,106],256],458:[[78,74],256],459:[[78,106],256],460:[[110,106],256],461:[[65,780]],462:[[97,780]],463:[[73,780]],464:[[105,780]],465:[[79,780]],466:[[111,780]],467:[[85,780]],468:[[117,780]],469:[[220,772]],470:[[252,772]],471:[[220,769]],472:[[252,769]],473:[[220,780]],474:[[252,780]],475:[[220,768]],476:[[252,768]],478:[[196,772]],479:[[228,772]],480:[[550,772]],481:[[551,772]],482:[[198,772]],483:[[230,772]],486:[[71,780]],487:[[103,780]],488:[[75,780]],489:[[107,780]],490:[[79,808],,{772:492}],491:[[111,808],,{772:493}],492:[[490,772]],493:[[491,772]],494:[[439,780]],495:[[658,780]],496:[[106,780]],497:[[68,90],256],498:[[68,122],256],499:[[100,122],256],500:[[71,769]],501:[[103,769]],504:[[78,768]],505:[[110,768]],506:[[197,769]],507:[[229,769]],508:[[198,769]],509:[[230,769]],510:[[216,769]],511:[[248,769]],66045:[,220]},512:{512:[[65,783]],513:[[97,783]],514:[[65,785]],515:[[97,785]],516:[[69,783]],517:[[101,783]],518:[[69,785]],519:[[101,785]],520:[[73,783]],521:[[105,783]],522:[[73,785]],523:[[105,785]],524:[[79,783]],525:[[111,783]],526:[[79,785]],527:[[111,785]],528:[[82,783]],529:[[114,783]],530:[[82,785]],531:[[114,785]],532:[[85,783]],533:[[117,783]],534:[[85,785]],535:[[117,785]],536:[[83,806]],537:[[115,806]],538:[[84,806]],539:[[116,806]],542:[[72,780]],543:[[104,780]],550:[[65,775],,{772:480}],551:[[97,775],,{772:481}],552:[[69,807],,{774:7708}],553:[[101,807],,{774:7709}],554:[[214,772]],555:[[246,772]],556:[[213,772]],557:[[245,772]],558:[[79,775],,{772:560}],559:[[111,775],,{772:561}],560:[[558,772]],561:[[559,772]],562:[[89,772]],563:[[121,772]],658:[,,{780:495}],688:[[104],256],689:[[614],256],690:[[106],256],691:[[114],256],692:[[633],256],693:[[635],256],694:[[641],256],695:[[119],256],696:[[121],256],728:[[32,774],256],729:[[32,775],256],730:[[32,778],256],731:[[32,808],256],732:[[32,771],256],733:[[32,779],256],736:[[611],256],737:[[108],256],738:[[115],256],739:[[120],256],740:[[661],256],66272:[,220]},768:{768:[,230],769:[,230],770:[,230],771:[,230],772:[,230],773:[,230],774:[,230],775:[,230],776:[,230,{769:836}],777:[,230],778:[,230],779:[,230],780:[,230],781:[,230],782:[,230],783:[,230],784:[,230],785:[,230],786:[,230],787:[,230],788:[,230],789:[,232],790:[,220],791:[,220],792:[,220],793:[,220],794:[,232],795:[,216],796:[,220],797:[,220],798:[,220],799:[,220],800:[,220],801:[,202],802:[,202],803:[,220],804:[,220],805:[,220],806:[,220],807:[,202],808:[,202],809:[,220],810:[,220],811:[,220],812:[,220],813:[,220],814:[,220],815:[,220],816:[,220],817:[,220],818:[,220],819:[,220],820:[,1],821:[,1],822:[,1],823:[,1],824:[,1],825:[,220],826:[,220],827:[,220],828:[,220],829:[,230],830:[,230],831:[,230],832:[[768],230],833:[[769],230],834:[,230],835:[[787],230],836:[[776,769],230],837:[,240],838:[,230],839:[,220],840:[,220],841:[,220],842:[,230],843:[,230],844:[,230],845:[,220],846:[,220],848:[,230],849:[,230],850:[,230],851:[,220],852:[,220],853:[,220],854:[,220],855:[,230],856:[,232],857:[,220],858:[,220],859:[,230],860:[,233],861:[,234],862:[,234],863:[,233],864:[,234],865:[,234],866:[,233],867:[,230],868:[,230],869:[,230],870:[,230],871:[,230],872:[,230],873:[,230],874:[,230],875:[,230],876:[,230],877:[,230],878:[,230],879:[,230],884:[[697]],890:[[32,837],256],894:[[59]],900:[[32,769],256],901:[[168,769]],902:[[913,769]],903:[[183]],904:[[917,769]],905:[[919,769]],906:[[921,769]],908:[[927,769]],910:[[933,769]],911:[[937,769]],912:[[970,769]],913:[,,{768:8122,769:902,772:8121,774:8120,787:7944,788:7945,837:8124}],917:[,,{768:8136,769:904,787:7960,788:7961}],919:[,,{768:8138,769:905,787:7976,788:7977,837:8140}],921:[,,{768:8154,769:906,772:8153,774:8152,776:938,787:7992,788:7993}],927:[,,{768:8184,769:908,787:8008,788:8009}],929:[,,{788:8172}],933:[,,{768:8170,769:910,772:8169,774:8168,776:939,788:8025}],937:[,,{768:8186,769:911,787:8040,788:8041,837:8188}],938:[[921,776]],939:[[933,776]],940:[[945,769],,{837:8116}],941:[[949,769]],942:[[951,769],,{837:8132}],943:[[953,769]],944:[[971,769]],945:[,,{768:8048,769:940,772:8113,774:8112,787:7936,788:7937,834:8118,837:8115}],949:[,,{768:8050,769:941,787:7952,788:7953}],951:[,,{768:8052,769:942,787:7968,788:7969,834:8134,837:8131}],953:[,,{768:8054,769:943,772:8145,774:8144,776:970,787:7984,788:7985,834:8150}],959:[,,{768:8056,769:972,787:8e3,788:8001}],961:[,,{787:8164,788:8165}],965:[,,{768:8058,769:973,772:8161,774:8160,776:971,787:8016,788:8017,834:8166}],969:[,,{768:8060,769:974,787:8032,788:8033,834:8182,837:8179}],970:[[953,776],,{768:8146,769:912,834:8151}],971:[[965,776],,{768:8162,769:944,834:8167}],972:[[959,769]],973:[[965,769]],974:[[969,769],,{837:8180}],976:[[946],256],977:[[952],256],978:[[933],256,{769:979,776:980}],979:[[978,769]],980:[[978,776]],981:[[966],256],982:[[960],256],1008:[[954],256],1009:[[961],256],1010:[[962],256],1012:[[920],256],1013:[[949],256],1017:[[931],256],66422:[,230],66423:[,230],66424:[,230],66425:[,230],66426:[,230]},1024:{1024:[[1045,768]],1025:[[1045,776]],1027:[[1043,769]],1030:[,,{776:1031}],1031:[[1030,776]],1036:[[1050,769]],1037:[[1048,768]],1038:[[1059,774]],1040:[,,{774:1232,776:1234}],1043:[,,{769:1027}],1045:[,,{768:1024,774:1238,776:1025}],1046:[,,{774:1217,776:1244}],1047:[,,{776:1246}],1048:[,,{768:1037,772:1250,774:1049,776:1252}],1049:[[1048,774]],1050:[,,{769:1036}],1054:[,,{776:1254}],1059:[,,{772:1262,774:1038,776:1264,779:1266}],1063:[,,{776:1268}],1067:[,,{776:1272}],1069:[,,{776:1260}],1072:[,,{774:1233,776:1235}],1075:[,,{769:1107}],1077:[,,{768:1104,774:1239,776:1105}],1078:[,,{774:1218,776:1245}],1079:[,,{776:1247}],1080:[,,{768:1117,772:1251,774:1081,776:1253}],1081:[[1080,774]],1082:[,,{769:1116}],1086:[,,{776:1255}],1091:[,,{772:1263,774:1118,776:1265,779:1267}],1095:[,,{776:1269}],1099:[,,{776:1273}],1101:[,,{776:1261}],1104:[[1077,768]],1105:[[1077,776]],1107:[[1075,769]],1110:[,,{776:1111}],1111:[[1110,776]],1116:[[1082,769]],1117:[[1080,768]],1118:[[1091,774]],1140:[,,{783:1142}],1141:[,,{783:1143}],1142:[[1140,783]],1143:[[1141,783]],1155:[,230],1156:[,230],1157:[,230],1158:[,230],1159:[,230],1217:[[1046,774]],1218:[[1078,774]],1232:[[1040,774]],1233:[[1072,774]],1234:[[1040,776]],1235:[[1072,776]],1238:[[1045,774]],1239:[[1077,774]],1240:[,,{776:1242}],1241:[,,{776:1243}],1242:[[1240,776]],1243:[[1241,776]],1244:[[1046,776]],1245:[[1078,776]],1246:[[1047,776]],1247:[[1079,776]],1250:[[1048,772]],1251:[[1080,772]],1252:[[1048,776]],1253:[[1080,776]],1254:[[1054,776]],1255:[[1086,776]],1256:[,,{776:1258}],1257:[,,{776:1259}],1258:[[1256,776]],1259:[[1257,776]],1260:[[1069,776]],1261:[[1101,776]],1262:[[1059,772]],1263:[[1091,772]],1264:[[1059,776]],1265:[[1091,776]],1266:[[1059,779]],1267:[[1091,779]],1268:[[1063,776]],1269:[[1095,776]],1272:[[1067,776]],1273:[[1099,776]]},1280:{1415:[[1381,1410],256],1425:[,220],1426:[,230],1427:[,230],1428:[,230],1429:[,230],1430:[,220],1431:[,230],1432:[,230],1433:[,230],1434:[,222],1435:[,220],1436:[,230],1437:[,230],1438:[,230],1439:[,230],1440:[,230],1441:[,230],1442:[,220],1443:[,220],1444:[,220],1445:[,220],1446:[,220],1447:[,220],1448:[,230],1449:[,230],1450:[,220],1451:[,230],1452:[,230],1453:[,222],1454:[,228],1455:[,230],1456:[,10],1457:[,11],1458:[,12],1459:[,13],1460:[,14],1461:[,15],1462:[,16],1463:[,17],1464:[,18],1465:[,19],1466:[,19],1467:[,20],1468:[,21],1469:[,22],1471:[,23],1473:[,24],1474:[,25],1476:[,230],1477:[,220],1479:[,18]},1536:{1552:[,230],1553:[,230],1554:[,230],1555:[,230],1556:[,230],1557:[,230],1558:[,230],1559:[,230],1560:[,30],1561:[,31],1562:[,32],1570:[[1575,1619]],1571:[[1575,1620]],1572:[[1608,1620]],1573:[[1575,1621]],1574:[[1610,1620]],1575:[,,{1619:1570,1620:1571,1621:1573}],1608:[,,{1620:1572}],1610:[,,{1620:1574}],1611:[,27],1612:[,28],1613:[,29],1614:[,30],1615:[,31],1616:[,32],1617:[,33],1618:[,34],1619:[,230],1620:[,230],1621:[,220],1622:[,220],1623:[,230],1624:[,230],1625:[,230],1626:[,230],1627:[,230],1628:[,220],1629:[,230],1630:[,230],1631:[,220],1648:[,35],1653:[[1575,1652],256],1654:[[1608,1652],256],1655:[[1735,1652],256],1656:[[1610,1652],256],1728:[[1749,1620]],1729:[,,{1620:1730}],1730:[[1729,1620]],1746:[,,{1620:1747}],1747:[[1746,1620]],1749:[,,{1620:1728}],1750:[,230],1751:[,230],1752:[,230],1753:[,230],1754:[,230],1755:[,230],1756:[,230],1759:[,230],1760:[,230],1761:[,230],1762:[,230],1763:[,220],1764:[,230],1767:[,230],1768:[,230],1770:[,220],1771:[,230],1772:[,230],1773:[,220]},1792:{1809:[,36],1840:[,230],1841:[,220],1842:[,230],1843:[,230],1844:[,220],1845:[,230],1846:[,230],1847:[,220],1848:[,220],1849:[,220],1850:[,230],1851:[,220],1852:[,220],1853:[,230],1854:[,220],1855:[,230],1856:[,230],1857:[,230],1858:[,220],1859:[,230],1860:[,220],1861:[,230],1862:[,220],1863:[,230],1864:[,220],1865:[,230],1866:[,230],2027:[,230],2028:[,230],2029:[,230],2030:[,230],2031:[,230],2032:[,230],2033:[,230],2034:[,220],2035:[,230]},2048:{2070:[,230],2071:[,230],2072:[,230],2073:[,230],2075:[,230],2076:[,230],2077:[,230],2078:[,230],2079:[,230],2080:[,230],2081:[,230],2082:[,230],2083:[,230],2085:[,230],2086:[,230],2087:[,230],2089:[,230],2090:[,230],2091:[,230],2092:[,230],2093:[,230],2137:[,220],2138:[,220],2139:[,220],2276:[,230],2277:[,230],2278:[,220],2279:[,230],2280:[,230],2281:[,220],2282:[,230],2283:[,230],2284:[,230],2285:[,220],2286:[,220],2287:[,220],2288:[,27],2289:[,28],2290:[,29],2291:[,230],2292:[,230],2293:[,230],2294:[,220],2295:[,230],2296:[,230],2297:[,220],2298:[,220],2299:[,230],2300:[,230],2301:[,230],2302:[,230],2303:[,230]},2304:{2344:[,,{2364:2345}],2345:[[2344,2364]],2352:[,,{2364:2353}],2353:[[2352,2364]],2355:[,,{2364:2356}],2356:[[2355,2364]],2364:[,7],2381:[,9],2385:[,230],2386:[,220],2387:[,230],2388:[,230],2392:[[2325,2364],512],2393:[[2326,2364],512],2394:[[2327,2364],512],2395:[[2332,2364],512],2396:[[2337,2364],512],2397:[[2338,2364],512],2398:[[2347,2364],512],2399:[[2351,2364],512],2492:[,7],2503:[,,{2494:2507,2519:2508}],2507:[[2503,2494]],2508:[[2503,2519]],2509:[,9],2524:[[2465,2492],512],2525:[[2466,2492],512],2527:[[2479,2492],512]},2560:{2611:[[2610,2620],512],2614:[[2616,2620],512],2620:[,7],2637:[,9],2649:[[2582,2620],512],2650:[[2583,2620],512],2651:[[2588,2620],512],2654:[[2603,2620],512],2748:[,7],2765:[,9],68109:[,220],68111:[,230],68152:[,230],68153:[,1],68154:[,220],68159:[,9],68325:[,230],68326:[,220]},2816:{2876:[,7],2887:[,,{2878:2891,2902:2888,2903:2892}],2888:[[2887,2902]],2891:[[2887,2878]],2892:[[2887,2903]],2893:[,9],2908:[[2849,2876],512],2909:[[2850,2876],512],2962:[,,{3031:2964}],2964:[[2962,3031]],3014:[,,{3006:3018,3031:3020}],3015:[,,{3006:3019}],3018:[[3014,3006]],3019:[[3015,3006]],3020:[[3014,3031]],3021:[,9]},3072:{3142:[,,{3158:3144}],3144:[[3142,3158]],3149:[,9],3157:[,84],3158:[,91],3260:[,7],3263:[,,{3285:3264}],3264:[[3263,3285]],3270:[,,{3266:3274,3285:3271,3286:3272}],3271:[[3270,3285]],3272:[[3270,3286]],3274:[[3270,3266],,{3285:3275}],3275:[[3274,3285]],3277:[,9]},3328:{3398:[,,{3390:3402,3415:3404}],3399:[,,{3390:3403}],3402:[[3398,3390]],3403:[[3399,3390]],3404:[[3398,3415]],3405:[,9],3530:[,9],3545:[,,{3530:3546,3535:3548,3551:3550}],3546:[[3545,3530]],3548:[[3545,3535],,{3530:3549}],3549:[[3548,3530]],3550:[[3545,3551]]},3584:{3635:[[3661,3634],256],3640:[,103],3641:[,103],3642:[,9],3656:[,107],3657:[,107],3658:[,107],3659:[,107],3763:[[3789,3762],256],3768:[,118],3769:[,118],3784:[,122],3785:[,122],3786:[,122],3787:[,122],3804:[[3755,3737],256],3805:[[3755,3745],256]},3840:{3852:[[3851],256],3864:[,220],3865:[,220],3893:[,220],3895:[,220],3897:[,216],3907:[[3906,4023],512],3917:[[3916,4023],512],3922:[[3921,4023],512],3927:[[3926,4023],512],3932:[[3931,4023],512],3945:[[3904,4021],512],3953:[,129],3954:[,130],3955:[[3953,3954],512],3956:[,132],3957:[[3953,3956],512],3958:[[4018,3968],512],3959:[[4018,3969],256],3960:[[4019,3968],512],3961:[[4019,3969],256],3962:[,130],3963:[,130],3964:[,130],3965:[,130],3968:[,130],3969:[[3953,3968],512],3970:[,230],3971:[,230],3972:[,9],3974:[,230],3975:[,230],3987:[[3986,4023],512],3997:[[3996,4023],512],4002:[[4001,4023],512],4007:[[4006,4023],512],4012:[[4011,4023],512],4025:[[3984,4021],512],4038:[,220]},4096:{4133:[,,{4142:4134}],4134:[[4133,4142]],4151:[,7],4153:[,9],4154:[,9],4237:[,220],4348:[[4316],256],69702:[,9],69759:[,9],69785:[,,{69818:69786}],69786:[[69785,69818]],69787:[,,{69818:69788}],69788:[[69787,69818]],69797:[,,{69818:69803}],69803:[[69797,69818]],69817:[,9],69818:[,7]},4352:{69888:[,230],69889:[,230],69890:[,230],69934:[[69937,69927]],69935:[[69938,69927]],69937:[,,{69927:69934}],69938:[,,{69927:69935}],69939:[,9],69940:[,9],70003:[,7],70080:[,9]},4608:{70197:[,9],70198:[,7],70377:[,7],70378:[,9]},4864:{4957:[,230],4958:[,230],4959:[,230],70460:[,7],70471:[,,{70462:70475,70487:70476}],70475:[[70471,70462]],70476:[[70471,70487]],70477:[,9],70502:[,230],70503:[,230],70504:[,230],70505:[,230],70506:[,230],70507:[,230],70508:[,230],70512:[,230],70513:[,230],70514:[,230],70515:[,230],70516:[,230]},5120:{70841:[,,{70832:70844,70842:70843,70845:70846}],70843:[[70841,70842]],70844:[[70841,70832]],70846:[[70841,70845]],70850:[,9],70851:[,7]},5376:{71096:[,,{71087:71098}],71097:[,,{71087:71099}],71098:[[71096,71087]],71099:[[71097,71087]],71103:[,9],71104:[,7]},5632:{71231:[,9],71350:[,9],71351:[,7]},5888:{5908:[,9],5940:[,9],6098:[,9],6109:[,230]},6144:{6313:[,228]},6400:{6457:[,222],6458:[,230],6459:[,220]},6656:{6679:[,230],6680:[,220],6752:[,9],6773:[,230],6774:[,230],6775:[,230],6776:[,230],6777:[,230],6778:[,230],6779:[,230],6780:[,230],6783:[,220],6832:[,230],6833:[,230],6834:[,230],6835:[,230],6836:[,230],6837:[,220],6838:[,220],6839:[,220],6840:[,220],6841:[,220],6842:[,220],6843:[,230],6844:[,230],6845:[,220]},6912:{6917:[,,{6965:6918}],6918:[[6917,6965]],6919:[,,{6965:6920}],6920:[[6919,6965]],6921:[,,{6965:6922}],6922:[[6921,6965]],6923:[,,{6965:6924}],6924:[[6923,6965]],6925:[,,{6965:6926}],6926:[[6925,6965]],6929:[,,{6965:6930}],6930:[[6929,6965]],6964:[,7],6970:[,,{6965:6971}],6971:[[6970,6965]],6972:[,,{6965:6973}],6973:[[6972,6965]],6974:[,,{6965:6976}],6975:[,,{6965:6977}],6976:[[6974,6965]],6977:[[6975,6965]],6978:[,,{6965:6979}],6979:[[6978,6965]],6980:[,9],7019:[,230],7020:[,220],7021:[,230],7022:[,230],7023:[,230],7024:[,230],7025:[,230],7026:[,230],7027:[,230],7082:[,9],7083:[,9],7142:[,7],7154:[,9],7155:[,9]},7168:{7223:[,7],7376:[,230],7377:[,230],7378:[,230],7380:[,1],7381:[,220],7382:[,220],7383:[,220],7384:[,220],7385:[,220],7386:[,230],7387:[,230],7388:[,220],7389:[,220],7390:[,220],7391:[,220],7392:[,230],7394:[,1],7395:[,1],7396:[,1],7397:[,1],7398:[,1],7399:[,1],7400:[,1],7405:[,220],7412:[,230],7416:[,230],7417:[,230]},7424:{7468:[[65],256],7469:[[198],256],7470:[[66],256],7472:[[68],256],7473:[[69],256],7474:[[398],256],7475:[[71],256],7476:[[72],256],7477:[[73],256],7478:[[74],256],7479:[[75],256],7480:[[76],256],7481:[[77],256],7482:[[78],256],7484:[[79],256],7485:[[546],256],7486:[[80],256],7487:[[82],256],7488:[[84],256],7489:[[85],256],7490:[[87],256],7491:[[97],256],7492:[[592],256],7493:[[593],256],7494:[[7426],256],7495:[[98],256],7496:[[100],256],7497:[[101],256],7498:[[601],256],7499:[[603],256],7500:[[604],256],7501:[[103],256],7503:[[107],256],7504:[[109],256],7505:[[331],256],7506:[[111],256],7507:[[596],256],7508:[[7446],256],7509:[[7447],256],7510:[[112],256],7511:[[116],256],7512:[[117],256],7513:[[7453],256],7514:[[623],256],7515:[[118],256],7516:[[7461],256],7517:[[946],256],7518:[[947],256],7519:[[948],256],7520:[[966],256],7521:[[967],256],7522:[[105],256],7523:[[114],256],7524:[[117],256],7525:[[118],256],7526:[[946],256],7527:[[947],256],7528:[[961],256],7529:[[966],256],7530:[[967],256],7544:[[1085],256],7579:[[594],256],7580:[[99],256],7581:[[597],256],7582:[[240],256],7583:[[604],256],7584:[[102],256],7585:[[607],256],7586:[[609],256],7587:[[613],256],7588:[[616],256],7589:[[617],256],7590:[[618],256],7591:[[7547],256],7592:[[669],256],7593:[[621],256],7594:[[7557],256],7595:[[671],256],7596:[[625],256],7597:[[624],256],7598:[[626],256],7599:[[627],256],7600:[[628],256],7601:[[629],256],7602:[[632],256],7603:[[642],256],7604:[[643],256],7605:[[427],256],7606:[[649],256],7607:[[650],256],7608:[[7452],256],7609:[[651],256],7610:[[652],256],7611:[[122],256],7612:[[656],256],7613:[[657],256],7614:[[658],256],7615:[[952],256],7616:[,230],7617:[,230],7618:[,220],7619:[,230],7620:[,230],7621:[,230],7622:[,230],7623:[,230],7624:[,230],7625:[,230],7626:[,220],7627:[,230],7628:[,230],7629:[,234],7630:[,214],7631:[,220],7632:[,202],7633:[,230],7634:[,230],7635:[,230],7636:[,230],7637:[,230],7638:[,230],7639:[,230],7640:[,230],7641:[,230],7642:[,230],7643:[,230],7644:[,230],7645:[,230],7646:[,230],7647:[,230],7648:[,230],7649:[,230],7650:[,230],7651:[,230],7652:[,230],7653:[,230],7654:[,230],7655:[,230],7656:[,230],7657:[,230],7658:[,230],7659:[,230],7660:[,230],7661:[,230],7662:[,230],7663:[,230],7664:[,230],7665:[,230],7666:[,230],7667:[,230],7668:[,230],7669:[,230],7676:[,233],7677:[,220],7678:[,230],7679:[,220]},7680:{7680:[[65,805]],7681:[[97,805]],7682:[[66,775]],7683:[[98,775]],7684:[[66,803]],7685:[[98,803]],7686:[[66,817]],7687:[[98,817]],7688:[[199,769]],7689:[[231,769]],7690:[[68,775]],7691:[[100,775]],7692:[[68,803]],7693:[[100,803]],7694:[[68,817]],7695:[[100,817]],7696:[[68,807]],7697:[[100,807]],7698:[[68,813]],7699:[[100,813]],7700:[[274,768]],7701:[[275,768]],7702:[[274,769]],7703:[[275,769]],7704:[[69,813]],7705:[[101,813]],7706:[[69,816]],7707:[[101,816]],7708:[[552,774]],7709:[[553,774]],7710:[[70,775]],7711:[[102,775]],7712:[[71,772]],7713:[[103,772]],7714:[[72,775]],7715:[[104,775]],7716:[[72,803]],7717:[[104,803]],7718:[[72,776]],7719:[[104,776]],7720:[[72,807]],7721:[[104,807]],7722:[[72,814]],7723:[[104,814]],7724:[[73,816]],7725:[[105,816]],7726:[[207,769]],7727:[[239,769]],7728:[[75,769]],7729:[[107,769]],7730:[[75,803]],7731:[[107,803]],7732:[[75,817]],7733:[[107,817]],7734:[[76,803],,{772:7736}],7735:[[108,803],,{772:7737}],7736:[[7734,772]],7737:[[7735,772]],7738:[[76,817]],7739:[[108,817]],7740:[[76,813]],7741:[[108,813]],7742:[[77,769]],7743:[[109,769]],7744:[[77,775]],7745:[[109,775]],7746:[[77,803]],7747:[[109,803]],7748:[[78,775]],7749:[[110,775]],7750:[[78,803]],7751:[[110,803]],7752:[[78,817]],7753:[[110,817]],7754:[[78,813]],7755:[[110,813]],7756:[[213,769]],7757:[[245,769]],7758:[[213,776]],7759:[[245,776]],7760:[[332,768]],7761:[[333,768]],7762:[[332,769]],7763:[[333,769]],7764:[[80,769]],7765:[[112,769]],7766:[[80,775]],7767:[[112,775]],7768:[[82,775]],7769:[[114,775]],7770:[[82,803],,{772:7772}],7771:[[114,803],,{772:7773}],7772:[[7770,772]],7773:[[7771,772]],7774:[[82,817]],7775:[[114,817]],7776:[[83,775]],7777:[[115,775]],7778:[[83,803],,{775:7784}],7779:[[115,803],,{775:7785}],7780:[[346,775]],7781:[[347,775]],7782:[[352,775]],7783:[[353,775]],7784:[[7778,775]],7785:[[7779,775]],7786:[[84,775]],7787:[[116,775]],7788:[[84,803]],7789:[[116,803]],7790:[[84,817]],7791:[[116,817]],7792:[[84,813]],7793:[[116,813]],7794:[[85,804]],7795:[[117,804]],7796:[[85,816]],7797:[[117,816]],7798:[[85,813]],7799:[[117,813]],7800:[[360,769]],7801:[[361,769]],7802:[[362,776]],7803:[[363,776]],7804:[[86,771]],7805:[[118,771]],7806:[[86,803]],7807:[[118,803]],7808:[[87,768]],7809:[[119,768]],7810:[[87,769]],7811:[[119,769]],7812:[[87,776]],7813:[[119,776]],7814:[[87,775]],7815:[[119,775]],7816:[[87,803]],7817:[[119,803]],7818:[[88,775]],7819:[[120,775]],7820:[[88,776]],7821:[[120,776]],7822:[[89,775]],7823:[[121,775]],7824:[[90,770]],7825:[[122,770]],7826:[[90,803]],7827:[[122,803]],7828:[[90,817]],7829:[[122,817]],7830:[[104,817]],7831:[[116,776]],7832:[[119,778]],7833:[[121,778]],7834:[[97,702],256],7835:[[383,775]],7840:[[65,803],,{770:7852,774:7862}],7841:[[97,803],,{770:7853,774:7863}],7842:[[65,777]],7843:[[97,777]],7844:[[194,769]],7845:[[226,769]],7846:[[194,768]],7847:[[226,768]],7848:[[194,777]],7849:[[226,777]],7850:[[194,771]],7851:[[226,771]],7852:[[7840,770]],7853:[[7841,770]],7854:[[258,769]],7855:[[259,769]],7856:[[258,768]],7857:[[259,768]],7858:[[258,777]],7859:[[259,777]],7860:[[258,771]],7861:[[259,771]],7862:[[7840,774]],7863:[[7841,774]],7864:[[69,803],,{770:7878}],7865:[[101,803],,{770:7879}],7866:[[69,777]],7867:[[101,777]],7868:[[69,771]],7869:[[101,771]],7870:[[202,769]],7871:[[234,769]],7872:[[202,768]],7873:[[234,768]],7874:[[202,777]],7875:[[234,777]],7876:[[202,771]],7877:[[234,771]],7878:[[7864,770]],7879:[[7865,770]],7880:[[73,777]],7881:[[105,777]],7882:[[73,803]],7883:[[105,803]],7884:[[79,803],,{770:7896}],7885:[[111,803],,{770:7897}],7886:[[79,777]],7887:[[111,777]],7888:[[212,769]],7889:[[244,769]],7890:[[212,768]],7891:[[244,768]],7892:[[212,777]],7893:[[244,777]],7894:[[212,771]],7895:[[244,771]],7896:[[7884,770]],7897:[[7885,770]],7898:[[416,769]],7899:[[417,769]],7900:[[416,768]],7901:[[417,768]],7902:[[416,777]],7903:[[417,777]],7904:[[416,771]],7905:[[417,771]],7906:[[416,803]],7907:[[417,803]],7908:[[85,803]],7909:[[117,803]],7910:[[85,777]],7911:[[117,777]],7912:[[431,769]],7913:[[432,769]],7914:[[431,768]],7915:[[432,768]],7916:[[431,777]],7917:[[432,777]],7918:[[431,771]],7919:[[432,771]],7920:[[431,803]],7921:[[432,803]],7922:[[89,768]],7923:[[121,768]],7924:[[89,803]],7925:[[121,803]],7926:[[89,777]],7927:[[121,777]],7928:[[89,771]],7929:[[121,771]]},7936:{7936:[[945,787],,{768:7938,769:7940,834:7942,837:8064}],7937:[[945,788],,{768:7939,769:7941,834:7943,837:8065}],7938:[[7936,768],,{837:8066}],7939:[[7937,768],,{837:8067}],7940:[[7936,769],,{837:8068}],7941:[[7937,769],,{837:8069}],7942:[[7936,834],,{837:8070}],7943:[[7937,834],,{837:8071}],7944:[[913,787],,{768:7946,769:7948,834:7950,837:8072}],7945:[[913,788],,{768:7947,769:7949,834:7951,837:8073}],7946:[[7944,768],,{837:8074}],7947:[[7945,768],,{837:8075}],7948:[[7944,769],,{837:8076}],7949:[[7945,769],,{837:8077}],7950:[[7944,834],,{837:8078}],7951:[[7945,834],,{837:8079}],7952:[[949,787],,{768:7954,769:7956}],7953:[[949,788],,{768:7955,769:7957}],7954:[[7952,768]],7955:[[7953,768]],7956:[[7952,769]],7957:[[7953,769]],7960:[[917,787],,{768:7962,769:7964}],7961:[[917,788],,{768:7963,769:7965}],7962:[[7960,768]],7963:[[7961,768]],7964:[[7960,769]],7965:[[7961,769]],7968:[[951,787],,{768:7970,769:7972,834:7974,837:8080}],7969:[[951,788],,{768:7971,769:7973,834:7975,837:8081}],7970:[[7968,768],,{837:8082}],7971:[[7969,768],,{837:8083}],7972:[[7968,769],,{837:8084}],7973:[[7969,769],,{837:8085}],7974:[[7968,834],,{837:8086}],7975:[[7969,834],,{837:8087}],7976:[[919,787],,{768:7978,769:7980,834:7982,837:8088}],7977:[[919,788],,{768:7979,769:7981,834:7983,837:8089}],7978:[[7976,768],,{837:8090}],7979:[[7977,768],,{837:8091}],7980:[[7976,769],,{837:8092}],7981:[[7977,769],,{837:8093}],7982:[[7976,834],,{837:8094}],7983:[[7977,834],,{837:8095}],7984:[[953,787],,{768:7986,769:7988,834:7990}],7985:[[953,788],,{768:7987,769:7989,834:7991}],7986:[[7984,768]],7987:[[7985,768]],7988:[[7984,769]],7989:[[7985,769]],7990:[[7984,834]],7991:[[7985,834]],7992:[[921,787],,{768:7994,769:7996,834:7998}],7993:[[921,788],,{768:7995,769:7997,834:7999}],7994:[[7992,768]],7995:[[7993,768]],7996:[[7992,769]],7997:[[7993,769]],7998:[[7992,834]],7999:[[7993,834]],8e3:[[959,787],,{768:8002,769:8004}],8001:[[959,788],,{768:8003,769:8005}],8002:[[8e3,768]],8003:[[8001,768]],8004:[[8e3,769]],8005:[[8001,769]],8008:[[927,787],,{768:8010,769:8012}],8009:[[927,788],,{768:8011,769:8013}],8010:[[8008,768]],8011:[[8009,768]],8012:[[8008,769]],8013:[[8009,769]],8016:[[965,787],,{768:8018,769:8020,834:8022}],8017:[[965,788],,{768:8019,769:8021,834:8023}],8018:[[8016,768]],8019:[[8017,768]],8020:[[8016,769]],8021:[[8017,769]],8022:[[8016,834]],8023:[[8017,834]],8025:[[933,788],,{768:8027,769:8029,834:8031}],8027:[[8025,768]],8029:[[8025,769]],8031:[[8025,834]],8032:[[969,787],,{768:8034,769:8036,834:8038,837:8096}],8033:[[969,788],,{768:8035,769:8037,834:8039,837:8097}],8034:[[8032,768],,{837:8098}],8035:[[8033,768],,{837:8099}],8036:[[8032,769],,{837:8100}],8037:[[8033,769],,{837:8101}],8038:[[8032,834],,{837:8102}],8039:[[8033,834],,{837:8103}],8040:[[937,787],,{768:8042,769:8044,834:8046,837:8104}],8041:[[937,788],,{768:8043,769:8045,834:8047,837:8105}],8042:[[8040,768],,{837:8106}],8043:[[8041,768],,{837:8107}],8044:[[8040,769],,{837:8108}],8045:[[8041,769],,{837:8109}],8046:[[8040,834],,{837:8110}],8047:[[8041,834],,{837:8111}],8048:[[945,768],,{837:8114}],8049:[[940]],8050:[[949,768]],8051:[[941]],8052:[[951,768],,{837:8130}],8053:[[942]],8054:[[953,768]],8055:[[943]],8056:[[959,768]],8057:[[972]],8058:[[965,768]],8059:[[973]],8060:[[969,768],,{837:8178}],8061:[[974]],8064:[[7936,837]],8065:[[7937,837]],8066:[[7938,837]],8067:[[7939,837]],8068:[[7940,837]],8069:[[7941,837]],8070:[[7942,837]],8071:[[7943,837]],8072:[[7944,837]],8073:[[7945,837]],8074:[[7946,837]],8075:[[7947,837]],8076:[[7948,837]],8077:[[7949,837]],8078:[[7950,837]],8079:[[7951,837]],8080:[[7968,837]],8081:[[7969,837]],8082:[[7970,837]],8083:[[7971,837]],8084:[[7972,837]],8085:[[7973,837]],8086:[[7974,837]],8087:[[7975,837]],8088:[[7976,837]],8089:[[7977,837]],8090:[[7978,837]],8091:[[7979,837]],8092:[[7980,837]],8093:[[7981,837]],8094:[[7982,837]],8095:[[7983,837]],8096:[[8032,837]],8097:[[8033,837]],8098:[[8034,837]],8099:[[8035,837]],8100:[[8036,837]],8101:[[8037,837]],8102:[[8038,837]],8103:[[8039,837]],8104:[[8040,837]],8105:[[8041,837]],8106:[[8042,837]],8107:[[8043,837]],8108:[[8044,837]],8109:[[8045,837]],8110:[[8046,837]],8111:[[8047,837]],8112:[[945,774]],8113:[[945,772]],8114:[[8048,837]],8115:[[945,837]],8116:[[940,837]],8118:[[945,834],,{837:8119}],8119:[[8118,837]],8120:[[913,774]],8121:[[913,772]],8122:[[913,768]],8123:[[902]],8124:[[913,837]],8125:[[32,787],256],8126:[[953]],8127:[[32,787],256,{768:8141,769:8142,834:8143}],8128:[[32,834],256],8129:[[168,834]],8130:[[8052,837]],8131:[[951,837]],8132:[[942,837]],8134:[[951,834],,{837:8135}],8135:[[8134,837]],8136:[[917,768]],8137:[[904]],8138:[[919,768]],8139:[[905]],8140:[[919,837]],8141:[[8127,768]],8142:[[8127,769]],8143:[[8127,834]],8144:[[953,774]],8145:[[953,772]],8146:[[970,768]],8147:[[912]],8150:[[953,834]],8151:[[970,834]],8152:[[921,774]],8153:[[921,772]],8154:[[921,768]],8155:[[906]],8157:[[8190,768]],8158:[[8190,769]],8159:[[8190,834]],8160:[[965,774]],8161:[[965,772]],8162:[[971,768]],8163:[[944]],8164:[[961,787]],8165:[[961,788]],8166:[[965,834]],8167:[[971,834]],8168:[[933,774]],8169:[[933,772]],8170:[[933,768]],8171:[[910]],8172:[[929,788]],8173:[[168,768]],8174:[[901]],8175:[[96]],8178:[[8060,837]],8179:[[969,837]],8180:[[974,837]],8182:[[969,834],,{837:8183}],8183:[[8182,837]],8184:[[927,768]],8185:[[908]],8186:[[937,768]],8187:[[911]],8188:[[937,837]],8189:[[180]],8190:[[32,788],256,{768:8157,769:8158,834:8159}]},8192:{8192:[[8194]],8193:[[8195]],8194:[[32],256],8195:[[32],256],8196:[[32],256],8197:[[32],256],8198:[[32],256],8199:[[32],256],8200:[[32],256],8201:[[32],256],8202:[[32],256],8209:[[8208],256],8215:[[32,819],256],8228:[[46],256],8229:[[46,46],256],8230:[[46,46,46],256],8239:[[32],256],8243:[[8242,8242],256],8244:[[8242,8242,8242],256],8246:[[8245,8245],256],8247:[[8245,8245,8245],256],8252:[[33,33],256],8254:[[32,773],256],8263:[[63,63],256],8264:[[63,33],256],8265:[[33,63],256],8279:[[8242,8242,8242,8242],256],8287:[[32],256],8304:[[48],256],8305:[[105],256],8308:[[52],256],8309:[[53],256],8310:[[54],256],8311:[[55],256],8312:[[56],256],8313:[[57],256],8314:[[43],256],8315:[[8722],256],8316:[[61],256],8317:[[40],256],8318:[[41],256],8319:[[110],256],8320:[[48],256],8321:[[49],256],8322:[[50],256],8323:[[51],256],8324:[[52],256],8325:[[53],256],8326:[[54],256],8327:[[55],256],8328:[[56],256],8329:[[57],256],8330:[[43],256],8331:[[8722],256],8332:[[61],256],8333:[[40],256],8334:[[41],256],8336:[[97],256],8337:[[101],256],8338:[[111],256],8339:[[120],256],8340:[[601],256],8341:[[104],256],8342:[[107],256],8343:[[108],256],8344:[[109],256],8345:[[110],256],8346:[[112],256],8347:[[115],256],8348:[[116],256],8360:[[82,115],256],8400:[,230],8401:[,230],8402:[,1],8403:[,1],8404:[,230],8405:[,230],8406:[,230],8407:[,230],8408:[,1],8409:[,1],8410:[,1],8411:[,230],8412:[,230],8417:[,230],8421:[,1],8422:[,1],8423:[,230],8424:[,220],8425:[,230],8426:[,1],8427:[,1],8428:[,220],8429:[,220],8430:[,220],8431:[,220],8432:[,230]},8448:{8448:[[97,47,99],256],8449:[[97,47,115],256],8450:[[67],256],8451:[[176,67],256],8453:[[99,47,111],256],8454:[[99,47,117],256],8455:[[400],256],8457:[[176,70],256],8458:[[103],256],8459:[[72],256],8460:[[72],256],8461:[[72],256],8462:[[104],256],8463:[[295],256],8464:[[73],256],8465:[[73],256],8466:[[76],256],8467:[[108],256],8469:[[78],256],8470:[[78,111],256],8473:[[80],256],8474:[[81],256],8475:[[82],256],8476:[[82],256],8477:[[82],256],8480:[[83,77],256],8481:[[84,69,76],256],8482:[[84,77],256],8484:[[90],256],8486:[[937]],8488:[[90],256],8490:[[75]],8491:[[197]],8492:[[66],256],8493:[[67],256],8495:[[101],256],8496:[[69],256],8497:[[70],256],8499:[[77],256],8500:[[111],256],8501:[[1488],256],8502:[[1489],256],8503:[[1490],256],8504:[[1491],256],8505:[[105],256],8507:[[70,65,88],256],8508:[[960],256],8509:[[947],256],8510:[[915],256],8511:[[928],256],8512:[[8721],256],8517:[[68],256],8518:[[100],256],8519:[[101],256],8520:[[105],256],8521:[[106],256],8528:[[49,8260,55],256],8529:[[49,8260,57],256],8530:[[49,8260,49,48],256],8531:[[49,8260,51],256],8532:[[50,8260,51],256],8533:[[49,8260,53],256],8534:[[50,8260,53],256],8535:[[51,8260,53],256],8536:[[52,8260,53],256],8537:[[49,8260,54],256],8538:[[53,8260,54],256],8539:[[49,8260,56],256],8540:[[51,8260,56],256],8541:[[53,8260,56],256],8542:[[55,8260,56],256],8543:[[49,8260],256],8544:[[73],256],8545:[[73,73],256],8546:[[73,73,73],256],8547:[[73,86],256],8548:[[86],256],8549:[[86,73],256],8550:[[86,73,73],256],8551:[[86,73,73,73],256],8552:[[73,88],256],8553:[[88],256],8554:[[88,73],256],8555:[[88,73,73],256],8556:[[76],256],8557:[[67],256],8558:[[68],256],8559:[[77],256],8560:[[105],256],8561:[[105,105],256],8562:[[105,105,105],256],8563:[[105,118],256],8564:[[118],256],8565:[[118,105],256],8566:[[118,105,105],256],8567:[[118,105,105,105],256],8568:[[105,120],256],8569:[[120],256],8570:[[120,105],256],8571:[[120,105,105],256],8572:[[108],256],8573:[[99],256],8574:[[100],256],8575:[[109],256],8585:[[48,8260,51],256],8592:[,,{824:8602}],8594:[,,{824:8603}],8596:[,,{824:8622}],8602:[[8592,824]],8603:[[8594,824]],8622:[[8596,824]],8653:[[8656,824]],8654:[[8660,824]],8655:[[8658,824]],8656:[,,{824:8653}],8658:[,,{824:8655}],8660:[,,{824:8654}]},8704:{8707:[,,{824:8708}],8708:[[8707,824]],8712:[,,{824:8713}],8713:[[8712,824]],8715:[,,{824:8716}],8716:[[8715,824]],8739:[,,{824:8740}],8740:[[8739,824]],8741:[,,{824:8742}],8742:[[8741,824]],8748:[[8747,8747],256],8749:[[8747,8747,8747],256],8751:[[8750,8750],256],8752:[[8750,8750,8750],256],8764:[,,{824:8769}],8769:[[8764,824]],8771:[,,{824:8772}],8772:[[8771,824]],8773:[,,{824:8775}],8775:[[8773,824]],8776:[,,{824:8777}],8777:[[8776,824]],8781:[,,{824:8813}],8800:[[61,824]],8801:[,,{824:8802}],8802:[[8801,824]],8804:[,,{824:8816}],8805:[,,{824:8817}],8813:[[8781,824]],8814:[[60,824]],8815:[[62,824]],8816:[[8804,824]],8817:[[8805,824]],8818:[,,{824:8820}],8819:[,,{824:8821}],8820:[[8818,824]],8821:[[8819,824]],8822:[,,{824:8824}],8823:[,,{824:8825}],8824:[[8822,824]],8825:[[8823,824]],8826:[,,{824:8832}],8827:[,,{824:8833}],8828:[,,{824:8928}],8829:[,,{824:8929}],8832:[[8826,824]],8833:[[8827,824]],8834:[,,{824:8836}],8835:[,,{824:8837}],8836:[[8834,824]],8837:[[8835,824]],8838:[,,{824:8840}],8839:[,,{824:8841}],8840:[[8838,824]],8841:[[8839,824]],8849:[,,{824:8930}],8850:[,,{824:8931}],8866:[,,{824:8876}],8872:[,,{824:8877}],8873:[,,{824:8878}],8875:[,,{824:8879}],8876:[[8866,824]],8877:[[8872,824]],8878:[[8873,824]],8879:[[8875,824]],8882:[,,{824:8938}],8883:[,,{824:8939}],8884:[,,{824:8940}],8885:[,,{824:8941}],8928:[[8828,824]],8929:[[8829,824]],8930:[[8849,824]],8931:[[8850,824]],8938:[[8882,824]],8939:[[8883,824]],8940:[[8884,824]],8941:[[8885,824]]},8960:{9001:[[12296]],9002:[[12297]]},9216:{9312:[[49],256],9313:[[50],256],9314:[[51],256],9315:[[52],256],9316:[[53],256],9317:[[54],256],9318:[[55],256],9319:[[56],256],9320:[[57],256],9321:[[49,48],256],9322:[[49,49],256],9323:[[49,50],256],9324:[[49,51],256],9325:[[49,52],256],9326:[[49,53],256],9327:[[49,54],256],9328:[[49,55],256],9329:[[49,56],256],9330:[[49,57],256],9331:[[50,48],256],9332:[[40,49,41],256],9333:[[40,50,41],256],9334:[[40,51,41],256],9335:[[40,52,41],256],9336:[[40,53,41],256],9337:[[40,54,41],256],9338:[[40,55,41],256],9339:[[40,56,41],256],9340:[[40,57,41],256],9341:[[40,49,48,41],256],9342:[[40,49,49,41],256],9343:[[40,49,50,41],256],9344:[[40,49,51,41],256],9345:[[40,49,52,41],256],9346:[[40,49,53,41],256],9347:[[40,49,54,41],256],9348:[[40,49,55,41],256],9349:[[40,49,56,41],256],9350:[[40,49,57,41],256],9351:[[40,50,48,41],256],9352:[[49,46],256],9353:[[50,46],256],9354:[[51,46],256],9355:[[52,46],256],9356:[[53,46],256],9357:[[54,46],256],9358:[[55,46],256],9359:[[56,46],256],9360:[[57,46],256],9361:[[49,48,46],256],9362:[[49,49,46],256],9363:[[49,50,46],256],9364:[[49,51,46],256],9365:[[49,52,46],256],9366:[[49,53,46],256],9367:[[49,54,46],256],9368:[[49,55,46],256],9369:[[49,56,46],256],9370:[[49,57,46],256],9371:[[50,48,46],256],9372:[[40,97,41],256],9373:[[40,98,41],256],9374:[[40,99,41],256],9375:[[40,100,41],256],9376:[[40,101,41],256],9377:[[40,102,41],256],9378:[[40,103,41],256],9379:[[40,104,41],256],9380:[[40,105,41],256],9381:[[40,106,41],256],9382:[[40,107,41],256],9383:[[40,108,41],256],9384:[[40,109,41],256],9385:[[40,110,41],256],9386:[[40,111,41],256],9387:[[40,112,41],256],9388:[[40,113,41],256],9389:[[40,114,41],256],9390:[[40,115,41],256],9391:[[40,116,41],256],9392:[[40,117,41],256],9393:[[40,118,41],256],9394:[[40,119,41],256],9395:[[40,120,41],256],9396:[[40,121,41],256],9397:[[40,122,41],256],9398:[[65],256],9399:[[66],256],9400:[[67],256],9401:[[68],256],9402:[[69],256],9403:[[70],256],9404:[[71],256],9405:[[72],256],9406:[[73],256],9407:[[74],256],9408:[[75],256],9409:[[76],256],9410:[[77],256],9411:[[78],256],9412:[[79],256],9413:[[80],256],9414:[[81],256],9415:[[82],256],9416:[[83],256],9417:[[84],256],9418:[[85],256],9419:[[86],256],9420:[[87],256],9421:[[88],256],9422:[[89],256],9423:[[90],256],9424:[[97],256],9425:[[98],256],9426:[[99],256],9427:[[100],256],9428:[[101],256],9429:[[102],256],9430:[[103],256],9431:[[104],256],9432:[[105],256],9433:[[106],256],9434:[[107],256],9435:[[108],256],9436:[[109],256],9437:[[110],256],9438:[[111],256],9439:[[112],256],9440:[[113],256],9441:[[114],256],9442:[[115],256],9443:[[116],256],9444:[[117],256],9445:[[118],256],9446:[[119],256],9447:[[120],256],9448:[[121],256],9449:[[122],256],9450:[[48],256]},10752:{10764:[[8747,8747,8747,8747],256],10868:[[58,58,61],256],10869:[[61,61],256],10870:[[61,61,61],256],10972:[[10973,824],512]},11264:{11388:[[106],256],11389:[[86],256],11503:[,230],11504:[,230],11505:[,230]},11520:{11631:[[11617],256],11647:[,9],11744:[,230],11745:[,230],11746:[,230],11747:[,230],11748:[,230],11749:[,230],11750:[,230],11751:[,230],11752:[,230],11753:[,230],11754:[,230],11755:[,230],11756:[,230],11757:[,230],11758:[,230],11759:[,230],11760:[,230],11761:[,230],11762:[,230],11763:[,230],11764:[,230],11765:[,230],11766:[,230],11767:[,230],11768:[,230],11769:[,230],11770:[,230],11771:[,230],11772:[,230],11773:[,230],11774:[,230],11775:[,230]},11776:{11935:[[27597],256],12019:[[40863],256]},12032:{12032:[[19968],256],12033:[[20008],256],12034:[[20022],256],12035:[[20031],256],12036:[[20057],256],12037:[[20101],256],12038:[[20108],256],12039:[[20128],256],12040:[[20154],256],12041:[[20799],256],12042:[[20837],256],12043:[[20843],256],12044:[[20866],256],12045:[[20886],256],12046:[[20907],256],12047:[[20960],256],12048:[[20981],256],12049:[[20992],256],12050:[[21147],256],12051:[[21241],256],12052:[[21269],256],12053:[[21274],256],12054:[[21304],256],12055:[[21313],256],12056:[[21340],256],12057:[[21353],256],12058:[[21378],256],12059:[[21430],256],12060:[[21448],256],12061:[[21475],256],12062:[[22231],256],12063:[[22303],256],12064:[[22763],256],12065:[[22786],256],12066:[[22794],256],12067:[[22805],256],12068:[[22823],256],12069:[[22899],256],12070:[[23376],256],12071:[[23424],256],12072:[[23544],256],12073:[[23567],256],12074:[[23586],256],12075:[[23608],256],12076:[[23662],256],12077:[[23665],256],12078:[[24027],256],12079:[[24037],256],12080:[[24049],256],12081:[[24062],256],12082:[[24178],256],12083:[[24186],256],12084:[[24191],256],12085:[[24308],256],12086:[[24318],256],12087:[[24331],256],12088:[[24339],256],12089:[[24400],256],12090:[[24417],256],12091:[[24435],256],12092:[[24515],256],12093:[[25096],256],12094:[[25142],256],12095:[[25163],256],12096:[[25903],256],12097:[[25908],256],12098:[[25991],256],12099:[[26007],256],12100:[[26020],256],12101:[[26041],256],12102:[[26080],256],12103:[[26085],256],12104:[[26352],256],12105:[[26376],256],12106:[[26408],256],12107:[[27424],256],12108:[[27490],256],12109:[[27513],256],12110:[[27571],256],12111:[[27595],256],12112:[[27604],256],12113:[[27611],256],12114:[[27663],256],12115:[[27668],256],12116:[[27700],256],12117:[[28779],256],12118:[[29226],256],12119:[[29238],256],12120:[[29243],256],12121:[[29247],256],12122:[[29255],256],12123:[[29273],256],12124:[[29275],256],12125:[[29356],256],12126:[[29572],256],12127:[[29577],256],12128:[[29916],256],12129:[[29926],256],12130:[[29976],256],12131:[[29983],256],12132:[[29992],256],12133:[[3e4],256],12134:[[30091],256],12135:[[30098],256],12136:[[30326],256],12137:[[30333],256],12138:[[30382],256],12139:[[30399],256],12140:[[30446],256],12141:[[30683],256],12142:[[30690],256],12143:[[30707],256],12144:[[31034],256],12145:[[31160],256],12146:[[31166],256],12147:[[31348],256],12148:[[31435],256],12149:[[31481],256],12150:[[31859],256],12151:[[31992],256],12152:[[32566],256],12153:[[32593],256],12154:[[32650],256],12155:[[32701],256],12156:[[32769],256],12157:[[32780],256],12158:[[32786],256],12159:[[32819],256],12160:[[32895],256],12161:[[32905],256],12162:[[33251],256],12163:[[33258],256],12164:[[33267],256],12165:[[33276],256],12166:[[33292],256],12167:[[33307],256],12168:[[33311],256],12169:[[33390],256],12170:[[33394],256],12171:[[33400],256],12172:[[34381],256],12173:[[34411],256],12174:[[34880],256],12175:[[34892],256],12176:[[34915],256],12177:[[35198],256],12178:[[35211],256],12179:[[35282],256],12180:[[35328],256],12181:[[35895],256],12182:[[35910],256],12183:[[35925],256],12184:[[35960],256],12185:[[35997],256],12186:[[36196],256],12187:[[36208],256],12188:[[36275],256],12189:[[36523],256],12190:[[36554],256],12191:[[36763],256],12192:[[36784],256],12193:[[36789],256],12194:[[37009],256],12195:[[37193],256],12196:[[37318],256],12197:[[37324],256],12198:[[37329],256],12199:[[38263],256],12200:[[38272],256],12201:[[38428],256],12202:[[38582],256],12203:[[38585],256],12204:[[38632],256],12205:[[38737],256],12206:[[38750],256],12207:[[38754],256],12208:[[38761],256],12209:[[38859],256],12210:[[38893],256],12211:[[38899],256],12212:[[38913],256],12213:[[39080],256],12214:[[39131],256],12215:[[39135],256],12216:[[39318],256],12217:[[39321],256],12218:[[39340],256],12219:[[39592],256],12220:[[39640],256],12221:[[39647],256],12222:[[39717],256],12223:[[39727],256],12224:[[39730],256],12225:[[39740],256],12226:[[39770],256],12227:[[40165],256],12228:[[40565],256],12229:[[40575],256],12230:[[40613],256],12231:[[40635],256],12232:[[40643],256],12233:[[40653],256],12234:[[40657],256],12235:[[40697],256],12236:[[40701],256],12237:[[40718],256],12238:[[40723],256],12239:[[40736],256],12240:[[40763],256],12241:[[40778],256],12242:[[40786],256],12243:[[40845],256],12244:[[40860],256],12245:[[40864],256]},12288:{12288:[[32],256],12330:[,218],12331:[,228],12332:[,232],12333:[,222],12334:[,224],12335:[,224],12342:[[12306],256],12344:[[21313],256],12345:[[21316],256],12346:[[21317],256],12358:[,,{12441:12436}],12363:[,,{12441:12364}],12364:[[12363,12441]],12365:[,,{12441:12366}],12366:[[12365,12441]],12367:[,,{12441:12368}],12368:[[12367,12441]],12369:[,,{12441:12370}],12370:[[12369,12441]],12371:[,,{12441:12372}],12372:[[12371,12441]],12373:[,,{12441:12374}],12374:[[12373,12441]],12375:[,,{12441:12376}],12376:[[12375,12441]],12377:[,,{12441:12378}],12378:[[12377,12441]],12379:[,,{12441:12380}],12380:[[12379,12441]],12381:[,,{12441:12382}],12382:[[12381,12441]],12383:[,,{12441:12384}],12384:[[12383,12441]],12385:[,,{12441:12386}],12386:[[12385,12441]],12388:[,,{12441:12389}],12389:[[12388,12441]],12390:[,,{12441:12391}],12391:[[12390,12441]],12392:[,,{12441:12393}],12393:[[12392,12441]],12399:[,,{12441:12400,12442:12401}],12400:[[12399,12441]],12401:[[12399,12442]],12402:[,,{12441:12403,12442:12404}],12403:[[12402,12441]],12404:[[12402,12442]],12405:[,,{12441:12406,12442:12407}],12406:[[12405,12441]],12407:[[12405,12442]],12408:[,,{12441:12409,12442:12410}],12409:[[12408,12441]],12410:[[12408,12442]],12411:[,,{12441:12412,12442:12413}],12412:[[12411,12441]],12413:[[12411,12442]],12436:[[12358,12441]],12441:[,8],12442:[,8],12443:[[32,12441],256],12444:[[32,12442],256],12445:[,,{12441:12446}],12446:[[12445,12441]],12447:[[12424,12426],256],12454:[,,{12441:12532}],12459:[,,{12441:12460}],12460:[[12459,12441]],12461:[,,{12441:12462}],12462:[[12461,12441]],12463:[,,{12441:12464}],12464:[[12463,12441]],12465:[,,{12441:12466}],12466:[[12465,12441]],12467:[,,{12441:12468}],12468:[[12467,12441]],12469:[,,{12441:12470}],12470:[[12469,12441]],12471:[,,{12441:12472}],12472:[[12471,12441]],12473:[,,{12441:12474}],12474:[[12473,12441]],12475:[,,{12441:12476}],12476:[[12475,12441]],12477:[,,{12441:12478}],12478:[[12477,12441]],12479:[,,{12441:12480}],12480:[[12479,12441]],12481:[,,{12441:12482}],12482:[[12481,12441]],12484:[,,{12441:12485}],12485:[[12484,12441]],12486:[,,{12441:12487}],12487:[[12486,12441]],12488:[,,{12441:12489}],12489:[[12488,12441]],12495:[,,{12441:12496,12442:12497}],12496:[[12495,12441]],12497:[[12495,12442]],12498:[,,{12441:12499,12442:12500}],12499:[[12498,12441]],12500:[[12498,12442]],12501:[,,{12441:12502,12442:12503}],12502:[[12501,12441]],12503:[[12501,12442]],12504:[,,{12441:12505,12442:12506}],12505:[[12504,12441]],12506:[[12504,12442]],12507:[,,{12441:12508,12442:12509}],12508:[[12507,12441]],12509:[[12507,12442]],12527:[,,{12441:12535}],12528:[,,{12441:12536}],12529:[,,{12441:12537}],12530:[,,{12441:12538}],12532:[[12454,12441]],12535:[[12527,12441]],12536:[[12528,12441]],12537:[[12529,12441]],12538:[[12530,12441]],12541:[,,{12441:12542}],12542:[[12541,12441]],12543:[[12467,12488],256]},12544:{12593:[[4352],256],12594:[[4353],256],12595:[[4522],256],12596:[[4354],256],12597:[[4524],256],12598:[[4525],256],12599:[[4355],256],12600:[[4356],256],12601:[[4357],256],12602:[[4528],256],12603:[[4529],256],12604:[[4530],256],12605:[[4531],256],12606:[[4532],256],12607:[[4533],256],12608:[[4378],256],12609:[[4358],256],12610:[[4359],256],12611:[[4360],256],12612:[[4385],256],12613:[[4361],256],12614:[[4362],256],12615:[[4363],256],12616:[[4364],256],12617:[[4365],256],12618:[[4366],256],12619:[[4367],256],12620:[[4368],256],12621:[[4369],256],12622:[[4370],256],12623:[[4449],256],12624:[[4450],256],12625:[[4451],256],12626:[[4452],256],12627:[[4453],256],12628:[[4454],256],12629:[[4455],256],12630:[[4456],256],12631:[[4457],256],12632:[[4458],256],12633:[[4459],256],12634:[[4460],256],12635:[[4461],256],12636:[[4462],256],12637:[[4463],256],12638:[[4464],256],12639:[[4465],256],12640:[[4466],256],12641:[[4467],256],12642:[[4468],256],12643:[[4469],256],12644:[[4448],256],12645:[[4372],256],12646:[[4373],256],12647:[[4551],256],12648:[[4552],256],12649:[[4556],256],12650:[[4558],256],12651:[[4563],256],12652:[[4567],256],12653:[[4569],256],12654:[[4380],256],12655:[[4573],256],12656:[[4575],256],12657:[[4381],256],12658:[[4382],256],12659:[[4384],256],12660:[[4386],256],12661:[[4387],256],12662:[[4391],256],12663:[[4393],256],12664:[[4395],256],12665:[[4396],256],12666:[[4397],256],12667:[[4398],256],12668:[[4399],256],12669:[[4402],256],12670:[[4406],256],12671:[[4416],256],12672:[[4423],256],12673:[[4428],256],12674:[[4593],256],12675:[[4594],256],12676:[[4439],256],12677:[[4440],256],12678:[[4441],256],12679:[[4484],256],12680:[[4485],256],12681:[[4488],256],12682:[[4497],256],12683:[[4498],256],12684:[[4500],256],12685:[[4510],256],12686:[[4513],256],12690:[[19968],256],12691:[[20108],256],12692:[[19977],256],12693:[[22235],256],12694:[[19978],256],12695:[[20013],256],12696:[[19979],256],12697:[[30002],256],12698:[[20057],256],12699:[[19993],256],12700:[[19969],256],12701:[[22825],256],12702:[[22320],256],12703:[[20154],256]},12800:{12800:[[40,4352,41],256],12801:[[40,4354,41],256],12802:[[40,4355,41],256],12803:[[40,4357,41],256],12804:[[40,4358,41],256],12805:[[40,4359,41],256],12806:[[40,4361,41],256],12807:[[40,4363,41],256],12808:[[40,4364,41],256],12809:[[40,4366,41],256],12810:[[40,4367,41],256],12811:[[40,4368,41],256],12812:[[40,4369,41],256],12813:[[40,4370,41],256],12814:[[40,4352,4449,41],256],12815:[[40,4354,4449,41],256],12816:[[40,4355,4449,41],256],12817:[[40,4357,4449,41],256],12818:[[40,4358,4449,41],256],12819:[[40,4359,4449,41],256],12820:[[40,4361,4449,41],256],12821:[[40,4363,4449,41],256],12822:[[40,4364,4449,41],256],12823:[[40,4366,4449,41],256],12824:[[40,4367,4449,41],256],12825:[[40,4368,4449,41],256],12826:[[40,4369,4449,41],256],12827:[[40,4370,4449,41],256],12828:[[40,4364,4462,41],256],12829:[[40,4363,4457,4364,4453,4523,41],256],12830:[[40,4363,4457,4370,4462,41],256],12832:[[40,19968,41],256],12833:[[40,20108,41],256],12834:[[40,19977,41],256],12835:[[40,22235,41],256],12836:[[40,20116,41],256],12837:[[40,20845,41],256],12838:[[40,19971,41],256],12839:[[40,20843,41],256],12840:[[40,20061,41],256],12841:[[40,21313,41],256],12842:[[40,26376,41],256],12843:[[40,28779,41],256],12844:[[40,27700,41],256],12845:[[40,26408,41],256],12846:[[40,37329,41],256],12847:[[40,22303,41],256],12848:[[40,26085,41],256],12849:[[40,26666,41],256],12850:[[40,26377,41],256],12851:[[40,31038,41],256],12852:[[40,21517,41],256],12853:[[40,29305,41],256],12854:[[40,36001,41],256],12855:[[40,31069,41],256],12856:[[40,21172,41],256],12857:[[40,20195,41],256],12858:[[40,21628,41],256],12859:[[40,23398,41],256],12860:[[40,30435,41],256],12861:[[40,20225,41],256],12862:[[40,36039,41],256],12863:[[40,21332,41],256],12864:[[40,31085,41],256],12865:[[40,20241,41],256],12866:[[40,33258,41],256],12867:[[40,33267,41],256],12868:[[21839],256],12869:[[24188],256],12870:[[25991],256],12871:[[31631],256],12880:[[80,84,69],256],12881:[[50,49],256],12882:[[50,50],256],12883:[[50,51],256],12884:[[50,52],256],12885:[[50,53],256],12886:[[50,54],256],12887:[[50,55],256],12888:[[50,56],256],12889:[[50,57],256],12890:[[51,48],256],12891:[[51,49],256],12892:[[51,50],256],12893:[[51,51],256],12894:[[51,52],256],12895:[[51,53],256],12896:[[4352],256],12897:[[4354],256],12898:[[4355],256],12899:[[4357],256],12900:[[4358],256],12901:[[4359],256],12902:[[4361],256],12903:[[4363],256],12904:[[4364],256],12905:[[4366],256],12906:[[4367],256],12907:[[4368],256],12908:[[4369],256],12909:[[4370],256],12910:[[4352,4449],256],12911:[[4354,4449],256],12912:[[4355,4449],256],12913:[[4357,4449],256],12914:[[4358,4449],256],12915:[[4359,4449],256],12916:[[4361,4449],256],12917:[[4363,4449],256],12918:[[4364,4449],256],12919:[[4366,4449],256],12920:[[4367,4449],256],12921:[[4368,4449],256],12922:[[4369,4449],256],12923:[[4370,4449],256],12924:[[4366,4449,4535,4352,4457],256],12925:[[4364,4462,4363,4468],256],12926:[[4363,4462],256],12928:[[19968],256],12929:[[20108],256],12930:[[19977],256],12931:[[22235],256],12932:[[20116],256],12933:[[20845],256],12934:[[19971],256],12935:[[20843],256],12936:[[20061],256],12937:[[21313],256],12938:[[26376],256],12939:[[28779],256],12940:[[27700],256],12941:[[26408],256],12942:[[37329],256],12943:[[22303],256],12944:[[26085],256],12945:[[26666],256],12946:[[26377],256],12947:[[31038],256],12948:[[21517],256],12949:[[29305],256],12950:[[36001],256],12951:[[31069],256],12952:[[21172],256],12953:[[31192],256],12954:[[30007],256],12955:[[22899],256],12956:[[36969],256],12957:[[20778],256],12958:[[21360],256],12959:[[27880],256],12960:[[38917],256],12961:[[20241],256],12962:[[20889],256],12963:[[27491],256],12964:[[19978],256],12965:[[20013],256],12966:[[19979],256],12967:[[24038],256],12968:[[21491],256],12969:[[21307],256],12970:[[23447],256],12971:[[23398],256],12972:[[30435],256],12973:[[20225],256],12974:[[36039],256],12975:[[21332],256],12976:[[22812],256],12977:[[51,54],256],12978:[[51,55],256],12979:[[51,56],256],12980:[[51,57],256],12981:[[52,48],256],12982:[[52,49],256],12983:[[52,50],256],12984:[[52,51],256],12985:[[52,52],256],12986:[[52,53],256],12987:[[52,54],256],12988:[[52,55],256],12989:[[52,56],256],12990:[[52,57],256],12991:[[53,48],256],12992:[[49,26376],256],12993:[[50,26376],256],12994:[[51,26376],256],12995:[[52,26376],256],12996:[[53,26376],256],12997:[[54,26376],256],12998:[[55,26376],256],12999:[[56,26376],256],13e3:[[57,26376],256],13001:[[49,48,26376],256],13002:[[49,49,26376],256],13003:[[49,50,26376],256],13004:[[72,103],256],13005:[[101,114,103],256],13006:[[101,86],256],13007:[[76,84,68],256],13008:[[12450],256],13009:[[12452],256],13010:[[12454],256],13011:[[12456],256],13012:[[12458],256],13013:[[12459],256],13014:[[12461],256],13015:[[12463],256],13016:[[12465],256],13017:[[12467],256],13018:[[12469],256],13019:[[12471],256],13020:[[12473],256],13021:[[12475],256],13022:[[12477],256],13023:[[12479],256],13024:[[12481],256],13025:[[12484],256],13026:[[12486],256],13027:[[12488],256],13028:[[12490],256],13029:[[12491],256],13030:[[12492],256],13031:[[12493],256],13032:[[12494],256],13033:[[12495],256],13034:[[12498],256],13035:[[12501],256],13036:[[12504],256],13037:[[12507],256],13038:[[12510],256],13039:[[12511],256],13040:[[12512],256],13041:[[12513],256],13042:[[12514],256],13043:[[12516],256],13044:[[12518],256],13045:[[12520],256],13046:[[12521],256],13047:[[12522],256],13048:[[12523],256],13049:[[12524],256],13050:[[12525],256],13051:[[12527],256],13052:[[12528],256],13053:[[12529],256],13054:[[12530],256]},13056:{13056:[[12450,12497,12540,12488],256],13057:[[12450,12523,12501,12449],256],13058:[[12450,12531,12506,12450],256],13059:[[12450,12540,12523],256],13060:[[12452,12491,12531,12464],256],13061:[[12452,12531,12481],256],13062:[[12454,12457,12531],256],13063:[[12456,12473,12463,12540,12489],256],13064:[[12456,12540,12459,12540],256],13065:[[12458,12531,12473],256],13066:[[12458,12540,12512],256],13067:[[12459,12452,12522],256],13068:[[12459,12521,12483,12488],256],13069:[[12459,12525,12522,12540],256],13070:[[12460,12525,12531],256],13071:[[12460,12531,12510],256],13072:[[12462,12460],256],13073:[[12462,12491,12540],256],13074:[[12461,12517,12522,12540],256],13075:[[12462,12523,12480,12540],256],13076:[[12461,12525],256],13077:[[12461,12525,12464,12521,12512],256],13078:[[12461,12525,12513,12540,12488,12523],256],13079:[[12461,12525,12527,12483,12488],256],13080:[[12464,12521,12512],256],13081:[[12464,12521,12512,12488,12531],256],13082:[[12463,12523,12476,12452,12525],256],13083:[[12463,12525,12540,12493],256],13084:[[12465,12540,12473],256],13085:[[12467,12523,12490],256],13086:[[12467,12540,12509],256],13087:[[12469,12452,12463,12523],256],13088:[[12469,12531,12481,12540,12512],256],13089:[[12471,12522,12531,12464],256],13090:[[12475,12531,12481],256],13091:[[12475,12531,12488],256],13092:[[12480,12540,12473],256],13093:[[12487,12471],256],13094:[[12489,12523],256],13095:[[12488,12531],256],13096:[[12490,12494],256],13097:[[12494,12483,12488],256],13098:[[12495,12452,12484],256],13099:[[12497,12540,12475,12531,12488],256],13100:[[12497,12540,12484],256],13101:[[12496,12540,12524,12523],256],13102:[[12500,12450,12473,12488,12523],256],13103:[[12500,12463,12523],256],13104:[[12500,12467],256],13105:[[12499,12523],256],13106:[[12501,12449,12521,12483,12489],256],13107:[[12501,12451,12540,12488],256],13108:[[12502,12483,12471,12455,12523],256],13109:[[12501,12521,12531],256],13110:[[12504,12463,12479,12540,12523],256],13111:[[12506,12477],256],13112:[[12506,12491,12498],256],13113:[[12504,12523,12484],256],13114:[[12506,12531,12473],256],13115:[[12506,12540,12472],256],13116:[[12505,12540,12479],256],13117:[[12509,12452,12531,12488],256],13118:[[12508,12523,12488],256],13119:[[12507,12531],256],13120:[[12509,12531,12489],256],13121:[[12507,12540,12523],256],13122:[[12507,12540,12531],256],13123:[[12510,12452,12463,12525],256],13124:[[12510,12452,12523],256],13125:[[12510,12483,12495],256],13126:[[12510,12523,12463],256],13127:[[12510,12531,12471,12519,12531],256],13128:[[12511,12463,12525,12531],256],13129:[[12511,12522],256],13130:[[12511,12522,12496,12540,12523],256],13131:[[12513,12460],256],13132:[[12513,12460,12488,12531],256],13133:[[12513,12540,12488,12523],256],13134:[[12516,12540,12489],256],13135:[[12516,12540,12523],256],13136:[[12518,12450,12531],256],13137:[[12522,12483,12488,12523],256],13138:[[12522,12521],256],13139:[[12523,12500,12540],256],13140:[[12523,12540,12502,12523],256],13141:[[12524,12512],256],13142:[[12524,12531,12488,12466,12531],256],13143:[[12527,12483,12488],256],13144:[[48,28857],256],13145:[[49,28857],256],13146:[[50,28857],256],13147:[[51,28857],256],13148:[[52,28857],256],13149:[[53,28857],256],13150:[[54,28857],256],13151:[[55,28857],256],13152:[[56,28857],256],13153:[[57,28857],256],13154:[[49,48,28857],256],13155:[[49,49,28857],256],13156:[[49,50,28857],256],13157:[[49,51,28857],256],13158:[[49,52,28857],256],13159:[[49,53,28857],256],13160:[[49,54,28857],256],13161:[[49,55,28857],256],13162:[[49,56,28857],256],13163:[[49,57,28857],256],13164:[[50,48,28857],256],13165:[[50,49,28857],256],13166:[[50,50,28857],256],13167:[[50,51,28857],256],13168:[[50,52,28857],256],13169:[[104,80,97],256],13170:[[100,97],256],13171:[[65,85],256],13172:[[98,97,114],256],13173:[[111,86],256],13174:[[112,99],256],13175:[[100,109],256],13176:[[100,109,178],256],13177:[[100,109,179],256],13178:[[73,85],256],13179:[[24179,25104],256],13180:[[26157,21644],256],13181:[[22823,27491],256],13182:[[26126,27835],256],13183:[[26666,24335,20250,31038],256],13184:[[112,65],256],13185:[[110,65],256],13186:[[956,65],256],13187:[[109,65],256],13188:[[107,65],256],13189:[[75,66],256],13190:[[77,66],256],13191:[[71,66],256],13192:[[99,97,108],256],13193:[[107,99,97,108],256],13194:[[112,70],256],13195:[[110,70],256],13196:[[956,70],256],13197:[[956,103],256],13198:[[109,103],256],13199:[[107,103],256],13200:[[72,122],256],13201:[[107,72,122],256],13202:[[77,72,122],256],13203:[[71,72,122],256],13204:[[84,72,122],256],13205:[[956,8467],256],13206:[[109,8467],256],13207:[[100,8467],256],13208:[[107,8467],256],13209:[[102,109],256],13210:[[110,109],256],13211:[[956,109],256],13212:[[109,109],256],13213:[[99,109],256],13214:[[107,109],256],13215:[[109,109,178],256],13216:[[99,109,178],256],13217:[[109,178],256],13218:[[107,109,178],256],13219:[[109,109,179],256],13220:[[99,109,179],256],13221:[[109,179],256],13222:[[107,109,179],256],13223:[[109,8725,115],256],13224:[[109,8725,115,178],256],13225:[[80,97],256],13226:[[107,80,97],256],13227:[[77,80,97],256],13228:[[71,80,97],256],13229:[[114,97,100],256],13230:[[114,97,100,8725,115],256],13231:[[114,97,100,8725,115,178],256],13232:[[112,115],256],13233:[[110,115],256],13234:[[956,115],256],13235:[[109,115],256],13236:[[112,86],256],13237:[[110,86],256],13238:[[956,86],256],13239:[[109,86],256],13240:[[107,86],256],13241:[[77,86],256],13242:[[112,87],256],13243:[[110,87],256],13244:[[956,87],256],13245:[[109,87],256],13246:[[107,87],256],13247:[[77,87],256],13248:[[107,937],256],13249:[[77,937],256],13250:[[97,46,109,46],256],13251:[[66,113],256],13252:[[99,99],256],13253:[[99,100],256],13254:[[67,8725,107,103],256],13255:[[67,111,46],256],13256:[[100,66],256],13257:[[71,121],256],13258:[[104,97],256],13259:[[72,80],256],13260:[[105,110],256],13261:[[75,75],256],13262:[[75,77],256],13263:[[107,116],256],13264:[[108,109],256],13265:[[108,110],256],13266:[[108,111,103],256],13267:[[108,120],256],13268:[[109,98],256],13269:[[109,105,108],256],13270:[[109,111,108],256],13271:[[80,72],256],13272:[[112,46,109,46],256],13273:[[80,80,77],256],13274:[[80,82],256],13275:[[115,114],256],13276:[[83,118],256],13277:[[87,98],256],13278:[[86,8725,109],256],13279:[[65,8725,109],256],13280:[[49,26085],256],13281:[[50,26085],256],13282:[[51,26085],256],13283:[[52,26085],256],13284:[[53,26085],256],13285:[[54,26085],256],13286:[[55,26085],256],13287:[[56,26085],256],13288:[[57,26085],256],13289:[[49,48,26085],256],13290:[[49,49,26085],256],13291:[[49,50,26085],256],13292:[[49,51,26085],256],13293:[[49,52,26085],256],13294:[[49,53,26085],256],13295:[[49,54,26085],256],13296:[[49,55,26085],256],13297:[[49,56,26085],256],13298:[[49,57,26085],256],13299:[[50,48,26085],256],13300:[[50,49,26085],256],13301:[[50,50,26085],256],13302:[[50,51,26085],256],13303:[[50,52,26085],256],13304:[[50,53,26085],256],13305:[[50,54,26085],256],13306:[[50,55,26085],256],13307:[[50,56,26085],256],13308:[[50,57,26085],256],13309:[[51,48,26085],256],13310:[[51,49,26085],256],13311:[[103,97,108],256]},27136:{92912:[,1],92913:[,1],92914:[,1],92915:[,1],92916:[,1]},27392:{92976:[,230],92977:[,230],92978:[,230],92979:[,230],92980:[,230],92981:[,230],92982:[,230]},42496:{42607:[,230],42612:[,230],42613:[,230],42614:[,230],42615:[,230],42616:[,230],42617:[,230],42618:[,230],42619:[,230],42620:[,230],42621:[,230],42652:[[1098],256],42653:[[1100],256],42655:[,230],42736:[,230],42737:[,230]},42752:{42864:[[42863],256],43e3:[[294],256],43001:[[339],256]},43008:{43014:[,9],43204:[,9],43232:[,230],43233:[,230],43234:[,230],43235:[,230],43236:[,230],43237:[,230],43238:[,230],43239:[,230],43240:[,230],43241:[,230],43242:[,230],43243:[,230],43244:[,230],43245:[,230],43246:[,230],43247:[,230],43248:[,230],43249:[,230]},43264:{43307:[,220],43308:[,220],43309:[,220],43347:[,9],43443:[,7],43456:[,9]},43520:{43696:[,230],43698:[,230],43699:[,230],43700:[,220],43703:[,230],43704:[,230],43710:[,230],43711:[,230],43713:[,230],43766:[,9]},43776:{43868:[[42791],256],43869:[[43831],256],43870:[[619],256],43871:[[43858],256],44013:[,9]},48128:{113822:[,1]},53504:{119134:[[119127,119141],512],119135:[[119128,119141],512],119136:[[119135,119150],512],119137:[[119135,119151],512],119138:[[119135,119152],512],119139:[[119135,119153],512],119140:[[119135,119154],512],119141:[,216],119142:[,216],119143:[,1],119144:[,1],119145:[,1],119149:[,226],119150:[,216],119151:[,216],119152:[,216],119153:[,216],119154:[,216],119163:[,220],119164:[,220],119165:[,220],119166:[,220],119167:[,220],119168:[,220],119169:[,220],119170:[,220],119173:[,230],119174:[,230],119175:[,230],119176:[,230],119177:[,230],119178:[,220],119179:[,220],119210:[,230],119211:[,230],119212:[,230],119213:[,230],119227:[[119225,119141],512],119228:[[119226,119141],512],119229:[[119227,119150],512],119230:[[119228,119150],512],119231:[[119227,119151],512],119232:[[119228,119151],512]},53760:{119362:[,230],119363:[,230],119364:[,230]},54272:{119808:[[65],256],119809:[[66],256],119810:[[67],256],119811:[[68],256],119812:[[69],256],119813:[[70],256],119814:[[71],256],119815:[[72],256],119816:[[73],256],119817:[[74],256],119818:[[75],256],119819:[[76],256],119820:[[77],256],119821:[[78],256],119822:[[79],256],119823:[[80],256],119824:[[81],256],119825:[[82],256],119826:[[83],256],119827:[[84],256],119828:[[85],256],119829:[[86],256],119830:[[87],256],119831:[[88],256],119832:[[89],256],119833:[[90],256],119834:[[97],256],119835:[[98],256],119836:[[99],256],119837:[[100],256],119838:[[101],256],119839:[[102],256],119840:[[103],256],119841:[[104],256],119842:[[105],256],119843:[[106],256],119844:[[107],256],119845:[[108],256],119846:[[109],256],119847:[[110],256],119848:[[111],256],119849:[[112],256],119850:[[113],256],119851:[[114],256],119852:[[115],256],119853:[[116],256],119854:[[117],256],119855:[[118],256],119856:[[119],256],119857:[[120],256],119858:[[121],256],119859:[[122],256],119860:[[65],256],119861:[[66],256],119862:[[67],256],119863:[[68],256],119864:[[69],256],119865:[[70],256],119866:[[71],256],119867:[[72],256],119868:[[73],256],119869:[[74],256],119870:[[75],256],119871:[[76],256],119872:[[77],256],119873:[[78],256],119874:[[79],256],119875:[[80],256],119876:[[81],256],119877:[[82],256],119878:[[83],256],119879:[[84],256],119880:[[85],256],119881:[[86],256],119882:[[87],256],119883:[[88],256],119884:[[89],256],119885:[[90],256],119886:[[97],256],119887:[[98],256],119888:[[99],256],119889:[[100],256],119890:[[101],256],119891:[[102],256],119892:[[103],256],119894:[[105],256],119895:[[106],256],119896:[[107],256],119897:[[108],256],119898:[[109],256],119899:[[110],256],119900:[[111],256],119901:[[112],256],119902:[[113],256],119903:[[114],256],119904:[[115],256],119905:[[116],256],119906:[[117],256],119907:[[118],256],119908:[[119],256],119909:[[120],256],119910:[[121],256],119911:[[122],256],119912:[[65],256],119913:[[66],256],119914:[[67],256],119915:[[68],256],119916:[[69],256],119917:[[70],256],119918:[[71],256],119919:[[72],256],119920:[[73],256],119921:[[74],256],119922:[[75],256],119923:[[76],256],119924:[[77],256],119925:[[78],256],119926:[[79],256],119927:[[80],256],119928:[[81],256],119929:[[82],256],119930:[[83],256],119931:[[84],256],119932:[[85],256],119933:[[86],256],119934:[[87],256],119935:[[88],256],119936:[[89],256],119937:[[90],256],119938:[[97],256],119939:[[98],256],119940:[[99],256],119941:[[100],256],119942:[[101],256],119943:[[102],256],119944:[[103],256],119945:[[104],256],119946:[[105],256],119947:[[106],256],119948:[[107],256],119949:[[108],256],119950:[[109],256],119951:[[110],256],119952:[[111],256],119953:[[112],256],119954:[[113],256],119955:[[114],256],119956:[[115],256],119957:[[116],256],119958:[[117],256],119959:[[118],256],119960:[[119],256],119961:[[120],256],119962:[[121],256],119963:[[122],256],119964:[[65],256],119966:[[67],256],119967:[[68],256],119970:[[71],256],119973:[[74],256],119974:[[75],256],119977:[[78],256],119978:[[79],256],119979:[[80],256],119980:[[81],256],119982:[[83],256],119983:[[84],256],119984:[[85],256],119985:[[86],256],119986:[[87],256],119987:[[88],256],119988:[[89],256],119989:[[90],256],119990:[[97],256],119991:[[98],256],119992:[[99],256],119993:[[100],256],119995:[[102],256],119997:[[104],256],119998:[[105],256],119999:[[106],256],12e4:[[107],256],120001:[[108],256],120002:[[109],256],120003:[[110],256],120005:[[112],256],120006:[[113],256],120007:[[114],256],120008:[[115],256],120009:[[116],256],120010:[[117],256],120011:[[118],256],120012:[[119],256],120013:[[120],256],120014:[[121],256],120015:[[122],256],120016:[[65],256],120017:[[66],256],120018:[[67],256],120019:[[68],256],120020:[[69],256],120021:[[70],256],120022:[[71],256],120023:[[72],256],120024:[[73],256],120025:[[74],256],120026:[[75],256],120027:[[76],256],120028:[[77],256],120029:[[78],256],120030:[[79],256],120031:[[80],256],120032:[[81],256],120033:[[82],256],120034:[[83],256],120035:[[84],256],120036:[[85],256],120037:[[86],256],120038:[[87],256],120039:[[88],256],120040:[[89],256],120041:[[90],256],120042:[[97],256],120043:[[98],256],120044:[[99],256],120045:[[100],256],120046:[[101],256],120047:[[102],256],120048:[[103],256],120049:[[104],256],120050:[[105],256],120051:[[106],256],120052:[[107],256],120053:[[108],256],120054:[[109],256],120055:[[110],256],120056:[[111],256],120057:[[112],256],120058:[[113],256],120059:[[114],256],120060:[[115],256],120061:[[116],256],120062:[[117],256],120063:[[118],256]},54528:{120064:[[119],256],120065:[[120],256],120066:[[121],256],120067:[[122],256],120068:[[65],256],120069:[[66],256],120071:[[68],256],120072:[[69],256],120073:[[70],256],120074:[[71],256],120077:[[74],256],120078:[[75],256],120079:[[76],256],120080:[[77],256],120081:[[78],256],120082:[[79],256],120083:[[80],256],120084:[[81],256],120086:[[83],256],120087:[[84],256],120088:[[85],256],120089:[[86],256],120090:[[87],256],120091:[[88],256],120092:[[89],256],120094:[[97],256],120095:[[98],256],120096:[[99],256],120097:[[100],256],120098:[[101],256],120099:[[102],256],120100:[[103],256],120101:[[104],256],120102:[[105],256],120103:[[106],256],120104:[[107],256],120105:[[108],256],120106:[[109],256],120107:[[110],256],120108:[[111],256],120109:[[112],256],120110:[[113],256],120111:[[114],256],120112:[[115],256],120113:[[116],256],120114:[[117],256],120115:[[118],256],120116:[[119],256],120117:[[120],256],120118:[[121],256],120119:[[122],256],120120:[[65],256],120121:[[66],256],120123:[[68],256],120124:[[69],256],120125:[[70],256],120126:[[71],256],120128:[[73],256],120129:[[74],256],120130:[[75],256],120131:[[76],256],120132:[[77],256],120134:[[79],256],120138:[[83],256],120139:[[84],256],120140:[[85],256],120141:[[86],256],120142:[[87],256],120143:[[88],256],120144:[[89],256],120146:[[97],256],120147:[[98],256],120148:[[99],256],120149:[[100],256],120150:[[101],256],120151:[[102],256],120152:[[103],256],120153:[[104],256],120154:[[105],256],120155:[[106],256],120156:[[107],256],120157:[[108],256],120158:[[109],256],120159:[[110],256],120160:[[111],256],120161:[[112],256],120162:[[113],256],120163:[[114],256],120164:[[115],256],120165:[[116],256],120166:[[117],256],120167:[[118],256],120168:[[119],256],120169:[[120],256],120170:[[121],256],120171:[[122],256],120172:[[65],256],120173:[[66],256],120174:[[67],256],120175:[[68],256],120176:[[69],256],120177:[[70],256],120178:[[71],256],120179:[[72],256],120180:[[73],256],120181:[[74],256],120182:[[75],256],120183:[[76],256],120184:[[77],256],120185:[[78],256],120186:[[79],256],120187:[[80],256],120188:[[81],256],120189:[[82],256],120190:[[83],256],120191:[[84],256],120192:[[85],256],120193:[[86],256],120194:[[87],256],120195:[[88],256],120196:[[89],256],120197:[[90],256],120198:[[97],256],120199:[[98],256],120200:[[99],256],120201:[[100],256],120202:[[101],256],120203:[[102],256],120204:[[103],256],120205:[[104],256],120206:[[105],256],120207:[[106],256],120208:[[107],256],120209:[[108],256],120210:[[109],256],120211:[[110],256],120212:[[111],256],120213:[[112],256],120214:[[113],256],120215:[[114],256],120216:[[115],256],120217:[[116],256],120218:[[117],256],120219:[[118],256],120220:[[119],256],120221:[[120],256],120222:[[121],256],120223:[[122],256],120224:[[65],256],120225:[[66],256],120226:[[67],256],120227:[[68],256],120228:[[69],256],120229:[[70],256],120230:[[71],256],120231:[[72],256],120232:[[73],256],120233:[[74],256],120234:[[75],256],120235:[[76],256],120236:[[77],256],120237:[[78],256],120238:[[79],256],120239:[[80],256],120240:[[81],256],120241:[[82],256],120242:[[83],256],120243:[[84],256],120244:[[85],256],120245:[[86],256],120246:[[87],256],120247:[[88],256],120248:[[89],256],120249:[[90],256],120250:[[97],256],120251:[[98],256],120252:[[99],256],120253:[[100],256],120254:[[101],256],120255:[[102],256],120256:[[103],256],120257:[[104],256],120258:[[105],256],120259:[[106],256],120260:[[107],256],120261:[[108],256],120262:[[109],256],120263:[[110],256],120264:[[111],256],120265:[[112],256],120266:[[113],256],120267:[[114],256],120268:[[115],256],120269:[[116],256],120270:[[117],256],120271:[[118],256],120272:[[119],256],120273:[[120],256],120274:[[121],256],120275:[[122],256],120276:[[65],256],120277:[[66],256],120278:[[67],256],120279:[[68],256],120280:[[69],256],120281:[[70],256],120282:[[71],256],120283:[[72],256],120284:[[73],256],120285:[[74],256],120286:[[75],256],120287:[[76],256],120288:[[77],256],120289:[[78],256],120290:[[79],256],120291:[[80],256],120292:[[81],256],120293:[[82],256],120294:[[83],256],120295:[[84],256],120296:[[85],256],120297:[[86],256],120298:[[87],256],120299:[[88],256],120300:[[89],256],120301:[[90],256],120302:[[97],256],120303:[[98],256],120304:[[99],256],120305:[[100],256],120306:[[101],256],120307:[[102],256],120308:[[103],256],120309:[[104],256],120310:[[105],256],120311:[[106],256],120312:[[107],256],120313:[[108],256],120314:[[109],256],120315:[[110],256],120316:[[111],256],120317:[[112],256],120318:[[113],256],120319:[[114],256]},54784:{120320:[[115],256],120321:[[116],256],120322:[[117],256],120323:[[118],256],120324:[[119],256],120325:[[120],256],120326:[[121],256],120327:[[122],256],120328:[[65],256],120329:[[66],256],120330:[[67],256],120331:[[68],256],120332:[[69],256],120333:[[70],256],120334:[[71],256],120335:[[72],256],120336:[[73],256],120337:[[74],256],120338:[[75],256],120339:[[76],256],120340:[[77],256],120341:[[78],256],120342:[[79],256],120343:[[80],256],120344:[[81],256],120345:[[82],256],120346:[[83],256],120347:[[84],256],120348:[[85],256],120349:[[86],256],120350:[[87],256],120351:[[88],256],120352:[[89],256],120353:[[90],256],120354:[[97],256],120355:[[98],256],120356:[[99],256],120357:[[100],256],120358:[[101],256],120359:[[102],256],120360:[[103],256],120361:[[104],256],120362:[[105],256],120363:[[106],256],120364:[[107],256],120365:[[108],256],120366:[[109],256],120367:[[110],256],120368:[[111],256],120369:[[112],256],120370:[[113],256],120371:[[114],256],120372:[[115],256],120373:[[116],256],120374:[[117],256],120375:[[118],256],120376:[[119],256],120377:[[120],256],120378:[[121],256],120379:[[122],256],120380:[[65],256],120381:[[66],256],120382:[[67],256],120383:[[68],256],120384:[[69],256],120385:[[70],256],120386:[[71],256],120387:[[72],256],120388:[[73],256],120389:[[74],256],120390:[[75],256],120391:[[76],256],120392:[[77],256],120393:[[78],256],120394:[[79],256],120395:[[80],256],120396:[[81],256],120397:[[82],256],120398:[[83],256],120399:[[84],256],120400:[[85],256],120401:[[86],256],120402:[[87],256],120403:[[88],256],120404:[[89],256],120405:[[90],256],120406:[[97],256],120407:[[98],256],120408:[[99],256],120409:[[100],256],120410:[[101],256],120411:[[102],256],120412:[[103],256],120413:[[104],256],120414:[[105],256],120415:[[106],256],120416:[[107],256],120417:[[108],256],120418:[[109],256],120419:[[110],256],120420:[[111],256],120421:[[112],256],120422:[[113],256],120423:[[114],256],120424:[[115],256],120425:[[116],256],120426:[[117],256],120427:[[118],256],120428:[[119],256],120429:[[120],256],120430:[[121],256],120431:[[122],256],120432:[[65],256],120433:[[66],256],120434:[[67],256],120435:[[68],256],120436:[[69],256],120437:[[70],256],120438:[[71],256],120439:[[72],256],120440:[[73],256],120441:[[74],256],120442:[[75],256],120443:[[76],256],120444:[[77],256],120445:[[78],256],120446:[[79],256],120447:[[80],256],120448:[[81],256],120449:[[82],256],120450:[[83],256],120451:[[84],256],120452:[[85],256],120453:[[86],256],120454:[[87],256],120455:[[88],256],120456:[[89],256],120457:[[90],256],120458:[[97],256],120459:[[98],256],120460:[[99],256],120461:[[100],256],120462:[[101],256],120463:[[102],256],120464:[[103],256],120465:[[104],256],120466:[[105],256],120467:[[106],256],120468:[[107],256],120469:[[108],256],120470:[[109],256],120471:[[110],256],120472:[[111],256],120473:[[112],256],120474:[[113],256],120475:[[114],256],120476:[[115],256],120477:[[116],256],120478:[[117],256],120479:[[118],256],120480:[[119],256],120481:[[120],256],120482:[[121],256],120483:[[122],256],120484:[[305],256],120485:[[567],256],120488:[[913],256],120489:[[914],256],120490:[[915],256],120491:[[916],256],120492:[[917],256],120493:[[918],256],120494:[[919],256],120495:[[920],256],120496:[[921],256],120497:[[922],256],120498:[[923],256],120499:[[924],256],120500:[[925],256],120501:[[926],256],120502:[[927],256],120503:[[928],256],120504:[[929],256],120505:[[1012],256],120506:[[931],256],120507:[[932],256],120508:[[933],256],120509:[[934],256],120510:[[935],256],120511:[[936],256],120512:[[937],256],120513:[[8711],256],120514:[[945],256],120515:[[946],256],120516:[[947],256],120517:[[948],256],120518:[[949],256],120519:[[950],256],120520:[[951],256],120521:[[952],256],120522:[[953],256],120523:[[954],256],120524:[[955],256],120525:[[956],256],120526:[[957],256],120527:[[958],256],120528:[[959],256],120529:[[960],256],120530:[[961],256],120531:[[962],256],120532:[[963],256],120533:[[964],256],120534:[[965],256],120535:[[966],256],120536:[[967],256],120537:[[968],256],120538:[[969],256],120539:[[8706],256],120540:[[1013],256],120541:[[977],256],120542:[[1008],256],120543:[[981],256],120544:[[1009],256],120545:[[982],256],120546:[[913],256],120547:[[914],256],120548:[[915],256],120549:[[916],256],120550:[[917],256],120551:[[918],256],120552:[[919],256],120553:[[920],256],120554:[[921],256],120555:[[922],256],120556:[[923],256],120557:[[924],256],120558:[[925],256],120559:[[926],256],120560:[[927],256],120561:[[928],256],120562:[[929],256],120563:[[1012],256],120564:[[931],256],120565:[[932],256],120566:[[933],256],120567:[[934],256],120568:[[935],256],120569:[[936],256],120570:[[937],256],120571:[[8711],256],120572:[[945],256],120573:[[946],256],120574:[[947],256],120575:[[948],256]},55040:{120576:[[949],256],120577:[[950],256],120578:[[951],256],120579:[[952],256],120580:[[953],256],120581:[[954],256],120582:[[955],256],120583:[[956],256],120584:[[957],256],120585:[[958],256],120586:[[959],256],120587:[[960],256],120588:[[961],256],120589:[[962],256],120590:[[963],256],120591:[[964],256],120592:[[965],256],120593:[[966],256],120594:[[967],256],120595:[[968],256],120596:[[969],256],120597:[[8706],256],120598:[[1013],256],120599:[[977],256],120600:[[1008],256],120601:[[981],256],120602:[[1009],256],120603:[[982],256],120604:[[913],256],120605:[[914],256],120606:[[915],256],120607:[[916],256],120608:[[917],256],120609:[[918],256],120610:[[919],256],120611:[[920],256],120612:[[921],256],120613:[[922],256],120614:[[923],256],120615:[[924],256],120616:[[925],256],120617:[[926],256],120618:[[927],256],120619:[[928],256],120620:[[929],256],120621:[[1012],256],120622:[[931],256],120623:[[932],256],120624:[[933],256],120625:[[934],256],120626:[[935],256],120627:[[936],256],120628:[[937],256],120629:[[8711],256],120630:[[945],256],120631:[[946],256],120632:[[947],256],120633:[[948],256],120634:[[949],256],120635:[[950],256],120636:[[951],256],120637:[[952],256],120638:[[953],256],120639:[[954],256],120640:[[955],256],120641:[[956],256],120642:[[957],256],120643:[[958],256],120644:[[959],256],120645:[[960],256],120646:[[961],256],120647:[[962],256],120648:[[963],256],120649:[[964],256],120650:[[965],256],120651:[[966],256],120652:[[967],256],120653:[[968],256],120654:[[969],256],120655:[[8706],256],120656:[[1013],256],120657:[[977],256],120658:[[1008],256],120659:[[981],256],120660:[[1009],256],120661:[[982],256],120662:[[913],256],120663:[[914],256],120664:[[915],256],120665:[[916],256],120666:[[917],256],120667:[[918],256],120668:[[919],256],120669:[[920],256],120670:[[921],256],120671:[[922],256],120672:[[923],256],120673:[[924],256],120674:[[925],256],120675:[[926],256],120676:[[927],256],120677:[[928],256],120678:[[929],256],120679:[[1012],256],120680:[[931],256],120681:[[932],256],120682:[[933],256],120683:[[934],256],120684:[[935],256],120685:[[936],256],120686:[[937],256],120687:[[8711],256],120688:[[945],256],120689:[[946],256],120690:[[947],256],120691:[[948],256],120692:[[949],256],120693:[[950],256],120694:[[951],256],120695:[[952],256],120696:[[953],256],120697:[[954],256],120698:[[955],256],120699:[[956],256],120700:[[957],256],120701:[[958],256],120702:[[959],256],120703:[[960],256],120704:[[961],256],120705:[[962],256],120706:[[963],256],120707:[[964],256],120708:[[965],256],120709:[[966],256],120710:[[967],256],120711:[[968],256],120712:[[969],256],120713:[[8706],256],120714:[[1013],256],120715:[[977],256],120716:[[1008],256],120717:[[981],256],120718:[[1009],256],120719:[[982],256],120720:[[913],256],120721:[[914],256],120722:[[915],256],120723:[[916],256],120724:[[917],256],120725:[[918],256],120726:[[919],256],120727:[[920],256],120728:[[921],256],120729:[[922],256],120730:[[923],256],120731:[[924],256],120732:[[925],256],120733:[[926],256],120734:[[927],256],120735:[[928],256],120736:[[929],256],120737:[[1012],256],120738:[[931],256],120739:[[932],256],120740:[[933],256],120741:[[934],256],120742:[[935],256],120743:[[936],256],120744:[[937],256],120745:[[8711],256],120746:[[945],256],120747:[[946],256],120748:[[947],256],120749:[[948],256],120750:[[949],256],120751:[[950],256],120752:[[951],256],120753:[[952],256],120754:[[953],256],120755:[[954],256],120756:[[955],256],120757:[[956],256],120758:[[957],256],120759:[[958],256],120760:[[959],256],120761:[[960],256],120762:[[961],256],120763:[[962],256],120764:[[963],256],120765:[[964],256],120766:[[965],256],120767:[[966],256],120768:[[967],256],120769:[[968],256],120770:[[969],256],120771:[[8706],256],120772:[[1013],256],120773:[[977],256],120774:[[1008],256],120775:[[981],256],120776:[[1009],256],120777:[[982],256],120778:[[988],256],120779:[[989],256],120782:[[48],256],120783:[[49],256],120784:[[50],256],120785:[[51],256],120786:[[52],256],120787:[[53],256],120788:[[54],256],120789:[[55],256],120790:[[56],256],120791:[[57],256],120792:[[48],256],120793:[[49],256],120794:[[50],256],120795:[[51],256],120796:[[52],256],120797:[[53],256],120798:[[54],256],120799:[[55],256],120800:[[56],256],120801:[[57],256],120802:[[48],256],120803:[[49],256],120804:[[50],256],120805:[[51],256],120806:[[52],256],120807:[[53],256],120808:[[54],256],120809:[[55],256],120810:[[56],256],120811:[[57],256],120812:[[48],256],120813:[[49],256],120814:[[50],256],120815:[[51],256],120816:[[52],256],120817:[[53],256],120818:[[54],256],120819:[[55],256],120820:[[56],256],120821:[[57],256],120822:[[48],256],120823:[[49],256],120824:[[50],256],120825:[[51],256],120826:[[52],256],120827:[[53],256],120828:[[54],256],120829:[[55],256],120830:[[56],256],120831:[[57],256]},59392:{125136:[,220],125137:[,220],125138:[,220],125139:[,220],125140:[,220],125141:[,220],125142:[,220]},60928:{126464:[[1575],256],126465:[[1576],256],126466:[[1580],256],126467:[[1583],256],126469:[[1608],256],126470:[[1586],256],126471:[[1581],256],126472:[[1591],256],126473:[[1610],256],126474:[[1603],256],126475:[[1604],256],126476:[[1605],256],126477:[[1606],256],126478:[[1587],256],126479:[[1593],256],126480:[[1601],256],126481:[[1589],256],126482:[[1602],256],126483:[[1585],256],126484:[[1588],256],126485:[[1578],256],126486:[[1579],256],126487:[[1582],256],126488:[[1584],256],126489:[[1590],256],126490:[[1592],256],126491:[[1594],256],126492:[[1646],256],126493:[[1722],256],126494:[[1697],256],126495:[[1647],256],126497:[[1576],256],126498:[[1580],256],126500:[[1607],256],126503:[[1581],256],126505:[[1610],256],126506:[[1603],256],126507:[[1604],256],126508:[[1605],256],126509:[[1606],256],126510:[[1587],256],126511:[[1593],256],126512:[[1601],256],126513:[[1589],256],126514:[[1602],256],126516:[[1588],256],126517:[[1578],256],126518:[[1579],256],126519:[[1582],256],126521:[[1590],256],126523:[[1594],256],126530:[[1580],256],126535:[[1581],256],126537:[[1610],256],126539:[[1604],256],126541:[[1606],256],126542:[[1587],256],126543:[[1593],256],126545:[[1589],256],126546:[[1602],256],126548:[[1588],256],126551:[[1582],256],126553:[[1590],256],126555:[[1594],256],126557:[[1722],256],126559:[[1647],256],126561:[[1576],256],126562:[[1580],256],126564:[[1607],256],126567:[[1581],256],126568:[[1591],256],126569:[[1610],256],126570:[[1603],256],126572:[[1605],256],126573:[[1606],256],126574:[[1587],256],126575:[[1593],256],126576:[[1601],256],126577:[[1589],256],126578:[[1602],256],126580:[[1588],256],126581:[[1578],256],126582:[[1579],256],126583:[[1582],256],126585:[[1590],256],126586:[[1592],256],126587:[[1594],256],126588:[[1646],256],126590:[[1697],256],126592:[[1575],256],126593:[[1576],256],126594:[[1580],256],126595:[[1583],256],126596:[[1607],256],126597:[[1608],256],126598:[[1586],256],126599:[[1581],256],126600:[[1591],256],126601:[[1610],256],126603:[[1604],256],126604:[[1605],256],126605:[[1606],256],126606:[[1587],256],126607:[[1593],256],126608:[[1601],256],126609:[[1589],256],126610:[[1602],256],126611:[[1585],256],126612:[[1588],256],126613:[[1578],256],126614:[[1579],256],126615:[[1582],256],126616:[[1584],256],126617:[[1590],256],126618:[[1592],256],126619:[[1594],256],126625:[[1576],256],126626:[[1580],256],126627:[[1583],256],126629:[[1608],256],126630:[[1586],256],126631:[[1581],256],126632:[[1591],256],126633:[[1610],256],126635:[[1604],256],126636:[[1605],256],126637:[[1606],256],126638:[[1587],256],126639:[[1593],256],126640:[[1601],256],126641:[[1589],256],126642:[[1602],256],126643:[[1585],256],126644:[[1588],256],126645:[[1578],256],126646:[[1579],256],126647:[[1582],256],126648:[[1584],256],126649:[[1590],256],126650:[[1592],256],126651:[[1594],256]},61696:{127232:[[48,46],256],127233:[[48,44],256],127234:[[49,44],256],127235:[[50,44],256],127236:[[51,44],256],127237:[[52,44],256],127238:[[53,44],256],127239:[[54,44],256],127240:[[55,44],256],127241:[[56,44],256],127242:[[57,44],256],127248:[[40,65,41],256],127249:[[40,66,41],256],127250:[[40,67,41],256],127251:[[40,68,41],256],127252:[[40,69,41],256],127253:[[40,70,41],256],127254:[[40,71,41],256],127255:[[40,72,41],256],127256:[[40,73,41],256],127257:[[40,74,41],256],127258:[[40,75,41],256],127259:[[40,76,41],256],127260:[[40,77,41],256],127261:[[40,78,41],256],127262:[[40,79,41],256],127263:[[40,80,41],256],127264:[[40,81,41],256],127265:[[40,82,41],256],127266:[[40,83,41],256],127267:[[40,84,41],256],127268:[[40,85,41],256],127269:[[40,86,41],256],127270:[[40,87,41],256],127271:[[40,88,41],256],127272:[[40,89,41],256],127273:[[40,90,41],256],127274:[[12308,83,12309],256],127275:[[67],256],127276:[[82],256],127277:[[67,68],256],127278:[[87,90],256],127280:[[65],256],127281:[[66],256],127282:[[67],256],127283:[[68],256],127284:[[69],256],127285:[[70],256],127286:[[71],256],127287:[[72],256],127288:[[73],256],127289:[[74],256],127290:[[75],256],127291:[[76],256],127292:[[77],256],127293:[[78],256],127294:[[79],256],127295:[[80],256],127296:[[81],256],127297:[[82],256],127298:[[83],256],127299:[[84],256],127300:[[85],256],127301:[[86],256],127302:[[87],256],127303:[[88],256],127304:[[89],256],127305:[[90],256],127306:[[72,86],256],127307:[[77,86],256],127308:[[83,68],256],127309:[[83,83],256],127310:[[80,80,86],256],127311:[[87,67],256],127338:[[77,67],256],127339:[[77,68],256],127376:[[68,74],256]},61952:{127488:[[12411,12363],256],127489:[[12467,12467],256],127490:[[12469],256],127504:[[25163],256],127505:[[23383],256],127506:[[21452],256],127507:[[12487],256],127508:[[20108],256],127509:[[22810],256],127510:[[35299],256],127511:[[22825],256],127512:[[20132],256],127513:[[26144],256],127514:[[28961],256],127515:[[26009],256],127516:[[21069],256],127517:[[24460],256],127518:[[20877],256],127519:[[26032],256],127520:[[21021],256],127521:[[32066],256],127522:[[29983],256],127523:[[36009],256],127524:[[22768],256],127525:[[21561],256],127526:[[28436],256],127527:[[25237],256],127528:[[25429],256],127529:[[19968],256],127530:[[19977],256],127531:[[36938],256],127532:[[24038],256],127533:[[20013],256],127534:[[21491],256],127535:[[25351],256],127536:[[36208],256],127537:[[25171],256],127538:[[31105],256],127539:[[31354],256],127540:[[21512],256],127541:[[28288],256],127542:[[26377],256],127543:[[26376],256],127544:[[30003],256],127545:[[21106],256],127546:[[21942],256],127552:[[12308,26412,12309],256],127553:[[12308,19977,12309],256],127554:[[12308,20108,12309],256],127555:[[12308,23433,12309],256],127556:[[12308,28857,12309],256],127557:[[12308,25171,12309],256],127558:[[12308,30423,12309],256],127559:[[12308,21213,12309],256],127560:[[12308,25943,12309],256],127568:[[24471],256],127569:[[21487],256]},63488:{194560:[[20029]],194561:[[20024]],194562:[[20033]],194563:[[131362]],194564:[[20320]],194565:[[20398]],194566:[[20411]],194567:[[20482]],194568:[[20602]],194569:[[20633]],194570:[[20711]],194571:[[20687]],194572:[[13470]],194573:[[132666]],194574:[[20813]],194575:[[20820]],194576:[[20836]],194577:[[20855]],194578:[[132380]],194579:[[13497]],194580:[[20839]],194581:[[20877]],194582:[[132427]],194583:[[20887]],194584:[[20900]],194585:[[20172]],194586:[[20908]],194587:[[20917]],194588:[[168415]],194589:[[20981]],194590:[[20995]],194591:[[13535]],194592:[[21051]],194593:[[21062]],194594:[[21106]],194595:[[21111]],194596:[[13589]],194597:[[21191]],194598:[[21193]],194599:[[21220]],194600:[[21242]],194601:[[21253]],194602:[[21254]],194603:[[21271]],194604:[[21321]],194605:[[21329]],194606:[[21338]],194607:[[21363]],194608:[[21373]],194609:[[21375]],194610:[[21375]],194611:[[21375]],194612:[[133676]],194613:[[28784]],194614:[[21450]],194615:[[21471]],194616:[[133987]],194617:[[21483]],194618:[[21489]],194619:[[21510]],194620:[[21662]],194621:[[21560]],194622:[[21576]],194623:[[21608]],194624:[[21666]],194625:[[21750]],194626:[[21776]],194627:[[21843]],194628:[[21859]],194629:[[21892]],194630:[[21892]],194631:[[21913]],194632:[[21931]],194633:[[21939]],194634:[[21954]],194635:[[22294]],194636:[[22022]],194637:[[22295]],194638:[[22097]],194639:[[22132]],194640:[[20999]],194641:[[22766]],194642:[[22478]],194643:[[22516]],194644:[[22541]],194645:[[22411]],194646:[[22578]],194647:[[22577]],194648:[[22700]],194649:[[136420]],194650:[[22770]],194651:[[22775]],194652:[[22790]],194653:[[22810]],194654:[[22818]],194655:[[22882]],194656:[[136872]],194657:[[136938]],194658:[[23020]],194659:[[23067]],194660:[[23079]],194661:[[23e3]],194662:[[23142]],194663:[[14062]],194664:[[14076]],194665:[[23304]],194666:[[23358]],194667:[[23358]],194668:[[137672]],194669:[[23491]],194670:[[23512]],194671:[[23527]],194672:[[23539]],194673:[[138008]],194674:[[23551]],194675:[[23558]],194676:[[24403]],194677:[[23586]],194678:[[14209]],194679:[[23648]],194680:[[23662]],194681:[[23744]],194682:[[23693]],194683:[[138724]],194684:[[23875]],194685:[[138726]],194686:[[23918]],194687:[[23915]],194688:[[23932]],194689:[[24033]],194690:[[24034]],194691:[[14383]],194692:[[24061]],194693:[[24104]],194694:[[24125]],194695:[[24169]],194696:[[14434]],194697:[[139651]],194698:[[14460]],194699:[[24240]],194700:[[24243]],194701:[[24246]],194702:[[24266]],194703:[[172946]],194704:[[24318]],194705:[[140081]],194706:[[140081]],194707:[[33281]],194708:[[24354]],194709:[[24354]],194710:[[14535]],194711:[[144056]],194712:[[156122]],194713:[[24418]],194714:[[24427]],194715:[[14563]],194716:[[24474]],194717:[[24525]],194718:[[24535]],194719:[[24569]],194720:[[24705]],194721:[[14650]],194722:[[14620]],194723:[[24724]],194724:[[141012]],194725:[[24775]],194726:[[24904]],194727:[[24908]],194728:[[24910]],194729:[[24908]],194730:[[24954]],194731:[[24974]],194732:[[25010]],194733:[[24996]],194734:[[25007]],194735:[[25054]],194736:[[25074]],194737:[[25078]],194738:[[25104]],194739:[[25115]],194740:[[25181]],194741:[[25265]],194742:[[25300]],194743:[[25424]],194744:[[142092]],194745:[[25405]],194746:[[25340]],194747:[[25448]],194748:[[25475]],194749:[[25572]],194750:[[142321]],194751:[[25634]],194752:[[25541]],194753:[[25513]],194754:[[14894]],194755:[[25705]],194756:[[25726]],194757:[[25757]],194758:[[25719]],194759:[[14956]],194760:[[25935]],194761:[[25964]],194762:[[143370]],194763:[[26083]],194764:[[26360]],194765:[[26185]],194766:[[15129]],194767:[[26257]],194768:[[15112]],194769:[[15076]],194770:[[20882]],194771:[[20885]],194772:[[26368]],194773:[[26268]],194774:[[32941]],194775:[[17369]],194776:[[26391]],194777:[[26395]],194778:[[26401]],194779:[[26462]],194780:[[26451]],194781:[[144323]],194782:[[15177]],194783:[[26618]],194784:[[26501]],194785:[[26706]],194786:[[26757]],194787:[[144493]],194788:[[26766]],194789:[[26655]],194790:[[26900]],194791:[[15261]],194792:[[26946]],194793:[[27043]],194794:[[27114]],194795:[[27304]],194796:[[145059]],194797:[[27355]],194798:[[15384]],194799:[[27425]],194800:[[145575]],194801:[[27476]],194802:[[15438]],194803:[[27506]],194804:[[27551]],194805:[[27578]],194806:[[27579]],194807:[[146061]],194808:[[138507]],194809:[[146170]],194810:[[27726]],194811:[[146620]],194812:[[27839]],194813:[[27853]],194814:[[27751]],194815:[[27926]]},63744:{63744:[[35912]],63745:[[26356]],63746:[[36554]],63747:[[36040]],63748:[[28369]],63749:[[20018]],63750:[[21477]],63751:[[40860]],63752:[[40860]],63753:[[22865]],63754:[[37329]],63755:[[21895]],63756:[[22856]],63757:[[25078]],63758:[[30313]],63759:[[32645]],63760:[[34367]],63761:[[34746]],63762:[[35064]],63763:[[37007]],63764:[[27138]],63765:[[27931]],63766:[[28889]],63767:[[29662]],63768:[[33853]],63769:[[37226]],63770:[[39409]],63771:[[20098]],63772:[[21365]],63773:[[27396]],63774:[[29211]],63775:[[34349]],63776:[[40478]],63777:[[23888]],63778:[[28651]],63779:[[34253]],63780:[[35172]],63781:[[25289]],63782:[[33240]],63783:[[34847]],63784:[[24266]],63785:[[26391]],63786:[[28010]],63787:[[29436]],63788:[[37070]],63789:[[20358]],63790:[[20919]],63791:[[21214]],63792:[[25796]],63793:[[27347]],63794:[[29200]],63795:[[30439]],63796:[[32769]],63797:[[34310]],63798:[[34396]],63799:[[36335]],63800:[[38706]],63801:[[39791]],63802:[[40442]],63803:[[30860]],63804:[[31103]],63805:[[32160]],63806:[[33737]],63807:[[37636]],63808:[[40575]],63809:[[35542]],63810:[[22751]],63811:[[24324]],63812:[[31840]],63813:[[32894]],63814:[[29282]],63815:[[30922]],63816:[[36034]],63817:[[38647]],63818:[[22744]],63819:[[23650]],63820:[[27155]],63821:[[28122]],63822:[[28431]],63823:[[32047]],63824:[[32311]],63825:[[38475]],63826:[[21202]],63827:[[32907]],63828:[[20956]],63829:[[20940]],63830:[[31260]],63831:[[32190]],63832:[[33777]],63833:[[38517]],63834:[[35712]],63835:[[25295]],63836:[[27138]],63837:[[35582]],63838:[[20025]],63839:[[23527]],63840:[[24594]],63841:[[29575]],63842:[[30064]],63843:[[21271]],63844:[[30971]],63845:[[20415]],63846:[[24489]],63847:[[19981]],63848:[[27852]],63849:[[25976]],63850:[[32034]],63851:[[21443]],63852:[[22622]],63853:[[30465]],63854:[[33865]],63855:[[35498]],63856:[[27578]],63857:[[36784]],63858:[[27784]],63859:[[25342]],63860:[[33509]],63861:[[25504]],63862:[[30053]],63863:[[20142]],63864:[[20841]],63865:[[20937]],63866:[[26753]],63867:[[31975]],63868:[[33391]],63869:[[35538]],63870:[[37327]],63871:[[21237]],63872:[[21570]],63873:[[22899]],63874:[[24300]],63875:[[26053]],63876:[[28670]],63877:[[31018]],63878:[[38317]],63879:[[39530]],63880:[[40599]],63881:[[40654]],63882:[[21147]],63883:[[26310]],63884:[[27511]],63885:[[36706]],63886:[[24180]],63887:[[24976]],63888:[[25088]],63889:[[25754]],63890:[[28451]],63891:[[29001]],63892:[[29833]],63893:[[31178]],63894:[[32244]],63895:[[32879]],63896:[[36646]],63897:[[34030]],63898:[[36899]],63899:[[37706]],63900:[[21015]],63901:[[21155]],63902:[[21693]],63903:[[28872]],63904:[[35010]],63905:[[35498]],63906:[[24265]],63907:[[24565]],63908:[[25467]],63909:[[27566]],63910:[[31806]],63911:[[29557]],63912:[[20196]],63913:[[22265]],63914:[[23527]],63915:[[23994]],63916:[[24604]],63917:[[29618]],63918:[[29801]],63919:[[32666]],63920:[[32838]],63921:[[37428]],63922:[[38646]],63923:[[38728]],63924:[[38936]],63925:[[20363]],63926:[[31150]],63927:[[37300]],63928:[[38584]],63929:[[24801]],63930:[[20102]],63931:[[20698]],63932:[[23534]],63933:[[23615]],63934:[[26009]],63935:[[27138]],63936:[[29134]],63937:[[30274]],63938:[[34044]],63939:[[36988]],63940:[[40845]],63941:[[26248]],63942:[[38446]],63943:[[21129]],63944:[[26491]],63945:[[26611]],63946:[[27969]],63947:[[28316]],63948:[[29705]],63949:[[30041]],63950:[[30827]],63951:[[32016]],63952:[[39006]],63953:[[20845]],63954:[[25134]],63955:[[38520]],63956:[[20523]],63957:[[23833]],63958:[[28138]],63959:[[36650]],63960:[[24459]],63961:[[24900]],63962:[[26647]],63963:[[29575]],63964:[[38534]],63965:[[21033]],63966:[[21519]],63967:[[23653]],63968:[[26131]],63969:[[26446]],63970:[[26792]],63971:[[27877]],63972:[[29702]],63973:[[30178]],63974:[[32633]],63975:[[35023]],63976:[[35041]],63977:[[37324]],63978:[[38626]],63979:[[21311]],63980:[[28346]],63981:[[21533]],63982:[[29136]],63983:[[29848]],63984:[[34298]],63985:[[38563]],63986:[[40023]],63987:[[40607]],63988:[[26519]],63989:[[28107]],63990:[[33256]],63991:[[31435]],63992:[[31520]],63993:[[31890]],63994:[[29376]],63995:[[28825]],63996:[[35672]],63997:[[20160]],63998:[[33590]],63999:[[21050]],194816:[[27966]],194817:[[28023]],194818:[[27969]],194819:[[28009]],194820:[[28024]],194821:[[28037]],194822:[[146718]],194823:[[27956]],194824:[[28207]],194825:[[28270]],194826:[[15667]],194827:[[28363]],194828:[[28359]],194829:[[147153]],194830:[[28153]],194831:[[28526]],194832:[[147294]],194833:[[147342]],194834:[[28614]],194835:[[28729]],194836:[[28702]],194837:[[28699]],194838:[[15766]],194839:[[28746]],194840:[[28797]],194841:[[28791]],194842:[[28845]],194843:[[132389]],194844:[[28997]],194845:[[148067]],194846:[[29084]],194847:[[148395]],194848:[[29224]],194849:[[29237]],194850:[[29264]],194851:[[149e3]],194852:[[29312]],194853:[[29333]],194854:[[149301]],194855:[[149524]],194856:[[29562]],194857:[[29579]],194858:[[16044]],194859:[[29605]],194860:[[16056]],194861:[[16056]],194862:[[29767]],194863:[[29788]],194864:[[29809]],194865:[[29829]],194866:[[29898]],194867:[[16155]],194868:[[29988]],194869:[[150582]],194870:[[30014]],194871:[[150674]],194872:[[30064]],194873:[[139679]],194874:[[30224]],194875:[[151457]],194876:[[151480]],194877:[[151620]],194878:[[16380]],194879:[[16392]],194880:[[30452]],194881:[[151795]],194882:[[151794]],194883:[[151833]],194884:[[151859]],194885:[[30494]],194886:[[30495]],194887:[[30495]],194888:[[30538]],194889:[[16441]],194890:[[30603]],194891:[[16454]],194892:[[16534]],194893:[[152605]],194894:[[30798]],194895:[[30860]],194896:[[30924]],194897:[[16611]],194898:[[153126]],194899:[[31062]],194900:[[153242]],194901:[[153285]],194902:[[31119]],194903:[[31211]],194904:[[16687]],194905:[[31296]],194906:[[31306]],194907:[[31311]],194908:[[153980]],194909:[[154279]],194910:[[154279]],194911:[[31470]],194912:[[16898]],194913:[[154539]],194914:[[31686]],194915:[[31689]],194916:[[16935]],194917:[[154752]],194918:[[31954]],194919:[[17056]],194920:[[31976]],194921:[[31971]],194922:[[32e3]],194923:[[155526]],194924:[[32099]],194925:[[17153]],194926:[[32199]],194927:[[32258]],194928:[[32325]],194929:[[17204]],194930:[[156200]],194931:[[156231]],194932:[[17241]],194933:[[156377]],194934:[[32634]],194935:[[156478]],194936:[[32661]],194937:[[32762]],194938:[[32773]],194939:[[156890]],194940:[[156963]],194941:[[32864]],194942:[[157096]],194943:[[32880]],194944:[[144223]],194945:[[17365]],194946:[[32946]],194947:[[33027]],194948:[[17419]],194949:[[33086]],194950:[[23221]],194951:[[157607]],194952:[[157621]],194953:[[144275]],194954:[[144284]],194955:[[33281]],194956:[[33284]],194957:[[36766]],194958:[[17515]],194959:[[33425]],194960:[[33419]],194961:[[33437]],194962:[[21171]],194963:[[33457]],194964:[[33459]],194965:[[33469]],194966:[[33510]],194967:[[158524]],194968:[[33509]],194969:[[33565]],194970:[[33635]],194971:[[33709]],194972:[[33571]],194973:[[33725]],194974:[[33767]],194975:[[33879]],194976:[[33619]],194977:[[33738]],194978:[[33740]],194979:[[33756]],194980:[[158774]],194981:[[159083]],194982:[[158933]],194983:[[17707]],194984:[[34033]],194985:[[34035]],194986:[[34070]],194987:[[160714]],194988:[[34148]],194989:[[159532]],194990:[[17757]],194991:[[17761]],194992:[[159665]],194993:[[159954]],194994:[[17771]],194995:[[34384]],194996:[[34396]],194997:[[34407]],194998:[[34409]],194999:[[34473]],195e3:[[34440]],195001:[[34574]],195002:[[34530]],195003:[[34681]],195004:[[34600]],195005:[[34667]],195006:[[34694]],195007:[[17879]],195008:[[34785]],195009:[[34817]],195010:[[17913]],195011:[[34912]],195012:[[34915]],195013:[[161383]],195014:[[35031]],195015:[[35038]],195016:[[17973]],195017:[[35066]],195018:[[13499]],195019:[[161966]],195020:[[162150]],195021:[[18110]],195022:[[18119]],195023:[[35488]],195024:[[35565]],195025:[[35722]],195026:[[35925]],195027:[[162984]],195028:[[36011]],195029:[[36033]],195030:[[36123]],195031:[[36215]],195032:[[163631]],195033:[[133124]],195034:[[36299]],195035:[[36284]],195036:[[36336]],195037:[[133342]],195038:[[36564]],195039:[[36664]],195040:[[165330]],195041:[[165357]],195042:[[37012]],195043:[[37105]],195044:[[37137]],195045:[[165678]],195046:[[37147]],195047:[[37432]],195048:[[37591]],195049:[[37592]],195050:[[37500]],195051:[[37881]],195052:[[37909]],195053:[[166906]],195054:[[38283]],195055:[[18837]],195056:[[38327]],195057:[[167287]],195058:[[18918]],195059:[[38595]],195060:[[23986]],195061:[[38691]],195062:[[168261]],195063:[[168474]],195064:[[19054]],195065:[[19062]],195066:[[38880]],195067:[[168970]],195068:[[19122]],195069:[[169110]],195070:[[38923]],195071:[[38923]]},64e3:{64e3:[[20999]],64001:[[24230]],64002:[[25299]],64003:[[31958]],64004:[[23429]],64005:[[27934]],64006:[[26292]],64007:[[36667]],64008:[[34892]],64009:[[38477]],64010:[[35211]],64011:[[24275]],64012:[[20800]],64013:[[21952]],64016:[[22618]],64018:[[26228]],64021:[[20958]],64022:[[29482]],64023:[[30410]],64024:[[31036]],64025:[[31070]],64026:[[31077]],64027:[[31119]],64028:[[38742]],64029:[[31934]],64030:[[32701]],64032:[[34322]],64034:[[35576]],64037:[[36920]],64038:[[37117]],64042:[[39151]],64043:[[39164]],64044:[[39208]],64045:[[40372]],64046:[[37086]],64047:[[38583]],64048:[[20398]],64049:[[20711]],64050:[[20813]],64051:[[21193]],64052:[[21220]],64053:[[21329]],64054:[[21917]],64055:[[22022]],64056:[[22120]],64057:[[22592]],64058:[[22696]],64059:[[23652]],64060:[[23662]],64061:[[24724]],64062:[[24936]],64063:[[24974]],64064:[[25074]],64065:[[25935]],64066:[[26082]],64067:[[26257]],64068:[[26757]],64069:[[28023]],64070:[[28186]],64071:[[28450]],64072:[[29038]],64073:[[29227]],64074:[[29730]],64075:[[30865]],64076:[[31038]],64077:[[31049]],64078:[[31048]],64079:[[31056]],64080:[[31062]],64081:[[31069]],64082:[[31117]],64083:[[31118]],64084:[[31296]],64085:[[31361]],64086:[[31680]],64087:[[32244]],64088:[[32265]],64089:[[32321]],64090:[[32626]],64091:[[32773]],64092:[[33261]],64093:[[33401]],64094:[[33401]],64095:[[33879]],64096:[[35088]],64097:[[35222]],64098:[[35585]],64099:[[35641]],64100:[[36051]],64101:[[36104]],64102:[[36790]],64103:[[36920]],64104:[[38627]],64105:[[38911]],64106:[[38971]],64107:[[24693]],64108:[[148206]],64109:[[33304]],64112:[[20006]],64113:[[20917]],64114:[[20840]],64115:[[20352]],64116:[[20805]],64117:[[20864]],64118:[[21191]],64119:[[21242]],64120:[[21917]],64121:[[21845]],64122:[[21913]],64123:[[21986]],64124:[[22618]],64125:[[22707]],64126:[[22852]],64127:[[22868]],64128:[[23138]],64129:[[23336]],64130:[[24274]],64131:[[24281]],64132:[[24425]],64133:[[24493]],64134:[[24792]],64135:[[24910]],64136:[[24840]],64137:[[24974]],64138:[[24928]],64139:[[25074]],64140:[[25140]],64141:[[25540]],64142:[[25628]],64143:[[25682]],64144:[[25942]],64145:[[26228]],64146:[[26391]],64147:[[26395]],64148:[[26454]],64149:[[27513]],64150:[[27578]],64151:[[27969]],64152:[[28379]],64153:[[28363]],64154:[[28450]],64155:[[28702]],64156:[[29038]],64157:[[30631]],64158:[[29237]],64159:[[29359]],64160:[[29482]],64161:[[29809]],64162:[[29958]],64163:[[30011]],64164:[[30237]],64165:[[30239]],64166:[[30410]],64167:[[30427]],64168:[[30452]],64169:[[30538]],64170:[[30528]],64171:[[30924]],64172:[[31409]],64173:[[31680]],64174:[[31867]],64175:[[32091]],64176:[[32244]],64177:[[32574]],64178:[[32773]],64179:[[33618]],64180:[[33775]],64181:[[34681]],64182:[[35137]],64183:[[35206]],64184:[[35222]],64185:[[35519]],64186:[[35576]],64187:[[35531]],64188:[[35585]],64189:[[35582]],64190:[[35565]],64191:[[35641]],64192:[[35722]],64193:[[36104]],64194:[[36664]],64195:[[36978]],64196:[[37273]],64197:[[37494]],64198:[[38524]],64199:[[38627]],64200:[[38742]],64201:[[38875]],64202:[[38911]],64203:[[38923]],64204:[[38971]],64205:[[39698]],64206:[[40860]],64207:[[141386]],64208:[[141380]],64209:[[144341]],64210:[[15261]],64211:[[16408]],64212:[[16441]],64213:[[152137]],64214:[[154832]],64215:[[163539]],64216:[[40771]],64217:[[40846]],195072:[[38953]],195073:[[169398]],195074:[[39138]],195075:[[19251]],195076:[[39209]],195077:[[39335]],195078:[[39362]],195079:[[39422]],195080:[[19406]],195081:[[170800]],195082:[[39698]],195083:[[4e4]],195084:[[40189]],195085:[[19662]],195086:[[19693]],195087:[[40295]],195088:[[172238]],195089:[[19704]],195090:[[172293]],195091:[[172558]],195092:[[172689]],195093:[[40635]],195094:[[19798]],195095:[[40697]],195096:[[40702]],195097:[[40709]],195098:[[40719]],195099:[[40726]],195100:[[40763]],195101:[[173568]]},64256:{64256:[[102,102],256],64257:[[102,105],256],64258:[[102,108],256],64259:[[102,102,105],256],64260:[[102,102,108],256],64261:[[383,116],256],64262:[[115,116],256],64275:[[1396,1398],256],64276:[[1396,1381],256],64277:[[1396,1387],256],64278:[[1406,1398],256],64279:[[1396,1389],256],64285:[[1497,1460],512],64286:[,26],64287:[[1522,1463],512],64288:[[1506],256],64289:[[1488],256],64290:[[1491],256],64291:[[1492],256],64292:[[1499],256],64293:[[1500],256],64294:[[1501],256],64295:[[1512],256],64296:[[1514],256],64297:[[43],256],64298:[[1513,1473],512],64299:[[1513,1474],512],64300:[[64329,1473],512],64301:[[64329,1474],512],64302:[[1488,1463],512],64303:[[1488,1464],512],64304:[[1488,1468],512],64305:[[1489,1468],512],64306:[[1490,1468],512],64307:[[1491,1468],512],64308:[[1492,1468],512],64309:[[1493,1468],512],64310:[[1494,1468],512],64312:[[1496,1468],512],64313:[[1497,1468],512],64314:[[1498,1468],512],64315:[[1499,1468],512],64316:[[1500,1468],512],64318:[[1502,1468],512],64320:[[1504,1468],512],64321:[[1505,1468],512],64323:[[1507,1468],512],64324:[[1508,1468],512],64326:[[1510,1468],512],64327:[[1511,1468],512],64328:[[1512,1468],512],64329:[[1513,1468],512],64330:[[1514,1468],512],64331:[[1493,1465],512],64332:[[1489,1471],512],64333:[[1499,1471],512],64334:[[1508,1471],512],64335:[[1488,1500],256],64336:[[1649],256],64337:[[1649],256],64338:[[1659],256],64339:[[1659],256],64340:[[1659],256],64341:[[1659],256],64342:[[1662],256],64343:[[1662],256],64344:[[1662],256],64345:[[1662],256],64346:[[1664],256],64347:[[1664],256],64348:[[1664],256],64349:[[1664],256],64350:[[1658],256],64351:[[1658],256],64352:[[1658],256],64353:[[1658],256],64354:[[1663],256],64355:[[1663],256],64356:[[1663],256],64357:[[1663],256],64358:[[1657],256],64359:[[1657],256],64360:[[1657],256],64361:[[1657],256],64362:[[1700],256],64363:[[1700],256],64364:[[1700],256],64365:[[1700],256],64366:[[1702],256],64367:[[1702],256],64368:[[1702],256],64369:[[1702],256],64370:[[1668],256],64371:[[1668],256],64372:[[1668],256],64373:[[1668],256],64374:[[1667],256],64375:[[1667],256],64376:[[1667],256],64377:[[1667],256],64378:[[1670],256],64379:[[1670],256],64380:[[1670],256],64381:[[1670],256],64382:[[1671],256],64383:[[1671],256],64384:[[1671],256],64385:[[1671],256],64386:[[1677],256],64387:[[1677],256],64388:[[1676],256],64389:[[1676],256],64390:[[1678],256],64391:[[1678],256],64392:[[1672],256],64393:[[1672],256],64394:[[1688],256],64395:[[1688],256],64396:[[1681],256],64397:[[1681],256],64398:[[1705],256],64399:[[1705],256],64400:[[1705],256],64401:[[1705],256],64402:[[1711],256],64403:[[1711],256],64404:[[1711],256],64405:[[1711],256],64406:[[1715],256],64407:[[1715],256],64408:[[1715],256],64409:[[1715],256],64410:[[1713],256],64411:[[1713],256],64412:[[1713],256],64413:[[1713],256],64414:[[1722],256],64415:[[1722],256],64416:[[1723],256],64417:[[1723],256],64418:[[1723],256],64419:[[1723],256],64420:[[1728],256],64421:[[1728],256],64422:[[1729],256],64423:[[1729],256],64424:[[1729],256],64425:[[1729],256],64426:[[1726],256],64427:[[1726],256],64428:[[1726],256],64429:[[1726],256],64430:[[1746],256],64431:[[1746],256],64432:[[1747],256],64433:[[1747],256],64467:[[1709],256],64468:[[1709],256],64469:[[1709],256],64470:[[1709],256],64471:[[1735],256],64472:[[1735],256],64473:[[1734],256],64474:[[1734],256],64475:[[1736],256],64476:[[1736],256],64477:[[1655],256],64478:[[1739],256],64479:[[1739],256],64480:[[1733],256],64481:[[1733],256],64482:[[1737],256],64483:[[1737],256],64484:[[1744],256],64485:[[1744],256],64486:[[1744],256],64487:[[1744],256],64488:[[1609],256],64489:[[1609],256],64490:[[1574,1575],256],64491:[[1574,1575],256],64492:[[1574,1749],256],64493:[[1574,1749],256],64494:[[1574,1608],256],64495:[[1574,1608],256],64496:[[1574,1735],256],64497:[[1574,1735],256],64498:[[1574,1734],256],64499:[[1574,1734],256],64500:[[1574,1736],256],64501:[[1574,1736],256],64502:[[1574,1744],256],64503:[[1574,1744],256],64504:[[1574,1744],256],64505:[[1574,1609],256],64506:[[1574,1609],256],64507:[[1574,1609],256],64508:[[1740],256],64509:[[1740],256],64510:[[1740],256],64511:[[1740],256]},64512:{64512:[[1574,1580],256],64513:[[1574,1581],256],64514:[[1574,1605],256],64515:[[1574,1609],256],64516:[[1574,1610],256],64517:[[1576,1580],256],64518:[[1576,1581],256],64519:[[1576,1582],256],64520:[[1576,1605],256],64521:[[1576,1609],256],64522:[[1576,1610],256],64523:[[1578,1580],256],64524:[[1578,1581],256],64525:[[1578,1582],256],64526:[[1578,1605],256],64527:[[1578,1609],256],64528:[[1578,1610],256],64529:[[1579,1580],256],64530:[[1579,1605],256],64531:[[1579,1609],256],64532:[[1579,1610],256],64533:[[1580,1581],256],64534:[[1580,1605],256],64535:[[1581,1580],256],64536:[[1581,1605],256],64537:[[1582,1580],256],64538:[[1582,1581],256],64539:[[1582,1605],256],64540:[[1587,1580],256],64541:[[1587,1581],256],64542:[[1587,1582],256],64543:[[1587,1605],256],64544:[[1589,1581],256],64545:[[1589,1605],256],64546:[[1590,1580],256],64547:[[1590,1581],256],64548:[[1590,1582],256],64549:[[1590,1605],256],64550:[[1591,1581],256],64551:[[1591,1605],256],64552:[[1592,1605],256],64553:[[1593,1580],256],64554:[[1593,1605],256],64555:[[1594,1580],256],64556:[[1594,1605],256],64557:[[1601,1580],256],64558:[[1601,1581],256],64559:[[1601,1582],256],64560:[[1601,1605],256],64561:[[1601,1609],256],64562:[[1601,1610],256],64563:[[1602,1581],256],64564:[[1602,1605],256],64565:[[1602,1609],256],64566:[[1602,1610],256],64567:[[1603,1575],256],64568:[[1603,1580],256],64569:[[1603,1581],256],64570:[[1603,1582],256],64571:[[1603,1604],256],64572:[[1603,1605],256],64573:[[1603,1609],256],64574:[[1603,1610],256],64575:[[1604,1580],256],64576:[[1604,1581],256],64577:[[1604,1582],256],64578:[[1604,1605],256],64579:[[1604,1609],256],64580:[[1604,1610],256],64581:[[1605,1580],256],64582:[[1605,1581],256],64583:[[1605,1582],256],64584:[[1605,1605],256],64585:[[1605,1609],256],64586:[[1605,1610],256],64587:[[1606,1580],256],64588:[[1606,1581],256],64589:[[1606,1582],256],64590:[[1606,1605],256],64591:[[1606,1609],256],64592:[[1606,1610],256],64593:[[1607,1580],256],64594:[[1607,1605],256],64595:[[1607,1609],256],64596:[[1607,1610],256],64597:[[1610,1580],256],64598:[[1610,1581],256],64599:[[1610,1582],256],64600:[[1610,1605],256],64601:[[1610,1609],256],64602:[[1610,1610],256],64603:[[1584,1648],256],64604:[[1585,1648],256],64605:[[1609,1648],256],64606:[[32,1612,1617],256],64607:[[32,1613,1617],256],64608:[[32,1614,1617],256],64609:[[32,1615,1617],256],64610:[[32,1616,1617],256],64611:[[32,1617,1648],256],64612:[[1574,1585],256],64613:[[1574,1586],256],64614:[[1574,1605],256],64615:[[1574,1606],256],64616:[[1574,1609],256],64617:[[1574,1610],256],64618:[[1576,1585],256],64619:[[1576,1586],256],64620:[[1576,1605],256],64621:[[1576,1606],256],64622:[[1576,1609],256],64623:[[1576,1610],256],64624:[[1578,1585],256],64625:[[1578,1586],256],64626:[[1578,1605],256],64627:[[1578,1606],256],64628:[[1578,1609],256],64629:[[1578,1610],256],64630:[[1579,1585],256],64631:[[1579,1586],256],64632:[[1579,1605],256],64633:[[1579,1606],256],64634:[[1579,1609],256],64635:[[1579,1610],256],64636:[[1601,1609],256],64637:[[1601,1610],256],64638:[[1602,1609],256],64639:[[1602,1610],256],64640:[[1603,1575],256],64641:[[1603,1604],256],64642:[[1603,1605],256],64643:[[1603,1609],256],64644:[[1603,1610],256],64645:[[1604,1605],256],64646:[[1604,1609],256],64647:[[1604,1610],256],64648:[[1605,1575],256],64649:[[1605,1605],256],64650:[[1606,1585],256],64651:[[1606,1586],256],64652:[[1606,1605],256],64653:[[1606,1606],256],64654:[[1606,1609],256],64655:[[1606,1610],256],64656:[[1609,1648],256],64657:[[1610,1585],256],64658:[[1610,1586],256],64659:[[1610,1605],256],64660:[[1610,1606],256],64661:[[1610,1609],256],64662:[[1610,1610],256],64663:[[1574,1580],256],64664:[[1574,1581],256],64665:[[1574,1582],256],64666:[[1574,1605],256],64667:[[1574,1607],256],64668:[[1576,1580],256],64669:[[1576,1581],256],64670:[[1576,1582],256],64671:[[1576,1605],256],64672:[[1576,1607],256],64673:[[1578,1580],256],64674:[[1578,1581],256],64675:[[1578,1582],256],64676:[[1578,1605],256],64677:[[1578,1607],256],64678:[[1579,1605],256],64679:[[1580,1581],256],64680:[[1580,1605],256],64681:[[1581,1580],256],64682:[[1581,1605],256],64683:[[1582,1580],256],64684:[[1582,1605],256],64685:[[1587,1580],256],64686:[[1587,1581],256],64687:[[1587,1582],256],64688:[[1587,1605],256],64689:[[1589,1581],256],64690:[[1589,1582],256],64691:[[1589,1605],256],64692:[[1590,1580],256],64693:[[1590,1581],256],64694:[[1590,1582],256],64695:[[1590,1605],256],64696:[[1591,1581],256],64697:[[1592,1605],256],64698:[[1593,1580],256],64699:[[1593,1605],256],64700:[[1594,1580],256],64701:[[1594,1605],256],64702:[[1601,1580],256],64703:[[1601,1581],256],64704:[[1601,1582],256],64705:[[1601,1605],256],64706:[[1602,1581],256],64707:[[1602,1605],256],64708:[[1603,1580],256],64709:[[1603,1581],256],64710:[[1603,1582],256],64711:[[1603,1604],256],64712:[[1603,1605],256],64713:[[1604,1580],256],64714:[[1604,1581],256],64715:[[1604,1582],256],64716:[[1604,1605],256],64717:[[1604,1607],256],64718:[[1605,1580],256],64719:[[1605,1581],256],64720:[[1605,1582],256],64721:[[1605,1605],256],64722:[[1606,1580],256],64723:[[1606,1581],256],64724:[[1606,1582],256],64725:[[1606,1605],256],64726:[[1606,1607],256],64727:[[1607,1580],256],64728:[[1607,1605],256],64729:[[1607,1648],256],64730:[[1610,1580],256],64731:[[1610,1581],256],64732:[[1610,1582],256],64733:[[1610,1605],256],64734:[[1610,1607],256],64735:[[1574,1605],256],64736:[[1574,1607],256],64737:[[1576,1605],256],64738:[[1576,1607],256],64739:[[1578,1605],256],64740:[[1578,1607],256],64741:[[1579,1605],256],64742:[[1579,1607],256],64743:[[1587,1605],256],64744:[[1587,1607],256],64745:[[1588,1605],256],64746:[[1588,1607],256],64747:[[1603,1604],256],64748:[[1603,1605],256],64749:[[1604,1605],256],64750:[[1606,1605],256],64751:[[1606,1607],256],64752:[[1610,1605],256],64753:[[1610,1607],256],64754:[[1600,1614,1617],256],64755:[[1600,1615,1617],256],64756:[[1600,1616,1617],256],64757:[[1591,1609],256],64758:[[1591,1610],256],64759:[[1593,1609],256],64760:[[1593,1610],256],64761:[[1594,1609],256],64762:[[1594,1610],256],64763:[[1587,1609],256],64764:[[1587,1610],256],64765:[[1588,1609],256],64766:[[1588,1610],256],64767:[[1581,1609],256]},64768:{64768:[[1581,1610],256],64769:[[1580,1609],256],64770:[[1580,1610],256],64771:[[1582,1609],256],64772:[[1582,1610],256],64773:[[1589,1609],256],64774:[[1589,1610],256],64775:[[1590,1609],256],64776:[[1590,1610],256],64777:[[1588,1580],256],64778:[[1588,1581],256],64779:[[1588,1582],256],64780:[[1588,1605],256],64781:[[1588,1585],256],64782:[[1587,1585],256],64783:[[1589,1585],256],64784:[[1590,1585],256],64785:[[1591,1609],256],64786:[[1591,1610],256],64787:[[1593,1609],256],64788:[[1593,1610],256],64789:[[1594,1609],256],64790:[[1594,1610],256],64791:[[1587,1609],256],64792:[[1587,1610],256],64793:[[1588,1609],256],64794:[[1588,1610],256],64795:[[1581,1609],256],64796:[[1581,1610],256],64797:[[1580,1609],256],64798:[[1580,1610],256],64799:[[1582,1609],256],64800:[[1582,1610],256],64801:[[1589,1609],256],64802:[[1589,1610],256],64803:[[1590,1609],256],64804:[[1590,1610],256],64805:[[1588,1580],256],64806:[[1588,1581],256],64807:[[1588,1582],256],64808:[[1588,1605],256],64809:[[1588,1585],256],64810:[[1587,1585],256],64811:[[1589,1585],256],64812:[[1590,1585],256],64813:[[1588,1580],256],64814:[[1588,1581],256],64815:[[1588,1582],256],64816:[[1588,1605],256],64817:[[1587,1607],256],64818:[[1588,1607],256],64819:[[1591,1605],256],64820:[[1587,1580],256],64821:[[1587,1581],256],64822:[[1587,1582],256],64823:[[1588,1580],256],64824:[[1588,1581],256],64825:[[1588,1582],256],64826:[[1591,1605],256],64827:[[1592,1605],256],64828:[[1575,1611],256],64829:[[1575,1611],256],64848:[[1578,1580,1605],256],64849:[[1578,1581,1580],256],64850:[[1578,1581,1580],256],64851:[[1578,1581,1605],256],64852:[[1578,1582,1605],256],64853:[[1578,1605,1580],256],64854:[[1578,1605,1581],256],64855:[[1578,1605,1582],256],64856:[[1580,1605,1581],256],64857:[[1580,1605,1581],256],64858:[[1581,1605,1610],256],64859:[[1581,1605,1609],256],64860:[[1587,1581,1580],256],64861:[[1587,1580,1581],256],64862:[[1587,1580,1609],256],64863:[[1587,1605,1581],256],64864:[[1587,1605,1581],256],64865:[[1587,1605,1580],256],64866:[[1587,1605,1605],256],64867:[[1587,1605,1605],256],64868:[[1589,1581,1581],256],64869:[[1589,1581,1581],256],64870:[[1589,1605,1605],256],64871:[[1588,1581,1605],256],64872:[[1588,1581,1605],256],64873:[[1588,1580,1610],256],64874:[[1588,1605,1582],256],64875:[[1588,1605,1582],256],64876:[[1588,1605,1605],256],64877:[[1588,1605,1605],256],64878:[[1590,1581,1609],256],64879:[[1590,1582,1605],256],64880:[[1590,1582,1605],256],64881:[[1591,1605,1581],256],64882:[[1591,1605,1581],256],64883:[[1591,1605,1605],256],64884:[[1591,1605,1610],256],64885:[[1593,1580,1605],256],64886:[[1593,1605,1605],256],64887:[[1593,1605,1605],256],64888:[[1593,1605,1609],256],64889:[[1594,1605,1605],256],64890:[[1594,1605,1610],256],64891:[[1594,1605,1609],256],64892:[[1601,1582,1605],256],64893:[[1601,1582,1605],256],64894:[[1602,1605,1581],256],64895:[[1602,1605,1605],256],64896:[[1604,1581,1605],256],64897:[[1604,1581,1610],256],64898:[[1604,1581,1609],256],64899:[[1604,1580,1580],256],64900:[[1604,1580,1580],256],64901:[[1604,1582,1605],256],64902:[[1604,1582,1605],256],64903:[[1604,1605,1581],256],64904:[[1604,1605,1581],256],64905:[[1605,1581,1580],256],64906:[[1605,1581,1605],256],64907:[[1605,1581,1610],256],64908:[[1605,1580,1581],256],64909:[[1605,1580,1605],256],64910:[[1605,1582,1580],256],64911:[[1605,1582,1605],256],64914:[[1605,1580,1582],256],64915:[[1607,1605,1580],256],64916:[[1607,1605,1605],256],64917:[[1606,1581,1605],256],64918:[[1606,1581,1609],256],64919:[[1606,1580,1605],256],64920:[[1606,1580,1605],256],64921:[[1606,1580,1609],256],64922:[[1606,1605,1610],256],64923:[[1606,1605,1609],256],64924:[[1610,1605,1605],256],64925:[[1610,1605,1605],256],64926:[[1576,1582,1610],256],64927:[[1578,1580,1610],256],64928:[[1578,1580,1609],256],64929:[[1578,1582,1610],256],64930:[[1578,1582,1609],256],64931:[[1578,1605,1610],256],64932:[[1578,1605,1609],256],64933:[[1580,1605,1610],256],64934:[[1580,1581,1609],256],64935:[[1580,1605,1609],256],64936:[[1587,1582,1609],256],64937:[[1589,1581,1610],256],64938:[[1588,1581,1610],256],64939:[[1590,1581,1610],256],64940:[[1604,1580,1610],256],64941:[[1604,1605,1610],256],64942:[[1610,1581,1610],256],64943:[[1610,1580,1610],256],64944:[[1610,1605,1610],256],64945:[[1605,1605,1610],256],64946:[[1602,1605,1610],256],64947:[[1606,1581,1610],256],64948:[[1602,1605,1581],256],64949:[[1604,1581,1605],256],64950:[[1593,1605,1610],256],64951:[[1603,1605,1610],256],64952:[[1606,1580,1581],256],64953:[[1605,1582,1610],256],64954:[[1604,1580,1605],256],64955:[[1603,1605,1605],256],64956:[[1604,1580,1605],256],64957:[[1606,1580,1581],256],64958:[[1580,1581,1610],256],64959:[[1581,1580,1610],256],64960:[[1605,1580,1610],256],64961:[[1601,1605,1610],256],64962:[[1576,1581,1610],256],64963:[[1603,1605,1605],256],64964:[[1593,1580,1605],256],64965:[[1589,1605,1605],256],64966:[[1587,1582,1610],256],64967:[[1606,1580,1610],256],65008:[[1589,1604,1746],256],65009:[[1602,1604,1746],256],65010:[[1575,1604,1604,1607],256],65011:[[1575,1603,1576,1585],256],65012:[[1605,1581,1605,1583],256],65013:[[1589,1604,1593,1605],256],65014:[[1585,1587,1608,1604],256],65015:[[1593,1604,1610,1607],256],65016:[[1608,1587,1604,1605],256],65017:[[1589,1604,1609],256],65018:[[1589,1604,1609,32,1575,1604,1604,1607,32,1593,1604,1610,1607,32,1608,1587,1604,1605],256],65019:[[1580,1604,32,1580,1604,1575,1604,1607],256],65020:[[1585,1740,1575,1604],256]},65024:{65040:[[44],256],65041:[[12289],256],65042:[[12290],256],65043:[[58],256],65044:[[59],256],65045:[[33],256],65046:[[63],256],65047:[[12310],256],65048:[[12311],256],65049:[[8230],256],65056:[,230],65057:[,230],65058:[,230],65059:[,230],65060:[,230],65061:[,230],65062:[,230],65063:[,220],65064:[,220],65065:[,220],65066:[,220],65067:[,220],65068:[,220],65069:[,220],65072:[[8229],256],65073:[[8212],256],65074:[[8211],256],65075:[[95],256],65076:[[95],256],65077:[[40],256],65078:[[41],256],65079:[[123],256],65080:[[125],256],65081:[[12308],256],65082:[[12309],256],65083:[[12304],256],65084:[[12305],256],65085:[[12298],256],65086:[[12299],256],65087:[[12296],256],65088:[[12297],256],65089:[[12300],256],65090:[[12301],256],65091:[[12302],256],65092:[[12303],256],65095:[[91],256],65096:[[93],256],65097:[[8254],256],65098:[[8254],256],65099:[[8254],256],65100:[[8254],256],65101:[[95],256],65102:[[95],256],65103:[[95],256],65104:[[44],256],65105:[[12289],256],65106:[[46],256],65108:[[59],256],65109:[[58],256],65110:[[63],256],65111:[[33],256],65112:[[8212],256],65113:[[40],256],65114:[[41],256],65115:[[123],256],65116:[[125],256],65117:[[12308],256],65118:[[12309],256],65119:[[35],256],65120:[[38],256],65121:[[42],256],65122:[[43],256],65123:[[45],256],65124:[[60],256],65125:[[62],256],65126:[[61],256],65128:[[92],256],65129:[[36],256],65130:[[37],256],65131:[[64],256],65136:[[32,1611],256],65137:[[1600,1611],256],65138:[[32,1612],256],65140:[[32,1613],256],65142:[[32,1614],256],65143:[[1600,1614],256],65144:[[32,1615],256],65145:[[1600,1615],256],65146:[[32,1616],256],65147:[[1600,1616],256],65148:[[32,1617],256],65149:[[1600,1617],256],65150:[[32,1618],256],65151:[[1600,1618],256],65152:[[1569],256],65153:[[1570],256],65154:[[1570],256],65155:[[1571],256],65156:[[1571],256],65157:[[1572],256],65158:[[1572],256],65159:[[1573],256],65160:[[1573],256],65161:[[1574],256],65162:[[1574],256],65163:[[1574],256],65164:[[1574],256],65165:[[1575],256],65166:[[1575],256],65167:[[1576],256],65168:[[1576],256],65169:[[1576],256],65170:[[1576],256],65171:[[1577],256],65172:[[1577],256],65173:[[1578],256],65174:[[1578],256],65175:[[1578],256],65176:[[1578],256],65177:[[1579],256],65178:[[1579],256],65179:[[1579],256],65180:[[1579],256],65181:[[1580],256],65182:[[1580],256],65183:[[1580],256],65184:[[1580],256],65185:[[1581],256],65186:[[1581],256],65187:[[1581],256],65188:[[1581],256],65189:[[1582],256],65190:[[1582],256],65191:[[1582],256],65192:[[1582],256],65193:[[1583],256],65194:[[1583],256],65195:[[1584],256],65196:[[1584],256],65197:[[1585],256],65198:[[1585],256],65199:[[1586],256],65200:[[1586],256],65201:[[1587],256],65202:[[1587],256],65203:[[1587],256],65204:[[1587],256],65205:[[1588],256],65206:[[1588],256],65207:[[1588],256],65208:[[1588],256],65209:[[1589],256],65210:[[1589],256],65211:[[1589],256],65212:[[1589],256],65213:[[1590],256],65214:[[1590],256],65215:[[1590],256],65216:[[1590],256],65217:[[1591],256],65218:[[1591],256],65219:[[1591],256],65220:[[1591],256],65221:[[1592],256],65222:[[1592],256],65223:[[1592],256],65224:[[1592],256],65225:[[1593],256],65226:[[1593],256],65227:[[1593],256],65228:[[1593],256],65229:[[1594],256],65230:[[1594],256],65231:[[1594],256],65232:[[1594],256],65233:[[1601],256],65234:[[1601],256],65235:[[1601],256],65236:[[1601],256],65237:[[1602],256],65238:[[1602],256],65239:[[1602],256],65240:[[1602],256],65241:[[1603],256],65242:[[1603],256],65243:[[1603],256],65244:[[1603],256],65245:[[1604],256],65246:[[1604],256],65247:[[1604],256],65248:[[1604],256],65249:[[1605],256],65250:[[1605],256],65251:[[1605],256],65252:[[1605],256],65253:[[1606],256],65254:[[1606],256],65255:[[1606],256],65256:[[1606],256],65257:[[1607],256],65258:[[1607],256],65259:[[1607],256],65260:[[1607],256],65261:[[1608],256],65262:[[1608],256],65263:[[1609],256],65264:[[1609],256],65265:[[1610],256],65266:[[1610],256],65267:[[1610],256],65268:[[1610],256],65269:[[1604,1570],256],65270:[[1604,1570],256],65271:[[1604,1571],256],65272:[[1604,1571],256],65273:[[1604,1573],256],65274:[[1604,1573],256],65275:[[1604,1575],256],65276:[[1604,1575],256]},65280:{65281:[[33],256],65282:[[34],256],65283:[[35],256],65284:[[36],256],65285:[[37],256],65286:[[38],256],65287:[[39],256],65288:[[40],256],65289:[[41],256],65290:[[42],256],65291:[[43],256],65292:[[44],256],65293:[[45],256],65294:[[46],256],65295:[[47],256],65296:[[48],256],65297:[[49],256],65298:[[50],256],65299:[[51],256],65300:[[52],256],65301:[[53],256],65302:[[54],256],65303:[[55],256],65304:[[56],256],65305:[[57],256],65306:[[58],256],65307:[[59],256],65308:[[60],256],65309:[[61],256],65310:[[62],256],65311:[[63],256],65312:[[64],256],65313:[[65],256],65314:[[66],256],65315:[[67],256],65316:[[68],256],65317:[[69],256],65318:[[70],256],65319:[[71],256],65320:[[72],256],65321:[[73],256],65322:[[74],256],65323:[[75],256],65324:[[76],256],65325:[[77],256],65326:[[78],256],65327:[[79],256],65328:[[80],256],65329:[[81],256],65330:[[82],256],65331:[[83],256],65332:[[84],256],65333:[[85],256],65334:[[86],256],65335:[[87],256],65336:[[88],256],65337:[[89],256],65338:[[90],256],65339:[[91],256],65340:[[92],256],65341:[[93],256],65342:[[94],256],65343:[[95],256],65344:[[96],256],65345:[[97],256],65346:[[98],256],65347:[[99],256],65348:[[100],256],65349:[[101],256],65350:[[102],256],65351:[[103],256],65352:[[104],256],65353:[[105],256],65354:[[106],256],65355:[[107],256],65356:[[108],256],65357:[[109],256],65358:[[110],256],65359:[[111],256],65360:[[112],256],65361:[[113],256],65362:[[114],256],65363:[[115],256],65364:[[116],256],65365:[[117],256],65366:[[118],256],65367:[[119],256],65368:[[120],256],65369:[[121],256],65370:[[122],256],65371:[[123],256],65372:[[124],256],65373:[[125],256],65374:[[126],256],65375:[[10629],256],65376:[[10630],256],65377:[[12290],256],65378:[[12300],256],65379:[[12301],256],65380:[[12289],256],65381:[[12539],256],65382:[[12530],256],65383:[[12449],256],65384:[[12451],256],65385:[[12453],256],65386:[[12455],256],65387:[[12457],256],65388:[[12515],256],65389:[[12517],256],65390:[[12519],256],65391:[[12483],256],65392:[[12540],256],65393:[[12450],256],65394:[[12452],256],65395:[[12454],256],65396:[[12456],256],65397:[[12458],256],65398:[[12459],256],65399:[[12461],256],65400:[[12463],256],65401:[[12465],256],65402:[[12467],256],65403:[[12469],256],65404:[[12471],256],65405:[[12473],256],65406:[[12475],256],65407:[[12477],256],65408:[[12479],256],65409:[[12481],256],65410:[[12484],256],65411:[[12486],256],65412:[[12488],256],65413:[[12490],256],65414:[[12491],256],65415:[[12492],256],65416:[[12493],256],65417:[[12494],256],65418:[[12495],256],65419:[[12498],256],65420:[[12501],256],65421:[[12504],256],65422:[[12507],256],65423:[[12510],256],65424:[[12511],256],65425:[[12512],256],65426:[[12513],256],65427:[[12514],256],65428:[[12516],256],65429:[[12518],256],65430:[[12520],256],65431:[[12521],256],65432:[[12522],256],65433:[[12523],256],65434:[[12524],256],65435:[[12525],256],65436:[[12527],256],65437:[[12531],256],65438:[[12441],256],65439:[[12442],256],65440:[[12644],256],65441:[[12593],256],65442:[[12594],256],65443:[[12595],256],65444:[[12596],256],65445:[[12597],256],65446:[[12598],256],65447:[[12599],256],65448:[[12600],256],65449:[[12601],256],65450:[[12602],256],65451:[[12603],256],65452:[[12604],256],65453:[[12605],256],65454:[[12606],256],65455:[[12607],256],65456:[[12608],256],65457:[[12609],256],65458:[[12610],256],65459:[[12611],256],65460:[[12612],256],65461:[[12613],256],65462:[[12614],256],65463:[[12615],256],65464:[[12616],256],65465:[[12617],256],65466:[[12618],256],65467:[[12619],256],65468:[[12620],256],65469:[[12621],256],65470:[[12622],256],65474:[[12623],256],65475:[[12624],256],65476:[[12625],256],65477:[[12626],256],65478:[[12627],256],65479:[[12628],256],65482:[[12629],256],65483:[[12630],256],65484:[[12631],256],65485:[[12632],256],65486:[[12633],256],65487:[[12634],256],65490:[[12635],256],65491:[[12636],256],65492:[[12637],256],65493:[[12638],256],65494:[[12639],256],65495:[[12640],256],65498:[[12641],256],65499:[[12642],256],65500:[[12643],256],65504:[[162],256],65505:[[163],256],65506:[[172],256],65507:[[175],256],65508:[[166],256],65509:[[165],256],65510:[[8361],256],65512:[[9474],256],65513:[[8592],256],65514:[[8593],256],65515:[[8594],256],65516:[[8595],256],65517:[[9632],256],65518:[[9675],256]}};var h={nfc:function(e){return t("NFC",e)},nfd:function(e){return t("NFD",e)},nfkc:function(e){return t("NFKC",e)},nfkd:function(e){return t("NFKD",e)}};(f.exports=h).shimApplied=!1,String.prototype.normalize||(Object.defineProperty(String.prototype,"normalize",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=""+this,t=void 0===arguments[0]?"NFC":arguments[0];if(null==this)throw new TypeError("Cannot call method on "+Object.prototype.toString.call(this));if("NFC"===t)return h.nfc(e);if("NFD"===t)return h.nfd(e);if("NFKC"===t)return h.nfkc(e);if("NFKD"===t)return h.nfkd(e);throw new RangeError("Invalid normalization form: "+t)}}),h.shimApplied=!0)}()},(e,t,n)=>{"use strict";n.r(t),n.d(t,{collatorFromConfig:()=>function(e){var t=e.caseSensitive?e.accentSensitive?"variant":"case":e.accentSensitive?"accent":"base",n=e.caseFirst,r=e.ignorePunctuation;return new Intl.Collator(e.localeLang,{sensitivity:t,caseFirst:n,ignorePunctuation:r})}})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{DetailedCellError:()=>r});class r{constructor(e,t,n){this.value=t,this.address=n,this.type=e.type,this.message=null!=(t=e.message)?t:""}toString(){return this.value}valueOf(){return this.value}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Config:()=>z,getDefaultConfig:()=>function(){return s({})}});var U=n(100),t=n(101),V=n(102),r=n(103),i=n(77),o=n(104),W=n(106),$=n(108);const j=new WeakMap;class z{constructor(e={},t=!0){var{accentSensitive:n,binarySearchThreshold:r,caseSensitive:i,caseFirst:o,chooseAddressMappingPolicy:s,currencySymbol:a,dateFormats:l,decimalSeparator:u,evaluateNullToZero:c,functionArgSeparator:d,functionPlugins:h,ignorePunctuation:f,leapYear1900:p,localeLang:g,language:m,ignoreWhiteSpace:y,licenseKey:v,matchWholeCell:b,arrayColumnSeparator:E,arrayRowSeparator:C,maxRows:w,maxColumns:S,nullYear:T,nullDate:R,parseDateTime:A,precisionEpsilon:_,precisionRounding:N,stringifyDateTime:x,stringifyDuration:O,smartRounding:I,timeFormats:M,thousandSeparator:k,useArrayArithmetic:D,useStats:L,undoLimit:P,useColumnIndex:F,useRegularExpressions:B,useWildcards:H}=e;t&&z.warnDeprecatedOptions(e),this.useArrayArithmetic=(0,U.configValueFromParam)(D,"boolean","useArrayArithmetic"),this.accentSensitive=(0,U.configValueFromParam)(n,"boolean","accentSensitive"),this.caseSensitive=(0,U.configValueFromParam)(i,"boolean","caseSensitive"),this.caseFirst=(0,U.configValueFromParam)(o,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=(0,U.configValueFromParam)(f,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=null!=s?s:z.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...(0,U.configValueFromParamCheck)(l,Array.isArray,"array","dateFormats")],this.timeFormats=[...(0,U.configValueFromParamCheck)(M,Array.isArray,"array","timeFormats")],this.functionArgSeparator=(0,U.configValueFromParam)(d,"string","functionArgSeparator"),this.decimalSeparator=(0,U.configValueFromParam)(u,[".",","],"decimalSeparator"),this.language=(0,U.configValueFromParam)(m,"string","language"),this.ignoreWhiteSpace=(0,U.configValueFromParam)(y,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=(0,U.configValueFromParam)(v,"string","licenseKey"),this.thousandSeparator=(0,U.configValueFromParam)(k,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=(0,U.configValueFromParam)(E,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=(0,U.configValueFromParam)(C,[";","|"],"arrayRowSeparator"),this.localeLang=(0,U.configValueFromParam)(g,"string","localeLang"),this.functionPlugins=[...null!=h?h:z.defaultConfig.functionPlugins],this.smartRounding=(0,U.configValueFromParam)(I,"boolean","smartRounding"),this.evaluateNullToZero=(0,U.configValueFromParam)(c,"boolean","evaluateNullToZero"),this.nullYear=(0,U.configValueFromParam)(T,"number","nullYear"),(0,U.validateNumberToBeAtLeast)(this.nullYear,"nullYear",0),(0,U.validateNumberToBeAtMost)(this.nullYear,"nullYear",100),this.precisionRounding=(0,U.configValueFromParam)(N,"number","precisionRounding"),(0,U.validateNumberToBeAtLeast)(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=(0,U.configValueFromParam)(_,"number","precisionEpsilon"),(0,U.validateNumberToBeAtLeast)(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=(0,U.configValueFromParam)(F,"boolean","useColumnIndex"),this.useStats=(0,U.configValueFromParam)(L,"boolean","useStats"),this.binarySearchThreshold=null!=r?r:z.defaultConfig.binarySearchThreshold,this.parseDateTime=(0,U.configValueFromParam)(A,"function","parseDateTime"),this.stringifyDateTime=(0,U.configValueFromParam)(x,"function","stringifyDateTime"),this.stringifyDuration=(0,U.configValueFromParam)(O,"function","stringifyDuration"),this.translationPackage=$.HyperFormula.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=(0,U.configValueFromParamCheck)(R,V.instanceOfSimpleDate,"IDate","nullDate"),this.leapYear1900=(0,U.configValueFromParam)(p,"boolean","leapYear1900"),this.undoLimit=(0,U.configValueFromParam)(P,"number","undoLimit"),this.useRegularExpressions=(0,U.configValueFromParam)(B,"boolean","useRegularExpressions"),this.useWildcards=(0,U.configValueFromParam)(H,"boolean","useWildcards"),this.matchWholeCell=(0,U.configValueFromParam)(b,"boolean","matchWholeCell"),(0,U.validateNumberToBeAtLeast)(this.undoLimit,"undoLimit",0),this.maxRows=(0,U.configValueFromParam)(w,"number","maxRows"),(0,U.validateNumberToBeAtLeast)(this.maxRows,"maxRows",1),this.maxColumns=(0,U.configValueFromParam)(S,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(a),(0,U.validateNumberToBeAtLeast)(this.maxColumns,"maxColumns",1),j.set(this,{licenseKeyValidityState:(0,W.checkLicenseKeyValidity)(this.licenseKey)}),(0,U.configCheckIfParametersNotInConflict)({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),(0,U.configCheckIfParametersNotInConflict)({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){e=[...(0,U.configValueFromParamCheck)(e,Array.isArray,"array","currencySymbol")];return e.forEach(e=>{if("string"!=typeof e)throw new i.ExpectedValueOfTypeError("string[]","currencySymbol");if(""===e)throw new i.ConfigValueEmpty("currencySymbol")}),e}get licenseKeyValidityState(){return j.get(this).licenseKeyValidityState}getConfig(){return s(this)}mergeConfig(e){var t=Object.assign({},this.getConfig(),e);return z.warnDeprecatedOptions(e),new z(t,!1)}static warnDeprecatedOptions(e){z.warnDeprecatedIfUsed(e.binarySearchThreshold,"binarySearchThreshold","1.1")}static warnDeprecatedIfUsed(e,t,n,r){void 0!==e&&(void 0===r?console.warn(t+" option is deprecated since "+n):console.warn(t+` option is deprecated since ${n}, please use `+r))}}function s(e){var t={};for(const r in z.defaultConfig){var n=null!=(n=e[r])?n:z.defaultConfig[r];Array.isArray(n)?t[r]=[...n]:t[r]=n}return t}z.defaultConfig={accentSensitive:!1,binarySearchThreshold:20,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",chooseAddressMappingPolicy:new r.AlwaysDense,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:t.defaultParseToDateTime,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,stringifyDateTime:o.defaultStringifyDateTime,stringifyDuration:o.defaultStringifyDuration,timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{configCheckIfParametersNotInConflict:()=>function(...e){const n=new Map,t=(e.forEach(e=>{var t=n.get(e.value)||[];t.push(e.name),n.set(e.value,t)}),[]);for(const r of n.values())1<r.length&&t.push(r);if(0<t.length)throw t.forEach(e=>e.sort()),e=t.map(e=>`[${e}]`).join("; "),new Error("Config initialization failed. Parameters in conflict: "+e)},configValueFromParam:()=>function(e,t,n){{if(void 0===e)return i.Config.defaultConfig[n];if("string"==typeof t){if(typeof e===t)return e;throw new o.ExpectedValueOfTypeError(t,n)}if(t.includes(e))return e;throw new o.ExpectedOneOfValuesError(t.map(e=>`'${e}'`).join(" "),n)}},configValueFromParamCheck:()=>function(e,t,n,r){{if(t(e))return e;if(void 0===e)return i.Config.defaultConfig[r];throw new o.ExpectedValueOfTypeError(n,r)}},validateArgToType:()=>function(e,t,n){if(typeof e!==t)throw new o.ExpectedValueOfTypeError(t,n)},validateNumberToBeAtLeast:()=>function(e,t,n){if(e<n)throw new o.ConfigValueTooSmallError(t,n)},validateNumberToBeAtMost:()=>function(e,t,n){if(n<e)throw new o.ConfigValueTooBigError(t,n)}});var i=n(99),o=n(77)},(e,t,n)=>{"use strict";n.r(t),n.d(t,{defaultParseToDateTime:()=>function(e,t,n){let r=(e=e.replace(/\s\s+/g," ").trim().toLowerCase()).substring(e.length-2);"am"===r||"pm"===r?e=e.substring(0,e.length-2).trim():"a"===(r=e.substring(e.length-1))||"p"===r?e=e.substring(0,e.length-1).trim():r=void 0;e=e.split(/[ /.-]/g);2<=e.length&&e[e.length-2].includes(":")&&(e[e.length-2]=e[e.length-2]+"."+e[e.length-1],e.pop());var i=e[e.length-1].split(":");void 0!==r&&i.push(r);if(1===e.length)return o(i,n);if(1===i.length)return a(e,t);e=a(e.slice(0,e.length-1),t),t=o(i,n);if(void 0!==e&&void 0!==t)return Object.assign(Object.assign({},e),t)},secondsExtendedRegexp:()=>s});const s=/^ss(\.(s+|0+))?$/;function o(n,r){if(void 0!==r){(r=r.toLowerCase()).endsWith("am/pm")?r=r.substring(0,r.length-5).trim():r.endsWith("a/p")&&(r=r.substring(0,r.length-3).trim());r=r.split(":");let t=void 0;if("am"===n[n.length-1]||"a"===n[n.length-1]?(t=!1,n.pop()):"pm"!==n[n.length-1]&&"p"!==n[n.length-1]||(t=!0,n.pop()),n.length===r.length){var i=r.indexOf("hh"),o=r.indexOf("mm"),r=r.findIndex(e=>s.test(e)),i=-1!==i?n[i]:"0";if(/^\d+$/.test(i)){let e=Number(i);if(void 0!==t){if(e<0||12<e)return;e%=12,t&&(e+=12)}i=-1!==o?n[o]:"0";if(/^\d+$/.test(i)){o=Number(i),i=-1!==r?n[r]:"0";if(/^\d+(\.\d+)?$/.test(i))return n=Math.round(1e3*Number(i))/1e3,{hours:e,minutes:o,seconds:n}}}}}}function a(t,n){if(void 0!==n){n=n.toLowerCase().split(/[ /.-]/g);if(t.length===n.length){var r=n.indexOf("mm"),i=n.indexOf("dd"),o=n.indexOf("yyyy"),n=n.indexOf("yy");if(r in t&&i in t&&(o in t||n in t)&&!(o in t&&n in t)){let e;if(o in t){o=t[o];if(!/^\d+$/.test(o))return;if((e=Number(o))<1e3||9999<e)return}else{o=t[n];if(!/^\d+$/.test(o))return;if((e=Number(o))<0||99<e)return}n=t[r];if(/^\d+$/.test(n)){o=Number(n),r=t[i];if(/^\d+$/.test(r))return n=Number(r),{year:e,month:o,day:n}}}}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{DateTimeHelper:()=>h,instanceOfSimpleDate:()=>u,instanceOfSimpleTime:()=>c,maxDate:()=>d,numberToSimpleTime:()=>f,offsetMonth:()=>function(e,t){t=12*e.year+e.month-1+t;return{year:Math.floor(t/12),month:t%12+1,day:e.day}},roundToNearestSecond:()=>function(e){return Math.round(3600*e*24)/86400},timeToNumber:()=>p,toBasisEU:()=>function(e){return{year:e.year,month:e.month,day:Math.min(30,e.day)}},truncateDayInMonth:()=>function(e){return{year:e.year,month:e.month,day:Math.min(e.day,i[e.month-1])}}});var r=n(70);const i=[31,28,31,30,31,30,31,31,30,31,30,31],o=[0,31,59,90,120,151,181,212,243,273,304,334],s=60,a=60,l=24;function u(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"year"in e&&"number"==typeof e.year&&"month"in e&&"number"==typeof e.month&&"day"in e&&"number"==typeof e.day}function c(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"hours"in e&&"number"==typeof e.hours&&"minutes"in e&&"number"==typeof e.minutes&&"seconds"in e&&"number"==typeof e.seconds}const d={year:9999,month:12,day:31};class h{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(d),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&0<=e?e:void 0}dateStringToDateNumber(e){var{dateTime:e,dateFormat:t="",timeFormat:n=""}=this.parseDateTimeFromConfigFormats(e);if(void 0!==e)return c(e)?u(e)?new r.DateTimeNumber(p(e)+this.dateToNumber(e),t+" "+n):new r.TimeNumber(p(e),n):u(e)?new r.DateNumber(this.dateToNumber(e),t):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return!(isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||12<e.month||e.day<1||!(this.isLeapYear(e.year)&&2===e.month?e.day<=29:e.day<=i[e.month-1]))}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-(this.leapYear1900?1:0)}numberToSimpleDate(e){e=Math.floor(e)+this.minDateAbsoluteValue;let t=Math.floor(e/365.2425);this.dateToNumberFromZero({year:t+1,month:1,day:1})<=e?t++:this.dateToNumberFromZero({year:t-1,month:1,day:1})>e&&t--;var e=e-this.dateToNumberFromZero({year:t,month:1,day:1}),n=function(e){let t=0;o[t+6]<=e&&(t+=6);o[t+3]<=e&&(t+=3);o[t+2]<=e?t+=2:o[t+1]<=e&&(t+=1);return t}(e-(this.isLeapYear(t)&&59<=e?1:0)),e=e-o[n]-(this.isLeapYear(t)&&1<n?1:0);return{year:t,month:n+1,day:1+e}}numberToSimpleDateTime(e){var t=f(e%1),n=Math.floor(t.hours/l),e=(t.hours=t.hours%l,this.numberToSimpleDate(Math.floor(e)+n));return Object.assign(Object.assign({},e),t)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&1900<=e?1:0)}daysInMonth(e,t){return this.isLeapYear(e)&&2===t?29:i[t-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,t){return 31===e.day&&(e.day=30),30===e.day&&31===t.day&&(t.day=30),2===e.month&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,2===t.month)&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30),[e,t]}yearLengthForBasis(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,t,n){e=this.parseDateTime(e,t,n);if(!u(e)||(0<=e.year&&e.year<100&&(e.year<this.getNullYear()?e.year+=2e3:e.year+=1900),this.isValidDate(e)))return e}parseDateTimeFromFormats(e,t,n){var t=0===t.length?[void 0]:t,r=0===n.length?[void 0]:n;for(const o of t)for(const s of r){var i=this.parseSingleFormat(e,o,s);if(void 0!==i)return{dateTime:i,timeFormat:s,dateFormat:o}}return{}}countLeapDays(e){return 2<e.month||2===e.month&&29<=e.day?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+o[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return!(e%4)&&(!(!(e%100)&&e%400)||1900===e&&this.config.leapYear1900)}}function f(e){var e=e*l*a*s,t=(t=e%s,n=1e5,Math.round(t*n)/n%s),n=(e-t)/s,e=Math.round(n%a)%a,n=(n-e)/a;return{hours:Math.round(n),minutes:e,seconds:t}}function p(e){return((e.seconds/60+e.minutes)/60+e.hours)/24}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{AlwaysDense:()=>a,AlwaysSparse:()=>s,DenseSparseChooseBasedOnThreshold:()=>o});var r=n(92),i=n(91);class o{constructor(e){this.threshold=e}call(e){return e>this.threshold?r.DenseStrategy:i.SparseStrategy}}class s{call(){return i.SparseStrategy}}class a{call(){return r.DenseStrategy}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{defaultStringifyDateTime:()=>function(t,e){e=(0,d.parseForDateTimeFormat)(e);if(void 0===e)return;var n=e.tokens;let r="",i=!1;var o=n.some(e=>e.type===d.TokenType.FORMAT&&("a/p"===e.value||"A/P"===e.value||"am/pm"===e.value||"AM/PM"===e.value));for(let e=0;e<n.length;e++){var s=n[e];if(s.type===d.TokenType.FREE_TEXT)r+=s.value;else switch(s.value.toLowerCase()){case"h":case"hh":i=!0,r+=h(o?(t.hours+11)%12+1:t.hours,s.value.length);break;case"d":case"dd":r+=h(t.day,s.value.length);break;case"s":case"ss":r+=h(Math.floor(t.seconds),s.value.length);break;case"m":case"mm":(i=e+1<n.length&&n[e+1].value.startsWith(":")?!0:i)?r+=h(t.minutes,s.value.length):r+=h(t.month,s.value.length),i=!0;break;case"yy":r+=h(t.year%100,s.value.length);break;case"yyyy":r+=t.year;break;case"am/pm":case"a/p":var[a,l]=s.value.split("/");r+=t.hours<12?a:l;break;default:if(!u.secondsExtendedRegexp.test(s.value))return;a=s.value.length-3;r+=(t.seconds<10?"0":"")+Math.floor(t.seconds*Math.pow(10,a))/Math.pow(10,a)}}return r},defaultStringifyDuration:()=>function(e,t){t=(0,d.parseForDateTimeFormat)(t);if(void 0===t)return;t=t.tokens;let n="";for(const i of t)if(i.type===d.TokenType.FREE_TEXT)n+=i.value;else switch(i.value.toLowerCase()){case"h":case"hh":n+=h(e.hours,i.value.length),e.hours=0;break;case"[hh]":n+=h(e.hours,i.value.length-2),e.hours=0;break;case"m":case"mm":n+=h(e.minutes,i.value.length),e.minutes=0;break;case"[mm]":n+=h(e.minutes+60*e.hours,i.value.length-2),e.minutes=0,e.hours=0;break;case"s":case"ss":n+=h(Math.floor(e.seconds),i.value.length);break;default:if(!u.secondsExtendedRegexp.test(i.value))return;var r=Math.max(i.value.length-3,0);n+=(e.seconds<10?"0":"")+Math.floor(e.seconds*Math.pow(10,r))/Math.pow(10,r)}return n},format:()=>function(e,t,n,r){r=n.stringifyDateTime(r.numberToSimpleDateTime(e),t);if(void 0!==r)return r;r=n.stringifyDuration((0,c.numberToSimpleTime)(e),t);if(void 0!==r)return r;n=(0,d.parseForNumberFormat)(t);if(void 0===n)return t;{var i=n.tokens,o=e;let t="";for(let e=0;e<i.length;++e){var s=i[e];if(s.type===d.TokenType.FREE_TEXT)t+=s.value;else{var s=s.value.split("."),a=s[0],l=s[1]||"",s=s[1]?".":"",u=Number(o.toFixed(l.length)).toString().split(".");let e=u[0]||"";u=u[1]||"",a=(a.length>e.length&&(a=p(a.substr(0,a.length-e.length),"0"),e=h(e,a+e.length)),p(l.substr(u.length,l.length-u.length),"0"));u=f(u,a+u.length),t+=e+s+u}}return t}},padLeft:()=>h,padRight:()=>f});var u=n(101),c=n(102),d=n(105);function h(e,t){let n=""+e;for(;n.length<t;)n="0"+n;return n}function f(e,t){let n=""+e;for(;n.length<t;)n+="0";return n}function p(e,t){return e.split(t).length-1}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{FormatExpressionType:()=>o,TokenType:()=>a,formatToken:()=>l,isEscapeToken:()=>d,parse:()=>function(e){var t;return null!=(t=null!=(t=u(e))?t:c(e))?t:{type:o.STRING,tokens:[{type:a.FREE_TEXT,value:e}]}},parseForDateTimeFormat:()=>u,parseForNumberFormat:()=>c});const r=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,i=/(\\.|[#0]+(\.[#0]*)?)/g;var a,o;function l(e,t){return{type:e,value:t}}function s(t,n){var r=[];let i=0;for(let e=0;e<t.length;++e){var o,s=t[e];s.index!==i&&(o=n.substr(i,s.index-i),r.push(l(a.FREE_TEXT,o))),s[0].startsWith("\\")?r.push(l(a.FREE_TEXT,s[0])):r.push(l(a.FORMAT,s[0])),i=s.index+s[0].length}var e=t[t.length-1];return e.index+e[0].length<n.length&&(e=n.substr(e.index+e[0].length,n.length),r.push(l(a.FREE_TEXT,e))),r}function u(e){var t=function(e){r.lastIndex=0;for(var t,n=[];null!==(t=r.exec(e))&&n.push(t),t;);return n}(e);if(!t.every(e=>d(e)))return{type:o.DATE,tokens:s(t,e)}}function c(e){t=e,i.lastIndex=0;var t=null!==(t=i.exec(t))?[t]:[];if(!t.every(e=>d(e)))return{type:o.NUMBER,tokens:s(t,e)}}function d(e){return e[0].startsWith("\\")}(n=a=a||{}).FORMAT="FORMAT",n.FREE_TEXT="FREE_TEXT",(t=o=o||{}).DATE="DATE",t.NUMBER="NUMBER",t.STRING="STRING"},(e,t,n)=>{"use strict";n.r(t),n.d(t,{checkLicenseKeyValidity:()=>function(e){var t={template:"missing",vars:{}};{var n,r,i;"gpl-v3"===e||"internal-use-in-handsontable"===e?t.template="valid":"string"==typeof e&&(0,o.checkKeySchema)(e)?([i,r,n]="29/05/2023".split("/"),r=Math.floor(new Date(r+`/${i}/`+n).getTime()/864e5),i=(0,o.extractTime)(e),t.vars.keyValidityDate=function(e){var t=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()],n=e.getDate(),e=e.getFullYear();return t+` ${n}, `+e}(new Date(864e5*(i+1))),t.template=i<r?"expired":"valid"):""!==e&&(t.template="invalid")}a||"valid"===t.template||(console.warn(s[t.template](t.vars)),a=!0);return t.template}});var o=n(107);const s={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:e})=>"The license key for HyperFormula expired"+` on ${e}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."};let a=!1},(e,t,n)=>{"use strict";n.r(t),n.d(t,{checkKeySchema:()=>function(i){if((i=(i+"").replace(/\-/g,""))[r]!==u("Z"))return!1;let o=0;return[[0,u("G")+1],[u("H"),u("H")-1],[u("G")+u("H"),u("G")]].reduce((e,[t,n],r)=>(e|=(a(""+a(s(l(i,o+t-(0===r?0:2),n+(r?2:0)))+(s(l(i,o+t+n,2))+[]).padStart(2,"0")))%97||2)>>1,o+=2,e),u("A"))===[]+1>>1},extractTime:()=>function(e){return 25===i(e)[r]?s(l(i(e),s("12"),u("F")))/(s(l(i(e),u("C"),u("Y")>>4))||1+(~~![][r]<<3)):0}});const r="length",s=e=>parseInt(e,16),a=e=>parseInt(e,10),i=e=>(e+"").replace(/\-/g,""),l=(e,t,n)=>e.substr(t,n),u=e=>e.codePointAt(0)-65},(e,t,n)=>{"use strict";n.r(t),n.d(t,{HyperFormula:()=>y});var a=n(2),i=n(100),r=n(109),o=n(3),s=n(110),l=n(99),u=n(102),c=n(141),p=n(142),d=n(77),h=n(86),f=n(128),g=n(114),m=n(7);class y{constructor(e,t,n,r,i,o,s,a,l,u,c,d,h,f){this._config=e,this._stats=t,this._dependencyGraph=n,this._columnSearch=r,this._parser=i,this._unparser=o,this._cellContentParser=s,this._evaluator=a,this._lazilyTransformingAstService=l,this._crudOperations=u,this._exporter=c,this._namedExpressions=d,this._serialization=h,this._functionRegistry=f,this._emitter=new p.Emitter,this._evaluationSuspended=!1}static get defaultConfig(){return(0,l.getDefaultConfig)()}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,t={},n=[]){return this.buildFromEngineState(r.BuildEngineFactory.buildFromSheet(e,t,n))}static buildFromSheets(e,t={},n=[]){return this.buildFromEngineState(r.BuildEngineFactory.buildFromSheets(e,t,n))}static buildEmpty(e={},t=[]){return this.buildFromEngineState(r.BuildEngineFactory.buildEmpty(e,t))}static getLanguage(e){(0,i.validateArgToType)(e,"string","languageCode");e=this.registeredLanguages.get(e);if(void 0===e)throw new d.LanguageNotRegisteredError;return e}static registerLanguage(e,t){if((0,i.validateArgToType)(e,"string","languageCode"),this.registeredLanguages.has(e))throw new d.LanguageAlreadyRegisteredError;this.registeredLanguages.set(e,(0,h.buildTranslationPackage)(t))}static unregisterLanguage(e){if((0,i.validateArgToType)(e,"string","languageCode"),!this.registeredLanguages.has(e))throw new d.LanguageNotRegisteredError;this.registeredLanguages.delete(e)}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,t){f.FunctionRegistry.registerFunctionPlugin(e,t)}static unregisterFunctionPlugin(e){f.FunctionRegistry.unregisterFunctionPlugin(e)}static registerFunction(e,t,n){(0,i.validateArgToType)(e,"string","functionId"),f.FunctionRegistry.registerFunction(e,t,n)}static unregisterFunction(e){(0,i.validateArgToType)(e,"string","functionId"),f.FunctionRegistry.unregisterFunction(e)}static unregisterAllFunctions(){f.FunctionRegistry.unregisterAll()}static getRegisteredFunctionNames(e){(0,i.validateArgToType)(e,"string","code");var t=f.FunctionRegistry.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}static getFunctionPlugin(e){return(0,i.validateArgToType)(e,"string","functionId"),f.FunctionRegistry.getFunctionPlugin(e)}static getAllFunctionPlugins(){return f.FunctionRegistry.getPlugins()}static buildFromEngineState(e){return new y(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if((0,o.isSimpleCellAddress)(e))return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e);throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress")}getCellFormula(e){if((0,o.isSimpleCellAddress)(e))return this._serialization.getCellFormula(e);throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress")}getCellHyperlink(e){if((0,o.isSimpleCellAddress)(e))return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellHyperlink(e);throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress")}getCellSerialized(e){if((0,o.isSimpleCellAddress)(e))return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e);throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress")}getSheetValues(e){return(0,i.validateArgToType)(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return(0,i.validateArgToType)(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return(0,i.validateArgToType)(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter(e=>this.getSheetDimensions(e))}getSheetDimensions(e){return(0,i.validateArgToType)(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){Object.entries(e).every(([e,t])=>this._config[e]===t)||this.rebuildWithConfig(e)}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.rebuildWithConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let t;if((0,o.isSimpleCellAddress)(e))t=new a.AbsoluteCellRange(e,e);else{if(!(0,a.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress | SimpleCellRange","address");t=new a.AbsoluteCellRange(e.start,e.end)}try{this._crudOperations.ensureRangeInSizeLimits(t);for(const n of t.addresses(this._dependencyGraph))this._crudOperations.ensureItIsPossibleToChangeContent(n)}catch(e){return!1}return!0}setCellContents(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,t){(0,i.validateArgToType)(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForArrays(e,t),!0}catch(e){return!1}}setRowOrder(e,t){(0,i.validateArgToType)(e,"number","sheetId");t=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,t)}isItPossibleToSetRowOrder(e,t){(0,i.validateArgToType)(e,"number","sheetId");try{var n=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,n),this._crudOperations.testRowOrderForArrays(e,n),!0}catch(e){return!1}}swapColumnIndexes(e,t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,t){(0,i.validateArgToType)(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForArrays(e,t),!0}catch(e){return!1}}setColumnOrder(e,t){(0,i.validateArgToType)(e,"number","sheetId");t=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,t)}isItPossibleToSetColumnOrder(e,t){(0,i.validateArgToType)(e,"number","sheetId");try{var n=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,n),this._crudOperations.testColumnOrderForArrays(e,n),!0}catch(e){return!1}}isItPossibleToAddRows(e,...t){(0,i.validateArgToType)(e,"number","sheetId");t=(0,g.normalizeAddedIndexes)(t);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...t),!0}catch(e){return!1}}addRows(e,...t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.addRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...t){(0,i.validateArgToType)(e,"number","sheetId");t=(0,g.normalizeRemovedIndexes)(t);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...t),!0}catch(e){return!1}}removeRows(e,...t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.removeRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...t){(0,i.validateArgToType)(e,"number","sheetId");t=(0,g.normalizeAddedIndexes)(t);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...t),!0}catch(e){return!1}}addColumns(e,...t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.addColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...t){(0,i.validateArgToType)(e,"number","sheetId");t=(0,g.normalizeRemovedIndexes)(t);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...t),!0}catch(e){return!1}}removeColumns(e,...t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.removeColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,t){if(!(0,o.isSimpleCellAddress)(t))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","destinationLeftCorner");if(!(0,a.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellRange","source");try{var n=new a.AbsoluteCellRange(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(n.start,n.width(),n.height(),t),!0}catch(e){return!1}}moveCells(e,t){if(!(0,o.isSimpleCellAddress)(t))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","destinationLeftCorner");if((0,a.isSimpleCellRange)(e))return e=new a.AbsoluteCellRange(e.start,e.end),this._crudOperations.moveCells(e.start,e.width(),e.height(),t),this.recomputeIfDependencyGraphNeedsIt();throw new d.ExpectedValueOfTypeError("SimpleCellRange","source")}isItPossibleToMoveRows(e,t,n,r){(0,i.validateArgToType)(e,"number","sheetId"),(0,i.validateArgToType)(t,"number","startRow"),(0,i.validateArgToType)(n,"number","numberOfRows"),(0,i.validateArgToType)(r,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,n,r),!0}catch(e){return!1}}moveRows(e,t,n,r){return(0,i.validateArgToType)(e,"number","sheetId"),(0,i.validateArgToType)(t,"number","startRow"),(0,i.validateArgToType)(n,"number","numberOfRows"),(0,i.validateArgToType)(r,"number","targetRow"),this._crudOperations.moveRows(e,t,n,r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,t,n,r){(0,i.validateArgToType)(e,"number","sheetId"),(0,i.validateArgToType)(t,"number","startColumn"),(0,i.validateArgToType)(n,"number","numberOfColumns"),(0,i.validateArgToType)(r,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,n,r),!0}catch(e){return!1}}moveColumns(e,t,n,r){return(0,i.validateArgToType)(e,"number","sheetId"),(0,i.validateArgToType)(t,"number","startColumn"),(0,i.validateArgToType)(n,"number","numberOfColumns"),(0,i.validateArgToType)(r,"number","targetColumn"),this._crudOperations.moveColumns(e,t,n,r),this.recomputeIfDependencyGraphNeedsIt()}copy(e){var t;if((0,a.isSimpleCellRange)(e))return t=new a.AbsoluteCellRange(e.start,e.end),this._crudOperations.copy(t.start,t.width(),t.height()),this.getRangeValues(e);throw new d.ExpectedValueOfTypeError("SimpleCellRange","source")}cut(e){var t;if((0,a.isSimpleCellRange)(e))return t=new a.AbsoluteCellRange(e.start,e.end),this._crudOperations.cut(t.start,t.width(),t.height()),this.getRangeValues(e);throw new d.ExpectedValueOfTypeError("SimpleCellRange","source")}paste(e){if((0,o.isSimpleCellAddress)(e))return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt();throw new d.ExpectedValueOfTypeError("SimpleCellAddress","targetLeftCorner")}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if((0,a.isSimpleCellRange)(e))return new a.AbsoluteCellRange(e.start,e.end).arrayOfAddressesInRange().map(e=>e.map(e=>this.getCellValue(e)));throw new d.ExpectedValueOfTypeError("SimpleCellRange","source")}getRangeFormulas(e){if((0,a.isSimpleCellRange)(e))return new a.AbsoluteCellRange(e.start,e.end).arrayOfAddressesInRange().map(e=>e.map(e=>this.getCellFormula(e)));throw new d.ExpectedValueOfTypeError("SimpleCellRange","source")}getRangeSerialized(e){if((0,a.isSimpleCellRange)(e))return new a.AbsoluteCellRange(e.start,e.end).arrayOfAddressesInRange().map(e=>e.map(e=>this.getCellSerialized(e)));throw new d.ExpectedValueOfTypeError("SimpleCellRange","source")}getFillRangeData(r,i,o=!1){if(!(0,a.isSimpleCellRange)(r))throw new d.ExpectedValueOfTypeError("SimpleCellRange","source");if(!(0,a.isSimpleCellRange)(i))throw new d.ExpectedValueOfTypeError("SimpleCellRange","target");const s=new a.AbsoluteCellRange(r.start,r.end);var e=new a.AbsoluteCellRange(i.start,i.end);return this.ensureEvaluationIsNotSuspended(),e.arrayOfAddressesInRange().map(e=>e.map(e=>{var t=((e.row-(o?i:r).start.row)%s.height()+s.height())%s.height()+r.start.row,n=((e.col-(o?i:r).start.col)%s.width()+s.width())%s.width()+r.start.col;return this._serialization.getCellSerialized({row:t,col:n,sheet:s.sheet},e)}))}isItPossibleToAddSheet(e){(0,i.validateArgToType)(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch(e){return!1}}addSheet(e){void 0!==e&&(0,i.validateArgToType)(e,"string","sheetName");e=this._crudOperations.addSheet(e);return this._emitter.emit(p.Events.SheetAdded,e),e}isItPossibleToRemoveSheet(e){(0,i.validateArgToType)(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(e){return!1}}removeSheet(e){(0,i.validateArgToType)(e,"number","sheetId");var t=this.sheetMapping.getDisplayName(e),e=(this._crudOperations.removeSheet(e),this.recomputeIfDependencyGraphNeedsIt());return this._emitter.emit(p.Events.SheetRemoved,t,e),e}isItPossibleToClearSheet(e){(0,i.validateArgToType)(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(e){return!1}}clearSheet(e){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,t){(0,i.validateArgToType)(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,t),!0}catch(e){return!1}}setSheetContent(e,t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,t){return(0,i.validateArgToType)(e,"string","cellAddress"),(0,i.validateArgToType)(t,"number","sheetId"),(0,m.simpleCellAddressFromString)(this.sheetMapping.get,e,t)}simpleCellRangeFromString(e,t){return(0,i.validateArgToType)(e,"string","cellRange"),(0,i.validateArgToType)(t,"number","sheetId"),(0,m.simpleCellRangeFromString)(this.sheetMapping.get,e,t)}simpleCellAddressToString(e,t){if((0,o.isSimpleCellAddress)(e))return(0,i.validateArgToType)(t,"number","sheetId"),(0,m.simpleCellAddressToString)(this.sheetMapping.fetchDisplayName,e,t);throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress")}simpleCellRangeToString(e,t){if((0,a.isSimpleCellRange)(e))return(0,i.validateArgToType)(t,"number","sheetId"),(0,m.simpleCellRangeToString)(this.sheetMapping.fetchDisplayName,e,t);throw new d.ExpectedValueOfTypeError("SimpleCellRange","cellRange")}getCellDependents(e){let t;if((0,o.isSimpleCellAddress)(e))t=this._dependencyGraph.addressMapping.getCell(e);else{if(!(0,a.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress | SimpleCellRange",e);t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)}return void 0===t?[]:this._dependencyGraph.getAdjacentNodesAddresses(t)}getCellPrecedents(e){let t;if((0,o.isSimpleCellAddress)(e))t=this._dependencyGraph.addressMapping.getCell(e);else{if(!(0,a.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress | SimpleCellRange",e);t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)}return void 0===t?[]:this._dependencyGraph.dependencyQueryAddresses(t)}getSheetName(e){return(0,i.validateArgToType)(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}getSheetNames(){return this.sheetMapping.sheetNames()}getSheetId(e){return(0,i.validateArgToType)(e,"string","sheetName"),this.sheetMapping.get(e)}doesSheetExist(e){return(0,i.validateArgToType)(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){var t;if((0,o.isSimpleCellAddress)(e))return t=this.dependencyGraph.getCell(e),(0,o.getCellType)(t,e);throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress")}doesCellHaveSimpleValue(e){if((0,o.isSimpleCellAddress)(e))return this.getCellType(e)===o.CellType.VALUE;throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress")}doesCellHaveFormula(e){if((0,o.isSimpleCellAddress)(e))return(e=this.getCellType(e))===o.CellType.FORMULA||e===o.CellType.ARRAYFORMULA;throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress")}isCellEmpty(e){if((0,o.isSimpleCellAddress)(e))return this.getCellType(e)===o.CellType.EMPTY;throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress")}isCellPartOfArray(e){if((0,o.isSimpleCellAddress)(e))return(e=this.getCellType(e))===o.CellType.ARRAY||e===o.CellType.ARRAYFORMULA;throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress")}getCellValueType(e){if(!(0,o.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();e=this.dependencyGraph.getCellValue(e);return(0,o.getCellValueType)(e)}getCellValueDetailedType(e){if(!(0,o.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();e=this.dependencyGraph.getCellValue(e);return(0,o.getCellValueDetailedType)(e)}getCellValueFormat(e){if(!(0,o.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();e=this.dependencyGraph.getCellValue(e);return(0,o.getCellValueFormat)(e)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,t){(0,i.validateArgToType)(e,"number","sheetId"),(0,i.validateArgToType)(t,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch(e){return!1}}renameSheet(e,t){(0,i.validateArgToType)(e,"number","sheetId"),(0,i.validateArgToType)(t,"string","newName");e=this._crudOperations.renameSheet(e,t);void 0!==e&&this._emitter.emit(p.Events.SheetRenamed,e,t)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(e){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),e}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(p.Events.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;var e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(p.Events.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,t,n){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==n&&(0,i.validateArgToType)(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,n),!0}catch(e){return!1}}addNamedExpression(e,t,n,r){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==n&&(0,i.validateArgToType)(n,"number","scope"),this._crudOperations.addNamedExpression(e,t,n,r);t=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(p.Events.NamedExpressionAdded,e,t),t}getNamedExpressionValue(e,t){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==t&&(0,i.validateArgToType)(t,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(t);e=this._namedExpressions.namedExpressionForScope(e,t);if(e)return this._serialization.getCellValue(e.address)}getNamedExpressionFormula(e,t){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==t&&(0,i.validateArgToType)(t,"number","scope"),this._crudOperations.ensureScopeIdIsValid(t);e=this._namedExpressions.namedExpressionForScope(e,t);if(void 0!==e)return this._serialization.getCellFormula(e.address)}getNamedExpression(e,t){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==t&&(0,i.validateArgToType)(t,"number","scope");var n=this._namedExpressions.namedExpressionForScope(e,t);if(void 0!==n)return{name:e,scope:t,expression:this._serialization.getCellFormula(n.address),options:n.options}}isItPossibleToChangeNamedExpression(e,t,n){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==n&&(0,i.validateArgToType)(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,n),!0}catch(e){return!1}}changeNamedExpression(e,t,n,r){return(0,i.validateArgToType)(e,"string","expressionName"),void 0!==n&&(0,i.validateArgToType)(n,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,n,t,r),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,t){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==t&&(0,i.validateArgToType)(t,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch(e){return!1}}removeNamedExpression(e,t){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==t&&(0,i.validateArgToType)(t,"number","scope");e=this._crudOperations.removeNamedExpression(e,t);return e?(t=this.recomputeIfDependencyGraphNeedsIt(),this._emitter.emit(p.Events.NamedExpressionRemoved,e.displayName,t),t):[]}listNamedExpressions(e){return void 0!==e&&(0,i.validateArgToType)(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){(0,i.validateArgToType)(e,"string","formulaString");var{ast:e,address:t}=this.extractTemporaryFormula(e);if(void 0===e)throw new d.NotAFormulaError;return this._unparser.unparse(e,t)}calculateFormula(e,t){(0,i.validateArgToType)(e,"string","formulaString"),(0,i.validateArgToType)(t,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(t);var{ast:e,address:t,dependencies:n}=this.extractTemporaryFormula(e,t);if(void 0===e)throw new d.NotAFormulaError;e=this.evaluator.runAndForget(e,t,n);return this._exporter.exportScalarOrRange(e)}validateFormula(e){(0,i.validateArgToType)(e,"string","formulaString");e=this.extractTemporaryFormula(e).ast;return void 0!==e&&!(e.type===m.AstNodeType.ERROR&&!e.error)}getRegisteredFunctionNames(){return y.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return(0,i.validateArgToType)(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return(0,i.validateArgToType)(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return(0,i.validateArgToType)(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return(0,i.validateArgToType)(e,"number","val"),(0,u.numberToSimpleTime)(e)}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}destroy(){(0,c.objectDestroy)(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new d.EvaluationSuspendedError}extractTemporaryFormula(e,t=1){var n,r,e=this._cellContentParser.parse(e),t={sheet:t,col:0,row:0};return!(e instanceof s.CellContent.Formula)||({ast:e,errors:n,dependencies:r}=this._parser.parse(e.formula,t),0<n.length)?{address:t,dependencies:[]}:{ast:e,address:t,dependencies:r}}rebuildWithConfig(e){var t=this._config.mergeConfig(e),e=this._config.mergeConfig({language:e.language}),e=this._serialization.withNewConfig(e,this._namedExpressions).getAllSheetsSerialized(),n=this._serialization.getAllNamedExpressionsSerialized(),t=r.BuildEngineFactory.rebuildWithConfig(t,e,n,this._stats);this._config=t.config,this._stats=t.stats,this._dependencyGraph=t.dependencyGraph,this._columnSearch=t.columnSearch,this._parser=t.parser,this._unparser=t.unparser,this._cellContentParser=t.cellContentParser,this._evaluator=t.evaluator,this._lazilyTransformingAstService=t.lazilyTransformingAstService,this._crudOperations=t.crudOperations,this._exporter=t.exporter,this._namedExpressions=t.namedExpressions,this._serialization=t.serialization,this._functionRegistry=t.functionRegistry}recomputeIfDependencyGraphNeedsIt(){var e,t;return this._evaluationSuspended?[]:(e=this._crudOperations.getAndClearContentChanges(),t=Array.from(this.dependencyGraph.verticesToRecompute()),this.dependencyGraph.clearRecentlyChangedVertices(),0<t.length&&e.addAll(this.evaluator.partialRun(t)),t=e.exportChanges(this._exporter),e.isEmpty()||this._emitter.emit(p.Events.ValuesUpdated,t),t)}}y.version="2.5.0",y.buildDate="29/05/2023 09:32:33",y.releaseDate="29/05/2023",y.languages={},y.registeredLanguages=new Map},(e,t,n)=>{"use strict";n.r(t),n.d(t,{BuildEngineFactory:()=>r});var R=n(1),A=n(110),_=n(111),i=n(99),N=n(112),x=n(102),O=n(4),I=n(77),M=n(125),k=n(126),D=n(127),o=n(86),L=n(95),P=n(128),F=n(130),B=n(132),H=n(134),U=n(113),V=n(139),W=n(114),$=n(7),j=n(140),z=n(123),G=n(72),Y=n(124);class r{static buildFromSheets(e,t={},n=[]){t=new i.Config(t);return this.buildEngine(t,e,n)}static buildFromSheet(e,t={},n=[]){var t=new i.Config(t),r=t.translationPackage.getUITranslation(o.UIElement.NEW_SHEET_PREFIX)+"1";return this.buildEngine(t,{[r]:e},n)}static buildEmpty(e={},t=[]){return this.buildEngine(new i.Config(e),{},t)}static rebuildWithConfig(e,t,n,r){return this.buildEngine(e,t,n,r)}static buildEngine(e,t={},n=[],r=new(e.useStats?G.Statistics:G.EmptyStatistics)){r.start(G.StatType.BUILD_ENGINE_TOTAL);var i=new U.NamedExpressions,o=new P.FunctionRegistry(e),s=new B.LazilyTransformingAstService(r);const a=O.DependencyGraph.buildEmpty(s,e,o,i,r),l=(0,H.buildColumnSearchStrategy)(a,e,r);var u=a.sheetMapping,c=a.addressMapping;for(const T in t)if(Object.prototype.hasOwnProperty.call(t,T)){var d=t[T],h=((0,z.validateAsSheet)(d),(0,z.findBoundaries)(d));if(h.height>e.maxRows||h.width>e.maxColumns)throw new I.SheetSizeLimitExceededError;var f=u.addSheet(T);c.autoAddSheet(f,d,h)}const p=new $.ParserWithCaching(e,o,u.get);s.parser=p;var g=new $.Unparser(e,(0,$.buildLexerConfig)(e),u.fetchDisplayName,i),m=new x.DateTimeHelper(e),y=new V.NumberLiteralHelper(e),v=new L.ArithmeticHelper(e,m,y);const b=new A.CellContentParser(e,m,y),E=new R.ArraySizePredictor(e,o);var y=new W.Operations(e,a,l,b,p,r,s,i,E),C=new Y.UndoRedo(e,y),w=(s.undoRedo=C,new _.ClipboardOperations(e,a,y));const S=new N.CrudOperations(e,y,C,w,a,l,p,b,s,i);n.forEach(e=>{S.ensureItIsPossibleToAddNamedExpression(e.name,e.expression,e.scope),S.operations.addNamedExpression(e.name,e.expression,e.scope,e.options)});y=new k.Exporter(e,i,u.fetchDisplayName,s),C=new j.Serialization(a,g,y),w=new F.Interpreter(e,a,l,r,v,o,i,C,E,m),r.measure(G.StatType.GRAPH_BUILD,()=>{new D.GraphBuilder(a,l,p,b,r,E).buildGraph(t,r)}),n=new M.Evaluator(e,r,w,s,a,l);return n.run(),r.end(G.StatType.BUILD_ENGINE_TOTAL),{config:e,stats:r,dependencyGraph:a,columnSearch:l,parser:p,unparser:g,cellContentParser:b,evaluator:n,lazilyTransformingAstService:s,crudOperations:S,exporter:y,namedExpressions:i,serialization:C,functionRegistry:o}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{CellContent:()=>o,CellContentParser:()=>r,isBoolean:()=>f,isError:()=>p,isFormula:()=>h});var o,s=n(3),a=n(102),l=n(61),u=n(77),c=n(95),d=n(70);{(t=o=o||{}).Number=class{constructor(e){this.value=e,this.value=(0,d.cloneNumber)(this.value,(0,c.fixNegativeZero)((0,d.getRawValue)(this.value)))}},t.String=class{constructor(e){this.value=e}},t.Boolean=class{constructor(e){this.value=e}};class i{static getSingletonInstance(){return i.instance||(i.instance=new i),i.instance}}t.Empty=i,t.Formula=class{constructor(e){this.formula=e}},t.Error=class{constructor(e,t){this.value=new s.CellError(e,t)}}}function h(e){return e.startsWith("=")}function f(e){e=e.toLowerCase();return"true"===e||"false"===e}function p(e,t){e=e.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(e)&&Object.prototype.hasOwnProperty.call(t,e)}class r{constructor(e,t,n){this.config=e,this.dateHelper=t,this.numberLiteralsHelper=n}parse(r){if(null==r)return o.Empty.getSingletonInstance();if("number"==typeof r)return(0,c.isNumberOverflow)(r)?new o.Error(s.ErrorType.NUM,l.ErrorMessage.ValueLarge):new o.Number(r);if("boolean"==typeof r)return new o.Boolean(r);if(r instanceof Date)return(i=this.dateHelper.dateToNumber({day:r.getDate(),month:r.getMonth()+1,year:r.getFullYear()})+(0,a.timeToNumber)({hours:r.getHours(),minutes:r.getMinutes(),seconds:r.getSeconds()+r.getMilliseconds()/1e3}))<0?new o.Error(s.ErrorType.NUM,l.ErrorMessage.DateBounds):i%1==0?new o.Number(new d.DateNumber(i,"Date()")):i<1?new o.Number(new d.TimeNumber(i,"Date()")):new o.Number(new d.DateTimeNumber(i,"Date()"));if("string"!=typeof r)throw new u.UnableToParseError(r);if(f(r))return new o.Boolean("true"===r.toLowerCase());if(h(r))return new o.Formula(r);if(p(r,this.config.errorMapping))return new o.Error(this.config.errorMapping[r.toUpperCase()]);{let e=r.trim(),t=0,n;e.endsWith("%")?(t=1,e=e.slice(0,e.length-1)):void 0!==(i=this.currencyMatcher(e))&&(t=2,[n,e]=i);var i=this.numberLiteralsHelper.numericStringToMaybeNumber(e);if(void 0!==i){let e;return e=1===t?new d.PercentNumber(i/100):2===t?new d.CurrencyNumber(i,n):i,new o.Number(e)}i=this.dateHelper.dateStringToDateNumber(e);return void 0!==i?new o.Number(i):new o.String(r.startsWith("'")?r.slice(1):r)}}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length)];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length)]}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ClipboardCellType:()=>r,ClipboardOperations:()=>u});var s,r,i=n(2),a=n(3),o=n(77);(t=s=s||{})[t.COPY=0]="COPY",t[t.CUT=1]="CUT",(n=r=r||{})[n.VALUE=0]="VALUE",n[n.EMPTY=1]="EMPTY",n[n.FORMULA=2]="FORMULA",n[n.PARSING_ERROR=3]="PARSING_ERROR";class l{constructor(e,t,n,r,i){this.sourceLeftCorner=e,this.width=t,this.height=n,this.type=r,this.content=i}*getContent(n){if(void 0!==this.content)for(let t=0;t<this.height;++t)for(let e=0;e<this.width;++e)yield[(0,a.simpleCellAddress)(n.sheet,n.col+e,n.row+t),this.content[t][e]]}}class u{constructor(e,t,n){this.dependencyGraph=t,this.operations=n,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,t,n){this.clipboard=new l(e,t,n,s.CUT)}copy(n,r,e){var i=[];for(let t=0;t<e;++t){i[t]=[];for(let e=0;e<r;++e){var o=this.operations.getClipboardCell((0,a.simpleCellAddress)(n.sheet,n.col+e,n.row+t));i[t].push(o)}}this.clipboard=new l(n,r,e,s.COPY,i)}abortCut(){this.clipboard&&this.clipboard.type===s.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(void 0!==this.clipboard){if((0,a.invalidSimpleCellAddress)(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new o.InvalidArgumentsError("a valid target address.");e=i.AbsoluteCellRange.spanFrom(e,this.clipboard.width,this.clipboard.height);if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new o.SheetSizeLimitExceededError;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(e))throw new Error("It is not possible to paste onto an array")}}isCutClipboard(){return void 0!==this.clipboard&&this.clipboard.type===s.CUT}isCopyClipboard(){return void 0!==this.clipboard&&this.clipboard.type===s.COPY}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{CrudOperations:()=>h});var s=n(2),a=n(3),r=n(110),l=n(77),i=n(113),o=n(114),u=n(123),c=n(71),d=n(124);class h{constructor(e,t,n,r,i,o,s,a,l,u){this.operations=t,this.undoRedo=n,this.clipboardOperations=r,this.dependencyGraph=i,this.columnSearch=o,this.parser=s,this.cellContentParser=a,this.lazilyTransformingAstService=l,this.namedExpressions=u,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...t){var n=new o.AddRowsCommand(e,t);this.ensureItIsPossibleToAddRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(n),this.undoRedo.saveOperation(new d.AddRowsUndoEntry(n))}removeRows(e,...t){var n=new o.RemoveRowsCommand(e,t),e=(this.ensureItIsPossibleToRemoveRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.removeRows(n));this.undoRedo.saveOperation(new d.RemoveRowsUndoEntry(n,e))}addColumns(e,...t){var n=new o.AddColumnsCommand(e,t);this.ensureItIsPossibleToAddColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(n),this.undoRedo.saveOperation(new d.AddColumnsUndoEntry(n))}removeColumns(e,...t){var n=new o.RemoveColumnsCommand(e,t),e=(this.ensureItIsPossibleToRemoveColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.removeColumns(n));this.undoRedo.saveOperation(new d.RemoveColumnsUndoEntry(n,e))}moveCells(e,t,n,r){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var{version:i,overwrittenCellsData:o,addedGlobalNamedExpressions:s}=this.operations.moveCells(e,t,n,r);this.undoRedo.saveOperation(new d.MoveCellsUndoEntry(e,t,n,r,o,s,i))}moveRows(e,t,n,r){this.ensureItIsPossibleToMoveRows(e,t,n,r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var i=this.operations.moveRows(e,t,n,r);this.undoRedo.saveOperation(new d.MoveRowsUndoEntry(e,t,n,r,i))}moveColumns(e,t,n,r){this.ensureItIsPossibleToMoveColumns(e,t,n,r),this.undoRedo.clearRedoStack();var i=this.operations.moveColumns(e,t,n,r);this.undoRedo.saveOperation(new d.MoveColumnsUndoEntry(e,t,n,r,i))}cut(e,t,n){this.clipboardOperations.cut(e,t,n)}ensureItIsPossibleToCopy(e,t,n){if(!f(t))throw new l.InvalidArgumentsError("width to be positive integer.");if(!f(n))throw new l.InvalidArgumentsError("height to be positive integer.")}copy(e,t,n){this.ensureItIsPossibleToCopy(e,t,n),this.clipboardOperations.copy(e,t,n)}paste(e){var t,n,r=this.clipboardOperations.clipboard;if(void 0===r)throw new l.NothingToPasteError;this.clipboardOperations.isCutClipboard()?this.moveCells(r.sourceLeftCorner,r.width,r.height,e):this.clipboardOperations.isCopyClipboard()&&(this.clipboardOperations.ensureItIsPossibleToCopyPaste(e),t=s.AbsoluteCellRange.spanFrom(e,r.width,r.height),t=this.operations.getRangeClipboardCells(t),this.undoRedo.clearRedoStack(),n=this.operations.restoreClipboardCells(r.sourceLeftCorner.sheet,r.getContent(e)),this.undoRedo.saveOperation(new d.PasteUndoEntry(e,t,r.content,n)))}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return void 0===this.clipboardOperations.clipboard}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){void 0!==e&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();e=this.operations.addSheet(e);return this.undoRedo.saveOperation(new d.AddSheetUndoEntry(e)),e}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var t=this.sheetMapping.fetchDisplayName(e),n=this.operations.getSheetClipboardCells(e),{version:r,scopedNamedExpressions:i}=this.operations.removeSheet(e);this.undoRedo.saveOperation(new d.RemoveSheetUndoEntry(t,e,n,i,r))}renameSheet(e,t){this.ensureItIsPossibleToRenameSheet(e,t);var n=this.operations.renameSheet(e,t);return void 0!==n&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new d.RenameSheetUndoEntry(e,n,t))),n}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var t=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new d.ClearSheetUndoEntry(e,t))}setCellContents(n,r){if(r instanceof Array){for(let e=0;e<r.length;e++)if(!(r[e]instanceof Array))throw new l.InvalidArgumentsError("an array of arrays or a raw cell value.")}else r=[[r]];this.ensureItIsPossibleToChangeCellContents(n,r),this.undoRedo.clearRedoStack();var i=[];for(let t=0;t<r.length;t++)for(let e=0;e<r[t].length;e++){var o={sheet:n.sheet,row:n.row+t,col:n.col+e},s=r[t][e],a=(this.clipboardOperations.abortCut(),this.operations.setCellContent(o,s));i.push({address:o,newContent:s,oldContent:a})}this.undoRedo.saveOperation(new d.SetCellContentsUndoEntry(i))}setSheetContent(e,t){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,t),(0,u.validateAsSheet)(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var n=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,t),this.undoRedo.saveOperation(new d.SetSheetContentUndoEntry(e,n,t))}setRowOrder(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var n=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new d.SetRowOrderUndoEntry(e,t,n))}validateSwapRowIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new l.NoSheetWithIdError(e);this.validateRowOrColumnMapping(e,t,"row")}testColumnOrderForArrays(e,t){for(var[n,r]of t)if(n!==r){r=s.AbsoluteCellRange.spanFrom({sheet:e,col:n,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(r))throw new l.SourceLocationHasArrayError}}setColumnOrder(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var n=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new d.SetColumnOrderUndoEntry(e,t,n))}validateSwapColumnIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new l.NoSheetWithIdError(e);this.validateRowOrColumnMapping(e,t,"column")}testRowOrderForArrays(e,t){for(var[n,r]of t)if(n!==r){r=s.AbsoluteCellRange.spanFrom({sheet:e,col:0,row:n},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(r))throw new l.SourceLocationHasArrayError}}mappingFromOrder(e,t,n){if(!this.sheetMapping.hasSheetWithId(e))throw new l.NoSheetWithIdError(e);var r="row"===n?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==r)throw new l.InvalidArgumentsError(`number of ${n}s provided to be sheet ${"row"===n?"height":"width"}.`);var i=[];for(let e=0;e<r;e++)t[e]!==e&&i.push([e,t[e]]);return i}undo(){if(this.undoRedo.isUndoStackEmpty())throw new l.NoOperationToUndoError;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new l.NoOperationToRedoError;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,t,n,r){this.ensureItIsPossibleToAddNamedExpression(e,t,n),this.operations.addNamedExpression(e,t,n,r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new d.AddNamedExpressionUndoEntry(e,t,n,r))}changeNamedExpressionExpression(e,t,n,r){this.ensureItIsPossibleToChangeNamedExpression(e,n,t);var[e,i]=this.operations.changeNamedExpressionExpression(e,n,t,r);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new d.ChangeNamedExpressionUndoEntry(e,n,i,t,r))}removeNamedExpression(e,t){this.ensureScopeIdIsValid(t);var[e,n]=this.operations.removeNamedExpression(e,t);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new d.RemoveNamedExpressionUndoEntry(e,n,t)),e}ensureItIsPossibleToAddNamedExpression(e,t,n){this.ensureScopeIdIsValid(n),this.ensureNamedExpressionNameIsValid(e,n),this.ensureNamedExpressionIsValid(t)}ensureItIsPossibleToChangeNamedExpression(e,t,n){if(this.ensureScopeIdIsValid(n),void 0===this.namedExpressions.namedExpressionForScope(e,n))throw new l.NamedExpressionDoesNotExistError(e);this.ensureNamedExpressionIsValid(t)}isItPossibleToRemoveNamedExpression(e,t){if(this.ensureScopeIdIsValid(t),void 0===this.namedExpressions.namedExpressionForScope(e,t))throw new l.NamedExpressionDoesNotExistError(e)}ensureItIsPossibleToAddRows(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new l.NoSheetWithIdError(e);var n,r;if(this.dependencyGraph.getSheetHeight(e)+t.map(e=>e[1]).reduce((e,t)=>e+t,0)>this.maxRows)throw new l.SheetSizeLimitExceededError;for([n,r]of t)if(!p(n)||!f(r))throw new l.InvalidArgumentsError("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...t){for(var[n,r]of t){r=n+r-1;if(!p(n)||!p(r))throw new l.InvalidArgumentsError("starting and ending row to be nonnegative.");if(r<n)throw new l.InvalidArgumentsError("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new l.NoSheetWithIdError(e)}}ensureItIsPossibleToAddColumns(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new l.NoSheetWithIdError(e);var n,r;if(this.dependencyGraph.getSheetWidth(e)+t.map(e=>e[1]).reduce((e,t)=>e+t,0)>this.maxColumns)throw new l.SheetSizeLimitExceededError;for([n,r]of t)if(!p(n)||!f(r))throw new l.InvalidArgumentsError("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...t){for(var[n,r]of t){r=n+r-1;if(!p(n)||!p(r))throw new l.InvalidArgumentsError("starting and ending column to be nonnegative.");if(r<n)throw new l.InvalidArgumentsError("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new l.NoSheetWithIdError(e)}}ensureItIsPossibleToMoveRows(e,t,n,r){this.ensureItIsPossibleToAddRows(e,[r,n]);var i=(0,a.simpleCellAddress)(e,0,t),o=(0,a.simpleCellAddress)(e,0,r);if(!this.sheetMapping.hasSheetWithId(e)||(0,a.invalidSimpleCellAddress)(i)||(0,a.invalidSimpleCellAddress)(o)||!f(n)||r<=t+n&&t<=r)throw new l.InvalidArgumentsError("a valid range of rows to move.");o=this.dependencyGraph.getSheetWidth(e),t=s.AbsoluteCellRange.spanFrom(i,o,n);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new l.SourceLocationHasArrayError;if(0<r&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(c.RowsSpan.fromNumberOfRows(e,r-1,2)))throw new l.TargetLocationHasArrayError}ensureItIsPossibleToMoveColumns(e,t,n,r){this.ensureItIsPossibleToAddColumns(e,[r,n]);var i=(0,a.simpleCellAddress)(e,t,0),o=(0,a.simpleCellAddress)(e,r,0);if(!this.sheetMapping.hasSheetWithId(e)||(0,a.invalidSimpleCellAddress)(i)||(0,a.invalidSimpleCellAddress)(o)||!f(n)||r<=t+n&&t<=r)throw new l.InvalidArgumentsError("a valid range of columns to move.");o=this.dependencyGraph.getSheetHeight(e),t=s.AbsoluteCellRange.spanFrom(i,n,o);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new l.SourceLocationHasArrayError;if(0<r&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(c.ColumnsSpan.fromNumberOfColumns(e,r-1,2)))throw new l.TargetLocationHasArrayError}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new l.SheetNameAlreadyTakenError(e)}ensureItIsPossibleToRenameSheet(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new l.NoSheetWithIdError(e);var n=this.sheetMapping.get(t);if(void 0!==n&&n!==e)throw new l.SheetNameAlreadyTakenError(t)}ensureItIsPossibleToChangeContent(e){if((0,a.invalidSimpleCellAddress)(e))throw new l.InvalidAddressError(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new l.NoSheetWithIdError(e.sheet)}ensureItIsPossibleToChangeCellContents(e,t){t=(0,u.findBoundaries)(t),e=s.AbsoluteCellRange.spanFrom(e,t.width,t.height);this.ensureRangeInSizeLimits(e);for(const n of e.addresses(this.dependencyGraph))this.ensureItIsPossibleToChangeContent(n)}ensureItIsPossibleToChangeSheetContents(e,t){t=(0,u.findBoundaries)(t),e=s.AbsoluteCellRange.spanFrom((0,a.simpleCellAddress)(e,0,0),t.width,t.height);this.ensureRangeInSizeLimits(e)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new l.SheetSizeLimitExceededError}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(void 0!==e&&!this.sheetMapping.hasSheetWithId(e))throw new l.NoSheetWithIdError(e)}validateRowOrColumnMapping(e,t,n){var r="row"===n?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),i=t.map(([e])=>e).sort((e,t)=>e-t),o=t.map(([,e])=>e).sort((e,t)=>e-t);for(let e=0;e<i.length;e++){if(!p(i[e])||i[e]>=r)throw new l.InvalidArgumentsError(n+` numbers to be nonnegative integers and less than sheet ${"row"===n?"height":"width"}.`);if(i[e]===i[e+1])throw new l.InvalidArgumentsError(`source ${n} numbers to be unique.`);if(i[e]!==o[e])throw new l.InvalidArgumentsError(`target ${n} numbers to be permutation of source ${n} numbers.`)}}ensureNamedExpressionNameIsValid(e,t){if(!this.namedExpressions.isNameValid(e))throw new l.NamedExpressionNameIsInvalidError(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new l.NamedExpressionNameIsAlreadyTakenError(e)}ensureNamedExpressionIsValid(e){e=this.cellContentParser.parse(e);if(e instanceof r.CellContent.Formula){e=this.parser.parse(e.formula,(0,a.simpleCellAddress)(-1,0,0));if((0,i.doesContainRelativeReferences)(e.ast))throw new l.NoRelativeAddressesAllowedError}}}function f(e){return Number.isInteger(e)&&0<e}function p(e){return Number.isInteger(e)&&0<=e}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{InternalNamedExpression:()=>s,NamedExpressions:()=>u,doesContainRelativeReferences:()=>c});var r=n(3),i=n(7),o=n(12);class s{constructor(e,t,n,r){this.displayName=e,this.address=t,this.added=n,this.options=r}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new s(this.displayName,this.address,this.added,this.options)}}class a{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){e=this.normalizeExpressionName(e),e=this.mapping.get(e);return!(e&&e.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){e=this.mapping.get(this.normalizeExpressionName(e));if(e&&e.added)return e}remove(e){e=this.normalizeExpressionName(e),e=this.mapping.get(e);e&&(e.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}normalizeExpressionName(e){return e.toLowerCase()}}class l{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}isNameAvailable(e){e=this.normalizeExpressionName(e);return!this.mapping.has(e)}remove(e){e=this.normalizeExpressionName(e);this.mapping.get(e)&&this.mapping.delete(e)}normalizeExpressionName(e){return e.toLowerCase()}}class u{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new a,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,t){return void 0===t?this.workbookStore.isNameAvailable(e):null==(t=null==(t=this.worksheetStore(t))?void 0:t.isNameAvailable(e))||t}namedExpressionInAddress(e){e=this.addressCache.get(e);if(e&&e.added)return e}namedExpressionForScope(e,t){return void 0===t?this.workbookStore.getExisting(e):null==(t=this.worksheetStore(t))?void 0:t.get(e)}nearestNamedExpression(e,t){return null!=(t=null==(t=this.worksheetStore(t))?void 0:t.get(e))?t:this.workbookStore.getExisting(e)}isExpressionInScope(e,t){return null!=(t=null==(t=this.worksheetStore(t))?void 0:t.has(e))&&t}isNameValid(e){var t=new RegExp(`^${o.CELL_REFERENCE_PATTERN}$`),n=new RegExp(`^${o.R1C1_CELL_REFERENCE_PATTERN}$`),r=new RegExp(`^${o.NAMED_EXPRESSION_PATTERN}$`);return!t.test(e)&&!n.test(e)&&r.test(e)}addNamedExpression(e,t,n){t=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t);let r=t.get(e);return void 0!==r?(r.added=!0,r.displayName=e,r.options=n):(r=new s(e,this.nextAddress(),!0,n),t.add(r)),this.addressCache.set(r.address.row,r),r}restoreNamedExpression(e,t){t=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,t.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,t){return null!=(t=this.worksheetStoreOrCreate(t).get(e))?t:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let t=this.workbookStore.get(e);return void 0===t&&(t=new s(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}remove(e,t){let n;var r=null===(n=void 0===t?this.workbookStore:this.worksheetStore(t))||void 0===n?void 0:n.get(e);if(void 0===n||void 0===r||!r.added)throw Error("Named expression does not exist");n.remove(e),n instanceof l&&0===n.mapping.size&&this.worksheetStores.delete(t),this.addressCache.delete(r.address.row)}getAllNamedExpressionsNamesInScope(t){return this.getAllNamedExpressions().filter(({scope:e})=>e===t).map(e=>e.expression.displayName)}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map(e=>e.expression.displayName)}getAllNamedExpressions(){const n=[];return this.workbookStore.getAllNamedExpressions().forEach(e=>{n.push({expression:e,scope:void 0})}),this.worksheetStores.forEach((e,t)=>{e.getAllNamedExpressions().forEach(e=>{n.push({expression:e,scope:t})})}),n}getAllNamedExpressionsForScope(e){return void 0===e?this.workbookStore.getAllNamedExpressions():null!=(e=null==(e=this.worksheetStores.get(e))?void 0:e.getAllNamedExpressions())?e:[]}worksheetStoreOrCreate(e){let t=this.worksheetStores.get(e);return t||(t=new l,this.worksheetStores.set(e,t)),t}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return(0,r.simpleCellAddress)(u.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}u.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;const c=e=>{switch(e.type){case i.AstNodeType.EMPTY:case i.AstNodeType.NUMBER:case i.AstNodeType.STRING:case i.AstNodeType.ERROR:case i.AstNodeType.ERROR_WITH_RAW_INPUT:return!1;case i.AstNodeType.CELL_REFERENCE:return!e.reference.isAbsolute();case i.AstNodeType.CELL_RANGE:case i.AstNodeType.COLUMN_RANGE:case i.AstNodeType.ROW_RANGE:return!e.start.isAbsolute();case i.AstNodeType.NAMED_EXPRESSION:return!1;case i.AstNodeType.PERCENT_OP:case i.AstNodeType.PLUS_UNARY_OP:case i.AstNodeType.MINUS_UNARY_OP:return c(e.value);case i.AstNodeType.CONCATENATE_OP:case i.AstNodeType.EQUALS_OP:case i.AstNodeType.NOT_EQUAL_OP:case i.AstNodeType.LESS_THAN_OP:case i.AstNodeType.GREATER_THAN_OP:case i.AstNodeType.LESS_THAN_OR_EQUAL_OP:case i.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case i.AstNodeType.MINUS_OP:case i.AstNodeType.PLUS_OP:case i.AstNodeType.TIMES_OP:case i.AstNodeType.DIV_OP:case i.AstNodeType.POWER_OP:return c(e.left)||c(e.right);case i.AstNodeType.PARENTHESIS:return c(e.expression);case i.AstNodeType.FUNCTION_CALL:return e.args.some(e=>c(e));case i.AstNodeType.ARRAY:return e.args.some(e=>e.some(e=>c(e)))}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{AddColumnsCommand:()=>N,AddRowsCommand:()=>_,Operations:()=>O,RemoveColumnsCommand:()=>x,RemoveRowsCommand:()=>A,normalizeAddedIndexes:()=>M,normalizeRemovedIndexes:()=>I});var d=n(2),u=n(6),a=n(1),l=n(3),c=n(110),s=n(111),h=n(68),f=n(4),r=n(80),i=n(115),o=n(117),p=n(118),g=n(119),m=n(120),y=n(121),v=n(122),b=n(77),E=n(70),C=n(113),w=n(7),S=n(123),T=n(71),R=n(72);class A{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return I(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>T.RowsSpan.fromNumberOfRows(this.sheet,e[0],e[1]))}}class _{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return M(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>T.RowsSpan.fromNumberOfRows(this.sheet,e[0],e[1]))}}class N{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return M(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>T.ColumnsSpan.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class x{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return I(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>T.ColumnsSpan.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class O{constructor(e,t,n,r,i,o,s,a,l){this.dependencyGraph=t,this.columnSearch=n,this.cellContentParser=r,this.parser=i,this.stats=o,this.lazilyTransformingAstService=s,this.namedExpressions=a,this.arraySizePredictor=l,this.changes=h.ContentChanges.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){var t=[];for(const r of e.rowsSpans()){var n=this.doRemoveRows(r);n&&t.push(n)}return t}addRows(e){for(const t of e.rowsSpans())this.doAddRows(t)}addColumns(e){for(const t of e.columnsSpans())this.doAddColumns(t)}removeColumns(e){var t=[];for(const r of e.columnsSpans()){var n=this.doRemoveColumns(r);n&&t.push(n)}return t}removeSheet(t){this.dependencyGraph.removeSheet(t);let n;this.stats.measure(R.StatType.TRANSFORM_ASTS,()=>{var e=new v.RemoveSheetTransformer(t);e.performEagerTransformations(this.dependencyGraph,this.parser),n=this.lazilyTransformingAstService.addTransformation(e)}),this.sheetMapping.removeSheet(t),this.columnSearch.removeSheet(t);var e=this.namedExpressions.getAllNamedExpressionsForScope(t).map(e=>this.removeNamedExpression(e.normalizeExpressionName(),t));return{version:n,scopedNamedExpressions:e}}removeSheetByName(e){e=this.sheetMapping.fetch(e);return this.removeSheet(e)}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){var e=this.sheetMapping.addSheet(e),t=[];return this.dependencyGraph.addressMapping.autoAddSheet(e,t,(0,S.findBoundaries)(t)),this.sheetMapping.fetchDisplayName(e)}renameSheet(e,t){return this.sheetMapping.renameSheet(e,t)}moveRows(e,t,n,r){var i=T.RowsSpan.fromNumberOfRows(e,r,n),i=(this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(i),r<t&&(t+=n),(0,l.simpleCellAddress)(e,0,t)),r=(0,l.simpleCellAddress)(e,0,r),i=(this.moveCells(i,Number.POSITIVE_INFINITY,n,r),T.RowsSpan.fromNumberOfRows(e,t,n));return this.doRemoveRows(i),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,t,n,r){var i=T.ColumnsSpan.fromNumberOfColumns(e,r,n),i=(this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(i),r<t&&(t+=n),(0,l.simpleCellAddress)(e,t,0)),r=(0,l.simpleCellAddress)(e,r,0),i=(this.moveCells(i,n,Number.POSITIVE_INFINITY,r),T.ColumnsSpan.fromNumberOfColumns(e,t,n));return this.doRemoveColumns(i),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,t,n,r){this.ensureItIsPossibleToMoveCells(e,t,n,r);const i=d.AbsoluteCellRange.spanFrom(e,t,n);var o=d.AbsoluteCellRange.spanFrom(r,t,n);const s=r.col-e.col,a=r.row-e.row,l=r.sheet;var u=this.getRangeClipboardCells(o),o=this.dependencyGraph.rawValuesFromRange(o),o=(this.columnSearch.removeValues(o),this.dependencyGraph.rawValuesFromRange(i));this.columnSearch.moveValues(o,s,a,l);let c;this.stats.measure(R.StatType.TRANSFORM_ASTS,()=>{var e=new g.MoveCellsTransformer(i,s,a,l);e.performEagerTransformations(this.dependencyGraph,this.parser),c=this.lazilyTransformingAstService.addTransformation(e)}),this.dependencyGraph.moveCells(i,s,a,l);o=this.updateNamedExpressionsForMovedCells(e,t,n,r);return{version:c,overwrittenCellsData:u,addedGlobalNamedExpressions:o}}setRowOrder(t,e){var n,r=[];let i=[];for(const[o,s]of e)o!==s&&(n=d.AbsoluteCellRange.spanFrom({sheet:t,col:0,row:o},1/0,1),n=this.getRangeClipboardCells(n),i=i.concat(n),r.push(n.map(([{sheet:e,col:t},n])=>[{sheet:e,col:t,row:s},n])));return r.forEach(e=>this.restoreClipboardCells(t,e.values())),i}setColumnOrder(t,e){var n,r=[];let i=[];for(const[o,s]of e)o!==s&&(n=d.AbsoluteCellRange.spanFrom({sheet:t,col:o,row:0},1,1/0),n=this.getRangeClipboardCells(n),i=i.concat(n),r.push(n.map(([{sheet:e,row:t},n])=>[{sheet:e,col:s,row:t},n])));return r.forEach(e=>this.restoreClipboardCells(t,e.values())),i}addNamedExpression(e,t,n,r){r=this.namedExpressions.addNamedExpression(e,n,r);this.storeNamedExpressionInCell(r.address,t),this.adjustNamedExpressionEdges(r,e,n)}restoreNamedExpression(e,t,n){var r=e.displayName,t=(this.restoreCell(e.address,t),this.namedExpressions.restoreNamedExpression(e,n));this.adjustNamedExpressionEdges(t,r,n)}changeNamedExpressionExpression(e,t,n,r){var i,n=this.namedExpressions.namedExpressionForScope(e,n);if(n)return i=n.copy(),n.options=r,r=this.getClipboardCell(n.address),this.storeNamedExpressionInCell(n.address,t),[i,r];throw new b.NamedExpressionDoesNotExistError(e)}removeNamedExpression(e,t){var n=this.namedExpressions.namedExpressionForScope(e,t);if(!n)throw new b.NamedExpressionDoesNotExistError(e);this.namedExpressions.remove(n.displayName,t);var r=this.getClipboardCell(n.address);return void 0!==t?(t=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e),this.dependencyGraph.exchangeNode(n.address,t.address)):this.dependencyGraph.setCellEmpty(n.address),[n,r]}ensureItIsPossibleToMoveCells(e,t,n,r){if((0,l.invalidSimpleCellAddress)(e)||!(k(t)&&k(n)||(i=t,s=n,0===(o=e).row&&k(i)&&s===Number.POSITIVE_INFINITY)||0===o.col&&k(s)&&i===Number.POSITIVE_INFINITY)||(0,l.invalidSimpleCellAddress)(r)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(r.sheet))throw new b.InvalidArgumentsError("a valid range of cells to move.");var i,o=d.AbsoluteCellRange.spanFrom(e,t,n),s=d.AbsoluteCellRange.spanFrom(r,t,n);if(s.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new b.SheetSizeLimitExceededError;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new b.SourceLocationHasArrayError;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new b.TargetLocationHasArrayError}restoreClipboardCells(e,t){var n,r,i,o=[];for([n,r]of t)this.restoreCell(n,r),r.type===s.ClipboardCellType.FORMULA&&(i=this.parser.fetchCachedResult(r.hash)["dependencies"],o.push(...this.updateNamedExpressionsForTargetAddress(e,n,i)));return o}restoreCell(e,t){switch(t.type){case s.ClipboardCellType.VALUE:this.setValueToCell(t,e);break;case s.ClipboardCellType.FORMULA:this.setFormulaToCellFromCache(t.hash,e);break;case s.ClipboardCellType.EMPTY:this.setCellEmpty(e);break;case s.ClipboardCellType.PARSING_ERROR:this.setParsingErrorToCell(t.rawInput,t.errors,e)}}getOldContent(e){var t=this.dependencyGraph.getCell(e);if(void 0===t||t instanceof f.EmptyCellVertex)return[e,{type:s.ClipboardCellType.EMPTY}];if(t instanceof f.ValueCellVertex)return[e,Object.assign({type:s.ClipboardCellType.VALUE},t.getValues())];if(t instanceof r.FormulaVertex)return[t.getAddress(this.lazilyTransformingAstService),{type:s.ClipboardCellType.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))}];if(t instanceof f.ParsingErrorVertex)return[e,{type:s.ClipboardCellType.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){var t,n=this.dependencyGraph.getCell(e);if(void 0===n||n instanceof f.EmptyCellVertex)return{type:s.ClipboardCellType.EMPTY};if(n instanceof f.ValueCellVertex)return Object.assign({type:s.ClipboardCellType.VALUE},n.getValues());if(n instanceof f.ArrayVertex)return(t=n.getArrayCellValue(e))===E.EmptyValue?{type:s.ClipboardCellType.EMPTY}:{type:s.ClipboardCellType.VALUE,parsedValue:t,rawValue:n.getArrayCellRawValue(e)};if(n instanceof f.FormulaCellVertex)return{type:s.ClipboardCellType.FORMULA,hash:this.parser.computeHashFromAst(n.getFormula(this.lazilyTransformingAstService))};if(n instanceof f.ParsingErrorVertex)return{type:s.ClipboardCellType.PARSING_ERROR,rawInput:n.rawInput,errors:n.errors};throw Error("Trying to copy unsupported type")}getSheetClipboardCells(n){var e=this.dependencyGraph.getSheetHeight(n),r=this.dependencyGraph.getSheetWidth(n),i=new Array(e);for(let t=0;t<e;t++){i[t]=new Array(r);for(let e=0;e<r;e++){var o=(0,l.simpleCellAddress)(n,e,t);i[t][e]=this.getClipboardCell(o)}}return i}getRangeClipboardCells(e){var t=[];for(const n of e.addresses(this.dependencyGraph))t.push([n,this.getClipboardCell(n)]);return t}setCellContent(e,t){var n,r,i,o=this.cellContentParser.parse(t),s=this.getOldContent(e);return o instanceof c.CellContent.Formula?({ast:r,errors:i}=n=this.parser.parse(o.formula,e),0<i.length?this.setParsingErrorToCell(o.formula,i,e):(i=this.arraySizePredictor.checkArraySize(r,e),this.setFormulaToCell(e,i,n))):o instanceof c.CellContent.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:o.value,rawValue:t},e),s}setSheetContent(n,r){this.clearSheet(n);for(let t=0;t<r.length;t++)for(let e=0;e<r[t].length;e++){var i=(0,l.simpleCellAddress)(n,e,t);this.setCellContent(i,r[t][e])}}setParsingErrorToCell(e,t,n){var r=this.dependencyGraph.getCellValue(n),t=new f.ParsingErrorVertex(t,e),e=this.dependencyGraph.setParsingErrorToCell(n,t);this.columnSearch.remove((0,E.getRawValue)(r),n),this.columnSearch.applyChanges(e.getChanges()),this.changes.addAll(e),this.changes.addChange(t.getCellValue(),n)}setFormulaToCell(e,t,{ast:n,hasVolatileFunction:r,hasStructuralChangeFunction:i,dependencies:o}){var s=this.dependencyGraph.getCellValue(e),n=this.dependencyGraph.setFormulaToCell(e,n,(0,u.absolutizeDependencies)(o,e),t,r,i);this.columnSearch.remove((0,E.getRawValue)(s),e),this.columnSearch.applyChanges(n.getChanges()),this.changes.addAll(n)}setValueToCell(e,t){var n=this.dependencyGraph.getCellValue(t),r=this.dependencyGraph.setValueToCell(t,e);this.columnSearch.change((0,E.getRawValue)(n),(0,E.getRawValue)(e.parsedValue),t),this.columnSearch.applyChanges(r.getChanges().filter(e=>!(0,l.equalSimpleCellAddress)(e.address,t))),this.changes.addAll(r),this.changes.addChange(e.parsedValue,t)}setCellEmpty(e){var t,n;this.dependencyGraph.isArrayInternalCell(e)||(t=this.dependencyGraph.getCellValue(e),n=this.dependencyGraph.setCellEmpty(e),this.columnSearch.remove((0,E.getRawValue)(t),e),this.columnSearch.applyChanges(n.getChanges()),this.changes.addAll(n),this.changes.addChange(E.EmptyValue,e))}setFormulaToCellFromCache(e,t){var{ast:e,hasVolatileFunction:n,hasStructuralChangeFunction:r,dependencies:i}=this.parser.fetchCachedResult(e),i=(0,u.absolutizeDependencies)(i,t),[o]=new p.CleanOutOfScopeDependenciesTransformer(t.sheet).transformSingleAst(e,t),i=(this.parser.rememberNewAst(o),(0,u.filterDependenciesOutOfScope)(i)),e=this.arraySizePredictor.checkArraySize(e,t);this.dependencyGraph.setFormulaToCell(t,o,i,e,n,r)}rowEffectivelyNotInSheet(e,t){return this.dependencyGraph.addressMapping.getHeight(t)<=e}getAndClearContentChanges(){var e=this.changes;return this.changes=h.ContentChanges.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(n){if(!this.rowEffectivelyNotInSheet(n.rowStart,n.sheet)){var e,r=[];for([e]of this.dependencyGraph.entriesFromRowsSpan(n))r.push({address:e,cellType:this.getClipboardCell(e)});var{affectedArrays:i,contentChanges:o}=this.dependencyGraph.removeRows(n);this.columnSearch.applyChanges(o.getChanges());let t;return this.stats.measure(R.StatType.TRANSFORM_ASTS,()=>{var e=new y.RemoveRowsTransformer(n);e.performEagerTransformations(this.dependencyGraph,this.parser),t=this.lazilyTransformingAstService.addTransformation(e)}),this.rewriteAffectedArrays(i),{version:t,removedCells:r,rowFrom:n.rowStart,rowCount:n.numberOfRows}}}doRemoveColumns(n){if(!this.columnEffectivelyNotInSheet(n.columnStart,n.sheet)){var e,r=[];for([e]of this.dependencyGraph.entriesFromColumnsSpan(n))r.push({address:e,cellType:this.getClipboardCell(e)});var{affectedArrays:i,contentChanges:o}=this.dependencyGraph.removeColumns(n);this.columnSearch.applyChanges(o.getChanges()),this.columnSearch.removeColumns(n);let t;return this.stats.measure(R.StatType.TRANSFORM_ASTS,()=>{var e=new m.RemoveColumnsTransformer(n);e.performEagerTransformations(this.dependencyGraph,this.parser),t=this.lazilyTransformingAstService.addTransformation(e)}),this.rewriteAffectedArrays(i),{version:t,removedCells:r,columnFrom:n.columnStart,columnCount:n.numberOfColumns}}}doAddRows(t){var e;this.rowEffectivelyNotInSheet(t.rowStart,t.sheet)||(e=this.dependencyGraph.addRows(t)["affectedArrays"],this.stats.measure(R.StatType.TRANSFORM_ASTS,()=>{var e=new o.AddRowsTransformer(t);e.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(e)}),this.rewriteAffectedArrays(e))}rewriteAffectedArrays(e){for(const r of e.values()){var t,n;r.array.size.isRef||(n=r.getFormula(this.lazilyTransformingAstService),t=r.getAddress(this.lazilyTransformingAstService),n=this.parser.computeHashFromAst(n),this.setFormulaToCellFromCache(n,t))}}doAddColumns(t){var e,n;this.columnEffectivelyNotInSheet(t.columnStart,t.sheet)||({affectedArrays:e,contentChanges:n}=this.dependencyGraph.addColumns(t),this.columnSearch.addColumns(t),this.columnSearch.applyChanges(n.getChanges()),this.stats.measure(R.StatType.TRANSFORM_ASTS,()=>{var e=new i.AddColumnsTransformer(t);e.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(e)}),this.rewriteAffectedArrays(e))}columnEffectivelyNotInSheet(e,t){return this.dependencyGraph.addressMapping.getWidth(t)<=e}adjustNamedExpressionEdges(e,t,n){if(void 0!==n){var r=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),t=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),i=this.dependencyGraph.fetchCellOrCreateEmpty(t.address);for(const a of this.dependencyGraph.graph.adjacentNodes(i))if(a instanceof f.FormulaCellVertex&&a.getAddress(this.lazilyTransformingAstService).sheet===n){var o=a.getFormula(this.lazilyTransformingAstService),s=a.getAddress(this.lazilyTransformingAstService),o=this.parser.fetchCachedResultForAst(o)["dependencies"];for(const l of(0,u.absolutizeDependencies)(o,s))l instanceof w.NamedExpressionDependency&&l.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(i,a),this.dependencyGraph.graph.addEdge(r,a))}}}storeNamedExpressionInCell(e,t){var n=this.cellContentParser.parse(t);if(n instanceof c.CellContent.Formula){var r=this.parser.parse(n.formula,(0,l.simpleCellAddress)(-1,0,0));if((0,C.doesContainRelativeReferences)(r.ast))throw new b.NoRelativeAddressesAllowedError;var{ast:r,hasVolatileFunction:i,hasStructuralChangeFunction:o,dependencies:s}=r;this.dependencyGraph.setFormulaToCell(e,r,(0,u.absolutizeDependencies)(s,e),a.ArraySize.scalar(),i,o)}else n instanceof c.CellContent.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:t},e)}updateNamedExpressionsForMovedCells(e,t,n,r){if(e.sheet===r.sheet)return[];var i=[];for(const s of d.AbsoluteCellRange.spanFrom(r,t,n).addresses(this.dependencyGraph)){var o=this.addressMapping.fetchCell(s);o instanceof f.FormulaCellVertex&&s.sheet!==e.sheet&&(o=o.getFormula(this.lazilyTransformingAstService),o=this.parser.fetchCachedResultForAst(o)["dependencies"],i.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,s,o)))}return i}updateNamedExpressionsForTargetAddress(e,t,n){if(e===t.sheet)return[];var r,i,o=[],s=this.addressMapping.fetchCell(t);for(const a of(0,u.absolutizeDependencies)(n,t))a instanceof w.NamedExpressionDependency&&(i=a.name,r=this.dependencyGraph.fetchNamedExpressionVertex(i,e),(i=this.namedExpressions.isExpressionInScope(i,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(i,t.sheet):this.copyOrFetchGlobalNamedExpressionVertex(i,r,o))!==r)&&(this.dependencyGraph.graph.softRemoveEdge(r,s),this.dependencyGraph.graph.addEdge(i,s));return o}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(C.NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS,new f.SparseStrategy(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,t,n){let r=this.namedExpressions.namedExpressionForScope(e);var i,o;return void 0===r&&(r=this.namedExpressions.addNamedExpression(e),n.push(r.normalizeExpressionName()),t instanceof f.FormulaCellVertex?({ast:e,hasVolatileFunction:n,hasStructuralChangeFunction:i,dependencies:o}=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),this.dependencyGraph.setFormulaToCell(r.address,e,(0,u.absolutizeDependencies)(o,r.address),a.ArraySize.scalar(),n,i)):t instanceof f.EmptyCellVertex?this.setCellEmpty(r.address):t instanceof f.ValueCellVertex&&this.setValueToCell(t.getValues(),r.address)),this.dependencyGraph.fetchCellOrCreateEmpty(r.address)}}function I(e){if(e.length<=1)return e;var e=[...e].sort(([e],[t])=>e-t),t=e.reduce((e,[t,n])=>{var r=e[e.length-1],i=r[0]+r[1];return t<=i?r[1]+=Math.max(0,n-(i-t)):e.push([t,n]),e},[e[0]]);let n=0;for(let e=0;e<t.length;++e)t[e][0]-=n,n+=t[e][1];return t}function M(e){if(e.length<=1)return e;var e=[...e].sort(([e],[t])=>e-t),t=e.reduce((e,[t,n])=>{var r=e[e.length-1];return t===r[0]?r[1]=Math.max(r[1],n):e.push([t,n]),e},[e[0]]);let n=0;for(let e=0;e<t.length;++e)t[e][0]+=n,n+=t[e][1];return t}function k(e){return Number.isInteger(e)&&0<e}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{AddColumnsTransformer:()=>r});var i=n(3);class r extends n(116).Transformer{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){throw Error("Not implemented")}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformCellAddress(e,t){var n=(0,i.absoluteSheetReference)(e,t);if(n!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;const r=e.toSimpleColumnAddress(t);if(n===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return this.columnsSpan.columnStart<=r.col&&e.shiftedByColumns(this.columnsSpan.numberOfColumns);if(t.sheet===this.columnsSpan.sheet&&n!==this.columnsSpan.sheet)return!(e.isColumnAbsolute()||t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(e.isColumnAbsolute())return!(e.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(this.columnsSpan.numberOfColumns);{const r=e.toSimpleColumnAddress(t);return r.col<this.columnsSpan.columnStart?!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart&&e.shiftedByColumns(this.columnsSpan.numberOfColumns)}}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,t,n){var r=this.transformCellAddress(e,n),n=this.transformCellAddress(t,n);return r===i.ErrorType.REF||n===i.ErrorType.REF?i.ErrorType.REF:!(!r&&!n)&&[r||e,n||t]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Transformer:()=>o});var r=n(3),i=n(7);class o{performEagerTransformations(e,t){for(const i of e.arrayFormulaNodes()){var[n,r]=this.transformSingleAst(i.getFormula(e.lazilyTransformingAstService),i.getAddress(e.lazilyTransformingAstService)),n=t.rememberNewAst(n);i.setFormula(n),i.setAddress(r)}}transformSingleAst(e,t){return[this.transformAst(e,t),this.fixNodeAddress(t)]}transformAst(e,t){switch(e.type){case i.AstNodeType.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case i.AstNodeType.CELL_RANGE:return this.transformCellRangeAst(e,t);case i.AstNodeType.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case i.AstNodeType.ROW_RANGE:return this.transformRowRangeAst(e,t);case i.AstNodeType.EMPTY:case i.AstNodeType.ERROR:case i.AstNodeType.NUMBER:case i.AstNodeType.NAMED_EXPRESSION:case i.AstNodeType.ERROR_WITH_RAW_INPUT:case i.AstNodeType.STRING:return e;case i.AstNodeType.PERCENT_OP:case i.AstNodeType.MINUS_UNARY_OP:case i.AstNodeType.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,t)});case i.AstNodeType.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map(e=>this.transformAst(e,t))});case i.AstNodeType.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,t)});case i.AstNodeType.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map(e=>e.map(e=>this.transformAst(e,t)))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}transformCellReferenceAst(e,t){t=this.transformCellAddress(e.reference,t);return t instanceof i.CellAddress?Object.assign(Object.assign({},e),{reference:t}):t===r.ErrorType.REF?(0,i.buildCellErrorAst)(new r.CellError(r.ErrorType.REF)):e}transformCellRangeAst(e,t){t=this.transformCellRange(e.start,e.end,t);return Array.isArray(t)?Object.assign(Object.assign({},e),{start:t[0],end:t[1]}):t===r.ErrorType.REF?(0,i.buildCellErrorAst)(new r.CellError(r.ErrorType.REF)):e}transformColumnRangeAst(e,t){t=this.transformColumnRange(e.start,e.end,t);return Array.isArray(t)?Object.assign(Object.assign({},e),{start:t[0],end:t[1]}):t===r.ErrorType.REF?(0,i.buildCellErrorAst)(new r.CellError(r.ErrorType.REF)):e}transformRowRangeAst(e,t){t=this.transformRowRange(e.start,e.end,t);return Array.isArray(t)?Object.assign(Object.assign({},e),{start:t[0],end:t[1]}):t===r.ErrorType.REF?(0,i.buildCellErrorAst)(new r.CellError(r.ErrorType.REF)):e}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{AddRowsTransformer:()=>r});var i=n(3);class r extends n(116).Transformer{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){throw Error("Not implemented")}transformCellAddress(e,t){var n,r=(0,i.absoluteSheetReference)(e,t);return(r===this.rowsSpan.sheet||t.sheet===this.rowsSpan.sheet)&&(n=e.toSimpleRowAddress(t),r===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=n.row&&e.shiftedByRows(this.rowsSpan.numberOfRows):t.sheet===this.rowsSpan.sheet&&r!==this.rowsSpan.sheet?!(e.isRowAbsolute()||t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?!(e.row<this.rowsSpan.rowStart)&&e.shiftedByRows(this.rowsSpan.numberOfRows):n.row<this.rowsSpan.rowStart?!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart&&e.shiftedByRows(this.rowsSpan.numberOfRows))}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,t,n){var r=this.transformCellAddress(e,n),n=this.transformCellAddress(t,n);return r===i.ErrorType.REF||n===i.ErrorType.REF?i.ErrorType.REF:!(!r&&!n)&&[r||e,n||t]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{CleanOutOfScopeDependenciesTransformer:()=>i});var r=n(3);class i extends n(116).Transformer{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return!!e.isInvalid(t)&&r.ErrorType.REF}transformCellRange(e,t,n){return!(!e.isInvalid(n)&&!t.isInvalid(n))&&r.ErrorType.REF}transformColumnRange(e,t,n){return!(!e.isInvalid(n)&&!t.isInvalid(n))&&r.ErrorType.REF}transformRowRange(e,t,n){return!(!e.isInvalid(n)&&!t.isInvalid(n))&&r.ErrorType.REF}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{DependentFormulaTransformer:()=>a,MoveCellsTransformer:()=>s});var r=n(3),o=n(7),i=n(11),t=n(116);class s extends t.Transformer{constructor(e,t,n,r){super(),this.sourceRange=e,this.toRight=t,this.toBottom=n,this.toSheet=r,this.dependentFormulaTransformer=new a(e,t,n,r)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,t){return this.sourceRange.addressInRange(t)?[this.transformAst(e,t),this.fixNodeAddress(t)]:this.dependentFormulaTransformer.transformSingleAst(e,t)}fixNodeAddress(e){return(0,r.simpleCellAddress)(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,t){return this.transformAddress(e,t)}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformAddress(e,t){var n=this.sourceRange;if(e instanceof o.CellAddress){t=e.toSimpleCellAddress(t);if(n.addressInRange(t))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,t,n){var r=this.sourceRange;if(e instanceof o.CellAddress&&t instanceof o.CellAddress){var i=e.toSimpleCellAddress(n),n=t.toSimpleCellAddress(n);if(r.addressInRange(i)&&r.addressInRange(n))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}class a extends t.Transformer{constructor(e,t,n,r){super(),this.sourceRange=e,this.toRight=t,this.toBottom=n,this.toSheet=r}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return!!this.shouldMove(e,t)&&e.moved(this.toSheet,this.toRight,this.toBottom)}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}shouldMove(e,t){return e instanceof o.CellAddress?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof i.RowAddress?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}transformRange(e,t,n){e=this.transformCellAddress(e,n),t=this.transformCellAddress(t,n);return!(!e||!t)&&[e,t]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{RemoveColumnsTransformer:()=>r});var a=n(3);class r extends n(116).Transformer{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){throw Error("Not implemented")}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformCellAddress(e,t){var n=(0,a.absoluteSheetReference)(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==n)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===n){var r=e.toSimpleColumnAddress(t);if(r.col<this.columnsSpan.columnStart)return!1;if(r.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==n){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===n)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{r=e.toSimpleColumnAddress(t);if(r.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(r.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return a.ErrorType.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,t,n){var r=(0,a.absoluteSheetReference)(e,n);let i=e,o=t;if(this.columnsSpan.sheet===r){var r=e.toSimpleColumnAddress(n),s=t.toSimpleColumnAddress(n);if(this.columnsSpan.columnStart<=r.col&&this.columnsSpan.columnEnd>=s.col)return a.ErrorType.REF;r.col>=this.columnsSpan.columnStart&&r.col<=this.columnsSpan.columnEnd&&(i=e.shiftedByColumns(this.columnsSpan.columnEnd-r.col+1)),s.col>=this.columnsSpan.columnStart&&s.col<=this.columnsSpan.columnEnd&&(o=t.shiftedByColumns(-(s.col-this.columnsSpan.columnStart+1)))}e=this.transformCellAddress(i,n),r=this.transformCellAddress(o,n);if(!1===e&&!1===r)return[i,o];if(e===a.ErrorType.REF||r===a.ErrorType.REF)throw Error("Cannot happen");return[e||i,r||o]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{RemoveRowsTransformer:()=>r});var a=n(3);class r extends n(116).Transformer{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,t){return e}transformCellAddress(e,t){var n=(0,a.absoluteSheetReference)(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==n)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===n){var r=e.toSimpleRowAddress(t);if(r.row<this.rowsSpan.rowStart)return!1;if(r.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==n){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===n)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{r=e.toSimpleRowAddress(t);if(r.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(r.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return a.ErrorType.REF}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,t,n){var r=(0,a.absoluteSheetReference)(e,n);let i=e,o=t;if(this.rowsSpan.sheet===r){var r=e.toSimpleRowAddress(n),s=t.toSimpleRowAddress(n);if(this.rowsSpan.rowStart<=r.row&&this.rowsSpan.rowEnd>=s.row)return a.ErrorType.REF;r.row>=this.rowsSpan.rowStart&&r.row<=this.rowsSpan.rowEnd&&(i=e.shiftedByRows(this.rowsSpan.rowEnd-r.row+1)),s.row>=this.rowsSpan.rowStart&&s.row<=this.rowsSpan.rowEnd&&(o=t.shiftedByRows(-(s.row-this.rowsSpan.rowStart+1)))}e=this.transformCellAddress(i,n),r=this.transformCellAddress(o,n);return!1===e&&!1===r?[i,o]:e===a.ErrorType.REF||r===a.ErrorType.REF?a.ErrorType.REF:[e||i,r||o]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{RemoveSheetTransformer:()=>i});var r=n(3);class i extends n(116).Transformer{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}performEagerTransformations(e,t){for(const r of e.arrayFormulaNodes()){var[n]=this.transformSingleAst(r.getFormula(e.lazilyTransformingAstService),r.getAddress(e.lazilyTransformingAstService));r.setFormula(n)}}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.transformAddress(e)}transformCellRange(e,t,n){return this.transformAddress(e)}transformColumnRange(e,t,n){return this.transformAddress(e)}transformRowRange(e,t,n){return this.transformAddress(e)}transformAddress(e){return e.sheet===this.sheet&&r.ErrorType.REF}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{findBoundaries:()=>function(r){let e=0,i=0,o=0;for(let n=0;n<r.length;n++){let t=0;for(let e=0;e<r[n].length;e++){var s=r[n][e];null!=s&&(t=e+1,++o)}e=Math.max(e,t),0<t&&(i=n+1)}var t=e*i;return{height:i,width:e,fill:0==t?0:o/t}},validateAsSheet:()=>function(t){if(!Array.isArray(t))throw new r.InvalidArgumentsError("an array of arrays.");for(let e=0;e<t.length;e++)if(!Array.isArray(t[e]))throw new r.InvalidArgumentsError("an array of arrays.")}});var r=n(77)},(e,t,n)=>{"use strict";n.r(t),n.d(t,{AddColumnsUndoEntry:()=>p,AddNamedExpressionUndoEntry:()=>w,AddRowsUndoEntry:()=>a,AddSheetUndoEntry:()=>m,BaseUndoEntry:()=>r,BatchUndoEntry:()=>R,ChangeNamedExpressionUndoEntry:()=>T,ClearSheetUndoEntry:()=>b,MoveCellsUndoEntry:()=>o,MoveColumnsUndoEntry:()=>f,MoveRowsUndoEntry:()=>h,PasteUndoEntry:()=>C,RemoveColumnsUndoEntry:()=>g,RemoveNamedExpressionUndoEntry:()=>S,RemoveRowsUndoEntry:()=>i,RemoveSheetUndoEntry:()=>y,RenameSheetUndoEntry:()=>v,SetCellContentsUndoEntry:()=>E,SetColumnOrderUndoEntry:()=>c,SetRowOrderUndoEntry:()=>u,SetSheetContentUndoEntry:()=>d,UndoRedo:()=>A});var l=n(3),s=n(114);class r{}class i extends r{constructor(e,t){super(),this.command=e,this.rowsRemovals=t}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}}class o extends r{constructor(e,t,n,r,i,o,s){super(),this.sourceLeftCorner=e,this.width=t,this.height=n,this.destinationLeftCorner=r,this.overwrittenCellsData=i,this.addedGlobalNamedExpressions=o,this.version=s}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}}class a extends r{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}}class u extends r{constructor(e,t,n){super(),this.sheetId=e,this.rowMapping=t,this.oldContent=n}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}}class c extends r{constructor(e,t,n){super(),this.sheetId=e,this.columnMapping=t,this.oldContent=n}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}}class d extends r{constructor(e,t,n){super(),this.sheetId=e,this.oldSheetContent=t,this.newSheetContent=n}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}}class h extends r{constructor(e,t,n,r,i){super(),this.sheet=e,this.startRow=t,this.numberOfRows=n,this.targetRow=r,this.version=i,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}}class f extends r{constructor(e,t,n,r,i){super(),this.sheet=e,this.startColumn=t,this.numberOfColumns=n,this.targetColumn=r,this.version=i,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}}class p extends r{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}}class g extends r{constructor(e,t){super(),this.command=e,this.columnsRemovals=t}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}}class m extends r{constructor(e){super(),this.sheetName=e}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}}class y extends r{constructor(e,t,n,r,i){super(),this.sheetName=e,this.sheetId=t,this.oldSheetContent=n,this.scopedNamedExpressions=r,this.version=i}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}}class v extends r{constructor(e,t,n){super(),this.sheetId=e,this.oldName=t,this.newName=n}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}}class b extends r{constructor(e,t){super(),this.sheetId=e,this.oldSheetContent=t}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}}class E extends r{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}}class C extends r{constructor(e,t,n,r){super(),this.targetLeftCorner=e,this.oldContent=t,this.newContent=n,this.addedGlobalNamedExpressions=r}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}}class w extends r{constructor(e,t,n,r){super(),this.name=e,this.newContent=t,this.scope=n,this.options=r}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}}class S extends r{constructor(e,t,n){super(),this.namedExpression=e,this.content=t,this.scope=n}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}}class T extends r{constructor(e,t,n,r,i){super(),this.namedExpression=e,this.newContent=t,this.oldContent=n,this.scope=r,this.options=i}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}}class R extends r{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;0<=e;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}class A{constructor(e,t){this.operations=t,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){void 0!==this.batchUndoEntry?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new R}commitBatchMode(){if(void 0===this.batchUndoEntry)throw Error("Batch mode wasn't started");this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,t,n){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([t,n])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return 0===this.undoStack.length}isRedoStackEmpty(){return 0===this.redoStack.length}undo(){var e=this.undoStack.pop();if(!e)throw Error("Attempted to undo without operation on stack");this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(const t of e.reversedOperations())this.undoEntry(t)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();var{command:{sheet:t},rowsRemovals:n}=e;for(let e=n.length-1;0<=e;--e){var r,i,o=n[e];this.operations.addRows(new s.AddRowsCommand(t,[[o.rowFrom,o.rowCount]]));for({address:r,cellType:i}of o.removedCells)this.operations.restoreCell(r,i);this.restoreOldDataFromVersion(o.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();var{command:{sheet:t},columnsRemovals:n}=e;for(let e=n.length-1;0<=e;--e){var r,i,o=n[e];this.operations.addColumns(new s.AddColumnsCommand(t,[[o.columnFrom,o.columnCount]]));for({address:r,cellType:i}of o.removedCells)this.operations.restoreCell(r,i);this.restoreOldDataFromVersion(o.version-1)}}undoAddRows(t){var n=t.command.rowsSpans();for(let e=n.length-1;0<=e;--e){var r=n[e];this.operations.removeRows(new s.RemoveRowsCommand(t.command.sheet,[[r.rowStart,r.numberOfRows]]))}}undoAddColumns(t){var n=t.command.columnsSpans();for(let e=n.length-1;0<=e;--e){var r=n[e];this.operations.removeColumns(new s.RemoveColumnsCommand(t.command.sheet,[[r.columnStart,r.numberOfColumns]]))}}undoSetCellContents(e){for(const i of e.cellContents){var t=i.address,[n,r]=i.oldContent;(0,l.equalSimpleCellAddress)(t,n)||this.operations.setCellEmpty(t),this.operations.restoreCell(n,r)}}undoPaste(e){this.restoreOperationOldContent(e.oldContent);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoMoveRows(e){var t=e["sheet"];this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){var t=e["sheet"];this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoAddSheet(e){e=e.sheetName;this.operations.removeSheetByName(e)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();var t,n,{oldSheetContent:r,sheetId:i}=e;this.operations.addSheet(e.sheetName);for(let t=0;t<r.length;t++){var o=r[t];for(let e=0;e<o.length;e++){var s=o[e],a=(0,l.simpleCellAddress)(i,e,t);this.operations.restoreCell(a,s)}}for([t,n]of e.scopedNamedExpressions)this.operations.restoreNamedExpression(t,n,i);this.restoreOldDataFromVersion(e.version-1)}undoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.oldName)}undoClearSheet(e){var{oldSheetContent:n,sheetId:r}=e;for(let t=0;t<n.length;t++){var i=n[t];for(let e=0;e<i.length;e++){var o=i[e],s=(0,l.simpleCellAddress)(r,e,t);this.operations.restoreCell(s,o)}}}undoSetSheetContent(e){var{oldSheetContent:n,sheetId:r}=e;this.operations.clearSheet(r);for(let t=0;t<n.length;t++){var i=n[t];for(let e=0;e<i.length;e++){var o=i[e],s=(0,l.simpleCellAddress)(r,e,t);this.operations.restoreCell(s,o)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){var e=this.redoStack.pop();if(!e)throw Error("Attempted to redo without operation on stack");this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(const t of e.operations)this.redoEntry(t)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){var{targetLeftCorner:n,newContent:r}=e,i=r.length,o=r[0].length;for(let t=0;t<i;++t)for(let e=0;e<o;++e){var s=(0,l.simpleCellAddress)(n.sheet,n.col+e,n.row+t);this.operations.restoreCell(s,r[t][e])}}redoSetCellContents(e){for(const t of e.cellContents)this.operations.setCellContent(t.address,t.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheet(e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){var{sheetId:e,newSheetContent:t}=e;this.operations.setSheetContent(e,t)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(var[t,n]of e)this.operations.restoreCell(t,n)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){for(const r of this.oldData.get(e)||[]){var[t,n]=r;this.operations.setFormulaToCellFromCache(n,t)}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Evaluator:()=>f});var s=n(2),a=n(6),r=n(3),o=n(68),l=n(4),u=n(80),c=n(93),d=n(70),i=n(69),h=n(72);class f{constructor(e,t,n,r,i,o){this.config=e,this.stats=t,this.interpreter=n,this.lazilyTransformingAstService=r,this.dependencyGraph=i,this.columnSearch=o}run(){this.stats.start(h.StatType.TOP_SORT);const{sorted:e,cycled:t}=this.dependencyGraph.topSortWithScc();this.stats.end(h.StatType.TOP_SORT),this.stats.measure(h.StatType.EVALUATION,()=>{this.recomputeFormulas(t,e)})}partialRun(e){const i=o.ContentChanges.empty();return this.stats.measure(h.StatType.EVALUATION,()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,e=>{var t,n,r;return e instanceof u.FormulaVertex?(t=e.isComputed()?e.getCellValue():void 0,(n=this.recomputeFormulaVertexValue(e))!==t&&(r=e.getAddress(this.lazilyTransformingAstService),i.addChange(n,r),this.columnSearch.change((0,d.getRawValue)(t),(0,d.getRawValue)(n),r),!0)):(e instanceof l.RangeVertex&&e.clearCache(),!0)},e=>{var t,n;e instanceof l.RangeVertex?e.clearCache():e instanceof u.FormulaVertex&&(t=e.getAddress(this.lazilyTransformingAstService),this.columnSearch.remove((0,d.getRawValue)(e.valueOrUndef()),t),n=new r.CellError(r.ErrorType.CYCLE,void 0,e),e.setCellValue(n),i.addChange(n,t))})}),i}runAndForget(e,t,n){var r,i=[];for(const o of(0,a.absolutizeDependencies)(n,t))o instanceof s.AbsoluteCellRange&&(r=o,void 0===this.dependencyGraph.getRange(r.start,r.end))&&(r=new l.RangeVertex(r),this.dependencyGraph.rangeMapping.setRange(r),i.push(r));n=this.evaluateAstToCellValue(e,new c.InterpreterState(t,this.config.useArrayArithmetic));return i.forEach(e=>{this.dependencyGraph.rangeMapping.removeRange(e)}),n}recomputeFormulas(e,t){e.forEach(e=>{e instanceof u.FormulaVertex&&e.setCellValue(new r.CellError(r.ErrorType.CYCLE,void 0,e))}),t.forEach(e=>{var t,n;e instanceof u.FormulaVertex?(t=this.recomputeFormulaVertexValue(e),n=e.getAddress(this.lazilyTransformingAstService),this.columnSearch.add((0,d.getRawValue)(t),n)):e instanceof l.RangeVertex&&e.clearCache()})}recomputeFormulaVertexValue(e){var t,n=e.getAddress(this.lazilyTransformingAstService);return e instanceof l.ArrayVertex&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e))?e.setNoSpace():(t=e.getFormula(this.lazilyTransformingAstService),t=this.evaluateAstToCellValue(t,new c.InterpreterState(n,this.config.useArrayArithmetic,e)),e.setCellValue(t))}evaluateAstToCellValue(e,t){e=this.interpreter.evaluateAst(e,t);return!(e instanceof i.SimpleRangeValue)&&e===d.EmptyValue&&this.config.evaluateNullToZero?0:e}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ExportedCellChange:()=>c,ExportedNamedExpressionChange:()=>d,Exporter:()=>h});var r=n(3),i=n(98),o=n(61),s=n(70),a=n(69),l=n(113),u=n(8);class c{constructor(e,t){this.address=e,this.newValue=t}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}class d{constructor(e,t){this.name=e,this.newValue=t}}class h{constructor(e,t,n,r){this.config=e,this.namedExpressions=t,this.sheetIndexMapping=n,this.lazilyTransformingService=r}exportChange(e){var t=e.value,e=e.address;if(e.sheet===l.NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS){var n=this.namedExpressions.namedExpressionInAddress(e.row);if(n)return new d(n.displayName,this.exportScalarOrRange(t));throw new Error("Missing named expression")}if(t instanceof a.SimpleRangeValue){var r,i,o=[];for([r,i]of t.entriesFromTopLeftCorner(e))o.push(new c(i,this.exportValue(r)));return o}return new c(e,this.exportValue(t))}exportValue(e){return e instanceof a.SimpleRangeValue?this.detailedError(new r.CellError(r.ErrorType.VALUE,o.ErrorMessage.ScalarExpected)):this.config.smartRounding&&(0,s.isExtendedNumber)(e)?this.cellValueRounding((0,s.getRawValue)(e)):e instanceof r.CellError?this.detailedError(e):e===s.EmptyValue?null:(0,s.getRawValue)(e)}exportScalarOrRange(e){return e instanceof a.SimpleRangeValue?e.rawData().map(e=>e.map(e=>this.exportValue(e))):this.exportValue(e)}detailedError(e){var t;let n=void 0;var r=null==(r=e.root)?void 0:r.getAddress(this.lazilyTransformingService);return void 0!==r&&(n=r.sheet===l.NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS?null==(t=this.namedExpressions.namedExpressionInAddress(r.row))?void 0:t.displayName:(0,u.simpleCellAddressToString)(this.sheetIndexMapping,r,-1)),new i.DetailedCellError(e,this.config.translationPackage.getErrorTranslation(e.type),n)}cellValueRounding(e){var t;return 0===e?e:(t=Math.floor(Math.log10(Math.abs(e))),t=Math.pow(10,this.config.precisionRounding-t),e<0?-Math.round(-e*t)/t:Math.round(e*t)/t)}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{GraphBuilder:()=>r,SimpleStrategy:()=>s});var h=n(6),f=n(1),p=n(3),g=n(110),m=n(4),y=n(70),v=n(72);class r{constructor(e,t,n,r,i,o){this.dependencyGraph=e,this.columnSearch=t,this.parser=n,this.cellContentParser=r,this.stats=i,this.arraySizePredictor=o,this.buildStrategy=new s(e,t,n,i,r,o)}buildGraph(e,t){const n=t.measure(v.StatType.COLLECT_DEPENDENCIES,()=>this.buildStrategy.run(e));this.dependencyGraph.getAndClearContentChanges(),t.measure(v.StatType.PROCESS_DEPENDENCIES,()=>this.processDependencies(n))}processDependencies(e){e.forEach((e,t)=>{this.dependencyGraph.processCellDependencies(e,t)})}}class s{constructor(e,t,n,r,i,o){this.dependencyGraph=e,this.columnIndex=t,this.parser=n,this.stats=r,this.cellContentParser=i,this.arraySizePredictor=o}run(e){var n=new Map;for(const t in e){var r=this.dependencyGraph.getSheetId(t),i=e[t];for(let t=0;t<i.length;++t){var o=i[t];for(let e=0;e<o.length;++e){var s,a,l,u=o[e];const c=(0,p.simpleCellAddress)(r,e,t),d=this.cellContentParser.parse(u);d instanceof g.CellContent.Formula?0<(l=this.stats.measure(v.StatType.PARSER,()=>this.parser.parse(d.formula,c))).errors.length?(this.shrinkArrayIfNeeded(c),s=new m.ParsingErrorVertex(l.errors,d.formula),this.dependencyGraph.addVertex(c,s)):(this.shrinkArrayIfNeeded(c),(s=this.arraySizePredictor.checkArraySize(l.ast,c)).isScalar()?(a=new m.FormulaCellVertex(l.ast,c,0),n.set(a,(0,h.absolutizeDependencies)(l.dependencies,c)),this.dependencyGraph.addVertex(c,a),l.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(a),l.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(a)):(a=new m.ArrayVertex(l.ast,c,new f.ArraySize(s.width,s.height)),n.set(a,(0,h.absolutizeDependencies)(l.dependencies,c)),this.dependencyGraph.addArrayVertex(c,a))):d instanceof g.CellContent.Empty||(this.shrinkArrayIfNeeded(c),l=new m.ValueCellVertex(d.value,u),this.columnIndex.add((0,y.getRawValue)(d.value),c),this.dependencyGraph.addVertex(c,l))}}}return n}shrinkArrayIfNeeded(e){e=this.dependencyGraph.getCell(e);e instanceof m.ArrayVertex&&this.dependencyGraph.shrinkArrayToCorner(e)}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{FunctionRegistry:()=>s});var i=n(77),r=n(108),t=n(129);function a(e,t){let n=t.implementedFunctions[e];var r=null==(r=t.aliases)?void 0:r[e];if(void 0!==r){if(void 0!==n)throw new i.AliasAlreadyExisting(e,t.name);n=t.implementedFunctions[r]}if(void 0===n)throw i.FunctionPluginValidationError.functionNotDeclaredInPlugin(e,t.name);return n}class s{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=e=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(e),this.isFunctionVolatile=e=>this.volatileFunctions.has(e),this.isArrayFunction=e=>this.arrayFunctions.has(e),this.isFunctionDependentOnSheetStructureChange=e=>this.structuralChangeFunctions.has(e),0<e.functionPlugins.length){this.instancePlugins=new Map;for(const o of e.functionPlugins)s.loadPluginFunctions(o,this.instancePlugins)}else this.instancePlugins=new Map(s.plugins);for(var[t,n]of s.protectedFunctions())s.loadFunctionUnprotected(n,t,this.instancePlugins);for(var[r,i]of this.instancePlugins.entries())this.categorizeFunction(r,a(r,i))}static registerFunctionPlugin(e,t){this.loadPluginFunctions(e,this.plugins),void 0!==t&&this.loadTranslations(t)}static registerFunction(e,t,n){this.loadPluginFunction(t,e,this.plugins),void 0!==n&&this.loadTranslations(n)}static unregisterFunction(e){if(this.functionIsProtected(e))throw i.ProtectedFunctionError.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(const r of this.protectedPlugins())if(r===e)throw i.ProtectedFunctionError.cannotUnregisterProtectedPlugin();for(var[t,n]of this.plugins.entries())n===e&&this.plugins.delete(t)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){if(!this.functionIsProtected(e))return this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(t){const n=new Set(r.HyperFormula.getRegisteredLanguagesCodes());Object.keys(t).forEach(e=>{n.has(e)&&r.HyperFormula.getLanguage(e).extendFunctions(t[e])})}static loadPluginFunctions(t,n){Object.keys(t.implementedFunctions).forEach(e=>{this.loadPluginFunction(t,e,n)}),void 0!==t.aliases&&Object.keys(t.aliases).forEach(e=>{this.loadPluginFunction(t,e,n)})}static loadPluginFunction(e,t,n){if(this.functionIsProtected(t))throw i.ProtectedFunctionError.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,n)}static loadFunctionUnprotected(e,t,n){var r=a(t,e).method;if(!Object.prototype.hasOwnProperty.call(e.prototype,r))throw i.FunctionPluginValidationError.functionMethodNotFound(r,e.name);n.set(t,e)}static*protectedFunctions(){for(var[e,t]of this._protectedPlugins)void 0!==t&&(yield[e,t])}static*protectedPlugins(){for(var[,e]of this._protectedPlugins)void 0!==e&&(yield e)}initializePlugins(t){var n=[];for(const[o,s]of this.instancePlugins.entries()){let e=n.find(e=>e instanceof s);void 0===e&&(e=new s(t),n.push(e));var r=a(o,s),i=r.method,i=(this.functions.set(o,[i,e]),r.arraySizeMethod);void 0!==i&&this.arraySizeFunctions.set(o,[i,e])}}getFunctionPlugin(e){if(!s.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){var t=this.functions.get(e);if(void 0!==t&&this.config.translationPackage.isFunctionTranslated(e)){const[n,r]=t;return(e,t)=>r[n](e,t)}}getArraySizeFunction(e){var t=this.arraySizeFunctions.get(e);if(void 0!==t&&this.config.translationPackage.isFunctionTranslated(e)){const[n,r]=t;return(e,t)=>r[n](e,t)}}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){var e,t,n=new Set;for([e,t]of this.instancePlugins)s.functionIsProtected(e)||n.add(t);return Array.from(n)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.arrayFunction&&this.arrayFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,t)}}s.plugins=new Map,s._protectedPlugins=new Map([["VERSION",t.VersionPlugin],["OFFSET",void 0]])},(e,t,n)=>{"use strict";n.r(t),n.d(t,{VersionPlugin:()=>o});var r=n(108),t=n(94);const i=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class o extends t.FunctionPlugin{version(e,t){return this.runFunction(e.args,t,this.metadata("VERSION"),()=>{var{licenseKeyValidityState:e,licenseKey:t}=this.config;let n;return i.has(t)?n=i.get(t):i.has(e)?n=i.get(e):"valid"===e&&(n=t.slice(-5)),`HyperFormula v${r.HyperFormula.version}, `+n})}}o.implementedFunctions={VERSION:{method:"version",parameters:[]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Interpreter:()=>r});var d=n(2),h=n(81),v=n(3),b=n(61),f=n(57),E=n(95),c=n(131),p=n(128),g=n(93),m=n(70),C=n(69);class r{constructor(e,t,n,r,i,o,s,a,l,u){this.config=e,this.dependencyGraph=t,this.columnSearch=n,this.stats=r,this.arithmeticHelper=i,this.functionRegistry=o,this.namedExpressions=s,this.serialization=a,this.arraySizePredictor=l,this.dateTimeHelper=u,this.equalOp=(e,t)=>w(this.arithmeticHelper.eq,e,t),this.notEqualOp=(e,t)=>w(this.arithmeticHelper.neq,e,t),this.greaterThanOp=(e,t)=>w(this.arithmeticHelper.gt,e,t),this.lessThanOp=(e,t)=>w(this.arithmeticHelper.lt,e,t),this.greaterThanOrEqualOp=(e,t)=>w(this.arithmeticHelper.geq,e,t),this.lessThanOrEqualOp=(e,t)=>w(this.arithmeticHelper.leq,e,t),this.concatOp=(e,t)=>w(this.arithmeticHelper.concat,(0,E.coerceScalarToString)(e),(0,E.coerceScalarToString)(t)),this.plusOp=(e,t)=>w(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.minusOp=(e,t)=>w(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.timesOp=(e,t)=>w(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.powerOp=(e,t)=>w(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.divOp=(e,t)=>w(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.unaryMinusOp=e=>y(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(e)),this.percentOp=e=>y(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(e)),this.unaryPlusOp=e=>this.arithmeticHelper.unaryPlus(e),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new c.CriterionBuilder(e)}evaluateAst(e,t){let n=this.evaluateAstWithoutPostprocessing(e,t);if((0,m.isExtendedNumber)(n)){if((0,E.isNumberOverflow)((0,m.getRawValue)(n)))return new v.CellError(v.ErrorType.NUM,b.ErrorMessage.NaN);n=(0,m.cloneNumber)(n,(0,E.fixNegativeZero)((0,m.getRawValue)(n)))}n instanceof C.SimpleRangeValue&&1===n.height()&&1===n.width()&&([[n]]=n.data);e=n,t=t.formulaVertex;return e instanceof v.CellError&&void 0!==t?e.attachRootVertex(t):e}evaluateAstWithoutPostprocessing(e,n){switch(e.type){case f.AstNodeType.EMPTY:return m.EmptyValue;case f.AstNodeType.CELL_REFERENCE:var t=e.reference.toSimpleCellAddress(n.formulaAddress);return(0,v.invalidSimpleCellAddress)(t)?new v.CellError(v.ErrorType.REF,b.ErrorMessage.BadRef):this.dependencyGraph.getCellValue(t);case f.AstNodeType.NUMBER:case f.AstNodeType.STRING:return e.value;case f.AstNodeType.CONCATENATE_OP:var t=this.evaluateAst(e.left,n),r=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.concatOp,t,r,n);case f.AstNodeType.EQUALS_OP:t=this.evaluateAst(e.left,n),r=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.equalOp,t,r,n);case f.AstNodeType.NOT_EQUAL_OP:t=this.evaluateAst(e.left,n),r=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.notEqualOp,t,r,n);case f.AstNodeType.GREATER_THAN_OP:t=this.evaluateAst(e.left,n),r=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.greaterThanOp,t,r,n);case f.AstNodeType.LESS_THAN_OP:t=this.evaluateAst(e.left,n),r=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.lessThanOp,t,r,n);case f.AstNodeType.GREATER_THAN_OR_EQUAL_OP:t=this.evaluateAst(e.left,n),r=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,t,r,n);case f.AstNodeType.LESS_THAN_OR_EQUAL_OP:t=this.evaluateAst(e.left,n),r=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.lessThanOrEqualOp,t,r,n);case f.AstNodeType.PLUS_OP:t=this.evaluateAst(e.left,n),r=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.plusOp,t,r,n);case f.AstNodeType.MINUS_OP:t=this.evaluateAst(e.left,n),r=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.minusOp,t,r,n);case f.AstNodeType.TIMES_OP:t=this.evaluateAst(e.left,n),r=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.timesOp,t,r,n);case f.AstNodeType.POWER_OP:t=this.evaluateAst(e.left,n),r=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.powerOp,t,r,n);case f.AstNodeType.DIV_OP:t=this.evaluateAst(e.left,n),r=this.evaluateAst(e.right,n);return this.binaryRangeWrapper(this.divOp,t,r,n);case f.AstNodeType.PLUS_UNARY_OP:t=this.evaluateAst(e.value,n);return this.unaryRangeWrapper(this.unaryPlusOp,t,n);case f.AstNodeType.MINUS_UNARY_OP:r=this.evaluateAst(e.value,n);return this.unaryRangeWrapper(this.unaryMinusOp,r,n);case f.AstNodeType.PERCENT_OP:t=this.evaluateAst(e.value,n);return this.unaryRangeWrapper(this.percentOp,t,n);case f.AstNodeType.FUNCTION_CALL:return"valid"===this.config.licenseKeyValidityState||p.FunctionRegistry.functionIsProtected(e.procedureName)?void 0!==(r=this.functionRegistry.getFunction(e.procedureName))?r(e,new g.InterpreterState(n.formulaAddress,n.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),n.formulaVertex)):new v.CellError(v.ErrorType.NAME,b.ErrorMessage.FunctionName(e.procedureName)):new v.CellError(v.ErrorType.LIC,b.ErrorMessage.LicenseKey(this.config.licenseKeyValidityState));case f.AstNodeType.NAMED_EXPRESSION:t=this.namedExpressions.nearestNamedExpression(e.expressionName,n.formulaAddress.sheet);return t?this.dependencyGraph.getCellValue(t.address):new v.CellError(v.ErrorType.NAME,b.ErrorMessage.NamedExpressionName(e.expressionName));case f.AstNodeType.CELL_RANGE:if(!this.rangeSpansOneSheet(e))return new v.CellError(v.ErrorType.REF,b.ErrorMessage.RangeManySheets);r=d.AbsoluteCellRange.fromCellRange(e,n.formulaAddress),t=this.dependencyGraph.getArray(r);if(t){t=t.array;if(t instanceof h.NotComputedArray)throw new Error("Array should be already computed");if(t instanceof v.CellError)return t;if(t instanceof h.ArrayValue)return C.SimpleRangeValue.fromRange(t.raw(),r,this.dependencyGraph);throw new Error("Unknown array")}return C.SimpleRangeValue.onlyRange(r,this.dependencyGraph);case f.AstNodeType.COLUMN_RANGE:return this.rangeSpansOneSheet(e)?(t=d.AbsoluteColumnRange.fromColumnRange(e,n.formulaAddress),C.SimpleRangeValue.onlyRange(t,this.dependencyGraph)):new v.CellError(v.ErrorType.REF,b.ErrorMessage.RangeManySheets);case f.AstNodeType.ROW_RANGE:return this.rangeSpansOneSheet(e)?(r=d.AbsoluteRowRange.fromRowRangeAst(e,n.formulaAddress),C.SimpleRangeValue.onlyRange(r,this.dependencyGraph)):new v.CellError(v.ErrorType.REF,b.ErrorMessage.RangeManySheets);case f.AstNodeType.PARENTHESIS:return this.evaluateAst(e.expression,n);case f.AstNodeType.ARRAY:{let t=void 0;var i=[];for(const u of e.args){let e=void 0;var o=[];for(const c of u){var s=(0,E.coerceToRange)(this.evaluateAst(c,n)),a=s.height();if(void 0===e)e=a,o.push(...s.data);else{if(e!==a)return new v.CellError(v.ErrorType.REF,b.ErrorMessage.SizeMismatch);for(let e=0;e<a;e++)o[e].push(...s.data[e])}}var l=o[0].length;if(void 0===t)t=l;else if(t!==l)return new v.CellError(v.ErrorType.REF,b.ErrorMessage.SizeMismatch);i.push(...o)}return C.SimpleRangeValue.onlyValues(i)}case f.AstNodeType.ERROR_WITH_RAW_INPUT:case f.AstNodeType.ERROR:return e.error}}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(t,e,n){return(e=e instanceof C.SimpleRangeValue&&!n.arraysFlag?null!=(n=(0,E.coerceRangeToScalar)(e,n))?n:new v.CellError(v.ErrorType.VALUE,b.ErrorMessage.ScalarExpected):e)instanceof v.CellError?e:e instanceof C.SimpleRangeValue?(n=e.data.map(e=>e.map(t)),C.SimpleRangeValue.onlyValues(n)):t(e)}binaryRangeWrapper(n,r,i,e){var t;if((r=r instanceof C.SimpleRangeValue&&!e.arraysFlag?null!=(t=(0,E.coerceRangeToScalar)(r,e))?t:new v.CellError(v.ErrorType.VALUE,b.ErrorMessage.ScalarExpected):r)instanceof v.CellError)return r;if((i=i instanceof C.SimpleRangeValue&&!e.arraysFlag?null!=(t=(0,E.coerceRangeToScalar)(i,e))?t:new v.CellError(v.ErrorType.VALUE,b.ErrorMessage.ScalarExpected):i)instanceof v.CellError)return i;if(r instanceof C.SimpleRangeValue||i instanceof C.SimpleRangeValue){if(!(r instanceof C.SimpleRangeValue)){if(i.isAdHoc()){var o=i.data;for(let t=0;t<o.length;t++)for(let e=0;e<o[0].length;e++)o[t][e]=n(r,o[t][e]);return C.SimpleRangeValue.onlyValues(o)}r=C.SimpleRangeValue.fromScalar(r)}if(!(i instanceof C.SimpleRangeValue)){if(r.isAdHoc()){var s=r.data;for(let t=0;t<s.length;t++)for(let e=0;e<s[0].length;e++)s[t][e]=n(s[t][e],i);return C.SimpleRangeValue.onlyValues(s)}i=C.SimpleRangeValue.fromScalar(i)}if(r.width()===i.width()&&r.height()===i.height()){if(r.isAdHoc()){var a=r.data,l=i.data;for(let t=0;t<a.length;t++)for(let e=0;e<a[0].length;e++)a[t][e]=n(a[t][e],l[t][e]);return C.SimpleRangeValue.onlyValues(a)}if(i.isAdHoc()){var u=r.data,c=i.data;for(let t=0;t<u.length;t++)for(let e=0;e<u[0].length;e++)c[t][e]=n(u[t][e],c[t][e]);return C.SimpleRangeValue.onlyValues(c)}}var d=Math.max(r.width(),i.width()),h=Math.max(r.height(),i.height()),f=Array(h);for(let e=0;e<h;e++)f[e]=Array(d);for(let t=0;t<h;t++){var p=1!==r.height()?t:0,g=1!==i.height()?t:0;for(let e=0;e<d;e++){var m=1!==r.width()?e:0,y=1!==i.width()?e:0;p<r.height()&&g<i.height()&&m<r.width()&&y<i.width()?f[t][e]=n(r.data[p][m],i.data[g][y]):f[t][e]=new v.CellError(v.ErrorType.NA)}}return C.SimpleRangeValue.onlyValues(f)}return n(r,i)}}function y(e,t){return t instanceof v.CellError?t:e(t)}function w(e,t,n){return t instanceof v.CellError?t:n instanceof v.CellError?n:e(t,n)}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{CriterionBuilder:()=>r,CriterionType:()=>o,buildCriterion:()=>a,buildCriterionLambda:()=>i});var o,s=n(70);(t=o=o||{}).GREATER_THAN="GREATER_THAN",t.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",t.LESS_THAN="LESS_THAN",t.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",t.NOT_EQUAL="NOT_EQUAL",t.EQUAL="EQUAL";const a=(e,t)=>({operator:e,value:t});class r{constructor(e){var t;this.trueString=null!=(t=null==(t=e.translationPackage.getMaybeFunctionTranslation("TRUE"))?void 0:t.toLowerCase())?t:"true",this.falseString=null!=(e=null==(t=e.translationPackage.getMaybeFunctionTranslation("FALSE"))?void 0:t.toLowerCase())?e:"false"}fromCellValue(e,t){if("string"==typeof e||"boolean"==typeof e||"number"==typeof e){var n=this.parseCriterion(e,t);if(void 0!==n)return{raw:e,lambda:i(n,t)}}}parseCriterion(n,r){if("number"==typeof n||"boolean"==typeof n)return a(o.EQUAL,n);if("string"==typeof n){var i=l.exec(n);let e,t;e=i?(t=function(e){switch(e){case">":return o.GREATER_THAN;case">=":return o.GREATER_THAN_OR_EQUAL;case"<":return o.LESS_THAN;case"<=":return o.LESS_THAN_OR_EQUAL;case"<>":return o.NOT_EQUAL;case"=":return o.EQUAL;default:return}}(i[1]),i[2]):(t=o.EQUAL,n);i=r.coerceToMaybeNumber(e),n=e.toLowerCase()===this.trueString||e.toLowerCase()!==this.falseString&&void 0;if(void 0===t)return;if(""===e)return a(t,null);if(void 0!==i)return a(t,(0,s.getRawValue)(i));if(t===o.EQUAL||t===o.NOT_EQUAL)return a(t,null!=n?n:e)}}}const l=/([<>=]+)(.*)/;const i=(t,n)=>{switch(t.operator){case o.GREATER_THAN:return"number"==typeof t.value?e=>"number"==typeof e&&0<n.floatCmp(e,t.value):e=>!1;case o.GREATER_THAN_OR_EQUAL:return"number"==typeof t.value?e=>"number"==typeof e&&0<=n.floatCmp(e,t.value):e=>!1;case o.LESS_THAN:return"number"==typeof t.value?e=>"number"==typeof e&&n.floatCmp(e,t.value)<0:e=>!1;case o.LESS_THAN_OR_EQUAL:return"number"==typeof t.value?e=>"number"==typeof e&&n.floatCmp(e,t.value)<=0:e=>!1;case o.EQUAL:return"number"==typeof t.value?e=>{return"number"==typeof e?0===n.floatCmp(e,t.value):"string"==typeof e&&""!==e&&void 0!==(e=n.coerceToMaybeNumber(e))&&0===n.floatCmp(e,t.value)}:"string"==typeof t.value?n.eqMatcherFunction(t.value):"boolean"==typeof t.value?e=>"boolean"==typeof e&&e===t.value:e=>e===s.EmptyValue;case o.NOT_EQUAL:return"number"==typeof t.value?e=>{return"number"==typeof e?0!==n.floatCmp(e,t.value):"string"!=typeof e||""===e||void 0===(e=n.coerceToMaybeNumber(e))||0!==n.floatCmp(e,t.value)}:"string"==typeof t.value?n.neqMatcherFunction(t.value):"boolean"==typeof t.value?e=>"boolean"!=typeof e||e!==t.value:e=>e!==s.EmptyValue}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{LazilyTransformingAstService:()=>i});var r=n(133),s=n(72);class i{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return void 0!==this.combinedTransformer?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new r.CombinedTransformer(e)}commitCombinedMode(){if(void 0===this.combinedTransformer)throw Error("Combined mode wasn't started");return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(t,n,r){this.stats.start(s.StatType.TRANSFORM_ASTS_POSTPONED);for(let e=r;e<this.transformations.length;e++){var i=this.transformations[e],[i,o]=(i.isIrreversible()&&(this.undoRedo.storeDataForVersion(e,n,this.parser.computeHashFromAst(t)),this.parser.rememberNewAst(t)),i.transformSingleAst(t,n));t=i,n=o}r=this.parser.rememberNewAst(t);return this.stats.end(s.StatType.TRANSFORM_ASTS_POSTPONED),[r,n,this.transformations.length]}*getTransformationsFrom(t,n){for(let e=t;e<this.transformations.length;e++){var r=this.transformations[e];n&&!n(r)||(yield r)}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{CombinedTransformer:()=>r});class r{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(t,n){this.transformations.forEach(e=>e.performEagerTransformations(t,n))}transformSingleAst(e,t){let[n,r]=[e,t];return this.transformations.forEach(e=>{[n,r]=e.transformSingleAst(n,r)}),[n,r]}isIrreversible(){return!0}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{buildColumnSearchStrategy:()=>function(e,t,n){return t.useColumnIndex?new i.ColumnIndex(e,t,n):new r.ColumnBinarySearch(e)}});var r=n(135),i=n(138)},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ColumnBinarySearch:()=>r});class r extends n(136).AdvancedFind{constructor(e){super(e),this.dependencyGraph=e}add(e,t){}remove(e,t){}change(e,t,n){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,t,n,r){}removeValues(e){}find(e,t,n){return this.basicFind(e,t,"row",n)}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{AdvancedFind:()=>r});var i=n(70),s=n(95),a=n(137);class r{constructor(e){this.dependencyGraph=e}advancedFind(t,e){let n;var r=e.range;n=void 0===r?e.valuesFromTopLeftCorner():this.dependencyGraph.computeListOfValuesInRange(r);for(let e=0;e<n.length;e++)if(t((0,i.getRawValue)(n[e])))return e;return-1}basicFind(e,t,n,{ordering:r,matchExactly:i}){var e="string"==typeof e?(0,s.forceNormalizeString)(e):e,o=t.range;return void 0===o?this.findNormalizedValue(e,t.valuesFromTopLeftCorner()):"none"===r?this.findNormalizedValue(e,this.dependencyGraph.computeListOfValuesInRange(o)):(0,a.findLastOccurrenceInOrderedRange)(e,o,{searchCoordinate:n,orderingDirection:r,matchExactly:i},this.dependencyGraph)}findNormalizedValue(e,t){return t.map(i.getRawValue).map(e=>"string"==typeof e?(0,s.forceNormalizeString)(e):e).indexOf(e)}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{compare:()=>m,findLastMatchingIndex:()=>g,findLastOccurrenceInOrderedArray:()=>function(t,n,e="asc"){e="asc"===e?e=>0<=m(t,n[e]):e=>0<=-m(t,n[e]);return g(e,0,n.length-1)},findLastOccurrenceInOrderedRange:()=>function(t,n,{searchCoordinate:e,orderingDirection:r,matchExactly:i},o){const s=n.start[e],a="col"===e?n.effectiveEndColumn(o):n.effectiveEndRow(o),l="col"===e?e=>(0,f.getRawValue)(o.getCellValue((0,h.simpleCellAddress)(n.sheet,e,n.start.row))):e=>(0,f.getRawValue)(o.getCellValue((0,h.simpleCellAddress)(n.sheet,n.start.col,e))),u="asc"===r?(e,t)=>m(e,t):(e,t)=>-m(e,t),c=g(e=>0<=u(t,l(e)),s,a),d=l(c);if(c===p||typeof d!=typeof t)return p;if(i&&d!==t)return p;return c-s}});var h=n(3),f=n(70);const p=-1;function g(e,t,n){let r=t,i=n;for(;r<i;){var o=Math.ceil((r+i)/2);e(o)?r=o:i=o-1}return r===i&&e(r)?r:p}function m(e,t){return typeof e==typeof t?e===f.EmptyValue?0:e<t?-1:t<e?1:0:e===f.EmptyValue||t!==f.EmptyValue&&(t instanceof h.CellError||"number"==typeof e&&"string"==typeof t||"number"==typeof e&&"boolean"==typeof t||("string"!=typeof e||"number"!=typeof t)&&"string"==typeof e&&"boolean"==typeof t)?-1:1}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ColumnIndex:()=>d,findInOrderedArray:()=>h});var a=n(3),s=n(117),l=n(121),o=n(95),i=n(70),u=n(69),c=n(72),r=n(135);class d{constructor(e,t,n){this.dependencyGraph=e,this.config=t,this.stats=n,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new r.ColumnBinarySearch(e)}add(e,t){if(!(e===i.EmptyValue||e instanceof a.CellError))if(e instanceof u.SimpleRangeValue)for(var[n,r]of e.entriesFromTopLeftCorner(t))this.addSingleCellValue((0,i.getRawValue)(n),r);else this.addSingleCellValue(e,t)}remove(e,t){if(void 0!==e)if(e instanceof u.SimpleRangeValue)for(var[n,r]of e.entriesFromTopLeftCorner(t))this.removeSingleValue((0,i.getRawValue)(n),r);else this.removeSingleValue(e,t)}change(e,t,n){e!==t&&(this.remove(e,n),this.add(t,n))}applyChanges(e){for(const t of e)void 0!==t.oldValue&&this.change((0,i.getRawValue)(t.oldValue),(0,i.getRawValue)(t.value),t.address)}moveValues(e,t,n,r){for(var[i,o]of e){var s=(0,a.movedSimpleCellAddress)(o,r,t,n);this.remove(i,o),this.add(i,s)}}removeValues(e){for(var[t,n]of e)this.remove(t,n)}find(e,t,{ordering:n,matchExactly:r}){var i=this.findUsingColumnIndex(e,t,!0===r?"findFirst":"findLast");return void 0!==i?i:this.binarySearchStrategy.find(e,t,{ordering:n,matchExactly:r})}findUsingColumnIndex(e,t,n){var r,t=t.range;if(void 0!==t)return this.ensureRecentData(t.sheet,t.start.col,e),(r=this.getColumnMap(t.sheet,t.start.col))?(e="string"==typeof e?(0,o.forceNormalizeString)(e):e,(r=r.get(e))&&r.index&&0!==r.index.length&&void 0!==(e=d.findRowBelongingToRange(r,t,n))?e-t.start.row:void 0):-1}static findRowBelongingToRange(e,t,n){var r=t.start.row,t=t.end.row,n="findFirst"===n?h(r,e.index,"upperBound"):h(t,e.index,"lowerBound");return-1!==n&&r<=(r=e.index[n])&&r<=t?r:void 0}advancedFind(e,t){return this.binarySearchStrategy.advancedFind(e,t)}addColumns(e){var t=this.index.get(e.sheet);t&&t.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){var t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,t){this.index.has(e)||this.index.set(e,[]);e=this.index.get(e);let n=e[t];return n||(n=new Map,e[t]=n),n}getValueIndex(e,t,n){var r=this.getColumnMap(e,t);let i=this.getColumnMap(e,t).get(n);return i||(i={version:this.transformingService.version(),index:[]},r.set(n,i)),i}ensureRecentData(t,e,n){var r=this.getValueIndex(t,e,n),i=this.transformingService.version();if(r.version!==i){for(const o of this.transformingService.getTransformationsFrom(r.version,e=>e.sheet===t&&(e instanceof s.AddRowsTransformer||e instanceof l.RemoveRowsTransformer)))o instanceof s.AddRowsTransformer?this.addRows(e,o.rowsSpan,n):o instanceof l.RemoveRowsTransformer&&this.removeRows(e,o.rowsSpan,n);r.version=i}}addSingleCellValue(t,n){this.stats.measure(c.StatType.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(n.sheet,n.col,t),"string"==typeof t&&(t=(0,o.forceNormalizeString)(t));var e=this.getValueIndex(n.sheet,n.col,t);d.addValue(e,n.row)})}removeSingleValue(r,i){this.stats.measure(c.StatType.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(i.sheet,i.col,r);var e,t=this.getColumnMap(i.sheet,i.col),n=("string"==typeof r&&(r=(0,o.forceNormalizeString)(r)),t.get(r));n&&(-1<(e=h(i.row,n.index))&&n.index.splice(e,1),0===n.index.length&&t.delete(r),0===t.size)&&delete this.index.get(i.sheet)[i.col]})}addRows(e,t,n){e=this.getValueIndex(t.sheet,e,n);d.shiftRows(e,t.rowStart,t.numberOfRows)}removeRows(e,t,n){e=this.getValueIndex(t.sheet,e,n);d.removeRowsFromValues(e,t),d.shiftRows(e,t.rowEnd+1,-t.numberOfRows)}static addValue(e,t){var n=h(t,e.index,"lowerBound");e.index[n]!==t&&e.index.splice(n+1,0,t)}static removeRowsFromValues(e,t){var n=h(t.rowStart,e.index,"upperBound"),r=h(t.rowEnd,e.index,"lowerBound");-1<n&&-1<r&&n<=r&&e.index[n]<=t.rowEnd&&e.index.splice(n,r-n+1)}static shiftRows(t,n,r){n=h(n,t.index,"upperBound");if(-1!==n)for(let e=n;e<t.index.length;++e)t.index[e]+=r}}function h(e,t,n="upperBound"){let r=0,i=t.length-1;for(;r<=i;){var o=Math.floor((r+i)/2);if(e>t[o])r=o+1;else{if(!(e<t[o]))return o;i=o-1}}n="lowerBound"===n?i:r;return 0<=n&&n<=t.length?n:-1}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{NumberLiteralHelper:()=>r});class r{constructor(e){this.config=e;var e="."===this.config.thousandSeparator?"\\"+this.config.thousandSeparator:this.config.thousandSeparator,t="."===this.config.decimalSeparator?"\\"+this.config.decimalSeparator:this.config.decimalSeparator;this.numberPattern=new RegExp(`^([+-]?((${t}\\d+)|(\\d+(${e}\\d{3,})*(${t}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=new RegExp(""+e,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e))return e=this.numericStringToNumber(e),isNaN(e)?void 0:e}numericStringToNumber(e){e=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(e)}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Serialization:()=>o});var l=n(3),i=n(4),r=n(7);class o{constructor(e,t,n){this.dependencyGraph=e,this.unparser=t,this.exporter=n}getCellHyperlink(e){e=this.dependencyGraph.getCell(e);if(e instanceof i.FormulaCellVertex){e=e.getFormula(this.dependencyGraph.lazilyTransformingAstService);if("HYPERLINK"===e.procedureName)return e.hyperlink}}getCellFormula(e,t){var n=this.dependencyGraph.getCell(e);if(n instanceof i.FormulaCellVertex)return r=n.getFormula(this.dependencyGraph.lazilyTransformingAstService),this.unparser.unparse(r,t=null!=t?t:e);if(n instanceof i.ArrayVertex){var r=n.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(r.row!==e.row||r.col!==e.col||r.sheet!==e.sheet)return;t=null!=t?t:e;r=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(void 0!==r)return this.unparser.unparse(r,t)}else if(n instanceof i.ParsingErrorVertex)return n.getFormula()}getCellSerialized(e,t){return null!=(t=this.getCellFormula(e,t))?t:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,e=>this.getCellValue(e))}getSheetFormulas(e){return this.genericSheetGetter(e,e=>this.getCellFormula(e))}genericSheetGetter(n,r){var i=this.dependencyGraph.getSheetHeight(n),o=this.dependencyGraph.getSheetWidth(n),s=new Array(i);for(let t=0;t<i;t++){s[t]=new Array(o);for(let e=0;e<o;e++){var a=(0,l.simpleCellAddress)(n,e,t);s[t][e]=r(a)}for(let e=o-1;0<=e&&(null===s[t][e]||void 0===s[t][e]);e--)s[t].pop()}for(let e=i-1;0<=e&&0===s[e].length;e--)s.pop();return s}genericAllSheetsGetter(e){var t={};for(const r of this.dependencyGraph.sheetMapping.displayNames()){var n=this.dependencyGraph.sheetMapping.fetch(r);t[r]=e(n)}return t}getSheetSerialized(e){return this.genericSheetGetter(e,e=>this.getCellSerialized(e))}getAllSheetsValues(){return this.genericAllSheetsGetter(e=>this.getSheetValues(e))}getAllSheetsFormulas(){return this.genericAllSheetsGetter(e=>this.getSheetFormulas(e))}getAllSheetsSerialized(){return this.genericAllSheetsGetter(e=>this.getSheetSerialized(e))}getAllNamedExpressionsSerialized(){const t=[];let e=0;for(const r of this.dependencyGraph.sheetMapping.displayNames()){var n=this.dependencyGraph.sheetMapping.fetch(r);t[n]=e,e++}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map(e=>({name:e.expression.displayName,expression:this.getCellSerialized(e.expression.address),scope:void 0!==e.scope?t[e.scope]:void 0,options:e.expression.options}))}withNewConfig(e,t){e=new r.Unparser(e,(0,r.buildLexerConfig)(e),this.dependencyGraph.sheetMapping.fetchDisplayName,t);return new o(this.dependencyGraph,e,this.exporter)}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{objectDestroy:()=>function(e){for(var[t,n]of Object.entries(e))n instanceof Function?e[t]=function(e){return()=>{throw new Error(`The "${e}" method cannot be called because this HyperFormula instance has been destroyed`)}}(n):delete e[t]}})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Emitter:()=>i,Events:()=>r});var r,t=n(143);(n=r=r||{}).SheetAdded="sheetAdded",n.SheetRemoved="sheetRemoved",n.SheetRenamed="sheetRenamed",n.NamedExpressionAdded="namedExpressionAdded",n.NamedExpressionRemoved="namedExpressionRemoved",n.ValuesUpdated="valuesUpdated",n.EvaluationSuspended="evaluationSuspended",n.EvaluationResumed="evaluationResumed";class i extends t.TinyEmitter{emit(e,...t){return super.emit(e,...t),this}}},e=>{function t(){}t.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var r=this;function i(){r.off(e,i),t.apply(n,arguments)}return i._=t,this.on(e,i,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,i=n.length;r<i;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],i=[];if(r&&t)for(var o=0,s=r.length;o<s;o++)r[o].fn!==t&&r[o].fn._!==t&&i.push(r[o]);return i.length?n[e]=i:delete n[e],this}},e.exports=t,e.exports.TinyEmitter=t},(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ADDRESS:"ADDRESS",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",HYPERLINK:"HYPERLINK",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",IFS:"IFS",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{FunctionArgumentType:()=>r.FunctionArgumentType,FunctionPlugin:()=>r.FunctionPlugin});var r=n(94)},(P,e,t)=>{"use strict";t.r(e),t.d(e,{AbsPlugin:()=>i.AbsPlugin,AddressPlugin:()=>n.AddressPlugin,ArrayPlugin:()=>r.ArrayPlugin,BitShiftPlugin:()=>o.BitShiftPlugin,BitwiseLogicOperationsPlugin:()=>s.BitwiseLogicOperationsPlugin,BooleanPlugin:()=>a.BooleanPlugin,CharPlugin:()=>l.CharPlugin,CodePlugin:()=>u.CodePlugin,ComplexPlugin:()=>j.ComplexPlugin,ConditionalAggregationPlugin:()=>D.ConditionalAggregationPlugin,CountBlankPlugin:()=>c.CountBlankPlugin,CountUniquePlugin:()=>d.CountUniquePlugin,DateTimePlugin:()=>h.DateTimePlugin,DegreesPlugin:()=>f.DegreesPlugin,DeltaPlugin:()=>p.DeltaPlugin,ExpPlugin:()=>g.ExpPlugin,FinancialPlugin:()=>m.FinancialPlugin,FormulaTextPlugin:()=>y.FormulaTextPlugin,HyperlinkPlugin:()=>v.HyperlinkPlugin,InformationPlugin:()=>b.InformationPlugin,IsEvenPlugin:()=>E.IsEvenPlugin,IsOddPlugin:()=>C.IsOddPlugin,LogarithmPlugin:()=>w.LogarithmPlugin,LookupPlugin:()=>H.LookupPlugin,MathConstantsPlugin:()=>S.MathConstantsPlugin,MathPlugin:()=>$.MathPlugin,MatrixPlugin:()=>T.MatrixPlugin,MedianPlugin:()=>R.MedianPlugin,ModuloPlugin:()=>A.ModuloPlugin,NumericAggregationPlugin:()=>_.NumericAggregationPlugin,PowerPlugin:()=>N.PowerPlugin,RadiansPlugin:()=>x.RadiansPlugin,RadixConversionPlugin:()=>O.RadixConversionPlugin,RandomPlugin:()=>I.RandomPlugin,RomanPlugin:()=>U.RomanPlugin,RoundingPlugin:()=>M.RoundingPlugin,SimpleArithmerticPlugin:()=>V.SimpleArithmerticPlugin,SqrtPlugin:()=>k.SqrtPlugin,StatisticalAggregationPlugin:()=>z.StatisticalAggregationPlugin,StatisticalPlugin:()=>W.StatisticalPlugin,SumprodPlugin:()=>L.SumprodPlugin,TextPlugin:()=>F.TextPlugin,TrigonometryPlugin:()=>B.TrigonometryPlugin});var n=t(147),r=t(148),i=t(149),o=t(150),s=t(151),a=t(152),l=t(153),u=t(154),c=t(155),d=t(156),h=t(157),f=t(158),p=t(159),g=t(160),m=t(161),y=t(162),v=t(163),b=t(164),E=t(165),C=t(166),w=t(167),S=t(168),T=t(169),R=t(170),A=t(171),_=t(172),N=t(173),x=t(174),O=t(175),I=t(176),M=t(177),k=t(178),D=t(179),L=t(182),F=t(183),B=t(184),H=t(185),U=t(187),V=t(188),W=t(189),$=t(192),j=t(193),z=t(194)},(e,t,n)=>{"use strict";n.r(t),n.d(t,{AddressPlugin:()=>r});var l,u=n(8),t=n(94),i=n(3),o=n(61);(n=l=l||{})[n.FullyAbsolute=1]="FullyAbsolute",n[n.RowAbsoluteColRelative=2]="RowAbsoluteColRelative",n[n.RowRelativeColAbsolute=3]="RowRelativeColAbsolute",n[n.FullyRelative=4]="FullyRelative";class r extends t.FunctionPlugin{verifyAddressArguments(e,t,n,r){if(r){if(e<1||t<1)return new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.LessThanOne)}else if(l.FullyAbsolute==n){if(e<1||t<1)return new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.LessThanOne)}else if(l.RowAbsoluteColRelative==n){if(e<1)return new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.LessThanOne)}else if(l.RowRelativeColAbsolute==n&&t<1)return new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.LessThanOne)}address(e,t){return this.runFunction(e.args,t,this.metadata("ADDRESS"),(e,t,n,r,i)=>{var o=this.verifyAddressArguments(e,t,n,r);if(void 0!==o)return o;o=(0,u.columnIndexToLabel)(t-1);let s="";null!=i&&(s=i+"!");var i=0==t?"C":`C[${t}]`,a=0==e?"R":`R[${e}]`;return l.FullyRelative==n?r?""+s+o+e:s+a+i:l.RowRelativeColAbsolute==n?r?s+"$"+o+e:s+a+"C"+t:l.RowAbsoluteColRelative==n?r?""+s+o+"$"+e:s+"R"+e+i:r?s+`$${o}$`+e:s+`R${e}C`+t})}}r.implementedFunctions={ADDRESS:{method:"address",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,defaultValue:1,minValue:1,maxValue:4},{argumentType:t.FunctionArgumentType.BOOLEAN,optionalArg:!0,defaultValue:!0},{argumentType:t.FunctionArgumentType.STRING,optionalArg:!0}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ArrayPlugin:()=>r});var o=n(1),a=n(3),l=n(61),s=n(7),u=n(95),c=n(93),d=n(69),t=n(94);class r extends t.FunctionPlugin{arrayformula(e,t){return this.runFunction(e.args,t,this.metadata("ARRAYFORMULA"),e=>e)}arrayformulaArraySize(e,t){if(1!==e.args.length)return o.ArraySize.error();const n=this.metadata("ARRAYFORMULA");return e.args.map(e=>{return this.arraySizeForAst(e,new c.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(e=null===n||void 0===n?void 0:n.arrayFunction)&&e))})[0]}arrayconstrain(e,t){return this.runFunction(e.args,t,this.metadata("ARRAY_CONSTRAIN"),(e,t,n)=>{t=Math.min(t,e.height()),n=Math.min(n,e.width());var r=e.data,i=[];for(let e=0;e<t;e++)i.push(r[e].slice(0,n));return d.SimpleRangeValue.onlyValues(i)})}arrayconstrainArraySize(e,t){if(3!==e.args.length)return o.ArraySize.error();const n=this.metadata("ARRAY_CONSTRAIN");let{height:r,width:i}=e.args.map(e=>{return this.arraySizeForAst(e,new c.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(e=null===n||void 0===n?void 0:n.arrayFunction)&&e))})[0];return e.args[1].type===s.AstNodeType.NUMBER&&(r=Math.min(r,e.args[1].value)),e.args[2].type===s.AstNodeType.NUMBER&&(i=Math.min(i,e.args[2].value)),r<1||i<1||!Number.isInteger(r)||!Number.isInteger(i)?o.ArraySize.error():new o.ArraySize(i,r)}filter(e,t){return this.runFunction(e.args,t,this.metadata("FILTER"),(e,...r)=>{for(const n of r)if(e.width()!==n.width()||e.height()!==n.height())return new a.CellError(a.ErrorType.NA,l.ErrorMessage.EqualLength);if(1<e.width()&&1<e.height())return new a.CellError(a.ErrorType.NA,l.ErrorMessage.WrongDimension);var i=e.data,t=[];for(let n=0;n<e.height();n++){var o=[];for(let t=0;t<e.width();t++){let e=!0;for(const s of r)if(!0!==(0,u.coerceScalarToBoolean)(s.data[n][t])){e=!1;break}e&&o.push(i[n][t])}0<o.length&&t.push(o)}return 0<t.length?d.SimpleRangeValue.onlyValues(t):new a.CellError(a.ErrorType.NA,l.ErrorMessage.EmptyRange)})}filterArraySize(e,t){if(e.args.length<=1)return o.ArraySize.error();const n=this.metadata("FILTER");var e=e.args.map(e=>{return this.arraySizeForAst(e,new c.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(e=null===n||void 0===n?void 0:n.arrayFunction)&&e))}),r=Math.max(...e.map(e=>e.width)),e=Math.max(...e.map(e=>e.height));return new o.ArraySize(r,e)}}r.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:t.FunctionArgumentType.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.INTEGER,minValue:1},{argumentType:t.FunctionArgumentType.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}],repeatLastArgs:1}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{AbsPlugin:()=>r});t=n(94);class r extends t.FunctionPlugin{abs(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}r.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{BitShiftPlugin:()=>s});var r=n(3),i=n(61),t=n(94);const o=0xffffffffffff;class s extends t.FunctionPlugin{bitlshift(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),a)}bitrshift(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),l)}}function a(e,t){return t<0?l(e,-t):u(e*Math.pow(2,t))}function l(e,t){return t<0?a(e,-t):u(Math.floor(e/Math.pow(2,t)))}function u(e){return e>o?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.BitshiftLong):e}s.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:t.FunctionArgumentType.INTEGER,minValue:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:-53,maxValue:53}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:t.FunctionArgumentType.INTEGER,minValue:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:-53,maxValue:53}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{BitwiseLogicOperationsPlugin:()=>r});t=n(94);class r extends t.FunctionPlugin{bitand(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),(e,t)=>e&t)}bitor(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),(e,t)=>e|t)}bitxor(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),(e,t)=>e^t)}}r.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:t.FunctionArgumentType.INTEGER,minValue:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:t.FunctionArgumentType.INTEGER,minValue:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:t.FunctionArgumentType.INTEGER,minValue:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:0}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{BooleanPlugin:()=>r});var i=n(3),o=n(61),t=n(94);class r extends t.FunctionPlugin{literalTrue(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),()=>!0)}literalFalse(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),()=>!1)}conditionalIf(e,t){return this.runFunction(e.args,t,this.metadata("IF"),(e,t,n)=>e?t:n)}ifs(e,t){return this.runFunction(e.args,t,this.metadata("IFS"),(...t)=>{for(let e=0;e<t.length;e+=2)if(t[e])return t[e+1];return new i.CellError(i.ErrorType.NA,o.ErrorMessage.NoConditionMet)})}and(e,t){return this.runFunction(e.args,t,this.metadata("AND"),(...e)=>e.filter(e=>void 0!==e).every(e=>!!e))}or(e,t){return this.runFunction(e.args,t,this.metadata("OR"),(...e)=>e.filter(e=>void 0!==e).some(e=>e))}not(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),e=>!e)}xor(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),(...e)=>{let t=0;return e.filter(e=>void 0!==e).forEach(e=>{e&&t++}),t%2==1})}switch(e,t){return this.runFunction(e.args,t,this.metadata("SWITCH"),(e,...t)=>{var n=t.length;let r=0;for(;r+1<n;r+=2)if(!(t[r]instanceof i.CellError)&&this.arithmeticHelper.eq(e,t[r]))return t[r+1];return r<n?t[r]:new i.CellError(i.ErrorType.NA,o.ErrorMessage.NoDefault)})}iferror(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),(e,t)=>e instanceof i.CellError?t:e)}ifna(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),(e,t)=>e instanceof i.CellError&&e.type===i.ErrorType.NA?t:e)}choose(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),(e,...t)=>e>t.length?new i.CellError(i.ErrorType.NUM,o.ErrorMessage.Selector):t[e-1])}}r.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:t.FunctionArgumentType.BOOLEAN},{argumentType:t.FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:t.FunctionArgumentType.SCALAR,defaultValue:!1,passSubtype:!0}]},IFS:{method:"ifs",parameters:[{argumentType:t.FunctionArgumentType.BOOLEAN},{argumentType:t.FunctionArgumentType.SCALAR,passSubtype:!0}],repeatLastArgs:2},AND:{method:"and",parameters:[{argumentType:t.FunctionArgumentType.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:t.FunctionArgumentType.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:t.FunctionArgumentType.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:t.FunctionArgumentType.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:t.FunctionArgumentType.NOERROR},{argumentType:t.FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:t.FunctionArgumentType.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:t.FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:t.FunctionArgumentType.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:t.FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:t.FunctionArgumentType.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:t.FunctionArgumentType.INTEGER,minValue:1},{argumentType:t.FunctionArgumentType.SCALAR,passSubtype:!0}],repeatLastArgs:1}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{CharPlugin:()=>o});var r=n(3),i=n(61),t=n(94);class o extends t.FunctionPlugin{char(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),e=>e<1||256<=e?new r.CellError(r.ErrorType.VALUE,i.ErrorMessage.CharacterCodeBounds):String.fromCharCode(Math.trunc(e)))}unichar(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),e=>e<1||1114112<=e?new r.CellError(r.ErrorType.VALUE,i.ErrorMessage.CharacterCodeBounds):String.fromCodePoint(Math.trunc(e)))}}o.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{CodePlugin:()=>o});var r=n(3),i=n(61),t=n(94);class o extends t.FunctionPlugin{code(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),e=>0===e.length?new r.CellError(r.ErrorType.VALUE,i.ErrorMessage.EmptyString):e.charCodeAt(0))}unicode(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),e=>{return null!=(e=e.codePointAt(0))?e:new r.CellError(r.ErrorType.VALUE,i.ErrorMessage.EmptyString)})}}o.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:t.FunctionArgumentType.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:t.FunctionArgumentType.STRING}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{CountBlankPlugin:()=>i});var r=n(70),t=n(94);class i extends t.FunctionPlugin{countblank(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),(...e)=>{let t=0;return e.forEach(e=>{e===r.EmptyValue&&t++}),t})}}i.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}],repeatLastArgs:1,expandRanges:!0}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{CountUniquePlugin:()=>r});var i=n(3),t=n(94);class r extends t.FunctionPlugin{countunique(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),(...e)=>{var t=new Set,n=new Set;for(const r of e)r instanceof i.CellError?n.add(r.type):""!==r&&t.add(r);return t.size+n.size})}}r.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}],repeatLastArgs:1,expandRanges:!0}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{DateTimePlugin:()=>i});var l=n(3),o=n(102),a=n(61),r=n(104),s=n(70),t=n(94);class i extends t.FunctionPlugin{constructor(){super(...arguments),this.isoweeknumCore=e=>{var t=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),n=this.dateTimeHelper.numberToSimpleDate(e),n=this.dateTimeHelper.dateToNumber({year:n.year,month:1,day:1}),n=this.dateTimeHelper.relativeNumberToAbsoluteNumber(n),n=n+((4-n)%7+7)%7,t=Math.floor((t-1)/7)-Math.floor((n-1)/7)+1;return 0==t?this.isoweeknumCore(e-7)+1:t},this.days360Core=(e,t,n)=>{e=this.dateTimeHelper.numberToSimpleDate(e),t=this.dateTimeHelper.numberToSimpleDate(t);let r,i;return n?(r=(0,o.toBasisEU)(e),i=(0,o.toBasisEU)(t)):[r,i]=this.dateTimeHelper.toBasisUS(e,t),360*(i.year-r.year)+30*(i.month-r.month)+i.day-r.day}}date(e,t){return this.runFunction(e.args,t,this.metadata("DATE"),(e,t,n)=>{n=Math.trunc(n),t=Math.trunc(t);let r=Math.trunc(e);r<this.dateTimeHelper.getEpochYearZero()&&(r+=this.dateTimeHelper.getEpochYearZero());e=Math.floor((t-1)/12),t-=12*e,e={year:r+=e,month:t,day:1};return this.dateTimeHelper.isValidDate(e)?(t=this.dateTimeHelper.dateToNumber(e)+(n-1),void 0===(t=this.dateTimeHelper.getWithinBounds(t))?new l.CellError(l.ErrorType.NUM,a.ErrorMessage.DateBounds):t):new l.CellError(l.ErrorType.VALUE,a.ErrorMessage.InvalidDate)})}time(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),(e,t,n)=>{e=(0,o.timeToNumber)({hours:Math.trunc(e),minutes:Math.trunc(t),seconds:Math.trunc(n)});return e<0?new l.CellError(l.ErrorType.NUM,a.ErrorMessage.NegativeTime):e%1})}eomonth(e,t){return this.runFunction(e.args,t,this.metadata("EOMONTH"),(e,t)=>{e=this.dateTimeHelper.numberToSimpleDate(e),e=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth((0,o.offsetMonth)(e,t)));return void 0===(e=this.dateTimeHelper.getWithinBounds(e))?new l.CellError(l.ErrorType.NUM,a.ErrorMessage.DateBounds):e})}day(e,t){return this.runFunction(e.args,t,this.metadata("DAY"),e=>this.dateTimeHelper.numberToSimpleDate(e).day)}days(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),(e,t)=>Math.trunc(e)-Math.trunc(t))}month(e,t){return this.runFunction(e.args,t,this.metadata("MONTH"),e=>this.dateTimeHelper.numberToSimpleDate(e).month)}year(e,t){return this.runFunction(e.args,t,this.metadata("YEAR"),e=>this.dateTimeHelper.numberToSimpleDate(e).year)}hour(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),e=>(0,o.numberToSimpleTime)((0,o.roundToNearestSecond)(e)%1).hours)}minute(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),e=>(0,o.numberToSimpleTime)((0,o.roundToNearestSecond)(e)%1).minutes)}second(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),e=>(0,o.numberToSimpleTime)((0,o.roundToNearestSecond)(e)%1).seconds)}text(e,t){return this.runFunction(e.args,t,this.metadata("TEXT"),(e,t)=>(0,r.format)(e,t,this.config,this.dateTimeHelper))}weekday(e,t){return this.runFunction(e.args,t,this.metadata("WEEKDAY"),(e,t)=>{e=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));return 3===t?(e-1)%7:void 0===(t=d.get(t))?new l.CellError(l.ErrorType.NUM,a.ErrorMessage.BadMode):(e-t)%7+1})}weeknum(e,t){return this.runFunction(e.args,t,this.metadata("WEEKNUM"),(e,t)=>{var n=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),r=this.dateTimeHelper.numberToSimpleDate(e),r=this.dateTimeHelper.dateToNumber({year:r.year,month:1,day:1}),r=this.dateTimeHelper.relativeNumberToAbsoluteNumber(r);return 21===t?this.isoweeknumCore(e):void 0===(e=d.get(t))?new l.CellError(l.ErrorType.NUM,a.ErrorMessage.BadMode):Math.floor((n-e)/7)-Math.floor((r-e)/7)+1})}isoweeknum(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,t){return this.runFunction(e.args,t,this.metadata("DATEVALUE"),e=>{e=this.dateTimeHelper.parseDateTimeFromConfigFormats(e).dateTime;return void 0===e?new l.CellError(l.ErrorType.VALUE,a.ErrorMessage.IncorrectDateTime):(0,o.instanceOfSimpleDate)(e)?((0,o.instanceOfSimpleTime)(e)?Math.trunc((0,o.timeToNumber)(e)):0)+this.dateTimeHelper.dateToNumber(e):0})}timevalue(e,t){return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),e=>{e=this.dateTimeHelper.dateStringToDateNumber(e);return void 0===e?new l.CellError(l.ErrorType.VALUE,a.ErrorMessage.IncorrectDateTime):(0,s.getRawValue)(e)%1})}now(e,t){return this.runFunction(e.args,t,this.metadata("NOW"),()=>{var e=new Date(Date.now());return(0,o.timeToNumber)({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()})+this.dateTimeHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()})})}today(e,t){return this.runFunction(e.args,t,this.metadata("TODAY"),()=>{var e=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()})})}edate(e,t){return this.runFunction(e.args,t,this.metadata("EDATE"),(e,t)=>{e=this.dateTimeHelper.numberToSimpleDate(e),e=(0,o.truncateDayInMonth)((0,o.offsetMonth)(e,t)),t=this.dateTimeHelper.dateToNumber(e);return void 0===(t=this.dateTimeHelper.getWithinBounds(t))?new l.CellError(l.ErrorType.NUM,a.ErrorMessage.DateBounds):t})}datedif(e,t){return this.runFunction(e.args,t,this.metadata("DATEDIF"),(e,t,n)=>{if(t<e)return new l.CellError(l.ErrorType.NUM,a.ErrorMessage.StartEndDate);if("D"===n)return Math.floor(t)-Math.floor(e);var r,i,o=this.dateTimeHelper.numberToSimpleDate(e),s=this.dateTimeHelper.numberToSimpleDate(t);switch(n){case"M":return 12*(s.year-o.year)+(s.month-o.month)-(s.day<o.day?1:0);case"YM":return(s.month-o.month+12-(s.day<o.day?1:0))%12;case"Y":return s.month>o.month||s.month===o.month&&s.day>=o.day?s.year-o.year:s.year-o.year-1;case"MD":return s.day>=o.day?s.day-o.day:(r=1===s.month?12:s.month-1,i=1===s.month?s.year-1:s.year,this.dateTimeHelper.daysInMonth(i,r)+s.day-o.day);case"YD":return s.month>o.month||s.month===o.month&&s.day>=o.day?Math.floor(t)-this.dateTimeHelper.dateToNumber({year:s.year,month:o.month,day:o.day}):Math.floor(t)-Math.floor(e)-365*(s.year-o.year-1)-this.dateTimeHelper.leapYearsCount(s.year-1)+this.dateTimeHelper.leapYearsCount(o.year);default:return new l.CellError(l.ErrorType.NUM,a.ErrorMessage.BadMode)}})}days360(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,t){return this.runFunction(e.args,t,this.metadata("YEARFRAC"),(e,t,n)=>{switch(e=Math.trunc(e),(t=Math.trunc(t))<e&&([e,t]=[t,e]),n){case 0:return this.days360Core(e,t,!1)/360;case 1:return(t-e)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(e),this.dateTimeHelper.numberToSimpleDate(t));case 2:return(t-e)/360;case 3:return(t-e)/365;case 4:return this.days360Core(e,t,!0)/360}throw new Error("Should not be reachable.")})}interval(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),e=>{var t=(e=Math.trunc(e))%60,n=(e=Math.trunc(e/60))%60,r=(e=Math.trunc(e/60))%24,i=(e=Math.trunc(e/24))%30,o=(e=Math.trunc(e/30))%12,e=Math.trunc(e/12);return"P"+(0<e?e+"Y":"")+(0<o?o+"M":"")+(0<i?i+"D":"")+"T"+(0<r?r+"H":"")+(0<n?n+"M":"")+(0<t?t+"S":"")})}networkdays(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),(e,t,n)=>this.networkdayscore(e,t,1,n))}networkdaysintl(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),(e,t,n,r)=>this.networkdayscore(e,t,n,r))}workday(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY"),(e,t,n)=>this.workdaycore(e,t,1,n))}workdayintl(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),(e,t,n,r)=>this.workdaycore(e,t,n,r))}networkdayscore(e,t,n,r){e=Math.trunc(e);let i=1;(t=Math.trunc(t))<e&&([e,t]=[t,e],i=-1);n=c(n);return n instanceof l.CellError?n:(r=this.simpleRangeToFilteredHolidays(n,r))instanceof l.CellError?r:i*this.countWorkdays(e,t,n,r)}workdaycore(n,r,e,t){n=Math.trunc(n),r=Math.trunc(r);var i=c(e);if(i instanceof l.CellError)return i;var o=this.simpleRangeToFilteredHolidays(i,t);if(o instanceof l.CellError)return o;if(0<r){let e=1;for(;this.countWorkdays(n+1,n+e,i,o)<r;)e*=2;let t=1;for(;t+1<e;){var s=Math.trunc((t+e)/2);this.countWorkdays(n+1,n+s,i,o)<r?t=s:e=s}return n+e}if(r<0){r*=-1;let e=1;for(;this.countWorkdays(n-e,n-1,i,o)<r;)e*=2;let t=1;for(;t+1<e;){var a=Math.trunc((t+e)/2);this.countWorkdays(n-a,n-1,i,o)<r?t=a:e=a}return n-e}return n}countWorkdays(e,t,n,r){var i=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)),o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));let s=0;for(let e=0;e<7;e++)"0"===n.charAt(e)&&(s=(s+=Math.floor((i+6-e)/7))-Math.floor((o-1+6-e)/7));return s-=u(t+1,r)-u(e,r)}simpleRangeToFilteredHolidays(t,e){e=null!=(e=null==e?void 0:e.valuesFromTopLeftCorner())?e:[];for(const r of e)if(r instanceof l.CellError)return r;var n=[];for(const i of e)if(i!==s.EmptyValue){if(!(0,s.isExtendedNumber)(i))return new l.CellError(l.ErrorType.VALUE,a.ErrorMessage.WrongType);n.push(Math.trunc((0,s.getRawValue)(i)))}return[...new Set(n)].sort((e,t)=>e-t).filter(e=>{e=this.dateTimeHelper.relativeNumberToAbsoluteNumber(e);return"0"===t.charAt((e-1)%7)})}}function u(e,t){if(0===t.length)return 0;if(e<=t[0])return 0;if(t[t.length-1]<e)return t.length;let n=0,r=t.length-1;for(;n+1<r;){var i=Math.floor((r+n)/2);t[i]>=e?r=i:n=i}return r}function c(e){return"number"!=typeof e&&"string"!=typeof e?new l.CellError(l.ErrorType.VALUE,a.ErrorMessage.WrongType):"string"==typeof e?7===e.length&&/^(0|1)*$/.test(e)&&"1111111"!==e?e:new l.CellError(l.ErrorType.NUM,a.ErrorMessage.WeekendString):null!=(e=h.get(e))?e:new l.CellError(l.ErrorType.NUM,a.ErrorMessage.BadMode)}i.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}],returnNumberType:s.NumberType.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}],returnNumberType:s.NumberType.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER}],returnNumberType:s.NumberType.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:t.FunctionArgumentType.STRING}],returnNumberType:s.NumberType.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:t.FunctionArgumentType.STRING}],returnNumberType:s.NumberType.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:s.NumberType.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:s.NumberType.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER}],returnNumberType:s.NumberType.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NOERROR,defaultValue:1},{argumentType:t.FunctionArgumentType.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NOERROR,defaultValue:1},{argumentType:t.FunctionArgumentType.RANGE,optionalArg:!0}]}};const d=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),h=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]])},(e,t,n)=>{"use strict";n.r(t),n.d(t,{DegreesPlugin:()=>r});t=n(94);class r extends t.FunctionPlugin{degrees(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),e=>e*(180/Math.PI))}}r.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{DeltaPlugin:()=>r});t=n(94);class r extends t.FunctionPlugin{delta(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),(e,t)=>e===t?1:0)}}r.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ExpPlugin:()=>r});t=n(94);class r extends t.FunctionPlugin{exp(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}r.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{FinancialPlugin:()=>r});var c=n(3),u=n(61),i=n(70),t=n(94);class r extends t.FunctionPlugin{pmt(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),s)}ipmt(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),l)}ppmt(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),d)}fv(e,t){return this.runFunction(e.args,t,this.metadata("FV"),a)}cumipmt(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),(t,n,r,i,o,s)=>{if(o<i)return new c.CellError(c.ErrorType.NUM,u.ErrorMessage.EndStartPeriod);let a=0;for(let e=i;e<=o;e++)a+=l(t,e,n,r,0,s);return a})}cumprinc(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),(t,n,r,i,o,s)=>{if(o<i)return new c.CellError(c.ErrorType.NUM,u.ErrorMessage.EndStartPeriod);let a=0;for(let e=i;e<=o;e++)a+=d(t,e,n,r,0,s);return a})}db(e,t){return this.runFunction(e.args,t,this.metadata("DB"),(t,e,n,r,i)=>{if(12===i&&n<r||n+1<r)return new c.CellError(c.ErrorType.NUM,u.ErrorMessage.PeriodLong);if(t<=e)return 0;var o=Math.round(1e3*(1-Math.pow(e/t,1/n)))/1e3,e=t*o*i/12;if(1===r)return e;let s=e;for(let e=0;e<r-2;e++)s+=(t-s)*o;return r===n+1?(t-s)*o*(12-i)/12:(t-s)*o})}ddb(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),(e,t,n,r,i)=>{if(n<r)return new c.CellError(c.ErrorType.NUM);let o=i/n,s;s=1<=o?(o=1)===r?e:0:e*Math.pow(1-o,r-1);i=e*Math.pow(1-o,r);return Math.max(s-Math.max(t,i),0)})}dollarde(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),(e,t)=>{if(t<1)return new c.CellError(c.ErrorType.DIV_BY_ZERO);for(t=Math.trunc(t);10<t;)t/=10;return Math.trunc(e)+10*(e-Math.trunc(e))/t})}dollarfr(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),(e,t)=>{if(t<1)return new c.CellError(c.ErrorType.DIV_BY_ZERO);for(t=Math.trunc(t);10<t;)t/=10;return Math.trunc(e)+(e-Math.trunc(e))*t/10})}effect(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),(e,t)=>(t=Math.trunc(t),Math.pow(1+e/t,t)-1))}ispmt(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),(e,t,n,r)=>0===n?new c.CellError(c.ErrorType.DIV_BY_ZERO):r*e*(t/n-1))}nominal(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),(e,t)=>(t=Math.trunc(t),(Math.pow(e+1,1/t)-1)*t))}nper(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),(e,t,n,r,i)=>0===e?0===t?new c.CellError(c.ErrorType.DIV_BY_ZERO):(-n-r)/t:(i&&(t*=1+e),Math.log((t-r*e)/(n*e+t))/Math.log(1+e)))}rate(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),(n,r,i,o,s,e)=>{if(e<=-1)return new c.CellError(c.ErrorType.VALUE);var a,l;let u=e;s=s?1:0;for(let e=0;e<50;e++){if(u<=-1)return new c.CellError(c.ErrorType.NUM);let e;if(e=Math.abs(u)<1e-7?i*(1+n*u)+r*(1+u*s)*n+o:i*(a=Math.pow(1+u,n))+r*(1/u+s)*(a-1)+o,Math.abs(e)<1e-7)return u;let t;t=Math.abs(u)<1e-7?i*n+r*s*n:(a=Math.pow(1+u,n),i*(l=n*Math.pow(1+u,n-1))+r*(1/u+s)*l+r*(-1/(u*u))*(a-1)),u-=e/t}return new c.CellError(c.ErrorType.NUM)})}pv(e,t){return this.runFunction(e.args,t,this.metadata("PV"),(e,t,n,r,i)=>(i=i?1:0,-1===e?0===t?new c.CellError(c.ErrorType.NUM):new c.CellError(c.ErrorType.DIV_BY_ZERO):0===e?-n*t-r:((1-Math.pow(1+e,t))*n*(1+e*i)/e-r)/Math.pow(1+e,t)))}rri(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),(e,t,n)=>0===t||n<0&&0<t||0<n&&t<0?new c.CellError(c.ErrorType.NUM):Math.pow(n/t,1/e)-1)}sln(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),(e,t,n)=>0===n?new c.CellError(c.ErrorType.DIV_BY_ZERO):(e-t)/n)}syd(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),(e,t,n,r)=>n<r?new c.CellError(c.ErrorType.NUM):(e-t)*(n-r+1)*2/(n*(n+1)))}tbilleq(e,t){return this.runFunction(e.args,t,this.metadata("TBILLEQ"),(e,t,n)=>{var r,i;return e=Math.round(e),(t=Math.round(t))<=e||(r=this.dateTimeHelper.numberToSimpleDate(e),(i=this.dateTimeHelper.numberToSimpleDate(t)).year>r.year+1)||i.year===r.year+1&&(i.month>r.month||i.month===r.month&&i.day>r.day)?new c.CellError(c.ErrorType.NUM):0==(i=360-n*(t-e))?0:i<0?new c.CellError(c.ErrorType.NUM):365*n/i})}tbillprice(e,t){return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),(e,t,n)=>{var r,i;return e=Math.round(e),(t=Math.round(t))<=e||(r=this.dateTimeHelper.numberToSimpleDate(e),(i=this.dateTimeHelper.numberToSimpleDate(t)).year>r.year+1)||i.year===r.year+1&&(i.month>r.month||i.month===r.month&&i.day>r.day)?new c.CellError(c.ErrorType.NUM):0==(i=360-n*(t-e))?0:i<0?new c.CellError(c.ErrorType.NUM):100*(1-n*(t-e)/360)})}tbillyield(e,t){return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),(e,t,n)=>{var r,i;return e=Math.round(e),(t=Math.round(t))<=e||(r=this.dateTimeHelper.numberToSimpleDate(e),(i=this.dateTimeHelper.numberToSimpleDate(t)).year>r.year+1)||i.year===r.year+1&&(i.month>r.month||i.month===r.month&&i.day>r.day)?new c.CellError(c.ErrorType.NUM):360*(100-n)/(n*(t-e))})}fvschedule(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),(e,t)=>{t=t.valuesFromTopLeftCorner();for(const n of t)if(n instanceof c.CellError)return n;for(const r of t)if((0,i.isExtendedNumber)(r))e*=1+(0,i.getRawValue)(r);else if(r!==i.EmptyValue)return new c.CellError(c.ErrorType.VALUE,u.ErrorMessage.NumberExpected);return e})}npv(e,t){return this.runFunction(e.args,t,this.metadata("NPV"),(e,...t)=>{t=this.arithmeticHelper.coerceNumbersExactRanges(t);return t instanceof c.CellError?t:h(e,t)})}mirr(e,t){return this.runFunction(e.args,t,this.metadata("MIRR"),(e,t,n)=>{e=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(e instanceof c.CellError)return e;let r=!1,i=!1;var o,s,a=[],l=[];for(const u of e)(0<u?(r=!0,a.push(u),l):(u<0?(i=!0,l.push(u)):l.push(0),a)).push(0);return r&&i?(e=e.length,(o=h(n,a))instanceof c.CellError?o:(s=h(t,l))instanceof c.CellError?s:Math.pow(-o*Math.pow(1+n,e)/s/(1+t),1/(e-1))-1):new c.CellError(c.ErrorType.DIV_BY_ZERO)})}pduration(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),(e,t,n)=>(Math.log(n)-Math.log(t))/Math.log(1+e))}xnpv(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),(t,e,n)=>{e=e.valuesFromTopLeftCorner();for(const a of e)if("number"!=typeof a)return new c.CellError(c.ErrorType.VALUE,u.ErrorMessage.NumberExpected);var r=e,e=n.valuesFromTopLeftCorner();for(const l of e)if("number"!=typeof l)return new c.CellError(c.ErrorType.VALUE,u.ErrorMessage.NumberExpected);var i=e;if(i.length!==r.length)return new c.CellError(c.ErrorType.NUM,u.ErrorMessage.EqualLength);var o=i.length;let s=0;if(i[0]<0)return new c.CellError(c.ErrorType.NUM,u.ErrorMessage.ValueSmall);for(let e=0;e<o;e++){if(i[e]=Math.floor(i[e]),i[e]<i[0])return new c.CellError(c.ErrorType.NUM,u.ErrorMessage.ValueSmall);s+=r[e]/Math.pow(1+t,(i[e]-i[0])/365)}return s})}}function s(e,t,n,r,i){return 0===e?(-n-r)/t:(r*e+n*e*(r=Math.pow(1+e,t)))*(i?1/(1+e):1)/(1-r)}function l(e,t,n,r,i,o){n=s(e,n,r,i,o);return 1===t?e*(o?0:-r):e*(o?a(e,t-2,n,r,o)-n:a(e,t-1,n,r,o))}function a(e,t,n,r,i){return 0===e?-r-n*t:n*(i?1+e:1)*(1-(n=Math.pow(1+e,t)))/e-r*n}function d(e,t,n,r,i,o){return s(e,n,r,i,o)-l(e,t,n,r,i,o)}function h(t,n){let r=0;for(let e=n.length-1;0<=e;e--){if(r+=n[e],-1===t){if(0===r)continue;return new c.CellError(c.ErrorType.DIV_BY_ZERO)}r/=1+t}return r}r.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:1},{argumentType:t.FunctionArgumentType.INTEGER,minValue:1},{argumentType:t.FunctionArgumentType.INTEGER,minValue:0,maxValue:1}],returnNumberType:i.NumberType.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:1},{argumentType:t.FunctionArgumentType.INTEGER,minValue:1},{argumentType:t.FunctionArgumentType.INTEGER,minValue:0,maxValue:1}],returnNumberType:i.NumberType.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:i.NumberType.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.INTEGER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:i.NumberType.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}],returnNumberType:i.NumberType.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}],returnNumberType:i.NumberType.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:.1}],returnNumberType:i.NumberType.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}],returnNumberType:i.NumberType.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}],returnNumberType:i.NumberType.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:i.NumberType.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:i.NumberType.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:i.NumberType.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.RANGE}],returnNumberType:i.NumberType.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1,returnNumberType:i.NumberType.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}],returnNumberType:i.NumberType.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:-1},{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{FormulaTextPlugin:()=>o});var r=n(3),i=n(61),t=n(145),n=n(94);class o extends t.FunctionPlugin{formulatext(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),()=>new r.CellError(r.ErrorType.NA,i.ErrorMessage.WrongArgNumber),e=>{return null!=(e=this.serialization.getCellFormula(e))?e:new r.CellError(r.ErrorType.NA,i.ErrorMessage.Formula)})}}o.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:n.FunctionArgumentType.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{HyperlinkPlugin:()=>r});t=n(94);class r extends t.FunctionPlugin{hyperlink(n,e){return this.runFunction(n.args,e,this.metadata("HYPERLINK"),(e,t)=>(n.hyperlink=e,null!=t?t:e))}}r.implementedFunctions={HYPERLINK:{method:"hyperlink",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.STRING,optionalArg:!0}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{InformationPlugin:()=>u});var i=n(3),r=n(80),o=n(61),s=n(7),a=n(70),l=n(69),t=n(94);class u extends t.FunctionPlugin{isbinary(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),e=>/^[01]{1,10}$/.test(e))}iserr(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),e=>e instanceof i.CellError&&e.type!==i.ErrorType.NA)}iserror(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),e=>e instanceof i.CellError)}isformula(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),()=>new i.CellError(i.ErrorType.NA,o.ErrorMessage.WrongArgNumber),e=>{return this.dependencyGraph.addressMapping.getCell(e)instanceof r.FormulaVertex})}isblank(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),e=>e===a.EmptyValue)}isna(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),e=>e instanceof i.CellError&&e.type==i.ErrorType.NA)}isnumber(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),a.isExtendedNumber)}islogical(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),e=>"boolean"==typeof e)}isref(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),e=>e instanceof i.CellError&&(e.type==i.ErrorType.REF||e.type==i.ErrorType.CYCLE))}istext(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),e=>"string"==typeof e)}isnontext(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),e=>!("string"==typeof e))}column(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),()=>t.formulaAddress.col+1,e=>e.col+1)}columns(e,t){if(1!==e.args.length)return new i.CellError(i.ErrorType.NA,o.ErrorMessage.WrongArgNumber);if(e.args.some(e=>e.type===s.AstNodeType.EMPTY))return new i.CellError(i.ErrorType.NUM,o.ErrorMessage.EmptyArg);let n=e.args[0];for(;n.type===s.AstNodeType.PARENTHESIS;)n=n.expression;return n.type===s.AstNodeType.CELL_RANGE||n.type===s.AstNodeType.COLUMN_RANGE?n.end.col-n.start.col+1:n.type===s.AstNodeType.CELL_REFERENCE?1:n.type===s.AstNodeType.ROW_RANGE?this.config.maxColumns:(e=this.evaluateAst(n,t))instanceof l.SimpleRangeValue?e.width():e instanceof i.CellError?e:1}row(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),()=>t.formulaAddress.row+1,e=>e.row+1)}rows(e,t){if(1!==e.args.length)return new i.CellError(i.ErrorType.NA,o.ErrorMessage.WrongArgNumber);if(e.args.some(e=>e.type===s.AstNodeType.EMPTY))return new i.CellError(i.ErrorType.NUM,o.ErrorMessage.EmptyArg);let n=e.args[0];for(;n.type===s.AstNodeType.PARENTHESIS;)n=n.expression;return n.type===s.AstNodeType.CELL_RANGE||n.type===s.AstNodeType.ROW_RANGE?n.end.row-n.start.row+1:n.type===s.AstNodeType.CELL_REFERENCE?1:n.type===s.AstNodeType.COLUMN_RANGE?this.config.maxRows:(e=this.evaluateAst(n,t))instanceof l.SimpleRangeValue?e.height():e instanceof i.CellError?e:1}index(e,t){return this.runFunction(e.args,t,this.metadata("INDEX"),(e,t,n)=>{var r;return n<1||t<1?new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.LessThanOne):n>e.width()||t>e.height()?new i.CellError(i.ErrorType.NUM,o.ErrorMessage.ValueLarge):null!=(t=null!=(t=null==(r=null==(r=null==e?void 0:e.data)?void 0:r[t-1])?void 0:r[n-1])?t:null==(n=null==(r=null==e?void 0:e.data)?void 0:r[0])?void 0:n[0])?t:new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.CellRangeExpected)})}na(e,t){return new i.CellError(i.ErrorType.NA)}sheet(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEET"),()=>t.formulaAddress.sheet+1,e=>e.sheet+1,e=>{e=this.dependencyGraph.sheetMapping.get(e);return void 0!==e?e+1:new i.CellError(i.ErrorType.NA,o.ErrorMessage.SheetRef)})}sheets(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEETS"),()=>this.dependencyGraph.sheetMapping.numberOfSheets(),()=>1,()=>new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.CellRefExpected))}}u.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:t.FunctionArgumentType.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:t.FunctionArgumentType.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:t.FunctionArgumentType.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:t.FunctionArgumentType.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:t.FunctionArgumentType.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:t.FunctionArgumentType.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:t.FunctionArgumentType.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:t.FunctionArgumentType.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{IsEvenPlugin:()=>r});t=n(94);class r extends t.FunctionPlugin{iseven(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),e=>e%2==0)}}r.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{IsOddPlugin:()=>r});t=n(94);class r extends t.FunctionPlugin{isodd(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),e=>e%2==1)}}r.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{LogarithmPlugin:()=>r});t=n(94);class r extends t.FunctionPlugin{log10(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}log(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),(e,t)=>Math.log(e)/Math.log(t))}ln(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}r.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{MathConstantsPlugin:()=>i,PI:()=>r});t=n(94);const r=parseFloat(Math.PI.toFixed(14));class i extends t.FunctionPlugin{pi(e,t){return this.runFunction(e.args,t,this.metadata("PI"),()=>r)}sqrtpi(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),e=>Math.sqrt(r*e))}}i.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{MatrixPlugin:()=>r});var a=n(1),i=n(3),o=n(61),l=n(7),u=n(93),s=n(69),t=n(94);function c(e,t){return new a.ArraySize(t.width,e.height)}function d(e,t,n){return new a.ArraySize(1+(e.width-t)/n,1+(e.height-t)/n)}class r extends t.FunctionPlugin{mmult(e,t){return this.runFunction(e.args,t,this.metadata("MMULT"),(e,t)=>{var n;return e.hasOnlyNumbers()&&t.hasOnlyNumbers()?t.height()!==e.width()?new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.ArrayDimensions):(n=c(e.size,t.size),n=this.createKernel(function(t,n,r){let i=0;for(let e=0;e<r;++e)i+=t[this.thread.y][e]*n[e][this.thread.x];return i},n)(e.rawNumbers(),t.rawNumbers(),e.width()),s.SimpleRangeValue.onlyNumbers(n)):new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.NumberRange)})}mmultArraySize(e,t){if(2!==e.args.length)return a.ArraySize.error();const n=this.metadata("MMULT");var[e,r]=e.args.map(e=>{return this.arraySizeForAst(e,new u.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(e=null===n||void 0===n?void 0:n.arrayFunction)&&e))});return c(e,r)}maxpool(e,t){return this.runFunction(e.args,t,this.metadata("MAXPOOL"),(e,t,n=t)=>{var r;return e.hasOnlyNumbers()?(r=d(e.size,t,n),r=this.createKernel(function(n,r,e){var i=this.thread.x*e,o=this.thread.y*e;let s=n[o][i];for(let t=0;t<r;t++)for(let e=0;e<r;e++)s=Math.max(s,n[o+t][i+e]);return s},r)(e.rawNumbers(),t,n),s.SimpleRangeValue.onlyNumbers(r)):new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.NumberRange)})}medianpool(e,t){return this.runFunction(e.args,t,this.metadata("MEDIANPOOL"),(e,t,n=t)=>{var r;return e.hasOnlyNumbers()?(r=d(e.size,t,n),r=this.createKernel(function(r,i,e){var o=this.thread.x*e,s=this.thread.y*e;let n=r[s][o];for(let t=0;t<i;t++)for(let e=0;e<i;e++)n=Math.max(n,r[s+t][o+e]);let a=r[s][o];for(let t=0;t<i;t++)for(let e=0;e<i;e++)a=Math.min(a,r[s+t][o+e]);var t=i*i;let l=a,u=n,c=42;for(let e=0;e<32;e++){var d=(l+u)/2;let n=0;for(let t=0;t<i;t++)for(let e=0;e<i;e++)r[s+t][o+e]>d&&n++;if(i%2==0){if(n===t/2){c=d;break}n>t/2?l=d:u=d}else{if(n===(t-1)/2){c=d;break}n>(t-1)/2?l=d:u=d}}return c},r)(e.rawNumbers(),t,n),s.SimpleRangeValue.onlyNumbers(r)):new i.CellError(i.ErrorType.VALUE,o.ErrorMessage.NumberRange)})}maxpoolArraySize(e,t){if(e.args.length<2||3<e.args.length)return a.ArraySize.error();const n=this.metadata("MAXPOOL");var r=e.args.map(e=>{return this.arraySizeForAst(e,new u.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(e=null===n||void 0===n?void 0:n.arrayFunction)&&e))})[0],i=e.args[1];let o,s=o=i.type===l.AstNodeType.NUMBER?i.value:1;return 3===e.args.length&&(i=e.args[2],s=i.type===l.AstNodeType.NUMBER?i.value:1),o>r.width||o>r.height||s>o||(r.width-o)%s!=0||(r.height-o)%s!=0?a.ArraySize.error():d(r,o,s)}medianpoolArraySize(e,t){return this.maxpoolArraySize(e,t)}transpose(e,t){return this.runFunction(e.args,t,this.metadata("TRANSPOSE"),e=>{var n=e.rawData(),r=e.size,i=[];for(let t=0;t<r.width;++t){i[t]=[];for(let e=0;e<r.height;++e)i[t][e]=n[e][t]}return s.SimpleRangeValue.onlyValues(i)})}transposeArraySize(e,t){if(1!==e.args.length)return a.ArraySize.error();const n=this.metadata("MMULT");var[e]=e.args.map(e=>{return this.arraySizeForAst(e,new u.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(e=null===n||void 0===n?void 0:n.arrayFunction)&&e))});return new a.ArraySize(e.height,e.width)}createKernel(i,o){return function(...n){var r=[];for(let t=0;t<o.height;++t){r.push([]);for(let e=0;e<o.width;++e)r[t][e]=i.apply({thread:{x:e,y:t}},n)}return r}}}r.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:t.FunctionArgumentType.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{MedianPlugin:()=>o});var r=n(3),i=n(61),t=n(94);class o extends t.FunctionPlugin{median(e,t){return this.runFunction(e.args,t,this.metadata("MEDIAN"),(...e)=>{e=this.arithmeticHelper.coerceNumbersExactRanges(e);return e instanceof r.CellError?e:0===e.length?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.OneValue):(e.sort((e,t)=>e-t),e.length%2==0?(e[e.length/2-1]+e[e.length/2])/2:e[Math.floor(e.length/2)])})}large(e,t){return this.runFunction(e.args,t,this.metadata("LARGE"),(e,t)=>{e=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return e instanceof r.CellError?e:(e.sort((e,t)=>e-t),(t=Math.trunc(t))>e.length?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.ValueLarge):e[e.length-t])})}small(e,t){return this.runFunction(e.args,t,this.metadata("SMALL"),(e,t)=>{e=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return e instanceof r.CellError?e:(e.sort((e,t)=>e-t),(t=Math.trunc(t))>e.length?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.ValueLarge):e[t-1])})}}o.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ModuloPlugin:()=>i});var r=n(3),t=n(94);class i extends t.FunctionPlugin{mod(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),(e,t)=>0===t?new r.CellError(r.ErrorType.DIV_BY_ZERO):e%t)}}i.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{NumericAggregationPlugin:()=>l});var u=n(2),f=n(3),c=n(61),d=n(77),h=n(7),r=n(95),i=n(70),p=n(69),o=n(94);function s(e){return(0,i.isExtendedNumber)(e)&&!Number.isFinite((0,i.getRawValue)(e))?0:e}class a{constructor(e,t,n){this.sumsq=e,this.sum=t,this.count=n}static single(e){return new a(e*e,e,1)}compose(e){return new a(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){if(0<this.count)return this.sum/this.count}varSValue(){if(1<this.count)return(this.sumsq-this.sum*this.sum/this.count)/(this.count-1)}varPValue(){if(0<this.count)return(this.sumsq-this.sum*this.sum/this.count)/this.count}}a.empty=new a(0,0,0);class l extends o.FunctionPlugin{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,t)=>this.arithmeticHelper.addWithEpsilonRaw(e,t)}sum(e,t){return this.doSum(e.args,t)}sumsq(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,e=>Math.pow((0,i.getRawValue)(e),2),g)}max(e,t){return this.doMax(e.args,t)}maxa(e,t){return s(this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",(e,t)=>Math.max(e,t),i.getRawValue,m))}min(e,t){return this.doMin(e.args,t)}mina(e,t){return s(this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",(e,t)=>Math.min(e,t),i.getRawValue,m))}count(e,t){return this.doCount(e.args,t)}counta(e,t){return this.doCounta(e.args,t)}average(e,t){return this.doAverage(e.args,t)}averagea(e,t){e=this.reduce(e.args,t,a.empty,"_AGGREGATE_A",(e,t)=>e.compose(t),e=>a.single((0,i.getRawValue)(e)),m);return e instanceof f.CellError?e:null!=(t=e.averageValue())?t:new f.CellError(f.ErrorType.DIV_BY_ZERO)}vars(e,t){return this.doVarS(e.args,t)}varp(e,t){return this.doVarP(e.args,t)}vara(e,t){e=this.reduceAggregateA(e.args,t);return e instanceof f.CellError?e:null!=(t=e.varSValue())?t:new f.CellError(f.ErrorType.DIV_BY_ZERO)}varpa(e,t){e=this.reduceAggregateA(e.args,t);return e instanceof f.CellError?e:null!=(t=e.varPValue())?t:new f.CellError(f.ErrorType.DIV_BY_ZERO)}stdevs(e,t){return this.doStdevS(e.args,t)}stdevp(e,t){return this.doStdevP(e.args,t)}stdeva(e,t){e=this.reduceAggregateA(e.args,t);return e instanceof f.CellError?e:void 0===(t=e.varSValue())?new f.CellError(f.ErrorType.DIV_BY_ZERO):Math.sqrt(t)}stdevpa(e,t){e=this.reduceAggregateA(e.args,t);return e instanceof f.CellError?e:void 0===(t=e.varPValue())?new f.CellError(f.ErrorType.DIV_BY_ZERO):Math.sqrt(t)}product(e,t){return this.doProduct(e.args,t)}subtotal(e,t){if(e.args.length<2)return new f.CellError(f.ErrorType.NA,c.ErrorMessage.WrongArgNumber);var n=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:o.FunctionArgumentType.NUMBER},t),r=e.args.slice(1);switch(n){case 1:case 101:return this.doAverage(r,t);case 2:case 102:return this.doCount(r,t);case 3:case 103:return this.doCounta(r,t);case 4:case 104:return this.doMax(r,t);case 5:case 105:return this.doMin(r,t);case 6:case 106:return this.doProduct(r,t);case 7:case 107:return this.doStdevS(r,t);case 8:case 108:return this.doStdevP(r,t);case 9:case 109:return this.doSum(r,t);case 10:case 110:return this.doVarS(r,t);case 11:case 111:return this.doVarP(r,t);default:return new f.CellError(f.ErrorType.VALUE,c.ErrorMessage.BadMode)}}reduceAggregate(e,t){return this.reduce(e,t,a.empty,"_AGGREGATE",(e,t)=>e.compose(t),e=>a.single((0,i.getRawValue)(e)),g)}reduceAggregateA(e,t){return this.reduce(e,t,a.empty,"_AGGREGATE_A",(e,t)=>e.compose(t),e=>a.single((0,i.getRawValue)(e)),m)}doAverage(e,t){e=this.reduceAggregate(e,t);return e instanceof f.CellError?e:null!=(t=e.averageValue())?t:new f.CellError(f.ErrorType.DIV_BY_ZERO)}doVarS(e,t){e=this.reduceAggregate(e,t);return e instanceof f.CellError?e:null!=(t=e.varSValue())?t:new f.CellError(f.ErrorType.DIV_BY_ZERO)}doVarP(e,t){e=this.reduceAggregate(e,t);return e instanceof f.CellError?e:null!=(t=e.varPValue())?t:new f.CellError(f.ErrorType.DIV_BY_ZERO)}doStdevS(e,t){e=this.reduceAggregate(e,t);return e instanceof f.CellError?e:void 0===(t=e.varSValue())?new f.CellError(f.ErrorType.DIV_BY_ZERO):Math.sqrt(t)}doStdevP(e,t){e=this.reduceAggregate(e,t);return e instanceof f.CellError?e:void 0===(t=e.varPValue())?new f.CellError(f.ErrorType.DIV_BY_ZERO):Math.sqrt(t)}doCount(e,t){return this.reduce(e,t,0,"COUNT",(e,t)=>e+t,i.getRawValue,e=>(0,i.isExtendedNumber)(e)?1:0)}doCounta(e,t){return this.reduce(e,t,0,"COUNTA",(e,t)=>e+t,i.getRawValue,e=>e===i.EmptyValue?0:1)}doMax(e,t){return s(this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",(e,t)=>Math.max(e,t),i.getRawValue,g))}doMin(e,t){return s(this.reduce(e,t,Number.POSITIVE_INFINITY,"MIN",(e,t)=>Math.min(e,t),i.getRawValue,g))}doSum(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,i.getRawValue,g)}doProduct(e,t){return this.reduce(e,t,1,"PRODUCT",(e,t)=>e*t,i.getRawValue,g)}reduce(e,i,o,s,a,l,u){return e.length<1?new f.CellError(f.ErrorType.NA,c.ErrorMessage.WrongArgNumber):e.reduce((e,t)=>{if(e instanceof f.CellError)return e;var n;if(t.type===h.AstNodeType.CELL_RANGE||t.type===h.AstNodeType.COLUMN_RANGE||t.type===h.AstNodeType.ROW_RANGE)return(n=this.evaluateRange(t,i,o,s,a,l,u))instanceof f.CellError?n:a(n,e);let r;if((r=this.evaluateAst(t,i))instanceof p.SimpleRangeValue)return Array.from(r.valuesFromTopLeftCorner()).map(u).filter(e=>void 0!==e).map(e=>e instanceof f.CellError?e:l(e)).reduce((e,t)=>e instanceof f.CellError?e:t instanceof f.CellError?t:a(e,t),e);if(t.type===h.AstNodeType.CELL_REFERENCE){if(void 0===(r=u(r)))return e}else if(r=this.coerceScalarToNumberOrError(r),void 0===(r=u(r)))return e;return r instanceof f.CellError?r:a(e,l(r))},o)}evaluateRange(e,t,n,r,i,o,s){let a;try{a=u.AbsoluteCellRange.fromAst(e,t.formulaAddress)}catch(e){if(e instanceof d.SheetsNotEqual)return new f.CellError(f.ErrorType.REF,c.ErrorMessage.RangeManySheets);throw e}e=this.dependencyGraph.getRange(a.start,a.end);if(void 0===e)throw new Error("Range does not exists in graph");let l=e.getFunctionValue(r);return void 0===l&&(t=this.getRangeValues(r,a,e,o,s),l=t.reduce((e,t)=>e instanceof f.CellError?e:t instanceof f.CellError?t:i(e,t),n),e.setFunctionValue(r,l)),l}getRangeValues(e,t,n,r,i){var o=[],{smallerRangeVertex:s,restRange:a}=this.dependencyGraph.rangeMapping.findSmallerRange(t);let l;if(void 0!==s&&this.dependencyGraph.existsEdge(s,n)){n=s.getFunctionValue(e);if(void 0!==n)o.push(n);else for(const d of s.range.addresses(this.dependencyGraph)){var u=i(this.dependencyGraph.getScalarValue(d));u instanceof f.CellError?o.push(u):void 0!==u&&o.push(r(u))}l=a}else l=t;for(const h of l.addresses(this.dependencyGraph)){var c=i(this.dependencyGraph.getScalarValue(h));c instanceof f.CellError?o.push(c):void 0!==c&&o.push(r(c))}return o}}function g(e){if((0,i.isExtendedNumber)(e)||e instanceof f.CellError)return e}function m(e){return"boolean"==typeof e?(0,r.coerceBooleanToNumber)(e):(0,i.isExtendedNumber)(e)||e instanceof f.CellError?e:"string"==typeof e?0:void 0}l.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1}},l.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{PowerPlugin:()=>r});t=n(94);class r extends t.FunctionPlugin{power(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}r.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{RadiansPlugin:()=>r});t=n(94);class r extends t.FunctionPlugin{radians(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),e=>e*(Math.PI/180))}}r.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{RadixConversionPlugin:()=>a});var r=n(3),i=n(61),o=n(104),t=n(94);const s=10;class a extends t.FunctionPlugin{dec2bin(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),(e,t)=>u(e,2,t))}dec2oct(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),(e,t)=>u(e,8,t))}dec2hex(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),(e,t)=>u(e,16,t))}bin2dec(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),e=>{e=l(e,2,s);return void 0===e?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.NotBinary):f(e,2)})}bin2oct(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),(e,t)=>{e=l(e,2,s);return void 0===e?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.NotBinary):u(f(e,2),8,t)})}bin2hex(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),(e,t)=>{e=l(e,2,s);return void 0===e?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.NotBinary):u(f(e,2),16,t)})}oct2dec(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),e=>{e=l(e,8,s);return void 0===e?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.NotOctal):f(e,8)})}oct2bin(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),(e,t)=>{e=l(e,8,s);return void 0===e?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.NotOctal):u(f(e,8),2,t)})}oct2hex(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),(e,t)=>{e=l(e,8,s);return void 0===e?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.NotOctal):u(f(e,8),16,t)})}hex2dec(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),e=>{e=l(e,16,s);return void 0===e?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.NotHex):f(e,16)})}hex2bin(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),(e,t)=>{e=l(e,16,s);return void 0===e?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.NotHex):u(f(e,16),2,t)})}hex2oct(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),(e,t)=>{e=l(e,16,s);return void 0===e?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.NotHex):u(f(e,16),8,t)})}base(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),d)}decimal(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),(e,t)=>{e=l(e,t,255);return void 0===e?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.NotHex):parseInt(e,t)})}}function l(e,t,n){t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".substr(0,t),t=new RegExp(`^[${t}]+$`);if(!(e.length>n)&&t.test(e))return e}function u(e,t,n){return e>-c(t)-1?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.ValueBaseLarge):e<c(t)?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.ValueBaseSmall):(t=h(e,t),void 0===n||e<0?t:t.length>n?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.ValueBaseLong):(0,o.padLeft)(t,n))}function c(e){return-Math.pow(e,s)/2}function d(e,t,n){e=h(e,t);return void 0!==n&&n>e.length?(0,o.padLeft)(e,n):e}function h(e,t){return(e+(e<0?Math.pow(t,s):0)).toString(t).toUpperCase()}function f(e,t){e=parseInt(e,t),t=Math.pow(t,s);return t/2<=e?e-t:e}a.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:t.FunctionArgumentType.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:s}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:s}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:t.FunctionArgumentType.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:s}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:s}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:t.FunctionArgumentType.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:s}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:s}]},DECIMAL:{method:"decimal",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,minValue:2,maxValue:36}]},BASE:{method:"base",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:2,maxValue:36},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:255}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{RandomPlugin:()=>o});var r=n(3),i=n(61),t=n(94);class o extends t.FunctionPlugin{rand(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}randbetween(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),(e,t)=>t<e?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.WrongOrder):((e=Math.ceil(e))===(t=Math.floor(t)+1)&&(t+=1),e+Math.floor(Math.random()*(t-e))))}}o.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}],isVolatile:!0}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{RoundingPlugin:()=>a,findNextEvenNumber:()=>s,findNextOddNumber:()=>o});var r=n(3),i=n(61),t=n(94);function o(e){e=Math.ceil(e);return e%2==1?e:e+1}function s(e){e=Math.ceil(e);return e%2==0?e:e+1}class a extends t.FunctionPlugin{roundup(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(e,t)=>{t=Math.pow(10,t);return e<0?-Math.ceil(-e*t)/t:Math.ceil(e*t)/t})}rounddown(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(e,t)=>{t=Math.pow(10,t);return e<0?-Math.floor(-e*t)/t:Math.floor(e*t)/t})}round(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),(e,t)=>{t=Math.pow(10,t);return e<0?-Math.round(-e*t)/t:Math.round(e*t)/t})}intFunc(e,t){return this.runFunction(e.args,t,this.metadata("INT"),e=>e<0?-Math.floor(-e):Math.floor(e))}even(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),e=>e<0?-s(-e):s(e))}odd(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),e=>e<0?-o(-e):o(e))}ceilingmath(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),(e,t,n)=>0===t||0===e?0:(t=Math.abs(t),1===n&&e<0&&(t=-t),Math.ceil(e/t)*t))}ceiling(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),(e,t)=>0===e?0:0===t?new r.CellError(r.ErrorType.DIV_BY_ZERO):0<e&&t<0?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.DistinctSigns):Math.ceil(e/t)*t)}ceilingprecise(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),(e,t)=>0===t||0===e?0:(t=Math.abs(t),Math.ceil(e/t)*t))}floormath(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),(e,t,n)=>0===t||0===e?0:(t=Math.abs(t),1===n&&e<0&&(t*=-1),Math.floor(e/t)*t))}floor(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),(e,t)=>0===e?0:0===t?new r.CellError(r.ErrorType.DIV_BY_ZERO):0<e&&t<0?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.DistinctSigns):Math.floor(e/t)*t)}floorprecise(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),(e,t)=>0===t||0===e?0:(t=Math.abs(t),Math.floor(e/t)*t))}}a.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]}},a.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{SqrtPlugin:()=>r});t=n(94);class r extends t.FunctionPlugin{sqrt(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}r.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ConditionalAggregationPlugin:()=>r});var c=n(3),d=n(61),h=n(180),i=n(70),t=n(94);class o{constructor(e,t){this.sum=e,this.count=t}static single(e){return new o(e,1)}compose(e){return new o(this.sum+e.sum,this.count+e.count)}averageValue(){if(0<this.count)return this.sum/this.count}}function s(e){return(0,i.isExtendedNumber)(e)&&!Number.isFinite((0,i.getRawValue)(e))?0:e}function a(e){return e instanceof c.CellError?e:(0,i.isExtendedNumber)(e)?(0,i.getRawValue)(e):void 0}o.empty=new o(0,0);class r extends t.FunctionPlugin{sumif(e,t){const r="SUMIF";return this.runFunction(e.args,t,this.metadata(r),(e,t,n)=>this.computeConditionalAggregationFunction(null!=n?n:e,[e,t],r,0,(e,t)=>this.arithmeticHelper.nonstrictadd(e,t),a))}sumifs(e,t){const n="SUMIFS";return this.runFunction(e.args,t,this.metadata(n),(e,...t)=>this.computeConditionalAggregationFunction(e,t,n,0,(e,t)=>this.arithmeticHelper.nonstrictadd(e,t),a))}averageif(e,t){const r="AVERAGEIF";return this.runFunction(e.args,t,this.metadata(r),(e,t,n)=>{n=this.computeConditionalAggregationFunction(null!=n?n:e,[e,t],r,o.empty,(e,t)=>e.compose(t),e=>(0,i.isExtendedNumber)(e)?o.single((0,i.getRawValue)(e)):o.empty);return n instanceof c.CellError?n:n.averageValue()||new c.CellError(c.ErrorType.DIV_BY_ZERO)})}countif(e,t){const n="COUNTIF";return this.runFunction(e.args,t,this.metadata(n),(e,t)=>this.computeConditionalAggregationFunction(e,[e,t],n,0,(e,t)=>e+t,()=>1))}countifs(e,t){const n="COUNTIFS";return this.runFunction(e.args,t,this.metadata(n),(...e)=>this.computeConditionalAggregationFunction(e[0],e,n,0,(e,t)=>e+t,()=>1))}minifs(e,t){const n="MINIFS",r=(e,t)=>void 0===t||void 0===e?void 0===t?e:t:Math.min(e,t);return this.runFunction(e.args,t,this.metadata(n),(e,...t)=>{return s(this.computeConditionalAggregationFunction(e,t,n,Number.POSITIVE_INFINITY,r,a))})}maxifs(e,t){const n="MAXIFS",r=(e,t)=>void 0===t||void 0===e?void 0===t?e:t:Math.max(e,t);return this.runFunction(e.args,t,this.metadata(n),(e,...t)=>{return s(this.computeConditionalAggregationFunction(e,t,n,Number.NEGATIVE_INFINITY,r,a))})}computeConditionalAggregationFunction(e,t,n,r,i,o){var s,a=[];for(let e=0;e<t.length;e+=2){var l=t[e],u=this.interpreter.criterionBuilder.fromCellValue(t[e+1],this.arithmeticHelper);if(void 0===u)return new c.CellError(c.ErrorType.VALUE,d.ErrorMessage.BadCriterion);a.push(new h.Condition(l,u))}return new h.CriterionFunctionCompute(this.interpreter,(s=n,e=>{e=e.map(e=>`${e.conditionRange.range.sheet},${e.conditionRange.range.start.col},`+e.conditionRange.range.start.row);return[s,...e].join(",")}),r,i,o).compute(e,a)}}r.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NOERROR},{argumentType:t.FunctionArgumentType.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NOERROR},{argumentType:t.FunctionArgumentType.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NOERROR}],repeatLastArgs:2}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Condition:()=>i,CriterionFunctionCompute:()=>r});var u=n(3),a=n(61),o=n(181),s=n(70);class r{constructor(e,t,n,r,i){this.interpreter=e,this.cacheKey=t,this.reduceInitialValue=n,this.composeFunction=r,this.mapFunction=i,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,t){for(const s of t)if(!s.conditionRange.sameDimensionsAs(e))return new u.CellError(u.ErrorType.VALUE,a.ErrorMessage.EqualLength);const n=this.tryToGetRangeVertexForRangeValue(e);var r,i,o=t.map(e=>this.tryToGetRangeVertexForRangeValue(e.conditionRange));return n&&o.every(e=>void 0!==e)?(r=t.map(e=>e.criterionPackage.raw).join(","),void 0!==(i=this.findAlreadyComputedValueInCache(n,this.cacheKey(t),r))?(this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),i):((i=this.buildNewCriterionCache(this.cacheKey(t),t.map(e=>e.conditionRange.range),e.range)).has(r)||i.set(r,[this.evaluateRangeValue(e,t),t.map(e=>e.criterionPackage.lambda)]),n.setCriterionFunctionValues(this.cacheKey(t),i),o.forEach(e=>{void 0!==e&&e.addDependentCacheRange(n)}),i.get(r)[0])):this.evaluateRangeValue(e,t)}tryToGetRangeVertexForRangeValue(e){e=e.range;if(void 0!==e)return this.dependencyGraph.getRange(e.start,e.end)}reduceFunction(e){let t=this.reduceInitialValue;for(const n of e)t=this.composeFunction(t,n);return t}findAlreadyComputedValueInCache(e,t,n){return e.getCriterionFunctionValue(t,n)}evaluateRangeValue(e,t){var n=t.map(e=>e.criterionPackage.lambda),e=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),n=d(n,t.map(e=>e.conditionRange.iterateValuesFromTopLeftCorner()),e);return this.reduceFunction(n)}buildNewCriterionCache(e,t,n){var r=this.dependencyGraph.getRange(n.start,n.end);const{smallerRangeVertex:i,restConditionRanges:o,restValuesRange:s}=((e,t,n)=>{if(n.end.row>n.start.row){var r=(0,u.simpleCellAddress)(n.end.sheet,n.end.col,n.end.row-1),e=e.getRange(n.start,r);if(void 0!==e)return{smallerRangeVertex:e,restValuesRange:n.withStart((0,u.simpleCellAddress)(n.start.sheet,n.start.col,n.end.row)),restConditionRanges:t.map(e=>e.withStart((0,u.simpleCellAddress)(e.start.sheet,e.start.col,e.end.row)))}}return{restValuesRange:n,restConditionRanges:t}})(this.dependencyGraph,t,n);let a;a=void 0!==i&&this.dependencyGraph.existsEdge(i,r)?i.getCriterionFunctionValues(e):new Map;const l=new Map;return a.forEach(([e,t],n)=>{var r=d(t,o.map(e=>c(this.dependencyGraph,e)),Array.from(c(this.dependencyGraph,s)).map(this.mapFunction)[Symbol.iterator]()),e=this.composeFunction(e,this.reduceFunction(r));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),l.set(n,[e,t])}),l}}class i{constructor(e,t){this.conditionRange=e,this.criterionPackage=t}}function*c(e,t){for(const n of t.addresses(e))yield(0,s.getRawValue)(e.getScalarValue(n))}function*d(e,t,n){for(const i of n){var r=t.map(e=>(0,o.split)(e));if(!r.every(e=>Object.prototype.hasOwnProperty.call(e,"value")))return;!function(t,n){var r=[];for(let e=0;e<Math.min(t.length,n.length);e++)r.push([t[e],n[e]]);return r}(r.map(e=>(0,s.getRawValue)(e.value)),e).every(([e,t])=>t(e))||(yield i),t=r.map(e=>e.rest)}}},(e,t,n)=>{"use strict";function*r(){}n.r(t),n.d(t,{empty:()=>r,first:()=>function(e){var e=e[Symbol.iterator](),{done:e,value:t}=e.next();if(!e)return t},split:()=>function(e){var e=e[Symbol.iterator](),{done:t,value:n}=e.next();return t?{rest:r()}:{value:n,rest:e}}})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{SumprodPlugin:()=>r});var l=n(3),u=n(61),c=n(70),t=n(94);class r extends t.FunctionPlugin{sumproduct(e,t){return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),(...e)=>{var t=e[0].width(),n=e[0].height();for(const s of e)if(s.width()!==t||s.height()!==n)return new l.CellError(l.ErrorType.VALUE,u.ErrorMessage.EqualLength);let r=0;var i=e.map(e=>e.iterateValuesFromTopLeftCorner());for(let e=0;e<t*n;e++){let e=1;for(const a of i){var o=a.next().value;if(o instanceof l.CellError)return o;o=this.coerceScalarToNumberOrError(o);(0,c.isExtendedNumber)(o)?e*=(0,c.getRawValue)(o):e=0}r+=e}return r})}}r.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:t.FunctionArgumentType.RANGE}],repeatLastArgs:1}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{TextPlugin:()=>r});var a=n(3),l=n(61),t=n(94);class r extends t.FunctionPlugin{concatenate(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),(...e)=>"".concat(...e))}split(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),(e,t)=>{e=e.split(" ");return t>=e.length||t<0?new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.IndexBounds):e[t]})}len(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),e=>e.length)}lower(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),e=>e.toLowerCase())}trim(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),e=>e.replace(/^ +| +$/g,"").replace(/ +/g," "))}proper(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),e=>e.replace(/\p{L}+/gu,e=>e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()))}clean(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),e=>e.replace(/[\u0000-\u001F]/g,""))}exact(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),(e,t)=>e===t)}rept(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),(e,t)=>t<0?new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.NegativeCount):e.repeat(t))}right(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),(e,t)=>t<0?new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.NegativeLength):0===t?"":e.slice(-t))}left(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),(e,t)=>t<0?new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.NegativeLength):e.slice(0,t))}mid(e,t){return this.runFunction(e.args,t,this.metadata("MID"),(e,t,n)=>t<1?new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.LessThanOne):n<0?new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.NegativeLength):e.substring(t-1,t+n-1))}replace(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),(e,t,n,r)=>t<1?new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.LessThanOne):n<0?new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.NegativeLength):e.substring(0,t-1)+r+e.substring(t+n-1))}search(e,t){return this.runFunction(e.args,t,this.metadata("SEARCH"),(e,t,n)=>{return n<1||n>t.length?new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.LengthBounds):(e=e.toLowerCase(),t=t.substring(n-1).toLowerCase(),-1<(t=this.arithmeticHelper.requiresRegex(e)?this.arithmeticHelper.searchString(e,t):t.indexOf(e))?t+n:new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.PatternNotFound))})}substitute(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),(e,t,n,r)=>{var i,o=new RegExp(t,"g");if(void 0===r)return e.replace(o,n);if(r<1)return new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.LessThanOne);let s=0;for(;null!==(i=o.exec(e));)if(r===++s)return e.substring(0,i.index)+n+e.substring(o.lastIndex);return e})}find(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),(e,t,n)=>{return n<1||n>t.length?new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.IndexBounds):0<(t=t.substring(n-1).indexOf(e)+n)?t:new a.CellError(a.ErrorType.VALUE,l.ErrorMessage.PatternNotFound)})}t(e,t){return this.runFunction(e.args,t,this.metadata("T"),e=>e instanceof a.CellError||"string"==typeof e?e:"")}upper(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),e=>e.toUpperCase())}}r.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:t.FunctionArgumentType.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:t.FunctionArgumentType.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:t.FunctionArgumentType.STRING}]},MID:{method:"mid",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:t.FunctionArgumentType.STRING}]},T:{method:"t",parameters:[{argumentType:t.FunctionArgumentType.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:t.FunctionArgumentType.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:t.FunctionArgumentType.STRING}]},REPT:{method:"rept",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.STRING},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:t.FunctionArgumentType.STRING}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{TrigonometryPlugin:()=>s});var r=n(3),i=n(61),t=n(94),o=n(168);class s extends t.FunctionPlugin{acos(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}asin(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}cos(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}sin(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}tan(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}atan(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}atan2(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),(e,t)=>0===e&&0===t?new r.CellError(r.ErrorType.DIV_BY_ZERO):Math.atan2(t,e))}cot(e,t){return this.runFunction(e.args,t,this.metadata("COT"),e=>0===e?new r.CellError(r.ErrorType.DIV_BY_ZERO):1/Math.tan(e))}acot(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),e=>0===e?o.PI/2:Math.atan(1/e))}sec(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),e=>1/Math.cos(e))}csc(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),e=>0===e?new r.CellError(r.ErrorType.DIV_BY_ZERO):1/Math.sin(e))}sinh(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}asinh(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}cosh(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}acosh(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}tanh(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}atanh(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}coth(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),e=>0===e?new r.CellError(r.ErrorType.DIV_BY_ZERO):1/Math.tanh(e))}acoth(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),e=>0===e?new r.CellError(r.ErrorType.NUM,i.ErrorMessage.NonZero):Math.atanh(1/e))}sech(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),e=>1/Math.cosh(e))}csch(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),e=>0===e?new r.CellError(r.ErrorType.DIV_BY_ZERO):1/Math.sinh(e))}}s.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{LookupPlugin:()=>i});var a=n(2),l=n(3),u=n(61),r=n(186),c=n(72),o=n(95),d=n(69),t=n(94);class i extends t.FunctionPlugin{constructor(){super(...arguments),this.rowSearch=new r.RowSearchStrategy(this.dependencyGraph)}vlookup(e,t){return this.runFunction(e.args,t,this.metadata("VLOOKUP"),(e,t,n,r)=>{var i=t.range;return void 0===i?new l.CellError(l.ErrorType.VALUE,u.ErrorMessage.WrongType):n<1?new l.CellError(l.ErrorType.VALUE,u.ErrorMessage.LessThanOne):n>i.width()?new l.CellError(l.ErrorType.REF,u.ErrorMessage.IndexLarge):this.doVlookup((0,o.zeroIfEmpty)(e),t,n-1,r)})}hlookup(e,t){return this.runFunction(e.args,t,this.metadata("HLOOKUP"),(e,t,n,r)=>{var i=t.range;return void 0===i?new l.CellError(l.ErrorType.VALUE,u.ErrorMessage.WrongType):n<1?new l.CellError(l.ErrorType.VALUE,u.ErrorMessage.LessThanOne):n>i.height()?new l.CellError(l.ErrorType.REF,u.ErrorMessage.IndexLarge):this.doHlookup((0,o.zeroIfEmpty)(e),t,n-1,r)})}match(e,t){return this.runFunction(e.args,t,this.metadata("MATCH"),(e,t,n)=>this.doMatch((0,o.zeroIfEmpty)(e),t,n))}searchInRange(e,t,n,r){return!n&&"string"==typeof e&&this.arithmeticHelper.requiresRegex(e)?r.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),t):r.find(e,t,n?{ordering:"asc"}:{ordering:"none",matchExactly:!0})}doVlookup(e,t,n,r){this.dependencyGraph.stats.start(c.StatType.VLOOKUP);var i=t.range;let o;o=void 0===i?d.SimpleRangeValue.onlyValues(t.data.map(e=>[e[0]])):d.SimpleRangeValue.onlyRange(a.AbsoluteCellRange.spanFrom(i.start,1,i.height()),this.dependencyGraph);e=this.searchInRange(e,o,r,this.columnSearch);if(this.dependencyGraph.stats.end(c.StatType.VLOOKUP),-1===e)return new l.CellError(l.ErrorType.NA,u.ErrorMessage.ValueNotFound);let s;return(s=void 0===i?t.data[e][n]:(r=(0,l.simpleCellAddress)(i.sheet,i.start.col+n,i.start.row+e),this.dependencyGraph.getCellValue(r)))instanceof d.SimpleRangeValue?new l.CellError(l.ErrorType.VALUE,u.ErrorMessage.WrongType):s}doHlookup(e,t,n,r){var i=t.range;let o;o=void 0===i?d.SimpleRangeValue.onlyValues([t.data[0]]):d.SimpleRangeValue.onlyRange(a.AbsoluteCellRange.spanFrom(i.start,i.width(),1),this.dependencyGraph);e=this.searchInRange(e,o,r,this.rowSearch);if(-1===e)return new l.CellError(l.ErrorType.NA,u.ErrorMessage.ValueNotFound);let s;return(s=void 0===i?t.data[n][e]:(r=(0,l.simpleCellAddress)(i.sheet,i.start.col+e,i.start.row+n),this.dependencyGraph.getCellValue(r)))instanceof d.SimpleRangeValue?new l.CellError(l.ErrorType.VALUE,u.ErrorMessage.WrongType):s}doMatch(e,t,n){return[-1,0,1].includes(n)?1<t.width()&&1<t.height()?new l.CellError(l.ErrorType.NA):-1===(e=(1===t.width()?this.columnSearch:this.rowSearch).find(e,t,0===n?{ordering:"none",matchExactly:!0}:{ordering:-1===n?"desc":"asc"}))?new l.CellError(l.ErrorType.NA,u.ErrorMessage.ValueNotFound):e+1:new l.CellError(l.ErrorType.VALUE,u.ErrorMessage.BadMode)}}i.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:t.FunctionArgumentType.NOERROR},{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:t.FunctionArgumentType.NOERROR},{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.BOOLEAN,defaultValue:!0}]},MATCH:{method:"match",parameters:[{argumentType:t.FunctionArgumentType.NOERROR},{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{RowSearchStrategy:()=>r});class r extends n(136).AdvancedFind{constructor(e){super(e),this.dependencyGraph=e}find(e,t,n){return this.basicFind(e,t,"col",n)}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{RomanPlugin:()=>s});var r=n(3),i=n(61),o=n(70),t=n(94);class s extends t.FunctionPlugin{roman(e,t){return this.runFunction(e.args,t,this.metadata("ROMAN"),(e,t)=>{return e=Math.trunc(e),!1===t?t=4:!0===t&&(t=0),(t=(0,o.getRawValue)(this.coerceScalarToNumberOrError(t)))instanceof r.CellError?t:(t=Math.trunc(t))<0?new r.CellError(r.ErrorType.VALUE,i.ErrorMessage.ValueSmall):4<t?new r.CellError(r.ErrorType.VALUE,i.ErrorMessage.ValueLarge):(t=t,e={val:(e=e)%1e3,acc:"M".repeat(Math.floor(e/1e3))},4===t&&(l(e,"IM",999,1e3),l(e,"ID",499,500)),3<=t&&(l(e,"VM",995,1e3),l(e,"VD",495,500)),2<=t&&(l(e,"XM",990,1e3),l(e,"XD",490,500)),1<=t&&(l(e,"LM",950,1e3),l(e,"LD",450,500)),l(e,"CM",900,1e3),l(e,"CD",400,500),l(e,"D",500,900),e.acc+="C".repeat(Math.floor(e.val/100)),e.val%=100,2<=t&&(l(e,"IC",99,100),l(e,"IL",49,50)),1<=t&&(l(e,"VC",95,100),l(e,"VL",45,50)),l(e,"XC",90,100),l(e,"XL",40,50),l(e,"L",50,90),e.acc+="X".repeat(Math.floor(e.val/10)),e.val%=10,l(e,"IX",9,10),l(e,"IV",4,5),l(e,"V",5,9),e.acc+="I".repeat(e.val),e.acc)})}arabic(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),e=>{let t=!1;return(e=e.trim().toUpperCase()).startsWith("-")&&(e=e.slice(1),t=!0,""===e)||(a(e={input:e,acc:0},{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),a(e,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),a(e,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),a(e,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),a(e,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),a(e,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),a(e,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),a(e,{token:"IX",val:9}),a(e,{token:"V",val:5},{token:"IV",val:4}),a(e,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),""!==e.input)?new r.CellError(r.ErrorType.VALUE,i.ErrorMessage.InvalidRoman):t?-e.acc:e.acc})}}function a(e,...t){for(const n of t)if(e.input.startsWith(n.token)){e.input=e.input.slice(n.token.length),e.acc+=n.val;break}}function l(e,t,n,r){e.val>=n&&e.val<r&&(e.val-=n,e.acc+=t)}s.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:1,lessThan:4e3},{argumentType:t.FunctionArgumentType.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:t.FunctionArgumentType.STRING}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{SimpleArithmerticPlugin:()=>r});t=n(94);class r extends t.FunctionPlugin{add(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}r.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:t.FunctionArgumentType.STRING,passSubtype:!0},{argumentType:t.FunctionArgumentType.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:t.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,passSubtype:!0}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{StatisticalPlugin:()=>i});var s=n(3),a=n(61),r=n(190),l=n(191),t=n(94);class i extends t.FunctionPlugin{erf(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),(e,t)=>void 0===t?(0,l.erf)(e):(0,l.erf)(t)-(0,l.erf)(e))}erfc(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),l.erfc)}expondist(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),(e,t,n)=>n?l.exponential.cdf(e,t):l.exponential.pdf(e,t))}fisher(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),e=>Math.log((1+e)/(1-e))/2)}fisherinv(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),e=>1-2/(Math.exp(2*e)+1))}gamma(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),l.gammafn)}gammadist(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),(e,t,n,r)=>r?l.gamma.cdf(e,t,n):l.gamma.pdf(e,t,n))}gammaln(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),l.gammaln)}gammainv(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),l.gamma.inv)}gauss(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),e=>l.normal.cdf(e,0,1)-.5)}betadist(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),(e,t,n,r,i,o)=>e<=i?new s.CellError(s.ErrorType.NUM,a.ErrorMessage.ValueSmall):o<=e?new s.CellError(s.ErrorType.NUM,a.ErrorMessage.ValueLarge):(e=(e-i)/(o-i),r?l.beta.cdf(e,t,n):l.beta.pdf(e,t,n)))}betainv(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),(e,t,n,r,i)=>i<=r?new s.CellError(s.ErrorType.NUM,a.ErrorMessage.WrongOrder):l.beta.inv(e,t,n)*(i-r)+r)}binomialdist(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),(e,t,n,r)=>t<e?new s.CellError(s.ErrorType.NUM,a.ErrorMessage.WrongOrder):(e=Math.trunc(e),t=Math.trunc(t),r?l.binomial.cdf(e,t,n):l.binomial.pdf(e,t,n)))}binomialinv(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),(e,t,n)=>{let r=-1,i=e=Math.trunc(e);for(;i>r+1;){var o=Math.trunc((r+i)/2);l.binomial.cdf(o,e,t)>=n?i=o:r=o}return i})}besselifn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),(e,t)=>(0,r.besseli)(e,Math.trunc(t)))}besseljfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),(e,t)=>(0,r.besselj)(e,Math.trunc(t)))}besselkfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),(e,t)=>(0,r.besselk)(e,Math.trunc(t)))}besselyfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),(e,t)=>(0,r.bessely)(e,Math.trunc(t)))}chisqdist(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),(e,t,n)=>(t=Math.trunc(t),n?l.chisquare.cdf(e,t):l.chisquare.pdf(e,t)))}chisqdistrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),(e,t)=>1-l.chisquare.cdf(e,Math.trunc(t)))}chisqinv(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),(e,t)=>l.chisquare.inv(e,Math.trunc(t)))}chisqinvrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),(e,t)=>l.chisquare.inv(1-e,Math.trunc(t)))}fdist(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),(e,t,n,r)=>(t=Math.trunc(t),n=Math.trunc(n),r?l.centralF.cdf(e,t,n):l.centralF.pdf(e,t,n)))}fdistrt(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),(e,t,n)=>1-l.centralF.cdf(e,Math.trunc(t),Math.trunc(n)))}finv(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),(e,t,n)=>l.centralF.inv(e,Math.trunc(t),Math.trunc(n)))}finvrt(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),(e,t,n)=>l.centralF.inv(1-e,Math.trunc(t),Math.trunc(n)))}weibulldist(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),(e,t,n,r)=>r?l.weibull.cdf(e,n,t):l.weibull.pdf(e,n,t))}poissondist(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),(e,t,n)=>(e=Math.trunc(e),n?l.poisson.cdf(e,t):l.poisson.pdf(e,t)))}hypgeomdist(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),(e,t,n,r,i)=>t<e||n<e||r<t||r<n||e+r<n+t?new s.CellError(s.ErrorType.NUM,a.ErrorMessage.ValueLarge):(e=Math.trunc(e),t=Math.trunc(t),n=Math.trunc(n),r=Math.trunc(r),i?l.hypgeom.cdf(e,r,n,t):l.hypgeom.pdf(e,r,n,t)))}tdist(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),(e,t,n)=>(t=Math.trunc(t),n?l.studentt.cdf(e,t):l.studentt.pdf(e,t)))}tdist2t(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),(e,t)=>2*(1-l.studentt.cdf(e,Math.trunc(t))))}tdistrt(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),(e,t)=>1-l.studentt.cdf(e,Math.trunc(t)))}tdistold(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),(e,t,n)=>n*(1-l.studentt.cdf(e,Math.trunc(t))))}tinv(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),(e,t)=>l.studentt.inv(e,Math.trunc(t)))}tinv2t(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),(e,t)=>l.studentt.inv(1-e/2,Math.trunc(t)))}lognormdist(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),(e,t,n,r)=>r?l.lognormal.cdf(e,t,n):l.lognormal.pdf(e,t,n))}lognorminv(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),(e,t,n)=>l.lognormal.inv(e,t,n))}normdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),(e,t,n,r)=>r?l.normal.cdf(e,t,n):l.normal.pdf(e,t,n))}norminv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),(e,t,n)=>l.normal.inv(e,t,n))}normsdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),(e,t)=>t?l.normal.cdf(e,0,1):l.normal.pdf(e,0,1))}normsinv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),e=>l.normal.inv(e,0,1))}phi(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),e=>l.normal.pdf(e,0,1))}negbinomdist(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),(e,t,n,r)=>(e=Math.trunc(e),t=Math.trunc(t),r?l.negbin.cdf(e,t,n):l.negbin.pdf(e,t,n)))}confidencenorm(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),(e,t,n)=>(0,l.normalci)(1,e,t,Math.trunc(n))[1]-1)}confidencet(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),(e,t,n)=>1===(n=Math.trunc(n))?new s.CellError(s.ErrorType.DIV_BY_ZERO):(0,l.tci)(1,e,t,n)[1]-1)}standardize(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),(e,t,n)=>(e-t)/n)}}i.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,lessThan:1},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.BOOLEAN},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0,maxValue:1},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:t.FunctionArgumentType.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1,maxValue:1e10},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1},{argumentType:t.FunctionArgumentType.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0,maxValue:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:t.FunctionArgumentType.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,greaterThan:0}]}},i.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"}},(P,e,t)=>{"use strict";t.r(e),t.d(e,{besseli:()=>L,besselj:()=>m,besselk:()=>F,bessely:()=>D});var d=Math;function c(e,t){for(var n=0,r=0;n<e.length;++n)r=t*r+e[n];return r}function h(e,t,n,r,i){if(0===t)return n;if(1===t)return r;for(var o=2/e,s=r,a=1;a<t;++a)s=r*a*o+i*n,n=r,r=s;return s}function n(n,r,e,i,o){return function(e,t){if(i){if(0===e)return 1==i?-1/0:1/0;if(e<0)return NaN}return 0===t?n(e):1===t?r(e):t<0?NaN:h(e,t|=0,n(e),r(e),o)}}o=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),s=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),a=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),l=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse(),u=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),f=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),p=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),g=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();var o,s,a,l,u,f,p,g,m=function e(t,n){if(n=Math.round(n),!isFinite(t))return isNaN(t)?t:0;if(n<0)return(n%2?-1:1)*e(t,-n);if(t<0)return(n%2?-1:1)*e(-t,n);if(0===n)return y(t);if(1===n)return v(t);if(0===t)return 0;var r=0;if(n<t)r=h(t,n,y(t),v(t),-1);else{for(var i,o=!1,s=0,a=0,l=1,u=2/t,c=2*d.floor((n+d.floor(d.sqrt(40*n)))/2);0<c;c--)i=c*u*l-s,s=l,1e10<d.abs(l=i)&&(l*=1e-10,s*=1e-10,r*=1e-10,a*=1e-10),o&&(a+=l),o=!o,c==n&&(r=s);r/=a=2*a-l}return r};function y(e){var t,n=0,r=0,i=e*e;return e<8?(n=c(o,i))/(r=c(s,i)):(t=e-.785398164,n=c(a,i=64/i),r=c(l,i),d.sqrt(.636619772/e)*(d.cos(t)*n-d.sin(t)*r*8/e))}function v(e){var t=0,n=0,r=0,i=e*e,o=d.abs(e)-2.356194491;return Math.abs(e)<8?t=(n=e*c(u,i))/(r=c(f,i)):(n=c(p,i=64/i),r=c(g,i),t=d.sqrt(.636619772/d.abs(e))*(d.cos(o)*n-d.sin(o)*r*8/d.abs(e)),e<0&&(t=-t)),t}b=.636619772,E=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),C=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),w=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),S=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),T=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),R=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),A=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),_=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();var b,E,C,w,S,T,R,A,_,N,x,O,I,r,i,M,k,D=n(function(e){var t=0,n=0,r=e*e,i=e-.785398164;return e<8?(t=c(E,r))/(n=c(C,r))+b*m(e,0)*d.log(e):(t=c(w,r=64/r),n=c(S,r),d.sqrt(b/e)*(d.sin(i)*t+d.cos(i)*n*8/e))},function(e){var t=0,n=0,r=e*e,i=e-2.356194491;return e<8?(t=e*c(T,r))/(n=c(R,r))+b*(m(e,1)*d.log(e)-1/e):(t=c(A,r=64/r),n=c(_,r),d.sqrt(b/e)*(d.sin(i)*t+d.cos(i)*n*8/e))},0,1,-1),L=(N=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),x=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),O=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),I=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function e(t,n){if(0===(n=Math.round(n)))return(r=t)<=3.75?c(N,r*r/14.0625):d.exp(d.abs(r))/d.sqrt(d.abs(r))*c(x,3.75/d.abs(r));var r;if(1===n)return(r=t)<3.75?r*c(O,r*r/14.0625):(r<0?-1:1)*d.exp(d.abs(r))/d.sqrt(d.abs(r))*c(I,3.75/d.abs(r));if(n<0)return NaN;if(0===d.abs(t))return 0;if(t==1/0)return 1/0;for(var i,o=0,s=2/d.abs(t),a=0,l=1,u=2*d.round((n+d.round(d.sqrt(40*n)))/2);0<u;u--)i=u*s*l+a,a=l,1e10<d.abs(l=i)&&(l*=1e-10,a*=1e-10,o*=1e-10),u==n&&(o=a);return o*=e(t,0)/l,t<0&&n%2?-o:o}),F=(r=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),i=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),M=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),k=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse(),n(function(e){return e<=2?-d.log(e/2)*L(e,0)+c(r,e*e/4):d.exp(-e)/d.sqrt(e)*c(i,2/e)},function(e){return e<=2?d.log(e/2)*L(e,1)+1/e*c(M,e*e/4):d.exp(-e)/d.sqrt(e)*c(k,2/e)},0,2,1))},(P,e,t)=>{"use strict";function r(e){var t,n,r,i=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];let o=i.length-1,s=!1,a=0,l=0;if(0===e)return 0;for(e<0&&(e=-e,s=!0),t=4*(r=2/(2+e))-2;0<o;o--)a=t*(n=a)-l+i[o],l=n;return r=r*Math.exp(-e*e+.5*(i[0]+t*a)-l),s?r-1:1-r}function s(e){return 1-r(e)}function i(e){let t=0,n,r,i,o;if(2<=e)return-100;if(e<=0)return 100;for(o=e<1?e:2-e,i=Math.sqrt(-2*Math.log(o/2)),n=-.70711*((2.30753+.27061*i)/(1+i*(.99229+.04481*i))-i);t<2;t++)r=s(n)-o,n+=r/(1.1283791670955126*Math.exp(-n*n)-n*r);return e<1?n:-n}t.r(e),t.d(e,{beta:()=>d,binomial:()=>v,centralF:()=>T,chisquare:()=>S,corrcoeff:()=>function(e,t){return L(e,t)/D(e,1)/D(t,1)},covariance:()=>L,erf:()=>r,erfc:()=>s,exponential:()=>n,factorial:()=>w,factorialln:()=>C,gamma:()=>a,gammafn:()=>o,gammaln:()=>f,geomean:()=>function(e){return Math.pow(function(e){var t=1,n=e.length;for(;0<=--n;)t*=e[n];return t}(e),1/e.length)},hypgeom:()=>_,lognormal:()=>F,mean:()=>I,negbin:()=>x,normal:()=>u,normalci:()=>function(){var e,t=[].slice.call(arguments),n=new Array(2);e=4===t.length?Math.abs(u.inv(t[1]/2,0,1)*t[2]/Math.sqrt(t[3])):Math.abs(u.inv(t[1]/2,0,1)*D(t[2])/Math.sqrt(t[2].length));return n[0]=t[0]-e,n[1]=t[0]+e,n},poisson:()=>A,stdev:()=>D,studentt:()=>N,sumsqerr:()=>M,tci:()=>function(){var e,t=[].slice.call(arguments),n=new Array(2);e=4===t.length?Math.abs(N.inv(t[1]/2,t[3]-1)*t[2]/Math.sqrt(t[3])):Math.abs(N.inv(t[1]/2,t[2].length-1)*D(t[2],!0)/Math.sqrt(t[2].length));return n[0]=t[0]-e,n[1]=t[0]+e,n},variance:()=>k,weibull:()=>R});const n={pdf:(e,t)=>e<0?0:t*Math.exp(-t*e),cdf:(e,t)=>e<0?0:1-Math.exp(-t*e)};function o(e){var t=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],n=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];let r=!1,i=0,o=0,s=0,a=e,l,u,c,d;if(171.6243769536076<e)return 1/0;if(a<=0){if(!(d=a%1))return 1/0;r=(1&a?-1:1)*Math.PI/Math.sin(Math.PI*d),a=1-a}for(c=a,u=a<1?a++:(a-=i=(0|a)-1)-1,l=0;l<8;++l)s=(s+t[l])*u,o=o*u+n[l];if(d=s/o+1,c<a)d/=c;else if(c>a)for(l=0;l<i;++l)d*=a,a++;return d=r?r/d:d}const a={pdf:function(e,t,n){return e<0?0:0===e&&1===t?1/n:Math.exp((t-1)*Math.log(e)-e/n-f(t)-t*Math.log(n))},cdf:function(e,t,n){return e<0?0:c(t,e/n)},inv:function(e,t,n){return l(e,t)*n}};function f(e){let t=0;var n=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let r=1.000000000190015,i,o,s;for(s=(o=i=e)+5.5,s-=(i+.5)*Math.log(s);t<6;t++)r+=n[t]/++o;return Math.log(2.5066282746310007*r/i)-s}function c(e,t){var n=f(e);let r=e,i=1/e,o=i,s=t+1-e,a=1/1e-30,l=1/s,u=l,c=1;var d,h=-~(8.5*Math.log(1<=e?e:1/e)+.4*e+17);if(t<0||e<=0)return NaN;if(t<e+1){for(;c<=h;c++)i+=o*=t/++r;return i*Math.exp(-t+e*Math.log(t)-n)}for(;c<=h;c++)d=-c*(c-e),s+=2,l=d*l+s,a=s+d/a,l=1/l,u*=l*a;return 1-u*Math.exp(-t+e*Math.log(t)-n)}function l(e,t){let n=0;var r=t-1,i=f(t);let o,s,a,l,u;if(1<=e)return Math.max(100,t+100*Math.sqrt(t));if(e<=0)return 0;for(o=1<t?(l=Math.log(r),u=Math.exp(r*(l-1)-i),s=Math.sqrt(-2*Math.log(e<.5?e:1-e)),o=(2.30753+.27061*s)/(1+s*(.99229+.04481*s))-s,e<.5&&(o=-o),Math.max(.001,t*Math.pow(1-1/(9*t)-o/(3*Math.sqrt(t)),3))):e<(s=1-t*(.253+.12*t))?Math.pow(e/s,1/t):1-Math.log(1-(e-s)/(1-s));n<12;n++){if(o<=0)return 0;if(a=(c(t,o)-e)/(s=1<t?u*Math.exp(-(o-r)+r*(Math.log(o)-l)):Math.exp(-o+r*Math.log(o)-i)),(o-=s=a/(1-.5*Math.min(1,a*((t-1)/o-1))))<=0&&(o=.5*(o+s)),Math.abs(s)<1e-8*o)break}return o}const u={pdf:function(e,t,n){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(e-t,2)/(2*n*n))},cdf:function(e,t,n){return.5*(1+r((e-t)/Math.sqrt(2*n*n)))},inv:function(e,t,n){return-1.4142135623730951*n*i(2*e)+t}},d={pdf:function(e,t,n){return 1<e||e<0?0:1==t&&1==n?1:t<512&&n<512?Math.pow(e,t-1)*Math.pow(1-e,n-1)/h(t,n):Math.exp((t-1)*Math.log(e)+(n-1)*Math.log(1-e)-p(t,n))},cdf:function(e,t,n){return 1<e||e<0?+(1<e):m(e,t,n)},inv:g};function h(e,t){if(!(e<=0||t<=0))return 170<e+t?Math.exp(p(e,t)):o(e)*o(t)/o(e+t)}function p(e,t){return f(e)+f(t)-f(e+t)}function g(e,t,n){var r,i,o,s,a,l,u,c=t-1,d=n-1,h=0;if(e<=0)return 0;if(1<=e)return 1;for(s=1<=t&&1<=n?(s=(2.30753+.27061*(i=Math.sqrt(-2*Math.log(e<.5?e:1-e))))/(1+i*(.99229+.04481*i))-i,l=((s=e<.5?-s:s)*s-3)/6,a=2/(1/(2*t-1)+1/(2*n-1)),l=s*Math.sqrt(l+a)/a-(1/(2*n-1)-1/(2*t-1))*(l+5/6-2/(3*a)),t/(t+n*Math.exp(2*l))):(a=Math.log(t/(t+n)),r=Math.log(n/(t+n)),e<(i=Math.exp(t*a)/t)/(l=i+(o=Math.exp(n*r)/n))?Math.pow(t*l*e,1/t):1-Math.pow(n*l*(1-e),1/n)),u=-f(t)-f(n)+f(t+n);h<10;h++){if(0===s||1===s)return s;if(1<=(s=(s-=i=(o=(m(s,t,n)-e)/(i=Math.exp(c*Math.log(s)+d*Math.log(1-s)+u)))/(1-.5*Math.min(1,o*(c/s-d/(1-s)))))<=0?.5*(s+i):s)&&(s=.5*(s+i+1)),Math.abs(i)<1e-8*s&&0<h)break}return s}function m(e,t,n){var r=0===e||1===e?0:Math.exp(f(t+n)-f(t)-f(n)+t*Math.log(e)+n*Math.log(1-e));return!(e<0||1<e)&&(e<(t+1)/(t+n+2)?r*y(e,t,n)/t:1-r*y(1-e,n,t)/n)}function y(e,t,n){for(var r,i,o=1e-30,s=1,a=t+n,l=t+1,u=t-1,c=1,d=1-a*e/l,h=d=1/(d=Math.abs(d)<o?o:d);s<=100&&(d=1+(r=s*(n-s)*e/((u+(i=2*s))*(t+i)))*d,c=1+r/c,h*=(d=1/(d=Math.abs(d)<o?o:d))*(c=Math.abs(c)<o?o:c),d=1+(r=-(t+s)*(a+s)*e/((t+i)*(l+i)))*d,c=1+r/c,h*=i=(d=1/(d=Math.abs(d)<o?o:d))*(c=Math.abs(c)<o?o:c),!(Math.abs(i-1)<3e-7));s++);return h}const v={pdf:function(e,t,n){return 0===n||1===n?t*n===e?1:0:E(t,e)*Math.pow(n,e)*Math.pow(1-n,t-e)},cdf:function(e,t,n){var r,i;return e<0?0:t<=e?1:n<0||1<n||t<=0?NaN:(n=n,e=(r=(e=Math.floor(e))+1)+(t=t-e),i=Math.exp(f(e)-f(t)-f(r)+r*Math.log(n)+t*Math.log(1-n)),e=n<(r+1)/(e+2)?i*b(n,r,t,1e-10):1-i*b(1-n,t,r,1e-10),Math.round(1e10*(1-e))/1e10)}};function b(e,t,n,r){for(var i,o=0,s=1,a=1,l=1,u=0,c=0;Math.abs((a-c)/a)>r;)s=l+(i=-(t+u)*(t+n+u)*e/(t+2*u)/(t+2*u+1))*s,a=(o=(c=a)+i*o)+(i=(u+=1)*(n-u)*e/(t+2*u-1)/(t+2*u))*a,o/=l=s+i*l,s/=l,a/=l,l=1;return a/t}function E(e,t){return 170<e||170<t?Math.exp((r=t,C(n=e)-C(r)-C(n-r))):w(e)/w(t)/w(e-t);var n,r}function C(e){return e<0?NaN:f(e+1)}function w(e){return e<0?NaN:o(e+1)}const S={pdf:function(e,t){return e<0?0:0===e&&2===t?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-f(t/2))},cdf:function(e,t){return e<0?0:c(t/2,e/2)},inv:function(e,t){return 2*l(e,.5*t)}},T={pdf:function(e,t,n){var r;return e<0?0:t<=2?0===e&&t<2?1/0:0===e&&2===t?1:1/h(t/2,n/2)*Math.pow(t/n,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/n*e,-(t+n)/2):(r=t*e/(n+e*t),t*(n/(n+e*t))/2*v.pdf((t-2)/2,(t+n-2)/2,r))},cdf:function(e,t,n){return e<0?0:m(t*e/(t*e+n),t/2,n/2)},inv:function(e,t,n){return n/(t*(1/g(e,t/2,n/2)-1))}},R={pdf:function(e,t,n){return e<0||t<0||n<0?0:n/t*Math.pow(e/t,n-1)*Math.exp(-Math.pow(e/t,n))},cdf:function(e,t,n){return e<0?0:1-Math.exp(-Math.pow(e/t,n))}},A={pdf:function(e,t){return t<0||e%1!=0||e<0?0:Math.pow(t,e)*Math.exp(-t)/w(e)},cdf:function(e,t){var n=0;if(e<0)return 0;for(var r=0;n<=e;n++)r+=A.pdf(n,t);return r}},_={pdf:function(e,t,n,r){if(e<0||e<n-(t-r))return 0;if(r<e||n<e)return 0;if(t<2*n)return t<2*r?_.pdf(t-n-r+e,t,t-n,t-r):_.pdf(r-e,t,t-n,r);if(t<2*r)return _.pdf(n-e,t,n,t-r);if(n<r)return _.pdf(e,t,r,n);for(var i=1,o=0,s=0;s<e;s++){for(;1<i&&o<r;)i*=1-n/(t-o),o++;i*=(r-s)*(n-s)/((s+1)*(t-n-r+s+1))}for(;o<r;o++)i*=1-n/(t-o);return Math.min(1,Math.max(0,i))},cdf:function e(t,n,r,i){if(t<0||t<r-(n-i))return 0;if(i<=t||r<=t)return 1;if(n<2*r)return n<2*i?e(n-r-i+t,n,n-r,n-i):1-_.cdf(i-t-1,n,n-r,i);if(n<2*i)return 1-_.cdf(r-t-1,n,r,n-i);if(r<i)return _.cdf(t,n,i,r);for(var o=1,s=1,a=0,l=0;l<t;l++){for(;1<o&&a<i;){var u=1-r/(n-a);s*=u,o*=u,a++}o+=s*=(i-l)*(r-l)/((l+1)*(n-r-i+l+1))}for(;a<i;a++)o*=1-r/(n-a);return Math.min(1,Math.max(0,o))}},N={pdf:function(e,t){return t=1e100<t?1e100:t,1/(Math.sqrt(t)*h(.5,t/2))*Math.pow(1+e*e/t,-(t+1)/2)},cdf:function(e,t){var n=t/2;return m((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),n,n)},inv:function(e,t){var n=g(2*Math.min(e,1-e),.5*t,.5),n=Math.sqrt(t*(1-n)/n);return.5<e?n:-n}},F={pdf:function(e,t,n){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(Math.log(e)-t,2)/(2*n*n))},cdf:function(e,t,n){return e<0?0:.5+.5*r((Math.log(e)-t)/Math.sqrt(2*n*n))},inv:function(e,t,n){return Math.exp(-1.4142135623730951*n*i(2*e)+t)}},x={pdf:function(e,t,n){return e===e>>>0&&(e<0?0:E(e+t-1,t-1)*Math.pow(1-n,e)*Math.pow(n,t))},cdf:function(e,t,n){var r=0,i=0;if(e<0)return 0;for(;i<=e;i++)r+=x.pdf(i,t,n);return r}};function O(e){for(var t=0,n=e.length;0<=--n;)t+=e[n];return t}function I(e){return O(e)/e.length}function M(e){for(var t,n=I(e),r=0,i=e.length;0<=--i;)r+=(t=e[i]-n)*t;return r}function k(e,t){return M(e)/(e.length-(t?1:0))}function D(e,t){return Math.sqrt(k(e,t))}function L(e,t){for(var n=I(e),r=I(t),i=e.length,o=new Array(i),s=0;s<i;s++)o[s]=(e[s]-n)*(t[s]-r);return O(o)/(i-1)}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{MathPlugin:()=>r});var l=n(3),u=n(61),t=n(94);class r extends t.FunctionPlugin{fact(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),t=>{t=Math.trunc(t);let n=1;for(let e=1;e<=t;e++)n*=e;return n})}factdouble(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),t=>{let n=1;for(let e=t=Math.trunc(t);1<=e;e-=2)n*=e;return n})}combin(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),(e,t)=>e<t?new l.CellError(l.ErrorType.NUM,u.ErrorMessage.WrongOrder):i(e=Math.trunc(e),t=Math.trunc(t)))}combina(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),(e,t)=>1030<=(e=Math.trunc(e))+(t=Math.trunc(t))-1?new l.CellError(l.ErrorType.NUM,u.ErrorMessage.ValueLarge):0===e&&0===t?1:i(e+t-1,t))}gcd(e,t){return this.runFunction(e.args,t,this.metadata("GCD"),(...e)=>{e=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(e);if(e instanceof l.CellError)return e;let t=0;for(const n of e){if(n<0)return new l.CellError(l.ErrorType.NUM,u.ErrorMessage.ValueSmall);t=o(t,Math.trunc(n))}return t>Number.MAX_SAFE_INTEGER?new l.CellError(l.ErrorType.NUM,u.ErrorMessage.ValueLarge):t})}lcm(e,t){return this.runFunction(e.args,t,this.metadata("LCM"),(...e)=>{var t,n,e=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(e);if(e instanceof l.CellError)return e;let r=1;for(const i of e){if(i<0)return new l.CellError(l.ErrorType.NUM,u.ErrorMessage.ValueSmall);r=(t=r,n=Math.trunc(i),0!==t&&0!==n?t*(n/o(t,n)):0)}return r>Number.MAX_SAFE_INTEGER?new l.CellError(l.ErrorType.NUM,u.ErrorMessage.ValueLarge):r})}mround(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),(e,t)=>0===t?0:0<e&&t<0||e<0&&0<t?new l.CellError(l.ErrorType.NUM,u.ErrorMessage.DistinctSigns):Math.round(e/t)*t)}multinomial(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),(...e)=>{let t=0,n=1;for(var r of e){if(r<0)return new l.CellError(l.ErrorType.NUM,u.ErrorMessage.ValueSmall);r=Math.trunc(r);for(let e=1;e<=r;e++)n*=(t+e)/e;t+=r}return Math.round(n)})}quotient(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),(e,t)=>0===t?new l.CellError(l.ErrorType.DIV_BY_ZERO):Math.trunc(e/t))}seriessum(e,t){return this.runFunction(e.args,t,this.metadata("SERIESSUM"),(e,t,n,r)=>{r=this.arithmeticHelper.manyToOnlyNumbersDropNulls(r.valuesFromTopLeftCorner());if(r instanceof l.CellError)return r;let i=0;r.reverse();for(const o of r)i=(i*=Math.pow(e,n))+o;return i*Math.pow(e,t)})}sign(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),e=>0<e?1:e<0?-1:0)}sumx2my2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),(e,t)=>{var n=e.valuesFromTopLeftCorner(),r=t.valuesFromTopLeftCorner();if(n.length!==r.length)return new l.CellError(l.ErrorType.NA,u.ErrorMessage.EqualLength);var i=n.length;let o=0;for(let e=0;e<i;e++){var s=n[e],a=r[e];if(s instanceof l.CellError)return s;if(a instanceof l.CellError)return a;"number"==typeof s&&"number"==typeof a&&(o+=Math.pow(s,2)-Math.pow(a,2))}return o})}sumx2py2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),(e,t)=>{var n=e.valuesFromTopLeftCorner(),r=t.valuesFromTopLeftCorner();if(n.length!==r.length)return new l.CellError(l.ErrorType.NA,u.ErrorMessage.EqualLength);var i=n.length;let o=0;for(let e=0;e<i;e++){var s=n[e],a=r[e];if(s instanceof l.CellError)return s;if(a instanceof l.CellError)return a;"number"==typeof s&&"number"==typeof a&&(o+=Math.pow(s,2)+Math.pow(a,2))}return o})}sumxmy2(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),(e,t)=>{var n=e.valuesFromTopLeftCorner(),r=t.valuesFromTopLeftCorner();if(n.length!==r.length)return new l.CellError(l.ErrorType.NA,u.ErrorMessage.EqualLength);var i=n.length;let o=0;for(let e=0;e<i;e++){var s=n[e],a=r[e];if(s instanceof l.CellError)return s;if(a instanceof l.CellError)return a;"number"==typeof s&&"number"==typeof a&&(o+=Math.pow(s-a,2))}return o})}}function i(t,n){t<2*n&&(n=t-n);let r=1;for(let e=1;e<=n;e++)r*=(t-n+e)/e;return Math.round(r)}function o(e,t){for(e<t&&([e,t]=[t,e]);0<t;)[e,t]=[t,e%t];return e}r.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0,lessThan:1030},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:t.FunctionArgumentType.NUMBER,minValue:0},{argumentType:t.FunctionArgumentType.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:t.FunctionArgumentType.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ComplexPlugin:()=>i});var a=n(3),r=n(61),l=n(95),t=n(94);class i extends t.FunctionPlugin{complex(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),(e,t,n)=>"i"!==n&&"j"!==n?new a.CellError(a.ErrorType.VALUE,r.ErrorMessage.ShouldBeIorJ):(0,l.coerceComplexToString)([e,t],n))}imabs(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),p)}imaginary(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),([,e])=>e)}imreal(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),([e])=>e)}imargument(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),([e,t])=>0===e&&0===t?new a.CellError(a.ErrorType.DIV_BY_ZERO):Math.atan2(t,e))}imconjugate(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),([e,t])=>(0,l.coerceComplexToString)([e,-t]))}imcos(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),e=>(0,l.coerceComplexToString)(u(e)))}imcosh(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),e=>(0,l.coerceComplexToString)(c(e)))}imcot(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),e=>(0,l.coerceComplexToString)(s(u(e),d(e))))}imcsc(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),e=>(0,l.coerceComplexToString)(s([1,0],d(e))))}imcsch(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),e=>(0,l.coerceComplexToString)(s([1,0],h(e))))}imsec(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),e=>(0,l.coerceComplexToString)(s([1,0],u(e))))}imsech(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),e=>(0,l.coerceComplexToString)(s([1,0],c(e))))}imsin(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),e=>(0,l.coerceComplexToString)(d(e)))}imsinh(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),e=>(0,l.coerceComplexToString)(h(e)))}imtan(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),e=>(0,l.coerceComplexToString)(s(d(e),u(e))))}imdiv(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),(e,t)=>(0,l.coerceComplexToString)(s(e,t)))}improduct(e,t){return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),(...e)=>{e=this.arithmeticHelper.coerceComplexExactRanges(e);if(e instanceof a.CellError)return e;let t=[1,0];for(const n of e)t=o(t,n);return(0,l.coerceComplexToString)(t)})}imsum(e,t){return this.runFunction(e.args,t,this.metadata("IMSUM"),(...e)=>{var t,n,r,i,e=this.arithmeticHelper.coerceComplexExactRanges(e);if(e instanceof a.CellError)return e;let o=[0,0];for(const s of e)o=([[t,n],[r,i]]=[o,s],[t+r,n+i]);return(0,l.coerceComplexToString)(o)})}imsub(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),(e,t)=>{return(0,l.coerceComplexToString)(([[e,t],[n,r]]=[e,t],[e-n,t-r]));var n,r})}imexp(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),e=>(0,l.coerceComplexToString)(f(e)))}imln(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),e=>(0,l.coerceComplexToString)(g(e)))}imlog10(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),e=>{var[e,t]=g(e),n=Math.log(10);return(0,l.coerceComplexToString)([e/n,t/n])})}imlog2(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),e=>{var[e,t]=g(e),n=Math.log(2);return(0,l.coerceComplexToString)([e/n,t/n])})}impower(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),(e,t)=>(0,l.coerceComplexToString)(m(e,t)))}imsqrt(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),e=>(0,l.coerceComplexToString)(m(e,.5)))}}function o([e,t],[n,r]){return[e*n-t*r,e*r+n*t]}function s([e,t],[n,r]){var i=Math.pow(n,2)+Math.pow(r,2),[e,t]=o([e,t],[n,-r]);return[e/i,t/i]}function u([e,t]){return[Math.cos(e)*Math.cosh(t),-Math.sin(e)*Math.sinh(t)]}function c([e,t]){return[Math.cosh(e)*Math.cos(t),Math.sinh(e)*Math.sin(t)]}function d([e,t]){return[Math.sin(e)*Math.cosh(t),Math.cos(e)*Math.sinh(t)]}function h([e,t]){return[Math.sinh(e)*Math.cos(t),Math.cosh(e)*Math.sin(t)]}function f([e,t]){return[Math.exp(e)*Math.cos(t),Math.exp(e)*Math.sin(t)]}function p([e,t]){return Math.sqrt(e*e+t*t)}function g([e,t]){return[Math.log(p([e,t])),Math.atan2(t,e)]}function m(e,t){var[e,n]=g(e);return f([t*e,t*n])}i.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX},{argumentType:t.FunctionArgumentType.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX},{argumentType:t.FunctionArgumentType.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX},{argumentType:t.FunctionArgumentType.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:t.FunctionArgumentType.COMPLEX}]}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{StatisticalAggregationPlugin:()=>r});var u=n(3),c=n(61),l=n(70),d=n(191),t=n(94);class r extends t.FunctionPlugin{avedev(e,t){return this.runFunction(e.args,t,this.metadata("AVEDEV"),(...e)=>{e=this.arithmeticHelper.coerceNumbersExactRanges(e);if(e instanceof u.CellError)return e;if(0===e.length)return new u.CellError(u.ErrorType.DIV_BY_ZERO);const n=(0,d.mean)(e);return e.reduce((e,t)=>e+Math.abs(t-n),0)/e.length})}devsq(e,t){return this.runFunction(e.args,t,this.metadata("DEVSQ"),(...e)=>{e=this.arithmeticHelper.coerceNumbersExactRanges(e);return e instanceof u.CellError?e:0===e.length?0:(0,d.sumsqerr)(e)})}geomean(e,t){return this.runFunction(e.args,t,this.metadata("GEOMEAN"),(...e)=>{e=this.arithmeticHelper.coerceNumbersExactRanges(e);if(e instanceof u.CellError)return e;if(0===e.length)return new u.CellError(u.ErrorType.NUM,c.ErrorMessage.OneValue);for(const t of e)if(t<=0)return new u.CellError(u.ErrorType.NUM,c.ErrorMessage.ValueSmall);return(0,d.geomean)(e)})}harmean(e,t){return this.runFunction(e.args,t,this.metadata("HARMEAN"),(...e)=>{e=this.arithmeticHelper.coerceNumbersExactRanges(e);if(e instanceof u.CellError)return e;if(0===e.length)return new u.CellError(u.ErrorType.NUM,c.ErrorMessage.OneValue);for(const t of e)if(t<=0)return new u.CellError(u.ErrorType.NUM,c.ErrorMessage.ValueSmall);return e.length/e.reduce((e,t)=>e+1/t,0)})}correl(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),(e,t)=>{return e.numberOfElements()!==t.numberOfElements()?new u.CellError(u.ErrorType.NA,c.ErrorMessage.EqualLength):(e=s(e,t))instanceof u.CellError?e:e[0].length<=1?new u.CellError(u.ErrorType.DIV_BY_ZERO,c.ErrorMessage.TwoValues):(0,d.corrcoeff)(e[0],e[1])})}rsq(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),(e,t)=>{return e.numberOfElements()!==t.numberOfElements()?new u.CellError(u.ErrorType.NA,c.ErrorMessage.EqualLength):(e=s(e,t))instanceof u.CellError?e:e[0].length<=1?new u.CellError(u.ErrorType.DIV_BY_ZERO,c.ErrorMessage.TwoValues):Math.pow((0,d.corrcoeff)(e[0],e[1]),2)})}covariancep(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),(e,t)=>{return e.numberOfElements()!==t.numberOfElements()?new u.CellError(u.ErrorType.NA,c.ErrorMessage.EqualLength):(e=s(e,t))instanceof u.CellError?e:(t=e[0].length)<1?new u.CellError(u.ErrorType.DIV_BY_ZERO,c.ErrorMessage.OneValue):1===t?0:(0,d.covariance)(e[0],e[1])*(t-1)/t})}covariances(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),(e,t)=>{return e.numberOfElements()!==t.numberOfElements()?new u.CellError(u.ErrorType.NA,c.ErrorMessage.EqualLength):(e=s(e,t))instanceof u.CellError?e:e[0].length<=1?new u.CellError(u.ErrorType.DIV_BY_ZERO,c.ErrorMessage.TwoValues):(0,d.covariance)(e[0],e[1])})}ztest(e,t){return this.runFunction(e.args,t,this.metadata("Z.TEST"),(e,t,n)=>{e=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(e instanceof u.CellError)return e;var r=e.length;if(void 0===n){if(r<2)return new u.CellError(u.ErrorType.DIV_BY_ZERO,c.ErrorMessage.TwoValues);n=(0,d.stdev)(e,!0)}return r<1?new u.CellError(u.ErrorType.NA,c.ErrorMessage.OneValue):0===n?new u.CellError(u.ErrorType.DIV_BY_ZERO):1-d.normal.cdf(((0,d.mean)(e)-t)/(n/Math.sqrt(r)),0,1)})}ftest(e,t){return this.runFunction(e.args,t,this.metadata("F.TEST"),(e,t)=>{var n,r,e=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),t=this.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());return e instanceof u.CellError?e:t instanceof u.CellError?t:e.length<=1||t.length<=1||(r=(0,d.variance)(e,!0),n=(0,d.variance)(t,!0),0===r)||0===n?new u.CellError(u.ErrorType.DIV_BY_ZERO):(r=d.centralF.cdf(r/n,e.length-1,t.length-1),2*Math.min(r,1-r))})}steyx(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),(e,t)=>{return e.numberOfElements()!==t.numberOfElements()?new u.CellError(u.ErrorType.NA,c.ErrorMessage.EqualLength):(e=s(e,t))instanceof u.CellError?e:(t=e[0].length)<=2?new u.CellError(u.ErrorType.DIV_BY_ZERO,c.ErrorMessage.ThreeValues):Math.sqrt(((0,d.sumsqerr)(e[0])-Math.pow((0,d.covariance)(e[0],e[1])*(t-1),2)/(0,d.sumsqerr)(e[1]))/(t-2))})}slope(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),(e,t)=>{return e.numberOfElements()!==t.numberOfElements()?new u.CellError(u.ErrorType.NA,c.ErrorMessage.EqualLength):(e=s(e,t))instanceof u.CellError?e:(t=e[0].length)<=1?new u.CellError(u.ErrorType.DIV_BY_ZERO,c.ErrorMessage.TwoValues):(0,d.covariance)(e[0],e[1])*(t-1)/(0,d.sumsqerr)(e[1])})}chisqtest(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),(e,t)=>{var n=e.height(),r=e.width();if(t.height()!==n||t.width()!==r)return new u.CellError(u.ErrorType.NA,c.ErrorMessage.EqualLength);var i=s(e,t);if(i instanceof u.CellError)return i;if(i[0].length<=1)return new u.CellError(u.ErrorType.DIV_BY_ZERO,c.ErrorMessage.TwoValues);let o=0;for(let e=0;e<i[0].length;e++){if(0===i[1][e])return new u.CellError(u.ErrorType.DIV_BY_ZERO);o+=Math.pow(i[0][e]-i[1][e],2)/i[1][e]}return o<0?new u.CellError(u.ErrorType.NUM,c.ErrorMessage.NaN):1-d.chisquare.cdf(o,1<n&&1<r?(n-1)*(r-1):n*r-1)})}ttest(e,t){return this.runFunction(e.args,t,this.metadata("T.TEST"),(e,t,n,r)=>{var i=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),o=this.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());if(i instanceof u.CellError)return i;if(o instanceof u.CellError)return o;var s=i.length,e=o.length;if(1!==r)return 2===r?s<=1||e<=1?new u.CellError(u.ErrorType.DIV_BY_ZERO,c.ErrorMessage.TwoValues):0==(t=((0,d.sumsqerr)(i)+(0,d.sumsqerr)(o))/(s+e-2))?new u.CellError(u.ErrorType.DIV_BY_ZERO):(r=Math.abs(((0,d.mean)(i)-(0,d.mean)(o))/Math.sqrt(t*(1/s+1/e))),n*(1-d.studentt.cdf(r,s+e-2))):s<=1||e<=1?new u.CellError(u.ErrorType.DIV_BY_ZERO,c.ErrorMessage.TwoValues):(t=(0,d.variance)(i,!0),r=(0,d.variance)(o,!0),0===t&&0===r?new u.CellError(u.ErrorType.DIV_BY_ZERO):(l=Math.abs(((0,d.mean)(i)-(0,d.mean)(o))/Math.sqrt(t/s+r/e)),t=Math.pow(t/s+r/e,2)/(Math.pow(t/s,2)/(s-1)+Math.pow(r/e,2)/(e-1)),n*(1-d.studentt.cdf(l,t))));if(e!==s)return new u.CellError(u.ErrorType.NA,c.ErrorMessage.EqualLength);if(s<=1)return new u.CellError(u.ErrorType.DIV_BY_ZERO,c.ErrorMessage.TwoValues);var a=Array(s);for(let e=0;e<s;e++)a[e]=i[e]-o[e];var l,r=(0,d.stdev)(a,!0);return 0===r?new u.CellError(u.ErrorType.DIV_BY_ZERO):(l=Math.abs(Math.sqrt(s)*(0,d.mean)(a)/r),n*(1-d.studentt.cdf(l,s-1)))})}skew(e,t){return this.runFunction(e.args,t,this.metadata("SKEW"),(...e)=>{e=this.arithmeticHelper.coerceNumbersExactRanges(e);if(e instanceof u.CellError)return e;var t=e.length;if(t<3)return new u.CellError(u.ErrorType.DIV_BY_ZERO,c.ErrorMessage.ThreeValues);const n=(0,d.mean)(e),r=(0,d.stdev)(e,!0);return 0===r?new u.CellError(u.ErrorType.DIV_BY_ZERO):e.reduce((e,t)=>e+Math.pow((t-n)/r,3),0)*t/(t-1)/(t-2)})}skewp(e,t){return this.runFunction(e.args,t,this.metadata("SKEW.P"),(...e)=>{e=this.arithmeticHelper.coerceNumbersExactRanges(e);if(e instanceof u.CellError)return e;var t=e.length;if(t<3)return new u.CellError(u.ErrorType.DIV_BY_ZERO,c.ErrorMessage.ThreeValues);const n=(0,d.mean)(e),r=(0,d.stdev)(e,!1);return 0===r?new u.CellError(u.ErrorType.DIV_BY_ZERO):e.reduce((e,t)=>e+Math.pow((t-n)/r,3),0)/t})}}function s(e,t){for(var n=e.iterateValuesFromTopLeftCorner(),r=t.iterateValuesFromTopLeftCorner(),i=[],o=[];s=n.next(),a=r.next(),!s.done&&!a.done;){var s=s.value,a=a.value;if(s instanceof u.CellError)return s;if(a instanceof u.CellError)return a;(0,l.isExtendedNumber)(s)&&(0,l.isExtendedNumber)(a)&&(i.push((0,l.getRawValue)(s)),o.push((0,l.getRawValue)(a)))}return[i,o]}r.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.NUMBER},{argumentType:t.FunctionArgumentType.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.RANGE},{argumentType:t.FunctionArgumentType.INTEGER,minValue:1,maxValue:2},{argumentType:t.FunctionArgumentType.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:t.FunctionArgumentType.ANY}],repeatLastArgs:1}},r.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,x(n(197))),o=(t.CellCoords=i.CellCoords,t.CellRange=i.CellRange,n(620)),s=x(n(457)),a=n(543),l=r(n(920)),r=r(n(690)),u=x(n(458)),c=x(n(444)),d=x(n(446)),h=x(n(542)),f=x(n(663)),p=x(n(490)),g=x(n(445)),m=x(n(305)),y=x(n(461)),v=x(n(447)),b=x(n(303)),E=x(n(451)),C=x(n(302)),w=x(n(452)),S=n(453),T=n(464),R=n(465),A=n(591),_=n(459),n=n(688);function N(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(N=function(e){return e?n:t})(e))}function x(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=N(t);if(t&&t.has(e))return t.get(e);var n,r,i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((r=o?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(i,n,r):i[n]=e[n]);return i.default=e,t&&t.set(e,i),i}(0,o.registerAllModules)(),(0,l.default)(i.default),i.default.__GhostTable=r.default,i.default._getListenersCounter=s.getListenersCounter,i.default._getRegisteredMapsCounter=a.getRegisteredMapsCounter,i.default.EventManager=s.default;o=[c,d,h,f,p,g,m,y,v,b,E,u],l=[C,w],i.default.helper={},i.default.dom={},c.arrayEach(o,t=>{c.arrayEach(Object.getOwnPropertyNames(t),e=>{"_"!==e.charAt(0)&&(i.default.helper[e]=t[e])})}),c.arrayEach(l,t=>{c.arrayEach(Object.getOwnPropertyNames(t),e=>{"_"!==e.charAt(0)&&(i.default.dom[e]=t[e])})}),i.default.cellTypes=null!=(r=i.default.cellTypes)?r:{},c.arrayEach((0,A.getRegisteredCellTypeNames)(),e=>{i.default.cellTypes[e]=(0,A.getCellType)(e)}),i.default.cellTypes.registerCellType=A.registerCellType,i.default.cellTypes.getCellType=A.getCellType,i.default.editors=null!=(a=i.default.editors)?a:{},c.arrayEach((0,S.getRegisteredEditorNames)(),e=>{i.default.editors[b.toUpperCaseFirst(e)+"Editor"]=(0,S.getEditor)(e)}),i.default.editors.registerEditor=S.registerEditor,i.default.editors.getEditor=S.getEditor,i.default.renderers=null!=(s=i.default.renderers)?s:{},c.arrayEach((0,T.getRegisteredRendererNames)(),e=>{var t=(0,T.getRenderer)(e);"base"===e&&(i.default.renderers.cellDecorator=t),i.default.renderers[b.toUpperCaseFirst(e)+"Renderer"]=t}),i.default.renderers.registerRenderer=T.registerRenderer,i.default.renderers.getRenderer=T.getRenderer,i.default.validators=null!=(d=i.default.validators)?d:{},c.arrayEach((0,R.getRegisteredValidatorNames)(),e=>{i.default.validators[b.toUpperCaseFirst(e)+"Validator"]=(0,R.getValidator)(e)}),i.default.validators.registerValidator=R.registerValidator,i.default.validators.getValidator=R.getValidator,i.default.plugins=null!=(h=i.default.plugins)?h:{},c.arrayEach((0,_.getPluginsNames)(),e=>{i.default.plugins[e]=(0,_.getPlugin)(e)}),i.default.plugins[b.toUpperCaseFirst(n.BasePlugin.PLUGIN_KEY)+"Plugin"]=n.BasePlugin,i.default.plugins.registerPlugin=_.registerPlugin,i.default.plugins.getPlugin=_.getPlugin,f=i.default;t.default=f},e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(198),n(199),n(200),n(201),r(n(202))),o=n(540),s=n(584),r=r(n(454)),a=n(563),l=n(591),u=n(606),c=n(610),n=n(476);function d(e,t){e=new i.default(e,t||{},o.rootInstanceSymbol);return e.init(),e}t.CellCoords=n.CellCoords,t.CellRange=n.CellRange,(0,l.registerCellType)(u.TextCellType),d.editors={BaseEditor:c.BaseEditor},d.Core=function(e){return new i.default(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o.rootInstanceSymbol)},d.DefaultSettings=(0,s.metaSchemaFactory)(),d.hooks=r.default.getSingleton(),d.CellCoords=n.CellCoords,d.CellRange=n.CellRange,d.packageName="handsontable",d.buildDate="31/08/2023 08:23:39",d.version="13.1.0",d.languages={dictionaryKeys:a.dictionaryKeys,getLanguageDictionary:a.getLanguageDictionary,getLanguagesDictionaries:a.getLanguagesDictionaries,registerLanguageDictionary:a.registerLanguageDictionary,getTranslatedPhrase:a.getTranslatedPhrase},t.default=d},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";var r=n(196),N=(t.__esModule=!0,t.default=function(e,t){let n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],s=!1,P=this;const r=new k.default(P);let f,d,p,g,m=!0;(0,K.hasValidParameter)(n)&&(0,K.registerAsRootInstance)(this);this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const i=null!=(u=null==t?void 0:t.layoutDirection)?u:"inherit",o=["rtl","ltr"].includes(i)?i:this.rootWindow.getComputedStyle(this.rootElement).direction,y=(this.rootElement.setAttribute("dir",o),this.isRtl=function(){return"rtl"===o},this.isLtr=function(){return!P.isRtl()},this.getDirectionFactor=function(){return P.isLtr()?1:-1},t.language=(0,Q.getValidLanguageCode)(t.language),new te.MetaManager(P,t,[te.DynamicCellMetaMod,te.ExtendMetaPropertiesMod])),F=y.getTableMeta(),v=y.getGlobalMeta(),a=(0,ne.createUniqueMap)();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),(0,K.isRootInstance)(this)&&(0,O._injectProductInfo)(t.licenseKey,e);this.guid="ht_"+(0,$.randomString)(),this.columnIndexMapper=new X.IndexMapper,this.rowIndexMapper=new X.IndexMapper,this.columnIndexMapper.addLocalHook("indexesSequenceChange",e=>{P.runHooks("afterColumnSequenceChange",e)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",e=>{P.runHooks("afterRowSequenceChange",e)}),d=new G.default(P),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);const l=e=>{var{row:e,col:t}=e;return P._createCellCoords(0<=e?P.rowIndexMapper.getRenderableFromVisualIndex(e):e,0<=t?P.columnIndexMapper.getRenderableFromVisualIndex(t):t)};let h=new ee.Selection(F,{rowIndexMapper:()=>P.rowIndexMapper,columnIndexMapper:()=>P.columnIndexMapper,countCols:()=>P.countCols(),countRows:()=>P.countRows(),propToCol:e=>f.propToCol(e),isEditorOpened:()=>!!P.getActiveEditor()&&P.getActiveEditor().isOpened(),countColsTranslated:()=>this.view.countRenderableColumns(),countRowsTranslated:()=>this.view.countRenderableRows(),getShortcutManager:()=>P.getShortcutManager(),createCellCoords:(e,t)=>P._createCellCoords(e,t),createCellRange:(e,t,n)=>P._createCellRange(e,t,n),visualToRenderableCoords:l,renderableToVisualCoords:e=>{var{row:e,col:t}=e;return P._createCellCoords(0<=e?P.rowIndexMapper.getVisualFromRenderableIndex(e):e,0<=t?P.columnIndexMapper.getVisualFromRenderableIndex(t):t)},isDisabledCellSelection:(e,t)=>P.getCellMeta(e,t).disableVisualSelection});this.selection=h;var u=e=>{e=e.hiddenIndexesChanged;e&&this.selection.refresh()};function b(n,r){var i="className"===n?P.rootElement:P.table;if(m)(0,N.addClass)(i,r);else{let e=[],t=[];v[n]&&(e=Array.isArray(v[n])?v[n]:(0,H.stringToArray)(v[n])),r&&(t=Array.isArray(r)?r:(0,H.stringToArray)(r));var o=(0,H.getDifferenceOfArrays)(e,t),s=(0,H.getDifferenceOfArrays)(t,e);o.length&&(0,N.removeClass)(i,o),s.length&&(0,N.addClass)(i,s)}v[n]=r}function c(){let e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function E(i,t,n){if(i.length){const l=P.getActiveEditor(),u=new c;let r=!0;u.onQueueEmpty=e=>{l&&r&&l.cancelChanges(),n(e)};for(let e=i.length-1;0<=e;e--){var[o,s,,a]=i[e],s=f.propToCol(s),o=P.getCellMeta(o,s);"numeric"===o.type&&"string"==typeof a&&(0,j.isNumericLike)(a)&&(i[e][3]=(s=void 0,s=(a=a).replace(",","."),!1===isNaN(parseFloat(s))?parseFloat(s):a)),P.getCellValidator(o)&&(u.addValidatorToQueue(),P.validateCell(i[e][3],o,function(t,n){return function(e){if("boolean"!=typeof e)throw new Error("Validation error: result is not boolean");!1===e&&!1===n.allowInvalid&&(r=!1,i.splice(t,1),n.valid=!0,null!==(e=P.getCell(n.visualRow,n.visualCol)))&&(0,N.removeClass)(e,F.invalidCellClassName),u.removeValidatorFormQueue()}}(e,o),t))}u.checkIfQueueIsEmpty()}}function C(t,n){let r=t.length-1;if(!(r<0)){for(;0<=r;r--){let e=!1;if(null===t[r])t.splice(r,1);else if(null!==t[r][2]&&void 0!==t[r][2]||null!==t[r][3]&&void 0!==t[r][3]){if(F.allowInsertRow)for(;t[r][0]>P.countRows()-1;){var i=f.createRow(void 0,void 0,{source:n})["delta"];if(0===i){e=!0;break}}if("array"===P.dataType&&(!F.columns||0===F.columns.length)&&F.allowInsertColumn)for(;f.propToCol(t[r][1])>P.countCols()-1;){var o=f.createCol(void 0,void 0,{source:n})["delta"];if(0===o){e=!0;break}}e||f.set(t[r][0],t[r][1],t[r][3])}}P.forceFullRender=!0,p.adjustRowsAndCols(),P.runHooks("beforeChangeRender",t,n),g.lockEditor(),P._refreshBorders(null),g.unlockEditor(),P.view.adjustElementsSize(),P.runHooks("afterChange",t,n||"edit");var e=P.getActiveEditor();e&&(0,O.isDefined)(e.refreshValue)&&e.refreshValue()}}function w(e,t,n){return Array.isArray(e)?e:[[e,t,n]]}function S(e,t){var n=P.getActiveEditor(),t=P.runHooks("beforeChange",e,t||"edit"),e=e.filter(e=>null!==e);return!1===t||0===e.length?(n&&n.cancelChanges(),[]):e}this.columnIndexMapper.addLocalHook("cacheUpdated",u),this.rowIndexMapper.addLocalHook("cacheUpdated",u),this.selection.addLocalHook("beforeSetRangeStart",e=>{this.runHooks("beforeSetRangeStart",e)}),this.selection.addLocalHook("beforeSetRangeStartOnly",e=>{this.runHooks("beforeSetRangeStartOnly",e)}),this.selection.addLocalHook("beforeSetRangeEnd",e=>{this.runHooks("beforeSetRangeEnd",e),e.row<0&&(e.row=this.view._wt.wtTable.getFirstVisibleRow()),e.col<0&&(e.col=this.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",e=>{var t=(0,B.createObjectPropListener)(!1),n=this.selection.getSelectedRange(),{from:r,to:i}=n.current(),n=n.size()-1,r=(this.runHooks("afterSelection",r.row,r.col,i.row,i.col,t,n),this.runHooks("afterSelectionByProp",r.row,P.colToProp(r.col),i.row,P.colToProp(i.col),t,n),this.selection.isSelectedByAnyHeader()),i=this.selection.selectedRange.current();let o=!0;s&&(o=!1),t.isTouched()&&(o=!t.value);n=this.selection.isSelectedByRowHeader(),t=this.selection.isSelectedByColumnHeader();!1!==o&&(r?n?this.view.scrollViewportVertically(P.rowIndexMapper.getRenderableFromVisualIndex(e.row)):t&&this.view.scrollViewportHorizontally(P.columnIndexMapper.getRenderableFromVisualIndex(e.col)):i&&!this.selection.isMultiple()?this.view.scrollViewport(l(i.from)):this.view.scrollViewport(l(e))),n&&t?(0,N.addClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]):n?((0,N.removeClass)(this.rootElement,"ht__selection--columns"),(0,N.addClass)(this.rootElement,"ht__selection--rows")):t?((0,N.removeClass)(this.rootElement,"ht__selection--rows"),(0,N.addClass)(this.rootElement,"ht__selection--columns")):(0,N.removeClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",e=>{var t=e.length-1,{from:e,to:n}=e[t];this.runHooks("afterSelectionEnd",e.row,e.col,n.row,n.col,t),this.runHooks("afterSelectionEndByProp",e.row,P.colToProp(e.col),n.row,P.colToProp(n.col),t)}),this.selection.addLocalHook("afterIsMultipleSelection",e=>{var t=this.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)}),this.selection.addLocalHook("beforeModifyTransformStart",e=>{this.runHooks("modifyTransformStart",e)}),this.selection.addLocalHook("afterModifyTransformStart",(e,t,n)=>{this.runHooks("afterModifyTransformStart",e,t,n)}),this.selection.addLocalHook("beforeModifyTransformEnd",e=>{this.runHooks("modifyTransformEnd",e)}),this.selection.addLocalHook("afterModifyTransformEnd",(e,t,n)=>{this.runHooks("afterModifyTransformEnd",e,t,n)}),this.selection.addLocalHook("afterDeselect",()=>{g.destroyEditor(),this._refreshBorders(),(0,N.removeClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",e=>{this.alter("insert_row_above",e,1,"auto")}),this.selection.addLocalHook("insertColRequire",e=>{this.alter("insert_col_start",e,1,"auto")}),p={alter(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;let s=3<arguments.length?arguments[3]:void 0;var r=4<arguments.length?arguments[4]:void 0,i=e=>{return 0===e.length?[]:((e=[...e]).sort((e,t)=>{var[e]=e,[t]=t;return e===t?0:t<e?1:-1}),(0,H.arrayReduce)(e,(e,t)=>{var[t,n]=t,r=e[e.length-1],[i,o]=r,i=i+o;return t<=i?(o=Math.max(n-(i-t),0),r[1]+=o):e.push([t,n]),e},[e[0]]))};switch(e){case"insert_row_below":case"insert_row_above":var o=P.countSourceRows();if(F.maxRows===o)return;var a="insert_row_below"===e?"below":"above",{delta:l,startPhysicalIndex:o}=(t=null!=(l=t)?l:"below"==a?o:0,f.createRow(t,n,{source:s,mode:a}));if(l){var a=h.selectedRange.current(),u=null==a?void 0:a.from,c=null==u?void 0:u.row,o=P.toVisualRow(o);if(h.isSelectedByCorner())P.selectAll();else if((0,O.isDefined)(c)&&o<=c){var{row:o,col:a}=a.to;let e=u.col;h.isSelectedByRowHeader()&&(e=-1),h.getSelectedRange().pop(),h.setRangeStartOnly(P._createCellCoords(c+l,e),!0),h.setRangeEnd(P._createCellCoords(o+l,a))}else P._refreshBorders()}break;case"insert_col_start":case"insert_col_end":var u="insert_col_end"===e?"end":"start",{delta:o,startPhysicalIndex:l}=(t=null!=(c=t)?c:"end"==u?P.countSourceCols():0,f.createCol(t,n,{source:s,mode:u}));if(o){Array.isArray(F.colHeaders)&&((a=[P.toVisualColumn(l),0]).length+=o,Array.prototype.splice.apply(F.colHeaders,a));c=h.selectedRange.current(),u=null==c?void 0:c.from,a=null==u?void 0:u.col,l=P.toVisualColumn(l);if(h.isSelectedByCorner())P.selectAll();else if((0,O.isDefined)(a)&&l<=a){var{row:l,col:c}=c.to;let e=u.row;h.isSelectedByColumnHeader()&&(e=-1),h.getSelectedRange().pop(),h.setRangeStartOnly(P._createCellCoords(e,a+o),!0),h.setRangeEnd(P._createCellCoords(l,c+o))}else P._refreshBorders()}break;case"remove_row":u=e=>{let o=0;(0,H.arrayEach)(e,e=>{let[t,n]=e;var r,e=(0,O.isEmpty)(t)?P.countRows()-1:Math.max(t-o,0),i=(Number.isInteger(t)&&(t=Math.max(t-o,0)),f.removeRow(t,n,s));i&&(i=P.countRows(),e+1<=(r=F.fixedRowsTop)&&(F.fixedRowsTop-=Math.min(n,r-e)),(r=F.fixedRowsBottom)&&i-r<=e&&(F.fixedRowsBottom-=Math.min(n,r)),o+=n)})};Array.isArray(t)?u(i(t)):u([[t,n]]),p.adjustRowsAndCols(),P._refreshBorders();break;case"remove_col":a=e=>{let o=0;(0,H.arrayEach)(e,e=>{let[t,n]=e;var r,e=(0,O.isEmpty)(t)?P.countCols()-1:Math.max(t-o,0);let i=P.toPhysicalColumn(e);Number.isInteger(t)&&(t=Math.max(t-o,0)),f.removeCol(t,n,s)&&(e+1<=(r=F.fixedColumnsStart)&&(F.fixedColumnsStart-=Math.min(n,r-e)),Array.isArray(F.colHeaders)&&(void 0===i&&(i=-1),F.colHeaders.splice(i,n)),o+=n)})};Array.isArray(t)?a(i(t)):a([[t,n]]),p.adjustRowsAndCols(),P._refreshBorders();break;default:throw new Error(`There is no such action "${e}"`)}r||p.adjustRowsAndCols()},adjustRowsAndCols(){var t=F.minRows,n=F.minSpareRows,r=F.minCols,i=F.minSpareCols;0===P.countRows()&&0===P.countCols()&&h.deselect(),t&&(o=P.countRows())<t&&f.createRow(o,t-o,{source:"auto"}),n&&(t=P.countEmptyRows(!0))<n&&(o=Math.min(n-t,F.maxRows-P.countSourceRows()),f.createRow(P.countRows(),o,{source:"auto"}));{let e;(r||i)&&(e=P.countEmptyCols(!0));var o,n=P.countCols();r&&!F.columns&&n<r&&(t=r-n,e+=t,f.createCol(n,t,{source:"auto"})),i&&!F.columns&&"array"===P.dataType&&e<i&&(n=P.countCols(),o=i-e,r=Math.min(o,F.maxCols-n),f.createCol(n,r,{source:"auto"}))}if(h.isSelected()){const s=P.countRows(),a=P.countCols();(0,H.arrayEach)(h.selectedRange,e=>{let t=!1,n=e.from.row,r=e.from.col,i=e.to.row,o=e.to.col;n>s-1?(n=s-1,t=!0,i>n&&(i=n)):i>s-1&&(i=s-1,t=!0,n>i)&&(n=i),r>a-1?(r=a-1,t=!0,o>r&&(o=r)):o>a-1&&(o=a-1,t=!0,r>o)&&(r=o),t&&P.selectCell(n,r,i,o)})}P.view&&P.view.adjustElementsSize()},populateFromArray(i,o,s,a,l){let u,c,d,h;var f=[],p={},g=[],m=i.row;const y=i.col;if(0===(c=o.length))return!1;let v=0,b=0;switch((0,B.isObject)(s)&&(v=s.col-y+1,b=s.row-m+1),l){case"shift_down":var E=(0,H.pivot)(o),C=E.length,w=Math.max(C,v),S=P.getData().slice(m),T=(0,H.pivot)(S).slice(y,y+w);for(d=0;d<w;d+=1)if(d<C){for(u=0,c=E[d].length;u<b-c;u+=1)E[d].push(E[d][u%c]);d<T.length?g.push(E[d].concat(T[d])):g.push(E[d].concat(new Array(S.length).fill(null)))}else g.push(E[d%C].concat(T[d]));P.populateFromArray(m,y,(0,H.pivot)(g));break;case"shift_right":var R=o.length,A=Math.max(R,b),_=P.getData().slice(m).map(e=>e.slice(y));for(u=0;u<A;u+=1)if(u<R){for(d=0,h=o[u].length;d<v-h;d+=1)o[u].push(o[u][d%h]);if(u<_.length)for(let e=0;e<_[u].length;e+=1)o[u].push(_[u][e]);else o[u].push(...new Array(_[0].length).fill(null))}else o.push(o[u%c].slice(0,A).concat(_[u]));P.populateFromArray(m,y,o);break;default:p.row=i.row,p.col=i.col;let e=0,n=0,r=!0,t;var N=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,e=o[e%o.length];return null!==t?e[t%e.length]:e},x=o.length,O=s?s.row-i.row+1:0;for(c=s?O:Math.max(x,O),u=0;u<c&&!(s&&p.row>s.row&&x<O||!F.allowInsertRow&&p.row>P.countRows()-1||p.row>=F.maxRows);u++){var I,M,k=u-e,D=N(k).length,L=s?s.col-i.col+1:0;if(h=s?L:Math.max(D,L),p.col=i.col,t=P.getCellMeta(p.row,p.col),"CopyPaste.paste"!==a&&"Autofill.fill"!==a||!t.skipRowOnPaste){for(n=0,d=0;d<h&&!(s&&p.col>s.col&&D<L||!F.allowInsertColumn&&p.col>P.countCols()-1||p.col>=F.maxCols);d++)if(t=P.getCellMeta(p.row,p.col),"CopyPaste.paste"!==a&&"Autofill.fill"!==a||!t.skipColumnOnPaste){if(!t.readOnly||"UndoRedo.undo"===a){let e=N(k,d-n),t=P.getDataAtCell(p.row,p.col);null!==e&&"object"==typeof e?null!==(t=Array.isArray(e)&&null===t?[]:t)&&"object"==typeof t&&(I=(0,B.duckSchema)(!Array.isArray(t)&&t[0]||t),M=(0,B.duckSchema)(!Array.isArray(e)&&e[0]||e),(0,B.isObjectEqual)(I,M)||Array.isArray(I)&&Array.isArray(M))?e=(0,B.deepClone)(e):r=!1:null!==t&&"object"==typeof t&&(r=!1),r&&f.push([p.row,p.col,e]),r=!0}p.col+=1}else n+=1,p.col+=1,h+=1;p.row+=1}else e+=1,p.row+=1,c+=1}P.setDataAtCell(f,null,null,a||"populateFromArray")}}},this.init=function(){d.setData(F.data),P.runHooks("beforeInit"),((0,I.isMobileBrowser)()||(0,I.isIpadOS)())&&(0,N.addClass)(P.rootElement,"mobile"),this.updateSettings(F,!0),this.view=new z.default(this),g=M.default.getInstance(P,F,h),P.runHooks("init"),this.forceFullRender=!0,this.view.render(),m&&null===P.rootElement.offsetParent&&(0,N.observeVisibilityChangeOnce)(P.rootElement,()=>{P.view._wt.wtOverlays.updateLastSpreaderSize(),P.render(),P.view.adjustElementsSize()}),"object"==typeof m&&(P.runHooks("afterChange",m[0],m[1]),m=!1),P.runHooks("afterInit")},this._createCellCoords=function(e,t){return P.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,n){return P.view._wt.createCellRange(e,t,n)},this.validateCell=function(t,i,o,n){let e=P.getCellValidator(i);function r(e,t){var n,r;1<arguments.length&&void 0!==t&&!t||!0===i.hidden||(t=i.visualCol,r=i.visualRow,(n=P.getCell(r,t,!0))&&"TH"!==n.nodeName&&(r=P.rowIndexMapper.getRenderableFromVisualIndex(r),t=P.columnIndexMapper.getRenderableFromVisualIndex(t),P.view._wt.getSetting("cellRenderer",r,t,n))),o(e)}var s;(0,O.isRegExp)(e)&&(e=(s=e,function(e,t){t(s.test(e))})),(0,x.isFunction)(e)?(t=P.runHooks("beforeValidate",t,i.visualRow,i.prop,n),P._registerImmediate(()=>{e.call(i,t,e=>{P&&(e=P.runHooks("afterValidate",e,t,i.visualRow,i.prop,n),r(i.valid=e),P.runHooks("postAfterValidate",e,t,i.visualRow,i.prop,n))})})):P._registerImmediate(()=>{i.valid=!0,r(i.valid,!1)})},this.setDataAtCell=function(e,t,n,r){var i,o=w(e,t,n),s=[];let a=r,l,u;for(l=0,i=o.length;l<i;l++){if("object"!=typeof o[l])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof o[l][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");u=o[l][1]>=this.countCols()?o[l][1]:f.colToProp(o[l][1]),s.push([o[l][0],u,d.getAtCell(this.toPhysicalRow(o[l][0]),o[l][1]),o[l][2]])}a||"object"!=typeof e||(a=t);const c=S(s,r);P.runHooks("afterSetDataAtCell",c,a),E(c,a,()=>{C(c,a)})},this.setDataAtRowProp=function(e,t,n,r){var i,o=w(e,t,n),s=[];let a=r,l;for(l=0,i=o.length;l<i;l++)s.push([o[l][0],o[l][1],d.getAtCell(this.toPhysicalRow(o[l][0]),o[l][1]),o[l][2]]);a||"object"!=typeof e||(a=t);const u=S(s,r);P.runHooks("afterSetDataAtRowProp",u,a),E(u,a,()=>{C(u,a)})},this.listen=function(){P&&!P.isListening()&&(oe=P.guid,P.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(oe=null,P.runHooks("afterUnlisten"))},this.isListening=function(){return oe===P.guid},this.destroyEditor=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];P._refreshBorders(e,t)},this.populateFromArray=function(e,t,n,r,i,o,s){if("object"!=typeof n||"object"!=typeof n[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");r="number"==typeof r?P._createCellCoords(r,i):null;return p.populateFromArray(P._createCellCoords(e,t),n,r,o,s)},this.spliceCol=function(e,t,n){for(var r=arguments.length,i=new Array(3<r?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];return f.spliceCol(e,t,n,...i)},this.spliceRow=function(e,t,n){for(var r=arguments.length,i=new Array(3<r?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];return f.spliceRow(e,t,n,...i)},this.getSelected=function(){if(h.isSelected())return(0,H.arrayMap)(h.getSelectedRange(),e=>{var{from:e,to:t}=e;return[e.row,e.col,t.row,t.col]})},this.getSelectedLast=function(){var e=this.getSelected();let t;return t=e&&0<e.length?e[e.length-1]:t},this.getSelectedRange=function(){if(h.isSelected())return Array.from(h.getSelectedRange())},this.getSelectedRangeLast=function(){var e=this.getSelectedRange();let t;return t=e&&0<e.length?e[e.length-1]:t},this.emptySelectedCells=function(e){if(h.isSelected()&&0!==this.countRows()&&0!==this.countCols()){const i=[];(0,H.arrayEach)(h.getSelectedRange(),e=>{const n=e.getTopStartCorner(),r=e.getBottomEndCorner();(0,j.rangeEach)(n.row,r.row,t=>{(0,j.rangeEach)(n.col,r.col,e=>{this.getCellMeta(t,e).readOnly||i.push([t,e,null])})})}),0<i.length&&this.setDataAtCell(i,e)}},this.isRenderSuspended=function(){return 0<this.renderSuspendedCounter},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(g.lockEditor(),this._refreshBorders(null),g.unlockEditor()))},this.batchRender=function(e){this.suspendRender();e=e();return this.resumeRender(),e},this.isExecutionSuspended=function(){return 0<this.executionSuspendedCounter},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],e=(this.suspendExecution(),e());return this.resumeExecution(t),e},this.batch=function(e){this.suspendRender(),this.suspendExecution();e=e();return this.resumeExecution(),this.resumeRender(),e},this.refreshDimensions=function(){var e,t,n,r,i;P.view&&({width:e,height:t}=P.view.getLastSize(),{width:n,height:r}=P.rootElement.getBoundingClientRect(),i=n!==e||r!==t,!1!==P.runHooks("beforeRefreshDimensions",{width:e,height:t},{width:n,height:r},i))&&(!i&&P.view._wt.wtOverlays.scrollableElement!==P.rootWindow||(P.view.setLastSize(n,r),P.render()),P.runHooks("afterRefreshDimensions",{width:e,height:t},{width:n,height:r},i))},this.updateData=function(e,t){(0,te.replaceData)(e,e=>{f=e},e=>{f=e,P.columnIndexMapper.fitToLength(this.getInitialColumnCount()),P.rowIndexMapper.fitToLength(this.countSourceRows()),p.adjustRowsAndCols()},{hotInstance:P,dataMap:f,dataSource:d,internalSource:"updateData",source:t,metaManager:y,firstRun:m})},this.loadData=function(e,t){(0,te.replaceData)(e,e=>{f=e},()=>{y.clearCellsCache(),P.initIndexMappers(),p.adjustRowsAndCols(),m=m&&[null,"loadData"]},{hotInstance:P,dataMap:f,dataSource:d,internalSource:"loadData",source:t,metaManager:y,firstRun:m})},this.getInitialColumnCount=function(){var e,t=F.columns;let n=0;if(Array.isArray(t))n=t.length;else if((0,x.isFunction)(t))if("array"===P.dataType){var r=this.countSourceCols();for(let e=0;e<r;e+=1)t(e)&&(n+=1)}else"object"!==P.dataType&&"function"!==P.dataType||(n=f.colToPropCache.length);else n=(0,O.isDefined)(F.dataSchema)?(e=f.getSchema(),Array.isArray(e)?e.length:(0,B.deepObjectSize)(e)):this.countSourceCols();return n},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,n,r){return(0,O.isUndefined)(e)?f.getAll():f.getRange(P._createCellCoords(e,t),P._createCellCoords(n,r),f.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,n,r){return f.getCopyableText(P._createCellCoords(e,t),P._createCellCoords(n,r))},this.getCopyableData=function(e,t){return f.getCopyable(e,f.colToProp(t))},this.getSchema=function(){return f.getSchema()},this.updateSettings=function(t){var e,n,r=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=(m?P.loadData:P.updateData).bind(this);let o=!1,s,a;if((0,O.isDefined)(t.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if((0,O.isDefined)(t.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if((0,O.isDefined)(t.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(s in t)"data"!==s&&("language"===s?(e=t.language,n=(n=void 0,J.normalizeLanguageCode)(e),(0,Q.hasLanguageDictionary)(n)?(P.runHooks("beforeLanguageChange",n),v.language=n,P.runHooks("afterLanguageChange",n)):(0,J.warnUserAboutLanguageRegistration)(e)):"className"===s?b("className",t.className):"tableClassName"===s&&P.table?(b("tableClassName",t.tableClassName),P.view._wt.wtOverlays.syncOverlayTableClassNames()):Z.default.getSingleton().isRegistered(s)||Z.default.getSingleton().isDeprecated(s)?((0,x.isFunction)(t[s])||Array.isArray(t[s]))&&(t[s].initialHook=!0,P.addHook(s,t[s])):!r&&(0,B.hasOwnProperty)(t,s)&&(v[s]=t[s]));void 0===t.data&&void 0===F.data?i(null,"updateSettings"):void 0!==t.data?i(t.data,"updateSettings"):void 0!==t.columns&&(f.createMap(),P.initIndexMappers());var l,u=P.countCols(),c=F.columns;if(c&&(0,x.isFunction)(c)&&(o=!0),void 0===t.cell&&void 0===t.cells&&void 0===t.columns||y.clearCache(),0<u)for(s=0,a=0;s<u;s++)c&&(l=o?c(s):c[a])&&y.updateColumnMeta(a,l),a+=1;(0,O.isDefined)(t.cell)&&(0,B.objectEach)(t.cell,e=>{P.setCellMetaObject(e.row,e.col,e)}),P.runHooks("afterCellMetaReset");let d=P.rootElement.style.height,h=(""!==d&&(d=parseInt(P.rootElement.style.height,10)),t.height);if((0,x.isFunction)(h)&&(h=h()),r&&P.rootElement.getAttribute("style")&&P.rootElement.setAttribute("data-initialstyle",P.rootElement.getAttribute("style")),null===h?(i=P.rootElement.getAttribute("data-initialstyle"))&&(-1<i.indexOf("height")||-1<i.indexOf("overflow"))?P.rootElement.setAttribute("style",i):(P.rootElement.style.height="",P.rootElement.style.overflow=""):void 0!==h&&(P.rootElement.style.height=isNaN(h)?""+h:h+"px",P.rootElement.style.overflow="hidden"),void 0!==t.width){let e=t.width;(0,x.isFunction)(e)&&(e=e()),P.rootElement.style.width=isNaN(e)?""+e:e+"px"}r||(P.view&&(P.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),P.view._wt.exportSettingsAsClassNames()),P.runHooks("afterUpdateSettings",t)),p.adjustRowsAndCols(),P.view&&!m&&(P.forceFullRender=!0,g.lockEditor(),P._refreshBorders(null),P.view._wt.wtOverlays.adjustElementsSize(),g.unlockEditor()),r||!P.view||""!==d&&""!==h&&void 0!==h||d===h||P.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var e=P.getSelectedLast();return F.getValue?(0,x.isFunction)(F.getValue)?F.getValue.call(P):e?P.getData()[e[0][0]][F.getValue]:void 0:e?P.getDataAtCell(e[0],e[1]):void 0},this.getSettings=function(){return F},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,n,r,i){p.alter(e,t,n,r,i)},this.getCell=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];let r=t,i=e;if(0<=t){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(0<=e){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;i=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===i||null===r?null:P.view.getCellAtCoords(P._createCellCoords(i,r),n)},this.getCoords=function(e){e=this.view._wt.wtTable.getCoords(e);if(null===e)return null;var{row:e,col:t}=e;let n=e,r=t;return 0<=e&&(n=this.rowIndexMapper.getVisualFromRenderableIndex(e)),0<=t&&(r=this.columnIndexMapper.getVisualFromRenderableIndex(t)),P._createCellCoords(n,r)},this.colToProp=function(e){return f.colToProp(e)},this.propToCol=function(e){return f.propToCol(e)},this.toVisualRow=e=>this.rowIndexMapper.getVisualFromPhysicalIndex(e),this.toVisualColumn=e=>this.columnIndexMapper.getVisualFromPhysicalIndex(e),this.toPhysicalRow=e=>this.rowIndexMapper.getPhysicalFromVisualIndex(e),this.toPhysicalColumn=e=>this.columnIndexMapper.getPhysicalFromVisualIndex(e),this.getDataAtCell=function(e,t){return f.get(e,f.colToProp(t))},this.getDataAtRowProp=function(e,t){return f.get(e,t)},this.getDataAtCol=function(e){var n=[],r=f.getRange(P._createCellCoords(0,e),P._createCellCoords(F.data.length-1,e),f.DESTINATION_RENDERER);for(let t=0;t<r.length;t+=1)for(let e=0;e<r[t].length;e+=1)n.push(r[t][e]);return n},this.getDataAtProp=function(e){var n=[],r=f.getRange(P._createCellCoords(0,f.propToCol(e)),P._createCellCoords(F.data.length-1,f.propToCol(e)),f.DESTINATION_RENDERER);for(let t=0;t<r.length;t+=1)for(let e=0;e<r[t].length;e+=1)n.push(r[t][e]);return n},this.getSourceData=function(e,t,n,r){let i;return i=void 0===e?d.getData():d.getByRange(P._createCellCoords(e,t),P._createCellCoords(n,r))},this.getSourceDataArray=function(e,t,n,r){let i;return i=void 0===e?d.getData(!0):d.getByRange(P._createCellCoords(e,t),P._createCellCoords(n,r),!0)},this.getSourceDataAtCol=function(e){return d.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,n,r){e=w(e,t,n),t=this.hasHook("afterSetSourceDataAtCell");const i=[];t&&(0,H.arrayEach)(e,e=>{var[e,t,n]=e;i.push([e,t,d.getAtCell(e,t),n])}),(0,H.arrayEach)(e,e=>{var[e,t,n]=e;d.setAtCell(e,t,n)}),t&&this.runHooks("afterSetSourceDataAtCell",i,r),this.render();n=P.getActiveEditor();n&&(0,O.isDefined)(n.refreshValue)&&n.refreshValue()},this.getSourceDataAtRow=function(e){return d.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return d.getAtCell(e,t)},this.getDataAtRow=function(e){return f.getRange(P._createCellCoords(e,0),P._createCellCoords(e,this.countCols()-1),f.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,n,r){e=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,n,r];const[i,o]=e;let[,,s,a]=e,l=null,u=null,c=(void 0===s&&(s=i),void 0===a&&(a=o),"mixed");return(0,j.rangeEach)(Math.max(Math.min(i,s),0),Math.max(i,s),t=>{let n=!0;return(0,j.rangeEach)(Math.max(Math.min(o,a),0),Math.max(o,a),e=>{e=this.getCellMeta(t,e);return u=e.type,l?n=l===u:l=u,n}),c=n?u:"mixed",n}),c},this.removeCellMeta=function(e,t,n){var[r,i]=[this.toPhysicalRow(e),this.toPhysicalColumn(t)],o=y.getCellMetaKeyValue(r,i,n);!1!==P.runHooks("beforeRemoveCellMeta",e,t,n,o)&&(y.removeCellMeta(r,i,n),P.runHooks("afterRemoveCellMeta",e,t,n,o))},this.spliceCellsMeta=function(n){for(var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length,r=new Array(2<t?t-2:0),i=2;i<t;i++)r[i-2]=arguments[i];if(0<r.length&&!Array.isArray(r[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");0<e&&y.removeRow(this.toPhysicalRow(n),e),0<r.length&&(0,H.arrayEach)(r.reverse(),e=>{y.createRow(this.toPhysicalRow(n)),(0,H.arrayEach)(e,(e,t)=>this.setCellMetaObject(n,t,e))}),P.render()},this.setCellMetaObject=function(n,r,e){"object"==typeof e&&(0,B.objectEach)(e,(e,t)=>{this.setCellMeta(n,r,t,e)})},this.setCellMeta=function(n,r,i,o){var e=P.runHooks("beforeSetCellMeta",n,r,i,o);if(!1!==e){let e=n,t=r;n<this.countRows()&&(e=this.toPhysicalRow(n)),r<this.countCols()&&(t=this.toPhysicalColumn(r)),y.setCellMeta(e,t,i,o),P.runHooks("afterSetCellMeta",n,r,i,o)}},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(e,t){let n=this.toPhysicalRow(e),r=this.toPhysicalColumn(t);return null===n&&(n=e),null===r&&(r=t),y.getCellMeta(n,r,{visualRow:e,visualColumn:t})},this.getCellMetaAtRow=function(e){return y.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===P.dataType||F.columns)},this.getCellRenderer=function(e,t){t=("number"==typeof e?P.getCellMeta(e,t):e).renderer;return"string"==typeof t?(0,U.getRenderer)(t):(0,O.isUndefined)(t)?(0,U.getRenderer)("text"):t},this.getCellEditor=function(e,t){t=("number"==typeof e?P.getCellMeta(e,t):e).editor;return"string"==typeof t?(0,V.getEditor)(t):(0,O.isUndefined)(t)?(0,V.getEditor)("text"):t},this.getCellValidator=function(e,t){t=("number"==typeof e?P.getCellMeta(e,t):e).validator;return"string"==typeof t?(0,W.getValidator)(t):t},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,n){const r=new c;e&&(r.onQueueEmpty=e);let i=P.countRows()-1;for(;0<=i;){if(void 0!==t&&-1===t.indexOf(i));else{let e=P.countCols()-1;for(;0<=e;)void 0!==n&&-1===n.indexOf(e)||(r.addValidatorToQueue(),P.validateCell(P.getDataAtCell(i,e),P.getCellMeta(i,e),e=>{if("boolean"!=typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(r.valid=!1),r.removeValidatorFormQueue()},"validateCells")),--e}--i}r.checkIfQueueIsEmpty()},this.getRowHeader=function(e){let t=F.rowHeaders,n=e;return void 0===(n=void 0!==n?P.runHooks("modifyRowHeader",n):n)?(t=[],(0,j.rangeEach)(P.countRows()-1,e=>{t.push(P.getRowHeader(e))})):Array.isArray(t)&&void 0!==t[n]?t=t[n]:(0,x.isFunction)(t)?t=t(n):t&&"string"!=typeof t&&"number"!=typeof t&&(t=n+1),t},this.hasRowHeaders=function(){return!!F.rowHeaders},this.hasColHeaders=function(){if(void 0!==F.colHeaders&&null!==F.colHeaders)return!!F.colHeaders;for(let e=0,t=P.countCols();e<t;e++)if(P.getColHeader(e))return!0;return!1},this.getColHeader=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,n=P.runHooks("modifyColHeader",e);if(void 0===n){var r=[],i=P.countCols();for(let e=0;e<i;e++)r.push(P.getColHeader(e));return r}let o=F.colHeaders;var s=P.toPhysicalColumn(n),a=function(e){var t=[],n=P.countCols();let r=0;for(;r<n;r++)(0,x.isFunction)(F.columns)&&F.columns(r)&&t.push(r);return t[e]}(s);return!1===F.colHeaders?o=null:F.columns&&(0,x.isFunction)(F.columns)&&F.columns(a)&&F.columns(a).title?o=F.columns(a).title:F.columns&&F.columns[s]&&F.columns[s].title?o=F.columns[s].title:Array.isArray(F.colHeaders)&&void 0!==F.colHeaders[s]?o=F.colHeaders[s]:(0,x.isFunction)(F.colHeaders)?o=F.colHeaders(s):F.colHeaders&&"string"!=typeof F.colHeaders&&"number"!=typeof F.colHeaders&&(o=(0,Y.spreadsheetColumnLabel)(n)),o=P.runHooks("modifyColumnHeaderValue",o,e,t)},this._getColWidthFromSettings=function(e){let t;var n;if(0<=e&&(n=P.getCellMeta(0,e),t=n.width),void 0!==(t=void 0!==t&&t!==F.width?t:F.colWidths)&&null!==t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e){let t=P._getColWidthFromSettings(e);return t=void 0===(t=P.runHooks("modifyColWidth",t,e))?q.ViewportColumnsCalculator.DEFAULT_WIDTH:t},this._getRowHeightFromSettings=function(e){let t=F.rowHeights;if(void 0!==t&&null!==t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=P._getRowHeightFromSettings(e);return P.runHooks("modifyRowHeight",t,e)},this.countSourceRows=function(){return d.countRows()},this.countSourceCols=function(){return d.countFirstRowKeys()},this.countRows=function(){return f.getLength()},this.countCols=function(){var e=F.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return P.view._wt.drawn?P.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return P.view._wt.drawn?P.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return P.view._wt.drawn?P.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return P.view._wt.drawn?P.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){let t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=0;return(0,j.rangeEachReverse)(P.countRows()-1,e=>{if(P.isEmptyRow(e))n+=1;else if(!0===t)return!1}),n},this.countEmptyCols=function(){let t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=0;return(0,j.rangeEachReverse)(P.countCols()-1,e=>{if(P.isEmptyCol(e))n+=1;else if(!0===t)return!1}),n},this.isEmptyRow=function(e){return F.isEmptyRow.call(P,e)},this.isEmptyCol=function(e){return F.isEmptyCol.call(P,e)},this.selectCell=function(e,t,n,r){var i=!(4<arguments.length&&void 0!==arguments[4])||arguments[4],o=!(5<arguments.length&&void 0!==arguments[5])||arguments[5];return!(0,O.isUndefined)(e)&&!(0,O.isUndefined)(t)&&this.selectCells([[e,t,n,r]],i,o)},this.selectCells=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[[]],t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],t=(!1===t&&(s=!0),h.selectCells(e));return t&&n&&P.listen(),s=!1,t},this.selectColumns=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e;return h.selectColumns(e,t)},this.selectRows=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e;return h.selectRows(e,t)},this.deselectCell=function(){h.deselect()},this.selectAll=function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=e&&this.hasRowHeaders(),e=e&&this.hasColHeaders();s=!0,h.selectAll(t,e),s=!1};const T=(e,t)=>e.getNearestNotHiddenIndex(t,1,!0);this.scrollViewportTo=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r=3<arguments.length&&void 0!==arguments[3]&&arguments[3],i=!n,o=!r;let s=e,a=t;if(!(4<arguments.length&&void 0!==arguments[4])||arguments[4]){const l=Number.isInteger(e),u=Number.isInteger(t);e=l?T(this.rowIndexMapper,e):void 0,t=u?T(this.columnIndexMapper,t):void 0;if(null===e||null===t)return!1;s=l?P.rowIndexMapper.getRenderableFromVisualIndex(e):void 0,a=u?P.columnIndexMapper.getRenderableFromVisualIndex(t):void 0}const l=Number.isInteger(s),u=Number.isInteger(a);return l&&u?P.view.scrollViewport(P._createCellCoords(s,a),i,r,n,o):l&&!1===u?P.view.scrollViewportVertically(s,i,n):!(!u||!1!==l)&&P.view.scrollViewportHorizontally(a,r,o)},this.destroy=function(){var e;P._clearTimeouts(),P._clearImmediates(),P.view&&P.view.destroy(),d&&d.destroy(),d=null,this.getShortcutManager().destroy(),y.clearCache(),(0,K.isRootInstance)(P)&&(e=this.rootDocument.querySelector(".hot-display-license-info"))&&e.parentNode.removeChild(e),(0,N.empty)(P.rootElement),r.destroy(),g&&g.destroy(),P.batchExecution(()=>{P.rowIndexMapper.unregisterAll(),P.columnIndexMapper.unregisterAll(),a.getItems().forEach(e=>{var[,e]=e;e.destroy()}),a.clear(),P.runHooks("afterDestroy")},!0),Z.default.getSingleton().destroy(P),(0,B.objectEach)(P,(e,t,n)=>{var r;(0,x.isFunction)(e)?n[t]=(r=t,()=>{throw new Error(`The "${r}" method cannot be called because this Handsontable instance has been destroyed`)}):"guid"!==t&&(n[t]=null)}),P.isDestroyed=!0,f&&f.destroy(),f=null,p=null,h=null,g=null,P=null},this.getActiveEditor=function(){return g.getActiveEditor()},this.getPlugin=function(e){e=(0,$.toUpperCaseFirst)(e);return"UndoRedo"===e?this.undoRedo:a.getItem(e)},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:a.getId(e)},this.getInstance=function(){return P},this.addHook=function(e,t){Z.default.getSingleton().add(e,t,P)},this.hasHook=function(e){return Z.default.getSingleton().has(e,P)||Z.default.getSingleton().has(e)},this.addHookOnce=function(e,t){Z.default.getSingleton().once(e,t,P)},this.removeHook=function(e,t){Z.default.getSingleton().remove(e,t,P)},this.runHooks=function(e,t,n,r,i,o,s){return Z.default.getSingleton().run(P,e,t,n,r,i,o,s)},this.getTranslatedPhrase=function(e,t){return(0,Q.getTranslatedPhrase)(F.language,e,t)},this.toHTML=()=>(0,D.instanceToHTML)(this),this.toTableElement=()=>{var e=this.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",(0,D.instanceToHTML)(this)),e.firstElementChild},this.timeouts=[],this._registerTimeout=function(e){let t=e;"function"==typeof t&&(t=setTimeout(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0)),this.timeouts.push(t)},this._clearTimeouts=function(){(0,H.arrayEach)(this.timeouts,e=>{clearTimeout(e)})},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){(0,H.arrayEach)(this.immediates,e=>{clearImmediate(e)})},this._refreshBorders=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];g.destroyEditor(e),P.view.render(),t&&h.isSelected()&&g.prepareEditor()},this.isRtl=function(){return"rtl"===P.rootWindow.getComputedStyle(P.rootElement).direction},this.isLtr=function(){return!P.isRtl()},this.getDirectionFactor=function(){return P.isLtr()?1:-1};const R=(0,re.createShortcutManager)({handleEvent(e){var t=P.isListening(),e=void 0!==(null==e?void 0:e.key);return t&&e},beforeKeyDown:e=>this.runHooks("beforeKeyDown",e),afterKeyDown:e=>{this.isDestroyed||P.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow}),A=(this.addHook("beforeOnCellMouseDown",e=>{!1===e.ctrlKey&&!1===e.metaKey&&R.releasePressedKeys()}),this.getShortcutManager=function(){return R},R.addContext("grid")),_={runOnlyIf:()=>(0,O.isDefined)(P.getSelected())&&0<P.countRenderedRows()&&0<P.countRenderedCols(),group:ie};R.setActiveContextName("grid"),A.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>{P.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:()=>{var t=P.getSelectedRange();const{row:r,col:i}=t[t.length-1].highlight,o=P.getDataAtCell(r,i),s=new Map;for(let e=0;e<t.length;e++)t[e].forAll((e,t)=>{var n;0<=e&&0<=t&&(e!==r||t!==i)&&(n=P.getCellMeta(e,t)["readOnly"],n||s.set(e+"x"+t,[e,t,o]))});P.setDataAtCell(Array.from(s.values()))},runOnlyIf:()=>1<P.getSelectedRangeLast().getCellsCount()},{keys:[["ArrowUp"]],callback:()=>{h.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>{h.setRangeStart(P._createCellCoords(P.rowIndexMapper.getNearestNotHiddenIndex(0,1),P.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:()=>{h.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{var{from:e,to:t}=P.getSelectedRangeLast(),n=P.rowIndexMapper.getNearestNotHiddenIndex(0,1);h.setRangeStart(e.clone()),h.setRangeEnd(P._createCellCoords(n,t.col))},runOnlyIf:()=>!(P.selection.isSelectedByCorner()||P.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>{h.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>{h.setRangeStart(P._createCellCoords(P.rowIndexMapper.getNearestNotHiddenIndex(P.countRows()-1,-1),P.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:()=>{h.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{var{from:e,to:t}=P.getSelectedRangeLast(),n=P.rowIndexMapper.getNearestNotHiddenIndex(P.countRows()-1,-1);h.setRangeStart(e.clone()),h.setRangeEnd(P._createCellCoords(n,t.col))},runOnlyIf:()=>!(P.selection.isSelectedByCorner()||P.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>{h.transformStart(0,-1*P.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>{var e=P.getSelectedRangeLast().highlight.row,t=P.columnIndexMapper.getNearestNotHiddenIndex(...P.isRtl()?[P.countCols()-1,-1]:[0,1]);h.setRangeStart(P._createCellCoords(e,t))}},{keys:[["ArrowLeft","Shift"]],callback:()=>{h.transformEnd(0,-1*P.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{var{from:e,to:t}=P.getSelectedRangeLast(),n=P.columnIndexMapper.getNearestNotHiddenIndex(...P.isRtl()?[P.countCols()-1,-1]:[0,1]);h.setRangeStart(e.clone()),h.setRangeEnd(P._createCellCoords(t.row,n))},runOnlyIf:()=>!(P.selection.isSelectedByCorner()||P.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>{h.transformStart(0,P.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>{var e=P.getSelectedRangeLast().highlight.row,t=P.columnIndexMapper.getNearestNotHiddenIndex(...P.isRtl()?[0,1]:[P.countCols()-1,-1]);h.setRangeStart(P._createCellCoords(e,t))}},{keys:[["ArrowRight","Shift"]],callback:()=>{h.transformEnd(0,P.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{var{from:e,to:t}=P.getSelectedRangeLast(),n=P.columnIndexMapper.getNearestNotHiddenIndex(...P.isRtl()?[0,1]:[P.countCols()-1,-1]);h.setRangeStart(e.clone()),h.setRangeEnd(P._createCellCoords(t.row,n))},runOnlyIf:()=>!(P.selection.isSelectedByCorner()||P.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>{var e=parseInt(P.getSettings().fixedColumnsStart,10),t=P.getSelectedRangeLast().highlight.row,e=P.columnIndexMapper.getNearestNotHiddenIndex(e,1);h.setRangeStart(P._createCellCoords(t,e))},runOnlyIf:()=>P.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>{h.setRangeEnd(P._createCellCoords(h.selectedRange.current().from.row,P.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>{var e=parseInt(P.getSettings().fixedRowsTop,10),t=parseInt(P.getSettings().fixedColumnsStart,10),e=P.rowIndexMapper.getNearestNotHiddenIndex(e,1),t=P.columnIndexMapper.getNearestNotHiddenIndex(t,1);h.setRangeStart(P._createCellCoords(e,t))},runOnlyIf:()=>P.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>{h.setRangeStart(P._createCellCoords(P.getSelectedRangeLast().highlight.row,P.columnIndexMapper.getNearestNotHiddenIndex(P.countCols()-1,-1)))},runOnlyIf:()=>P.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>{h.setRangeEnd(P._createCellCoords(h.selectedRange.current().from.row,P.columnIndexMapper.getNearestNotHiddenIndex(P.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>{var e=parseInt(P.getSettings().fixedRowsBottom,10),e=P.rowIndexMapper.getNearestNotHiddenIndex(P.countRows()-e-1,-1),t=P.columnIndexMapper.getNearestNotHiddenIndex(P.countCols()-1,-1);h.setRangeStart(P._createCellCoords(e,t))},runOnlyIf:()=>P.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>{h.transformStart(-P.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:()=>{var e=P.getSelectedRangeLast()["to"],t=Math.max(e.row-P.countVisibleRows(),0),t=P.rowIndexMapper.getNearestNotHiddenIndex(t,1);null!==t&&(t=P._createCellCoords(t,e.col),e=e.row-P.view.getFirstFullyVisibleRow(),e=Math.max(t.row-e,0),h.setRangeEnd(t),P.scrollViewportTo(e))}},{keys:[["PageDown"]],callback:()=>{h.transformStart(P.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:()=>{var e=P.getSelectedRangeLast()["to"],t=Math.min(e.row+P.countVisibleRows(),P.countRows()-1),t=P.rowIndexMapper.getNearestNotHiddenIndex(t,-1);null!==t&&(t=P._createCellCoords(t,e.col),e=e.row-P.view.getFirstFullyVisibleRow(),e=Math.min(t.row-e,P.countRows()-1),h.setRangeEnd(t),P.scrollViewportTo(e))}},{keys:[["Tab"]],callback:e=>{e="function"==typeof F.tabMoves?F.tabMoves(e):F.tabMoves;h.transformStart(e.row,e.col,!0)}},{keys:[["Shift","Tab"]],callback:e=>{e="function"==typeof F.tabMoves?F.tabMoves(e):F.tabMoves;h.transformStart(-e.row,-e.col)}}],_),(0,L.getPluginsNames)().forEach(e=>{var t=(0,L.getPlugin)(e);a.addItem(e,new t(this))}),Z.default.getSingleton().run(P,"construct")},n(203),n(273),n(289),n(302)),x=n(445),O=n(305),I=n(446),M=r(n(450)),k=r(n(457)),B=n(447),H=n(444),D=n(458),L=n(459),U=n(464),V=n(453),W=n(465),$=n(303),j=n(461),z=r(n(466)),G=r(n(541)),Y=n(542),X=n(543),K=n(540),q=n(476),Z=r(n(454)),Q=n(563),J=n(564),ee=n(569),te=n(584),ne=n(462),re=n(600);const ie="gridDefault";let oe=null;new Set},(e,t,n)=>{"use strict";var r=n(204),o=n(241),s=n(265),a=n(270),l=n(272);r({target:"Array",proto:!0,arity:1,forced:n(208)(function(){return 4294967297!==[].push.call({length:4294967296},1)})||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}}()},{push:function(e){var t=o(this),n=s(t),r=arguments.length;l(n+r);for(var i=0;i<r;i++)t[n]=arguments[i],n++;return a(t,n),n}})},(e,t,n)=>{"use strict";var u=n(205),c=n(206).f,d=n(245),h=n(249),f=n(239),p=n(257),g=n(269);e.exports=function(e,t){var n,r,i,o=e.target,s=e.global,a=e.stat,l=s?u:a?u[o]||f(o,{}):(u[o]||{}).prototype;if(l)for(n in t){if(r=t[n],i=e.dontCallGetSet?(i=c(l,n))&&i.value:l[n],!g(s?n:o+(a?".":"#")+n,e.forced)&&void 0!==i){if(typeof r==typeof i)continue;p(r,i)}(e.sham||i&&i.sham)&&d(r,"sham",!0),h(l,n,r,e)}}},function(e){"use strict";function t(e){return e&&e.Math===Math&&e}e.exports=t("object"==typeof globalThis&&globalThis)||t("object"==typeof window&&window)||t("object"==typeof self&&self)||t("object"==typeof global&&global)||function(){return this}()||this||Function("return this")()},(e,t,n)=>{"use strict";var r=n(207),i=n(209),o=n(211),s=n(212),a=n(213),l=n(219),u=n(240),c=n(243),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=a(e),t=l(t),c)try{return d(e,t)}catch(e){}if(u(e,t))return s(!i(o.f,e,t),e[t])}},(e,t,n)=>{"use strict";n=n(208);e.exports=!n(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},e=>{"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},(e,t,n)=>{"use strict";var n=n(210),r=Function.prototype.call;e.exports=n?r.bind(r):function(){return r.apply(r,arguments)}},(e,t,n)=>{"use strict";n=n(208);e.exports=!n(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})},(e,t)=>{"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){e=r(this,e);return!!e&&e.enumerable}:n},e=>{"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},(e,t,n)=>{"use strict";var r=n(214),i=n(217);e.exports=function(e){return r(i(e))}},(e,t,n)=>{"use strict";var r=n(215),i=n(208),o=n(216),s=Object,a=r("".split);e.exports=i(function(){return!s("z").propertyIsEnumerable(0)})?function(e){return"String"===o(e)?a(e,""):s(e)}:s},(e,t,n)=>{"use strict";var n=n(210),r=Function.prototype,i=r.call,r=n&&r.bind.bind(i,i);e.exports=n?r:function(e){return function(){return i.apply(e,arguments)}}},(e,t,n)=>{"use strict";var n=n(215),r=n({}.toString),i=n("".slice);e.exports=function(e){return i(r(e),8,-1)}},(e,t,n)=>{"use strict";var r=n(218),i=TypeError;e.exports=function(e){if(r(e))throw i("Can't call method on "+e);return e}},e=>{"use strict";e.exports=function(e){return null==e}},(e,t,n)=>{"use strict";var r=n(220),i=n(224);e.exports=function(e){e=r(e,"string");return i(e)?e:e+""}},(e,t,n)=>{"use strict";var r=n(209),i=n(221),o=n(224),s=n(231),a=n(234),n=n(235),l=TypeError,u=n("toPrimitive");e.exports=function(e,t){if(!i(e)||o(e))return e;var n=s(e,u);if(n){if(n=r(n,e,t=void 0===t?"default":t),!i(n)||o(n))return n;throw l("Can't convert object to primitive value")}return a(e,t=void 0===t?"number":t)}},(e,t,n)=>{"use strict";var r=n(222),n=n(223),i=n.all;e.exports=n.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:r(e)||e===i}:function(e){return"object"==typeof e?null!==e:r(e)}},(e,t,n)=>{"use strict";var n=n(223),r=n.all;e.exports=n.IS_HTMLDDA?function(e){return"function"==typeof e||e===r}:function(e){return"function"==typeof e}},e=>{"use strict";var t="object"==typeof document&&document.all;e.exports={all:t,IS_HTMLDDA:void 0===t&&void 0!==t}},(e,t,n)=>{"use strict";var r=n(225),i=n(222),o=n(226),n=n(227),s=Object;e.exports=n?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return i(t)&&o(t.prototype,s(e))}},(e,t,n)=>{"use strict";var r=n(205),i=n(222);e.exports=function(e,t){return arguments.length<2?(n=r[e],i(n)?n:void 0):r[e]&&r[e][t];var n}},(e,t,n)=>{"use strict";n=n(215);e.exports=n({}.isPrototypeOf)},(e,t,n)=>{"use strict";n=n(228);e.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},(e,t,n)=>{"use strict";var r=n(229),i=n(208),o=n(205).String;e.exports=!!Object.getOwnPropertySymbols&&!i(function(){var e=Symbol("symbol detection");return!o(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41})},(e,t,n)=>{"use strict";var r,i,o=n(205),n=n(230),s=o.process,o=o.Deno,s=s&&s.versions||o&&o.version,o=s&&s.v8;!(i=o?0<(r=o.split("."))[0]&&r[0]<4?1:+(r[0]+r[1]):i)&&n&&(!(r=n.match(/Edge\/(\d+)/))||74<=r[1])&&(r=n.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},e=>{"use strict";e.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},(e,t,n)=>{"use strict";var r=n(232),i=n(218);e.exports=function(e,t){e=e[t];return i(e)?void 0:r(e)}},(e,t,n)=>{"use strict";var r=n(222),i=n(233),o=TypeError;e.exports=function(e){if(r(e))return e;throw o(i(e)+" is not a function")}},e=>{"use strict";var t=String;e.exports=function(e){try{return t(e)}catch(e){return"Object"}}},(e,t,n)=>{"use strict";var i=n(209),o=n(222),s=n(221),a=TypeError;e.exports=function(e,t){var n,r;if("string"===t&&o(n=e.toString)&&!s(r=i(n,e)))return r;if(o(n=e.valueOf)&&!s(r=i(n,e)))return r;if("string"!==t&&o(n=e.toString)&&!s(r=i(n,e)))return r;throw a("Can't convert object to primitive value")}},(e,t,n)=>{"use strict";var r=n(205),i=n(236),o=n(240),s=n(242),a=n(228),n=n(227),l=r.Symbol,u=i("wks"),c=n?l.for||l:l&&l.withoutSetter||s;e.exports=function(e){return o(u,e)||(u[e]=a&&o(l,e)?l[e]:c("Symbol."+e)),u[e]}},(e,t,n)=>{"use strict";var r=n(237),i=n(238);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.32.1",mode:r?"pure":"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.32.1/LICENSE",source:"https://github.com/zloirock/core-js"})},e=>{"use strict";e.exports=!1},(e,t,n)=>{"use strict";var r=n(205),n=n(239),i="__core-js_shared__",r=r[i]||n(i,{});e.exports=r},(e,t,n)=>{"use strict";var r=n(205),i=Object.defineProperty;e.exports=function(t,n){try{i(r,t,{value:n,configurable:!0,writable:!0})}catch(e){r[t]=n}return n}},(e,t,n)=>{"use strict";var r=n(215),i=n(241),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},(e,t,n)=>{"use strict";var r=n(217),i=Object;e.exports=function(e){return i(r(e))}},(e,t,n)=>{"use strict";var n=n(215),r=0,i=Math.random(),o=n(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+o(++r+i,36)}},(e,t,n)=>{"use strict";var r=n(207),i=n(208),o=n(244);e.exports=!r&&!i(function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a})},(e,t,n)=>{"use strict";var r=n(205),n=n(221),i=r.document,o=n(i)&&n(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},(e,t,n)=>{"use strict";var r=n(207),i=n(246),o=n(212);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},(e,t,n)=>{"use strict";var r=n(207),i=n(243),o=n(247),s=n(248),a=n(219),l=TypeError,u=Object.defineProperty,c=Object.getOwnPropertyDescriptor,d="enumerable",h="configurable",f="writable";t.f=r?o?function(e,t,n){var r;return s(e),t=a(t),s(n),"function"==typeof e&&"prototype"===t&&"value"in n&&f in n&&!n[f]&&(r=c(e,t))&&r[f]&&(e[t]=n.value,n={configurable:(h in n?n:r)[h],enumerable:(d in n?n:r)[d],writable:!1}),u(e,t,n)}:u:function(e,t,n){if(s(e),t=a(t),s(n),i)try{return u(e,t,n)}catch(e){}if("get"in n||"set"in n)throw l("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},(e,t,n)=>{"use strict";var r=n(207),n=n(208);e.exports=r&&n(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},(e,t,n)=>{"use strict";var r=n(221),i=String,o=TypeError;e.exports=function(e){if(r(e))return e;throw o(i(e)+" is not an object")}},(e,t,n)=>{"use strict";var s=n(222),a=n(246),l=n(250),u=n(239);e.exports=function(e,t,n,r){var i=(r=r||{}).enumerable,o=void 0!==r.name?r.name:t;if(s(n)&&l(n,o,r),r.global)i?e[t]=n:u(t,n);else{try{r.unsafe?e[t]&&(i=!0):delete e[t]}catch(e){}i?e[t]=n:a.f(e,t,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return e}},(e,t,n)=>{"use strict";var r=n(215),i=n(208),o=n(222),s=n(240),a=n(207),l=n(251).CONFIGURABLE,u=n(252),n=n(253),c=n.enforce,d=n.get,h=String,f=Object.defineProperty,p=r("".slice),g=r("".replace),m=r([].join),y=a&&!i(function(){return 8!==f(function(){},"length",{value:8}).length}),v=String(String).split("String"),n=e.exports=function(e,t,n){"Symbol("===p(h(t),0,7)&&(t="["+g(h(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!s(e,"name")||l&&e.name!==t)&&(a?f(e,"name",{value:t,configurable:!0}):e.name=t),y&&n&&s(n,"arity")&&e.length!==n.arity&&f(e,"length",{value:n.arity});try{n&&s(n,"constructor")&&n.constructor?a&&f(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}n=c(e);return s(n,"source")||(n.source=m(v,"string"==typeof t?t:"")),e};Function.prototype.toString=n(function(){return o(this)&&d(this).source||u(this)},"toString")},(e,t,n)=>{"use strict";var r=n(207),n=n(240),i=Function.prototype,o=r&&Object.getOwnPropertyDescriptor,n=n(i,"name"),s=n&&"something"===function(){}.name,r=n&&(!r||o(i,"name").configurable);e.exports={EXISTS:n,PROPER:s,CONFIGURABLE:r}},(e,t,n)=>{"use strict";var r=n(215),i=n(222),n=n(238),o=r(Function.toString);i(n.inspectSource)||(n.inspectSource=function(e){return o(e)}),e.exports=n.inspectSource},(e,t,n)=>{"use strict";var r,i,o,s,a=n(254),l=n(205),u=n(221),c=n(245),d=n(240),h=n(238),f=n(255),n=n(256),p="Object already initialized",g=l.TypeError,l=l.WeakMap,m=a||h.state?((o=h.state||(h.state=new l)).get=o.get,o.has=o.has,o.set=o.set,r=function(e,t){if(o.has(e))throw g(p);return t.facade=e,o.set(e,t),t},i=function(e){return o.get(e)||{}},function(e){return o.has(e)}):(n[s=f("state")]=!0,r=function(e,t){if(d(e,s))throw g(p);return t.facade=e,c(e,s,t),t},i=function(e){return d(e,s)?e[s]:{}},function(e){return d(e,s)});e.exports={set:r,get:i,has:m,enforce:function(e){return m(e)?i(e):r(e,{})},getterFor:function(t){return function(e){if(u(e)&&(e=i(e)).type===t)return e;throw g("Incompatible receiver, "+t+" required")}}}},(e,t,n)=>{"use strict";var r=n(205),n=n(222),r=r.WeakMap;e.exports=n(r)&&/native code/.test(String(r))},(e,t,n)=>{"use strict";var r=n(236),i=n(242),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},e=>{"use strict";e.exports={}},(e,t,n)=>{"use strict";var l=n(240),u=n(258),c=n(206),d=n(246);e.exports=function(e,t,n){for(var r=u(t),i=d.f,o=c.f,s=0;s<r.length;s++){var a=r[s];l(e,a)||n&&l(n,a)||i(e,a,o(t,a))}}},(e,t,n)=>{"use strict";var r=n(225),i=n(215),o=n(259),s=n(268),a=n(248),l=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(a(e)),n=s.f;return n?l(t,n(e)):t}},(e,t,n)=>{"use strict";var r=n(260),i=n(267).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},(e,t,n)=>{"use strict";var r=n(215),s=n(240),a=n(213),l=n(261).indexOf,u=n(256),c=r([].push);e.exports=function(e,t){var n,r=a(e),i=0,o=[];for(n in r)!s(u,n)&&s(r,n)&&c(o,n);for(;t.length>i;)!s(r,n=t[i++])||~l(o,n)||c(o,n);return o}},(e,t,n)=>{"use strict";function r(a){return function(e,t,n){var r,i=l(e),o=c(i),s=u(n,o);if(a&&t!=t){for(;s<o;)if((r=i[s++])!=r)return!0}else for(;s<o;s++)if((a||s in i)&&i[s]===t)return a||s||0;return!a&&-1}}var l=n(213),u=n(262),c=n(265);e.exports={includes:r(!0),indexOf:r(!1)}},(e,t,n)=>{"use strict";var r=n(263),i=Math.max,o=Math.min;e.exports=function(e,t){e=r(e);return e<0?i(e+t,0):o(e,t)}},(e,t,n)=>{"use strict";var r=n(264);e.exports=function(e){e=+e;return e!=e||0==e?0:r(e)}},e=>{"use strict";var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){e=+e;return(0<e?n:t)(e)}},(e,t,n)=>{"use strict";var r=n(266);e.exports=function(e){return r(e.length)}},(e,t,n)=>{"use strict";var r=n(263),i=Math.min;e.exports=function(e){return 0<e?i(r(e),9007199254740991):0}},e=>{"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},(e,t)=>{"use strict";t.f=Object.getOwnPropertySymbols},(e,t,n)=>{"use strict";function r(e,t){return(e=l[a(e)])===c||e!==u&&(o(t)?i(t):!!t)}var i=n(208),o=n(222),s=/#|\.prototype\./,a=r.normalize=function(e){return String(e).replace(s,".").toLowerCase()},l=r.data={},u=r.NATIVE="N",c=r.POLYFILL="P";e.exports=r},(e,t,n)=>{"use strict";var r=n(207),i=n(271),o=TypeError,s=Object.getOwnPropertyDescriptor,n=r&&!function(){if(void 0!==this)return 1;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=n?function(e,t){if(i(e)&&!s(e,"length").writable)throw o("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},(e,t,n)=>{"use strict";var r=n(216);e.exports=Array.isArray||function(e){return"Array"===r(e)}},e=>{"use strict";var t=TypeError;e.exports=function(e){if(9007199254740991<e)throw t("Maximum allowed index exceeded");return e}},(e,t,n)=>{"use strict";function r(e,t){var n={};n[e]=l(e,t,d),o({global:!0,constructor:!0,arity:1,forced:d},n)}function i(e,t){var n;c&&c[e]&&((n={})[e]=l(u+"."+e,t,d),o({target:u,stat:!0,constructor:!0,arity:1,forced:d},n))}var o=n(204),s=n(205),a=n(274),l=n(275),u="WebAssembly",c=s[u],d=7!==Error("e",{cause:7}).cause;r("Error",function(t){return function(e){return a(t,this,arguments)}}),r("EvalError",function(t){return function(e){return a(t,this,arguments)}}),r("RangeError",function(t){return function(e){return a(t,this,arguments)}}),r("ReferenceError",function(t){return function(e){return a(t,this,arguments)}}),r("SyntaxError",function(t){return function(e){return a(t,this,arguments)}}),r("TypeError",function(t){return function(e){return a(t,this,arguments)}}),r("URIError",function(t){return function(e){return a(t,this,arguments)}}),i("CompileError",function(t){return function(e){return a(t,this,arguments)}}),i("LinkError",function(t){return function(e){return a(t,this,arguments)}}),i("RuntimeError",function(t){return function(e){return a(t,this,arguments)}})},(e,t,n)=>{"use strict";var n=n(210),r=Function.prototype,i=r.apply,o=r.call;e.exports="object"==typeof Reflect&&Reflect.apply||(n?o.bind(i):function(){return o.apply(i,arguments)})},(e,t,n)=>{"use strict";var c=n(225),d=n(240),h=n(245),f=n(226),p=n(276),g=n(257),m=n(279),y=n(280),v=n(281),b=n(285),E=n(286),C=n(207),w=n(237);e.exports=function(e,t,n,r){var i="stackTraceLimit",o=r?2:1,e=e.split("."),s=e[e.length-1],a=c.apply(null,e);if(a){var l=a.prototype;if(!w&&d(l,"cause")&&delete l.cause,!n)return a;var e=c("Error"),u=t(function(e,t){t=v(r?t:e,void 0),e=r?new a(e):new a;return void 0!==t&&h(e,"message",t),E(e,u,e.stack,2),this&&f(l,this)&&y(e,this,u),o<arguments.length&&b(e,arguments[o]),e});if(u.prototype=l,"Error"!==s?p?p(u,e):g(u,e,{name:!0}):C&&i in a&&(m(u,a,i),m(u,a,"prepareStackTrace")),g(u,a),!w)try{l.name!==s&&h(l,"name",s),l.constructor=u}catch(e){}return u}}},(e,t,n)=>{"use strict";var i=n(277),o=n(248),s=n(278);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var n,r=!1,e={};try{(n=i(Object.prototype,"__proto__","set"))(e,[]),r=e instanceof Array}catch(e){}return function(e,t){return o(e),s(t),r?n(e,t):e.__proto__=t,e}}():void 0)},(e,t,n)=>{"use strict";var r=n(215),i=n(232);e.exports=function(e,t,n){try{return r(i(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(e){}}},(e,t,n)=>{"use strict";var r=n(222),i=String,o=TypeError;e.exports=function(e){if("object"==typeof e||r(e))return e;throw o("Can't set "+i(e)+" as a prototype")}},(e,t,n)=>{"use strict";var r=n(246).f;e.exports=function(e,t,n){n in e||r(e,n,{configurable:!0,get:function(){return t[n]},set:function(e){t[n]=e}})}},(e,t,n)=>{"use strict";var r=n(222),i=n(221),o=n(276);e.exports=function(e,t,n){return o&&r(t=t.constructor)&&t!==n&&i(t=t.prototype)&&t!==n.prototype&&o(e,t),e}},(e,t,n)=>{"use strict";var r=n(282);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:r(e)}},(e,t,n)=>{"use strict";var r=n(283),i=String;e.exports=function(e){if("Symbol"===r(e))throw TypeError("Cannot convert a Symbol value to a string");return i(e)}},(e,t,n)=>{"use strict";var r=n(284),i=n(222),o=n(216),s=n(235)("toStringTag"),a=Object,l="Arguments"===o(function(){return arguments}());e.exports=r?o:function(e){var t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(t=function(e,t){try{return e[t]}catch(e){}}(e=a(e),s))?t:l?o(e):"Object"===(t=o(e))&&i(e.callee)?"Arguments":t}},(e,t,n)=>{"use strict";var r={};r[n(235)("toStringTag")]="z",e.exports="[object z]"===String(r)},(e,t,n)=>{"use strict";var r=n(221),i=n(245);e.exports=function(e,t){r(t)&&"cause"in t&&i(e,"cause",t.cause)}},(e,t,n)=>{"use strict";var i=n(245),o=n(287),s=n(288),a=Error.captureStackTrace;e.exports=function(e,t,n,r){s&&(a?a(e,t):i(e,"stack",o(n,r)))}},(e,t,n)=>{"use strict";var n=n(215),r=Error,i=n("".replace),n=String(r("zxcasd").stack),o=/\n\s*at [^:]*:[^\n]*/,s=o.test(n);e.exports=function(e,t){if(s&&"string"==typeof e&&!r.prepareStackTrace)for(;t--;)e=i(e,o,"");return e}},(e,t,n)=>{"use strict";var r=n(208),i=n(212);e.exports=!r(function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",i(1,7)),7!==e.stack)})},(e,t,n)=>{"use strict";n(290),n(299)},(e,t,n)=>{"use strict";var r=n(204),i=n(205),n=n(291).clear;r({global:!0,bind:!0,enumerable:!0,forced:i.clearImmediate!==n},{clearImmediate:n})},(e,t,n)=>{"use strict";function r(e){return function(){x(e)}}function i(e){x(e.data)}function o(e){l.postMessage(R(e),s.protocol+"//"+s.host)}var s,a,l=n(205),u=n(274),c=n(292),d=n(222),h=n(240),f=n(208),p=n(294),g=n(295),m=n(244),y=n(296),v=n(297),n=n(298),b=l.setImmediate,E=l.clearImmediate,C=l.process,w=l.Dispatch,S=l.Function,T=l.MessageChannel,R=l.String,A=0,_={},N="onreadystatechange",x=(f(function(){s=l.location}),function(e){var t;h(_,e)&&(t=_[e],delete _[e],t())});b&&E||(b=function(e){y(arguments.length,1);var t=d(e)?e:S(e),n=g(arguments,1);return _[++A]=function(){u(t,void 0,n)},a(A),A},E=function(e){delete _[e]},n?a=function(e){C.nextTick(r(e))}:w&&w.now?a=function(e){w.now(r(e))}:T&&!v?(v=(n=new T).port2,n.port1.onmessage=i,a=c(v.postMessage,v)):l.addEventListener&&d(l.postMessage)&&!l.importScripts&&s&&"file:"!==s.protocol&&!f(o)?(a=o,l.addEventListener("message",i,!1)):a=N in m("script")?function(e){p.appendChild(m("script"))[N]=function(){p.removeChild(this),x(e)}}:function(e){setTimeout(r(e),0)}),e.exports={set:b,clear:E}},(e,t,n)=>{"use strict";var r=n(293),i=n(232),o=n(210),s=r(r.bind);e.exports=function(e,t){return i(e),void 0===t?e:o?s(e,t):function(){return e.apply(t,arguments)}}},(e,t,n)=>{"use strict";var r=n(216),i=n(215);e.exports=function(e){if("Function"===r(e))return i(e)}},(e,t,n)=>{"use strict";n=n(225);e.exports=n("document","documentElement")},(e,t,n)=>{"use strict";n=n(215);e.exports=n([].slice)},e=>{"use strict";var n=TypeError;e.exports=function(e,t){if(e<t)throw n("Not enough arguments");return e}},(e,t,n)=>{"use strict";n=n(230);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(n)},(e,t,n)=>{"use strict";var r=n(205),n=n(216);e.exports="process"===n(r.process)},(e,t,n)=>{"use strict";var r=n(204),i=n(205),o=n(291).set,n=n(300),n=i.setImmediate?n(o,!1):o;r({global:!0,bind:!0,enumerable:!0,forced:i.setImmediate!==n},{setImmediate:n})},(e,t,n)=>{"use strict";var r=n(205),l=n(274),u=n(222),i=n(301),o=n(230),c=n(295),d=n(296),h=r.Function,f=/MSIE .\./.test(o)||i&&((n=r.Bun.version.split(".")).length<3||"0"===n[0]&&(n[1]<3||"3"===n[1]&&"0"===n[2]));e.exports=function(o,s){var a=s?2:1;return f?function(e,t){var n=d(arguments.length,1)>a,r=u(e)?e:h(e),i=n?c(arguments,a):[],e=n?function(){l(r,this,i)}:r;return s?o(e,t):o(e)}:o}},e=>{"use strict";e.exports="function"==typeof Bun&&Bun&&"string"==typeof Bun.version},(e,t,n)=>{"use strict";t.__esModule=!0,t.addClass=function(e,t){"string"==typeof t&&(t=t.split(" "));0<(t=s(t)).length&&e.classList.add(...t)},t.addEvent=function(e,t,n){e.addEventListener(t,n,!1)},t.clearTextSelection=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:window;e.getSelection&&(e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges())},t.closest=o,t.closestDown=function(e,t,n){var r=[];let i=e;for(;(i=i&&o(i,t,n))&&(!n||n.contains(i));)r.push(i),i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode;e=r.length;return e?r[e-1]:null},t.empty=a,t.fastInnerHTML=function(e,t){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];l.test(t)?e.innerHTML=n?(0,r.sanitize)(t):t:u(e,t)},t.fastInnerText=u,t.getCaretPosition=function(e){if(e.selectionStart)return e.selectionStart;return 0},t.getComputedStyle=h,t.getCssTransform=function(e){let t;if(e.style.transform&&""!==(t=e.style.transform))return["transform",t];return-1},t.getFrameElement=i,t.getParent=function(e){let t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=-1,r=null,i=e;for(;null!==i;){if(n===t){r=i;break}i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:(n+=1,i.parentNode)}return r},t.getParentWindow=function(e){return i(e)&&e.parent},t.getScrollLeft=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window;return e!==t?e.scrollLeft:d(t)},t.getScrollTop=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window;return e!==t?e.scrollTop:c(t)},t.getScrollableElement=function(e){let t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document||e,r=t.defaultView);var i=["auto","scroll"];let o=e.parentNode;for(;o&&o.style&&t.body!==o;){let{overflow:e,overflowX:t,overflowY:n}=o.style;if([e,t,n].includes("scroll"))return o;if({overflow:e,overflowX:t,overflowY:n}=r.getComputedStyle(o),i.includes(e)||i.includes(t)||i.includes(n))return o;if(o.clientHeight<=o.scrollHeight+1&&(i.includes(n)||i.includes(e)))return o;if(o.clientWidth<=o.scrollWidth+1&&(i.includes(t)||i.includes(e)))return o;o=o.parentNode}return r},t.getScrollbarWidth=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:document;void 0===f&&(f=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:document;var t=e.createElement("div"),n=(t.style.height="200px",t.style.width="100%",e.createElement("div")),r=(n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(t),(e.body||e.documentElement).appendChild(n),t.offsetWidth);n.style.overflow="scroll";let i=t.offsetWidth;r===i&&(i=n.clientWidth);return(e.body||e.documentElement).removeChild(n),r-i}(e));return f},t.getSelectionEndPosition=function(e){if(e.selectionEnd)return e.selectionEnd;return 0},t.getSelectionText=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:window;var t=e.document;let n="";e.getSelection?n=e.getSelection().toString():t.selection&&"Control"!==t.selection.type&&(n=t.selection.createRange().text);return n},t.getStyle=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:window;var r;if(e)return e===n?"width"===t?n.innerWidth+"px":"height"===t?n.innerHeight+"px":void 0:""!==(r=e.style[t])&&void 0!==r?r:""!==(r=h(e,n))[t]&&void 0!==r[t]?r[t]:void 0},t.getTrimmingContainer=function(e){var t=e.ownerDocument,n=t.defaultView;let r=e.parentNode;for(;r&&r.style&&t.body!==r;){if("visible"!==r.style.overflow&&""!==r.style.overflow)return r;var i=h(r,n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),i=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(i))return r;r=r.parentNode}return n},t.getWindowScrollLeft=d,t.getWindowScrollTop=c,t.hasAccessToParentWindow=function(e){return!!Object.getPrototypeOf(e.parent)},t.hasClass=function(e,t){return void 0!==e.classList&&"string"==typeof t&&""!==t&&e.classList.contains(t)},t.hasHorizontalScrollbar=function(e){return e.offsetHeight!==e.clientHeight},t.hasVerticalScrollbar=function(e){return e.offsetWidth!==e.clientWidth},t.index=function(e){let t=0,n=e;if(n.previousSibling)for(;n=n.previousSibling;)t+=1;return t},t.innerHeight=function(e){return e.clientHeight||e.innerHeight},t.innerWidth=function(e){return e.clientWidth||e.innerWidth},t.isChildOf=function(e,t){let n=e.parentNode,r=[];"string"==typeof t?r=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):r.push(t);for(;null!==n;){if(-1<r.indexOf(n))return!0;n=n.parentNode}return!1},t.isDetached=function(e){return!e.parentNode},t.isInput=p,t.isOutsideInput=g,t.isVisible=function e(t){const n=t.ownerDocument.documentElement;let r=t;for(;r!==n;){if(null===r)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(r.host){if(r.host.impl)return e(r.host.impl);if(r.host)return e(r.host);throw new Error("Lost in Web Components world")}return!1}if(r.style&&"none"===r.style.display)return!1;r=r.parentNode}return!0},t.matchesCSSRules=function(e,t){var n=t["selectorText"];let r=!1;t.type===CSSRule.STYLE_RULE&&n&&(e.msMatchesSelector?r=e.msMatchesSelector(n):e.matches&&(r=e.matches(n)));return r},t.observeVisibilityChangeOnce=function(n,r){var e=new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&null!==n.offsetParent&&(r(),t.unobserve(n))})},{root:n.ownerDocument.body});e.observe(n)},t.offset=function(e){var t=e.ownerDocument,n=t.defaultView,r=t.documentElement;let i=e,o,s,a;o=i.offsetLeft,s=i.offsetTop,a=i;for(;(i=i.offsetParent)&&i!==t.body;)o+=i.offsetLeft,s+=i.offsetTop,a=i;a&&"fixed"===a.style.position&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop);return{left:o,top:s}},t.outerHeight=function(e){return e.offsetHeight},t.outerWidth=function(e){return e.offsetWidth},t.overlayContainsElement=function(e,t,n){n=n.parentElement.querySelector(".ht_clone_"+e);return n?n.contains(t):null},t.removeClass=function(e,t){"string"==typeof t&&(t=t.split(" "));0<(t=s(t)).length&&e.classList.remove(...t)},t.removeEvent=function(e,t,n){e.removeEventListener(t,n,!1)},t.removeTextNodes=function t(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(-1<["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)){const n=e.childNodes;for(let e=n.length-1;0<=e;e--)t(n[e])}},t.resetCssTransform=function(e){e.style.transform&&""!==e.style.transform&&(e.style.transform="")},t.selectElementIfAllowed=function(e){var t=e.ownerDocument.activeElement;g(t)||e.select()},t.setCaretPosition=function(t,n,r){void 0===r&&(r=n);if(t.setSelectionRange){t.focus();try{t.setSelectionRange(n,r)}catch(e){var i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(n,r),i.style.display=o}}},t.setOverlayPosition=function(e,t,n){e.style.transform=`translate3d(${t},${n},0)`},n(203),n(273);var r=n(303);function i(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function o(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=2<arguments.length?arguments[2]:void 0,{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=e;for(;null!==o&&void 0!==o&&o!==n;){var{nodeType:s,nodeName:a}=o;if(s===r&&(t.includes(a)||t.includes(o)))return o;a=o["host"];o=a&&s===i?a:o.parentNode}return null}function s(e){return e&&e.length?e.filter(e=>!!e):[]}function a(e){for(var t;t=e.lastChild;)e.removeChild(t)}const l=/(<(.*)>|&(.*);)/;function u(e,t){var n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?n.textContent=t:(a(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function c(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:window).scrollY}function d(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:window).scrollX}function h(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}t.HTML_CHARACTERS=l;let f;function p(e){return e&&(-1<["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)||"true"===e.contentEditable)}function g(e){return p(e)&&!1===e.hasAttribute("data-hot-input")}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,t.equalsIgnoreCase=function(){var e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];let i=n.length;for(;i;){--i;var o=(0,s.stringify)(n[i]).toLowerCase();-1===e.indexOf(o)&&e.push(o)}return 1===e.length},t.isPercentValue=function(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)},t.randomString=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()},t.sanitize=o,t.stripTags=function(e){return o(""+e,{ALLOWED_TAGS:[]})},t.substitute=function(e){let n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return(""+e).replace(/(?:\\)?\[([^[\]]+)]/g,(e,t)=>"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===n[t]?"":n[t])},t.toUpperCaseFirst=function(e){return e[0].toUpperCase()+e.substr(1)},n(203),r(n(304))),s=n(305);function o(e,t){return i.default.sanitize(e,t)}},function(e,t,n){e.exports=function(){"use strict";function Ye(e){"@babel/helpers - typeof";return Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ye(e)}function a(e,t){a=Object.setPrototypeOf||function e(t,n){t.__proto__=n;return t};return a(e,t)}function r(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}function i(e,t,n){if(r())i=Reflect.construct;else i=function e(t,n,r){var i=[null];i.push.apply(i,n);var o=Function.bind.apply(t,i);var s=new o;if(r)a(s,r.prototype);return s};return i.apply(null,arguments)}function Xe(e){return t(e)||n(e)||o(e)||f()}function t(e){if(Array.isArray(e))return s(e)}function n(e){if(typeof Symbol!=="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function o(e,t){if(!e)return;if(typeof e==="string")return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor)n=e.constructor.name;if(n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}function s(e,t){if(t==null||t>e.length)t=e.length;for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p=Object.hasOwnProperty,l=Object.setPrototypeOf,g=Object.isFrozen,m=Object.getPrototypeOf,y=Object.getOwnPropertyDescriptor,Ke=Object.freeze,e=Object.seal,v=Object.create,u=typeof Reflect!=="undefined"&&Reflect,c=u.apply,d=u.construct;if(!c)c=function e(t,n,r){return t.apply(n,r)};if(!Ke)Ke=function e(t){return t};if(!e)e=function e(t){return t};if(!d)d=function e(t,n){return i(t,Xe(n))};var mt=h(Array.prototype.forEach),qe=h(Array.prototype.pop),Ze=h(Array.prototype.push),Qe=h(String.prototype.toLowerCase),Je=h(String.prototype.toString),yt=h(String.prototype.match),et=h(String.prototype.replace),vt=h(String.prototype.indexOf),bt=h(String.prototype.trim),tt=h(RegExp.prototype.test),nt=b(TypeError);function h(i){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return c(i,e,n)}}function b(r){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return d(r,t)}}function rt(e,t,n){var r;n=(r=n)!==null&&r!==void 0?r:Qe;if(l)l(e,null);var i=t.length;while(i--){var o=t[i];if(typeof o==="string"){var s=n(o);if(s!==o){if(!g(t))t[i]=s;o=s}}e[o]=true}return e}function it(e){var t=v(null);var n;for(n in e)if(c(p,e,[n])===true)t[n]=e[n];return t}function ot(e,t){while(e!==null){var n=y(e,t);if(n){if(n.get)return h(n.get);if(typeof n.value==="function")return h(n.value)}e=m(e)}function r(e){console.warn("fallback value for",e);return null}return r}var st=Ke(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),at=Ke(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),lt=Ke(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Et=Ke(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ut=Ke(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),Ct=Ke(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),ct=Ke(["#text"]),dt=Ke(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),ht=Ke(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ft=Ke(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),pt=Ke(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),wt=e(/\{\{[\w\W]*|[\w\W]*\}\}/gm),St=e(/<%[\w\W]*|[\w\W]*%>/gm),Tt=e(/\${[\w\W]*}/gm),Rt=e(/^data-[\-\w.\u00B7-\uFFFF]/),At=e(/^aria-[\-\w]+$/),_t=e(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Nt=e(/^(?:\w+script|data):/i),xt=e(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Ot=e(/^html$/i),It=function e(){return typeof window==="undefined"?null:window},Mt=function e(t,n){if(Ye(t)!=="object"||typeof t.createPolicy!=="function")return null;var r=null;var i="data-tt-policy-suffix";if(n.currentScript&&n.currentScript.hasAttribute(i))r=n.currentScript.getAttribute(i);var o="dompurify"+(r?"#"+r:"");try{return t.createPolicy(o,{createHTML:function e(t){return t},createScriptURL:function e(t){return t}})}catch(e){console.warn("TrustedTypes policy "+o+" could not be created.");return null}},E;function gt(){var c=arguments.length>0&&arguments[0]!==undefined?arguments[0]:It();var h=function e(t){return gt(t)};h.version="2.4.7";h.removed=[];if(!c||!c.document||c.document.nodeType!==9){h.isSupported=false;return h}var d=c.document;var a=c.document;var L=c.DocumentFragment,P=c.HTMLTemplateElement,f=c.Node,F=c.Element,n=c.NodeFilter,B=c.NamedNodeMap,H=B===void 0?c.NamedNodeMap||c.MozNamedAttrMap:B,U=c.HTMLFormElement,V=c.DOMParser,p=c.trustedTypes;var e=F.prototype;var W=ot(e,"cloneNode");var $=ot(e,"nextSibling");var j=ot(e,"childNodes");var l=ot(e,"parentNode");if(typeof P==="function"){var z=a.createElement("template");if(z.content&&z.content.ownerDocument)a=z.content.ownerDocument}var g=Mt(p,d);var G=g?g.createHTML(""):"";var t=a,Y=t.implementation,X=t.createNodeIterator,K=t.createDocumentFragment,q=t.getElementsByTagName;var Z=d.importNode;var Q={};try{Q=it(a).documentMode?a.documentMode:{}}catch(e){}var i={};h.isSupported=typeof l==="function"&&Y&&Y.createHTMLDocument!==undefined&&Q!==9;var J=wt,ee=St,te=Tt,ne=Rt,re=At,ie=Nt,oe=xt;var se=_t;var m=null;var ae=rt({},[].concat(Xe(st),Xe(at),Xe(lt),Xe(ut),Xe(ct)));var y=null;var le=rt({},[].concat(Xe(dt),Xe(ht),Xe(ft),Xe(pt)));var u=Object.seal(Object.create(null,{tagNameCheck:{writable:true,configurable:false,enumerable:true,value:null},attributeNameCheck:{writable:true,configurable:false,enumerable:true,value:null},allowCustomizedBuiltInElements:{writable:true,configurable:false,enumerable:true,value:false}}));var v=null;var ue=null;var ce=true;var de=true;var he=false;var fe=true;var b=false;var E=false;var pe=false;var ge=false;var C=false;var w=false;var S=false;var me=true;var ye=false;var ve="user-content-";var be=true;var T=false;var r={};var R=null;var Ee=rt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);var Ce=null;var we=rt({},["audio","video","img","source","image","track"]);var Se=null;var Te=rt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]);var o="http://www.w3.org/1998/Math/MathML";var s="http://www.w3.org/2000/svg";var A="http://www.w3.org/1999/xhtml";var _=A;var Re=false;var Ae=null;var _e=rt({},[o,s,A],Je);var N;var Ne=["application/xhtml+xml","text/html"];var xe="text/html";var x;var O=null;var Oe=a.createElement("form");var Ie=function e(t){return t instanceof RegExp||t instanceof Function};var Me=function e(t){if(O&&O===t)return;if(!t||Ye(t)!=="object")t={};t=it(t);N=Ne.indexOf(t.PARSER_MEDIA_TYPE)===-1?N=xe:N=t.PARSER_MEDIA_TYPE;x=N==="application/xhtml+xml"?Je:Qe;m="ALLOWED_TAGS"in t?rt({},t.ALLOWED_TAGS,x):ae;y="ALLOWED_ATTR"in t?rt({},t.ALLOWED_ATTR,x):le;Ae="ALLOWED_NAMESPACES"in t?rt({},t.ALLOWED_NAMESPACES,Je):_e;Se="ADD_URI_SAFE_ATTR"in t?rt(it(Te),t.ADD_URI_SAFE_ATTR,x):Te;Ce="ADD_DATA_URI_TAGS"in t?rt(it(we),t.ADD_DATA_URI_TAGS,x):we;R="FORBID_CONTENTS"in t?rt({},t.FORBID_CONTENTS,x):Ee;v="FORBID_TAGS"in t?rt({},t.FORBID_TAGS,x):{};ue="FORBID_ATTR"in t?rt({},t.FORBID_ATTR,x):{};r="USE_PROFILES"in t?t.USE_PROFILES:false;ce=t.ALLOW_ARIA_ATTR!==false;de=t.ALLOW_DATA_ATTR!==false;he=t.ALLOW_UNKNOWN_PROTOCOLS||false;fe=t.ALLOW_SELF_CLOSE_IN_ATTR!==false;b=t.SAFE_FOR_TEMPLATES||false;E=t.WHOLE_DOCUMENT||false;C=t.RETURN_DOM||false;w=t.RETURN_DOM_FRAGMENT||false;S=t.RETURN_TRUSTED_TYPE||false;ge=t.FORCE_BODY||false;me=t.SANITIZE_DOM!==false;ye=t.SANITIZE_NAMED_PROPS||false;be=t.KEEP_CONTENT!==false;T=t.IN_PLACE||false;se=t.ALLOWED_URI_REGEXP||se;_=t.NAMESPACE||A;u=t.CUSTOM_ELEMENT_HANDLING||{};if(t.CUSTOM_ELEMENT_HANDLING&&Ie(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck))u.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck;if(t.CUSTOM_ELEMENT_HANDLING&&Ie(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck))u.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck;if(t.CUSTOM_ELEMENT_HANDLING&&typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements==="boolean")u.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements;if(b)de=false;if(w)C=true;if(r){m=rt({},Xe(ct));y=[];if(r.html===true){rt(m,st);rt(y,dt)}if(r.svg===true){rt(m,at);rt(y,ht);rt(y,pt)}if(r.svgFilters===true){rt(m,lt);rt(y,ht);rt(y,pt)}if(r.mathMl===true){rt(m,ut);rt(y,ft);rt(y,pt)}}if(t.ADD_TAGS){if(m===ae)m=it(m);rt(m,t.ADD_TAGS,x)}if(t.ADD_ATTR){if(y===le)y=it(y);rt(y,t.ADD_ATTR,x)}if(t.ADD_URI_SAFE_ATTR)rt(Se,t.ADD_URI_SAFE_ATTR,x);if(t.FORBID_CONTENTS){if(R===Ee)R=it(R);rt(R,t.FORBID_CONTENTS,x)}if(be)m["#text"]=true;if(E)rt(m,["html","head","body"]);if(m.table){rt(m,["tbody"]);delete v.tbody}if(Ke)Ke(t);O=t};var ke=rt({},["mi","mo","mn","ms","mtext"]);var De=rt({},["foreignobject","desc","title","annotation-xml"]);var Le=rt({},["title","style","font","a","script"]);var I=rt({},at);rt(I,lt);rt(I,Et);var Pe=rt({},ut);rt(Pe,Ct);var Fe=function e(t){var n=l(t);if(!n||!n.tagName)n={namespaceURI:_,tagName:"template"};var r=Qe(t.tagName);var i=Qe(n.tagName);if(!Ae[t.namespaceURI])return false;if(t.namespaceURI===s){if(n.namespaceURI===A)return r==="svg";if(n.namespaceURI===o)return r==="svg"&&(i==="annotation-xml"||ke[i]);return Boolean(I[r])}if(t.namespaceURI===o){if(n.namespaceURI===A)return r==="math";if(n.namespaceURI===s)return r==="math"&&De[i];return Boolean(Pe[r])}if(t.namespaceURI===A){if(n.namespaceURI===s&&!De[i])return false;if(n.namespaceURI===o&&!ke[i])return false;return!Pe[r]&&(Le[r]||!I[r])}if(N==="application/xhtml+xml"&&Ae[t.namespaceURI])return true;return false};var M=function e(t){Ze(h.removed,{element:t});try{t.parentNode.removeChild(t)}catch(e){try{t.outerHTML=G}catch(e){t.remove()}}};var Be=function e(t,n){try{Ze(h.removed,{attribute:n.getAttributeNode(t),from:n})}catch(e){Ze(h.removed,{attribute:null,from:n})}n.removeAttribute(t);if(t==="is"&&!y[t])if(C||w)try{M(n)}catch(e){}else try{n.setAttribute(t,"")}catch(e){}};var He=function e(t){var n;var r;if(ge)t="<remove></remove>"+t;else{var i=yt(t,/^[\r\n\t ]+/);r=i&&i[0]}if(N==="application/xhtml+xml"&&_===A)t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>";var o=g?g.createHTML(t):t;if(_===A)try{n=(new V).parseFromString(o,N)}catch(e){}if(!n||!n.documentElement){n=Y.createDocument(_,"template",null);try{n.documentElement.innerHTML=Re?G:o}catch(e){}}var s=n.body||n.documentElement;if(t&&r)s.insertBefore(a.createTextNode(r),s.childNodes[0]||null);if(_===A)return q.call(n,E?"html":"body")[0];return E?n.documentElement:s};var Ue=function e(t){return X.call(t.ownerDocument||t,t,n.SHOW_ELEMENT|n.SHOW_COMMENT|n.SHOW_TEXT,null,false)};var Ve=function e(t){return t instanceof U&&(typeof t.nodeName!=="string"||typeof t.textContent!=="string"||typeof t.removeChild!=="function"||!(t.attributes instanceof H)||typeof t.removeAttribute!=="function"||typeof t.setAttribute!=="function"||typeof t.namespaceURI!=="string"||typeof t.insertBefore!=="function"||typeof t.hasChildNodes!=="function")};var k=function e(t){return Ye(f)==="object"?t instanceof f:t&&Ye(t)==="object"&&typeof t.nodeType==="number"&&typeof t.nodeName==="string"};var D=function e(t,n,r){if(!i[t])return;mt(i[t],function(e){e.call(h,n,r,O)})};var We=function e(t){var n;D("beforeSanitizeElements",t,null);if(Ve(t)){M(t);return true}if(tt(/[\u0080-\uFFFF]/,t.nodeName)){M(t);return true}var r=x(t.nodeName);D("uponSanitizeElement",t,{tagName:r,allowedTags:m});if(t.hasChildNodes()&&!k(t.firstElementChild)&&(!k(t.content)||!k(t.content.firstElementChild))&&tt(/<[/\w]/g,t.innerHTML)&&tt(/<[/\w]/g,t.textContent)){M(t);return true}if(r==="select"&&tt(/<template/i,t.innerHTML)){M(t);return true}if(!m[r]||v[r]){if(!v[r]&&je(r)){if(u.tagNameCheck instanceof RegExp&&tt(u.tagNameCheck,r))return false;if(u.tagNameCheck instanceof Function&&u.tagNameCheck(r))return false}if(be&&!R[r]){var i=l(t)||t.parentNode;var o=j(t)||t.childNodes;if(o&&i){var s=o.length;for(var a=s-1;a>=0;--a)i.insertBefore(W(o[a],true),$(t))}}M(t);return true}if(t instanceof F&&!Fe(t)){M(t);return true}if((r==="noscript"||r==="noembed"||r==="noframes")&&tt(/<\/no(script|embed|frames)/i,t.innerHTML)){M(t);return true}if(b&&t.nodeType===3){n=t.textContent;n=et(n,J," ");n=et(n,ee," ");n=et(n,te," ");if(t.textContent!==n){Ze(h.removed,{element:t.cloneNode()});t.textContent=n}}D("afterSanitizeElements",t,null);return false};var $e=function e(t,n,r){if(me&&(n==="id"||n==="name")&&(r in a||r in Oe))return false;if(de&&!ue[n]&&tt(ne,n));else if(ce&&tt(re,n));else if(!y[n]||ue[n])if(je(t)&&(u.tagNameCheck instanceof RegExp&&tt(u.tagNameCheck,t)||u.tagNameCheck instanceof Function&&u.tagNameCheck(t))&&(u.attributeNameCheck instanceof RegExp&&tt(u.attributeNameCheck,n)||u.attributeNameCheck instanceof Function&&u.attributeNameCheck(n))||n==="is"&&u.allowCustomizedBuiltInElements&&(u.tagNameCheck instanceof RegExp&&tt(u.tagNameCheck,r)||u.tagNameCheck instanceof Function&&u.tagNameCheck(r)));else return false;else if(Se[n]);else if(tt(se,et(r,oe,"")));else if((n==="src"||n==="xlink:href"||n==="href")&&t!=="script"&&vt(r,"data:")===0&&Ce[t]);else if(he&&!tt(ie,et(r,oe,"")));else if(r)return false;else;return true};var je=function e(t){return t.indexOf("-")>0};var ze=function e(t){var n;var r;var i;var o;D("beforeSanitizeAttributes",t,null);var s=t.attributes;if(!s)return;var a={attrName:"",attrValue:"",keepAttr:true,allowedAttributes:y};o=s.length;while(o--){n=s[o];var l=n,u=l.name,c=l.namespaceURI;r=u==="value"?n.value:bt(n.value);i=x(u);a.attrName=i;a.attrValue=r;a.keepAttr=true;a.forceKeepAttr=undefined;D("uponSanitizeAttribute",t,a);r=a.attrValue;if(a.forceKeepAttr)continue;Be(u,t);if(!a.keepAttr)continue;if(!fe&&tt(/\/>/i,r)){Be(u,t);continue}if(b){r=et(r,J," ");r=et(r,ee," ");r=et(r,te," ")}var d=x(t.nodeName);if(!$e(d,i,r))continue;if(ye&&(i==="id"||i==="name")){Be(u,t);r=ve+r}if(g&&Ye(p)==="object"&&typeof p.getAttributeType==="function")if(c);else switch(p.getAttributeType(d,i)){case"TrustedHTML":{r=g.createHTML(r);break}case"TrustedScriptURL":{r=g.createScriptURL(r);break}}try{if(c)t.setAttributeNS(c,u,r);else t.setAttribute(u,r);qe(h.removed)}catch(e){}}D("afterSanitizeAttributes",t,null)};var Ge=function e(t){var n;var r=Ue(t);D("beforeSanitizeShadowDOM",t,null);while(n=r.nextNode()){D("uponSanitizeShadowNode",n,null);if(We(n))continue;if(n.content instanceof L)e(n.content);ze(n)}D("afterSanitizeShadowDOM",t,null)};h.sanitize=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n;var r;var i;var o;var s;Re=!e;if(Re)e="\x3c!--\x3e";if(typeof e!=="string"&&!k(e))if(typeof e.toString==="function"){e=e.toString();if(typeof e!=="string")throw nt("dirty is not a string, aborting")}else throw nt("toString is not a function");if(!h.isSupported){if(Ye(c.toStaticHTML)==="object"||typeof c.toStaticHTML==="function"){if(typeof e==="string")return c.toStaticHTML(e);if(k(e))return c.toStaticHTML(e.outerHTML)}return e}if(!pe)Me(t);h.removed=[];if(typeof e==="string")T=false;if(T){if(e.nodeName){var a=x(e.nodeName);if(!m[a]||v[a])throw nt("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof f){n=He("\x3c!----\x3e");r=n.ownerDocument.importNode(e,true);if(r.nodeType===1&&r.nodeName==="BODY")n=r;else if(r.nodeName==="HTML")n=r;else n.appendChild(r)}else{if(!C&&!b&&!E&&e.indexOf("<")===-1)return g&&S?g.createHTML(e):e;n=He(e);if(!n)return C?null:S?G:""}if(n&&ge)M(n.firstChild);var l=Ue(T?e:n);while(i=l.nextNode()){if(i.nodeType===3&&i===o)continue;if(We(i))continue;if(i.content instanceof L)Ge(i.content);ze(i);o=i}o=null;if(T)return e;if(C){if(w){s=K.call(n.ownerDocument);while(n.firstChild)s.appendChild(n.firstChild)}else s=n;if(y.shadowroot||y.shadowrootmod)s=Z.call(d,s,true);return s}var u=E?n.outerHTML:n.innerHTML;if(E&&m["!doctype"]&&n.ownerDocument&&n.ownerDocument.doctype&&n.ownerDocument.doctype.name&&tt(Ot,n.ownerDocument.doctype.name))u="<!DOCTYPE "+n.ownerDocument.doctype.name+">\n"+u;if(b){u=et(u,J," ");u=et(u,ee," ");u=et(u,te," ")}return g&&S?g.createHTML(u):u};h.setConfig=function(e){Me(e);pe=true};h.clearConfig=function(){O=null;pe=false};h.isValidAttribute=function(e,t,n){if(!O)Me({});var r=x(e);var i=x(t);return $e(r,i,n)};h.addHook=function(e,t){if(typeof t!=="function")return;i[e]=i[e]||[];Ze(i[e],t)};h.removeHook=function(e){if(i[e])return qe(i[e])};h.removeHooks=function(e){if(i[e])i[e]=[]};h.removeAllHooks=function(){i={}};return h}return gt()}(),window.DOMPurify=n(304)},(e,t,n)=>{"use strict";var r=n(196),u=(t.__esModule=!0,t._injectProductInfo=function(e,t){var n=!c(e),r="string"==typeof e&&"non-commercial-and-evaluation"===e.toLowerCase(),i="13.1.0";let o,s="invalid",a="invalid";var l=function(r){let e=[][d],i=e;if(r[d]!==g("Z"))return!1;for(let e="",t="B<H4P+".split(""),n=g(t.shift());n;n=g(t.shift()||"A"))--n<""[d]?i|=(f(""+f(h(e)+(h(p(r,Math.abs(n),2))+[]).padStart(2,"0")))%97||2)>>1:e=p(r,n,n?1===t[d]?9:8:6);return i===e}(e=m(e||""));a=n||r||l?l?(n=(0,u.default)("31/08/2023","DD/MM/YYYY"),l=Math.floor(n.toDate().getTime()/864e5),n=y(e),o=(0,u.default)(864e5*(n+1),"x").format("MMMM DD, YYYY"),n<l?s="expired":s="valid"):r?(s="non_commercial","valid"):s="invalid":(s="missing","missing");v()&&(s="valid",a="valid");b||"valid"===s||(E[s]({keyValidityDate:o,hotVersion:i})&&console["non_commercial"===s?"info":"warn"](E[s]({keyValidityDate:o,hotVersion:i})),b=!0);"valid"!==a&&t.parentNode&&C[a]({keyValidityDate:o,hotVersion:i})&&((e=document.createElement("div")).className="hot-display-license-info",e.innerHTML=C[a]({keyValidityDate:o,hotVersion:i}),t.parentNode.insertBefore(e,t.nextSibling))},t.isDefined=function(e){return void 0!==e},t.isEmpty=c,t.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},t.isUndefined=o,t.stringify=function(e){let t;switch(typeof e){case"string":case"number":t=""+e;break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString()}return t},r(n(306))),i=n(443);function o(e){return void 0===e}function c(e){return null===e||""===e||o(e)}const d="length",h=e=>parseInt(e,16),f=e=>parseInt(e,10),p=(e,t,n)=>e.substr(t,n),g=e=>e.codePointAt(0)-65,m=e=>(""+e).replace(/\-/g,""),y=e=>h(p(m(e),h("12"),g("F")))/(h(p(m(e),g("B"),~~![][d]))||9),v=()=>"undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let b=!1;const E={invalid:()=>(0,i.toSingleLine)`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:e=>{var{keyValidityDate:e,hotVersion:t}=e;return(0,i.toSingleLine)`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>(0,i.toSingleLine)`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},C={invalid:()=>(0,i.toSingleLine)`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:e=>{var{keyValidityDate:e,hotVersion:t}=e;return(0,i.toSingleLine)`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>(0,i.toSingleLine)`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""}},function(cs,e,ds){(cs=ds.nmd(cs)).exports=function(){"use strict";var P,F;function d(){return P.apply(null,arguments)}function B(e){P=e}function s(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function H(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function l(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function U(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;else{var t;for(t in e)if(l(e,t))return false;return true}}function a(e){return e===void 0}function u(e){return typeof e==="number"||Object.prototype.toString.call(e)==="[object Number]"}function V(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function W(e,t){var n=[],r,i=e.length;for(r=0;r<i;++r)n.push(t(e[r],r));return n}function $(e,t){for(var n in t)if(l(t,n))e[n]=t[n];if(l(t,"toString"))e.toString=t.toString;if(l(t,"valueOf"))e.valueOf=t.valueOf;return e}function c(e,t,n,r){return Qn(e,t,n,r,true).utc()}function j(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidEra:null,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false,parsedDateParts:[],era:null,meridiem:null,rfc2822:false,weekdayMismatch:false}}function h(e){if(e._pf==null)e._pf=j();return e._pf}if(Array.prototype.some)F=Array.prototype.some;else F=function(e){var t=Object(this),n=t.length>>>0,r;for(r=0;r<n;r++)if(r in t&&e.call(this,t[r],r,t))return true;return false};function z(e){if(e._isValid==null){var t=h(e),n=F.call(t.parsedDateParts,function(e){return e!=null}),r=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict)r=r&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===undefined;if(Object.isFrozen==null||!Object.isFrozen(e))e._isValid=r;else return r}return e._isValid}function G(e){var t=c(NaN);if(e!=null)$(h(t),e);else h(t).userInvalidated=true;return t}var Y=d.momentProperties=[],X=false;function K(e,t){var n,r,i,o=Y.length;if(!a(t._isAMomentObject))e._isAMomentObject=t._isAMomentObject;if(!a(t._i))e._i=t._i;if(!a(t._f))e._f=t._f;if(!a(t._l))e._l=t._l;if(!a(t._strict))e._strict=t._strict;if(!a(t._tzm))e._tzm=t._tzm;if(!a(t._isUTC))e._isUTC=t._isUTC;if(!a(t._offset))e._offset=t._offset;if(!a(t._pf))e._pf=h(t);if(!a(t._locale))e._locale=t._locale;if(o>0)for(n=0;n<o;n++){r=Y[n];i=t[r];if(!a(i))e[r]=i}return e}function q(e){K(this,e);this._d=new Date(e._d!=null?e._d.getTime():NaN);if(!this.isValid())this._d=new Date(NaN);if(X===false){X=true;d.updateOffset(this);X=false}}function f(e){return e instanceof q||e!=null&&e._isAMomentObject!=null}function Z(e){if(d.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn)console.warn("Deprecation warning: "+e)}function e(o,s){var a=true;return $(function(){if(d.deprecationHandler!=null)d.deprecationHandler(null,o);if(a){var e=[],t,n,r,i=arguments.length;for(n=0;n<i;n++){t="";if(typeof arguments[n]==="object"){t+="\n["+n+"] ";for(r in arguments[0])if(l(arguments[0],r))t+=r+": "+arguments[0][r]+", ";t=t.slice(0,-2)}else t=arguments[n];e.push(t)}Z(o+"\nArguments: "+Array.prototype.slice.call(e).join("")+"\n"+(new Error).stack);a=false}return s.apply(this,arguments)},s)}var Q={},J;function ee(e,t){if(d.deprecationHandler!=null)d.deprecationHandler(e,t);if(!Q[e]){Z(t);Q[e]=true}}function p(e){return typeof Function!=="undefined"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function te(e){var t,n;for(n in e)if(l(e,n)){t=e[n];if(p(t))this[n]=t;else this["_"+n]=t}this._config=e;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ne(e,t){var n=$({},e),r;for(r in t)if(l(t,r))if(H(e[r])&&H(t[r])){n[r]={};$(n[r],e[r]);$(n[r],t[r])}else if(t[r]!=null)n[r]=t[r];else delete n[r];for(r in e)if(l(e,r)&&!l(t,r)&&H(e[r]))n[r]=$({},n[r]);return n}function re(e){if(e!=null)this.set(e)}if(d.suppressDeprecationWarnings=false,d.deprecationHandler=null,Object.keys)J=Object.keys;else J=function(e){var t,n=[];for(t in e)if(l(e,t))n.push(t);return n};var ie={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function oe(e,t,n){var r=this._calendar[e]||this._calendar["sameElse"];return p(r)?r.call(t,n):r}function o(e,t,n){var r=""+Math.abs(e),i=t-r.length,o=e>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var se=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ae=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,le={},ue={};function r(e,t,n,r){var i=r;if(typeof r==="string")i=function(){return this[r]()};if(e)ue[e]=i;if(t)ue[t[0]]=function(){return o(i.apply(this,arguments),t[1],t[2])};if(n)ue[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)}}function ce(e){if(e.match(/\[[\s\S]/))return e.replace(/^\[|\]$/g,"");return e.replace(/\\/g,"")}function de(r){var i=r.match(se),e,o;for(e=0,o=i.length;e<o;e++)if(ue[i[e]])i[e]=ue[i[e]];else i[e]=ce(i[e]);return function(e){var t="",n;for(n=0;n<o;n++)t+=p(i[n])?i[n].call(e,r):i[n];return t}}function he(e,t){if(!e.isValid())return e.localeData().invalidDate();t=fe(t,e.localeData());le[t]=le[t]||de(t);return le[t](e)}function fe(e,t){var n=5;function r(e){return t.longDateFormat(e)||e}ae.lastIndex=0;while(n>=0&&ae.test(e)){e=e.replace(ae,r);ae.lastIndex=0;n-=1}return e}var pe={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function ge(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];if(t||!n)return t;this._longDateFormat[e]=n.match(se).map(function(e){if(e==="MMMM"||e==="MM"||e==="DD"||e==="dddd")return e.slice(1);return e}).join("");return this._longDateFormat[e]}var me="Invalid date";function ye(){return this._invalidDate}var ve="%d",be=/\d{1,2}/;function Ee(e){return this._ordinal.replace("%d",e)}var Ce={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function we(e,t,n,r){var i=this._relativeTime[n];return p(i)?i(e,t,n,r):i.replace(/%d/i,e)}function Se(e,t){var n=this._relativeTime[e>0?"future":"past"];return p(n)?n(t):n.replace(/%s/i,t)}var Te={};function t(e,t){var n=e.toLowerCase();Te[n]=Te[n+"s"]=Te[t]=e}function g(e){return typeof e==="string"?Te[e]||Te[e.toLowerCase()]:undefined}function Re(e){var t={},n,r;for(r in e)if(l(e,r)){n=g(r);if(n)t[n]=e[r]}return t}var Ae={};function n(e,t){Ae[e]=t}function _e(e){var t=[],n;for(n in e)if(l(e,n))t.push({unit:n,priority:Ae[n]});t.sort(function(e,t){return e.priority-t.priority});return t}function Ne(e){return e%4===0&&e%100!==0||e%400===0}function m(e){if(e<0)return Math.ceil(e)||0;else return Math.floor(e)}function y(e){var t=+e,n=0;if(t!==0&&isFinite(t))n=m(t);return n}function xe(t,n){return function(e){if(e!=null){Ie(this,t,e);d.updateOffset(this,n);return this}else return Oe(this,t)}}function Oe(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function Ie(e,t,n){if(e.isValid()&&!isNaN(n))if(t==="FullYear"&&Ne(e.year())&&e.month()===1&&e.date()===29){n=y(n);e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),ot(n,e.month()))}else e._d["set"+(e._isUTC?"UTC":"")+t](n)}function Me(e){e=g(e);if(p(this[e]))return this[e]();return this}function ke(e,t){if(typeof e==="object"){e=Re(e);var n=_e(e),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](e[n[r].unit])}else{e=g(e);if(p(this[e]))return this[e](t)}return this}var De=/\d/,i=/\d\d/,Le=/\d{3}/,Pe=/\d{4}/,Fe=/[+-]?\d{6}/,v=/\d\d?/,Be=/\d\d\d\d?/,He=/\d\d\d\d\d\d?/,Ue=/\d{1,3}/,Ve=/\d{1,4}/,We=/[+-]?\d{1,6}/,$e=/\d+/,je=/[+-]?\d+/,ze=/Z|[+-]\d\d:?\d\d/gi,Ge=/Z|[+-]\d\d(?::?\d\d)?/gi,Ye=/[+-]?\d+(\.\d{1,3})?/,Xe=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Ke;function b(e,n,r){Ke[e]=p(n)?n:function(e,t){return e&&r?r:n}}function qe(e,t){if(!l(Ke,e))return new RegExp(Ze(e));return Ke[e](t._strict,t._locale)}function Ze(e){return E(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,i){return t||n||r||i}))}function E(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var Ke={},Qe={};function C(e,n){var t,r=n,i;if(typeof e==="string")e=[e];if(u(n))r=function(e,t){t[n]=y(e)};i=e.length;for(t=0;t<i;t++)Qe[e[t]]=r}function Je(e,i){C(e,function(e,t,n,r){n._w=n._w||{};i(e,n._w,n,r)})}function et(e,t,n){if(t!=null&&l(Qe,e))Qe[e](t,n._a,n,e)}var w=0,S=1,T=2,R=3,A=4,_=5,tt=6,nt=7,rt=8,N;function it(e,t){return(e%t+t)%t}if(Array.prototype.indexOf)N=Array.prototype.indexOf;else N=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function ot(e,t){if(isNaN(e)||isNaN(t))return NaN;var n=it(t,12);e+=(t-n)/12;return n===1?Ne(e)?29:28:31-n%7%2}r("M",["MM",2],"Mo",function(){return this.month()+1}),r("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),r("MMMM",0,0,function(e){return this.localeData().months(this,e)}),t("month","M"),n("month",8),b("M",v),b("MM",v,i),b("MMM",function(e,t){return t.monthsShortRegex(e)}),b("MMMM",function(e,t){return t.monthsRegex(e)}),C(["M","MM"],function(e,t){t[S]=y(e)-1}),C(["MMM","MMMM"],function(e,t,n,r){var i=n._locale.monthsParse(e,r,n._strict);if(i!=null)t[S]=i;else h(n).invalidMonth=e});var st="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),at="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),lt=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,ut=Xe,ct=Xe;function dt(e,t){if(!e)return s(this._months)?this._months:this._months["standalone"];return s(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||lt).test(t)?"format":"standalone"][e.month()]}function ht(e,t){if(!e)return s(this._monthsShort)?this._monthsShort:this._monthsShort["standalone"];return s(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[lt.test(t)?"format":"standalone"][e.month()]}function ft(e,t,n){var r,i,o,s=e.toLocaleLowerCase();if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];for(r=0;r<12;++r){o=c([2e3,r]);this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase();this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase()}}if(n)if(t==="MMM"){i=N.call(this._shortMonthsParse,s);return i!==-1?i:null}else{i=N.call(this._longMonthsParse,s);return i!==-1?i:null}else if(t==="MMM"){i=N.call(this._shortMonthsParse,s);if(i!==-1)return i;i=N.call(this._longMonthsParse,s);return i!==-1?i:null}else{i=N.call(this._longMonthsParse,s);if(i!==-1)return i;i=N.call(this._shortMonthsParse,s);return i!==-1?i:null}}function pt(e,t,n){var r,i,o;if(this._monthsParseExact)return ft.call(this,e,t,n);if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[]}for(r=0;r<12;r++){i=c([2e3,r]);if(n&&!this._longMonthsParse[r]){this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i");this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")}if(!n&&!this._monthsParse[r]){o="^"+this.months(i,"")+"|^"+this.monthsShort(i,"");this._monthsParse[r]=new RegExp(o.replace(".",""),"i")}if(n&&t==="MMMM"&&this._longMonthsParse[r].test(e))return r;else if(n&&t==="MMM"&&this._shortMonthsParse[r].test(e))return r;else if(!n&&this._monthsParse[r].test(e))return r}}function gt(e,t){var n;if(!e.isValid())return e;if(typeof t==="string")if(/^\d+$/.test(t))t=y(t);else{t=e.localeData().monthsParse(t);if(!u(t))return e}n=Math.min(e.date(),ot(e.year(),t));e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n);return e}function mt(e){if(e!=null){gt(this,e);d.updateOffset(this,true);return this}else return Oe(this,"Month")}function yt(){return ot(this.year(),this.month())}function vt(e){if(this._monthsParseExact){if(!l(this,"_monthsRegex"))Et.call(this);if(e)return this._monthsShortStrictRegex;else return this._monthsShortRegex}else{if(!l(this,"_monthsShortRegex"))this._monthsShortRegex=ut;return this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex}}function bt(e){if(this._monthsParseExact){if(!l(this,"_monthsRegex"))Et.call(this);if(e)return this._monthsStrictRegex;else return this._monthsRegex}else{if(!l(this,"_monthsRegex"))this._monthsRegex=ct;return this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex}}function Et(){function e(e,t){return t.length-e.length}var t=[],n=[],r=[],i,o;for(i=0;i<12;i++){o=c([2e3,i]);t.push(this.monthsShort(o,""));n.push(this.months(o,""));r.push(this.months(o,""));r.push(this.monthsShort(o,""))}t.sort(e);n.sort(e);r.sort(e);for(i=0;i<12;i++){t[i]=E(t[i]);n[i]=E(n[i])}for(i=0;i<24;i++)r[i]=E(r[i]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i");this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}function Ct(e){return Ne(e)?366:365}r("Y",0,0,function(){var e=this.year();return e<=9999?o(e,4):"+"+e}),r(0,["YY",2],0,function(){return this.year()%100}),r(0,["YYYY",4],0,"year"),r(0,["YYYYY",5],0,"year"),r(0,["YYYYYY",6,true],0,"year"),t("year","y"),n("year",1),b("Y",je),b("YY",v,i),b("YYYY",Ve,Pe),b("YYYYY",We,Fe),b("YYYYYY",We,Fe),C(["YYYYY","YYYYYY"],w),C("YYYY",function(e,t){t[w]=e.length===2?d.parseTwoDigitYear(e):y(e)}),C("YY",function(e,t){t[w]=d.parseTwoDigitYear(e)}),C("Y",function(e,t){t[w]=parseInt(e,10)}),d.parseTwoDigitYear=function(e){return y(e)+(y(e)>68?1900:2e3)};var wt=xe("FullYear",true);function St(){return Ne(this.year())}function Tt(e,t,n,r,i,o,s){var a;if(e<100&&e>=0){a=new Date(e+400,t,n,r,i,o,s);if(isFinite(a.getFullYear()))a.setFullYear(e)}else a=new Date(e,t,n,r,i,o,s);return a}function Rt(e){var t,n;if(e<100&&e>=0){n=Array.prototype.slice.call(arguments);n[0]=e+400;t=new Date(Date.UTC.apply(null,n));if(isFinite(t.getUTCFullYear()))t.setUTCFullYear(e)}else t=new Date(Date.UTC.apply(null,arguments));return t}function At(e,t,n){var r=7+t-n,i=(7+Rt(e,0,r).getUTCDay()-t)%7;return-i+r-1}function _t(e,t,n,r,i){var o=(7+n-r)%7,s=At(e,r,i),a=1+7*(t-1)+o+s,l,u;if(a<=0){l=e-1;u=Ct(l)+a}else if(a>Ct(e)){l=e+1;u=a-Ct(e)}else{l=e;u=a}return{year:l,dayOfYear:u}}function Nt(e,t,n){var r=At(e.year(),t,n),i=Math.floor((e.dayOfYear()-r-1)/7)+1,o,s;if(i<1){s=e.year()-1;o=i+x(s,t,n)}else if(i>x(e.year(),t,n)){o=i-x(e.year(),t,n);s=e.year()+1}else{s=e.year();o=i}return{week:o,year:s}}function x(e,t,n){var r=At(e,t,n),i=At(e+1,t,n);return(Ct(e)-r+i)/7}function xt(e){return Nt(e,this._week.dow,this._week.doy).week}r("w",["ww",2],"wo","week"),r("W",["WW",2],"Wo","isoWeek"),t("week","w"),t("isoWeek","W"),n("week",5),n("isoWeek",5),b("w",v),b("ww",v,i),b("W",v),b("WW",v,i),Je(["w","ww","W","WW"],function(e,t,n,r){t[r.substr(0,1)]=y(e)});var Ot={dow:0,doy:6};function It(){return this._week.dow}function Mt(){return this._week.doy}function kt(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function Dt(e){var t=Nt(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}function Lt(e,t){if(typeof e!=="string")return e;if(!isNaN(e))return parseInt(e,10);e=t.weekdaysParse(e);if(typeof e==="number")return e;return null}function Pt(e,t){if(typeof e==="string")return t.weekdaysParse(e)%7||7;return isNaN(e)?null:e}function Ft(e,t){return e.slice(t,7).concat(e.slice(0,t))}r("d",0,"do","day"),r("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),r("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),r("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),r("e",0,0,"weekday"),r("E",0,0,"isoWeekday"),t("day","d"),t("weekday","e"),t("isoWeekday","E"),n("day",11),n("weekday",11),n("isoWeekday",11),b("d",v),b("e",v),b("E",v),b("dd",function(e,t){return t.weekdaysMinRegex(e)}),b("ddd",function(e,t){return t.weekdaysShortRegex(e)}),b("dddd",function(e,t){return t.weekdaysRegex(e)}),Je(["dd","ddd","dddd"],function(e,t,n,r){var i=n._locale.weekdaysParse(e,r,n._strict);if(i!=null)t.d=i;else h(n).invalidWeekday=e}),Je(["d","e","E"],function(e,t,n,r){t[r]=y(e)});var Bt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Ht="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Ut="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Vt=Xe,Wt=Xe,$t=Xe;function jt(e,t){var n=s(this._weekdays)?this._weekdays:this._weekdays[e&&e!==true&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===true?Ft(n,this._week.dow):e?n[e.day()]:n}function zt(e){return e===true?Ft(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Gt(e){return e===true?Ft(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Yt(e,t,n){var r,i,o,s=e.toLocaleLowerCase();if(!this._weekdaysParse){this._weekdaysParse=[];this._shortWeekdaysParse=[];this._minWeekdaysParse=[];for(r=0;r<7;++r){o=c([2e3,1]).day(r);this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase();this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase();this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase()}}if(n)if(t==="dddd"){i=N.call(this._weekdaysParse,s);return i!==-1?i:null}else if(t==="ddd"){i=N.call(this._shortWeekdaysParse,s);return i!==-1?i:null}else{i=N.call(this._minWeekdaysParse,s);return i!==-1?i:null}else if(t==="dddd"){i=N.call(this._weekdaysParse,s);if(i!==-1)return i;i=N.call(this._shortWeekdaysParse,s);if(i!==-1)return i;i=N.call(this._minWeekdaysParse,s);return i!==-1?i:null}else if(t==="ddd"){i=N.call(this._shortWeekdaysParse,s);if(i!==-1)return i;i=N.call(this._weekdaysParse,s);if(i!==-1)return i;i=N.call(this._minWeekdaysParse,s);return i!==-1?i:null}else{i=N.call(this._minWeekdaysParse,s);if(i!==-1)return i;i=N.call(this._weekdaysParse,s);if(i!==-1)return i;i=N.call(this._shortWeekdaysParse,s);return i!==-1?i:null}}function Xt(e,t,n){var r,i,o;if(this._weekdaysParseExact)return Yt.call(this,e,t,n);if(!this._weekdaysParse){this._weekdaysParse=[];this._minWeekdaysParse=[];this._shortWeekdaysParse=[];this._fullWeekdaysParse=[]}for(r=0;r<7;r++){i=c([2e3,1]).day(r);if(n&&!this._fullWeekdaysParse[r]){this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i");this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i");this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")}if(!this._weekdaysParse[r]){o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,"");this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")}if(n&&t==="dddd"&&this._fullWeekdaysParse[r].test(e))return r;else if(n&&t==="ddd"&&this._shortWeekdaysParse[r].test(e))return r;else if(n&&t==="dd"&&this._minWeekdaysParse[r].test(e))return r;else if(!n&&this._weekdaysParse[r].test(e))return r}}function Kt(e){if(!this.isValid())return e!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();if(e!=null){e=Lt(e,this.localeData());return this.add(e-t,"d")}else return t}function qt(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function Zt(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=Pt(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function Qt(e){if(this._weekdaysParseExact){if(!l(this,"_weekdaysRegex"))tn.call(this);if(e)return this._weekdaysStrictRegex;else return this._weekdaysRegex}else{if(!l(this,"_weekdaysRegex"))this._weekdaysRegex=Vt;return this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex}}function Jt(e){if(this._weekdaysParseExact){if(!l(this,"_weekdaysRegex"))tn.call(this);if(e)return this._weekdaysShortStrictRegex;else return this._weekdaysShortRegex}else{if(!l(this,"_weekdaysShortRegex"))this._weekdaysShortRegex=Wt;return this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex}}function en(e){if(this._weekdaysParseExact){if(!l(this,"_weekdaysRegex"))tn.call(this);if(e)return this._weekdaysMinStrictRegex;else return this._weekdaysMinRegex}else{if(!l(this,"_weekdaysMinRegex"))this._weekdaysMinRegex=$t;return this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex}}function tn(){function e(e,t){return t.length-e.length}var t=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++){s=c([2e3,1]).day(o);a=E(this.weekdaysMin(s,""));l=E(this.weekdaysShort(s,""));u=E(this.weekdays(s,""));t.push(a);n.push(l);r.push(u);i.push(a);i.push(l);i.push(u)}t.sort(e);n.sort(e);r.sort(e);i.sort(e);this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i");this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function nn(){return this.hours()%12||12}function rn(){return this.hours()||24}function on(e,t){r(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function sn(e,t){return t._meridiemParse}function an(e){return(e+"").toLowerCase().charAt(0)==="p"}r("H",["HH",2],0,"hour"),r("h",["hh",2],0,nn),r("k",["kk",2],0,rn),r("hmm",0,0,function(){return""+nn.apply(this)+o(this.minutes(),2)}),r("hmmss",0,0,function(){return""+nn.apply(this)+o(this.minutes(),2)+o(this.seconds(),2)}),r("Hmm",0,0,function(){return""+this.hours()+o(this.minutes(),2)}),r("Hmmss",0,0,function(){return""+this.hours()+o(this.minutes(),2)+o(this.seconds(),2)}),on("a",true),on("A",false),t("hour","h"),n("hour",13),b("a",sn),b("A",sn),b("H",v),b("h",v),b("k",v),b("HH",v,i),b("hh",v,i),b("kk",v,i),b("hmm",Be),b("hmmss",He),b("Hmm",Be),b("Hmmss",He),C(["H","HH"],R),C(["k","kk"],function(e,t,n){var r=y(e);t[R]=r===24?0:r}),C(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e);n._meridiem=e}),C(["h","hh"],function(e,t,n){t[R]=y(e);h(n).bigHour=true}),C("hmm",function(e,t,n){var r=e.length-2;t[R]=y(e.substr(0,r));t[A]=y(e.substr(r));h(n).bigHour=true}),C("hmmss",function(e,t,n){var r=e.length-4,i=e.length-2;t[R]=y(e.substr(0,r));t[A]=y(e.substr(r,2));t[_]=y(e.substr(i));h(n).bigHour=true}),C("Hmm",function(e,t,n){var r=e.length-2;t[R]=y(e.substr(0,r));t[A]=y(e.substr(r))}),C("Hmmss",function(e,t,n){var r=e.length-4,i=e.length-2;t[R]=y(e.substr(0,r));t[A]=y(e.substr(r,2));t[_]=y(e.substr(i))});var ln,un=xe("Hours",true);function cn(e,t,n){if(e>11)return n?"pm":"PM";else return n?"am":"AM"}var dn={calendar:ie,longDateFormat:pe,invalidDate:me,ordinal:ve,dayOfMonthOrdinalParse:be,relativeTime:Ce,months:st,monthsShort:at,week:Ot,weekdays:Bt,weekdaysMin:Ut,weekdaysShort:Ht,meridiemParse:/[ap]\.?m?\.?/i},O={},hn={},fn;function pn(e,t){var n,r=Math.min(e.length,t.length);for(n=0;n<r;n+=1)if(e[n]!==t[n])return n;return r}function gn(e){return e?e.toLowerCase().replace("_","-"):e}function mn(e){var t=0,n,r,i,o;while(t<e.length){o=gn(e[t]).split("-");n=o.length;r=gn(e[t+1]);r=r?r.split("-"):null;while(n>0){i=vn(o.slice(0,n).join("-"));if(i)return i;if(r&&r.length>=n&&pn(o,r)>=n-1)break;n--}t++}return fn}function yn(e){return e.match("^[^/\\\\]*$")!=null}function vn(t){var e=null,n;if(O[t]===undefined&&"object"!=="undefined"&&cs&&cs.exports&&yn(t))try{e=fn._abbr;n=undefined;ds(307)("./"+t);bn(e)}catch(e){O[t]=null}return O[t]}function bn(e,t){var n;if(e){if(a(t))n=wn(e);else n=En(e,t);if(n)fn=n;else if(typeof console!=="undefined"&&console.warn)console.warn("Locale "+e+" not found. Did you forget to load it?")}return fn._abbr}function En(e,t){if(t!==null){var n,r=dn;t.abbr=e;if(O[e]!=null){ee("defineLocaleOverride","use moment.updateLocale(localeName, config) to change "+"an existing locale. moment.defineLocale(localeName, "+"config) should only be used for creating a new locale "+"See http://momentjs.com/guides/#/warnings/define-locale/ for more info.");r=O[e]._config}else if(t.parentLocale!=null)if(O[t.parentLocale]!=null)r=O[t.parentLocale]._config;else{n=vn(t.parentLocale);if(n!=null)r=n._config;else{if(!hn[t.parentLocale])hn[t.parentLocale]=[];hn[t.parentLocale].push({name:e,config:t});return null}}O[e]=new re(ne(r,t));if(hn[e])hn[e].forEach(function(e){En(e.name,e.config)});bn(e);return O[e]}else{delete O[e];return null}}function Cn(e,t){if(t!=null){var n,r,i=dn;if(O[e]!=null&&O[e].parentLocale!=null)O[e].set(ne(O[e]._config,t));else{r=vn(e);if(r!=null)i=r._config;t=ne(i,t);if(r==null)t.abbr=e;n=new re(t);n.parentLocale=O[e];O[e]=n}bn(e)}else if(O[e]!=null)if(O[e].parentLocale!=null){O[e]=O[e].parentLocale;if(e===bn())bn(e)}else if(O[e]!=null)delete O[e];return O[e]}function wn(e){var t;if(e&&e._locale&&e._locale._abbr)e=e._locale._abbr;if(!e)return fn;if(!s(e)){t=vn(e);if(t)return t;e=[e]}return mn(e)}function Sn(){return J(O)}function Tn(e){var t,n=e._a;if(n&&h(e).overflow===-2){t=n[S]<0||n[S]>11?S:n[T]<1||n[T]>ot(n[w],n[S])?T:n[R]<0||n[R]>24||n[R]===24&&(n[A]!==0||n[_]!==0||n[tt]!==0)?R:n[A]<0||n[A]>59?A:n[_]<0||n[_]>59?_:n[tt]<0||n[tt]>999?tt:-1;if(h(e)._overflowDayOfYear&&(t<w||t>T))t=T;if(h(e)._overflowWeeks&&t===-1)t=nt;if(h(e)._overflowWeekday&&t===-1)t=rt;h(e).overflow=t}return e}var Rn=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,An=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,_n=/Z|[+-]\d\d(?::?\d\d)?/,Nn=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,false],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,false],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,false],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,false],["YYYY",/\d{4}/,false]],xn=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],On=/^\/?Date\((-?\d+)/i,In=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Mn={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function kn(e){var t,n,r=e._i,i=Rn.exec(r)||An.exec(r),o,s,a,l,u=Nn.length,c=xn.length;if(i){h(e).iso=true;for(t=0,n=u;t<n;t++)if(Nn[t][1].exec(i[1])){s=Nn[t][0];o=Nn[t][2]!==false;break}if(s==null){e._isValid=false;return}if(i[3]){for(t=0,n=c;t<n;t++)if(xn[t][1].exec(i[3])){a=(i[2]||" ")+xn[t][0];break}if(a==null){e._isValid=false;return}}if(!o&&a!=null){e._isValid=false;return}if(i[4])if(_n.exec(i[4]))l="Z";else{e._isValid=false;return}e._f=s+(a||"")+(l||"");zn(e)}else e._isValid=false}function Dn(e,t,n,r,i,o){var s=[Ln(e),at.indexOf(t),parseInt(n,10),parseInt(r,10),parseInt(i,10)];if(o)s.push(parseInt(o,10));return s}function Ln(e){var t=parseInt(e,10);if(t<=49)return 2e3+t;else if(t<=999)return 1900+t;return t}function Pn(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Fn(e,t,n){if(e){var r=Ht.indexOf(e),i=new Date(t[0],t[1],t[2]).getDay();if(r!==i){h(n).weekdayMismatch=true;n._isValid=false;return false}}return true}function Bn(e,t,n){if(e)return Mn[e];else if(t)return 0;else{var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}}function Hn(e){var t=In.exec(Pn(e._i)),n;if(t){n=Dn(t[4],t[3],t[2],t[5],t[6],t[7]);if(!Fn(t[1],n,e))return;e._a=n;e._tzm=Bn(t[8],t[9],t[10]);e._d=Rt.apply(null,e._a);e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm);h(e).rfc2822=true}else e._isValid=false}function Un(e){var t=On.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}kn(e);if(e._isValid===false)delete e._isValid;else return;Hn(e);if(e._isValid===false)delete e._isValid;else return;if(e._strict)e._isValid=false;else d.createFromInputFallback(e)}function Vn(e,t,n){if(e!=null)return e;if(t!=null)return t;return n}function Wn(e){var t=new Date(d.now());if(e._useUTC)return[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()];return[t.getFullYear(),t.getMonth(),t.getDate()]}function $n(e){var t,n,r=[],i,o,s;if(e._d)return;i=Wn(e);if(e._w&&e._a[T]==null&&e._a[S]==null)jn(e);if(e._dayOfYear!=null){s=Vn(e._a[w],i[w]);if(e._dayOfYear>Ct(s)||e._dayOfYear===0)h(e)._overflowDayOfYear=true;n=Rt(s,0,e._dayOfYear);e._a[S]=n.getUTCMonth();e._a[T]=n.getUTCDate()}for(t=0;t<3&&e._a[t]==null;++t)e._a[t]=r[t]=i[t];for(;t<7;t++)e._a[t]=r[t]=e._a[t]==null?t===2?1:0:e._a[t];if(e._a[R]===24&&e._a[A]===0&&e._a[_]===0&&e._a[tt]===0){e._nextDay=true;e._a[R]=0}e._d=(e._useUTC?Rt:Tt).apply(null,r);o=e._useUTC?e._d.getUTCDay():e._d.getDay();if(e._tzm!=null)e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm);if(e._nextDay)e._a[R]=24;if(e._w&&typeof e._w.d!=="undefined"&&e._w.d!==o)h(e).weekdayMismatch=true}function jn(e){var t,n,r,i,o,s,a,l,u;t=e._w;if(t.GG!=null||t.W!=null||t.E!=null){o=1;s=4;n=Vn(t.GG,e._a[w],Nt(I(),1,4).year);r=Vn(t.W,1);i=Vn(t.E,1);if(i<1||i>7)l=true}else{o=e._locale._week.dow;s=e._locale._week.doy;u=Nt(I(),o,s);n=Vn(t.gg,e._a[w],u.year);r=Vn(t.w,u.week);if(t.d!=null){i=t.d;if(i<0||i>6)l=true}else if(t.e!=null){i=t.e+o;if(t.e<0||t.e>6)l=true}else i=o}if(r<1||r>x(n,o,s))h(e)._overflowWeeks=true;else if(l!=null)h(e)._overflowWeekday=true;else{a=_t(n,r,i,o,s);e._a[w]=a.year;e._dayOfYear=a.dayOfYear}}function zn(e){if(e._f===d.ISO_8601){kn(e);return}if(e._f===d.RFC_2822){Hn(e);return}e._a=[];h(e).empty=true;var t=""+e._i,n,r,i,o,s,a=t.length,l=0,u,c;i=fe(e._f,e._locale).match(se)||[];c=i.length;for(n=0;n<c;n++){o=i[n];r=(t.match(qe(o,e))||[])[0];if(r){s=t.substr(0,t.indexOf(r));if(s.length>0)h(e).unusedInput.push(s);t=t.slice(t.indexOf(r)+r.length);l+=r.length}if(ue[o]){if(r)h(e).empty=false;else h(e).unusedTokens.push(o);et(o,r,e)}else if(e._strict&&!r)h(e).unusedTokens.push(o)}h(e).charsLeftOver=a-l;if(t.length>0)h(e).unusedInput.push(t);if(e._a[R]<=12&&h(e).bigHour===true&&e._a[R]>0)h(e).bigHour=undefined;h(e).parsedDateParts=e._a.slice(0);h(e).meridiem=e._meridiem;e._a[R]=Gn(e._locale,e._a[R],e._meridiem);u=h(e).era;if(u!==null)e._a[w]=e._locale.erasConvertYear(u,e._a[w]);$n(e);Tn(e)}function Gn(e,t,n){var r;if(n==null)return t;if(e.meridiemHour!=null)return e.meridiemHour(t,n);else if(e.isPM!=null){r=e.isPM(n);if(r&&t<12)t+=12;if(!r&&t===12)t=0;return t}else return t}function Yn(e){var t,n,r,i,o,s,a=false,l=e._f.length;if(l===0){h(e).invalidFormat=true;e._d=new Date(NaN);return}for(i=0;i<l;i++){o=0;s=false;t=K({},e);if(e._useUTC!=null)t._useUTC=e._useUTC;t._f=e._f[i];zn(t);if(z(t))s=true;o+=h(t).charsLeftOver;o+=h(t).unusedTokens.length*10;h(t).score=o;if(!a){if(r==null||o<r||s){r=o;n=t;if(s)a=true}}else if(o<r){r=o;n=t}}$(e,n||t)}function Xn(e){if(e._d)return;var t=Re(e._i),n=t.day===undefined?t.date:t.day;e._a=W([t.year,t.month,n,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)});$n(e)}function Kn(e){var t=new q(Tn(qn(e)));if(t._nextDay){t.add(1,"d");t._nextDay=undefined}return t}function qn(e){var t=e._i,n=e._f;e._locale=e._locale||wn(e._l);if(t===null||n===undefined&&t==="")return G({nullInput:true});if(typeof t==="string")e._i=t=e._locale.preparse(t);if(f(t))return new q(Tn(t));else if(V(t))e._d=t;else if(s(n))Yn(e);else if(n)zn(e);else Zn(e);if(!z(e))e._d=null;return e}function Zn(e){var t=e._i;if(a(t))e._d=new Date(d.now());else if(V(t))e._d=new Date(t.valueOf());else if(typeof t==="string")Un(e);else if(s(t)){e._a=W(t.slice(0),function(e){return parseInt(e,10)});$n(e)}else if(H(t))Xn(e);else if(u(t))e._d=new Date(t);else d.createFromInputFallback(e)}function Qn(e,t,n,r,i){var o={};if(t===true||t===false){r=t;t=undefined}if(n===true||n===false){r=n;n=undefined}if(H(e)&&U(e)||s(e)&&e.length===0)e=undefined;o._isAMomentObject=true;o._useUTC=o._isUTC=i;o._l=n;o._i=e;o._f=t;o._strict=r;return Kn(o)}function I(e,t,n,r){return Qn(e,t,n,r,false)}d.createFromInputFallback=e("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), "+"which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are "+"discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),d.ISO_8601=function(){},d.RFC_2822=function(){};var Jn=e("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=I.apply(null,arguments);if(this.isValid()&&e.isValid())return e<this?this:e;else return G()}),er=e("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=I.apply(null,arguments);if(this.isValid()&&e.isValid())return e>this?this:e;else return G()});function tr(e,t){var n,r;if(t.length===1&&s(t[0]))t=t[0];if(!t.length)return I();n=t[0];for(r=1;r<t.length;++r)if(!t[r].isValid()||t[r][e](n))n=t[r];return n}function nr(){var e=[].slice.call(arguments,0);return tr("isBefore",e)}function rr(){var e=[].slice.call(arguments,0);return tr("isAfter",e)}var ir=function(){return Date.now?Date.now():+new Date},or=["year","quarter","month","week","day","hour","minute","second","millisecond"];function sr(e){var t,n=false,r,i=or.length;for(t in e)if(l(e,t)&&!(N.call(or,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return false;for(r=0;r<i;++r)if(e[or[r]]){if(n)return false;if(parseFloat(e[or[r]])!==y(e[or[r]]))n=true}return true}function ar(){return this._isValid}function lr(){return M(NaN)}function ur(e){var t=Re(e),n=t.year||0,r=t.quarter||0,i=t.month||0,o=t.week||t.isoWeek||0,s=t.day||0,a=t.hour||0,l=t.minute||0,u=t.second||0,c=t.millisecond||0;this._isValid=sr(t);this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60;this._days=+s+o*7;this._months=+i+r*3+n*12;this._data={};this._locale=wn();this._bubble()}function cr(e){return e instanceof ur}function dr(e){if(e<0)return Math.round(-1*e)*-1;else return Math.round(e)}function hr(e,t,n){var r=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),o=0,s;for(s=0;s<r;s++)if(n&&e[s]!==t[s]||!n&&y(e[s])!==y(t[s]))o++;return o+i}function fr(e,n){r(e,0,0,function(){var e=this.utcOffset(),t="+";if(e<0){e=-e;t="-"}return t+o(~~(e/60),2)+n+o(~~e%60,2)})}fr("Z",":"),fr("ZZ",""),b("Z",Ge),b("ZZ",Ge),C(["Z","ZZ"],function(e,t,n){n._useUTC=true;n._tzm=gr(Ge,e)});var pr=/([\+\-]|\d\d)/gi;function gr(e,t){var n=(t||"").match(e),r,i,o;if(n===null)return null;r=n[n.length-1]||[];i=(r+"").match(pr)||["-",0,0];o=+(i[1]*60)+y(i[2]);return o===0?0:i[0]==="+"?o:-o}function mr(e,t){var n,r;if(t._isUTC){n=t.clone();r=(f(e)||V(e)?e.valueOf():I(e).valueOf())-n.valueOf();n._d.setTime(n._d.valueOf()+r);d.updateOffset(n,false);return n}else return I(e).local()}function yr(e){return-Math.round(e._d.getTimezoneOffset())}function vr(e,t,n){var r=this._offset||0,i;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e==="string"){e=gr(Ge,e);if(e===null)return this}else if(Math.abs(e)<16&&!n)e=e*60;if(!this._isUTC&&t)i=yr(this);this._offset=e;this._isUTC=true;if(i!=null)this.add(i,"m");if(r!==e)if(!t||this._changeInProgress)Lr(this,M(e-r,"m"),1,false);else if(!this._changeInProgress){this._changeInProgress=true;d.updateOffset(this,true);this._changeInProgress=null}return this}else return this._isUTC?r:yr(this)}function br(e,t){if(e!=null){if(typeof e!=="string")e=-e;this.utcOffset(e,t);return this}else return-this.utcOffset()}function Er(e){return this.utcOffset(0,e)}function Cr(e){if(this._isUTC){this.utcOffset(0,e);this._isUTC=false;if(e)this.subtract(yr(this),"m")}return this}function wr(){if(this._tzm!=null)this.utcOffset(this._tzm,false,true);else if(typeof this._i==="string"){var e=gr(ze,this._i);if(e!=null)this.utcOffset(e);else this.utcOffset(0,true)}return this}function Sr(e){if(!this.isValid())return false;e=e?I(e).utcOffset():0;return(this.utcOffset()-e)%60===0}function Tr(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Rr(){if(!a(this._isDSTShifted))return this._isDSTShifted;var e={},t;K(e,this);e=qn(e);if(e._a){t=e._isUTC?c(e._a):I(e._a);this._isDSTShifted=this.isValid()&&hr(e._a,t.toArray())>0}else this._isDSTShifted=false;return this._isDSTShifted}function Ar(){return this.isValid()?!this._isUTC:false}function _r(){return this.isValid()?this._isUTC:false}function Nr(){return this.isValid()?this._isUTC&&this._offset===0:false}d.updateOffset=function(){};var xr=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Or=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function M(e,t){var n=e,r=null,i,o,s;if(cr(e))n={ms:e._milliseconds,d:e._days,M:e._months};else if(u(e)||!isNaN(+e)){n={};if(t)n[t]=+e;else n.milliseconds=+e}else if(r=xr.exec(e)){i=r[1]==="-"?-1:1;n={y:0,d:y(r[T])*i,h:y(r[R])*i,m:y(r[A])*i,s:y(r[_])*i,ms:y(dr(r[tt]*1e3))*i}}else if(r=Or.exec(e)){i=r[1]==="-"?-1:1;n={y:Ir(r[2],i),M:Ir(r[3],i),w:Ir(r[4],i),d:Ir(r[5],i),h:Ir(r[6],i),m:Ir(r[7],i),s:Ir(r[8],i)}}else if(n==null)n={};else if(typeof n==="object"&&("from"in n||"to"in n)){s=kr(I(n.from),I(n.to));n={};n.ms=s.milliseconds;n.M=s.months}o=new ur(n);if(cr(e)&&l(e,"_locale"))o._locale=e._locale;if(cr(e)&&l(e,"_isValid"))o._isValid=e._isValid;return o}function Ir(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Mr(e,t){var n={};n.months=t.month()-e.month()+(t.year()-e.year())*12;if(e.clone().add(n.months,"M").isAfter(t))--n.months;n.milliseconds=+t-+e.clone().add(n.months,"M");return n}function kr(e,t){var n;if(!(e.isValid()&&t.isValid()))return{milliseconds:0,months:0};t=mr(t,e);if(e.isBefore(t))n=Mr(e,t);else{n=Mr(t,e);n.milliseconds=-n.milliseconds;n.months=-n.months}return n}function Dr(i,o){return function(e,t){var n,r;if(t!==null&&!isNaN(+t)){ee(o,"moment()."+o+"(period, number) is deprecated. Please use moment()."+o+"(number, period). "+"See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.");r=e;e=t;t=r}n=M(e,t);Lr(this,n,i);return this}}function Lr(e,t,n,r){var i=t._milliseconds,o=dr(t._days),s=dr(t._months);if(!e.isValid())return;r=r==null?true:r;if(s)gt(e,Oe(e,"Month")+s*n);if(o)Ie(e,"Date",Oe(e,"Date")+o*n);if(i)e._d.setTime(e._d.valueOf()+i*n);if(r)d.updateOffset(e,o||s)}M.fn=ur.prototype,M.invalid=lr;var Pr=Dr(1,"add"),Fr=Dr(-1,"subtract");function Br(e){return typeof e==="string"||e instanceof String}function Hr(e){return f(e)||V(e)||Br(e)||u(e)||Vr(e)||Ur(e)||e===null||e===undefined}function Ur(e){var t=H(e)&&!U(e),n=false,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1){o=r[i];n=n||l(e,o)}return t&&n}function Vr(t){var e=s(t),n=false;if(e)n=t.filter(function(e){return!u(e)&&Br(t)}).length===0;return e&&n}function Wr(e){var t=H(e)&&!U(e),n=false,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1){o=r[i];n=n||l(e,o)}return t&&n}function $r(e,t){var n=e.diff(t,"days",true);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function jr(e,t){if(arguments.length===1)if(!arguments[0]){e=undefined;t=undefined}else if(Hr(arguments[0])){e=arguments[0];t=undefined}else if(Wr(arguments[0])){t=arguments[0];e=undefined}var n=e||I(),r=mr(n,this).startOf("day"),i=d.calendarFormat(this,r)||"sameElse",o=t&&(p(t[i])?t[i].call(this,n):t[i]);return this.format(o||this.localeData().calendar(i,this,I(n)))}function zr(){return new q(this)}function Gr(e,t){var n=f(e)?e:I(e);if(!(this.isValid()&&n.isValid()))return false;t=g(t)||"millisecond";if(t==="millisecond")return this.valueOf()>n.valueOf();else return n.valueOf()<this.clone().startOf(t).valueOf()}function Yr(e,t){var n=f(e)?e:I(e);if(!(this.isValid()&&n.isValid()))return false;t=g(t)||"millisecond";if(t==="millisecond")return this.valueOf()<n.valueOf();else return this.clone().endOf(t).valueOf()<n.valueOf()}function Xr(e,t,n,r){var i=f(e)?e:I(e),o=f(t)?t:I(t);if(!(this.isValid()&&i.isValid()&&o.isValid()))return false;r=r||"()";return(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))}function Kr(e,t){var n=f(e)?e:I(e),r;if(!(this.isValid()&&n.isValid()))return false;t=g(t)||"millisecond";if(t==="millisecond")return this.valueOf()===n.valueOf();else{r=n.valueOf();return this.clone().startOf(t).valueOf()<=r&&r<=this.clone().endOf(t).valueOf()}}function qr(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Zr(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Qr(e,t,n){var r,i,o;if(!this.isValid())return NaN;r=mr(e,this);if(!r.isValid())return NaN;i=(r.utcOffset()-this.utcOffset())*6e4;t=g(t);switch(t){case"year":o=Jr(this,r)/12;break;case"month":o=Jr(this,r);break;case"quarter":o=Jr(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:m(o)}function Jr(e,t){if(e.date()<t.date())return-Jr(t,e);var n=(t.year()-e.year())*12+(t.month()-e.month()),r=e.clone().add(n,"months"),i,o;if(t-r<0){i=e.clone().add(n-1,"months");o=(t-r)/(r-i)}else{i=e.clone().add(n+1,"months");o=(t-r)/(i-r)}return-(n+o)||0}function ei(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function ti(e){if(!this.isValid())return null;var t=e!==true,n=t?this.clone().utc():this;if(n.year()<0||n.year()>9999)return he(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ");if(p(Date.prototype.toISOString))if(t)return this.toDate().toISOString();else return new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",he(n,"Z"));return he(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function ni(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",n,r,i,o;if(!this.isLocal()){e=this.utcOffset()===0?"moment.utc":"moment.parseZone";t="Z"}n="["+e+'("]';r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY";i="-MM-DD[T]HH:mm:ss.SSS";o=t+'[")]';return this.format(n+r+i+o)}function ri(e){if(!e)e=this.isUtc()?d.defaultFormatUtc:d.defaultFormat;var t=he(this,e);return this.localeData().postformat(t)}function ii(e,t){if(this.isValid()&&(f(e)&&e.isValid()||I(e).isValid()))return M({to:this,from:e}).locale(this.locale()).humanize(!t);else return this.localeData().invalidDate()}function oi(e){return this.from(I(),e)}function si(e,t){if(this.isValid()&&(f(e)&&e.isValid()||I(e).isValid()))return M({from:this,to:e}).locale(this.locale()).humanize(!t);else return this.localeData().invalidDate()}function ai(e){return this.to(I(),e)}function li(e){var t;if(e===undefined)return this._locale._abbr;else{t=wn(e);if(t!=null)this._locale=t;return this}}d.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",d.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var ui=e("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){if(e===undefined)return this.localeData();else return this.locale(e)});function ci(){return this._locale}var di=1e3,hi=60*di,fi=60*hi,pi=(365*400+97)*24*fi;function gi(e,t){return(e%t+t)%t}function mi(e,t,n){if(e<100&&e>=0)return new Date(e+400,t,n)-pi;else return new Date(e,t,n).valueOf()}function yi(e,t,n){if(e<100&&e>=0)return Date.UTC(e+400,t,n)-pi;else return Date.UTC(e,t,n)}function vi(e){var t,n;e=g(e);if(e===undefined||e==="millisecond"||!this.isValid())return this;n=this._isUTC?yi:mi;switch(e){case"year":t=n(this.year(),0,1);break;case"quarter":t=n(this.year(),this.month()-this.month()%3,1);break;case"month":t=n(this.year(),this.month(),1);break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=n(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf();t-=gi(t+(this._isUTC?0:this.utcOffset()*hi),fi);break;case"minute":t=this._d.valueOf();t-=gi(t,hi);break;case"second":t=this._d.valueOf();t-=gi(t,di);break}this._d.setTime(t);d.updateOffset(this,true);return this}function bi(e){var t,n;e=g(e);if(e===undefined||e==="millisecond"||!this.isValid())return this;n=this._isUTC?yi:mi;switch(e){case"year":t=n(this.year()+1,0,1)-1;break;case"quarter":t=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=n(this.year(),this.month()+1,1)-1;break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf();t+=fi-gi(t+(this._isUTC?0:this.utcOffset()*hi),fi)-1;break;case"minute":t=this._d.valueOf();t+=hi-gi(t,hi)-1;break;case"second":t=this._d.valueOf();t+=di-gi(t,di)-1;break}this._d.setTime(t);d.updateOffset(this,true);return this}function Ei(){return this._d.valueOf()-(this._offset||0)*6e4}function Ci(){return Math.floor(this.valueOf()/1e3)}function wi(){return new Date(this.valueOf())}function Si(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Ti(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Ri(){return this.isValid()?this.toISOString():null}function Ai(){return z(this)}function _i(){return $({},h(this))}function Ni(){return h(this).overflow}function xi(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Oi(e,t){var n,r,i,o=this._eras||wn("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=d(o[n].since).startOf("day");o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=+Infinity;break;case"string":i=d(o[n].until).startOf("day").valueOf();o[n].until=i.valueOf();break}}return o}function Ii(e,t,n){var r,i,o=this.eras(),s,a,l;e=e.toUpperCase();for(r=0,i=o.length;r<i;++r){s=o[r].name.toUpperCase();a=o[r].abbr.toUpperCase();l=o[r].narrow.toUpperCase();if(n)switch(t){case"N":case"NN":case"NNN":if(a===e)return o[r];break;case"NNNN":if(s===e)return o[r];break;case"NNNNN":if(l===e)return o[r];break}else if([s,a,l].indexOf(e)>=0)return o[r]}}function Mi(e,t){var n=e.since<=e.until?+1:-1;if(t===undefined)return d(e.since).year();else return d(e.since).year()+(t-e.offset)*n}function ki(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){n=this.clone().startOf("day").valueOf();if(r[e].since<=n&&n<=r[e].until)return r[e].name;if(r[e].until<=n&&n<=r[e].since)return r[e].name}return""}function Di(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){n=this.clone().startOf("day").valueOf();if(r[e].since<=n&&n<=r[e].until)return r[e].narrow;if(r[e].until<=n&&n<=r[e].since)return r[e].narrow}return""}function Li(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){n=this.clone().startOf("day").valueOf();if(r[e].since<=n&&n<=r[e].until)return r[e].abbr;if(r[e].until<=n&&n<=r[e].since)return r[e].abbr}return""}function Pi(){var e,t,n,r,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e){n=i[e].since<=i[e].until?+1:-1;r=this.clone().startOf("day").valueOf();if(i[e].since<=r&&r<=i[e].until||i[e].until<=r&&r<=i[e].since)return(this.year()-d(i[e].since).year())*n+i[e].offset}return this.year()}function Fi(e){if(!l(this,"_erasNameRegex"))ji.call(this);return e?this._erasNameRegex:this._erasRegex}function Bi(e){if(!l(this,"_erasAbbrRegex"))ji.call(this);return e?this._erasAbbrRegex:this._erasRegex}function Hi(e){if(!l(this,"_erasNarrowRegex"))ji.call(this);return e?this._erasNarrowRegex:this._erasRegex}function Ui(e,t){return t.erasAbbrRegex(e)}function Vi(e,t){return t.erasNameRegex(e)}function Wi(e,t){return t.erasNarrowRegex(e)}function $i(e,t){return t._eraYearOrdinalRegex||$e}function ji(){var e=[],t=[],n=[],r=[],i,o,s=this.eras();for(i=0,o=s.length;i<o;++i){t.push(E(s[i].name));e.push(E(s[i].abbr));n.push(E(s[i].narrow));r.push(E(s[i].name));r.push(E(s[i].abbr));r.push(E(s[i].narrow))}this._erasRegex=new RegExp("^("+r.join("|")+")","i");this._erasNameRegex=new RegExp("^("+t.join("|")+")","i");this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i");this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}function zi(e,t){r(0,[e,e.length],0,t)}function Gi(e){return Qi.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Yi(e){return Qi.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Xi(){return x(this.year(),1,4)}function Ki(){return x(this.isoWeekYear(),1,4)}function qi(){var e=this.localeData()._week;return x(this.year(),e.dow,e.doy)}function Zi(){var e=this.localeData()._week;return x(this.weekYear(),e.dow,e.doy)}function Qi(e,t,n,r,i){var o;if(e==null)return Nt(this,r,i).year;else{o=x(e,r,i);if(t>o)t=o;return Ji.call(this,e,t,n,r,i)}}function Ji(e,t,n,r,i){var o=_t(e,t,n,r,i),s=Rt(o.year,0,o.dayOfYear);this.year(s.getUTCFullYear());this.month(s.getUTCMonth());this.date(s.getUTCDate());return this}function eo(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}r("N",0,0,"eraAbbr"),r("NN",0,0,"eraAbbr"),r("NNN",0,0,"eraAbbr"),r("NNNN",0,0,"eraName"),r("NNNNN",0,0,"eraNarrow"),r("y",["y",1],"yo","eraYear"),r("y",["yy",2],0,"eraYear"),r("y",["yyy",3],0,"eraYear"),r("y",["yyyy",4],0,"eraYear"),b("N",Ui),b("NN",Ui),b("NNN",Ui),b("NNNN",Vi),b("NNNNN",Wi),C(["N","NN","NNN","NNNN","NNNNN"],function(e,t,n,r){var i=n._locale.erasParse(e,r,n._strict);if(i)h(n).era=i;else h(n).invalidEra=e}),b("y",$e),b("yy",$e),b("yyy",$e),b("yyyy",$e),b("yo",$i),C(["y","yy","yyy","yyyy"],w),C(["yo"],function(e,t,n,r){var i;if(n._locale._eraYearOrdinalRegex)i=e.match(n._locale._eraYearOrdinalRegex);if(n._locale.eraYearOrdinalParse)t[w]=n._locale.eraYearOrdinalParse(e,i);else t[w]=parseInt(e,10)}),r(0,["gg",2],0,function(){return this.weekYear()%100}),r(0,["GG",2],0,function(){return this.isoWeekYear()%100}),zi("gggg","weekYear"),zi("ggggg","weekYear"),zi("GGGG","isoWeekYear"),zi("GGGGG","isoWeekYear"),t("weekYear","gg"),t("isoWeekYear","GG"),n("weekYear",1),n("isoWeekYear",1),b("G",je),b("g",je),b("GG",v,i),b("gg",v,i),b("GGGG",Ve,Pe),b("gggg",Ve,Pe),b("GGGGG",We,Fe),b("ggggg",We,Fe),Je(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,r){t[r.substr(0,2)]=y(e)}),Je(["gg","GG"],function(e,t,n,r){t[r]=d.parseTwoDigitYear(e)}),r("Q",0,"Qo","quarter"),t("quarter","Q"),n("quarter",7),b("Q",De),C("Q",function(e,t){t[S]=(y(e)-1)*3}),r("D",["DD",2],"Do","date"),t("date","D"),n("date",9),b("D",v),b("DD",v,i),b("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),C(["D","DD"],T),C("Do",function(e,t){t[T]=y(e.match(v)[0])});var to=xe("Date",true);function no(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}r("DDD",["DDDD",3],"DDDo","dayOfYear"),t("dayOfYear","DDD"),n("dayOfYear",4),b("DDD",Ue),b("DDDD",Le),C(["DDD","DDDD"],function(e,t,n){n._dayOfYear=y(e)}),r("m",["mm",2],0,"minute"),t("minute","m"),n("minute",14),b("m",v),b("mm",v,i),C(["m","mm"],A);var ro=xe("Minutes",false),io=(r("s",["ss",2],0,"second"),t("second","s"),n("second",15),b("s",v),b("ss",v,i),C(["s","ss"],_),xe("Seconds",false)),oo,so;for(r("S",0,0,function(){return~~(this.millisecond()/100)}),r(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),r(0,["SSS",3],0,"millisecond"),r(0,["SSSS",4],0,function(){return this.millisecond()*10}),r(0,["SSSSS",5],0,function(){return this.millisecond()*100}),r(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),r(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),r(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),r(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),t("millisecond","ms"),n("millisecond",16),b("S",Ue,De),b("SS",Ue,i),b("SSS",Ue,Le),oo="SSSS";oo.length<=9;oo+="S")b(oo,$e);function ao(e,t){t[tt]=y(("0."+e)*1e3)}for(oo="S";oo.length<=9;oo+="S")C(oo,ao);function lo(){return this._isUTC?"UTC":""}function uo(){return this._isUTC?"Coordinated Universal Time":""}so=xe("Milliseconds",false),r("z",0,0,"zoneAbbr"),r("zz",0,0,"zoneName");var k=q.prototype;if(k.add=Pr,k.calendar=jr,k.clone=zr,k.diff=Qr,k.endOf=bi,k.format=ri,k.from=ii,k.fromNow=oi,k.to=si,k.toNow=ai,k.get=Me,k.invalidAt=Ni,k.isAfter=Gr,k.isBefore=Yr,k.isBetween=Xr,k.isSame=Kr,k.isSameOrAfter=qr,k.isSameOrBefore=Zr,k.isValid=Ai,k.lang=ui,k.locale=li,k.localeData=ci,k.max=er,k.min=Jn,k.parsingFlags=_i,k.set=ke,k.startOf=vi,k.subtract=Fr,k.toArray=Si,k.toObject=Ti,k.toDate=wi,k.toISOString=ti,k.inspect=ni,typeof Symbol!=="undefined"&&Symbol.for!=null)k[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"};function co(e){return I(e*1e3)}function ho(){return I.apply(null,arguments).parseZone()}function fo(e){return e}k.toJSON=Ri,k.toString=ei,k.unix=Ci,k.valueOf=Ei,k.creationData=xi,k.eraName=ki,k.eraNarrow=Di,k.eraAbbr=Li,k.eraYear=Pi,k.year=wt,k.isLeapYear=St,k.weekYear=Gi,k.isoWeekYear=Yi,k.quarter=k.quarters=eo,k.month=mt,k.daysInMonth=yt,k.week=k.weeks=kt,k.isoWeek=k.isoWeeks=Dt,k.weeksInYear=qi,k.weeksInWeekYear=Zi,k.isoWeeksInYear=Xi,k.isoWeeksInISOWeekYear=Ki,k.date=to,k.day=k.days=Kt,k.weekday=qt,k.isoWeekday=Zt,k.dayOfYear=no,k.hour=k.hours=un,k.minute=k.minutes=ro,k.second=k.seconds=io,k.millisecond=k.milliseconds=so,k.utcOffset=vr,k.utc=Er,k.local=Cr,k.parseZone=wr,k.hasAlignedHourOffset=Sr,k.isDST=Tr,k.isLocal=Ar,k.isUtcOffset=_r,k.isUtc=Nr,k.isUTC=Nr,k.zoneAbbr=lo,k.zoneName=uo,k.dates=e("dates accessor is deprecated. Use date instead.",to),k.months=e("months accessor is deprecated. Use month instead",mt),k.years=e("years accessor is deprecated. Use year instead",wt),k.zone=e("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",br),k.isDSTShifted=e("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Rr);var D=re.prototype;function po(e,t,n,r){var i=wn(),o=c().set(r,t);return i[n](o,e)}function go(e,t,n){if(u(e)){t=e;e=undefined}e=e||"";if(t!=null)return po(e,t,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=po(e,r,n,"month");return i}function mo(e,t,n,r){if(typeof e==="boolean"){if(u(t)){n=t;t=undefined}t=t||""}else{t=e;n=t;e=false;if(u(t)){n=t;t=undefined}t=t||""}var i=wn(),o=e?i._week.dow:0,s,a=[];if(n!=null)return po(t,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=po(t,(s+o)%7,r,"day");return a}function yo(e,t){return go(e,t,"months")}function vo(e,t){return go(e,t,"monthsShort")}function bo(e,t,n){return mo(e,t,n,"weekdays")}function Eo(e,t,n){return mo(e,t,n,"weekdaysShort")}function Co(e,t,n){return mo(e,t,n,"weekdaysMin")}D.calendar=oe,D.longDateFormat=ge,D.invalidDate=ye,D.ordinal=Ee,D.preparse=fo,D.postformat=fo,D.relativeTime=we,D.pastFuture=Se,D.set=te,D.eras=Oi,D.erasParse=Ii,D.erasConvertYear=Mi,D.erasAbbrRegex=Bi,D.erasNameRegex=Fi,D.erasNarrowRegex=Hi,D.months=dt,D.monthsShort=ht,D.monthsParse=pt,D.monthsRegex=bt,D.monthsShortRegex=vt,D.week=xt,D.firstDayOfYear=Mt,D.firstDayOfWeek=It,D.weekdays=jt,D.weekdaysMin=Gt,D.weekdaysShort=zt,D.weekdaysParse=Xt,D.weekdaysRegex=Qt,D.weekdaysShortRegex=Jt,D.weekdaysMinRegex=en,D.isPM=an,D.meridiem=cn,bn("en",{eras:[{since:"0001-01-01",until:+Infinity,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-Infinity,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,n=y(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+n}}),d.lang=e("moment.lang is deprecated. Use moment.locale instead.",bn),d.langData=e("moment.langData is deprecated. Use moment.localeData instead.",wn);var wo=Math.abs;function So(){var e=this._data;this._milliseconds=wo(this._milliseconds);this._days=wo(this._days);this._months=wo(this._months);e.milliseconds=wo(e.milliseconds);e.seconds=wo(e.seconds);e.minutes=wo(e.minutes);e.hours=wo(e.hours);e.months=wo(e.months);e.years=wo(e.years);return this}function To(e,t,n,r){var i=M(t,n);e._milliseconds+=r*i._milliseconds;e._days+=r*i._days;e._months+=r*i._months;return e._bubble()}function Ro(e,t){return To(this,e,t,1)}function Ao(e,t){return To(this,e,t,-1)}function _o(e){if(e<0)return Math.floor(e);else return Math.ceil(e)}function No(){var e=this._milliseconds,t=this._days,n=this._months,r=this._data,i,o,s,a,l;if(!(e>=0&&t>=0&&n>=0||e<=0&&t<=0&&n<=0)){e+=_o(Oo(n)+t)*864e5;t=0;n=0}r.milliseconds=e%1e3;i=m(e/1e3);r.seconds=i%60;o=m(i/60);r.minutes=o%60;s=m(o/60);r.hours=s%24;t+=m(s/24);l=m(xo(t));n+=l;t-=_o(Oo(l));a=m(n/12);n%=12;r.days=t;r.months=n;r.years=a;return this}function xo(e){return e*4800/146097}function Oo(e){return e*146097/4800}function Io(e){if(!this.isValid())return NaN;var t,n,r=this._milliseconds;e=g(e);if(e==="month"||e==="quarter"||e==="year"){t=this._days+r/864e5;n=this._months+xo(t);switch(e){case"month":return n;case"quarter":return n/3;case"year":return n/12}}else{t=this._days+Math.round(Oo(this._months));switch(e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return t*24+r/36e5;case"minute":return t*1440+r/6e4;case"second":return t*86400+r/1e3;case"millisecond":return Math.floor(t*864e5)+r;default:throw new Error("Unknown unit "+e)}}}function Mo(){if(!this.isValid())return NaN;return this._milliseconds+this._days*864e5+this._months%12*2592e6+y(this._months/12)*31536e6}function ko(e){return function(){return this.as(e)}}var Do=ko("ms"),Lo=ko("s"),Po=ko("m"),Fo=ko("h"),Bo=ko("d"),Ho=ko("w"),Uo=ko("M"),Vo=ko("Q"),Wo=ko("y");function $o(){return M(this)}function jo(e){e=g(e);return this.isValid()?this[e+"s"]():NaN}function zo(e){return function(){return this.isValid()?this._data[e]:NaN}}var Go=zo("milliseconds"),Yo=zo("seconds"),Xo=zo("minutes"),Ko=zo("hours"),qo=zo("days"),Zo=zo("months"),Qo=zo("years");function Jo(){return m(this.days()/7)}var es=Math.round,ts={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function ns(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function rs(e,t,n,r){var i=M(e).abs(),o=es(i.as("s")),s=es(i.as("m")),a=es(i.as("h")),l=es(i.as("d")),u=es(i.as("M")),c=es(i.as("w")),d=es(i.as("y")),h=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];if(n.w!=null)h=h||c<=1&&["w"]||c<n.w&&["ww",c];h=h||u<=1&&["M"]||u<n.M&&["MM",u]||d<=1&&["y"]||["yy",d];h[2]=t;h[3]=+e>0;h[4]=r;return ns.apply(null,h)}function is(e){if(e===undefined)return es;if(typeof e==="function"){es=e;return true}return false}function os(e,t){if(ts[e]===undefined)return false;if(t===undefined)return ts[e];ts[e]=t;if(e==="s")ts.ss=t-1;return true}function ss(e,t){if(!this.isValid())return this.localeData().invalidDate();var n=false,r=ts,i,o;if(typeof e==="object"){t=e;e=false}if(typeof e==="boolean")n=e;if(typeof t==="object"){r=Object.assign({},ts,t);if(t.s!=null&&t.ss==null)r.ss=t.s-1}i=this.localeData();o=rs(this,!n,r,i);if(n)o=i.pastFuture(+this,o);return i.postformat(o)}var as=Math.abs;function ls(e){return(e>0)-(e<0)||+e}function us(){if(!this.isValid())return this.localeData().invalidDate();var e=as(this._milliseconds)/1e3,t=as(this._days),n=as(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,d;if(!a)return"P0D";r=m(e/60);i=m(r/60);e%=60;r%=60;o=m(n/12);n%=12;s=e?e.toFixed(3).replace(/\.?0+$/,""):"";l=a<0?"-":"";u=ls(this._months)!==ls(a)?"-":"";c=ls(this._days)!==ls(a)?"-":"";d=ls(this._milliseconds)!==ls(a)?"-":"";return l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(t?c+t+"D":"")+(i||r||e?"T":"")+(i?d+i+"H":"")+(r?d+r+"M":"")+(e?d+s+"S":"")}var L=ur.prototype;return L.isValid=ar,L.abs=So,L.add=Ro,L.subtract=Ao,L.as=Io,L.asMilliseconds=Do,L.asSeconds=Lo,L.asMinutes=Po,L.asHours=Fo,L.asDays=Bo,L.asWeeks=Ho,L.asMonths=Uo,L.asQuarters=Vo,L.asYears=Wo,L.valueOf=Mo,L._bubble=No,L.clone=$o,L.get=jo,L.milliseconds=Go,L.seconds=Yo,L.minutes=Xo,L.hours=Ko,L.days=qo,L.weeks=Jo,L.months=Zo,L.years=Qo,L.humanize=ss,L.toISOString=us,L.toString=us,L.toJSON=us,L.locale=li,L.localeData=ci,L.toIsoString=e("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",us),L.lang=ui,r("X",0,0,"unix"),r("x",0,0,"valueOf"),b("x",je),b("X",Ye),C("X",function(e,t,n){n._d=new Date(parseFloat(e)*1e3)}),C("x",function(e,t,n){n._d=new Date(y(e))}),d.version="2.29.4",B(I),d.fn=k,d.min=nr,d.max=rr,d.now=ir,d.utc=c,d.unix=co,d.months=yo,d.isDate=V,d.locale=bn,d.invalid=G,d.duration=M,d.isMoment=f,d.weekdays=bo,d.parseZone=ho,d.localeData=wn,d.isDuration=cr,d.monthsShort=vo,d.weekdaysMin=Co,d.defineLocale=En,d.updateLocale=Cn,d.locales=Sn,d.weekdaysShort=Eo,d.normalizeUnits=g,d.relativeTimeRounding=is,d.relativeTimeThreshold=os,d.calendarFormat=$r,d.prototype=k,d.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},d}(),window.moment=ds(306)},(e,t,n)=>{var r={"./af":308,"./af.js":308,"./ar":309,"./ar-dz":310,"./ar-dz.js":310,"./ar-kw":311,"./ar-kw.js":311,"./ar-ly":312,"./ar-ly.js":312,"./ar-ma":313,"./ar-ma.js":313,"./ar-sa":314,"./ar-sa.js":314,"./ar-tn":315,"./ar-tn.js":315,"./ar.js":309,"./az":316,"./az.js":316,"./be":317,"./be.js":317,"./bg":318,"./bg.js":318,"./bm":319,"./bm.js":319,"./bn":320,"./bn-bd":321,"./bn-bd.js":321,"./bn.js":320,"./bo":322,"./bo.js":322,"./br":323,"./br.js":323,"./bs":324,"./bs.js":324,"./ca":325,"./ca.js":325,"./cs":326,"./cs.js":326,"./cv":327,"./cv.js":327,"./cy":328,"./cy.js":328,"./da":329,"./da.js":329,"./de":330,"./de-at":331,"./de-at.js":331,"./de-ch":332,"./de-ch.js":332,"./de.js":330,"./dv":333,"./dv.js":333,"./el":334,"./el.js":334,"./en-au":335,"./en-au.js":335,"./en-ca":336,"./en-ca.js":336,"./en-gb":337,"./en-gb.js":337,"./en-ie":338,"./en-ie.js":338,"./en-il":339,"./en-il.js":339,"./en-in":340,"./en-in.js":340,"./en-nz":341,"./en-nz.js":341,"./en-sg":342,"./en-sg.js":342,"./eo":343,"./eo.js":343,"./es":344,"./es-do":345,"./es-do.js":345,"./es-mx":346,"./es-mx.js":346,"./es-us":347,"./es-us.js":347,"./es.js":344,"./et":348,"./et.js":348,"./eu":349,"./eu.js":349,"./fa":350,"./fa.js":350,"./fi":351,"./fi.js":351,"./fil":352,"./fil.js":352,"./fo":353,"./fo.js":353,"./fr":354,"./fr-ca":355,"./fr-ca.js":355,"./fr-ch":356,"./fr-ch.js":356,"./fr.js":354,"./fy":357,"./fy.js":357,"./ga":358,"./ga.js":358,"./gd":359,"./gd.js":359,"./gl":360,"./gl.js":360,"./gom-deva":361,"./gom-deva.js":361,"./gom-latn":362,"./gom-latn.js":362,"./gu":363,"./gu.js":363,"./he":364,"./he.js":364,"./hi":365,"./hi.js":365,"./hr":366,"./hr.js":366,"./hu":367,"./hu.js":367,"./hy-am":368,"./hy-am.js":368,"./id":369,"./id.js":369,"./is":370,"./is.js":370,"./it":371,"./it-ch":372,"./it-ch.js":372,"./it.js":371,"./ja":373,"./ja.js":373,"./jv":374,"./jv.js":374,"./ka":375,"./ka.js":375,"./kk":376,"./kk.js":376,"./km":377,"./km.js":377,"./kn":378,"./kn.js":378,"./ko":379,"./ko.js":379,"./ku":380,"./ku.js":380,"./ky":381,"./ky.js":381,"./lb":382,"./lb.js":382,"./lo":383,"./lo.js":383,"./lt":384,"./lt.js":384,"./lv":385,"./lv.js":385,"./me":386,"./me.js":386,"./mi":387,"./mi.js":387,"./mk":388,"./mk.js":388,"./ml":389,"./ml.js":389,"./mn":390,"./mn.js":390,"./mr":391,"./mr.js":391,"./ms":392,"./ms-my":393,"./ms-my.js":393,"./ms.js":392,"./mt":394,"./mt.js":394,"./my":395,"./my.js":395,"./nb":396,"./nb.js":396,"./ne":397,"./ne.js":397,"./nl":398,"./nl-be":399,"./nl-be.js":399,"./nl.js":398,"./nn":400,"./nn.js":400,"./oc-lnc":401,"./oc-lnc.js":401,"./pa-in":402,"./pa-in.js":402,"./pl":403,"./pl.js":403,"./pt":404,"./pt-br":405,"./pt-br.js":405,"./pt.js":404,"./ro":406,"./ro.js":406,"./ru":407,"./ru.js":407,"./sd":408,"./sd.js":408,"./se":409,"./se.js":409,"./si":410,"./si.js":410,"./sk":411,"./sk.js":411,"./sl":412,"./sl.js":412,"./sq":413,"./sq.js":413,"./sr":414,"./sr-cyrl":415,"./sr-cyrl.js":415,"./sr.js":414,"./ss":416,"./ss.js":416,"./sv":417,"./sv.js":417,"./sw":418,"./sw.js":418,"./ta":419,"./ta.js":419,"./te":420,"./te.js":420,"./tet":421,"./tet.js":421,"./tg":422,"./tg.js":422,"./th":423,"./th.js":423,"./tk":424,"./tk.js":424,"./tl-ph":425,"./tl-ph.js":425,"./tlh":426,"./tlh.js":426,"./tr":427,"./tr.js":427,"./tzl":428,"./tzl.js":428,"./tzm":429,"./tzm-latn":430,"./tzm-latn.js":430,"./tzm.js":429,"./ug-cn":431,"./ug-cn.js":431,"./uk":432,"./uk.js":432,"./ur":433,"./ur.js":433,"./uz":434,"./uz-latn":435,"./uz-latn.js":435,"./uz.js":434,"./vi":436,"./vi.js":436,"./x-pseudo":437,"./x-pseudo.js":437,"./yo":438,"./yo.js":438,"./zh-cn":439,"./zh-cn.js":439,"./zh-hk":440,"./zh-hk.js":440,"./zh-mo":441,"./zh-mo.js":441,"./zh-tw":442,"./zh-tw.js":442};function i(e){e=o(e);return n(e)}function o(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}i.keys=function(){return Object.keys(r)},i.resolve=o,(e.exports=i).id=307},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},()=>{},(e,t,n)=>{"use strict";t.__esModule=!0,t.toSingleLine=function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e=(0,i.arrayReduce)(e,(e,t,n)=>{return e+t.replace(/\r?\n\s*/g,"")+(r[n]||"")},"");return e.trim()};var i=n(444)},(e,t,n)=>{"use strict";function r(e,t,n,r){let i=-1,o=e,s=n;var a=(o=Array.isArray(e)?o:Array.from(e)).length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=t(s,o[i],i,o),i+=1;return s}function s(e,t){let n=0,r=e;for(var i=(r=Array.isArray(e)?r:Array.from(e)).length;n<i&&!1!==t(r[n],n,r);)n+=1;return e}function i(e){return r(e,(e,t)=>e+t,0)}t.__esModule=!0,t.arrayAvg=function(e){return e.length?i(e)/e.length:0},t.arrayEach=s,t.arrayFilter=function(e,t){let n=0,r=e;Array.isArray(e)||(r=Array.from(e));var i=r.length,o=[];let s=-1;for(;n<i;){var a=r[n];t(a,n,r)&&(s+=1,o[s]=a),n+=1}return o},t.arrayFlatten=function n(e){return r(e,(e,t)=>e.concat(Array.isArray(t)?n(t):t),[])},t.arrayMap=function(e,t){let n=0,r=e;Array.isArray(e)||(r=Array.from(e));var i=r.length,o=[];let s=-1;for(;n<i;){var a=r[n];s+=1,o[s]=t(a,n,r),n+=1}return o},t.arrayMax=function(e){return r(e,(e,t)=>t<e?e:t,Array.isArray(e)?e[0]:void 0)},t.arrayMin=function(e){return r(e,(e,t)=>e<t?e:t,Array.isArray(e)?e[0]:void 0)},t.arrayReduce=r,t.arraySum=i,t.arrayUnique=function(e){const t=[];return s(e,e=>{-1===t.indexOf(e)&&t.push(e)}),t},t.extendArray=function(e,t){var n=t.length;let r=0;for(;r<n;)e.push(t[r]),r+=1},t.getDifferenceOfArrays=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var[r,...i]=[...t];let o=r;return s(i,t=>{o=o.filter(e=>!t.includes(e))}),o},t.getIntersectionOfArrays=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var[r,...i]=[...t];let o=r;return s(i,t=>{o=o.filter(e=>t.includes(e))}),o},t.getUnionOfArrays=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,...i]=[...t],o=new Set(r);return s(i,e=>{s(e,e=>{o.has(e)||o.add(e)})}),Array.from(o)},t.pivot=function(n){var r=[];if(n&&0!==n.length&&n[0]&&0!==n[0].length){var e=n.length,i=n[0].length;for(let t=0;t<e;t++)for(let e=0;e<i;e++)r[e]||(r[e]=[]),r[e][t]=n[t][e]}return r},t.stringToArray=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:" ";return e.split(t)},t.to2dArray=function(e){var t=e.length;let n=0;for(;n<t;)e[n]=[e[n]],n+=1},n(203)},(e,t,n)=>{"use strict";t.__esModule=!0,t.curry=function(a){const l=a.length;return function o(s){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=s.concat(t);let i;return i=r.length>=l?a.apply(this,r):o(r)}}([])},t.curryRight=function(a){const l=a.length;return function o(s){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=s.concat(t.reverse());let i;return i=r.length>=l?a.apply(this,r):o(r)}}([])},t.debounce=function(r){let i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:200,o=null,s;return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o&&clearTimeout(o),o=setTimeout(()=>{s=r.apply(this,t)},i),s}},t.fastCall=function(e,t,n,r,i,o,s,a){{if((0,l.isDefined)(a))return e.call(t,n,r,i,o,s,a);if((0,l.isDefined)(s))return e.call(t,n,r,i,o,s);if((0,l.isDefined)(o))return e.call(t,n,r,i,o);if((0,l.isDefined)(i))return e.call(t,n,r,i);if((0,l.isDefined)(r))return e.call(t,n,r);if((0,l.isDefined)(n))return e.call(t,n)}return e.call(t)},t.isFunction=function(e){return"function"==typeof e},t.partial=function(r){for(var e=arguments.length,i=new Array(1<e?e-1:0),t=1;t<e;t++)i[t-1]=arguments[t];return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.apply(this,i.concat(t))}},t.pipe=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,...i]=t;return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,o.arrayReduce)(i,(e,t)=>t(e),r.apply(this,t))}},t.throttle=s,t.throttleAfterHits=function(r){let e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:200,t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:10;const i=s(r,e);let o=t;function n(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(o?(--o,r):i).apply(this,t)}return n.clearHits=function(){o=t},n};var o=n(444),l=n(305);function s(o){let s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:200,a=0;const l={lastCallThrottled:!0};let u=null;return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Date.now();let i=!1;return l.lastCallThrottled=!0,a||(a=r,i=!0),r=s-(r-a),i?(l.lastCallThrottled=!1,o.apply(this,t)):(u&&clearTimeout(u),u=setTimeout(()=>{l.lastCallThrottled=!1,o.apply(this,t),a=0,u=void 0},r)),l}}},(e,t,n)=>{"use strict";t.__esModule=!0,t.isChrome=function(){return i.chrome.value},t.isChromeWebKit=function(){return i.chromeWebKit.value},t.isEdge=function(){return i.edge.value},t.isEdgeWebKit=function(){return i.edgeWebKit.value},t.isFirefox=function(){return i.firefox.value},t.isFirefoxWebKit=function(){return i.firefoxWebKit.value},t.isIOS=function(){return o.ios.value},t.isIpadOS=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:navigator)["maxTouchPoints"];return 2<e&&o.mac.value},t.isLinuxOS=function(){return o.linux.value},t.isMacOS=function(){return o.mac.value},t.isMobileBrowser=function(){return i.mobile.value},t.isSafari=function(){return i.safari.value},t.isWindowsOS=function(){return o.win.value},t.setBrowserMeta=s,t.setPlatformMeta=a;var r=n(447),t=n=>{const r={value:!1,test:(e,t)=>{r.value=n(e,t)}};return r};const i={chrome:t((e,t)=>/Chrome/.test(e)&&/Google/.test(t)),chromeWebKit:t(e=>/CriOS/.test(e)),edge:t(e=>/Edge/.test(e)),edgeWebKit:t(e=>/EdgiOS/.test(e)),firefox:t(e=>/Firefox/.test(e)),firefoxWebKit:t(e=>/FxiOS/.test(e)),mobile:t(e=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)),safari:t((e,t)=>/Safari/.test(e)&&/Apple Computer/.test(t))},o={mac:t(e=>/^Mac/.test(e)),win:t(e=>/^Win/.test(e)),linux:t(e=>/^Linux/.test(e)),ios:t(e=>/iPhone|iPad|iPod/i.test(e))};function s(){let{userAgent:t=navigator.userAgent,vendor:n=navigator.vendor}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};(0,r.objectEach)(i,e=>{e=e.test;e(t,n)})}function a(){let{platform:t=navigator.platform}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};(0,r.objectEach)(o,e=>{e=e.test;e(t)})}s(),a()},(e,t,n)=>{"use strict";t.__esModule=!0,t.clone=function(e){const n={};return a(e,(e,t)=>{n[t]=e}),n},t.createObjectPropListener=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"value";const n="_"+t,r={_touched:!1,[n]:e,isTouched(){return this._touched}};return Object.defineProperty(r,t,{get(){return this[n]},set(e){this._touched=!0,this[n]=e},enumerable:!0,configurable:!0}),r},t.deepClone=o,t.deepExtend=function n(r,i){a(i,(e,t)=>{i[t]&&"object"==typeof i[t]?(r[t]||(Array.isArray(i[t])?r[t]=[]:"[object Date]"===Object.prototype.toString.call(i[t])?r[t]=i[t]:r[t]={}),n(r[t],i[t])):r[t]=i[t]})},t.deepObjectSize=function(e){if(!s(e))return 0;function r(e){let n=0;return s(e)?a(e,(e,t)=>{"__children"!==t&&(n+=r(e))}):n+=1,n}return r(e)},t.defineGetter=function(e,t,n,r){r.value=n,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(e,t,r)},t.duckSchema=function n(e){let r;Array.isArray(e)?r=e.length?new Array(e.length).fill(null):[]:(r={},a(e,(e,t)=>{"__children"!==t&&(e&&"object"==typeof e&&!Array.isArray(e)?r[t]=n(e):Array.isArray(e)?e.length&&"object"==typeof e[0]&&!Array.isArray(e[0])?r[t]=[n(e[0])]:r[t]=[]:r[t]=null)}));return r},t.extend=function(n,e,r){const i=Array.isArray(r);return a(e,(e,t)=>{!1!==i&&!r.includes(t)||(n[t]=e)}),n},t.getProperty=function(e,t){t=t.split(".");let n=e;return a(t,e=>{if(void 0===(n=n[e]))return n=void 0,!1}),n},t.hasOwnProperty=l,t.inherit=function(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e},t.isObject=s,t.isObjectEqual=function(e,t){return JSON.stringify(e)===JSON.stringify(t)},t.mixin=function(n){n.MIXINS||(n.MIXINS=[]);for(var e=arguments.length,t=new Array(1<e?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return(0,i.arrayEach)(t,e=>{n.MIXINS.push(e.MIXIN_NAME),a(e,(e,t)=>{if(void 0!==n.prototype[t])throw new Error(`Mixin conflict. Property '${t}' already exist and cannot be overwritten.`);"function"==typeof e?n.prototype[t]=e:Object.defineProperty(n.prototype,t,{get:function(e,t){const n="_"+e;return function(){return void 0===this[n]&&(this[n]=(e=>{let t=e;return t=Array.isArray(t)||s(t)?o(t):t})(t)),this[n]}}(t,e),set:function(e){const t="_"+e;return function(e){this[t]=e}}(t),configurable:!0})})}),n},t.objectEach=a,t.setProperty=function(e,t,n){const r=t.split(".");let i=e;r.forEach((e,t)=>{t!==r.length-1?(l(i,e)||(i[e]={}),i=i[e]):i[e]=n})},n(448),n(203),n(273);var i=n(444);function o(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e}function s(e){return"[object Object]"===Object.prototype.toString.call(e)}function a(e,t){for(const n in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,n))&&!1===t(e[n],n,e))break;return e}function l(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},(e,t,n)=>{"use strict";function i(e,t){var n=f(arguments),r=p(t);if(d(r)||void 0!==e&&!h(e))return n[1]=function(e,t){if(d(r)&&(t=l(r,this,g(e),t)),!h(t))return t},a(m,null,n)}function o(e,t,n){var r=v(n,t-1),n=v(n,t+1);return y(S,e)&&!y(T,n)||y(T,e)&&!y(S,r)?"\\u"+C(b(e,0),16):e}var r=n(204),s=n(225),a=n(274),l=n(209),u=n(215),c=n(208),d=n(222),h=n(224),f=n(295),p=n(449),n=n(228),g=String,m=s("JSON","stringify"),y=u(/./.exec),v=u("".charAt),b=u("".charCodeAt),E=u("".replace),C=u(1..toString),w=/[\uD800-\uDFFF]/g,S=/^[\uD800-\uDBFF]$/,T=/^[\uDC00-\uDFFF]$/,R=!n||c(function(){var e=s("Symbol")("stringify detection");return"[null]"!==m([e])||"{}"!==m({a:e})||"{}"!==m(Object(e))}),A=c(function(){return'"\\udf06\\ud834"'!==m("\udf06\ud834")||'"\\udead"'!==m("\udead")});m&&r({target:"JSON",stat:!0,arity:3,forced:R||A},{stringify:function(e,t,n){var r=f(arguments),r=a(R?i:m,null,r);return A&&"string"==typeof r?E(r,w,o):r}})},(e,t,n)=>{"use strict";var r=n(215),a=n(271),l=n(222),u=n(216),c=n(282),d=r([].push);e.exports=function(e){if(l(e))return e;if(a(e)){for(var t=e.length,r=[],n=0;n<t;n++){var i=e[n];"string"==typeof i?d(r,i):"number"!=typeof i&&"Number"!==u(i)&&"String"!==u(i)||d(r,c(i))}var o=r.length,s=!0;return function(e,t){if(s)return s=!1,t;if(a(this))return t;for(var n=0;n<o;n++)if(r[n]===e)return t}}}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(451)),o=n(452),l=n(302),u=n(453),s=r(n(457)),a=n(305);const c="editorManager.navigation",d=(t.SHORTCUTS_GROUP_NAVIGATION=c,"editorManager.handlingEditor");t.SHORTCUTS_GROUP_EDITOR=d;class h{constructor(e,t,n){this.instance=e,this.tableMeta=t,this.selection=n,this.eventManager=new s.default(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.instance.getShortcutManager().addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",e=>this.onAfterDocumentKeyDown(e)),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",e=>{!this.destroyed&&this.instance.isListening()&&this.openEditor("",e)}),this.instance.view._wt.update("onCellDblClick",(e,t,n)=>this.onCellDblClick(e,t,n))}registerShortcuts(){const n=this.instance.getShortcutManager();var e=n.getContext("grid"),t=n.getContext("editor"),r={group:d};t.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:(e,t)=>{this.closeEditorAndSaveChanges(n.isCtrlPressed()),this.moveSelectionAfterEnter(t.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>{this.closeEditorAndRestoreOriginalValue(n.isCtrlPressed()),this.activeEditor.focus()}}],r),e.addShortcuts([{keys:[["F2"]],callback:e=>{this.openEditor(null,e,!0)}},{keys:[["Backspace"],["Delete"]],callback:()=>{this.instance.emptySelectedCells(),this.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:(e,t)=>{this.instance.getSettings().enterBeginsEditing?this.cellProperties.readOnly?this.moveSelectionAfterEnter():this.openEditor(null,e,!0):this.moveSelectionAfterEnter(t.includes("shift")),(0,o.stopImmediatePropagation)(e)}}],{...r,runOnlyIf:()=>(0,a.isDefined)(this.instance.getSelected())})}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(!this.lock)if(this.activeEditor&&this.activeEditor.isWaiting())this.closeEditor(!1,!1,e=>{e&&this.prepareEditor()});else{var{row:n,col:r}=this.instance.getSelectedRangeLast().highlight,i=this.instance.runHooks("modifyGetCellCoords",n,r);let e=n,t=r;Array.isArray(i)&&([e,t]=i),this.cellProperties=this.instance.getCellMeta(e,t);var o,s,a,i=this.instance.rootDocument["activeElement"];i&&(0,l.isOutsideInput)(i)&&i.blur(),this.isCellEditable()?(i=this.instance.getCell(n,r,!0))&&(o=this.instance.getCellEditor(this.cellProperties),s=this.instance.colToProp(t),a=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(e),t),this.activeEditor=(0,u.getEditorInstance)(o,this.instance),this.activeEditor.prepare(n,r,s,i,a,this.cellProperties)):this.clearActiveEditor()}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){var n,r,i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];this.isCellEditable()?(this.activeEditor||({row:n,col:r}=this.instance.getSelectedRangeLast().highlight,n=this.instance.rowIndexMapper.getRenderableFromVisualIndex(n),r=this.instance.columnIndexMapper.getRenderableFromVisualIndex(r),this.instance.view.scrollViewport(this.instance._createCellCoords(n,r)),this.instance.view.render(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))):this.clearActiveEditor()}closeEditor(e,t,n){this.activeEditor?this.activeEditor.finishEditing(e,t,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){var e=this.instance.getCellEditor(this.cellProperties),{row:t,col:n}=this.instance.getSelectedRangeLast().highlight,{rowIndexMapper:r,columnIndexMapper:i}=this.instance,r=r.isHidden(this.instance.toPhysicalRow(t))||i.isHidden(this.instance.toPhysicalColumn(n));return!(this.cellProperties.readOnly||!e||r)}moveSelectionAfterEnter(e){var t="function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-t.row,-t.col):this.selection.transformStart(t.row,t.col,!0)}onAfterDocumentKeyDown(e){var t,n;this.instance.isListening()&&(t=e["keyCode"],this.selection.isSelected())&&(n=(e.ctrlKey||e.metaKey)&&!e.altKey,this.activeEditor&&(!this.activeEditor||this.activeEditor.isWaiting())||(0,i.isFunctionKey)(t)||(0,i.isCtrlMetaKey)(t)||n||this.isEditorOpened()||(t=this.instance.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>(0,a.isDefined)(this.instance.getSelected()),group:c},t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.instance.selection.transformStart(0,-1*this.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.instance.selection.transformStart(0,this.instance.getDirectionFactor())}}],n),this.openEditor("",e)))}onCellDblClick(e,t,n){"TD"===n.nodeName&&this.openEditor(null,e,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}const f=new WeakMap;h.getInstance=function(e,t,n){let r=f.get(e);return r||(r=new h(e,t,n),f.set(e,r)),r};r=h;t.default=r},(e,t,n)=>{"use strict";t.__esModule=!0,t.isCtrlKey=function(e){var t=[];(0,i.isMacOS)()?t.push(o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX):t.push(o.CONTROL);return t.includes(e)},t.isCtrlMetaKey=function(e){return[o.CONTROL,o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX].includes(e)},t.isFunctionKey=function(e){return s.includes(e)},t.isKey=function(t,e){e=e.split("|");let n=!1;return(0,r.arrayEach)(e,e=>{if(t===o[e])return!(n=!0)}),n},t.isPrintableChar=function(e){return 32===e||48<=e&&e<=57||96<=e&&e<=111||186<=e&&e<=192||219<=e&&e<=222||226<=e||65<=e&&e<=90},n(203);var r=n(444),i=n(446);const o={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:(0,i.isFirefox)()?182:174,AUDIO_MUTE:(0,i.isFirefox)()?181:173,AUDIO_UP:(0,i.isFirefox)()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},s=[(t.KEY_CODES=o).ALT,o.ARROW_DOWN,o.ARROW_LEFT,o.ARROW_RIGHT,o.ARROW_UP,o.AUDIO_DOWN,o.AUDIO_MUTE,o.AUDIO_UP,o.BACKSPACE,o.CAPS_LOCK,o.DELETE,o.END,o.ENTER,o.ESCAPE,o.F1,o.F2,o.F3,o.F4,o.F5,o.F6,o.F7,o.F8,o.F9,o.F10,o.F11,o.F12,o.F13,o.F14,o.F15,o.F16,o.F17,o.F18,o.F19,o.HOME,o.INSERT,o.MEDIA_NEXT,o.MEDIA_PLAY_PAUSE,o.MEDIA_PREV,o.MEDIA_STOP,o.NULL,o.NUM_LOCK,o.PAGE_DOWN,o.PAGE_UP,o.PAUSE,o.SCROLL_LOCK,o.SHIFT,o.TAB]},(e,t)=>{"use strict";t.__esModule=!0,t.isImmediatePropagationStopped=function(e){return!1===e.isImmediatePropagationEnabled},t.isLeftClick=function(e){return 0===e.button},t.isRightClick=function(e){return 2===e.button},t.stopImmediatePropagation=function(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,t.RegisteredEditor=d,t.getEditorInstance=t._getEditorInstance=function(e,t){let n;if("function"==typeof e)o.get(e)||h(null,e),n=o.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');n=a(e)}if(n)return n.getInstance(t);throw Error(`No editor registered under name "${e}"`)},t.getEditor=function(e){if("function"==typeof e)return e;if(l(e))return a(e).getConstructor();throw Error(`No registered editor found under "${e}" name`)},t.registerEditor=h,n(273),r(n(454))),r=r(n(456));const o=new WeakMap,{register:s,getItem:a,hasItem:l,getNames:u,getValues:c}=(0,r.default)("editors");function d(e){const t={},n=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new n(e)),t[e.guid]},i.default.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function h(e,t){e&&"string"!=typeof e&&(e=(t=e).EDITOR_TYPE);var n=new d(t);"string"==typeof e&&s(e,n),o.set(t,n)}t.getRegisteredEditors=c,t.getRegisteredEditorNames=u,t.hasEditor=l},(e,t,n)=>{"use strict";t.__esModule=!0,n(203);var s=n(444),r=n(447),a=n(303),l=n(455),i=n(443),g=n(445);const o=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],u=(0,i.toSingleLine)`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,c=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),d=new Map([]);class h{static getSingleton(){return f}constructor(){this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const t=Object.create(null);return(0,s.arrayEach)(o,e=>t[e]=[]),t}getBucket(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(r,i){let t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(i))(0,s.arrayEach)(i,e=>this.add(r,e,t));else{c.has(r)&&(0,l.warn)((0,a.substitute)(u,{hookName:r,removedInVersion:c.get(r)})),d.has(r)&&(0,l.warn)(d.get(r));const o=this.getBucket(t);if(void 0===o[r]&&(this.register(r),o[r]=[]),i.skip=!1,-1===o[r].indexOf(i)){let n=!1;i.initialHook&&(0,s.arrayEach)(o[r],(e,t)=>{if(e.initialHook)return o[r][t]=i,!(n=!0)}),n||o[r].push(i)}}return this}once(t,e){let n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)?(0,s.arrayEach)(e,e=>this.once(t,e,n)):(e.runOnce=!0,this.add(t,e,n))}remove(e,t){var n=this.getBucket(2<arguments.length&&void 0!==arguments[2]?arguments[2]:null);return void 0!==n[e]&&0<=n[e].indexOf(t)&&(t.skip=!0)}has(e){var t=this.getBucket(1<arguments.length&&void 0!==arguments[1]?arguments[1]:null);return!(void 0===t[e]||!t[e].length)}run(t,n,r,i,o,s,a,l){{var u,c=this.globalBucket[n],d=c?c.length:0;let e=0;if(d)for(;e<d;)!c[e]||c[e].skip?e+=1:(void 0!==(u=(0,g.fastCall)(c[e],t,r,i,o,s,a,l))&&(r=u),c[e]&&c[e].runOnce&&this.remove(n,c[e]),e+=1)}{var h,f=this.getBucket(t)[n],p=f?f.length:0;let e=0;if(p)for(;e<p;)!f[e]||f[e].skip?e+=1:(void 0!==(h=(0,g.fastCall)(f[e],t,r,i,o,s,a,l))&&(r=h),f[e]&&f[e].runOnce&&this.remove(n,f[e],t),e+=1)}return r}destroy(){(0,r.objectEach)(this.getBucket(0<arguments.length&&void 0!==arguments[0]?arguments[0]:null),(e,t,n)=>n[t].length=0)}register(e){this.isRegistered(e)||o.push(e)}deregister(e){this.isRegistered(e)&&o.splice(o.indexOf(e),1)}isDeprecated(e){return d.has(e)||c.has(e)}isRegistered(e){return 0<=o.indexOf(e)}getRegistered(){return o}}const f=new h;t.default=h},(e,t,n)=>{"use strict";t.__esModule=!0,t.error=function(){(0,r.isDefined)(console)&&console.error(...arguments)},t.info=function(){(0,r.isDefined)(console)&&console.info(...arguments)},t.log=function(){(0,r.isDefined)(console)&&console.log(...arguments)},t.warn=function(){(0,r.isDefined)(console)&&console.warn(...arguments)};var r=n(305)},(e,t)=>{"use strict";t.__esModule=!0,t.default=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"common";r.has(e)||r.set(e,new Map);const n=r.get(e);return{register:function(e,t){n.set(e,t)},getItem:function(e){return n.get(e)},hasItem:function(e){return n.has(e)},getNames:function(){return[...n.keys()]},getValues:function(){return[...n.values()]}}};const r=new Map;t.collection=r},(e,t,n)=>{"use strict";t.__esModule=!0,t.getListenersCounter=function(){return s},n(203);var o=n(452);let s=0;t.default=class{constructor(){this.context=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:null)||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]&&arguments[3];function i(e){n.call(this,function(e){const t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),(0,o.stopImmediatePropagation)(this)},e}(e))}return this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:i,options:r,eventManager:this}),e.addEventListener(t,i,r),s+=1,()=>{this.removeEventListener(e,t,n)}}removeEventListener(e,t,n){var r,i=3<arguments.length&&void 0!==arguments[3]&&arguments[3];let o=this.context.eventListeners.length;for(;o;)--o,(r=this.context.eventListeners[o]).event!==t||r.element!==e||n&&n!==r.callback||i&&r.eventManager!==this||(this.context.eventListeners.splice(o,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),--s)}clearEvents(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this.context){let e=this.context.eventListeners.length;for(;e;){--e;var n=this.context.eventListeners[e];t&&n.eventManager!==this||(this.context.eventListeners.splice(e,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),--s)}}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let n=e.document,r=e;n||(n=e.ownerDocument||e,r=n.defaultView);var i={bubbles:!0,cancelable:"mousemove"!==t,view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let o;n.createEvent?(o=n.createEvent("MouseEvents")).initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||n.body.parentNode):o=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent("on"+t,o)}}},(e,t,n)=>{"use strict";t.__esModule=!0,t._dataToHTML=function(t){var n=t.length,r=["<table>"];for(let e=0;e<n;e+=1){var i=t[e],o=i.length,s=[];0===e&&r.push("<tbody>");for(let e=0;e<o;e+=1){var a=i[e],a=(0,b.isEmpty)(a)?"":a.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,e=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(e.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${a}</td>`)}r.push("<tr>",...s,"</tr>"),e+1===n&&r.push("</tbody>")}return r.push("</table>"),r.join("")},t.htmlToGridSettings=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;var n={},r=t.createDocumentFragment(),t=t.createElement("div");r.appendChild(t);let i=e;"string"==typeof i&&(r=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,e=>{var t=e.match(/<td\b[^>]*?>/g)[0];return""+t+e.substring(t.length,e.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"")+"</td>"}),t.insertAdjacentHTML("afterbegin",""+r),i=t.querySelector("table"));if(i&&function(e){return"TABLE"===(e&&e.nodeName||"")}(i)){var o=t.querySelector('meta[name$="enerator"]');const w=null!==i.querySelector("tbody th");var e=i.querySelector("tr"),s=e?Array.from(e.cells).reduce((e,t)=>e+t.colSpan,0)-(w?1:0):0,r=i.tFoot&&Array.from(i.tFoot.rows)||[];const S=[];i.tHead&&(t=Array.from(i.tHead.rows).filter(e=>{var t=null!==e.querySelector("td");return t&&S.push(e),!t}),e=t.length,a=0<e,1<e?n.nestedHeaders=Array.from(t).reduce((e,t)=>{t=Array.from(t.cells).reduce((e,t,n)=>{return w&&0===n||({colSpan:n,innerHTML:t}=t,e.push(1<n?{label:t,colspan:n}:t)),e},[]);return e.push(t),e},[]):a&&(n.colHeaders=Array.from(t[0].children).reduce((e,t,n)=>(w&&0===n||e.push(t.innerHTML),e),[]))),S.length&&(n.fixedRowsTop=S.length),r.length&&(n.fixedRowsBottom=r.length);var a,l,u=[...S,...Array.from(i.tBodies).reduce((e,t)=>(e.push(...Array.from(t.rows)),e),[]),...r],c=(l=u.length,new Array(l));for(let e=0;e<l;e++)c[e]=new Array(s);var d=[],h=[];for(let n=0;n<l;n++){var f=u[n],p=Array.from(f.cells),g=p.length;for(let e=0;e<g;e++){var m=p[e],{nodeName:y,innerHTML:v,rowSpan:b,colSpan:E}=m,C=c[n].findIndex(e=>void 0===e);if("TD"===y){if(1<b||1<E){for(let t=n;t<n+b;t++)if(t<l)for(let e=C;e<C+E;e++)c[t][e]=null;y=m.getAttribute("style");y&&y.includes("mso-ignore:colspan")||d.push({col:C,row:n,rowspan:b,colspan:E})}let e="";e=o&&/excel/gi.test(o.content)?v.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):v.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),c[n][C]=e.replace(R,e=>T[e])}else h.push(v)}}return d.length&&(n.mergeCells=d),h.length&&(n.rowHeaders=h),c.length&&(n.data=c),n}},t.instanceToHTML=function(r){var e=r.hasColHeaders(),i=r.hasRowHeaders(),t=[e?-1:0,i?-1:0,r.countRows()-1,r.countCols()-1],o=r.getData(...t),s=o.length,a=0<s?o[0].length:0,t=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=i?1:0,d=e?1:0;for(let n=0;n<s;n+=1){var h=e&&0===n,f=[];for(let t=0;t<a;t+=1){var p,g,m,y=!h&&i&&0===t;let e="";h?e=`<th>${r.getColHeader(t-c)}</th>`:y?e=`<th>${r.getRowHeader(n-d)}</th>`:(y=o[n][t],{hidden:g,rowspan:m,colspan:p}=r.getCellMeta(n-d,t-c),g||(g=[],m&&g.push(`rowspan="${m}"`),p&&g.push(`colspan="${p}"`),e=(0,b.isEmpty)(y)?`<td ${g.join(" ")}></td>`:(m=y.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;"),`<td ${g.join(" ")}>${m}</td>`))),f.push(e)}var v=["<tr>",...f,"</tr>"].join("");h?l.splice(1,0,v):u.splice(-1,0,v)}return t.splice(1,0,l.join(""),u.join("")),t.join("")},n(203);var b=n(305);const T={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},R=new RegExp(Object.keys(T).map(e=>`(${e})`).join("|"),"gi")},(e,t,n)=>{"use strict";t.__esModule=!0,t.getPlugin=u,t.getPluginsNames=function(){return[...s.getItems(),...a.getItems()]},t.hasPlugin=function(e){return!!u(e)},t.registerPlugin=function(e,t,n){[e,t,n]=function(e,t,n){"function"==typeof e&&(e=(t=e).PLUGIN_KEY,n=t.PLUGIN_PRIORITY);return[e,t,n]}(e,t,n),void 0===u(e)&&function(e,t,n){e=(0,r.toUpperCaseFirst)(e);if(l.hasItem(e))throw new Error(o(e));void 0===n?a.addItem(e):s.addItem(n,e);l.addItem(e,t)}(e,t,n)},n(273);var r=n(303),t=n(460),i=n(462),n=n(463);const o=e=>`There is already registered "${e}" plugin.`;const s=(0,t.createPriorityMap)({errorPriorityExists:e=>`There is already registered plugin on priority "${e}".`,errorPriorityNaN:e=>`The priority "${e}" is not a number.`}),a=(0,n.createUniqueSet)({errorItemExists:o}),l=(0,i.createUniqueMap)({errorIdExists:o});function u(e){e=(0,r.toUpperCaseFirst)(e);return l.getItem(e)}},(e,t,n)=>{"use strict";t.__esModule=!0,t.createPriorityMap=function(){let{errorPriorityExists:n,errorPriorityNaN:r}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};const i=new Map;return n=(0,s.isFunction)(n)?n:u,r=(0,s.isFunction)(r)?r:c,{addItem:function(e,t){if(!(0,o.isNumeric)(e))throw new Error(r(e));if(i.has(e))throw new Error(n(e));i.set(e,t)},getItems:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:a;const[n,r]=l.get(e)||l.get(a);return[...i].sort((e,t)=>e[0]<t[0]?n:r).map(e=>e[1])}}},n(273);var o=n(461),s=n(445);const a="asc";t.ASC=a;t.DESC="desc";const l=new Map([[a,[-1,1]],["desc",[1,-1]]]),u=e=>`The priority '${e}' is already declared in a map.`,c=e=>`The priority '${e}' is not a number.`},(e,t)=>{"use strict";function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=typeof e;return"number"==n?!isNaN(e)&&isFinite(e):"string"==n?0!==e.length&&(1===e.length?/\d/.test(e):(t=Array.from(new Set([".",...t])).map(e=>"\\"+e).join("|"),new RegExp(`^[+-]?\\s*(((${t})?\\d+((${t})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(e.trim()))):"object"==n&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date)}t.__esModule=!0,t.isNumeric=n,t.isNumericLike=function(e){return n(e,[","])},t.rangeEach=function(e,t,n){let r=-1;"function"==typeof t?(n=t,t=e):r=e-1;for(;++r<=t&&!1!==n(r););},t.rangeEachReverse=function(e,t,n){let r=e+1;"function"==typeof t&&(n=t,t=0);for(;--r>=t&&!1!==n(r););},t.valueAccordingPercent=function(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}},(e,t,n)=>{"use strict";t.__esModule=!0,t.createUniqueMap=function(){let n=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})["errorIdExists"];const r=new Map;function t(){return[...r]}function i(e){return r.has(e)}return n=(0,o.isFunction)(n)?n:s,{addItem:function(e,t){if(i(e))throw new Error(n(e));r.set(e,t)},clear:function(){r.clear()},getId:function(n){var[e]=t().find(e=>{var[e,t]=e;return n===t&&e})||[null];return e},getItem:function(e){return r.get(e)},getItems:t,hasItem:i,removeItem:function(e){return r.delete(e)}}},n(273);var o=n(445);const s=e=>`The id '${e}' is already declared in a map.`},(e,t,n)=>{"use strict";t.__esModule=!0,t.createUniqueSet=function(){let t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})["errorItemExists"];const n=new Set;return t=(0,r.isFunction)(t)?t:i,{addItem:function(e){if(n.has(e))throw new Error(t(e));n.add(e)},clear:function(){n.clear()},getItems:function(){return[...n]}}},n(273);var r=n(445);const i=e=>`'${e}' value is already declared in a unique set.`},(e,t,n)=>{"use strict";var r=n(196);t.__esModule=!0,t.getRenderer=function(e){if("function"==typeof e)return e;if(s(e))return o(e);throw Error(`No registered renderer found under "${e}" name`)},t.registerRenderer=function(e,t){"string"!=typeof e&&(e=(t=e).RENDERER_TYPE);i(e,t)},n(273);const{register:i,getItem:o,hasItem:s,getNames:a,getValues:l}=(0,r(n(456)).default)("renderers");t.getRegisteredRenderers=l,t.getRegisteredRendererNames=a,t.hasRenderer=s},(e,t,n)=>{"use strict";var r=n(196);t.__esModule=!0,t.getValidator=function(e){if("function"==typeof e)return e;if(s(e))return o(e);throw Error(`No registered validator found under "${e}" name`)},t.registerValidator=function(e,t){"string"!=typeof e&&(e=(t=e).VALIDATOR_TYPE);i(e,t)},n(273);const{register:i,getItem:o,hasItem:s,getNames:a,getValues:l}=(0,r(n(456)).default)("validators");t.getRegisteredValidators=l,t.getRegisteredValidatorNames=a,t.hasValidator=s},(e,t,n)=>{"use strict";n(273);var r=n(196),i=(t.__esModule=!0,n(203),r(n(467))),o=r(n(471)),s=r(n(474)),d=n(302),a=r(n(457)),h=n(452),l=r(n(476)),u=n(539),c=n(540);function f(e,t,n){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,n)}const p=new WeakMap;var g=new WeakMap,m=new WeakMap;t.default=class{constructor(e){(0,i.default)(this,"instance",void 0),(0,i.default)(this,"eventManager",void 0),(0,i.default)(this,"settings",void 0),(0,i.default)(this,"THEAD",void 0),(0,i.default)(this,"TBODY",void 0),(0,i.default)(this,"_wt",void 0),(0,i.default)(this,"activeWt",void 0),f(this,g,{writable:!0,value:0}),f(this,m,{writable:!0,value:0}),(0,i.default)(this,"postponedAdjustElementsSize",!1),this.instance=e,this.eventManager=new a.default(this.instance),this.settings=this.instance.getSettings(),p.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}adjustElementsSize(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,t){e=this._wt.getCell(e,t);return e<0?null:e}scrollViewport(e,t,n,r,i){return this._wt.scrollViewport(e,t,n,r,i)}scrollViewportHorizontally(e,t,n){return this._wt.scrollViewportHorizontally(e,t,n)}scrollViewportVertically(e,t,n){return this._wt.scrollViewportVertically(e,t,n)}createElements(){var e=p.get(this),{rootElement:t,rootDocument:n}=this.instance,r=t.getAttribute("style");r&&t.setAttribute("data-originalstyle",r),(0,d.addClass)(t,"handsontable"),e.table=n.createElement("TABLE"),(0,d.addClass)(e.table,"htCore"),this.instance.getSettings().tableClassName&&(0,d.addClass)(e.table,this.instance.getSettings().tableClassName),this.THEAD=n.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}registerEvents(){const a=p.get(this),{rootElement:l,rootDocument:u,selection:t}=this.instance,c=u.documentElement;this.eventManager.addEventListener(l,"mousedown",e=>{var t;a.selectionMouseDown=!0,this.isTextSelectionAllowed(e.target)||(t=this.instance["rootWindow"],(0,d.clearTextSelection)(t),e.preventDefault(),t.focus())}),this.eventManager.addEventListener(l,"mouseup",()=>{a.selectionMouseDown=!1}),this.eventManager.addEventListener(l,"mousemove",e=>{a.selectionMouseDown&&!this.isTextSelectionAllowed(e.target)&&(this.settings.fragmentSelection&&(0,d.clearTextSelection)(this.instance.rootWindow),e.preventDefault())}),this.eventManager.addEventListener(c,"keyup",e=>{t.isInProgress()&&!e.shiftKey&&t.finish()}),this.eventManager.addEventListener(c,"mouseup",e=>{t.isInProgress()&&(0,h.isLeftClick)(e)&&t.finish(),!(a.mouseDown=!1,d.isOutsideInput)(u.activeElement)&&(t.isSelected()||t.isSelectedByAnyHeader()||l.contains(e.target)||(0,h.isRightClick)(e))||this.instance.unlisten()}),this.eventManager.addEventListener(c,"contextmenu",e=>{t.isInProgress()&&(0,h.isRightClick)(e)&&(t.finish(),a.mouseDown=!1)}),this.eventManager.addEventListener(c,"touchend",()=>{t.isInProgress()&&t.finish(),a.mouseDown=!1}),this.eventManager.addEventListener(c,"mousedown",e=>{var t=e.target,n=e.x||e.clientX,r=e.y||e.clientY;let i=e.target;if(!a.mouseDown&&l&&this.instance.view){var o=this.instance.view._wt.wtTable["holder"];if(i===o){var s=(0,d.getScrollbarWidth)(u);if(u.elementFromPoint(n+s,r)!==o||u.elementFromPoint(n,r+s)!==o)return}else for(;i!==c;){if(null===i){if(e.isTargetWebComponent)break;return}if(i===l)return;i=i.parentNode}("function"==typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(t):this.settings.outsideClickDeselects)?this.instance.deselectCell():this.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(a.table,"selectstart",e=>{this.settings.fragmentSelection||(0,d.isInput)(e.target)||e.preventDefault()})}translateFromRenderableToVisualCoords(e){var{row:e,col:t}=e;return this.instance._createCellCoords(...this.translateFromRenderableToVisualIndex(e,t))}translateFromRenderableToVisualIndex(e,t){let n=0<=e?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=0<=t?this.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===n&&(n=e),null===r&&(r=t),[n,r]}countRenderableIndexes(e,t){t=Math.min(e.getNotTrimmedIndexesLength(),t),t=e.getNearestNotHiddenIndex(t-1,-1);return null===t?0:e.getRenderableFromVisualIndex(t)+1}countRenderableColumns(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.instance.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.instance.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,n,r){if(isNaN(e)||e<0)return 0;e=n.getNearestNotHiddenIndex(e,t),n=n.getRenderableFromVisualIndex(e);if(!Number.isInteger(n))return 0;let i=0;return t<0?i=n+1:0<t&&(i=r-n),i}countNotHiddenFixedColumnsStart(){var e=this.instance.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(e,-1)}countNotHiddenFixedRowsTop(){var e=this.instance.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(e,-1)}countNotHiddenFixedRowsBottom(){var e=this.instance.countRows(),e=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(e,1)}isMainTableNotFullyCoveredByOverlays(){var e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>e&&this.instance.countRenderedCols()>t}initializeWalkontable(){const o=p.get(this),e={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:o.table,isDataViewInstance:()=>(0,c.isRootInstance)(this.instance),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(e,t)=>this.instance.getDataAtCell(...this.translateFromRenderableToVisualIndex(e,t)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>0<this.settings.fixedColumnsStart||0<e.rowHeaders().length,shouldRenderTopOverlay:()=>0<this.settings.fixedRowsTop||0<e.columnHeaders().length,shouldRenderBottomOverlay:()=>0<this.settings.fixedRowsBottom,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{var e=[];return this.instance.hasRowHeaders()&&e.push((e,t)=>{e=0<=e?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e;this.appendRowHeader(e,t)}),this.instance.runHooks("afterGetRowHeaderRenderers",e),(0,s.default)(this,m,e.length),e},columnHeaders:()=>{var e=[];return this.instance.hasColHeaders()&&e.push((e,t)=>{e=0<=e?this.instance.columnIndexMapper.getVisualFromRenderableIndex(e):e;this.appendColHeader(e,t)}),this.instance.runHooks("afterGetColumnHeaderRenderers",e),(0,s.default)(this,g,e.length),e},columnWidth:e=>{var t=this.instance.columnIndexMapper.getVisualFromRenderableIndex(e);return this.instance.getColWidth(null===t?e:t)},rowHeight:e=>{var t=this.instance.rowIndexMapper.getVisualFromRenderableIndex(e);return this.instance.getRowHeight(null===t?e:t)},cellRenderer:(e,t,n)=>{var[e,t]=this.translateFromRenderableToVisualIndex(e,t),r=this.instance.runHooks("modifyGetCellCoords",e,t);let i=e,o=t;Array.isArray(r)&&([i,o]=r);var r=this.instance.getCellMeta(i,o),s=this.instance.colToProp(o);let a=this.instance.getDataAtRowProp(i,s);this.instance.hasHook("beforeValueRender")&&(a=this.instance.runHooks("beforeValueRender",a,r)),this.instance.runHooks("beforeRenderer",n,e,t,s,a,r),this.instance.getCellRenderer(r)(this.instance,n,e,t,s,a,r),this.instance.runHooks("afterRenderer",n,e,t,s,a,r)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onContainerElementResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onCellMouseDown:(e,t,n,r)=>{var t=this.translateFromRenderableToVisualCoords(t),i={row:!1,column:!1,cell:!1};this.instance.listen(),this.activeWt=r,o.mouseDown=!0,this.instance.runHooks("beforeOnCellMouseDown",e,t,n,i),(0,h.isImmediatePropagationStopped)(e)||((0,u.handleMouseEvent)(e,{coords:t,selection:this.instance.selection,controller:i,cellCoordsFactory:(e,t)=>this.instance._createCellCoords(e,t)}),this.instance.runHooks("afterOnCellMouseDown",e,t,n),this.activeWt=this._wt)},onCellContextMenu:(e,t,n,r)=>{t=this.translateFromRenderableToVisualCoords(t);this.activeWt=r,o.mouseDown=!1,this.instance.selection.isInProgress()&&this.instance.selection.finish(),this.instance.runHooks("beforeOnCellContextMenu",e,t,n),(0,h.isImmediatePropagationStopped)(e)||(this.instance.runHooks("afterOnCellContextMenu",e,t,n),this.activeWt=this._wt)},onCellMouseOut:(e,t,n,r)=>{t=this.translateFromRenderableToVisualCoords(t);this.activeWt=r,this.instance.runHooks("beforeOnCellMouseOut",e,t,n),(0,h.isImmediatePropagationStopped)(e)||(this.instance.runHooks("afterOnCellMouseOut",e,t,n),this.activeWt=this._wt)},onCellMouseOver:(e,t,n,r)=>{var t=this.translateFromRenderableToVisualCoords(t),i={row:!1,column:!1,cell:!1};this.activeWt=r,this.instance.runHooks("beforeOnCellMouseOver",e,t,n,i),(0,h.isImmediatePropagationStopped)(e)||(o.mouseDown&&(0,u.handleMouseEvent)(e,{coords:t,selection:this.instance.selection,controller:i,cellCoordsFactory:(e,t)=>this.instance._createCellCoords(e,t)}),this.instance.runHooks("afterOnCellMouseOver",e,t,n),this.activeWt=this._wt)},onCellMouseUp:(e,t,n,r)=>{t=this.translateFromRenderableToVisualCoords(t);this.activeWt=r,this.instance.runHooks("beforeOnCellMouseUp",e,t,n),(0,h.isImmediatePropagationStopped)(e)||this.instance.isDestroyed||(this.instance.runHooks("afterOnCellMouseUp",e,t,n),this.activeWt=this._wt)},onCellCornerMouseDown:e=>{e.preventDefault(),this.instance.runHooks("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:e=>{e.preventDefault(),this.instance.runHooks("afterOnCellCornerDblClick",e)},beforeDraw:(e,t)=>this.beforeRender(e,t),onDraw:e=>this.afterRender(e),onScrollVertically:()=>this.instance.runHooks("afterScrollVertically"),onScrollHorizontally:()=>this.instance.runHooks("afterScrollHorizontally"),onBeforeRemoveCellClassNames:()=>this.instance.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(e,t,n)=>{var r=this.instance.rowIndexMapper,e=r.getVisualFromRenderableIndex(e),e=this.instance.runHooks("beforeHighlightingRowHeader",e,t,n);return r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(e,1))},onBeforeHighlightingColumnHeader:(e,t,n)=>{var r=this.instance.columnIndexMapper,e=r.getVisualFromRenderableIndex(e),e=this.instance.runHooks("beforeHighlightingColumnHeader",e,t,n);return r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(e,1))},onAfterDrawSelection:(e,t,n)=>{let r;var[e,t]=this.translateFromRenderableToVisualIndex(e,t),i=this.instance.selection.getSelectedRange(),o=i.size();return 0<o&&(i=i.peekByIndex((null!=n?n:0)+1-o),r=[i.from.row,i.from.col,i.to.row,i.to.col]),this.instance.runHooks("afterDrawSelection",e,t,r,n)},onBeforeDrawBorders:(e,t)=>{var[e,n,r,i]=e,e=[this.instance.rowIndexMapper.getVisualFromRenderableIndex(e),this.instance.columnIndexMapper.getVisualFromRenderableIndex(n),this.instance.rowIndexMapper.getVisualFromRenderableIndex(r),this.instance.columnIndexMapper.getVisualFromRenderableIndex(i)];return this.instance.runHooks("beforeDrawBorders",e,t)},onBeforeTouchScroll:()=>this.instance.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.instance.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(e,t)=>{t=this.instance.columnIndexMapper.getVisualFromRenderableIndex(t);return this.instance.runHooks("beforeStretchingColumnWidth",e,t)},onModifyRowHeaderWidth:e=>this.instance.runHooks("modifyRowHeaderWidth",e),onModifyGetCellCoords:(e,t,n)=>{var r,i=this.instance.rowIndexMapper,o=this.instance.columnIndexMapper,t=0<=t?o.getVisualFromRenderableIndex(t):t,e=0<=e?i.getVisualFromRenderableIndex(e):e,e=this.instance.runHooks("modifyGetCellCoords",e,t,n);if(Array.isArray(e))return[t,n,e,r]=e,[0<=t?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(t,1)):t,0<=n?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(n,1)):n,0<=e?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(e,-1)):e,0<=r?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r,-1)):r]},viewportRowCalculatorOverride:e=>{let t=this.settings.viewportRowRenderingOffset;var n,r,i,o;(0<(t="auto"===t&&this.settings.fixedRowsTop?10:t)||"auto"===t)&&(n=this.countRenderableRows(),r=e.startRow,i=e.endRow,"number"==typeof t?(e.startRow=Math.max(r-t,0),e.endRow=Math.min(i+t,n-1)):"auto"===t&&(o=Math.ceil(i/n*12),e.startRow=Math.max(r-o,0),e.endRow=Math.min(i+o,n-1))),this.instance.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:e=>{let t=this.settings.viewportColumnRenderingOffset;var n,r,i,o;(0<(t="auto"===t&&this.settings.fixedColumnsStart?10:t)||"auto"===t)&&(n=this.countRenderableColumns(),r=e.startColumn,i=e.endColumn,"number"==typeof t&&(e.startColumn=Math.max(r-t,0),e.endColumn=Math.min(i+t,n-1)),"auto"===t)&&(o=Math.ceil(i/n*6),e.startColumn=Math.max(r-o,0),e.endColumn=Math.min(i+o,n-1)),this.instance.runHooks("afterViewportColumnCalculatorOverride",e)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{var e=this.instance.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||e}},t=(this.instance.runHooks("beforeInitWalkontable",e),this._wt=new l.default(e),this.activeWt=this._wt,this._wt.wtTable.spreader);var{width:n,height:r}=this.instance.rootElement.getBoundingClientRect();this.setLastSize(n,r),this.eventManager.addEventListener(t,"mousedown",e=>{e.target===t&&3===e.which&&e.stopPropagation()}),this.eventManager.addEventListener(t,"contextmenu",e=>{e.target===t&&3===e.which&&e.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.instance.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){return!(!(0,d.isInput)(e)&&(e=(0,d.isChildOf)(e,this.instance.view._wt.wtTable.spreader),!0!==this.settings.fragmentSelection||!e)&&("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!e)&&(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}isMouseDown(){return p.get(this).mouseDown}isSelectedOnlyCell(){var e;return null!=(e=null==(e=this.instance.getSelectedRangeLast())?void 0:e.isSingle())&&e}isCellEdited(){var e=this.instance.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,t)}afterRender(e){e&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){var n=t.firstChild;if(!(0,d.hasClass)(n,"relative"))return(0,d.empty)(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{var{rootDocument:n,getRowHeader:r}=this.instance,i=n.createElement("div"),n=n.createElement("span");i.className="relative",n.className="rowHeader",this.updateCellHeader(n,e,r),i.appendChild(n),t.appendChild(i)}this.instance.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){var n,r,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.instance.getColHeader,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;t.firstChild?(r=t.firstChild,(0,d.hasClass)(r,"relative")?this.updateCellHeader(r.querySelector(".colHeader"),e,i,o):((0,d.empty)(t),this.appendColHeader(e,t,i,o))):(r=this.instance["rootDocument"],n=r.createElement("div"),r=r.createElement("span"),n.className="relative",r.className="colHeader",this.updateCellHeader(r,e,i,o),n.appendChild(r),t.appendChild(n)),this.instance.runHooks("afterGetColHeader",e,t,o)}updateCellHeader(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;let i=t;var o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&((0,d.hasClass)(e,"colHeader")?i=o.wtTable.columnFilter.sourceToRendered(t):(0,d.hasClass)(e,"rowHeader")&&(i=o.wtTable.rowFilter.sourceToRendered(t))),-1<i?(0,d.fastInnerHTML)(e,n(t,r)):((0,d.fastInnerText)(e,String.fromCharCode(160)),(0,d.addClass)(e,"cornerHeader"))}maximumVisibleElementWidth(e){e=this._wt.wtViewport.getWorkspaceWidth()-e;return 0<e?e:0}maximumVisibleElementHeight(e){e=this._wt.wtViewport.getWorkspaceHeight()-e;return 0<e?e:0}setLastSize(e,t){var n=p.get(this);[n.lastWidth,n.lastHeight]=[e,t]}getLastSize(){var e=p.get(this);return{width:e.lastWidth,height:e.lastHeight}}getFirstFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return(0,o.default)(this,g)}getRowHeadersCount(){return(0,o.default)(this,m)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}},(e,t,n)=>{var r=n(468);e.exports=function(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},(e,t,n)=>{var r=n(469).default,i=n(470);e.exports=function(e){return e=i(e,"string"),"symbol"===r(e)?e:String(e)},e.exports.__esModule=!0,e.exports.default=e.exports},t=>{function n(e){return t.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t.exports.__esModule=!0,t.exports.default=t.exports,n(e)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},(e,t,n)=>{var r=n(469).default;e.exports=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);if(n=n.call(e,t||"default"),"object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")},e.exports.__esModule=!0,e.exports.default=e.exports},(e,t,n)=>{var r=n(472),i=n(473);e.exports=function(e,t){return t=i(e,t,"get"),r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},e=>{e.exports=function(e,t){return t.get?t.get.call(e):t.value},e.exports.__esModule=!0,e.exports.default=e.exports},e=>{e.exports=function(e,t,n){if(t.has(e))return t.get(e);throw new TypeError("attempted to "+n+" private field on non-instance")},e.exports.__esModule=!0,e.exports.default=e.exports},(e,t,n)=>{var r=n(475),i=n(473);e.exports=function(e,t,n){return t=i(e,t,"set"),r(e,t,n),n},e.exports.__esModule=!0,e.exports.default=e.exports},e=>{e.exports=function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}},e.exports.__esModule=!0,e.exports.default=e.exports},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,r(n(477))),i=(t.ViewportColumnsCalculator=i.default,r(n(484))),i=(t.ViewportRowsCalculator=i.default,r(n(485))),i=(t.CellCoords=i.default,r(n(486))),i=(t.CellRange=i.default,r(n(487))),i=(t.default=i.default,t.Core=i.default,r(n(537))),r=(t.Selection=i.default,function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(498))),i=(t.Renderer=r,n(500)),r=(t.OrderView=i.OrderView,t.SharedOrderView=i.SharedOrderView,n(457));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}t.getListenersCounter=r.getListenersCounter},(e,t,n)=>{"use strict";t.__esModule=!0,n(203),n(478);var y=n(483);const v=new WeakMap;t.default=class r{static get DEFAULT_WIDTH(){return 50}constructor(){var{viewportSize:e,scrollOffset:t,totalItems:n,itemSizeFn:r,overrideFn:i,calculationType:o,stretchMode:s,stretchingItemWidthFn:a=e=>e,inlineStartOffset:l}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};v.set(this,{viewportWidth:e,scrollOffset:t,totalColumns:n,columnWidthFn:r,overrideFn:i,calculationType:o,stretchingColumnWidthFn:a,inlineStartOffset:l}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}calculate(){let t=0,n=!0;var r=[];let i,o=0,s=0;var e=v.get(this),a=e.calculationType,l=e.overrideFn,u=e.scrollOffset,c=Math.max(e.scrollOffset,0),d=e.totalColumns,h=e.viewportWidth,f=0<c?h+1:h;for(let e=0;e<d;e++)if(i=this._getColumnWidth(e),t<=c&&a!==y.FULLY_VISIBLE_TYPE&&(this.startColumn=e,o=i),t>=c&&t+(a===y.FULLY_VISIBLE_TYPE?i:0)<=c+f&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=e,o=i),this.endColumn=e),r.push(t),t+=i,s=i,a!==y.FULLY_VISIBLE_TYPE&&(this.endColumn=e),t>=c+h){n=!1;break}var p=a===y.FULLY_VISIBLE_TYPE?0:s,g=a===y.FULLY_VISIBLE_TYPE?o:0;if(u+h-f<-1*e.inlineStartOffset||u>r.at(-1)+p||-1*e.scrollOffset-e.viewportWidth>-1*g?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&n)for(this.startColumn=this.endColumn;0<this.startColumn;){var m=r[this.endColumn]+i-r[this.startColumn-1];if((m<=h||a!==y.FULLY_VISIBLE_TYPE)&&--this.startColumn,h<m)break}a===y.RENDER_TYPE&&null!==this.startColumn&&l&&l(this),this.startPosition=r[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if("none"!==this.stretch){let t=e;this.totalTargetWidth=t;var r=v.get(this),i=r.totalColumns;let n=0;for(let e=0;e<i;e++){var o=this._getColumnWidth(e),s=r.stretchingColumnWidthFn(void 0,e);"number"==typeof s?t-=s:n+=o}var a,e=t-n;"all"===this.stretch&&0<e?(this.stretchAllRatio=t/n,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0):"last"===this.stretch&&t!==1/0&&(a=this._getColumnWidth(i-1),this.stretchLastWidth=0<=(e+=a)?e:a)}}getStretchedColumnWidth(e,t){let n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(e,t):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(e)),n}_getStretchedAllColumnWidth(e,t){let n=0;var r=v.get(this),i=r.totalColumns;if(this.stretchAllColumnsWidth[e]||(t=Math.round(t*this.stretchAllRatio),r=r.stretchingColumnWidthFn(t,e),this.stretchAllColumnsWidth[e]=void 0===r?t:isNaN(r)?this._getColumnWidth(e):r),this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let e=0;e<this.stretchAllColumnsWidth.length;e++)n+=this.stretchAllColumnsWidth[e];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===v.get(this).totalColumns-1?this.stretchLastWidth:null}_getColumnWidth(e){let t=v.get(this).columnWidthFn(e);return t=isNaN(t)?r.DEFAULT_WIDTH:t}}},(e,t,n)=>{"use strict";var r=n(204),i=n(241),o=n(265),s=n(263),n=n(479);r({target:"Array",proto:!0},{at:function(e){var t=i(this),n=o(t),e=s(e),e=0<=e?e:n+e;return e<0||n<=e?void 0:t[e]}}),n("at")},(e,t,n)=>{"use strict";var r=n(235),i=n(480),n=n(246).f,o=r("unscopables"),s=Array.prototype;void 0===s[o]&&n(s,o,{configurable:!0,value:i(null)}),e.exports=function(e){s[o][e]=!0}},(e,t,n)=>{"use strict";function r(){}function i(e){e.write(g("")),e.close();var t=e.parentWindow.Object;return e=null,t}var o,s=n(248),a=n(481),l=n(267),u=n(256),c=n(294),d=n(244),n=n(255),h="prototype",f="script",p=n("IE_PROTO"),g=function(e){return"<"+f+">"+e+"</"+f+">"},m=function(){try{o=new ActiveXObject("htmlfile")}catch(e){}m="undefined"==typeof document||document.domain&&o?i(o):(e=d("iframe"),t="java"+f+":",e.style.display="none",c.appendChild(e),e.src=String(t),(t=e.contentWindow.document).open(),t.write(g("document.F=Object")),t.close(),t.F);for(var e,t,n=l.length;n--;)delete m[h][l[n]];return m()};u[p]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(r[h]=s(e),n=new r,r[h]=null,n[p]=e):n=m(),void 0===t?n:a.f(n,t)}},(e,t,n)=>{"use strict";var r=n(207),i=n(247),a=n(246),l=n(248),u=n(213),c=n(482);t.f=r&&!i?Object.defineProperties:function(e,t){l(e);for(var n,r=u(t),i=c(t),o=i.length,s=0;s<o;)a.f(e,n=i[s++],r[n]);return e}},(e,t,n)=>{"use strict";var r=n(260),i=n(267);e.exports=Object.keys||function(e){return r(e,i)}},(e,t)=>{"use strict";t.__esModule=!0;t.RENDER_TYPE=1,t.FULLY_VISIBLE_TYPE=2;t.PARTIALLY_VISIBLE_TYPE=3},(e,t,n)=>{"use strict";t.__esModule=!0,n(203),n(478);var y=n(483);const v=new WeakMap;t.default=class b{static get DEFAULT_HEIGHT(){return 23}constructor(){var{viewportSize:e,scrollOffset:t,totalItems:n,itemSizeFn:r,overrideFn:i,calculationType:o,scrollbarHeight:s}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};v.set(this,{viewportHeight:e,scrollOffset:t,totalRows:n,rowHeightFn:r,overrideFn:i,calculationType:o,horizontalScrollbarHeight:s}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}calculate(){var t=(p=v.get(this)).calculationType,e=p.overrideFn,n=p.rowHeightFn,r=p.scrollOffset,i=Math.max(p.scrollOffset,0),o=p.totalRows,s=p.viewportHeight,a=p.horizontalScrollbarHeight||0;let l=0,u=!0;var c=[];let d,h=0,f=0;for(let e=0;e<o;e++)if(d=n(e),isNaN(d)&&(d=b.DEFAULT_HEIGHT),l<=i&&t!==y.FULLY_VISIBLE_TYPE&&(this.startRow=e,h=d),l>=i&&l+(t===y.FULLY_VISIBLE_TYPE?d:0)<=i+s-a&&(null===this.startRow&&(this.startRow=e,h=d),this.endRow=e),c.push(l),l+=d,f=d,t!==y.FULLY_VISIBLE_TYPE&&(this.endRow=e),l>=i+s-a){u=!1;break}var p=t===y.FULLY_VISIBLE_TYPE?h:0,g=t===y.FULLY_VISIBLE_TYPE?0:f;if(r+s-a<p||r>c.at(-1)+g?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===o-1&&u)for(this.startRow=this.endRow;0<this.startRow;){var m=c[this.endRow]+d-c[this.startRow-1];if((m<=s-a||t!==y.FULLY_VISIBLE_TYPE)&&--this.startRow,s-a<=m)break}t===y.RENDER_TYPE&&null!==this.startRow&&e&&e(this),this.startPosition=c[this.startRow],void 0===this.startPosition&&(this.startPosition=null),o<this.endRow&&(this.endRow=o-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}},(e,t,n)=>{"use strict";n(273);var r=n(196),i=(t.__esModule=!0,r(n(467))),o=r(n(471)),s=r(n(474));function a(e,t,n){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,n)}var l=new WeakMap;t.default=class u{constructor(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];(0,i.default)(this,"row",null),(0,i.default)(this,"col",null),a(this,l,{writable:!0,value:!1}),(0,s.default)(this,l,n),void 0!==e&&void 0!==t&&(this.row=e,this.col=t)}isValid(e){return!(this.row<0||this.col<0||this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}isEqual(e){return e===this||this.row===e.row&&this.col===e.col}isSouthEastOf(e){return this.row>=e.row&&((0,o.default)(this,l)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&((0,o.default)(this,l)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&((0,o.default)(this,l)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&((0,o.default)(this,l)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}clone(){return new u(this.row,this.col,(0,o.default)(this,l))}toObject(){return{row:this.row,col:this.col}}}},(e,t,n)=>{"use strict";n(273);var r=n(196),i=(t.__esModule=!0,n(203),r(n(467))),o=r(n(471)),s=r(n(474)),a=r(n(485));function l(e,t,n){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,n)}var u=new WeakMap;t.default=class c{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:e,r=3<arguments.length&&void 0!==arguments[3]&&arguments[3];(0,i.default)(this,"highlight",null),(0,i.default)(this,"from",null),(0,i.default)(this,"to",null),l(this,u,{writable:!0,value:!1}),this.highlight=e.clone().normalize(),this.from=t.clone(),this.to=n.clone(),(0,s.default)(this,u,r)}setHighlight(e){return this.highlight=e.clone().normalize(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return 0<=this.from.row&&this.from.row===this.to.row&&0<=this.from.col&&this.from.col===this.to.col}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){var e,t;return this.from.row<0&&this.to.row<0?0:(e=Math.max(this.from.row,0),t=Math.max(this.to.row,0),Math.max(e,t)-Math.min(e,t)+1)}getWidth(){var e,t;return this.from.col<0&&this.to.col<0?0:(e=Math.max(this.from.col,0),t=Math.max(this.to.col,0),Math.max(e,t)-Math.min(e,t)+1)}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){var{row:e,col:t}=e,n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return n.row<=e&&r.row>=e&&n.col<=t&&r.col>=t}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){var t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col)&&(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0)}expandByRange(e){var t,n,r,i,o;return!(this.includesRange(e)||!this.overlaps(e)||(n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),t=this.getDirection(),r=e.getOuterTopStartCorner(),e=e.getOuterBottomEndCorner(),o=Math.min(n.row,r.row),n=Math.min(n.col,r.col),r=Math.max(i.row,e.row),i=Math.max(i.col,e.col),e=this._createCellCoords(o,n),o=this._createCellCoords(r,i),this.from=e,this.to=o,this.setDirection(t),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),0))}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return-1<["NE-SW","NW-SE"].indexOf(this.getDirection())?"N-S":"S-N"}getHorizontalDirection(){return-1<["NW-SE","SW-NE"].indexOf(this.getDirection())?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return(0,o.default)(this,u)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return(0,o.default)(this,u)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return(0,o.default)(this,u)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return(0,o.default)(this,u)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return(0,o.default)(this,u)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return(0,o.default)(this,u)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return(0,o.default)(this,u)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return(0,o.default)(this,u)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,t){return!!(t&&t.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(t.from.row,t.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(t.from.row,t.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(t.to.row,t.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(t.to.row,t.to.col))))||e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e,t){if(!(e instanceof a.default))return!1;if(t){var{from:n,to:r}=t;if(t.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(n.row,n.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(n.row,r.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(r.row,n.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterTopStartCorner()}}return e.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():e.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():e.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():e.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),r=Math.min(this.from.col,this.to.col),i=Math.max(this.from.col,this.to.col),o=Math.min(e.from.row,e.to.row),s=Math.max(e.from.row,e.to.row),a=Math.min(e.from.col,e.to.col),l=Math.max(e.from.col,e.to.col);return e=[],t===o&&e.push("top"),i===l&&e.push("right"),n===s&&e.push("bottom"),r===a&&e.push("left"),e}getInner(){var n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=[];for(let t=n.row;t<=r.row;t++)for(let e=n.col;e<=r.col;e++)this.from.row===t&&this.from.col===e||this.to.row===t&&this.to.col===e||i.push(this._createCellCoords(t,e));return i}getAll(){var n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=[];for(let t=n.row;t<=r.row;t++)for(let e=n.col;e<=r.col;e++)n.row===t&&n.col===e?i.push(n):r.row===t&&r.col===e?i.push(r):i.push(this._createCellCoords(t,e));return i}forAll(n){var r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let t=r.row;t<=i.row;t++)for(let e=r.col;e<=i.col;e++)if(!1===n(t,e))return}clone(){return new c(this.highlight,this.from,this.to,(0,o.default)(this,u))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new a.default(e,t,(0,o.default)(this,u))}}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,r(n(488))),o=r(n(520));t.default=class s{constructor(e){e instanceof o.default?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=e=>{const t=new s(e);return()=>t},this._wot=new i.default(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selections(){return this._wot.selections}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,n){return this._wot.createCellRange(e,t,n)}draw(){return this._wot.draw(0<arguments.length&&void 0!==arguments[0]&&arguments[0]),this}getCell(e){return this._wot.getCell(e,1<arguments.length&&void 0!==arguments[1]&&arguments[1])}scrollViewport(e,t,n,r,i){return this._wot.scrollViewport(e,t,n,r,i)}scrollViewportHorizontally(e,t,n){return this._wot.scrollViewportHorizontally(e,t,n)}scrollViewportVertically(e,t,n){return this._wot.scrollViewportVertically(e,t,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,n,r,i){return this._wot.wtSettings.getSetting(e,t,n,r,i)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),r(n(489))),o=r(n(491)),s=r(n(533)),a=r(n(534)),l=r(n(535)),r=r(n(520)),u=n(447),c=n(302);class d extends r.default{constructor(e,t){super(e,new s.default(t));e=this.wtSettings.getSetting("facade",this);this.wtTable=new a.default(this.getTableDao(),e,this.domBindings,this.wtSettings),this.wtViewport=new l.default(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selections=this.wtSettings.getSetting("selections"),this.wtEvent=new i.default(e,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selections),this.wtOverlays=new o.default(this,e,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const n=[],r=[];(0,u.objectEach)({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(e,t)=>{this.wtSettings.getSetting(t).length&&r.push(e),n.push(e)}),(0,c.removeClass)(this.wtTable.wtRootElement.parentNode,n),(0,c.addClass)(this.wtTable.wtRootElement.parentNode,r)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}t.default=d},(e,t,n)=>{"use strict";t.__esModule=!0;var o=n(302),s=n(445),r=n(490),i=n(446),a=n(305);const l=new WeakMap;t.default=class{constructor(e,t,n,r,i,o){var s=6<arguments.length&&void 0!==arguments[6]?arguments[6]:null;this.wtSettings=n,this.domBindings=t,this.wtTable=i,this.selections=o,this.parent=s,this.eventManager=r,this.facadeGetter=e,l.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}registerEvents(){this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",e=>this.onContextMenu(e)),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",e=>this.onMouseOver(e)),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",e=>this.onMouseOut(e));var e=()=>{this.eventManager.addEventListener(this.wtTable.holder,"touchstart",e=>this.onTouchStart(e)),this.eventManager.addEventListener(this.wtTable.holder,"touchend",e=>this.onTouchEnd(e)),this.momentumScrolling||(this.momentumScrolling={}),this.eventManager.addEventListener(this.wtTable.holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||this.wtSettings.getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,this.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},t=()=>{this.eventManager.addEventListener(this.wtTable.holder,"mouseup",e=>this.onMouseUp(e)),this.eventManager.addEventListener(this.wtTable.holder,"mousedown",e=>this.onMouseDown(e))};((0,i.isMobileBrowser)()?e:((0,r.isTouchSupported)()&&e(),t))()}selectedCellWasTouched(e){var t,n,r=l.get(this),e=this.parentCell(e).coords;return!(!r.selectedCellBeforeTouchEnd||!e)&&([t,n]=[e.row,r.selectedCellBeforeTouchEnd.from.row],[e,r]=[e.col,r.selectedCellBeforeTouchEnd.from.col],t===n)&&e===r}parentCell(e){var t={},n=this.wtTable.TABLE,n=(0,o.closestDown)(e,["TD","TH"],n);return n?(t.coords=this.wtTable.getCoords(n),t.TD=n):(0,o.hasClass)(e,"wtBorder")&&(0,o.hasClass)(e,"current")?(t.coords=this.selections.getCell().cellRange.highlight,t.TD=this.wtTable.getCell(t.coords)):(0,o.hasClass)(e,"wtBorder")&&(0,o.hasClass)(e,"area")&&this.selections.createOrGetArea().cellRange&&(t.coords=this.selections.createOrGetArea().cellRange.to,t.TD=this.wtTable.getCell(t.coords)),t}onMouseDown(e){const t=l.get(this);var n=this.domBindings.rootDocument.activeElement,r=(0,s.partial)(o.getParent,e.target),i=e.target;i!==n&&r(0)!==n&&r(1)!==n&&(r=this.parentCell(i),(0,o.hasClass)(i,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",e,i):r.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,r.coords,r.TD),0===e.button||this.touchApplied)&&r.TD&&(t.dblClickOrigin[0]=r.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout(()=>{t.dblClickOrigin[0]=null},1e3))}onContextMenu(e){var t;this.wtSettings.has("onCellContextMenu")&&(t=this.parentCell(e.target)).TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}onMouseOver(e){var t,n,r;this.wtSettings.has("onCellMouseOver")&&(t=this.wtTable.TABLE,n=(0,o.closestDown)(e.target,["TD","TH"],t),r=this.parent||this,n)&&n!==r.lastMouseOver&&(0,o.isChildOf)(n,t)&&(r.lastMouseOver=n,this.callListener("onCellMouseOver",e,this.wtTable.getCoords(n),n))}onMouseOut(e){var t,n,r,i;this.wtSettings.has("onCellMouseOut")&&(t=this.wtTable.TABLE,n=(0,o.closestDown)(e.target,["TD","TH"],t),r=(0,o.closestDown)(e.relatedTarget,["TD","TH"],t),i=this.parent||this,n)&&n!==r&&(0,o.isChildOf)(n,t)&&(this.callListener("onCellMouseOut",e,this.wtTable.getCoords(n),n),null===r)&&(i.lastMouseOver=null)}onMouseUp(e){const t=l.get(this);var n=this.parentCell(e.target);n.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),0!==e.button&&!this.touchApplied||(n.TD===t.dblClickOrigin[0]&&n.TD===t.dblClickOrigin[1]?((0,o.hasClass)(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),t.dblClickOrigin[0]=null,t.dblClickOrigin[1]=null):n.TD===t.dblClickOrigin[0]&&(t.dblClickOrigin[1]=n.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout(()=>{t.dblClickOrigin[1]=null},500)))}onTouchStart(e){l.get(this).selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t=e.target,n=null==(n=this.parentCell(t))?void 0:n.coords,n=(0,a.isDefined)(n)&&0<=n.row&&0<=n.col;e.cancelable&&n&&this.wtSettings.getSetting("isDataViewInstance")&&(n=["A","BUTTON","INPUT"],(0,i.isIOS)()&&((0,i.isChromeWebKit)()||(0,i.isFirefoxWebKit)())&&this.selectedCellWasTouched(t)&&!n.includes(t.tagName)||!this.selectedCellWasTouched(t))&&e.preventDefault(),this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,n,r){e=this.wtSettings.getSettingPure(e);e&&e(t,n,r,this.facadeGetter())}destroy(){var e=l.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}}},(e,t)=>{"use strict";t.__esModule=!0,t.cancelAnimationFrame=function(e){window.cancelAnimationFrame(e)},t.getComparisonFunction=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return n=n||("object"==typeof Intl?new Intl.Collator(e,t).compare:"function"==typeof String.prototype.localeCompare?(e,t)=>(""+e).localeCompare(t):(e,t)=>e===t?0:t<e?-1:1)},t.isTouchSupported=function(){return"ontouchstart"in window},t.requestAnimationFrame=function(e){return window.requestAnimationFrame(e)};let n},(e,t,n)=>{"use strict";var r=n(196),s=(t.__esModule=!0,n(203),r(n(467))),a=n(302),l=n(490),i=n(444),o=n(451),u=n(446),c=n(492);t.default=class{constructor(e,t,n,r,i,o){(0,s.default)(this,"wot",null),(0,s.default)(this,"topOverlay",null),(0,s.default)(this,"bottomOverlay",null),(0,s.default)(this,"inlineStartOverlay",null),(0,s.default)(this,"topInlineStartCornerOverlay",null),(0,s.default)(this,"bottomInlineStartCornerOverlay",null),(0,s.default)(this,"browserLineHeight",void 0),(0,s.default)(this,"wtSettings",null),(0,s.default)(this,"resizeObserver",new ResizeObserver(e=>{(0,l.requestAnimationFrame)(()=>{Array.isArray(e)&&e.length&&this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=r,this.domBindings=n,this.facadeGetter=t,this.wtTable=o;var{rootDocument:e,rootWindow:r}=this.domBindings,n=(this.instance=this.wot,this.eventManager=i,this.scrollbarSize=(0,a.getScrollbarWidth)(e),"hidden"===r.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow"));this.scrollableElement=n?o.holder:(0,a.getScrollableElement)(o.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=r.scrollX,this.lastScrollY=r.scrollY}getOverlays(){var e=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return 0<arguments.length&&void 0!==arguments[0]&&arguments[0]&&e.push(this.wtTable),e}initBrowserLineHeight(){var{rootWindow:e,rootDocument:t}=this.domBindings,e=e.getComputedStyle(t.body),t=parseInt(e.lineHeight,10),e=1.2*parseInt(e.fontSize,10);this.browserLineHeight=t||e}initOverlays(){var e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new c.TopOverlay(...e),this.bottomOverlay=new c.BottomOverlay(...e),this.inlineStartOverlay=new c.InlineStartOverlay(...e),this.topInlineStartCornerOverlay=new c.TopInlineStartCornerOverlay(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new c.BottomInlineStartCornerOverlay(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender)?this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e:e}refreshAll(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}registerListeners(){var{rootDocument:e,rootWindow:t}=this.domBindings,n=this.topOverlay["mainTableScrollableElement"],r=this.inlineStartOverlay["mainTableScrollableElement"],e=(this.eventManager.addEventListener(e.documentElement,"keydown",e=>this.onKeyDown(e)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",e=>this.onTableScroll(e),{passive:!0}),n!==r&&this.eventManager.addEventListener(r,"scroll",e=>this.onTableScroll(e),{passive:!0}),t.devicePixelRatio&&1<t.devicePixelRatio),n=this.scrollableElement===t;const i=this.wtSettings.getSetting("preventWheel"),o={passive:n};!i&&!e&&(0,u.isChrome)()||this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",e=>this.onCloneWheel(e,i),o),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(e=>{e&&e.needFullRender&&(e=e.clone.wtTable["holder"],this.eventManager.addEventListener(e,"wheel",e=>this.onCloneWheel(e,i),o))});let s;this.eventManager.addEventListener(t,"resize",()=>{clearTimeout(s),s=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),n||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){var t=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,i=e.target;this.keyPressed&&(r!==t&&i!==t&&!e.target.contains(r)||n!==t&&i!==t&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,t){var n=this.domBindings["rootWindow"],r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target,i=i!==n&&o!==n&&!o.contains(i),o=r!==n&&o!==n&&!o.contains(r);this.keyPressed&&(i||o)||(r=this.translateMouseWheelToScroll(e),(t||this.scrollableElement!==n&&r)&&e.preventDefault())}onKeyDown(e){this.keyPressed=(0,o.isKey)(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(n+=n*this.browserLineHeight,t+=t*this.browserLineHeight);var e=this.scrollVertically(t),r=this.scrollHorizontally(n);return e||r}scrollVertically(e){var t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){var t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){var e,t,n,r,i;this.destroyed||(i=this.domBindings["rootWindow"],e=this.topOverlay.clone.wtTable.holder,t=this.inlineStartOverlay.clone.wtTable.holder,[n,r]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],this.horizontalScrolling=e.scrollLeft!==n||this.lastScrollX!==i.scrollX,this.verticalScrolling=t.scrollTop!==r||this.lastScrollY!==i.scrollY,this.lastScrollX=i.scrollX,this.lastScrollY=i.scrollY,this.horizontalScrolling&&(e.scrollLeft=n,i=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null)&&(i.scrollLeft=n),this.verticalScrolling&&(t.scrollTop=r),this.refreshAll())}syncScrollWithMaster(){var{scrollLeft:e,scrollTop:t}=this.topOverlay.mainTableScrollableElement;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=t)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var e=this["wtTable"],t=this.domBindings["rootWindow"];"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=e.holder:this.scrollableElement=(0,a.getScrollableElement)(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){var e=this.wtTable.spreader,t=e.clientWidth,e=e.clientHeight,n=t!==this.spreaderLastSize.width||e!==this.spreaderLastSize.height;return n&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=e),n}adjustElementsSize(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this.wot["wtViewport"],n=this["wtTable"],r=this.wtSettings.getSetting("totalColumns"),i=this.wtSettings.getSetting("totalRows"),o=t.getRowHeaderWidth(),t=t.getColumnHeaderHeight(),s=n.hider.style;s.width=o+this.inlineStartOverlay.sumCellSizes(0,r)+"px",s.height=t+this.topOverlay.sumCellSizes(0,i)+1+"px",0<this.scrollbarSize&&({scrollHeight:o,scrollWidth:r}=n.wtRootElement,{scrollHeight:s,scrollWidth:t}=n.holder,this.hasScrollbarRight=o<s,this.hasScrollbarBottom=r<t,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>r?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>o&&(this.hasScrollbarRight=!0)),this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(t){if(!t)return null;var e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return(0,i.arrayEach)(e,e=>{e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(n=e.clone)}),n}syncOverlayTableClassNames(){const t=this.wtTable.TABLE;var e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];(0,i.arrayEach)(e,e=>{e&&(e.clone.wtTable.TABLE.className=t.className)})}}},(e,t,n)=>{"use strict";var r={BottomInlineStartCornerOverlay:t.__esModule=!0,BottomOverlay:!0,InlineStartOverlay:!0,Overlay:!0,TopInlineStartCornerOverlay:!0,TopOverlay:!0},i=n(493),i=(t.BottomInlineStartCornerOverlay=i.BottomInlineStartCornerOverlay,n(522)),i=(t.BottomOverlay=i.BottomOverlay,n(525)),i=(t.InlineStartOverlay=i.InlineStartOverlay,n(517)),i=(t.Overlay=i.Overlay,n(528)),i=(t.TopInlineStartCornerOverlay=i.TopInlineStartCornerOverlay,n(531)),o=(t.TopOverlay=i.TopOverlay,n(518));Object.keys(o).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(r,e)||e in t&&t[e]===o[e]||(t[e]=o[e])})},(e,t,n)=>{"use strict";var r=n(196),o=(t.__esModule=!0,n(302)),i=r(n(494)),r=n(517),s=n(518);class a extends r.Overlay{constructor(e,t,n,r,i,o){super(e,t,s.CLONE_BOTTOM_INLINE_START_CORNER,n,r),this.bottomOverlay=i,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new i.default(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){var t=this["wot"];if(this.updateTrimmingContainer(),t.wtTable.holder.parentNode){var n,t=this.clone.wtTable.holder.parentNode;t.style.top="",this.trimmingContainer===this.domBindings.rootWindow?(r=this.inlineStartOverlay.getOverlayOffset(),n=this.bottomOverlay.getOverlayOffset(),t.style[this.isRtl()?"right":"left"]=r+"px",t.style.bottom=n+"px"):((0,o.resetCssTransform)(t),this.repositionOverlay());let e=(0,o.outerHeight)(this.clone.wtTable.TABLE);var r=(0,o.outerWidth)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(e=0),t.style.height=e+"px",t.style.width=r+"px"}return!1}repositionOverlay(){var{wtTable:e,wtViewport:t}=this.wot,n=this.domBindings["rootDocument"],r=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=(0,o.getScrollbarWidth)(n)),r.style.bottom=i+"px"}}t.BottomInlineStartCornerOverlay=a},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,r(n(495))),o=r(n(515)),r=r(n(516)),s=n(447),a=n(492);class l extends i.default{constructor(e,t,n,r){super(e,t,n,r,a.CLONE_BOTTOM_INLINE_START_CORNER)}}(0,s.mixin)(l,o.default),(0,s.mixin)(l,r.default),t.default=l},(e,t,n)=>{"use strict";var r=n(196),s=(t.__esModule=!0,n(203),n(273),r(n(467))),f=n(302),i=n(445),p=r(n(496)),g=r(n(497)),a=n(498),l=r(n(513)),u=r(n(514)),m=n(492);t.default=class{constructor(e,t,n,r,i){(0,s.default)(this,"wtSettings",null),(0,s.default)(this,"domBindings",void 0),(0,s.default)(this,"TBODY",null),(0,s.default)(this,"THEAD",null),(0,s.default)(this,"COLGROUP",null),(0,s.default)(this,"hasTableHeight",!0),(0,s.default)(this,"hasTableWidth",!0),(0,s.default)(this,"isTableVisible",!1),(0,s.default)(this,"tableOffset",0),(0,s.default)(this,"holderOffset",0),this.domBindings=n,this.isMaster="master"===i,this.name=i,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=r,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,(0,f.removeTextNodes)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new u.default(this.dataAccessObject,this.wtSettings),this.columnUtils=new l.default(this.dataAccessObject,this.wtSettings),this.tableRenderer=new a.Renderer({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){var e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){var t=e.parentNode;let n;return t&&t.nodeType===Node.ELEMENT_NODE&&(0,f.hasClass)(t,"wtHolder")||((n=this.domBindings.rootDocument.createElement("div")).className="wtSpreader",t&&t.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",n}createHider(e){var t=e.parentNode;let n;return t&&t.nodeType===Node.ELEMENT_NODE&&(0,f.hasClass)(t,"wtHolder")||((n=this.domBindings.rootDocument.createElement("div")).className="wtHider",t&&t.insertBefore(n,e),n.appendChild(e)),n}createHolder(e){var t=e.parentNode;let n;return t&&t.nodeType===Node.ELEMENT_NODE&&(0,f.hasClass)(t,"wtHolder")||((n=this.domBindings.rootDocument.createElement("div")).style.position="relative",n.className="wtHolder",t&&t.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),n.appendChild(e)),n}draw(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=this["wtSettings"],{wtOverlays:e,wtViewport:r}=this.dataAccessObject,i=n.getSetting("totalRows"),o=n.getSetting("totalColumns"),s=n.getSetting("rowHeaders"),a=s.length,l=n.getSetting("columnHeaders"),u=l.length;let c=!1,d=t;if(this.isMaster&&(this.holderOffset=(0,f.offset)(this.holder),d=r.createRenderCalculators(d),a)&&!n.getSetting("fixedColumnsStart")&&(t=e.inlineStartOverlay.getScrollPosition(),n=this.correctHeaderWidth,this.correctHeaderWidth=0!==t,n!==this.correctHeaderWidth)&&(d=!1),this.isMaster&&(c=e.updateStateOfRendering()),d)this.isMaster&&r.createVisibleCalculators(),e&&e.refresh(!0);else{this.isMaster?this.tableOffset=(0,f.offset)(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var t=0<i?this.getFirstRenderedRow():0,n=0<o?this.getFirstRenderedColumn():0;this.rowFilter=new g.default(t,i,u),this.columnFilter=new p.default(n,o,a);let e=!0;if(this.isMaster&&(this.alignOverlaysWithTrimmingContainer(),this.wtSettings.getSetting("beforeDraw",!0,r={}),e=!0!==r.skipRender),e){this.tableRenderer.setHeaderContentRenderers(s,l),(this.is(m.CLONE_BOTTOM)||this.is(m.CLONE_BOTTOM_INLINE_START_CORNER))&&this.tableRenderer.setHeaderContentRenderers(s,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let e;this.isMaster&&(e=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(m.CLONE_BOTTOM))&&this.markOversizedRows(),this.isMaster?(this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM(),t=(0,f.outerWidth)(this.hider),i=(0,f.outerWidth)(this.TABLE),0!==t&&i!==t&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),e!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)):this.is(m.CLONE_BOTTOM)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let h=!1;return this.isMaster&&(h=e.topOverlay.resetFixedPosition(),e.bottomOverlay.clone&&(h=e.bottomOverlay.resetFixedPosition()||h),h=e.inlineStartOverlay.resetFixedPosition()||h,e.topInlineStartCornerOverlay&&e.topInlineStartCornerOverlay.resetFixedPosition(),e.bottomInlineStartCornerOverlay)&&e.bottomInlineStartCornerOverlay.clone&&e.bottomInlineStartCornerOverlay.resetFixedPosition(),h?(e.refreshAll(),e.adjustElementsSize()):this.refreshSelections(d),c&&e.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){var t=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;for(var r,i,o=this.wtSettings.getSetting("defaultRowHeight"),s=this.wtSettings.getSetting("columnHeaderHeight")||[];n;)--n,r=this.getColumnHeaderHeight(n),(i=this.getColumnHeader(t,n))&&(i=(0,f.innerHeight)(i),(!r&&o<i||r<i)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=i),Array.isArray(s)?null!==s[n]&&void 0!==s[n]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=s[n]):isNaN(s)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=s),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(s[n]||s))&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=s[n]||s)}adjustColumnHeaderHeights(){var n=this["wtSettings"],r=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders;for(let e=0,t=n.getSetting("columnHeaders").length;e<t;e++)if(i[e]){if(!r[e]||0===r[e].childNodes.length)return;r[e].childNodes[0].style.height=i[e]+"px"}}resetOversizedRows(){var e=this["wtSettings"],t=this.dataAccessObject["wtViewport"];if((this.isMaster||this.is(m.CLONE_BOTTOM))&&!e.getSetting("externalRowCalculator")){var n=this.getRenderedRowsCount();for(let e=0;e<n;e++){var r=this.rowFilter.renderedToSource(e);t.oversizedRows&&t.oversizedRows[r]&&(t.oversizedRows[r]=void 0)}}}removeClassFromCells(n){var r=this.TABLE.querySelectorAll("."+n);for(let e=0,t=r.length;e<t;e++)(0,f.removeClass)(r[e],n)}refreshSelections(t){var e=this["wtSettings"],n=this.dataAccessObject["selections"];if(n){var r=Array.from(n),i=r.length;if(t){var o=[];for(let e=0;e<i;e++){var{highlightHeaderClassName:s,highlightRowClassName:a,highlightColumnClassName:l}=r[e].settings,u=r[e].classNames,c=u.length;for(let e=0;e<c;e++)o.includes(u[e])||o.push(u[e]);s&&!o.includes(s)&&o.push(s),a&&!o.includes(a)&&o.push(a),l&&!o.includes(l)&&o.push(l)}var d=e.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(d))for(let e=0;e<d.length;e++)o.push(d[e]);var h=o.length;for(let e=0;e<h;e++)this.removeClassFromCells(o[e])}for(let e=0;e<i;e++)r[e].draw(this.facadeGetter(),t)}}getCell(e){let t=e.row,n=e.col;e=this.wtSettings.getSetting("onModifyGetCellCoords",t,n);if(e&&Array.isArray(e)&&([t,n]=e),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;e=this.getRow(t);if(!e&&0<=t)throw new Error("TR was expected to be rendered but is not");e=e.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!e&&0<=n)throw new Error("TD or TH was expected to be rendered but is not");return e}getRow(e){let t=null,n=null;var r;return n=e<0?(t=null==(r=this.rowFilter)?void 0:r.sourceRowToVisibleColHeadedRow(e),this.THEAD):(t=null==(r=this.rowFilter)?void 0:r.sourceToRendered(e),this.TBODY),void 0!==t&&void 0!==n&&!(n.childNodes.length<t+1)&&n.childNodes[t]}getColumnHeader(e){var t=this.THEAD.childNodes[1<arguments.length&&void 0!==arguments[1]?arguments[1]:0];return null==t?void 0:t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(e=>{e=e.childNodes[n];e&&t.push(e)}),t}getRowHeader(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return 0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)||this.wtSettings.getSetting("rowHeaders").length<=t||null==(e=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)])?void 0:e.childNodes[t]}getRowHeaders(t){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return[];var n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let e=0;e<r;e++){var i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],i=null==i?void 0:i.childNodes[e];i&&n.push(i)}return n}getCoords(e){let t=e;if(null===(t="TD"!==t.nodeName&&"TH"!==t.nodeName?(0,f.closest)(t,["TD","TH"]):t))return null;var e=t.parentNode,n=e.parentNode;let r=(0,f.index)(e),i=t.cellIndex;return(0,f.overlayContainsElement)(m.CLONE_TOP_INLINE_START_CORNER,t,this.wtRootElement)||(0,f.overlayContainsElement)(m.CLONE_TOP,t,this.wtRootElement)?"THEAD"===n.nodeName&&(r-=n.childNodes.length):r=(0,f.overlayContainsElement)(m.CLONE_BOTTOM_INLINE_START_CORNER,t,this.wtRootElement)||(0,f.overlayContainsElement)(m.CLONE_BOTTOM,t,this.wtRootElement)?this.wtSettings.getSetting("totalRows")-n.childNodes.length+r:n===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(r):this.rowFilter.renderedToSource(r),i=(0,f.overlayContainsElement)(m.CLONE_TOP_INLINE_START_CORNER,t,this.wtRootElement)||(0,f.overlayContainsElement)(m.CLONE_INLINE_START,t,this.wtRootElement)||(0,f.overlayContainsElement)(m.CLONE_BOTTOM_INLINE_START_CORNER,t,this.wtRootElement)?this.columnFilter.offsettedTH(i):this.columnFilter.visibleRowHeadedColumnToSourceColumn(i),this.wot.createCellCoords(r,i)}markOversizedRows(){if(!this.wtSettings.getSetting("externalRowCalculator")){let e=this.TBODY.childNodes.length;var n,r,i,o;let t;if(e*this.wtSettings.getSetting("defaultRowHeight")!=(0,f.innerHeight)(this.TBODY)-1||this.wtSettings.getSetting("fixedRowsBottom"))for(;e;)--e,r=this.rowFilter.renderedToSource(e),n=this.getRowHeight(r),o=(i=this.getTrForRow(r)).querySelector("th"),t=o?(0,f.innerHeight)(o):(0,f.innerHeight)(i)-1,(!n&&this.wtSettings.getSetting("defaultRowHeight")<t||n<t)&&(t+=1,this.dataAccessObject.wtViewport.oversizedRows[r]=t)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){var t;return!(0<=e)&&(t=this.wtSettings.getSetting("rowHeaders").length,Math.abs(e)<=t)}isRowHeaderRendered(e){var t;return!(0<=e)&&(t=this.wtSettings.getSetting("columnHeaders").length,Math.abs(e)<=t)}isRowBeforeRenderedRows(e){var t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){var t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&0<=e}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return(0,f.outerWidth)(this.TABLE)}getHeight(){return(0,f.outerHeight)(this.TABLE)}getTotalWidth(){var e=(0,f.outerWidth)(this.hider);return 0!==e?e:this.getWidth()}getTotalHeight(){var e=(0,f.outerHeight)(this.hider);return 0!==e?e:this.getHeight()}isVisible(){return(0,f.isVisible)(this.TABLE)}_modifyRowHeaderWidth(e){let t=(0,i.isFunction)(e)?e():null;return Array.isArray(t)?(t=[...t])[t.length-1]=this._correctRowHeaderWidth(t[t.length-1]):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return"number"!=typeof e&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}},(e,t)=>{"use strict";t.__esModule=!0;t.default=class{constructor(e,t,n){this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}},(e,t)=>{"use strict";t.__esModule=!0;t.default=class{constructor(e,t,n){this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}},(e,t,n)=>{"use strict";var r=n(196),a=(t.__esModule=!0,r(n(499))),l=(t.RowHeadersRenderer=a.default,r(n(508))),u=(t.ColumnHeadersRenderer=l.default,r(n(509))),c=(t.ColGroupRenderer=u.default,r(n(510))),d=(t.RowsRenderer=c.default,r(n(511))),h=(t.CellsRenderer=d.default,r(n(512)));t.TableRenderer=h.default;t.Renderer=class{constructor(){var{TABLE:e,THEAD:t,COLGROUP:n,TBODY:r,rowUtils:i,columnUtils:o,cellRenderer:s}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new h.default(e,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new a.default,columnHeaders:new l.default(t),colGroup:new u.default(n),rows:new c.default(r),cells:new d.default}),this.renderer.setAxisUtils(i,o)}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(500));class o extends r(n(506)).default{constructor(){super("TH"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new i.SharedOrderView(e,e=>this.nodesPool.obtain(this.sourceRowIndex,e),this.nodeType),this.orderViews.set(e,t)),t}render(){var{rowsToRender:t,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let e=0;e<t;e++){var s=this.table.renderedRowToSource(e),a=i.getRenderedNode(e),l=(this.sourceRowIndex=s,this.obtainOrderView(a)),a=o.obtainOrderView(a);l.appendView(a).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let e=0;e<r;e++){l.render();var u=l.getCurrentNode();u.className="",u.removeAttribute("style"),n[e](s,u,e)}l.end()}}}t.default=o},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,r(n(501))),i=(t.OrderView=i.default,r(n(505)));t.SharedOrderView=i.default},(e,t,n)=>{"use strict";var r=n(196),a=(t.__esModule=!0,n(203),n(502)),i=r(n(503));t.default=class{constructor(e,t,n){this.rootNode=e,this.nodesPool=t,this.sizeSet=new i.default,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){var e=this.collectedNodes.length;return 0<e?this.collectedNodes[e-1]:null}getRenderedChildCount(){var{rootNode:t,sizeSet:n}=this;let r=0;if(this.isSharedViewSet()){let e=t.firstElementChild;for(;e;){if(e.tagName===this.childNodeType)r+=1;else if(n.isPlaceOn(a.WORKING_SPACE_TOP))break;e=e.nextElementSibling}}else r=t.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;var{rootNode:e,sizeSet:t}=this,n=this.isSharedViewSet(),r=t.getViewSize()["nextSize"];let i=this.getRenderedChildCount();for(;i<r;){var o=this.nodesPool();!n||t.isPlaceOn(a.WORKING_SPACE_BOTTOM)?e.appendChild(o):e.insertBefore(o,e.firstChild),i+=1}for(var s=n&&t.isPlaceOn(a.WORKING_SPACE_TOP);i>r;)e.removeChild(s?e.firstChild:e.lastChild),--i}render(){var{rootNode:e,sizeSet:t}=this;let n=this.visualIndex,r=(this.isSharedViewSet()&&t.isPlaceOn(a.WORKING_SPACE_BOTTOM)&&(n+=t.sharedSize.nextSize),e.childNodes[n]);r.tagName!==this.childNodeType&&(t=this.nodesPool(),e.replaceChild(t,r),r=t),this.collectedNodes.push(r),this.visualIndex+=1}end(){}}},(e,t)=>{"use strict";t.__esModule=!0;t.WORKING_SPACE_ALL=0,t.WORKING_SPACE_TOP=1;t.WORKING_SPACE_BOTTOM=2},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,r(n(504))),o=n(502);t.default=class{constructor(){this.size=new i.default,this.workingSpace=o.WORKING_SPACE_ALL,this.sharedSize=null}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof i.default}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=o.WORKING_SPACE_TOP,e.workingSpace=o.WORKING_SPACE_BOTTOM,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=o.WORKING_SPACE_BOTTOM,e.workingSpace=o.WORKING_SPACE_TOP,this.sharedSize=e.getViewSize()}}},(e,t)=>{"use strict";t.__esModule=!0;t.default=class{constructor(){this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}},(e,t,n)=>{"use strict";var r=n(196);t.__esModule=!0;class i extends r(n(501)).default{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}t.default=i},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,r(n(507)));t.default=class{constructor(e,t){this.nodesPool="string"==typeof e?new i.default(e):null,this.nodeType=e,this.rootNode=t,this.table=null,this.renderedNodes=0}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}},(e,t)=>{"use strict";t.__esModule=!0;t.default=class{constructor(e){this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}},(e,t,n)=>{"use strict";var r=n(196),s=(t.__esModule=!0,n(302));class i extends r(n(506)).default{constructor(e){super(null,e)}adjust(){var{columnHeadersCount:n,rowHeadersCount:e}=this.table;let r=this.rootNode.firstChild;if(n){var t=this.table["columnsToRender"],i=t+e;for(let e=0,t=n;e<t;e++){for((r=this.rootNode.childNodes[e])||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<i;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)r.removeChild(r.lastChild),--this.renderedNodes}var o=this.rootNode.childNodes.length;if(n<o)for(let e=n;e<o;e++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&(0,s.empty)(r)}render(){var e=this.table["columnHeadersCount"];for(let t=0;t<e;t+=1){var{columnHeaderFunctions:n,columnsToRender:r,rowHeadersCount:i}=this.table,o=this.rootNode.childNodes[t];for(let e=-1*i;e<r;e+=1){var s=this.table.renderedColumnToSource(e),a=o.childNodes[e+i];a.className="",a.removeAttribute("style"),n[t](s,a,t)}}}}t.default=i},(e,t,n)=>{"use strict";var r=n(196),r=(t.__esModule=!0,r(n(506))),o=n(302);class i extends r.default{constructor(e){super(null,e)}adjust(){for(var{columnsToRender:e,rowHeadersCount:t}=this.table,n=e+t;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),--this.renderedNodes}render(){this.adjust();var{columnsToRender:t,rowHeadersCount:n}=this.table;for(let e=0;e<n;e++){var r=this.table.renderedColumnToSource(e),r=this.table.columnUtils.getHeaderWidth(r);this.rootNode.childNodes[e].style.width=r+"px"}for(let e=0;e<t;e++){var i=this.table.renderedColumnToSource(e),i=this.table.columnUtils.getStretchedColumnWidth(i);this.rootNode.childNodes[e+n].style.width=i+"px"}var e=this.rootNode.firstChild;e&&(0,o.addClass)(e,"rowHeader")}}t.default=i},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(455)),o=n(443),s=n(500),r=r(n(506));let a=!1;class l extends r.default{constructor(e){super("TR",e),this.orderView=new s.OrderView(e,e=>this.nodesPool.obtain(e),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){var t=this.table["rowsToRender"];!a&&1e3<t&&(a=!0,(0,i.warn)((0,o.toSingleLine)`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(let e=0;e<t;e++)this.orderView.render();this.orderView.end()}}t.default=l},(e,t,n)=>{"use strict";var r=n(196),c=(t.__esModule=!0,n(302)),i=n(500);class o extends r(n(506)).default{constructor(){super("TD"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new i.SharedOrderView(e,e=>this.nodesPool.obtain(this.sourceRowIndex,e),this.nodeType),this.orderViews.set(e,t)),t}render(){var{rowsToRender:t,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let e=0;e<t;e++){var o=this.table.renderedRowToSource(e),s=r.getRenderedNode(e),a=(this.sourceRowIndex=o,this.obtainOrderView(s)),s=i.obtainOrderView(s);a.prependView(s).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let e=0;e<n;e++){a.render();var l=a.getCurrentNode(),u=this.table.renderedColumnToSource(e);(0,c.hasClass)(l,"hide")||(l.className=""),l.removeAttribute("style"),l.removeAttribute("dir"),this.table.cellRenderer(o,u,l)}a.end()}}}t.default=o},(e,t)=>{"use strict";t.__esModule=!0;t.default=class{constructor(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})["cellRenderer"];this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=t}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){var{rowHeaders:e,columnHeaders:t,colGroup:n,rows:r,cells:i}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.setTable(this),t.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=n,this.rows=r,this.cells=i}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();var{rowsToRender:t,rows:n}=this;for(let e=0;e<t;e++){var r,i=n.getRenderedNode(e);i.firstChild&&(r=this.renderedRowToSource(e),r=this.rowUtils.getHeight(r),i.firstChild.style.height=r?r-1+"px":"")}}}},(e,t,n)=>{"use strict";t.__esModule=!0;var l=n(302);t.default=class{constructor(e,t){this.dataAccessObject=e,this.wtSettings=t,this.headerWidths=new Map}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){var t=this.dataAccessObject.wtViewport.columnsRenderCalculator;let n=this.getWidth(e);return n=t&&(t=t.getStretchedColumnWidth(e,n))?t:n}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight");e=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return t=void 0!==e?t?Math.max(t,e):e:t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){var e=this["wtSettings"],{wtTable:t,wtViewport:n,cloneSource:r}=this.dataAccessObject,r=(r?r.wtTable:t).holder,t=r.offsetHeight<r.scrollHeight?(0,l.getScrollbarWidth)():0,i=e.getSetting("rowHeaderWidth");if(n.columnsRenderCalculator.refreshStretching(n.getViewportWidth()-t),null!=(i=e.getSetting("onModifyRowHeaderWidth",i))){var o=e.getSetting("rowHeaders").length,s=e.getSetting("defaultColumnWidth");for(let e=0;e<o;e++){var a=null==(a=Array.isArray(i)?i[e]:i)?s:a;this.headerWidths.set(e,a)}}}}},(e,t)=>{"use strict";t.__esModule=!0;t.default=class{constructor(e,t){this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);e=this.dataAccessObject.wtViewport.oversizedRows[e];return t=void 0!==e?void 0===t?e:Math.max(t,e):t}}},(e,t,n)=>{"use strict";t.__esModule=!0;var r={getFirstRenderedRow(){var e=this.wtSettings.getSetting("totalRows"),t=this.wtSettings.getSetting("fixedRowsBottom"),n=e-t;return 0===e||0===t?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount(){return this.getRenderedRowsCount()}};(0,n(447).defineGetter)(r,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1}),t.default=r},(e,t,n)=>{"use strict";t.__esModule=!0;var r={getFirstRenderedColumn(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){var e=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),e)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()}};(0,n(447).defineGetter)(r,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1}),t.default=r},(e,t,n)=>{"use strict";var r=n(196),s=(t.__esModule=!0,n(273),r(n(467))),a=n(302),l=n(447),i=n(444),u=n(455),o=n(518),c=r(n(519));t.Overlay=class{constructor(e,t,n,r,i){(0,s.default)(this,"wtSettings",null),(0,l.defineGetter)(this,"wot",e,{writable:!1}),this.domBindings=i,this.facadeGetter=t,this.wtSettings=r;var{TABLE:e,hider:i,spreader:t,holder:r,wtRootElement:o}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=e,this.hider=i,this.spreader=t,this.holder=r,this.wtRootElement=o,this.trimmingContainer=(0,a.getTrimmingContainer)(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){var e=this.needFullRender,e=(this.needFullRender=this.shouldBeRendered(),e!==this.needFullRender);return e&&!this.needFullRender&&this.reset(),e}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=(0,a.getTrimmingContainer)(this.hider.parentNode.parentNode)}updateMainScrollableElement(){var e=this.wot["wtTable"],t=this.domBindings["rootWindow"];"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=(0,a.getScrollableElement)(e.TABLE)}getRelativeCellPosition(t,n,r){if(!1!==this.clone.wtTable.holder.contains(t)){var i=this.mainTableScrollableElement===this.domBindings.rootWindow,r=r<this.wtSettings.getSetting("fixedColumnsStart"),o=n<this.wtSettings.getSetting("fixedRowsTop"),n=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),s=this.clone.wtTable.spreader,s={start:this.getRelativeStartPosition(s),top:s.offsetTop},t={start:this.getRelativeStartPosition(t),top:t.offsetTop};let e=null;return e=i?this.getRelativeCellPositionWithinWindow(o,r,t,s):this.getRelativeCellPositionWithinHolder(o,n,r,t,s)}(0,u.warn)(`The provided element is not a child of the ${this.type} overlay`)}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,n,r){var i=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,s=0;if(t){let e=i.left;this.isRtl()&&(e=this.domBindings.rootWindow.innerWidth-(i.left+i.width+(0,a.getScrollbarWidth)())),o=e<=0?-1*e:0}else o=r.start;return s=e?this.clone.wtTable.TABLE.getBoundingClientRect().top-i.top:r.top,{start:n.start+o,top:n.top+s}}getRelativeCellPositionWithinHolder(e,t,n,r,i){const o=this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),s=this.wot.wtOverlays.topOverlay.getScrollPosition();let a=0,l=0;return n||(a=o-i.start),t?(n=this.wot.wtTable.wtRootElement.getBoundingClientRect(),t=this.clone.wtTable.TABLE.getBoundingClientRect(),l=-1*t.top+n.top):e||(l=s-i.top),{start:r.start-a,top:r.top-l}}makeClone(){if(-1===o.CLONE_TYPES.indexOf(this.type))throw new Error(`Clone type "${this.type}" is not supported.`);var e=this.wot["wtTable"],{rootDocument:t,rootWindow:n}=this.domBindings,r=t.createElement("DIV"),t=t.createElement("TABLE"),i=e.wtRootElement.parentNode,r=(r.className=o.CLONE_CLASS_NAMES.get(this.type)+" handsontable",r.setAttribute("dir",this.isRtl()?"rtl":"ltr"),r.style.position="absolute",r.style.top=0,r.style.overflow="visible",this.isRtl()?r.style.right=0:r.style.left=0,t.className=e.TABLE.className,r.appendChild(t),i.appendChild(r),this.wtSettings.getSetting("preventOverflow"));return!0===r||"horizontal"===r&&this.type===o.CLONE_TOP||"vertical"===r&&this.type===o.CLONE_INLINE_START?this.mainTableScrollableElement=n:"hidden"===n.getComputedStyle(i).getPropertyValue("overflow")?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=(0,a.getScrollableElement)(e.TABLE),new c.default(t,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}refresh(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}reset(){var e,t,n;this.clone&&(n=this.clone.wtTable.holder,t=this.clone.wtTable.hider,e=n.style,t=t.style,n=n.parentNode.style,(0,i.arrayEach)([e,t,n],e=>{e.width="",e.height=""}))}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}},(e,t)=>{"use strict";t.__esModule=!0;var n="bottom",r="inline_start",i="top_inline_start_corner",o="bottom_inline_start_corner",s=[t.CLONE_TOP="top",t.CLONE_BOTTOM=n,t.CLONE_INLINE_START=r,t.CLONE_TOP_INLINE_START_CORNER=i,t.CLONE_BOTTOM_INLINE_START_CORNER=o],s=(t.CLONE_TYPES=s,new Map([["top","ht_clone_top"],[n,"ht_clone_bottom"],[r,`ht_clone_${r} ht_clone_left`],[i,`ht_clone_${i} ht_clone_top_left_corner`],[o,`ht_clone_${o} ht_clone_bottom_left_corner`]]));t.CLONE_CLASS_NAMES=s},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,r(n(467))),o=r(n(489));class s extends r(n(520)).default{constructor(e,t,n){super(e,t),(0,i.default)(this,"cloneSource",void 0),(0,i.default)(this,"cloneOverlay",void 0);e=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),e,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selections=n.selections,this.wtEvent=new o.default(e,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selections,n.event),this.findOriginalHeaders()}}t.default=s},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),r(n(467))),o=n(302),s=n(303),a=r(n(457)),l=r(n(521)),u=r(n(485)),c=r(n(486));t.default=class{get eventManager(){return new a.default(this)}constructor(e,t){(0,i.default)(this,"wtTable",void 0),(0,i.default)(this,"wtScroll",void 0),(0,i.default)(this,"wtViewport",void 0),(0,i.default)(this,"wtOverlays",void 0),(0,i.default)(this,"selections",void 0),(0,i.default)(this,"wtEvent",void 0),(0,i.default)(this,"guid","wt_"+(0,s.randomString)()),(0,i.default)(this,"drawInterrupted",!1),(0,i.default)(this,"drawn",!1),(0,i.default)(this,"domBindings",void 0),(0,i.default)(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new l.default(this.createScrollDao())}findOriginalHeaders(){const n=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let e=0,t=this.wtTable.THEAD.childNodes[0].childNodes.length;e<t;e++)n.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,t){(0,o.fastInnerText)(t,n[e])}])}}createCellCoords(e,t){return new u.default(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,n){return new c.default(e,t,n,this.wtSettings.getSetting("rtlMode"))}draw(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,e||this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(1<arguments.length&&void 0!==arguments[1]&&arguments[1]){var t=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),r=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<n&&e.col<i)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<i&&e.row>=t-r){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<i)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<t&&e.row>=t-r&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}}return this.wtTable.getCell(e)}scrollViewport(e,t,n,r,i){return!(e.col<0||e.row<0)&&this.wtScroll.scrollViewport(e,t,n,r,i)}scrollViewportHorizontally(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportHorizontally(e,t,n)}scrollViewportVertically(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportVertically(e,t,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selections(){return t.selections},get drawn(){return t.drawn},set drawn(e){t.drawn=e},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count}}}}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,r(n(467))),d=n(302);t.default=class{constructor(e){(0,i.default)(this,"dataAccessObject",void 0),(0,i.default)(this,"lastScrolledColumnPos",-1),(0,i.default)(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,t,n,r,i){n=this.scrollViewportHorizontally(e.col,n,i),i=this.scrollViewportVertically(e.row,t,r);return n||i}scrollViewportHorizontally(e,t,n){var{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r||!Number.isInteger(e)||e<0||i<e)return!1;var r=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn(),n=void 0===t&&void 0===n,{fixedColumnsStart:o,inlineStartOverlay:s}=this.dataAccessObject;if(n&&e<o)return!1;let a=!1;return-1===r?a=s.scrollTo(e,n?e>this.lastScrolledColumnPos:t):(n&&(e<r||i<e)||!n)&&(a=s.scrollTo(e,n?i<e:t)),a&&(this.lastScrolledColumnPos=e),a}scrollViewportVertically(e,t,n){var{drawn:r,totalRows:i}=this.dataAccessObject;if(!r||!Number.isInteger(e)||e<0||i<e)return!1;var r=this.getFirstVisibleRow(),o=this.getLastVisibleRow(),t=void 0===t&&void 0===n,{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject;if(t&&(e<a||i-s-1<e))return!1;let u=!1;return-1===r?u=l.scrollTo(e,t?e>this.lastScrolledRowPos:n):(t&&(e<r||o<e)||!t)&&(u=l.scrollTo(e,t?o<e:n)),u&&(this.lastScrolledRowPos=e),u}getFirstVisibleRow(){var{topOverlay:n,wtTable:e,wtViewport:r,totalRows:i,fixedRowsTop:o,rootWindow:t}=this.dataAccessObject;let s=e.getFirstVisibleRow();if(n.mainTableScrollableElement===t){var a=(0,d.offset)(e.wtRootElement),l=(0,d.innerHeight)(e.hider),e=(0,d.innerHeight)(t),u=(0,d.getScrollTop)(t,t);if(a.top+l-e<=u){let t=r.getColumnHeaderHeight();t+=n.sumCellSizes(0,o);for(let e=i;0<e;e--)if(t+=n.sumCellSizes(e-1,e),a.top+l-t<=u){s=e;break}}}return s}getLastVisibleRow(){var{topOverlay:n,wtTable:e,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;let s=e.getLastVisibleRow();if(n.mainTableScrollableElement===o){var a=(0,d.offset)(e.wtRootElement),l=(0,d.getScrollTop)(o,o);if(a.top>l){var u=(0,d.innerHeight)(o);let t=r.getColumnHeaderHeight();for(let e=1;e<=i;e++)if(t+=n.sumCellSizes(e-1,e),a.top+t-l>=u){s=e-2;break}}}return s}getFirstVisibleColumn(){var{inlineStartOverlay:n,wtTable:e,wtViewport:r,totalColumns:i,rootWindow:t}=this.dataAccessObject;let o=e.getFirstVisibleColumn();if(n.mainTableScrollableElement===t){var s=(0,d.offset)(e.wtRootElement),a=(0,d.innerWidth)(e.hider),e=(0,d.innerWidth)(t),l=Math.abs((0,d.getScrollLeft)(t,t));if(s.left+a-e<=l){let t=r.getRowHeaderWidth();for(let e=i;0<e;e--)if(t+=n.sumCellSizes(e-1,e),s.left+a-t<=l){o=e;break}}}return o}getLastVisibleColumn(){var{wtSettings:e,inlineStartOverlay:r,wtTable:t,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;let a=t.getLastVisibleColumn();if(r.mainTableScrollableElement===s){var l,e=e.getSetting("rtlMode");let n=null;n=e?(e=t.TABLE.getBoundingClientRect(),l=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth,Math.abs(e.right-l)):(0,d.offset)(t.wtRootElement).left;var u=Math.abs((0,d.getScrollLeft)(s,s));if(n>u){var c=(0,d.innerWidth)(s);let t=i.getRowHeaderWidth();for(let e=1;e<=o;e++)if(t+=r.sumCellSizes(e-1,e),n+t-u>=c){a=e-2;break}}}return a}}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(273),r(n(467))),a=n(302),o=r(n(523)),r=n(517),s=n(518);class l extends r.Overlay{constructor(e,t,n,r){super(e,t,s.CLONE_BOTTOM,n,r),(0,i.default)(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new o.default(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var e=this.domBindings["rootWindow"],t=this.clone.wtTable.holder.parentNode;t.style.top="";let n=0;var r=this.wtSettings.getSetting("preventOverflow"),e=(this.trimmingContainer!==e||r&&"vertical"===r?(n=this.getScrollPosition(),this.repositionOverlay()):(n=this.getOverlayOffset(),t.style.bottom=n+"px"),this.adjustHeaderBordersPosition(n));return this.adjustElementsSize(),e}repositionOverlay(){var{wtTable:e,wtViewport:t}=this.wot,n=this.domBindings["rootDocument"],r=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=(0,a.getScrollbarWidth)(n)),r.style.bottom=i+"px"}setScrollPosition(e){var t=this.domBindings["rootWindow"];let n=!1;return this.mainTableScrollableElement===t?(t.scrollTo((0,a.getWindowScrollLeft)(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){var{wtTable:n,wtSettings:r}=this.wot,i=r.getSetting("defaultRowHeight");let o=e,s=0;for(;o<t;){var a=n.getRowHeight(o);s+=void 0===a?i:a,o+=1}return s}adjustElementsSize(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){var{wtTable:t,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:e}=this.domBindings,r=(0,a.getScrollbarWidth)(r),i=this.clone.wtTable.holder.parentNode.style,o=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==e||"horizontal"===o){let e=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(e-=r),e=Math.min(e,t.wtRootElement.scrollWidth),i.width=e+"px"}else i.width="";this.clone.wtTable.holder.style.width=i.width;let s=(0,a.outerHeight)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(s=0),i.height=s+"px"}adjustRootChildrenSize(){var e=this.clone.wtTable["holder"];this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){var e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){var e=this.isRtl()?"right":"left",t=this.clone.wtTable["spreader"];"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":t.style[e]=""}scrollTo(e,t){let n=this.getTableParentOffset();var r=(this.wot.cloneSource||this.wot).wtTable.holder;let i=0;t&&r.offsetHeight!==r.clientHeight&&(i=(0,a.getScrollbarWidth)(this.domBindings.rootDocument)),t?n=(n+=this.sumCellSizes(0,e+1))-this.wot.wtViewport.getViewportHeight()+1:n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=i,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,a.getScrollTop)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){var e,t=this.domBindings["rootWindow"],n=this.wtSettings.getSetting("preventOverflow");let r=0;return this.trimmingContainer!==t||n&&"vertical"===n||(n=(t=this.wot.wtTable.getTotalHeight())-this.clone.wtTable.getTotalHeight(),e=this.domBindings.rootDocument.documentElement.clientHeight,(r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-e+t,0))>n&&(r=0)),r}adjustHeaderBordersPosition(e){var t=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==t,r=this.wtSettings.getSetting("columnHeaders");let i=!1;return(n||0===t)&&0<r.length&&(n=this.wot.wtTable.holder.parentNode,t=(0,a.hasClass)(n,"innerBorderBottom"),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),i=e||0===this.wtSettings.getSetting("totalRows")?((0,a.addClass)(n,"innerBorderBottom"),!t):((0,a.removeClass)(n,"innerBorderBottom"),t)),i}}t.BottomOverlay=l},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,r(n(495))),o=r(n(515)),r=r(n(524)),s=n(447),a=n(492);class l extends i.default{constructor(e,t,n,r){super(e,t,n,r,a.CLONE_BOTTOM)}}(0,s.mixin)(l,o.default),(0,s.mixin)(l,r.default),t.default=l},(e,t,n)=>{"use strict";t.__esModule=!0;var r={getFirstRenderedColumn(){var e=this.dataAccessObject.startColumnRendered;return null===e?-1:e},getFirstVisibleColumn(){var e=this.dataAccessObject.startColumnVisible;return null===e?-1:e},getLastRenderedColumn(){var e=this.dataAccessObject.endColumnRendered;return null===e?-1:e},getLastVisibleColumn(){var e=this.dataAccessObject.endColumnVisible;return null===e?-1:e},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible}};(0,n(447).defineGetter)(r,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1}),t.default=r},(e,t,n)=>{"use strict";var r=n(196),s=(t.__esModule=!0,n(273),n(302)),i=r(n(526)),r=n(517),o=n(518);class a extends r.Overlay{constructor(e,t,n,r){super(e,t,o.CLONE_INLINE_START,n,r)}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new i.default(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){var e=this.wot["wtTable"];if(!this.needFullRender||!e.holder.parentNode)return!1;var e=this.domBindings["rootWindow"],t=this.clone.wtTable.holder.parentNode,n=this.wtSettings.getSetting("preventOverflow");let r=0;this.trimmingContainer!==e||n&&"horizontal"===n?(r=this.getScrollPosition(),(0,s.resetCssTransform)(t)):(r=this.getOverlayOffset()*(this.isRtl()?-1:1),(0,s.setOverlayPosition)(t,r+"px","0px"));e=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),e}setScrollPosition(e){var t=this.domBindings["rootWindow"];let n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,(0,s.getWindowScrollTop)(t)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){var n=this.wtSettings.getSetting("defaultColumnWidth");let r=e,i=0;for(;r<t;)i+=this.wot.wtTable.getStretchedColumnWidth(r)||n,r+=1;return i}adjustElementsSize(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){var t=this.wot["wtTable"],{rootDocument:n,rootWindow:e}=this.domBindings,n=(0,s.getScrollbarWidth)(n),r=this.clone.wtTable.holder.parentNode.style,i=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==e||"vertical"===i){let e=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(e-=n),e=Math.min(e,t.wtRootElement.scrollHeight),r.height=e+"px"}else r.height="";this.clone.wtTable.holder.style.height=r.height;e=(0,s.outerWidth)(this.clone.wtTable.TABLE);r.width=e+"px"}adjustRootChildrenSize(){var e=this.clone.wtTable["holder"],t=this.wot["selections"],n=this.facadeGetter(),n=Math.abs(null!=(t=null==t?void 0:t.getCell().getBorder(n).cornerCenterPointOffset)?t:0);this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=parseInt(e.parentNode.style.width,10)+n+"px"}applyToDOM(){var e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[t]=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[t]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px":this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){let n=this.getTableParentOffset();var r,i=(this.wot.cloneSource||this.wot).wtTable.holder;let o=0;return(t=t&&(r=this.wot.wtTable.getColumnWidth(e),this.wot.wtViewport.getViewportWidth()<r)?!1:t)&&i.offsetWidth!==i.clientWidth&&(o=(0,s.getScrollbarWidth)(this.domBindings.rootDocument)),t?n=(n+=this.sumCellSizes(0,e+1))-this.wot.wtViewport.getViewportWidth():n+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),n+=o,this.setScrollPosition(n)}getTableParentOffset(){var e=this.wtSettings.getSetting("preventOverflow");let t=0;return t=e||this.trimmingContainer!==this.domBindings.rootWindow?t:this.wot.wtTable.holderOffset.left}getScrollPosition(){return Math.abs((0,s.getScrollLeft)(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){var e=this.domBindings["rootWindow"],t=this.wtSettings.getSetting("preventOverflow");let n=0;return this.trimmingContainer!==e||t&&"horizontal"===t||(n=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),e=this.wot.wtTable.getTotalWidth(),t=this.clone.wtTable.getTotalWidth(),n>e-t&&(n=0)),n}adjustHeaderBordersPosition(e){var t=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("rowHeaders"),r=this.wtSettings.getSetting("fixedColumnsStart");(this.wtSettings.getSetting("totalRows")?(0,s.removeClass):(0,s.addClass))(t,"emptyRows");let i=!1;return r&&!n.length?(0,s.addClass)(t,"innerBorderLeft innerBorderInlineStart"):!r&&n.length&&(r=(0,s.hasClass)(t,"innerBorderInlineStart"),i=e?((0,s.addClass)(t,"innerBorderLeft innerBorderInlineStart"),!r):((0,s.removeClass)(t,"innerBorderLeft innerBorderInlineStart"),r)),i}}t.InlineStartOverlay=a},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,r(n(495))),o=r(n(527)),r=r(n(516)),s=n(447),a=n(492);class l extends i.default{constructor(e,t,n,r){super(e,t,n,r,a.CLONE_INLINE_START)}}(0,s.mixin)(l,o.default),(0,s.mixin)(l,r.default),t.default=l},(e,t,n)=>{"use strict";t.__esModule=!0;var r={getFirstRenderedRow(){var e=this.dataAccessObject.startRowRendered;return null===e?-1:e},getFirstVisibleRow(){var e=this.dataAccessObject.startRowVisible;return null===e?-1:e},getLastRenderedRow(){var e=this.dataAccessObject.endRowRendered;return null===e?-1:e},getLastVisibleRow(){var e=this.dataAccessObject.endRowVisible;return null===e?-1:e},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible}};(0,n(447).defineGetter)(r,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1}),t.default=r},(e,t,n)=>{"use strict";var r=n(196),s=(t.__esModule=!0,r(n(467))),i=n(302),o=r(n(529)),r=n(517),a=n(518);class l extends r.Overlay{constructor(e,t,n,r,i,o){super(e,t,a.CLONE_TOP_INLINE_START_CORNER,n,r),(0,s.default)(this,"topOverlay",void 0),(0,s.default)(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new o.default(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var t,n=this.clone.wtTable.holder.parentNode;this.trimmingContainer===this.domBindings.rootWindow?(r=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),t=this.topOverlay.getOverlayOffset(),(0,i.setOverlayPosition)(n,r+"px",t+"px")):(0,i.resetCssTransform)(n);let e=(0,i.outerHeight)(this.clone.wtTable.TABLE);var r=(0,i.outerWidth)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(e=0),n.style.height=e+"px",n.style.width=r+"px"}return!1}}t.TopInlineStartCornerOverlay=l},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,r(n(495))),o=r(n(530)),r=r(n(516)),s=n(447),a=n(492);class l extends i.default{constructor(e,t,n,r){super(e,t,n,r,a.CLONE_TOP_INLINE_START_CORNER)}}(0,s.mixin)(l,o.default),(0,s.mixin)(l,r.default),t.default=l},(e,t,n)=>{"use strict";t.__esModule=!0;var r={getFirstRenderedRow(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),e)},getVisibleRowsCount(){return this.getRenderedRowsCount()}};(0,n(447).defineGetter)(r,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1}),t.default=r},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(273),r(n(467))),l=n(302),o=r(n(532)),r=n(517),s=n(518);class a extends r.Overlay{constructor(e,t,n,r){super(e,t,s.CLONE_TOP,n,r),(0,i.default)(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new o.default(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var e=this.clone.wtTable.holder.parentNode,t=this.domBindings["rootWindow"],n=this.wtSettings.getSetting("preventOverflow");let r=0,i=!1;this.trimmingContainer!==t||n&&"vertical"===n?(r=this.getScrollPosition(),(0,l.resetCssTransform)(e)):(t=this.wot["wtTable"],n=t.hider.getBoundingClientRect(),t=Math.ceil(n.bottom),n=e.offsetHeight,i=t===n,r=this.getOverlayOffset(),(0,l.setOverlayPosition)(e,"0px",r+"px"));t=this.adjustHeaderBordersPosition(r,i);return this.adjustElementsSize(),t}setScrollPosition(e){var t=this.domBindings.rootWindow;let n=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo((0,l.getWindowScrollLeft)(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){var n=this.wtSettings.getSetting("defaultRowHeight");let r=e,i=0;for(;r<t;){var o=this.wot.wtTable.getRowHeight(r);i+=void 0===o?n:o,r+=1}return i}adjustElementsSize(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){var t=this.wot["wtTable"],{rootDocument:n,rootWindow:e}=this.domBindings,n=(0,l.getScrollbarWidth)(n),r=this.clone.wtTable.holder.parentNode.style,i=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==e||"horizontal"===i){let e=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(e-=n),e=Math.min(e,t.wtRootElement.scrollWidth),r.width=e+"px"}else r.width="";this.clone.wtTable.holder.style.width=r.width;let o=(0,l.outerHeight)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(o=0),r.height=o+"px"}adjustRootChildrenSize(){var e=this.clone.wtTable["holder"],t=this.wot["selections"],n=this.facadeGetter(),n=Math.abs(null!=(t=null==t?void 0:t.getCell().getBorder(n).cornerCenterPointOffset)?t:0);this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=parseInt(e.parentNode.style.height,10)+n+"px"}applyToDOM(){var e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){var e=this.isRtl()?"right":"left",t=this.clone.wtTable["spreader"];"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":t.style[e]=""}scrollTo(e,t){var n,{wot:r,wtSettings:i}=this,o=(r.cloneSource||r).wtTable.holder;let s=this.getTableParentOffset(),a=0;return(t=t&&(n=this.wot.wtTable.getRowHeight(e),this.wot.wtViewport.getViewportHeight()<n)?!1:t)&&o.offsetHeight!==o.clientHeight&&(a=(0,l.getScrollbarWidth)(this.domBindings.rootDocument)),t?(n=i.getSetting("fixedRowsBottom"),o=i.getSetting("totalRows"),s=(s+=this.sumCellSizes(0,e+1))-(r.wtViewport.getViewportHeight()-this.sumCellSizes(o-n,o))+1):s+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e),s+=a,this.setScrollPosition(s)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,l.getScrollTop)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){var e=this.domBindings["rootWindow"],t=this.wtSettings.getSetting("preventOverflow");let n=0;return this.trimmingContainer!==e||t&&"vertical"===t||(e=this.wot.wtTable.getTotalHeight()-this.clone.wtTable.getTotalHeight(),(n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>e&&(n=0)),n}adjustHeaderBordersPosition(e){var t,n,r=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=this.wot.wtTable.holder.parentNode;(this.wtSettings.getSetting("totalColumns")?(0,l.removeClass):(0,l.addClass))(i,"emptyColumns");let o=!1;return r||(r=this.wtSettings.getSetting("fixedRowsTop"),n=this.cachedFixedRowsTop!==r,t=this.wtSettings.getSetting("columnHeaders"),(n||0===r)&&0<t.length&&(n=(0,l.hasClass)(i,"innerBorderTop"),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),o=e||0===this.wtSettings.getSetting("totalRows")?((0,l.addClass)(i,"innerBorderTop"),!n):((0,l.removeClass)(i,"innerBorderTop"),n))),o}}t.TopOverlay=a},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,r(n(495))),o=r(n(530)),r=r(n(524)),s=n(447),a=n(492);class l extends i.default{constructor(e,t,n,r){super(e,t,n,r,a.CLONE_TOP)}}(0,s.mixin)(l,o.default),(0,s.mixin)(l,r.default),t.default=l},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(273),r(n(467))),o=n(302),s=n(447);t.default=class{constructor(n){(0,i.default)(this,"settings",{}),(0,i.default)(this,"defaults",Object.freeze(this.getDefaults())),(0,s.objectEach)(this.defaults,(e,t)=>{if(void 0!==n[t])this.settings[t]=n[t];else{if(void 0===e)throw new Error(`A required setting "${t}" was not provided`);this.settings[t]=e}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>0<this.getSetting("fixedColumnsStart")||0<this.getSetting("rowHeaders").length,shouldRenderTopOverlay:()=>0<this.getSetting("fixedRowsTop")||0<this.getSetting("columnHeaders").length,shouldRenderBottomOverlay:()=>0<this.getSetting("fixedRowsBottom"),minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,n)=>{e=this.getSetting("data",e,t);(0,o.fastInnerText)(n,null==e?"":e)},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}update(e,t){return void 0===t?(0,s.objectEach)(e,(e,t)=>{this.settings[t]=e}):this.settings[e]=t,this}getSetting(e,t,n,r,i){return"function"==typeof this.settings[e]?this.settings[e](t,n,r,i):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}},(e,t,n)=>{"use strict";var r=n(196),c=(t.__esModule=!0,n(302)),i=r(n(495)),o=r(n(527)),r=r(n(524)),n=n(447);class s extends i.default{constructor(e,t,n,r){super(e,t,n,r,"master")}alignOverlaysWithTrimmingContainer(){var n=(0,c.getTrimmingContainer)(this.wtRootElement),r=this.domBindings["rootWindow"];if(n===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{var i=n.parentElement,o=(0,c.getStyle)(n,"height",r),s=(0,c.getStyle)(n,"overflow",r),a=this.holder.style,{scrollWidth:l,scrollHeight:u}=n;let{width:e,height:t}=n.getBoundingClientRect();i&&["auto","hidden","scroll"].includes(s)&&((s=n.cloneNode(!1)).style.overflow="auto",s.style.position="absolute",n.nextElementSibling?i.insertBefore(s,n.nextElementSibling):i.appendChild(s),n=parseInt((0,c.getComputedStyle)(s,r).height,10),i.removeChild(s),0===n)&&(t=0),t=Math.min(t,u),a.height="auto"===o?"auto":t+"px",e=Math.min(e,l),a.width=e+"px",a.overflow="",this.hasTableHeight="auto"===a.height||0<t,this.hasTableWidth=0<e}this.isTableVisible=(0,c.isVisible)(this.TABLE)}markOversizedColumnHeaders(){var e=this["wtSettings"],t=this.dataAccessObject["wtViewport"],n=e.getSetting("columnHeaders").length;if(n&&!t.hasOversizedColumnHeadersMarked.master){var r=e.getSetting("rowHeaders").length,i=this.getRenderedColumnsCount();for(let e=0;e<n;e++)for(let e=-1*r;e<i;e++)this.markIfOversizedColumnHeader(e);t.hasOversizedColumnHeadersMarked.master=!0}}}(0,n.mixin)(s,o.default),(0,n.mixin)(s,r.default),t.default=s},(e,t,n)=>{"use strict";t.__esModule=!0;var c=n(302),r=n(447),d=n(536);t.default=class{constructor(e,t,n,r,i){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){var e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return n=t===this.domBindings.rootWindow?e.documentElement.clientHeight:0<(0,c.outerHeight)(t)&&0<t.clientHeight?t.clientHeight:1/0}getWorkspaceWidth(){var e=this["wtSettings"],{rootDocument:t,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer,i=t.documentElement.offsetWidth,o=e.getSetting("totalColumns"),s=e.getSetting("preventOverflow"),a=e.getSetting("rtlMode"),l=this.wtTable.TABLE.getBoundingClientRect(),a=i-(a?l.right-i:l.left);let u;return s?(0,c.outerWidth)(this.wtTable.wtRootElement):(u=e.getSetting("freezeOverlays")?Math.min(a,i):Math.min(this.getContainerFillWidth(),a,i),r===n&&0<o&&this.sumColumnWidths(0,o-1)>u?t.documentElement.clientWidth:r===n||"scroll"!==(l=(0,c.getStyle)(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",n))&&"hidden"!==l&&"auto"!==l?"none"!==(s=e.getSetting("stretchH"))&&s?u:Math.max(u,(0,c.outerWidth)(this.wtTable.TABLE)):Math.max(u,r.clientWidth))}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let n=0,r=e;for(;r<t;)n+=this.wtTable.getColumnWidth(r),r+=1;return n}getContainerFillWidth(){var e,t,n;return this.containerWidth||(e=this.wtTable.holder,(t=this.domBindings.rootDocument.createElement("div")).style.width="100%",t.style.height="1px",e.appendChild(t),n=t.offsetWidth,this.containerWidth=n,e.removeChild(t),n)}getWorkspaceOffset(){return(0,c.offset)(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=(0,c.outerHeight)(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();var t;return e!==1/0&&0<(t=this.getColumnHeaderHeight())&&(e-=t),e}getRowHeaderWidth(){var n=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(n)for(let e=this.rowHeaderWidth=0,t=r.length;e<t;e++)this.rowHeaderWidth+=n[e]||n;if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");for(let e=this.rowHeaderWidth=0,t=r.length;e<t;e++)n?(this.rowHeaderWidth+=(0,c.outerWidth)(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){var e,t=this.getWorkspaceWidth();return t!==1/0&&0<(e=this.getRowHeaderWidth())?t-e:t}createRowsCalculator(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:d.RENDER_TYPE;const{wtSettings:t,wtTable:n}=this;let r,i,o,s=(this.rowHeaderWidth=NaN,r=t.getSetting("renderAllRows")&&e===d.RENDER_TYPE?1/0:this.getViewportHeight(),this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset);var a=t.getSetting("fixedRowsTop"),l=t.getSetting("fixedRowsBottom"),u=t.getSetting("totalRows");return a&&0<=s&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,a),s+=o,r-=o),l&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(u-l,u),r-=o),i=n.holder.clientHeight===n.holder.offsetHeight?0:(0,c.getScrollbarWidth)(this.domBindings.rootDocument),new d.ViewportRowsCalculator({viewportSize:r,scrollOffset:s,totalItems:t.getSetting("totalRows"),itemSizeFn:e=>n.getRowHeight(e),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,scrollbarHeight:i})}createColumnsCalculator(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:d.RENDER_TYPE;const{wtSettings:n,wtTable:t}=this;let r=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var o=n.getSetting("fixedColumnsStart");return o&&0<=i&&(o=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o),i+=o,r-=o),t.holder.clientWidth!==t.holder.offsetWidth&&(r-=(0,c.getScrollbarWidth)(this.domBindings.rootDocument)),new d.ViewportColumnsCalculator({viewportSize:r,scrollOffset:i,totalItems:n.getSetting("totalColumns"),itemSizeFn:e=>t.getColumnWidth(e),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:(e,t)=>n.getSetting("onBeforeStretchingColumnWidth",e,t),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){var e,t;let n=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return n&&(e=this.createRowsCalculator(d.FULLY_VISIBLE_TYPE),t=this.createColumnsCalculator(d.FULLY_VISIBLE_TYPE),this.areAllProposedVisibleRowsAlreadyRendered(e)&&this.areAllProposedVisibleColumnsAlreadyRendered(t)||(n=!1)),n||(this.rowsRenderCalculator=this.createRowsCalculator(d.RENDER_TYPE),this.columnsRenderCalculator=this.createColumnsCalculator(d.RENDER_TYPE)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(d.FULLY_VISIBLE_TYPE),this.columnsVisibleCalculator=this.createColumnsCalculator(d.FULLY_VISIBLE_TYPE)}areAllProposedVisibleRowsAlreadyRendered(e){var t,n,r;return!(!this.rowsVisibleCalculator||({startRow:e,endRow:t,isVisibleInTrimmingContainer:n}=e,null===e&&null===t?n:({startRow:n,endRow:r}=this.rowsRenderCalculator,e<n||e===n&&0<e||r<t||t===r&&t<this.wtSettings.getSetting("totalRows")-1)))}areAllProposedVisibleColumnsAlreadyRendered(e){var t,n,r;return!(!this.columnsVisibleCalculator||({startColumn:e,endColumn:t,isVisibleInTrimmingContainer:n}=e,null===e&&null===t?n:({startColumn:n,endColumn:r}=this.columnsRenderCalculator,e<n||e===n&&0<e||r<t||t===r&&t<this.wtSettings.getSetting("totalColumns")-1)))}resetHasOversizedColumnHeadersMarked(){(0,r.objectEach)(this.hasOversizedColumnHeadersMarked,(e,t,n)=>{n[t]=void 0})}}},(e,t,n)=>{"use strict";var r=n(196),i={ViewportColumnsCalculator:t.__esModule=!0,ViewportRowsCalculator:!0},o=r(n(477)),o=(t.ViewportColumnsCalculator=o.default,r(n(484))),s=(t.ViewportRowsCalculator=o.default,n(483));Object.keys(s).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(i,e)||e in t&&t[e]===s[e]||(t[e]=s[e])})},(e,t,n)=>{"use strict";var r=n(196),R=(t.__esModule=!0,n(203),n(302)),i=r(n(538));t.default=class{constructor(e,t){this.settings=e,this.cellRange=t||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}getBorder(e){return this.instanceBorders[e.guid]||(this.instanceBorders[e.guid]=new i.default(e,this.settings)),this.instanceBorders[e.guid]}isEmpty(){return null===this.cellRange}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){var e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}addClassAtCoords(t,e,n,r){var i=4<arguments.length&&void 0!==arguments[4]&&arguments[4],t=t.wtTable.getCell(this.settings.createCellCoords(e,n));if("object"==typeof t){let e=r;i&&(e=this.classNameGenerator(t),this.classNames.includes(e)||this.classNames.push(e)),(0,R.addClass)(t,e)}return this}linearClassNameGenerator(i,o){return function e(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;if(0===o||0===n)return i;n=0<=n?n:o;let r=i;return--n,r=(0,R.hasClass)(t,0==n?i:i+"-"+n)?i+"-"+(1+n):e(t,n)}}draw(i){if(this.isEmpty())this.settings.border&&this.getBorder(i).disappear();else{var t=i.wtTable.getRenderedRowsCount(),n=i.wtTable.getRenderedColumnsCount(),e=this.getCorners(),[o,s,a,l]=e,{highlightHeaderClassName:u,highlightColumnClassName:c,highlightRowClassName:d,highlightOnlyClosestHeader:h,selectionType:f}=this.settings,p=void 0===f||["active-header","header"].includes(f);if(p&&null!==s&&null!==l){let r=0;for(let e=0;e<n;e+=1){var g=i.wtTable.columnFilter.renderedToSource(e);if(s<=g&&g<=l){let n=i.wtTable.getColumnHeaders(g);var m=n.length-1;h&&1<n.length&&(n=[n[m]]);for(let t=0;t<n.length;t+=1){var y=[];let e=n[t];u&&y.push(u),c&&y.push(c),t=h?m:t;var v=i.getSetting("onBeforeHighlightingColumnHeader",g,t,{selectionType:f,columnCursor:r,selectionWidth:l-s+1,classNames:y});v!==g&&(e=i.wtTable.getColumnHeader(v,t)),(0,R.addClass)(e,y)}r+=1}}}if(null!==o&&null!==a){let r=0;for(let e=0;e<t;e+=1){var b=i.wtTable.rowFilter.renderedToSource(e);if(p&&o<=b&&b<=a){let n=i.wtTable.getRowHeaders(b);var E=n.length-1;h&&1<n.length&&(n=[n[E]]);for(let t=0;t<n.length;t+=1){var C=[];let e=n[t];u&&C.push(u),d&&C.push(d),t=h?E:t;var w=i.getSetting("onBeforeHighlightingRowHeader",b,t,{selectionType:f,rowCursor:r,selectionHeight:a-o+1,classNames:C});w!==b&&(e=i.wtTable.getRowHeader(w,t)),(0,R.addClass)(e,C)}r+=1}if(null!==s&&null!==l)for(let e=0;e<n;e+=1){var S=i.wtTable.columnFilter.renderedToSource(e),T=(o<=b&&b<=a&&s<=S&&S<=l?this.settings.className&&this.addClassAtCoords(i,b,S,this.settings.className,this.settings.markIntersections):o<=b&&b<=a?d&&this.addClassAtCoords(i,b,S,d):s<=S&&S<=l&&c&&this.addClassAtCoords(i,b,S,c),i.getSetting("onAfterDrawSelection",b,S,this.settings.layerLevel));"string"==typeof T&&this.addClassAtCoords(i,b,S,T)}}}i.getSetting("onBeforeDrawBorders",e,this.settings.className),this.settings.border&&this.getBorder(i).appear(e)}}destroy(){Object.values(this.instanceBorders).forEach(e=>e.destroy())}}},(e,t,n)=>{"use strict";t.__esModule=!0;var R=n(302),s=n(452),r=n(447),A=n(446);t.default=class{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){var e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,e=this.main.childNodes.length;t<e;t++){var n=this.main.childNodes[t];this.eventManager.addEventListener(n,"mouseenter",e=>this.onMouseEnter(e,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){e.preventDefault(),(0,s.stopImmediatePropagation)(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none",this.eventManager.addEventListener(i,"mousemove",function e(t){(t.clientY<Math.floor(o.top)||t.clientY>Math.ceil(o.top+o.height)||t.clientX<Math.floor(o.left)||t.clientX>Math.ceil(o.left+o.width))&&(r.eventManager.removeEventListener(i,"mousemove",e),n.style.display="block")})}}createBorders(t){var n=this.wot["rootDocument"],r=(this.main=n.createElement("div"),["top","start","bottom","end","corner"]);let i=this.main.style;i.position="absolute",i.top=0;for(let e=i.left=0;e<5;e++){var o=r[e],s=n.createElement("div");s.className="wtBorder "+(this.settings.className||""),this.settings[o]&&this.settings[o].hide&&(s.className+=" hidden"),(i=s.style).backgroundColor=(this.settings[o]&&this.settings[o].color?this.settings[o]:t.border).color,i.height=this.settings[o]&&this.settings[o].width?this.settings[o].width+"px":t.border.width+"px",i.width=this.settings[o]&&this.settings[o].width?this.settings[o].width+"px":t.border.width+"px",this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),(0,A.isMobileBrowser)()&&this.createMultipleSelectorHandles(),this.disappear();var e=this.wot["wtTable"];let a=e.bordersHolder;a||((a=n.createElement("div")).className="htBorders",e.bordersHolder=a,e.spreader.appendChild(a)),a.appendChild(this.main)}createMultipleSelectorHandles(){var e=this.wot["rootDocument"],e=(this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")},this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style},{position:"absolute",height:"40px",width:"40px","border-radius":parseInt(40/1.5,10)+"px"}),e=((0,r.objectEach)(e,(e,t)=>{this.selectionHandles.styles.bottomHitArea[t]=e,this.selectionHandles.styles.topHitArea[t]=e}),{position:"absolute",height:"10px",width:"10px","border-radius":parseInt(10/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"});(0,r.objectEach)(e,(e,t)=>{this.selectionHandles.styles.bottom[t]=e,this.selectionHandles.styles.top[t]=e}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){var n=this.wot.selections.createOrGetArea();return!(!n.cellRange||e===n.cellRange.to.row&&t===n.cellRange.to.col)}updateMultipleSelectionHandlesPosition(e,t,n,r,i,o){var s=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:a,topHitArea:l,bottom:u,bottomHitArea:c}=this.selectionHandles.styles,d=parseInt(a.borderWidth,10),h=parseInt(a.width,10),f=parseInt(l.width,10),p=this.wot.wtTable.getWidth(),g=this.wot.wtTable.getHeight(),m=(a.top=parseInt(n-h-1,10)+"px",a[s]=parseInt(r-h-1,10)+"px",l.top=parseInt(n-f/4*3,10)+"px",l[s]=parseInt(r-f/4*3,10)+"px",Math.min(parseInt(r+i,10),p-h-2*d)),r=Math.min(parseInt(r+i-f/4,10),p-f-2*d),i=(u[s]=m+"px",c[s]=r+"px",Math.min(parseInt(n+o,10),g-h-2*d)),p=Math.min(parseInt(n+o-f/4,10),g-f-2*d);u.top=i+"px",c.top=p+"px",this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(a.display="block",l.display="block",this.isPartRange(e,t)?(u.display="none",c.display="none"):(u.display="block",c.display="block")):(a.display="none",u.display="none",l.display="none",c.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(a.zIndex="9999",l.zIndex="9999"):(a.zIndex="",l.zIndex="")}appear(t){if(!this.disabled){var{wtTable:p,rootDocument:g,rootWindow:m}=this.wot;let l,u,c,d,h,f;var n=p.getRenderedRowsCount();for(let e=0;e<n;e+=1){var r=p.rowFilter.renderedToSource(e);if(r>=t[0]&&r<=t[2]){l=r,h=t[0];break}}for(let e=n-1;0<=e;--e){var i=p.rowFilter.renderedToSource(e);if(i>=t[0]&&i<=t[2]){u=i;break}}var o=p.getRenderedColumnsCount();for(let e=0;e<o;e+=1){var s=p.columnFilter.renderedToSource(e);if(s>=t[1]&&s<=t[3]){c=s,f=t[1];break}}for(let e=o-1;0<=e;--e){var a=p.columnFilter.renderedToSource(e);if(a>=t[1]&&a<=t[3]){d=a;break}}if(void 0===l||void 0===c)this.disappear();else{let t=p.getCell(this.wot.createCellCoords(l,c));var y=l!==u||c!==d,v=y?p.getCell(this.wot.createCellCoords(u,d)):t,b=(0,R.offset)(t),y=y?(0,R.offset)(v):b,E=(0,R.offset)(p.TABLE),C=(0,R.outerWidth)(p.TABLE),w=b.top,b=b.left,S=this.wot.wtSettings.getSetting("rtlMode");let r=0,i=0;if(r=S?(T=(0,R.outerWidth)(t),C=m.innerWidth-E.left-C,i=b+T-y.left,m.innerWidth-b-T-C-1):(i=y.left+(0,R.outerWidth)(v)-b,b-E.left-1),this.isEntireColumnSelected(l,u)){var T=this.getDimensionsFromHeader("columns",c,d,h,E);let e=null;T&&([e,r,i]=T),e&&(t=e)}let o=w-E.top-1,s=y.top+(0,R.outerHeight)(v)-w;if(this.isEntireRowSelected(c,d)){C=this.getDimensionsFromHeader("rows",l,u,f,E);let e=null;C&&([e,o,s]=C),e&&(t=e)}b=(0,R.getComputedStyle)(t,m),T=(0<parseInt(b.borderTopWidth,10)&&(o+=1,s=0<s?s-1:0),0<parseInt(b[S?"borderRightWidth":"borderLeftWidth"],10)&&(r+=1,i=0<i?i-1:0),S?"right":"left"),y=(this.topStyle.top=o+"px",this.topStyle[T]=r+"px",this.topStyle.width=i+"px",this.topStyle.display="block",this.startStyle.top=o+"px",this.startStyle[T]=r+"px",this.startStyle.height=s+"px",this.startStyle.display="block",Math.floor(this.settings.border.width/2));this.bottomStyle.top=o+s-y+"px",this.bottomStyle[T]=r+"px",this.bottomStyle.width=i+"px",this.bottomStyle.display="block",this.endStyle.top=o+"px",this.endStyle[T]=r+i-y+"px",this.endStyle.height=s+1+"px",this.endStyle.display="block";let e=this.settings.border.cornerVisible;e="function"==typeof e?e(this.settings.layerLevel):e;w=this.wot.getSetting("onModifyGetCellCoords",u,d);let[n,a]=[u,d];if(w&&Array.isArray(w)&&([,,n,a]=w),(0,A.isMobileBrowser)()||!e||this.isPartRange(n,a))this.cornerStyle.display="none";else{this.cornerStyle.top=o+s+this.cornerCenterPointOffset-1+"px",this.cornerStyle[T]=r+i+this.cornerCenterPointOffset-1+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let n=(0,R.getTrimmingContainer)(p.TABLE);E=n===m,C=(E&&(n=g.documentElement),parseInt(this.cornerDefaultStyle.width,10)/2),b=parseInt(this.cornerDefaultStyle.height,10)/2;if(d===this.wot.getSetting("totalColumns")-1){y=E?v.getBoundingClientRect().left:v.offsetLeft;let e=!1,t=0;(e=S?(t=y-parseInt(this.cornerDefaultStyle.width,10)/2)<0:(t=y+(0,R.outerWidth)(v)+parseInt(this.cornerDefaultStyle.width,10)/2)>=(0,R.innerWidth)(n))&&(this.cornerStyle[T]=Math.floor(r+i+this.cornerCenterPointOffset-C)+"px",this.cornerStyle[S?"borderLeftWidth":"borderRightWidth"]=0)}u===this.wot.getSetting("totalRows")-1&&(E?v.getBoundingClientRect().top:v.offsetTop)+(0,R.outerHeight)(v)+parseInt(this.cornerDefaultStyle.height,10)/2>=(0,R.innerHeight)(n)&&(this.cornerStyle.top=Math.floor(o+s+this.cornerCenterPointOffset-b)+"px",this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}(0,A.isMobileBrowser)()&&this.updateMultipleSelectionHandlesPosition(u,d,o,r,i,s)}}}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,n,r,i){const o=this.wot["wtTable"];var s=o.wtRootElement.parentNode;let a=null,l=null,u=null,c=null,d=null,h=null;var f=null,p=null;switch(e){case"rows":a=function(){return o.getRowHeader(...arguments)},l=function(){return(0,R.outerHeight)(...arguments)},u="ht__selection--rows",h="top";break;case"columns":a=function(){return o.getColumnHeader(...arguments)},l=function(){return(0,R.outerWidth)(...arguments)},u="ht__selection--columns",h="left"}return!(!s.classList.contains(u)||(e=this.wot.getSetting("columnHeaders").length,f=a(t,e-r),p=a(n,e-r),!f)||!p)&&(s=(0,R.offset)(f),t=(0,R.offset)(p),f&&p&&(c=s[h]-i[h]-1,d=t[h]+l(p)-s[h]),[f,c,d])}changeBorderStyle(e,t){var n=this[e].style,t=t[e];!t||t.hide?(0,R.addClass)(this[e],"hidden"):((0,R.hasClass)(this[e],"hidden")&&(0,R.removeClass)(this[e],"hidden"),n.backgroundColor=t.color,"top"!==e&&"bottom"!==e||(n.height=t.width+"px"),"start"!==e&&"end"!==e||(n.width=t.width+"px"))}changeBorderToDefaultStyle(e){const t=1,n="#000";e=this[e].style;e.backgroundColor=n,e.width=t+"px",e.height=t+"px"}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),(t?(0,R.addClass):(0,R.removeClass))(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",(0,A.isMobileBrowser)()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}},(e,t,n)=>{"use strict";t.__esModule=!0,t.handleMouseEvent=function(e,t){var{coords:t,selection:n,controller:r,cellCoordsFactory:i}=t;s.get(e.type)({coords:t,selection:n,controller:r,cellCoordsFactory:i,isShiftKey:e.shiftKey,isLeftClick:(0,o.isLeftClick)(e)||"touchstart"===e.type,isRightClick:(0,o.isRightClick)(e)})},t.mouseDown=r,t.mouseOver=i;var o=n(452);function r(e){var{isShiftKey:e,isLeftClick:t,isRightClick:n,coords:r,selection:i,controller:o,cellCoordsFactory:s}=e,a=i.isSelected()?i.getSelectedRange().current():null,l=i.isSelectedByCorner(),u=i.isSelectedByRowHeader();e&&a?0<=r.row&&0<=r.col&&!o.cell?i.setRangeEnd(r):(l||u)&&0<=r.row&&0<=r.col&&!o.cell?i.setRangeEnd(s(r.row,r.col)):l&&r.row<0&&!o.column?i.setRangeEnd(s(a.to.row,r.col)):u&&r.col<0&&!o.row?i.setRangeEnd(s(r.row,a.to.col)):(!l&&!u&&r.col<0||l&&r.col<0)&&!o.row?i.selectRows(Math.max(a.from.row,0),r.row,r.col):(!l&&!u&&r.row<0||u&&r.row<0)&&!o.column&&i.selectColumns(Math.max(a.from.col,0),r.col,r.row):(e=!i.inInSelection(r),s=t||n&&e,r.row<0&&0<=r.col&&!o.column?s&&i.selectColumns(r.col,r.col,r.row):r.col<0&&0<=r.row&&!o.row?s&&i.selectRows(r.row,r.row,r.col):0<=r.col&&0<=r.row&&!o.cell?s&&i.setRangeStart(r):r.col<0&&r.row<0&&i.selectAll(!0,!0))}function i(e){var t,n,r,{isLeftClick:e,coords:i,selection:o,controller:s,cellCoordsFactory:a}=e;e&&(e=o.isSelectedByRowHeader(),t=o.isSelectedByColumnHeader(),n=o.tableProps.countCols(),r=o.tableProps.countRows(),t&&!s.column?o.setRangeEnd(a(r-1,i.col)):e&&!s.row?o.setRangeEnd(a(i.row,n-1)):s.cell||o.setRangeEnd(i))}const s=new Map([["mousedown",r],["mouseover",i],["touchstart",r]])},(e,t)=>{"use strict";t.__esModule=!0,t.hasValidParameter=function(e){return e===r},t.isRootInstance=function(e){return n.has(e)},t.registerAsRootInstance=function(e){n.set(e,!0)};const n=new WeakMap,r=(t.holder=n,Symbol("rootInstance"));t.rootInstanceSymbol=r},(e,t,n)=>{"use strict";t.__esModule=!0,n(203);var u=n(447),r=n(542),i=n(444),c=n(461),d=n(445);t.default=class{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this.hot=e,this.data=t,this.dataType="array",this.colToProp=()=>{},this.propToCol=()=>{}}modifyRowData(e){let t;return void 0===(t=this.hot.hasHook("modifyRowData")?this.hot.runHooks("modifyRowData",e):t)||Number.isInteger(t)?this.data[e]:t}getData(){return this.data&&0!==this.data.length?this.getByRange(null,null,0<arguments.length&&void 0!==arguments[0]&&arguments[0]):this.data}setData(e){this.data=e}getAtColumn(n){const r=[];return(0,i.arrayEach)(this.data,(e,t)=>{t=this.getAtCell(t,n);r.push(t)}),r}getAtRow(n,r,i){let o=3<arguments.length&&void 0!==arguments[3]&&arguments[3];var e=void 0===r&&void 0===i;let s=null,a=null;if(s=this.modifyRowData(n),Array.isArray(s))a=[],e?s.forEach((e,t)=>{a[t]=this.getAtPhysicalCell(n,t,s)}):(0,c.rangeEach)(r,i,e=>{a[e-r]=this.getAtPhysicalCell(n,e,s)});else if((0,u.isObject)(s)||(0,d.isFunction)(s))if(a=o?[]:{},!e||o){const l=this.countFirstRowKeys()-1;(0,c.rangeEach)(0,l,e=>{var t=this.colToProp(e);(r||0)<=e&&e<=(i||l)&&!Number.isInteger(t)&&(e=this.getAtPhysicalCell(n,t,s),o?a.push(e):(0,u.setProperty)(a,t,e))})}else(0,u.objectEach)(s,(e,t)=>{(0,u.setProperty)(a,t,this.getAtPhysicalCell(n,t,s))});return a}setAtCell(e,t,n){var r;e>=this.countRows()||t>=this.countFirstRowKeys()||(this.hot.hasHook("modifySourceData")&&(r=(0,u.createObjectPropListener)(n),this.hot.runHooks("modifySourceData",e,t,r,"set"),r.isTouched())&&(n=r.value),Number.isInteger(t)?this.data[e][t]=n:(0,u.setProperty)(this.data[e],t,n))}getAtPhysicalCell(e,t,n){let r=null;return n&&(r="string"==typeof t?(0,u.getProperty)(n,t):"function"==typeof t?t(n):n[t]),r=this.hot.hasHook("modifySourceData")&&(n=(0,u.createObjectPropListener)(r),this.hot.runHooks("modifySourceData",e,t,n,"get"),n.isTouched())?n.value:r}getAtCell(e,t){var n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),n)}getByRange(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;let n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r=!1,i=null,o=null,s=null,a=null;null===e||null===t?(r=!0,i=0,s=this.countRows()-1):(i=Math.min(e.row,t.row),o=Math.min(e.col,t.col),s=Math.max(e.row,t.row),a=Math.max(e.col,t.col));const l=[];return(0,c.rangeEach)(i,s,e=>{l.push(r?this.getAtRow(e,void 0,void 0,n):this.getAtRow(e,o,a,n))}),l}countRows(){if(this.hot.hasHook("modifySourceLength")){var e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return(0,r.countFirstRowKeys)(this.data)}destroy(){this.data=null,this.hot=null}}},(e,t,n)=>{"use strict";t.__esModule=!0,t.countFirstRowKeys=function(e){let t=0;Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&(0,r.isObject)(e[0])&&(t=(0,r.deepObjectSize)(e[0])));return t},t.createEmptySpreadsheetData=function(t,n){var r=[];var i;for(let e=0;e<t;e++){i=[];for(let e=0;e<n;e++)i.push("");r.push(i)}return r},t.createSpreadsheetData=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:100,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:4;var n=[];let r,i;for(r=0;r<e;r++){var o=[];for(i=0;i<t;i++)o.push(s(i)+(r+1));n.push(o)}return n},t.createSpreadsheetObjectData=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:100,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:4;var n=[];let r,i;for(r=0;r<e;r++){var o={};for(i=0;i<t;i++)o["prop"+i]=s(i)+(r+1);n.push(o)}return n},t.dataRowToChangesArray=function(e){let r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,t=e;const i=[];Array.isArray(e)&&Array.isArray(e[0])||(t=[e]);return t.forEach((t,n)=>{Array.isArray(t)?t.forEach((e,t)=>{i.push([n+r,t,e])}):Object.keys(t).forEach(e=>{i.push([n+r,e,t[e]])})}),i},t.isArrayOfArrays=function(e){return!!(Array.isArray(e)&&e.length&&e.every(e=>Array.isArray(e)))},t.isArrayOfObjects=function(e){return!!(Array.isArray(e)&&e.length&&e.every(e=>"object"==typeof e&&!Array.isArray(e)&&null!==e))},t.spreadsheetColumnIndex=function(n){let r=0;if(n)for(let e=0,t=n.length-1;e<n.length;e+=1,--t)r+=o**t*(i.indexOf(n[e])+1);return--r},t.spreadsheetColumnLabel=s,n(203);var r=n(447);const i="ABCDEFGHIJKLMNOPQRSTUVWXYZ",o=i.length;function s(e){let t=e+1,n="";for(var r;0<t;)r=(t-1)%o,n=String.fromCharCode(65+r)+n,t=parseInt((t-r)/o,10);return n}},(e,t,n)=>{"use strict";var r={IndexMapper:t.__esModule=!0,getRegisteredMapsCounter:!0,getIncreasedIndexes:!0,getDecreasedIndexes:!0,alterUtilsFactory:!0},i=n(544),i=(t.IndexMapper=i.IndexMapper,n(559)),i=(t.getRegisteredMapsCounter=i.getRegisteredMapsCounter,n(556)),o=(t.getIncreasedIndexes=i.getIncreasedIndexes,t.getDecreasedIndexes=i.getDecreasedIndexes,t.alterUtilsFactory=i.alterUtilsFactory,n(545));Object.keys(o).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(r,e)||e in t&&t[e]===o[e]||(t[e]=o[e])})},(e,t,n)=>{"use strict";var r=n(196),a=(t.__esModule=!0,n(273),n(444)),l=n(545),i=n(557),r=r(n(549)),o=n(447),s=n(305),u=n(560);new Set;class c{constructor(){this.indexesSequence=new l.IndexesSequence,this.trimmingMapsCollection=new i.AggregatedCollection(e=>e.some(e=>!0===e),!1),this.hidingMapsCollection=new i.AggregatedCollection(e=>e.some(e=>!0===e),!1),this.variousMapsCollection=new i.MapCollection,this.hidingChangesObservable=new u.ChangesObservable({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if("hiding"!==e)throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,n){return this.registerMap(e,(0,l.createIndexMap)(t,n))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);(t instanceof l.TrimmingMap?this.trimmingMapsCollection:t instanceof l.HidingMap?this.hidingMapsCollection:this.variousMapsCollection).register(e,t);e=this.getNumberOfIndexes();return 0<e&&t.init(e),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){e=this.notTrimmedIndexesCache[e];return(0,s.isDefined)(e)?e:null}getPhysicalFromRenderableIndex(e){e=this.renderablePhysicalIndexesCache[e];return(0,s.isDefined)(e)?e:null}getVisualFromPhysicalIndex(e){e=this.fromPhysicalToVisualIndexesCache.get(e);return(0,s.isDefined)(e)?e:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){e=this.fromVisualToRenderableIndexesCache.get(e);return(0,s.isDefined)(e)?e:null}getNearestNotHiddenIndex(t,e){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(t))return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;var r=Array.from(this.fromVisualToRenderableIndexesCache.keys());let i=-1;return-1===(i=0<e?r.findIndex(e=>t<e):r.reverse().findIndex(e=>e<t))?n?this.getNearestNotHiddenIndex(t,-e,!1):null:r[i]}initToLength(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(t){var e,n=this.getNumberOfIndexes();t<n?(e=[...Array(this.getNumberOfIndexes()-t).keys()].map(e=>e+t),this.removeIndexes(e)):this.insertIndexes(n,t-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return!0===(!(0<arguments.length&&void 0!==arguments[0])||arguments[0])?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(e=>!1===this.isTrimmed(e))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return!0===(!(0<arguments.length&&void 0!==arguments[0])||arguments[0])?this.notHiddenIndexesCache:this.getIndexesSequence().filter(e=>!1===this.isHidden(e))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return!0===(!(0<arguments.length&&void 0!==arguments[0])||arguments[0])?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(e=>!1===this.isHidden(e))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){var n=(0,a.arrayMap)(e="number"==typeof e?[e]:e,e=>this.getPhysicalFromVisualIndex(e)),r=this.getNotTrimmedIndexesLength(),e=e.length,i=(0,l.getListWithRemovedItems)(this.getIndexesSequence(),n),o=i.filter(e=>!1===this.isTrimmed(e));let s=i.indexOf(o[o.length-1])+1;t+e<r&&(e=o[t],s=i.indexOf(e)),this.indexesChangeSource="move",this.setIndexesSequence((0,l.getListWithInsertedItems)(i,s,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){var e=this.getNotTrimmedIndexes()[e],n=(0,s.isDefined)(e)?e:this.getNumberOfIndexes(),e=this.getIndexesSequence().includes(e)?this.getIndexesSequence().indexOf(e):this.getNumberOfIndexes(),t=(0,a.arrayMap)(new Array(t).fill(n),(e,t)=>e+t);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(e,t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(e,t),this.hidingMapsCollection.insertToEvery(e,t),this.variousMapsCollection.insertToEvery(e,t),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){var e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===(0<arguments.length&&void 0!==arguments[0]&&arguments[0])||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){var t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let e=0;e<t;e+=1){var n=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(n,e)}}cacheFromVisualToRenderableIndexes(){var t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let e=0;e<t;e+=1){var n=this.getPhysicalFromRenderableIndex(e),n=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(n,e)}}}t.IndexMapper=c,(0,o.mixin)(c,r.default)},(e,t,n)=>{"use strict";var r={createIndexMap:t.__esModule=!0,HidingMap:!0,IndexMap:!0,LinkedPhysicalIndexToValueMap:!0,PhysicalIndexToValueMap:!0,TrimmingMap:!0},i=(t.createIndexMap=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(d.has(e))return new(d.get(e))(t);throw new Error(`The provided map type ("${e}") does not exist.`)},n(273),n(546)),o=(t.HidingMap=i.HidingMap,n(548)),s=(t.IndexMap=o.IndexMap,n(551)),a=(t.LinkedPhysicalIndexToValueMap=s.LinkedPhysicalIndexToValueMap,n(547)),l=(t.PhysicalIndexToValueMap=a.PhysicalIndexToValueMap,n(554)),u=(t.TrimmingMap=l.TrimmingMap,n(555)),c=(Object.keys(u).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(r,e)||e in t&&t[e]===u[e]||(t[e]=u[e])}),n(552));Object.keys(c).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(r,e)||e in t&&t[e]===c[e]||(t[e]=c[e])});const d=new Map([["hiding",i.HidingMap],["index",o.IndexMap],["linkedPhysicalIndexToValue",s.LinkedPhysicalIndexToValueMap],["physicalIndexToValue",a.PhysicalIndexToValueMap],["trimming",l.TrimmingMap]])},(e,t,n)=>{"use strict";t.__esModule=!0,n(203);var r=n(547),i=n(444);class o extends r.PhysicalIndexToValueMap{constructor(){super(0<arguments.length&&void 0!==arguments[0]&&arguments[0])}getHiddenIndexes(){return(0,i.arrayReduce)(this.getValues(),(e,t,n)=>(t&&e.push(n),e),[])}}t.HidingMap=o},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(548),i=n(550);class o extends r.IndexMap{insert(e,t){this.indexedValues=(0,i.getListWithInsertedItems)(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=(0,i.getListWithRemovedItems)(this.indexedValues,e),super.remove(e)}}t.PhysicalIndexToValueMap=o},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),n(461)),o=n(447),s=n(445),r=r(n(549));class a{constructor(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;this.indexedValues=[],this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){var t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;(this.indexedValues.length=0,s.isFunction)(this.initValueOrFn)?(0,i.rangeEach)(e-1,e=>this.indexedValues.push(this.initValueOrFn(e))):(0,i.rangeEach)(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}t.IndexMap=a,(0,o.mixin)(a,r.default)},(e,t,n)=>{"use strict";t.__esModule=!0,n(203);var r=n(447),u=n(445),n={_localHooks:Object.create(null),addLocalHook(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks(t,n,r,i,o,s,a){if(this._localHooks[t]){var l=this._localHooks[t].length;for(let e=0;e<l;e++)(0,u.fastCall)(this._localHooks[t][e],this,n,r,i,o,s,a)}},clearLocalHooks(){return this._localHooks={},this}};(0,r.defineGetter)(n,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),t.default=n},(e,t,n)=>{"use strict";t.__esModule=!0,t.getListWithInsertedItems=function(e,t,n,r){var i=n.length?n[0]:void 0;return[...e.slice(0,i),...n.map((e,t)=>(0,o.isFunction)(r)?r(e,t):r),...void 0===i?[]:e.slice(i)]},t.getListWithRemovedItems=function(e,n){return(0,r.arrayFilter)(e,(e,t)=>!1===n.includes(t))};var o=n(445),r=n(444)},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,r(n(467))),r=n(548),o=n(550),s=n(552),a=n(553),l=n(445);class u extends r.IndexMap{constructor(){super(...arguments),(0,i.default)(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length&&(this.indexedValues[e]=t,!1===this.orderOfIndexes.includes(e)&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0)}clearValue(e){this.orderOfIndexes=(0,s.getListWithRemovedItems)(this.orderOfIndexes,[e]),(0,l.isFunction)(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=(0,o.getListWithInsertedItems)(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=(0,a.getIncreasedIndexes)(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=(0,o.getListWithRemovedItems)(this.indexedValues,e),this.orderOfIndexes=(0,s.getListWithRemovedItems)(this.orderOfIndexes,e),this.orderOfIndexes=(0,a.getDecreasedIndexes)(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}t.LinkedPhysicalIndexToValueMap=u},(e,t,n)=>{"use strict";t.__esModule=!0,t.getListWithInsertedItems=function(e,t,n){return[...e.slice(0,t),...n,...e.slice(t)]},t.getListWithRemovedItems=function(e,t){return(0,r.arrayFilter)(e,e=>!1===t.includes(e))};var r=n(444)},(e,t,n)=>{"use strict";t.__esModule=!0,t.getDecreasedIndexes=function(e,n){return(0,i.arrayMap)(e,t=>t-n.filter(e=>e<t).length)},t.getIncreasedIndexes=function(e,t){const n=t[0],r=t.length;return(0,i.arrayMap)(e,e=>e>=n?e+r:e)};var i=n(444)},(e,t,n)=>{"use strict";t.__esModule=!0,n(203);var r=n(547),i=n(444);class o extends r.PhysicalIndexToValueMap{constructor(){super(0<arguments.length&&void 0!==arguments[0]&&arguments[0])}getTrimmedIndexes(){return(0,i.arrayReduce)(this.getValues(),(e,t,n)=>(t&&e.push(n),e),[])}}t.TrimmingMap=o},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(548),i=n(552),o=n(556);class s extends r.IndexMap{constructor(){super(e=>e)}insert(e,t){var n=(0,o.getIncreasedIndexes)(this.indexedValues,t);this.indexedValues=(0,i.getListWithInsertedItems)(n,e,t),super.insert(e,t)}remove(e){var t=(0,i.getListWithRemovedItems)(this.indexedValues,e);this.indexedValues=(0,o.getDecreasedIndexes)(t,e),super.remove(e)}}t.IndexesSequence=s},(e,t,n)=>{"use strict";t.__esModule=!0,n(273);var r=n(553),r=(t.getDecreasedIndexes=r.getDecreasedIndexes,t.getIncreasedIndexes=r.getIncreasedIndexes,n(552)),n=n(550);const i=new Map([["indexesSequence",{getListWithInsertedItems:r.getListWithInsertedItems,getListWithRemovedItems:r.getListWithRemovedItems}],["physicallyIndexed",{getListWithInsertedItems:n.getListWithInsertedItems,getListWithRemovedItems:n.getListWithRemovedItems}]]);t.alterUtilsFactory=e=>{if(!1===i.has(e))throw new Error(`Alter strategy with ID '${e}' does not exist.`);return i.get(e)}},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(558),i=(Object.keys(r).forEach(function(e){"default"===e||"__esModule"===e||e in t&&t[e]===r[e]||(t[e]=r[e])}),n(559));Object.keys(i).forEach(function(e){"default"===e||"__esModule"===e||e in t&&t[e]===i[e]||(t[e]=i[e])})},(e,t,n)=>{"use strict";t.__esModule=!0,n(203);var r=n(559),o=n(444),s=n(305);class i extends r.MapCollection{constructor(e,t){super(),this.mergedValuesCache=[],this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if(!0===(!(0<arguments.length&&void 0!==arguments[0])||arguments[0]))return this.mergedValuesCache;if(0===this.getLength())return[];var n=(0,o.arrayMap)(this.get(),e=>e.getValues()),e=[],r=(0,s.isDefined)(n[0])&&n[0].length||0;for(let t=0;t<r;t+=1){var i=[];for(let e=0;e<this.getLength();e+=1)i.push(n[e][t]);e.push(i)}return(0,o.arrayMap)(e,this.aggregationFunction)}getMergedValueAtIndex(e,t){t=this.getMergedValues(t)[e];return(0,s.isDefined)(t)?t:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}t.AggregatedCollection=i},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,t.getRegisteredMapsCounter=function(){return s},n(305)),o=n(447),r=r(n(549));let s=0;class a{constructor(){this.collection=new Map}register(e,t){!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)),s+=1)}unregister(e){var t=this.collection.get(e);(0,i.isDefined)(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),--s)}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return(0,i.isUndefined)(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(t){this.collection.forEach(e=>{e.remove(t)})}insertToEvery(t,n){this.collection.forEach(e=>{e.insert(t,n)})}initEvery(t){this.collection.forEach(e=>{e.init(t)})}}t.MapCollection=a,(0,o.mixin)(a,r.default)},(e,t,n)=>{"use strict";n(273);var r=n(196),i=(t.__esModule=!0,r(n(471))),o=r(n(474)),s=n(561),a=n(562);function l(e,t,n){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,n)}var u=new WeakMap,c=new WeakMap,d=new WeakMap,h=new WeakMap,f=new WeakMap;t.ChangesObservable=class{constructor(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})["initialIndexValue"];l(this,u,{writable:!0,value:new Set}),l(this,c,{writable:!0,value:[]}),l(this,d,{writable:!0,value:[]}),l(this,h,{writable:!0,value:!1}),l(this,f,{writable:!0,value:!1}),(0,o.default)(this,f,null!=e&&e)}createObserver(){const e=new s.ChangesObserver;return(0,i.default)(this,u).add(e),e.addLocalHook("unsubscribe",()=>{(0,i.default)(this,u).delete(e)}),e._writeInitialChanges((0,a.arrayDiff)((0,i.default)(this,c),(0,i.default)(this,d))),e}emit(e){let t=(0,i.default)(this,d);(0,i.default)(this,h)&&(0,i.default)(this,c).length===e.length||(0===e.length?e=new Array(t.length).fill((0,i.default)(this,f)):(0,o.default)(this,c,new Array(e.length).fill((0,i.default)(this,f))),(0,i.default)(this,h))||((0,o.default)(this,h,!0),t=(0,i.default)(this,c));const n=(0,a.arrayDiff)(t,e);(0,i.default)(this,u).forEach(e=>e._write(n)),(0,o.default)(this,d,e)}}},(e,t,n)=>{"use strict";n(273);var r=n(196),i=(t.__esModule=!0,r(n(474))),o=r(n(471)),s=n(447),r=r(n(549));function a(e,t,n){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,n)}var l=new WeakMap;class u{constructor(){a(this,l,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write((0,o.default)(this,l)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return 0<e.length&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){(0,i.default)(this,l,e)}}t.ChangesObserver=u,(0,s.mixin)(u,r.default)},(e,t,n)=>{"use strict";t.__esModule=!0,t.arrayDiff=function(e,t){var n=[];let r=0,i=0;for(;r<e.length&&i<t.length;r++,i++)e[r]!==t[i]&&n.push({op:"replace",index:i,oldValue:e[r],newValue:t[i]});for(;r<t.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:t[r]});for(;i<e.length;i++)n.push({op:"remove",index:i,oldValue:e[i],newValue:void 0});return n},n(203)},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,t.getDefaultLanguageDictionary=function(){return c.default},t.getLanguageDictionary=v,t.getLanguagesDictionaries=function(){return m()},t.getTranslatedPhrase=function(e,t,n){e=v(e);if(null===e)return null;e=e[t];if((0,s.isUndefined)(e))return null;t=function(t,n){let r=t;return(0,o.arrayEach)((0,u.getPhraseFormatters)(),e=>{r=e(t,n)}),r}(e,n);if(Array.isArray(t))return t[0];return t},t.getValidLanguageCode=function(e){let t=(0,a.normalizeLanguageCode)(e);b(t)||(t=h,(0,a.warnUserAboutLanguageRegistration)(e));return t},t.hasLanguageDictionary=b,t.registerLanguageDictionary=y,n(447)),o=n(444),s=n(305),a=n(564),l=r(n(456)),u=n(565),c=r(n(567)),r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=d(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function d(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(d=function(e){return e?n:t})(e))}t.dictionaryKeys=r;const h=c.default.languageCode,{register:f,getItem:p,hasItem:g,getValues:m}=(t.DEFAULT_LANGUAGE_CODE=h,(0,l.default)("languagesDictionaries"));function y(e,t){let n=e,r=t;return(0,i.isObject)(e)&&(r=e,n=r.languageCode),t=n,e=r,t!==h&&(0,a.extendNotExistingKeys)(e,p(h)),f(n,(0,i.deepClone)(r)),(0,i.deepClone)(r)}function v(e){return b(e)?(0,i.deepClone)(p(e)):null}function b(e){return g(e)}y(c.default)},(e,t,n)=>{"use strict";t.__esModule=!0,t.createCellHeadersRange=function(e,t){let n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:e,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:t,[i,o]=[n,r];t<e&&([i,o]=[o,i]);return i+"-"+o},t.extendNotExistingKeys=function(n,e){return(0,i.objectEach)(e,(e,t)=>{(0,r.isUndefined)(n[t])&&(n[t]=e)}),n},t.normalizeLanguageCode=function(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(e);if(t)return t[1].toLowerCase()+"-"+t[2].toUpperCase();return e},t.warnUserAboutLanguageRegistration=function(e){(0,r.isDefined)(e)&&(0,o.error)((0,s.toSingleLine)`Language with code "${e}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)};var r=n(305),i=n(447),o=n(455),s=n(443)},(e,t,n)=>{"use strict";var r=n(196),t=(t.__esModule=!0,t.getPhraseFormatters=t.getAll=function(){return o()},t.registerPhraseFormatter=t.register=s,r(n(456))),r=r(n(566));const{register:i,getValues:o}=(0,t.default)("phraseFormatters");function s(e,t){i(e,t)}s("pluralize",r.default)},(e,t)=>{"use strict";t.__esModule=!0,t.default=function(e,t){var n=Array.isArray(e)&&Number.isInteger(t);if(n)return e[t];return e}},(e,t,n)=>{"use strict";t.__esModule=!0;n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}n={languageCode:"en-US",[n.CONTEXTMENU_ITEMS_NO_ITEMS]:"No available options",[n.CONTEXTMENU_ITEMS_ROW_ABOVE]:"Insert row above",[n.CONTEXTMENU_ITEMS_ROW_BELOW]:"Insert row below",[n.CONTEXTMENU_ITEMS_INSERT_LEFT]:"Insert column left",[n.CONTEXTMENU_ITEMS_INSERT_RIGHT]:"Insert column right",[n.CONTEXTMENU_ITEMS_REMOVE_ROW]:["Remove row","Remove rows"],[n.CONTEXTMENU_ITEMS_REMOVE_COLUMN]:["Remove column","Remove columns"],[n.CONTEXTMENU_ITEMS_UNDO]:"Undo",[n.CONTEXTMENU_ITEMS_REDO]:"Redo",[n.CONTEXTMENU_ITEMS_READ_ONLY]:"Read only",[n.CONTEXTMENU_ITEMS_CLEAR_COLUMN]:"Clear column",[n.CONTEXTMENU_ITEMS_ALIGNMENT]:"Alignment",[n.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT]:"Left",[n.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER]:"Center",[n.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT]:"Right",[n.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY]:"Justify",[n.CONTEXTMENU_ITEMS_ALIGNMENT_TOP]:"Top",[n.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE]:"Middle",[n.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM]:"Bottom",[n.CONTEXTMENU_ITEMS_FREEZE_COLUMN]:"Freeze column",[n.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN]:"Unfreeze column",[n.CONTEXTMENU_ITEMS_BORDERS]:"Borders",[n.CONTEXTMENU_ITEMS_BORDERS_TOP]:"Top",[n.CONTEXTMENU_ITEMS_BORDERS_RIGHT]:"Right",[n.CONTEXTMENU_ITEMS_BORDERS_BOTTOM]:"Bottom",[n.CONTEXTMENU_ITEMS_BORDERS_LEFT]:"Left",[n.CONTEXTMENU_ITEMS_REMOVE_BORDERS]:"Remove border(s)",[n.CONTEXTMENU_ITEMS_ADD_COMMENT]:"Add comment",[n.CONTEXTMENU_ITEMS_EDIT_COMMENT]:"Edit comment",[n.CONTEXTMENU_ITEMS_REMOVE_COMMENT]:"Delete comment",[n.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT]:"Read-only comment",[n.CONTEXTMENU_ITEMS_MERGE_CELLS]:"Merge cells",[n.CONTEXTMENU_ITEMS_UNMERGE_CELLS]:"Unmerge cells",[n.CONTEXTMENU_ITEMS_COPY]:"Copy",[n.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS]:["Copy with header","Copy with headers"],[n.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS]:["Copy with group header","Copy with group headers"],[n.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY]:["Copy header only","Copy headers only"],[n.CONTEXTMENU_ITEMS_CUT]:"Cut",[n.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD]:"Insert child row",[n.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD]:"Detach from parent",[n.CONTEXTMENU_ITEMS_HIDE_COLUMN]:["Hide column","Hide columns"],[n.CONTEXTMENU_ITEMS_SHOW_COLUMN]:["Show column","Show columns"],[n.CONTEXTMENU_ITEMS_HIDE_ROW]:["Hide row","Hide rows"],[n.CONTEXTMENU_ITEMS_SHOW_ROW]:["Show row","Show rows"],[n.FILTERS_CONDITIONS_NONE]:"None",[n.FILTERS_CONDITIONS_EMPTY]:"Is empty",[n.FILTERS_CONDITIONS_NOT_EMPTY]:"Is not empty",[n.FILTERS_CONDITIONS_EQUAL]:"Is equal to",[n.FILTERS_CONDITIONS_NOT_EQUAL]:"Is not equal to",[n.FILTERS_CONDITIONS_BEGINS_WITH]:"Begins with",[n.FILTERS_CONDITIONS_ENDS_WITH]:"Ends with",[n.FILTERS_CONDITIONS_CONTAINS]:"Contains",[n.FILTERS_CONDITIONS_NOT_CONTAIN]:"Does not contain",[n.FILTERS_CONDITIONS_GREATER_THAN]:"Greater than",[n.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL]:"Greater than or equal to",[n.FILTERS_CONDITIONS_LESS_THAN]:"Less than",[n.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL]:"Less than or equal to",[n.FILTERS_CONDITIONS_BETWEEN]:"Is between",[n.FILTERS_CONDITIONS_NOT_BETWEEN]:"Is not between",[n.FILTERS_CONDITIONS_AFTER]:"After",[n.FILTERS_CONDITIONS_BEFORE]:"Before",[n.FILTERS_CONDITIONS_TODAY]:"Today",[n.FILTERS_CONDITIONS_TOMORROW]:"Tomorrow",[n.FILTERS_CONDITIONS_YESTERDAY]:"Yesterday",[n.FILTERS_VALUES_BLANK_CELLS]:"Blank cells",[n.FILTERS_DIVS_FILTER_BY_CONDITION]:"Filter by condition",[n.FILTERS_DIVS_FILTER_BY_VALUE]:"Filter by value",[n.FILTERS_LABELS_CONJUNCTION]:"And",[n.FILTERS_LABELS_DISJUNCTION]:"Or",[n.FILTERS_BUTTONS_SELECT_ALL]:"Select all",[n.FILTERS_BUTTONS_CLEAR]:"Clear",[n.FILTERS_BUTTONS_OK]:"OK",[n.FILTERS_BUTTONS_CANCEL]:"Cancel",[n.FILTERS_BUTTONS_PLACEHOLDER_SEARCH]:"Search",[n.FILTERS_BUTTONS_PLACEHOLDER_VALUE]:"Value",[n.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE]:"Second value"};t.default=n},(e,t)=>{"use strict";t.__esModule=!0;var n="ContextMenu:items",n=(t.CONTEXT_MENU_ITEMS_NAMESPACE=n,t.CONTEXTMENU_ITEMS_NO_ITEMS="ContextMenu:items.noItems",t.CONTEXTMENU_ITEMS_ROW_ABOVE="ContextMenu:items.insertRowAbove",t.CONTEXTMENU_ITEMS_ROW_BELOW="ContextMenu:items.insertRowBelow",t.CONTEXTMENU_ITEMS_INSERT_LEFT="ContextMenu:items.insertColumnOnTheLeft",t.CONTEXTMENU_ITEMS_INSERT_RIGHT="ContextMenu:items.insertColumnOnTheRight",t.CONTEXTMENU_ITEMS_REMOVE_ROW="ContextMenu:items.removeRow",t.CONTEXTMENU_ITEMS_REMOVE_COLUMN="ContextMenu:items.removeColumn",t.CONTEXTMENU_ITEMS_UNDO="ContextMenu:items.undo",t.CONTEXTMENU_ITEMS_REDO="ContextMenu:items.redo",t.CONTEXTMENU_ITEMS_READ_ONLY="ContextMenu:items.readOnly",t.CONTEXTMENU_ITEMS_CLEAR_COLUMN="ContextMenu:items.clearColumn",t.CONTEXTMENU_ITEMS_COPY="ContextMenu:items.copy",t.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS="ContextMenu:items.copyWithHeaders",t.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS="ContextMenu:items.copyWithGroupHeaders",t.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY="ContextMenu:items.copyHeadersOnly",t.CONTEXTMENU_ITEMS_CUT="ContextMenu:items.cut",t.CONTEXTMENU_ITEMS_FREEZE_COLUMN="ContextMenu:items.freezeColumn",t.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN="ContextMenu:items.unfreezeColumn",t.CONTEXTMENU_ITEMS_MERGE_CELLS="ContextMenu:items.mergeCells",t.CONTEXTMENU_ITEMS_UNMERGE_CELLS="ContextMenu:items.unmergeCells",t.CONTEXTMENU_ITEMS_ADD_COMMENT="ContextMenu:items.addComment",t.CONTEXTMENU_ITEMS_EDIT_COMMENT="ContextMenu:items.editComment",t.CONTEXTMENU_ITEMS_REMOVE_COMMENT="ContextMenu:items.removeComment",t.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT="ContextMenu:items.readOnlyComment",t.CONTEXTMENU_ITEMS_ALIGNMENT="ContextMenu:items.align",t.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT="ContextMenu:items.align.left",t.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER="ContextMenu:items.align.center",t.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT="ContextMenu:items.align.right",t.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY="ContextMenu:items.align.justify",t.CONTEXTMENU_ITEMS_ALIGNMENT_TOP="ContextMenu:items.align.top",t.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE="ContextMenu:items.align.middle",t.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM="ContextMenu:items.align.bottom",t.CONTEXTMENU_ITEMS_BORDERS="ContextMenu:items.borders",t.CONTEXTMENU_ITEMS_BORDERS_TOP="ContextMenu:items.borders.top",t.CONTEXTMENU_ITEMS_BORDERS_RIGHT="ContextMenu:items.borders.right",t.CONTEXTMENU_ITEMS_BORDERS_BOTTOM="ContextMenu:items.borders.bottom",t.CONTEXTMENU_ITEMS_BORDERS_LEFT="ContextMenu:items.borders.left",t.CONTEXTMENU_ITEMS_REMOVE_BORDERS="ContextMenu:items.borders.remove",t.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD="ContextMenu:items.nestedHeaders.insertChildRow",t.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD="ContextMenu:items.nestedHeaders.detachFromParent",t.CONTEXTMENU_ITEMS_HIDE_COLUMN="ContextMenu:items.hideColumn",t.CONTEXTMENU_ITEMS_SHOW_COLUMN="ContextMenu:items.showColumn",t.CONTEXTMENU_ITEMS_HIDE_ROW="ContextMenu:items.hideRow",t.CONTEXTMENU_ITEMS_SHOW_ROW="ContextMenu:items.showRow","Filters:"),n=(t.FILTERS_NAMESPACE=n)+"conditions";t.FILTERS_CONDITIONS_NAMESPACE=n,t.FILTERS_CONDITIONS_NONE="Filters:conditions.none",t.FILTERS_CONDITIONS_EMPTY="Filters:conditions.isEmpty",t.FILTERS_CONDITIONS_NOT_EMPTY="Filters:conditions.isNotEmpty",t.FILTERS_CONDITIONS_EQUAL="Filters:conditions.isEqualTo",t.FILTERS_CONDITIONS_NOT_EQUAL="Filters:conditions.isNotEqualTo",t.FILTERS_CONDITIONS_BEGINS_WITH="Filters:conditions.beginsWith",t.FILTERS_CONDITIONS_ENDS_WITH="Filters:conditions.endsWith",t.FILTERS_CONDITIONS_CONTAINS="Filters:conditions.contains",t.FILTERS_CONDITIONS_NOT_CONTAIN="Filters:conditions.doesNotContain",t.FILTERS_CONDITIONS_BY_VALUE="Filters:conditions.byValue",t.FILTERS_CONDITIONS_GREATER_THAN="Filters:conditions.greaterThan",t.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL="Filters:conditions.greaterThanOrEqualTo",t.FILTERS_CONDITIONS_LESS_THAN="Filters:conditions.lessThan",t.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL="Filters:conditions.lessThanOrEqualTo",t.FILTERS_CONDITIONS_BETWEEN="Filters:conditions.isBetween",t.FILTERS_CONDITIONS_NOT_BETWEEN="Filters:conditions.isNotBetween",t.FILTERS_CONDITIONS_AFTER="Filters:conditions.after",t.FILTERS_CONDITIONS_BEFORE="Filters:conditions.before",t.FILTERS_CONDITIONS_TODAY="Filters:conditions.today",t.FILTERS_CONDITIONS_TOMORROW="Filters:conditions.tomorrow",t.FILTERS_CONDITIONS_YESTERDAY="Filters:conditions.yesterday",t.FILTERS_DIVS_FILTER_BY_CONDITION="Filters:labels.filterByCondition",t.FILTERS_DIVS_FILTER_BY_VALUE="Filters:labels.filterByValue",t.FILTERS_LABELS_CONJUNCTION="Filters:labels.conjunction",t.FILTERS_LABELS_DISJUNCTION="Filters:labels.disjunction",t.FILTERS_VALUES_BLANK_CELLS="Filters:values.blankCells",t.FILTERS_BUTTONS_SELECT_ALL="Filters:buttons.selectAll",t.FILTERS_BUTTONS_CLEAR="Filters:buttons.clear",t.FILTERS_BUTTONS_OK="Filters:buttons.ok",t.FILTERS_BUTTONS_CANCEL="Filters:buttons.cancel",t.FILTERS_BUTTONS_PLACEHOLDER_SEARCH="Filters:buttons.placeholder.search",t.FILTERS_BUTTONS_PLACEHOLDER_VALUE="Filters:buttons.placeholder.value";t.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE="Filters:buttons.placeholder.secondValue"},(e,t,n)=>{"use strict";var r=n(196),i={Highlight:t.__esModule=!0,Selection:!0,handleMouseEvent:!0,detectSelectionType:!0,normalizeSelectionFactory:!0},o=r(n(570)),o=(t.Highlight=o.default,r(n(580))),r=(t.Selection=o.default,n(539)),o=(t.handleMouseEvent=r.handleMouseEvent,n(583)),s=(t.detectSelectionType=o.detectSelectionType,t.normalizeSelectionFactory=o.normalizeSelectionFactory,n(572));Object.keys(s).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(i,e)||e in t&&t[e]===s[e]||(t[e]=s[e])})},(e,t,n)=>{"use strict";t.__esModule=!0,n(203);var r=n(571),i=n(572),o=n(444);class s{constructor(e){this.options=e,this.layerLevel=0,this.cell=(0,r.createHighlight)(i.CELL_TYPE,e),this.fill=(0,r.createHighlight)(i.FILL_TYPE,e),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}isEnabledFor(e,t){let n=e,r=(e===i.CELL_TYPE&&(n="current"),this.options.disabledCellSelection(t.row,t.col));return!1===(r="string"==typeof r?[r]:r)||Array.isArray(r)&&!r.includes(n)}useLayerLevel(){return this.layerLevel=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,this}getCell(){return this.cell}getFill(){return this.fill}createOrGetArea(){var e=this.layerLevel;let t;return this.areas.has(e)?t=this.areas.get(e):(t=(0,r.createHighlight)(i.AREA_TYPE,{layerLevel:e,...this.options}),this.areas.set(e,t)),t}getAreas(){return[...this.areas.values()]}createOrGetHeader(){var e=this.layerLevel;let t;return this.headers.has(e)?t=this.headers.get(e):(t=(0,r.createHighlight)(i.HEADER_TYPE,{...this.options}),this.headers.set(e,t)),t}getHeaders(){return[...this.headers.values()]}createOrGetActiveHeader(){var e=this.layerLevel;let t;return this.activeHeaders.has(e)?t=this.activeHeaders.get(e):(t=(0,r.createHighlight)(i.ACTIVE_HEADER_TYPE,{...this.options}),this.activeHeaders.set(e,t)),t}getActiveHeaders(){return[...this.activeHeaders.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push((0,r.createHighlight)(i.CUSTOM_SELECTION_TYPE,{...this.options,...e}))}clear(){this.cell.clear(),this.fill.clear(),(0,o.arrayEach)(this.areas.values(),e=>{e.clear()}),(0,o.arrayEach)(this.headers.values(),e=>{e.clear()}),(0,o.arrayEach)(this.activeHeaders.values(),e=>{e.clear()})}[Symbol.iterator](){return[this.cell,this.fill,...this.areas.values(),...this.headers.values(),...this.activeHeaders.values(),...this.customSelections][Symbol.iterator]()}}t.default=s},(e,t,n)=>{"use strict";var r=n(196),t=(t.__esModule=!0,t.createHighlight=function(e,t){return d(e)({type:e,...t})},r(n(456))),i=n(572),o=r(n(573)),s=r(n(575)),a=r(n(576)),l=r(n(577)),u=r(n(578)),r=r(n(579));const{register:c,getItem:d}=(0,t.default)("highlight/types");c(i.ACTIVE_HEADER_TYPE,o.default),c(i.AREA_TYPE,s.default),c(i.CELL_TYPE,a.default),c(i.CUSTOM_SELECTION_TYPE,l.default),c(i.FILL_TYPE,u.default),c(i.HEADER_TYPE,r.default)},(e,t)=>{"use strict";t.__esModule=!0;t.ACTIVE_HEADER_TYPE="active-header",t.AREA_TYPE="area",t.CELL_TYPE="cell",t.FILL_TYPE="fill",t.HEADER_TYPE="header";t.CUSTOM_SELECTION_TYPE="custom-selection"},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(572)),o=r(n(574));t.default=function(e){let{activeHeaderClassName:t,...n}=e;return new o.default({highlightHeaderClassName:t,...n,selectionType:i.ACTIVE_HEADER_TYPE})}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,r(n(467)));class o extends n(476).Selection{constructor(e,t){super(e,null),(0,i.default)(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){var{from:e,to:t}=e;let n=this.getNearestNotHiddenCoords(e,1),r=this.getNearestNotHiddenCoords(t,-1);if(null===n||null===r)return null;if(n.row>r.row||n.col>r.col){if(!("header"===this.settings.type||"active-header"===this.settings.type))return null;n=e,r=t}return this.settings.createCellRange(n,n,r)}getNearestNotHiddenCoords(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:t,t=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),e.row,t);return null===t||null===(e=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),e.col,n))?null:this.settings.createCellCoords(t,e)}getNearestNotHiddenIndex(e,t,n){return t<0?t:(e=e.getNearestNotHiddenIndex(t,n),("header"===this.settings.type||"active-header"===this.settings.type)&&null===e?-1:e)}commit(){var e;return null!==this.visualCellRange&&(e=this.trimToVisibleCellsRangeOnly(this.visualCellRange),this.cellRange=null===e?null:this.createRenderableCellRange(e.from,e.to)),this}syncWith(e){var t="N-S"===e.getVerticalDirection()?1:-1,n="W-E"===e.getHorizontalDirection()?1:-1,t=this.getNearestNotHiddenCoords(e.from.clone().normalize(),t,n);return null!==t&&e.overlaps(t)?(null===this.cellRange&&(n=this.settings.visualToRenderableCoords(t),this.cellRange=this.settings.createCellRange(n)),e.setHighlight(t)):e.setHighlight(e.from),this}getCorners(){var{from:e,to:t}=this.cellRange,n=null===e.row||null===t.row,r=null===e.col||null===t.col,i=this.settings.createCellCoords(n?null:Math.min(e.row,t.row),r?null:Math.min(e.col,t.col)),n=this.settings.createCellCoords(n?null:Math.max(e.row,t.row),r?null:Math.max(e.col,t.col));return[i.row,i.col,n.row,n.col]}getVisualCorners(){var e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){e=this.settings.visualToRenderableCoords(e),t=this.settings.visualToRenderableCoords(t);return this.settings.createCellRange(e,e,t)}}t.default=o},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(572)),o=r(n(574));t.default=function(e){let{layerLevel:t,areaCornerVisible:n,...r}=e;return new o.default({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:n},...r,selectionType:i.AREA_TYPE})}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(572)),o=r(n(574));t.default=function(e){let{cellCornerVisible:t,...n}=e;return new o.default({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t},...n,selectionType:i.CELL_TYPE})}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(572)),o=r(n(574));t.default=function(e){let{border:t,visualCellRange:n,...r}=e;return new o.default({...t,...r,selectionType:i.CUSTOM_SELECTION_TYPE},n)}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(572)),o=r(n(574));t.default=function(e){let{...t}=e;return new o.default({className:"fill",border:{width:1,color:"#ff0000"},...t,selectionType:i.FILL_TYPE})}},(e,t,n)=>{"use strict";var r=n(196),o=(t.__esModule=!0,n(572)),s=r(n(574));t.default=function(e){let{headerClassName:t,rowClassName:n,columnClassName:r,...i}=e;return new s.default({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:n,highlightColumnClassName:r,...i,highlightOnlyClosestHeader:!0,selectionType:o.HEADER_TYPE})}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(273),r(n(570))),s=n(572),o=r(n(581)),a=n(447),u=n(305),l=n(444),c=r(n(549)),d=r(n(582)),h=n(583),f=n(443);class p{constructor(e,t){var r=this;this.settings=e,this.tableProps=t,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new o.default((e,t,n)=>this.tableProps.createCellRange(e,t,n)),this.highlight=new i.default({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,disabledCellSelection:(e,t)=>this.tableProps.isDisabledCellSelection(e,t),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),createCellRange:(e,t,n)=>this.tableProps.createCellRange(e,t,n),rowIndexMapper:()=>this.tableProps.rowIndexMapper(),columnIndexMapper:()=>this.tableProps.columnIndexMapper()}),this.transformation=new d.default(this.selectedRange,{countRows:()=>this.tableProps.countRowsTranslated(),countCols:()=>this.tableProps.countColsTranslated(),visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("beforeModifyTransformStart",...t)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("afterModifyTransformStart",...t)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("beforeModifyTransformEnd",...t)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("afterModifyTransformEnd",...t)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("insertRowRequire",...t)}),this.transformation.addLocalHook("insertColRequire",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("insertColRequire",...t)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r="multiple"===this.settings.selectionMode,i=(0,u.isUndefined)(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,o=e.row<0,s=e.col<0,a=o&&s,l=e.clone();this.selectedByCorner=a,this.runLocalHooks("beforeSetRangeStart"+(n?"Only":""),l),r&&(i||!(0,u.isUndefined)(t))||this.selectedRange.clear(),this.selectedRange.add(l),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!a&&s&&this.selectedByRowHeader.add(this.getLayerLevel()),!a&&o&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(e)}setRangeStartOnly(e,t){this.setRangeStart(e,t,!0)}setRangeEnd(e){if(!this.selectedRange.isEmpty()){var t=e.clone(),n=(this.runLocalHooks("beforeSetRangeEnd",t),this.begin(),this.selectedRange.current()),t=("single"!==this.settings.selectionMode&&n.setTo(this.tableProps.createCellCoords(t.row,t.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(s.CELL_TYPE,n.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(n),this.getLayerLevel()),r=(t<this.highlight.layerLevel&&((0,l.arrayEach)(this.highlight.getAreas(),e=>{e.clear()}),(0,l.arrayEach)(this.highlight.getHeaders(),e=>{e.clear()}),(0,l.arrayEach)(this.highlight.getActiveHeaders(),e=>{e.clear()})),this.highlight.useLayerLevel(t),this.highlight.createOrGetArea()),i=this.highlight.createOrGetHeader(),o=this.highlight.createOrGetActiveHeader();if(r.clear(),i.clear(),o.clear(),this.highlight.isEnabledFor(s.AREA_TYPE,n.highlight)&&(this.isMultiple()||1<=t)&&(r.add(n.from).add(n.to).commit(),1===t)&&(r=this.selectedRange.previous(),this.highlight.useLayerLevel(t-1).createOrGetArea().add(r.from).commit().syncWith(r),this.highlight.useLayerLevel(t)),this.highlight.isEnabledFor(s.HEADER_TYPE,n.highlight)){r=0===this.tableProps.countRowsTranslated(),t=0===this.tableProps.countColsTranslated();let e=n;(r||t)&&(e=n.clone()),r&&(e.from.row=-1),t&&(e.from.col=-1),("single"===this.settings.selectionMode?(this.isSelectedByAnyHeader()&&e.from.normalize(),i.add(e.from)):i.add(e.from).add(e.to)).commit(),this.isEntireRowSelected()&&this.tableProps.countCols()===n.getWidth()&&o.add(this.tableProps.createCellCoords(n.from.row,-1)).add(this.tableProps.createCellCoords(n.to.row,-1)).commit(),this.isEntireColumnSelected()&&this.tableProps.countRows()===n.getHeight()&&o.add(this.tableProps.createCellCoords(-1,n.from.col)).add(this.tableProps.createCellCoords(-1,n.to.col)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}}isMultiple(){var e=(0,a.createObjectPropListener)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,t){this.setRangeStart(this.transformation.transformStart(e,t,2<arguments.length&&void 0!==arguments[2]&&arguments[2]))}transformEnd(e,t){this.setRangeEnd(this.transformation.transformEnd(e,t))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&this.isEntireRowSelected(e)}isEntireRowSelected(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?0<this.selectedByRowHeader.size:this.selectedByRowHeader.has(e)}isSelectedByColumnHeader(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(e)}isEntireColumnSelected(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?0<this.selectedByColumnHeader.size:this.selectedByColumnHeader.has(e)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByCorner}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isAreaCornerVisible(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=this.tableProps.countRows(),r=this.tableProps.countCols();(e||t||0!==n&&0!==r)&&(t=this.tableProps.createCellCoords(t?-1:0,e?-1:0),e=this.tableProps.createCellCoords(n-1,r-1),this.clear(),this.setRangeStartOnly(t),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(e),this.finish())}selectCells(e){var t=(0,h.detectSelectionType)(e);if(t===h.SELECTION_TYPE_EMPTY)return!1;if(t===h.SELECTION_TYPE_UNRECOGNIZED)throw new Error((0,f.toSingleLine)`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=(0,h.normalizeSelectionFactory)(t,{propToCol:e=>this.tableProps.propToCol(e),keepDirection:!0}),o=this.tableProps.countRows(),s=this.tableProps.countCols();t=!e.some(e=>{var[e,t,n,r]=i(e);return!((0,h.isValidCoord)(e,o)&&(0,h.isValidCoord)(t,s)&&(0,h.isValidCoord)(n,o)&&(0,h.isValidCoord)(r,s))});return t&&(this.clear(),(0,l.arrayEach)(e,e=>{var[e,t,n,r]=i(e);this.setRangeStartOnly(this.tableProps.createCellCoords(e,t),!1),this.setRangeEnd(this.tableProps.createCellCoords(n,r)),this.finish()})),t}selectColumns(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:-1,e="string"==typeof e?this.tableProps.propToCol(e):e,t="string"==typeof t?this.tableProps.propToCol(t):t,r=this.tableProps.countCols(),i=this.tableProps.countRows(),r=(0,h.isValidCoord)(e,r)&&(0,h.isValidCoord)(t,r);return r&&(this.setRangeStartOnly(this.tableProps.createCellCoords(n,e)),this.setRangeEnd(this.tableProps.createCellCoords(i-1,t)),this.finish()),r}selectRows(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:-1,r=this.tableProps.countRows(),i=this.tableProps.countCols(),r=(0,h.isValidCoord)(e,r)&&(0,h.isValidCoord)(t,r);return r&&(this.setRangeStartOnly(this.tableProps.createCellCoords(e,n)),this.setRangeEnd(this.tableProps.createCellCoords(t,i-1)),this.finish()),r}refresh(){if(this.highlight.getCustomSelections().forEach(e=>{e.commit()}),this.isSelected()){var e=this.highlight.getCell(),t=this.getLayerLevel();e.commit().syncWith(this.selectedRange.current());for(let e=0;e<this.selectedRange.size();e+=1){this.highlight.useLayerLevel(e);var n=this.highlight.createOrGetArea(),r=this.highlight.createOrGetHeader(),i=this.highlight.createOrGetActiveHeader();n.commit(),r.commit(),i.commit()}this.highlight.useLayerLevel(t)}}}(0,a.mixin)(p,c.default),t.default=p},(e,t,n)=>{"use strict";t.__esModule=!0,n(203);class r{constructor(e){this.ranges=[],this.createCellRange=e}isEmpty(){return 0===this.size()}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(0)}previous(){return this.peekByIndex(-1)}includes(t){return this.ranges.some(e=>e.includes(t))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=this.size()+e-1;let t;return t=0<=e?this.ranges[e]:t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}t.default=r},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(447)),r=r(n(549));class o{constructor(e,t){this.range=e,this.options=t}transformStart(n,r){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r=this.options.createCellCoords(n,r),o=this.range.current().highlight,{row:s,col:a}=this.options.visualToRenderableCoords(o);let l=o,u=0,c=0;if(this.runLocalHooks("beforeTransformStart",r),null!==s&&null!==a){let e=this.options.countRows(),t=this.options.countCols();var o=this.options.fixedRowsBottom(),d=this.options.minSpareRows(),h=this.options.minSpareCols(),f=this.options.autoWrapRow(),p=this.options.autoWrapCol(),n=(s+n>e-1?i&&0<d&&!(o&&s>=e-o-1)?(this.runLocalHooks("insertRowRequire",e),e=this.options.countRows()):p&&(r.row=1-e,r.col=a+r.col===t-1?1-t:1):p&&s+r.row<0&&0<=a+r.col&&(r.row=e-1,r.col=a+r.col===0?t-1:-1),a+r.col>t-1?i&&0<h?(this.runLocalHooks("insertColRequire",t),t=this.options.countCols()):f&&(r.row=s+r.row===e-1?1-e:1,r.col=1-t):f&&a+r.col<0&&0<=s+r.row&&(r.row=s+r.row===0?e-1:-1,r.col=t-1),this.options.createCellCoords(s+r.row,a+r.col));u=0,c=0,n.row<0?(u=-1,n.row=0):0<n.row&&n.row>=e&&(u=1,n.row=e-1),n.col<0?(c=-1,n.col=0):0<n.col&&n.col>=t&&(c=1,n.col=t-1),l=this.options.renderableToVisualCoords(n)}return this.runLocalHooks("afterTransformStart",l,u,c),l}transformEnd(e,t){e=this.options.createCellCoords(e,t),t=this.range.current();let n=t.to,r=0,i=0;this.runLocalHooks("beforeTransformEnd",e);var o,{row:s,col:a}=this.options.visualToRenderableCoords(t.highlight);return null!==s&&null!==a&&(s=this.options.countRows(),a=this.options.countCols(),{row:t,col:o}=this.options.visualToRenderableCoords(t.to),t=this.options.createCellCoords(t+e.row,o+e.col),r=0,i=0,t.row<0?(r=-1,t.row=0):0<t.row&&t.row>=s&&(r=1,t.row=s-1),t.col<0?(i=-1,t.col=0):0<t.col&&t.col>=a&&(i=1,t.col=a-1),n=this.options.renderableToVisualCoords(t)),this.runLocalHooks("afterTransformEnd",n,r,i),n}}(0,i.mixin)(o,r.default),t.default=o},(e,t,n)=>{"use strict";t.__esModule=!0,t.detectSelectionType=p,t.isValidCoord=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1/0;return"number"==typeof e&&0<=e&&e<t},t.normalizeSelectionFactory=g,t.transformSelectionToColumnDistance=function(e){var t=p(e);if(t===a||t===l)return[];const r=g(t),i=new Set,n=((0,s.arrayEach)(e,e=>{var[,e,,t]=r(e);const n=Math.max(e,0);e=t-n+1;(0,s.arrayEach)(Array.from(new Array(e),(e,t)=>n+t),e=>{i.has(e)||i.add(e)})}),Array.from(i).sort((e,t)=>e-t)),o=(0,s.arrayReduce)(n,(e,t,n,r)=>(0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e),[]);return o},t.transformSelectionToRowDistance=function(e){var t=p(e);if(t===a||t===l)return[];const r=g(t),i=new Set,n=((0,s.arrayEach)(e,e=>{var[e,,t]=r(e);const n=Math.max(e,0);e=t-n+1;(0,s.arrayEach)(Array.from(new Array(e),(e,t)=>n+t),e=>{i.has(e)||i.add(e)})}),Array.from(i).sort((e,t)=>e-t)),o=(0,s.arrayReduce)(n,(e,t,n,r)=>(0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e),[]);return o},n(273),n(203);var i=n(476),s=n(444),d=n(305);const a=0,l=(t.SELECTION_TYPE_UNRECOGNIZED=a,1),o=(t.SELECTION_TYPE_EMPTY=l,2),h=(t.SELECTION_TYPE_ARRAY=o,3),r=[t.SELECTION_TYPE_OBJECT=h,o],u=(t.SELECTION_TYPES=r,[["number"],["number","string"],["number","undefined"],["number","string","undefined"]]),c=Symbol("root"),f=Symbol("child");function p(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:c;if(t!==c&&t!==f)throw new Error("The second argument is used internally only and cannot be overwritten.");var n=Array.isArray(e),t=t===c;let r=a;return n&&(n=e[0],0===e.length?r=l:t&&n instanceof i.CellRange?r=h:t&&Array.isArray(n)?r=p(n,f):2<=e.length&&e.length<=4&&!e.some((e,t)=>!u[t].includes(typeof e))&&(r=o)),r}function g(l){let{keepDirection:u=!1,propToCol:c}=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(r.includes(l))return function(e){var t,n,r=l===h;let i=r?e.from.row:e[0],o=r?e.from.col:e[1],s=r?e.to.row:e[2],a=r?e.to.col:e[3];return"function"==typeof c&&("string"==typeof o&&(o=c(o)),"string"==typeof a)&&(a=c(a)),(0,d.isUndefined)(s)&&(s=i),(0,d.isUndefined)(a)&&(a=o),u||(r=i,e=o,t=s,n=a,i=Math.min(r,t),o=Math.min(e,n),s=Math.max(r,t),a=Math.max(e,n)),[i,o,s,a]};throw new Error("Unsupported selection ranges schema type was provided.")}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,r(n(585))),i=(t.DataMap=i.default,r(n(588))),i=(t.MetaManager=i.default,r(n(592))),r=(t.metaSchemaFactory=i.default,n(597)),i=(t.replaceData=r.replaceData,n(598)),r=(t.DynamicCellMetaMod=i.DynamicCellMetaMod,n(599));t.ExtendMetaPropertiesMod=r.ExtendMetaPropertiesMod},(e,t,n)=>{"use strict";t.__esModule=!0,n(273),n(203);var r=n(586),i=n(542),d=n(447),u=n(444),h=n(461),o=n(305);t.default=class f{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,n){this.instance=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}createMap(){var r=this.getSchema();if(void 0===r)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var i,o=this.tableMeta.columns;let s;if(this.colToPropCache=[],this.propToColCache=new Map,o){let e=0,t=0,n=!1;for("function"==typeof o?(i=(0,d.deepObjectSize)(r),e=0<i?i:this.countFirstRowKeys(),n=!0):(i=this.tableMeta.maxCols,e=Math.min(i,o.length)),s=0;s<e;s++){var a,l=n?o(s):o[s];(0,d.isObject)(l)&&(void 0!==l.data&&(a=n?t:s,this.colToPropCache[a]=l.data,this.propToColCache.set(l.data,a)),t+=1)}}else this.recursiveDuckColumns(r)}countFirstRowKeys(){return(0,i.countFirstRowKeys)(this.dataSource)}recursiveDuckColumns(e,t,n){let r=t,i=n,o;return void 0===r&&(r=0,i=""),"object"!=typeof e||Array.isArray(e)||(0,d.objectEach)(e,(e,t)=>{null===e?(o=i+t,this.colToPropCache.push(o),this.propToColCache.set(o,r),r+=1):r=this.recursiveDuckColumns(e,r,t+".")}),r}colToProp(e){var t;return!1===Number.isInteger(e)||null===(t=this.instance.toPhysicalColumn(e))?e:this.colToPropCache&&(0,o.isDefined)(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){var t=this.propToColCache.get(e);return(0,o.isDefined)(t)?this.instance.toVisualColumn(t):null===(t=this.instance.toVisualColumn(e))?e:t}getSchema(){var e=this.tableMeta.dataSchema;return e?"function"==typeof e?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?(0,d.duckSchema)(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,{source:n,mode:r="above"}=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=this.instance.countSourceRows();let o=i,s=0,a=e;if((a="number"!=typeof a||a>=i?i:a)<this.instance.countRows()&&(o=this.instance.toPhysicalRow(a)),!1===this.instance.runHooks("beforeCreateRow",a,t,n)||null===o)return{delta:0};for(var l=this.tableMeta.maxRows,u=this.getSchema().length,c=[];s<t&&i+s<l;){let e=null;"array"===this.instance.dataType?this.tableMeta.dataSchema?e=(0,d.deepClone)(this.getSchema()):(e=[],(0,h.rangeEach)(u-1,()=>e.push(null))):"function"===this.instance.dataType?e=this.tableMeta.dataSchema(a+s):(e={},(0,d.deepExtend)(e,this.getSchema())),c.push(e),s+=1}return this.instance.rowIndexMapper.insertIndexes(a,s),"below"===r&&(o=Math.min(o+1,i)),this.spliceData(o,0,c),r=this.instance.toVisualRow(o),this.instance.countSourceRows()===c.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),0<s&&(null==e?this.metaManager.createRow(null,s):"auto"!==n&&this.metaManager.createRow(o,t)),this.instance.runHooks("afterCreateRow",r,s,n),this.instance.forceFullRender=!0,{delta:s,startPhysicalIndex:o}}createCol(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,{source:n,mode:r="start"}=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var i=this.dataSource,o=this.tableMeta.maxCols,s=this.instance.countSourceCols();let a=e;if(("number"!=typeof a||a>=s)&&(a=s),!1===this.instance.runHooks("beforeCreateCol",a,t,n))return{delta:0};let l=s;a<this.instance.countCols()&&(l=this.instance.toPhysicalColumn(a));var u=this.instance.countSourceRows();let c=this.instance.countCols(),d=0,h=l;for(r=h="end"===r?Math.min(h+1,s):h;d<t&&c<o;){if("number"!=typeof a||a>=c)if(0<u)for(let e=0;e<u;e+=1)void 0===i[e]&&(i[e]=[]),i[e].push(null);else i.push([null]);else for(let e=0;e<u;e++)i[e].splice(h,0,null);d+=1,h+=1,c+=1}return this.instance.columnIndexMapper.insertIndexes(a,d),0<d&&(null==e?this.metaManager.createColumn(null,d):"auto"!==n&&this.metaManager.createColumn(r,t)),s=this.instance.toVisualColumn(r),this.instance.runHooks("afterCreateCol",s,d,n),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:d,startPhysicalIndex:r}}removeRow(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=2<arguments.length?arguments[2]:void 0,e=Number.isInteger(e)?e:-n,n=this.visualRowsToPhysical(e,n),i=this.instance.countSourceRows();return!1!==this.instance.runHooks("beforeRemoveRow",e=(i+e)%i,n.length,n,r)&&(i=n.length,this.filterData(e,i,n),e<this.instance.countRows()&&(this.instance.rowIndexMapper.removeIndexes(n),t=(0,o.isDefined)(this.tableMeta.columns)||(0,o.isDefined)(this.tableMeta.dataSchema),0===this.instance.rowIndexMapper.getNotTrimmedIndexesLength())&&!1===t&&this.instance.columnIndexMapper.setIndexesSequence([]),n.slice(0).sort((e,t)=>t-e).forEach(e=>{this.metaManager.removeRow(e,1)}),this.instance.runHooks("afterRemoveRow",e,i,n,r),this.instance.forceFullRender=!0)}removeCol(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,t=2<arguments.length?arguments[2]:void 0;if("object"===this.instance.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var e="number"!=typeof e?-n:e,e=(this.instance.countCols()+e)%this.instance.countCols(),r=this.visualColumnsToPhysical(e,n),i=r.slice(0).sort((e,t)=>t-e);if(!1===this.instance.runHooks("beforeRemoveCol",e,n,r,t))return!1;let o=!0;var s=i.length,a=this.dataSource;for(let e=0;e<s;e++)o&&r[0]!==r[e]-e&&(o=!1);if(o)for(let e=0,t=this.instance.countSourceRows();e<t;e++)a[e].splice(r[0],n),0===e&&this.metaManager.removeColumn(r[0],n);else for(let t=0,e=this.instance.countSourceRows();t<e;t++)for(let e=0;e<s;e++)a[t].splice(i[e],1),0===t&&this.metaManager.removeColumn(i[e],1);return e<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(r),0===this.instance.columnIndexMapper.getNotTrimmedIndexesLength())&&this.instance.rowIndexMapper.setIndexesSequence([]),this.instance.runHooks("afterRemoveCol",e,n,r,t),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,n){for(var r=(i=this.instance.getDataAtCol(e)).slice(t,t+n),i=i.slice(t+n),o=arguments.length,s=new Array(3<o?o-3:0),a=3;a<o;a++)s[a-3]=arguments[a];(0,u.extendArray)(s,i);let l=0;for(;l<n;)s.push(null),l+=1;return(0,u.to2dArray)(s),this.instance.populateFromArray(t,e,s,null,null,"spliceCol"),r}spliceRow(e,t,n){for(var r=(i=this.instance.getSourceDataAtRow(e)).slice(t,t+n),i=i.slice(t+n),o=arguments.length,s=new Array(3<o?o-3:0),a=3;a<o;a++)s[a-3]=arguments[a];(0,u.extendArray)(s,i);let l=0;for(;l<n;)s.push(null),l+=1;return this.instance.populateFromArray(e,t,[s],null,null,"spliceRow"),r}spliceData(e,t,n){!1!==this.instance.runHooks("beforeDataSplice",e,t,n)&&(t=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)],this.dataSource.length=0,t.forEach(e=>this.dataSource.push(e)))}filterData(e,t,n){let r=this.instance.runHooks("filterData",e,t,n);!1===Array.isArray(r)&&(r=this.dataSource.filter((e,t)=>-1===n.indexOf(t))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(e,t){var e=this.instance.toPhysicalRow(e),r=this.dataSource[e],n=this.instance.runHooks("modifyRowData",e);let i=null;if((r=isNaN(n)?n:r)&&r.hasOwnProperty&&(0,d.hasOwnProperty)(r,t))i=r[t];else if("string"==typeof t&&-1<t.indexOf(".")){var o=t.split(".");let n=r;if(!n)return null;for(let e=0,t=o.length;e<t;e++)if(void 0===(n=n[o[e]]))return null;i=n}else"function"==typeof t&&(i=t(this.dataSource.slice(e,e+1)[0]));return i=this.instance.hasHook("modifyData")&&(n=(0,d.createObjectPropListener)(i),this.instance.runHooks("modifyData",e,this.propToCol(t),n,"get"),n.isTouched())?n.value:i}getCopyable(e,t){return this.instance.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,n,r){e=this.instance.toPhysicalRow(e);let i=r;var r=this.dataSource[e],t=this.instance.runHooks("modifyRowData",e),r=isNaN(t)?t:r;if(this.instance.hasHook("modifyData")&&(t=(0,d.createObjectPropListener)(i),this.instance.runHooks("modifyData",e,this.propToCol(n),t,"set"),t.isTouched())&&(i=t.value),r&&r.hasOwnProperty&&(0,d.hasOwnProperty)(r,n))r[n]=i;else if("string"==typeof n&&-1<n.indexOf(".")){var o,s=n.split(".");let e=r,t=0;for(t=0,o=s.length-1;t<o;t++)void 0===e[s[t]]&&(e[s[t]]={}),e=e[s[t]];e[s[t]]=i}else"function"==typeof n?n(this.dataSource.slice(e,e+1)[0],i):r[n]=i}visualRowsToPhysical(e,t){var n,r=this.instance.countSourceRows(),i=[];let o=(r+e)%r,s=t;for(;o<r&&s;)n=this.instance.toPhysicalRow(o),i.push(n),--s,o+=1;return i}visualColumnsToPhysical(e,t){var n=this.instance.countCols(),r=[];let i=(n+e)%n,o=t;for(;i<n&&o;){var s=this.instance.toPhysicalColumn(i);r.push(s),--o,i+=1}return r}clear(){for(let t=0;t<this.instance.countSourceRows();t++)for(let e=0;e<this.instance.countCols();e++)this.set(t,this.colToProp(e),"")}getLength(){var e=this.tableMeta.maxRows;let t;return t=e<0||0===e?0:e||1/0,e=this.instance.rowIndexMapper.getNotTrimmedIndexesLength(),Math.min(e,t)}getAll(){var e={row:0,col:0},t={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-t.row!=0||this.instance.countSourceRows()?this.getRange(e,t,f.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,n){var r=[];let i,o;var s=this.tableMeta.maxRows,a=this.tableMeta.maxCols;if(0===s||0===a)return[];var l=n===f.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,u=Math.min(Math.max(s-1,0),Math.max(e.row,t.row)),c=Math.min(Math.max(a-1,0),Math.max(e.col,t.col));for(i=Math.min(e.row,t.row);i<=u;i++){var d=[],h=0<=i?this.instance.toPhysicalRow(i):i;for(o=Math.min(e.col,t.col);o<=c&&null!==h;o++)d.push(l.call(this,i,this.colToProp(o)));null!==h&&r.push(d)}return r}getText(e,t){return(0,r.stringify)(this.getRange(e,t,f.DESTINATION_RENDERER))}getCopyableText(e,t){return(0,r.stringify)(this.getRange(e,t,f.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(587);t.parse=n.parse,t.stringify=n.stringify},(e,t)=>{"use strict";t.__esModule=!0,t.parse=function(r){var i=[[""]];if(0!==r.length){let e=0,t=0,n;for(;0<r.length&&n!==r.length;)if(n=r.length,r.match(u))r=r.replace(u,""),e+=1,i[t][e]="";else if(r.match(a))r=r.replace(a,""),e=0,t+=1,i[t]=[""];else{let n="";if(r.startsWith('"')){let e=0,t=!0;for(;t;){var o=r.slice(0,1);'"'===o&&(e+=1),n+=o,(0===(r=r.slice(1)).length||r.match(/^[\t\r\n]/)&&e%2==0)&&(t=!1)}n=n.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,e=>new Array(Math.floor(e.length/2)).fill('"').join(""))}else{var s=r.match(l);n=s?s[0]:"",r=r.slice(n.length)}i[t][e]=n}}return i},t.stringify=function(e){let t,n,r,i,o="",s;for(t=0,n=e.length;t<n;t+=1){for(i=e[t].length,r=0;r<i;r+=1)0<r&&(o+="\t"),"string"==typeof(s=e[t][r])?-1<s.indexOf("\n")?o+=`"${s.replace(/"/g,'""')}"`:o+=s:o+=null==s?"":s;t!==n-1&&(o+="\n")}return o};const a=/^(\r\n|\n\r|\r|\n)/,l=/^[^\t\r\n]+/,u=/^\t/},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(273),r(n(589))),o=r(n(593)),s=r(n(594)),a=r(n(596)),r=r(n(549)),n=n(447);class l{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];this.hot=e,this.globalMeta=new i.default(e),this.tableMeta=new o.default(this.globalMeta),this.columnMeta=new s.default(this.globalMeta),this.cellMeta=new a.default(this.columnMeta),n.forEach(e=>new e(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,n){var{visualRow:n,visualColumn:r}=n,i=this.cellMeta.getMeta(e,t);return i.visualRow=n,i.visualCol=r,i.row=e,i.col=t,this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,t,n){if("string"!=typeof n)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,n)}setCellMeta(e,t,n,r){this.cellMeta.setMeta(e,t,n,r)}updateCellMeta(e,t,n){this.cellMeta.updateMeta(e,t,n)}removeCellMeta(e,t,n){this.cellMeta.removeMeta(e,t,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){this.cellMeta.createRow(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:1)}removeRow(e){this.cellMeta.removeRow(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:1)}createColumn(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}t.default=l,(0,n.mixin)(l,r.default)},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(447)),o=n(590),s=r(n(592));t.default=class{constructor(e){this.metaCtor=class{},this.meta=this.metaCtor.prototype,(0,i.extend)(this.meta,(0,s.default)()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;(0,i.extend)(this.meta,e),(0,o.extendByMetaType)(this.meta,{...e,type:null!=(t=e.type)?t:this.meta.type},e)}}},(e,t,n)=>{"use strict";t.__esModule=!0,t.assert=function(e,t){if(!e())throw new Error("Assertion failed: "+t)},t.columnFactory=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];function n(){}(0,l.inherit)(n,e);for(let e=0;e<t.length;e++)n.prototype[t[e]]=void 0;return n},t.extendByMetaType=function(o,e){let s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:o;var t="string"==typeof e.type?(0,r.getCellType)(e.type):e.type;o._automaticallyAssignedMetaProps&&(0,l.objectEach)(e,(e,t)=>{o._automaticallyAssignedMetaProps.delete(t)});if((0,l.isObject)(t)){s!==o||o._automaticallyAssignedMetaProps||(o._automaticallyAssignedMetaProps=new Set);const a={};(0,l.objectEach)(t,(e,t)=>{var n,r,i;n=t,r=s,"CELL_TYPE"!==n&&(null!=(i=r._automaticallyAssignedMetaProps)&&i.has(n)||!(0,l.hasOwnProperty)(r,n))&&(a[t]=e,null!=(i=o._automaticallyAssignedMetaProps))&&i.add(t)}),(0,l.extend)(o,a)}},t.isNullish=function(e){return null==e},t.isUnsignedNumber=function(e){return Number.isInteger(e)&&0<=e},n(273);var l=n(447),r=n(591)},(e,t,n)=>{"use strict";var r=n(196),r=(t.__esModule=!0,t.getCellType=function(e){if(u(e))return i(e);throw Error(`You declared cell type "${e}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`)},t.registerCellType=function(e,t){"string"!=typeof e&&(e=(t=e).CELL_TYPE);var{editor:n,renderer:r,validator:i}=t;n&&(0,o.registerEditor)(e,n);r&&(0,s.registerRenderer)(e,r);i&&(0,a.registerValidator)(e,i);l(e,t)},n(273),r(n(456))),o=n(453),s=n(464),a=n(465);const{register:l,getItem:i,hasItem:u,getNames:c,getValues:d}=(0,r.default)("cellTypes");t.getRegisteredCellTypes=d,t.getRegisteredCellTypeNames=c,t.hasCellType=u},(e,t,n)=>{"use strict";t.__esModule=!0;var o=n(305),s=n(447);t.default=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol(e){let t;var n,r;for(t=0,n=this.countRows();t<n;t++)if(r=this.getDataAtCell(t,e),!1===(0,o.isEmpty)(r))return!1;return!0},isEmptyRow(e){let t;var n,r,i;for(t=0,n=this.countCols();t<n;t++)if(r=this.getDataAtCell(e,t),!1===(0,o.isEmpty)(r))return"object"==typeof r&&(i=this.getCellMeta(e,t),(0,s.isObjectEqual)(this.getSchema()[i.prop],r));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0})},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(447),i=n(590);t.default=class{constructor(e){e=e.getMetaConstructor();this.meta=new e}getMeta(){return this.meta}updateMeta(e){(0,r.extend)(this.meta,e),(0,i.extendByMetaType)(this.meta,e,e)}}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(447)),o=n(590),s=r(n(595));const a=["data","width"];t.default=class{constructor(e){this.globalMeta=e,this.metas=new s.default(()=>this._createMeta())}updateMeta(e,t){e=this.getMeta(e);(0,i.extend)(e,t),(0,o.extendByMetaType)(e,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return(0,o.columnFactory)(this.globalMeta.getMetaConstructor(),a).prototype}}},(e,t,n)=>{"use strict";t.__esModule=!0,n(203);var r=n(444),o=n(590);class i{constructor(e){this.valueFactory=e,this.data=[],this.index=[],this.holes=new Set}obtain(e){(0,o.assert)(()=>(0,o.isUnsignedNumber)(e),"Expecting an unsigned number.");var t=this._getStorageIndexByKey(e);let n;return 0<=t?void 0===(n=this.data[t])&&(n=this.valueFactory(e),this.data[t]=n):(n=this.valueFactory(e),0<this.holes.size?(t=this.holes.values().next().value,this.holes.delete(t),this.data[t]=n,this.index[e]=t):(this.data.push(n),this.index[e]=this.data.length-1)),n}insert(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=((0,o.assert)(()=>(0,o.isUnsignedNumber)(e)||(0,o.isNullish)(e),"Expecting an unsigned number or null/undefined argument."),[]),r=this.data.length;for(let e=0;e<t;e++)n.push(r+e),this.data.push(void 0);var i=(0,o.isNullish)(e)?this.index.length:e;this.index=[...this.index.slice(0,i),...n,...this.index.slice(i)]}remove(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=((0,o.assert)(()=>(0,o.isUnsignedNumber)(e)||(0,o.isNullish)(e),"Expecting an unsigned number or null/undefined argument."),this.index.splice((0,o.isNullish)(e)?this.index.length-t:e,t));for(let e=0;e<n.length;e++){var r=n[e];"number"==typeof r&&this.holes.add(r)}}size(){return this.data.length-this.holes.size}values(){return(0,r.arrayFilter)(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){const t=[];for(let e=0;e<this.data.length;e++){var n=this._getKeyByStorageIndex(e);-1!==n&&t.push([n,this.data[e]])}let r=0;return{next:()=>{var e;return r<t.length?(e=t[r],r+=1,{value:e,done:!1}):{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}t.default=i},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),n(447)),o=n(590),s=r(n(595));t.default=class{constructor(e){this.columnMeta=e,this.metas=new s.default(()=>this._createRow())}updateMeta(e,t,n){e=this.getMeta(e,t);(0,i.extend)(e,n),(0,o.extendByMetaType)(e,n)}createRow(e,t){this.metas.insert(e,t)}createColumn(t,n){for(let e=0;e<this.metas.size();e++)this.metas.obtain(e).insert(t,n)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(t,n){for(let e=0;e<this.metas.size();e++)this.metas.obtain(e).remove(t,n)}getMeta(e,t,n){e=this.metas.obtain(e).obtain(t);return void 0===n?e:e[n]}setMeta(e,t,n,r){e=this.metas.obtain(e).obtain(t);null!=(t=e._automaticallyAssignedMetaProps)&&t.delete(n),e[n]=r}removeMeta(e,t,n){delete this.metas.obtain(e).obtain(t)[n]}getMetas(){var t=[],n=Array.from(this.metas.values());for(let e=0;e<n.length;e++)t.push(...n[e].values());return t}getMetasAtRow(e){(0,o.assert)(()=>(0,o.isUnsignedNumber)(e),"Expecting an unsigned number.");var t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new s.default(e=>this._createMeta(e))}_createMeta(e){return new(this.columnMeta.getMetaConstructor(e))}}},(e,t,n)=>{"use strict";var r=n(196),p=(t.__esModule=!0,t.replaceData=function(t,e,n,r){var{hotInstance:i,dataMap:r,dataSource:o,internalSource:s,source:a,metaManager:l,firstRun:u}=r,c=(0,p.toUpperCaseFirst)(s),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":(0,g.isFunction)(d.dataSchema)?i.dataType="function":i.dataType="object";r&&r.destroy();t=i.runHooks("before"+c,t,u,a);r=new m.default(i,t,l);if(e(r),"object"==typeof t&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw new Error(s+` only accepts array of objects or array of arrays (${typeof t} given)`);{var h=r.getSchema();t=[];let n,e=0;var f;for(e=0,f=d.startRows;e<f;e++){if("object"!==i.dataType&&"function"!==i.dataType||!d.dataSchema)if("array"===i.dataType)n=(0,y.deepClone)(h[0]);else{n=[];for(let e=0,t=d.startCols;e<t;e++)n.push(null)}else n=(0,y.deepClone)(h);t.push(n)}}}Array.isArray(t[0])&&(i.dataType="array");d.data=t,r.dataSource=t,o.data=t,o.dataType=i.dataType,o.colToProp=r.colToProp.bind(r),o.propToCol=r.propToCol.bind(r),o.countCachedColumns=r.countCachedColumns.bind(r),n(r),i.runHooks("after"+c,t,u,a),u||(i.runHooks("afterChange",null,s),i.render())},n(203),n(273),n(303)),g=n(445),m=r(n(585)),y=n(447)},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,r(n(454))),u=n(447),c=n(445);t.DynamicCellMetaMod=class{constructor(e){this.metaManager=e,this.metaSyncMemo=new Map,e.addLocalHook("afterGetCellMeta",e=>this.extendCellMeta(e)),i.default.getSingleton().add("beforeRender",e=>{e&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(t){var{row:n,col:r}=t;if(null==(i=this.metaSyncMemo.get(n))||!i.has(r)){var{visualRow:i,visualCol:o}=t,s=this.metaManager.hot,a=s.colToProp(o),l=(t.prop=a,s.runHooks("beforeGetCellMeta",i,o,t),(0,u.hasOwnProperty)(t,"type")?t.type:null);let e=(0,c.isFunction)(t.cells)?t.cells(n,r,a):null;l&&(e?e.type=null!=(a=e.type)?a:l:e={type:l}),e&&this.metaManager.updateCellMeta(n,r,e),s.runHooks("afterGetCellMeta",i,o,t),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(r)}}}},(e,t,n)=>{"use strict";t.__esModule=!0,n(273);t.ExtendMetaPropertiesMod=class{constructor(e){this.metaManager=e,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(e){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===e)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(e,t,n){if(!n)throw new Error(`The \`${e}\` option can not be updated after the Handsontable is initialized.`)}}]]),this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{var{target:e,onChange:n=()=>{}}=e,r="string"==typeof e,i=r?e:t,o="_"+i;this.metaManager.globalMeta.meta[o]=this.metaManager.globalMeta.meta[i],this.installPropWatcher(t,o,n),r&&this.installPropWatcher(e,o,n)})}installPropWatcher(n,r,i){const o=this;Object.defineProperty(this.metaManager.globalMeta.meta,n,{get(){return this[r]},set(e){var t=!o.usageTracker.has(n);o.usageTracker.add(n),i.call(o,n,e,t),this[r]=e},enumerable:!0,configurable:!0})}}},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(601);t.createShortcutManager=n.createShortcutManager},(e,t,n)=>{"use strict";t.__esModule=!0;var a=n(462),l=n(602),u=n(604);t.createShortcutManager=e=>{var{ownerWindow:e,handleEvent:t,beforeKeyDown:n,afterKeyDown:r}=e;const i=(0,a.createUniqueMap)({errorIdExists:e=>`The "${e}" context name is already registered.`});let c="grid";const o=()=>c,d=e=>i.getItem(e);let h=!1;const s=(0,u.useRecorder)(e,t,n,r,(t,n)=>{var e=d(c);let r=!1;if(e.hasShortcut(n)){var i=e.getShortcuts(n);for(let e=0;e<i.length;e++){var{callback:o,runOnlyIf:s,preventDefault:a,stopPropagation:l,captureCtrl:u}=i[e];if(!1!==s(t)&&(h=u,r=!1===o(t,n),h=!1,a&&t.preventDefault(),l&&t.stopPropagation(),r))break}}return r});return s.mount(),{addContext:e=>{var t=(0,l.createContext)(e);return i.addItem(e,t),t},getActiveContextName:o,getContext:d,setActiveContextName:e=>{c=e},isCtrlPressed:()=>!h&&(s.isPressed("control")||s.isPressed("meta")),releasePressedKeys:()=>s.releasePressedKeys(),destroy:()=>s.unmount()}}},(e,t,n)=>{"use strict";t.__esModule=!0,n(273),n(203);var r=n(462),d=n(603),h=n(305),f=n(445),s=n(447),p=n(443);t.createContext=t=>{function i(){let{keys:e,callback:t,group:n,runOnlyIf:r=()=>!0,captureCtrl:i=!1,preventDefault:o=!0,stopPropagation:s=!1,relativeToGroup:a,position:l}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if((0,h.isUndefined)(n))throw new Error("You need to define the shortcut's group.");if(!1===(0,f.isFunction)(t))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(e))throw new Error((0,p.toSingleLine)`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const u={callback:t,group:n,runOnlyIf:r,captureCtrl:i,preventDefault:o,stopPropagation:s};(0,h.isDefined)(a)&&([u.relativeToGroup,u.position]=[a,l]),e.forEach(t=>{t=(0,d.normalizeKeys)(t);if(c.hasItem(t)){var n=c.getItem(t);let e=n.findIndex(e=>e.group===a);-1!==e?"before"===l?--e:e+=1:e=n.length,n.splice(e,0,u)}else c.addItem(t,[u])})}const c=(0,r.createUniqueMap)({errorIdExists:e=>`The "${e}" shortcut is already registered in the "${t}" context.`});const o=e=>{e=(0,d.normalizeKeys)(e);c.removeItem(e)};return{addShortcut:i,addShortcuts:function(e){let r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};e.forEach(n=>{(0,s.objectEach)(r,(e,t)=>{!1===Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=r[t])}),i(n)})},getShortcuts:e=>{e=(0,d.normalizeKeys)(e),e=c.getItem(e);return(0,h.isDefined)(e)?e.slice():[]},hasShortcut:e=>{e=(0,d.normalizeKeys)(e);return c.hasItem(e)},removeShortcutsByKeys:o,removeShortcutsByGroup:r=>{c.getItems().forEach(e=>{var[e,t]=e,n=t.filter(e=>e.group!==r);0===n.length?o((0,d.getKeysList)(e)):(t.length=0,t.push(...n))})}}}},(e,t)=>{"use strict";t.__esModule=!0;const n=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]);t.normalizeKeys=e=>e.map(e=>{e=e.toLowerCase();return n.has(e)?n.get(e):e}).sort().join("+"),t.getKeysList=e=>e.split("+");t.normalizeEventKey=e=>e.toLowerCase()},(e,t,n)=>{"use strict";t.__esModule=!0,t.useRecorder=function(t,i,e,o,s){const a=e=>p.includes(e),l=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=[];return e.altKey&&n.push("alt"),t&&(e.ctrlKey||e.metaKey)?n.push("control/meta"):(e.ctrlKey&&n.push("control"),e.metaKey&&n.push("meta")),e.shiftKey&&n.push("shift"),n},n=t=>{if(!1!==i(t)){var n=e(t);if(229!==t.keyCode&&!1!==n&&!(0,d.isImmediatePropagationStopped)(t)){n=(0,c.normalizeEventKey)(t.key);let e=[];a(n)?g.press(n):e=l(t);var r=[n].concat(e);!s(t,r)&&((0,f.isMacOS)()&&e.includes("meta")||!(0,f.isMacOS)()&&e.includes("control"))&&s(t,[n].concat(l(t,!0))),o(t)}}},r=e=>{!1!==i(e)&&(e=(0,c.normalizeEventKey)(e.key),!1!==a(e))&&g.release(e)},u=()=>{g.releaseAll()};return{mount:()=>{let e=t;for(;e;)e.document.documentElement.addEventListener("keydown",n),e.document.documentElement.addEventListener("keyup",r),e.document.documentElement.addEventListener("blur",u),e=(0,h.getParentWindow)(e)},unmount:()=>{let e=t;for(;e;)e.document.documentElement.removeEventListener("keydown",n),e.document.documentElement.removeEventListener("keyup",r),e.document.documentElement.removeEventListener("blur",u),e=(0,h.getParentWindow)(e)},isPressed:e=>g.isPressed(e),releasePressedKeys:()=>g.releaseAll()}},n(203);var t=n(605),c=n(603),d=n(452),h=n(302),f=n(446);const p=["meta","alt","shift","control"],g=(0,t.createKeysObserver)()},(e,t)=>{"use strict";t.__esModule=!0,t.createKeysObserver=function(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(607);t.CELL_TYPE=n.CELL_TYPE,t.TextCellType=n.TextCellType},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(608),n=n(616),r={CELL_TYPE:t.CELL_TYPE="text",editor:r.TextEditor,renderer:n.textRenderer};t.TextCellType=r},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(609);t.EDITOR_TYPE=n.EDITOR_TYPE,t.TextEditor=n.TextEditor},(e,t,n)=>{"use strict";var r=n(196),a=(t.__esModule=!0,n(610)),i=r(n(457)),l=n(446),u=n(302),o=n(461),s=n(451),c=n(613),d=n(305),h=n(450),f=n(611),p=n(615);const g="ht_editor_hidden",m="textEditor";t.EDITOR_TYPE="text";class y extends a.BaseEditor{static get EDITOR_TYPE(){return"text"}constructor(e){super(e),this.eventManager=new i.default(this),this.autoResize=(0,c.autoResize)(),this.TEXTAREA=void 0,this.textareaStyle=void 0,this.TEXTAREA_PARENT=void 0,this.textareaParentStyle=void 0,this.layerClass=void 0,this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",e=>this.onAfterDocumentKeyDown(e)),this.registerShortcuts()}close(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}prepare(e,t,n,r,i,o){var s=this.state;super.prepare(e,t,n,r,i,o),o.readOnly||(this.refreshDimensions(!0),{allowInvalid:e,fragmentSelection:t}=o,e&&(this.TEXTAREA.value=""),s!==a.EDITOR_STATE.FINISHED&&this.hideEditableElement(),t||(0,l.isMobileBrowser)()||this.focus())}beginEditing(e,t){this.state===a.EDITOR_STATE.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),(0,u.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){var e=this.hot["rootDocument"];this.TEXTAREA=e.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,(0,u.addClass)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),(0,u.addClass)(this.TEXTAREA_PARENT,"handsontableInputHolder"),(0,u.hasClass)(this.TEXTAREA_PARENT,this.layerClass)&&(0,u.removeClass)(this.TEXTAREA_PARENT,this.layerClass),(0,u.addClass)(this.TEXTAREA_PARENT,g),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){(0,l.isEdge)()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",(0,u.removeClass)(this.TEXTAREA_PARENT,this.layerClass),(0,u.addClass)(this.TEXTAREA_PARENT,g)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const t=this.TEXTAREA_PARENT.childNodes;let n=!1;(0,o.rangeEach)(t.length-1,e=>{e=t[e];if((0,u.hasClass)(e,"handsontableEditor"))return!(n=!0)}),(0,u.hasClass)(this.TEXTAREA_PARENT,g)&&(0,u.removeClass)(this.TEXTAREA_PARENT,g),n?this.layerClass="ht_editor_visible":this.layerClass=this.getEditedCellsLayerClass(),(0,u.addClass)(this.TEXTAREA_PARENT,this.layerClass)}refreshValue(){var e=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){var e,t,n,r,i,o,s=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.state!==a.EDITOR_STATE.EDITING&&!s||(this.TD=this.getEditedCell(),this.TD?({top:t,start:r,width:e,maxWidth:i,height:n,maxHeight:o}=this.getEditedCellRect(),this.textareaParentStyle.top=t+"px",this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=r+"px",this.showEditableElement(),t=(0,u.getComputedStyle)(this.TD,this.hot.rootWindow),this.TEXTAREA.style.fontSize=t.fontSize,this.TEXTAREA.style.fontFamily=t.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,r=(0,u.getComputedStyle)(this.TEXTAREA),t=parseInt(r.paddingLeft,10)+parseInt(r.paddingRight,10),r=n-(n=parseInt(r.paddingTop,10)+parseInt(r.paddingBottom,10)),i=i-t,o=o-n,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(e-t,i),minHeight:Math.min(r,o),maxWidth:i,maxHeight:o},!0)):s||this.close())}bindEvents(){this.eventManager.addEventListener(this.TEXTAREA,"cut",e=>e.stopPropagation()),this.eventManager.addEventListener(this.TEXTAREA,"paste",e=>e.stopPropagation()),(0,l.isIOS)()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){var e=this.hot.getShortcutManager().getContext("editor"),t={runOnlyIf:()=>(0,d.isDefined)(this.hot.getSelected()),group:m};const n=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Tab"]],callback:e=>{var t=this.hot.getSettings(),e="function"==typeof t.tabMoves?t.tabMoves(e):t.tabMoves;this.hot.selection.transformStart(e.row,e.col,!0)}},{keys:[["Shift","Tab"]],callback:e=>{var t=this.hot.getSettings(),e="function"==typeof t.tabMoves?t.tabMoves(e):t.tabMoves;this.hot.selection.transformStart(-e.row,-e.col)}},{keys:[["Control","Enter"]],callback:()=>(n(),!1),runOnlyIf:e=>!this.hot.selection.isMultiple()&&!e.altKey,relativeToGroup:h.SHORTCUTS_GROUP_EDITOR,position:"before"},{keys:[["Meta","Enter"]],callback:()=>(n(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple(),relativeToGroup:h.SHORTCUTS_GROUP_EDITOR,position:"before"},{keys:[["Alt","Enter"]],callback:()=>(n(),!1),relativeToGroup:h.SHORTCUTS_GROUP_EDITOR,position:"before"},{keys:[["PageUp"]],callback:()=>{this.hot.selection.transformStart(-this.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:()=>{this.hot.selection.transformStart(this.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:(e,t)=>{var[t]=t;(0,p.updateCaretPosition)(t,this.TEXTAREA)}},{keys:[["End"]],callback:(e,t)=>{var[t]=t;(0,p.updateCaretPosition)(t,this.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}}],t)}unregisterShortcuts(){var e=this.hot.getShortcutManager().getContext("editor");e.removeShortcutsByGroup(h.SHORTCUTS_GROUP_NAVIGATION),e.removeShortcutsByGroup(m),e.removeShortcutsByGroup(f.SHORTCUTS_GROUP_EDITOR)}onAfterDocumentKeyDown(e){-1===[s.KEY_CODES.ARROW_UP,s.KEY_CODES.ARROW_RIGHT,s.KEY_CODES.ARROW_DOWN,s.KEY_CODES.ARROW_LEFT].indexOf(e.keyCode)&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}t.TextEditor=y},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(611);t.EDITOR_STATE=n.EDITOR_STATE,t.EDITOR_TYPE=n.EDITOR_TYPE,t.BaseEditor=n.BaseEditor},(e,t,n)=>{"use strict";var r=n(196),a=(t.__esModule=!0,n(273),n(305)),i=n(447),s=n(450),r=r(n(612)),v=n(302);t.EDITOR_TYPE="base";const l=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),u=(t.EDITOR_STATE=l,"baseEditor");t.SHORTCUTS_GROUP_EDITOR=u;class o{static get EDITOR_TYPE(){return"base"}constructor(e){this.hot=e,this.instance=e,this.state=l.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,n,r,i,o){this.TD=r,this.row=e,this.col=t,this.prop=n,this.originalValue=i,this.cellProperties=o,this.state=l.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let n,r,i,o;t?(t=this.hot.getSelectedLast(),n=Math.max(Math.min(t[0],t[2]),0),r=Math.max(Math.min(t[1],t[3]),0),i=Math.max(t[0],t[2]),o=Math.max(t[1],t[3])):[n,r,i,o]=[this.row,this.col,null,null];t=this.hot.runHooks("modifyGetCellCoords",n,r);Array.isArray(t)&&([n,r]=t);var t=this.hot.getShortcutManager().getContext("editor"),s={runOnlyIf:()=>(0,a.isDefined)(this.hot.getSelected()),group:u};this.isInFullEditMode()&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],s),this.hot.populateFromArray(n,r,e,i,o,"edit")}beginEditing(e,t){var n,r,i;this.state===l.VIRGIN&&(i=(n=this.hot).rowIndexMapper.getRenderableFromVisualIndex(this.row),r=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),n.view.scrollViewport(n._createCellCoords(i,r)),this.state=l.EDITING,this.isInFullEditMode()&&(i="string"==typeof e?e:(0,a.stringify)(this.originalValue),this.setValue(i)),this.open(t),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col))}finishEditing(e,t,n){let r;if(n){const o=this._closeCallback;this._closeCallback=e=>{o&&o(e),n(e),this.hot.view.render()}}var i;this.isWaiting()||((i=this.hot.getShortcutManager().getContext("editor")).removeShortcutsByGroup(u),i.removeShortcutsByGroup(s.SHORTCUTS_GROUP_NAVIGATION),this.state===l.VIRGIN?this.hot._registerTimeout(()=>{this._fireCallbacks(!0)}):this.state===l.EDITING&&(e?(this.cancelChanges(),this.hot.view.render()):(i=this.getValue(),r=this.cellProperties.trimWhitespace?[["string"==typeof i?String.prototype.trim.call(i||""):i]]:[[i]],this.state=l.WAITING,this.saveValue(r,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",e=>{this.state=l.FINISHED,this.discardEditor(e)}):(this.state=l.FINISHED,this.discardEditor(!0)))))}cancelChanges(){this.state=l.FINISHED,this.discardEditor()}discardEditor(e){this.state===l.FINISHED&&(!1===e&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=l.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=l.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===l.WAITING}getEditedCellRect(){var r=this.getEditedCell();if(r){var{wtOverlays:i,wtViewport:o}=this.hot.view._wt,s=this.hot.rootWindow,a=(0,v.offset)(r),l=(0,v.outerWidth)(r),u=(0,v.offset)(this.hot.rootElement),c=(0,v.outerWidth)(this.hot.rootElement),d=i.topOverlay.holder,h=i.inlineStartOverlay.holder,f=d!==s?d.scrollTop:0,p=h!==s?h.scrollLeft:0,c=s.innerWidth-u.left-c,g=(null!=(g=i.getParentOverlay(r))?g:this.hot.view._wt)["wtTable"],m=g.name,f=["master","inline_start"].includes(m)?f:0,p=["master","top","bottom"].includes(m)?p:0,y=a.top===u.top?0:1;let e=a.top-u.top-y-f,t=0;t=this.hot.isRtl()?s.innerWidth-a.left-l-c-1+p:a.left-u.left-1-p,["top","top_inline_start_corner"].includes(m)&&(e+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(m)&&(t+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));y=this.hot.hasColHeaders(),f=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),c=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom"),a=((y&&f<=0||f===c)&&(e+=1),s<=0&&(t+=1),o.rowsRenderCalculator.startPosition),u=o.columnsRenderCalculator.startPosition,p=Math.abs(i.inlineStartOverlay.getScrollPosition()),m=i.topOverlay.getScrollPosition(),y=(0,v.getScrollbarWidth)(this.hot.rootDocument),f=r.offsetTop+a-m;let n=0;this.hot.isRtl()?(c=r.offsetLeft,n=0<=c?g.getWidth()-r.offsetLeft:Math.abs(c),n+=u-p-l):n=r.offsetLeft+u-p;s=(0,v.getComputedStyle)(this.TD,this.hot.rootWindow),o=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",i=0<parseInt(s[o],10)?0:1,a=0<parseInt(s.borderTopWidth,10)?0:1,m=(0,v.outerWidth)(r)+i,g=(0,v.outerHeight)(r)+a,c=(0,v.hasVerticalScrollbar)(d)?y:0,l=(0,v.hasHorizontalScrollbar)(h)?y:0,u=this.hot.view.maximumVisibleElementWidth(n)-c+i,p=Math.max(this.hot.view.maximumVisibleElementHeight(f)-l+a,23);return{top:e,start:t,height:g,maxHeight:p,width:m,maxWidth:u}}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){var e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?t=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?t=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}t.BaseEditor=o,(0,i.mixin)(o,r.default)},(e,t,n)=>{"use strict";t.__esModule=!0,n(203);var r=n(444),i=n(447),n={_hooksStorage:Object.create(null),addHook(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey(t){(0,r.arrayEach)(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){(0,i.objectEach)(this._hooksStorage,(e,t)=>this.removeHooksByKey(t)),this._hooksStorage={}}};(0,i.defineGetter)(n,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1}),t.default=n},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(614);t.autoResize=n.autoResize},(e,t)=>{"use strict";t.__esModule=!0,t.autoResize=function(){function i(e,t,n){e.addEventListener(t,n,!1)}function e(e,t,n){e.removeEventListener(t,n,!1)}function o(){window.setTimeout(c,0)}function r(e,t,n){var r;s=e,(e=t)&&e.minHeight&&("inherit"==e.minHeight?a.minHeight=s.clientHeight:(r=parseInt(e.minHeight),isNaN(r)||(a.minHeight=r))),e&&e.maxHeight&&("inherit"==e.maxHeight?a.maxHeight=s.clientHeight:(r=parseInt(e.maxHeight),isNaN(r)||(a.maxHeight=r))),e&&e.minWidth&&("inherit"==e.minWidth?a.minWidth=s.clientWidth:(r=parseInt(e.minWidth),isNaN(r)||(a.minWidth=r))),e&&e.maxWidth&&("inherit"==e.maxWidth?a.maxWidth=s.clientWidth:(r=parseInt(e.maxWidth),isNaN(r)||(a.maxWidth=r))),u.firstChild||(u.className="autoResize",u.style.display="inline-block",u.appendChild(l)),"TEXTAREA"==s.nodeName&&(s.style.resize="none",s.style.overflowY="",s.style.height=a.minHeight+"px",s.style.minWidth=a.minWidth+"px",s.style.maxWidth=a.maxWidth+"px",s.style.overflowY="hidden"),n&&(i(s,"change",c),i(s,"cut",o),i(s,"paste",o),i(s,"drop",o),i(s,"keydown",o),i(s,"focus",c),i(s,"compositionstart",o),i(s,"compositionupdate",o),i(s,"compositionend",o)),c()}var s,a={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t=document.body,l=document.createTextNode(""),u=document.createElement("SPAN"),c=function(e){e?/^[a-zA-Z \.,\\\/\|0-9]$/.test(e)||(e="."):e="",void 0!==l.textContent?l.textContent=s.value+e:l.data=s.value+e,u.style.position="absolute",u.style.fontSize=n(s).fontSize,u.style.fontFamily=n(s).fontFamily,u.style.whiteSpace="pre",t.appendChild(u),e=u.clientWidth+2,t.removeChild(u),s.style.height=a.minHeight+"px",a.minWidth>e?s.style.width=a.minWidth+"px":e>a.maxWidth?s.style.width=a.maxWidth+"px":s.style.width=e+"px",e=s.scrollHeight?s.scrollHeight-1:0,a.minHeight>e?s.style.height=a.minHeight+"px":a.maxHeight<e?(s.style.height=a.maxHeight+"px",s.style.overflowY="visible"):s.style.height=e+"px"};function n(e){return e.currentStyle||document.defaultView.getComputedStyle(e)}return{init:function(e,t,n){r(e,t,n)},unObserve:function(){e(s,"change",c),e(s,"cut",o),e(s,"paste",o),e(s,"drop",o),e(s,"keydown",o),e(s,"focus",c),e(s,"compositionstart",o),e(s,"compositionupdate",o),e(s,"compositionend",o)},resize:c}}},(e,t,n)=>{"use strict";t.__esModule=!0,t.updateCaretPosition=function(t,e){var n=(0,a.getCaretPosition)(e),r=e.value.split("\n");let i=n,o=0;for(let e=0;e<r.length;e++){var s=r[e],s=(0!==e&&(o+=r[e-1].length+1),o+s.length);if("home"===t?i=o:"end"===t&&(i=s),n<=s)break}(0,a.setCaretPosition)(e,i)};var a=n(302)},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(617);t.RENDERER_TYPE=n.RENDERER_TYPE,t.textRenderer=n.textRenderer},(e,t,n)=>{"use strict";t.__esModule=!0,t.textRenderer=r;var l=n(618),u=n(302),c=n(305);function r(e,t,n,r,i,o,s){l.baseRenderer.apply(this,[e,t,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=(0,c.stringify)(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate?((0,u.empty)(t),(r=e.rootDocument.createElement("TEMPLATE")).setAttribute("bind","{{}}"),r.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(r),r.model=e.getSourceDataAtRow(n),t.appendChild(r)):(0,u.fastInnerText)(t,a)}t.RENDERER_TYPE="text",r.RENDERER_TYPE="text"},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(619);t.RENDERER_TYPE=n.RENDERER_TYPE,t.baseRenderer=n.baseRenderer},(e,t,n)=>{"use strict";t.__esModule=!0,t.baseRenderer=r,n(203);var u=n(302);function r(e,t,n,r,i,o,s){var a=[],l=[];s.className&&(0,u.addClass)(t,s.className),s.readOnly&&a.push(s.readOnlyCellClassName),(!1===s.valid&&s.invalidCellClassName?a:l).push(s.invalidCellClassName),!1===s.wordWrap&&s.noWordWrapClassName&&a.push(s.noWordWrapClassName),!o&&s.placeholder&&a.push(s.placeholderCellClassName),(0,u.removeClass)(t,l),(0,u.addClass)(t,a)}t.RENDERER_TYPE="base",r.RENDERER_TYPE="base"},(e,t,n)=>{"use strict";t.__esModule=!0,t.registerAllModules=function(){(0,r.registerAllEditors)(),(0,i.registerAllRenderers)(),(0,o.registerAllValidators)(),(0,s.registerAllCellTypes)(),(0,a.registerAllPlugins)()};var r=n(621),i=(t.registerAllEditors=r.registerAllEditors,n(642)),o=(t.registerAllRenderers=i.registerAllRenderers,n(658)),s=(t.registerAllValidators=o.registerAllValidators,n(668)),a=(t.registerAllCellTypes=s.registerAllCellTypes,n(685));t.registerAllPlugins=a.registerAllPlugins},(e,t,n)=>{"use strict";t.__esModule=!0,t.registerAllEditors=function(){(0,p.registerEditor)(i.BaseEditor),(0,p.registerEditor)(r.AutocompleteEditor),(0,p.registerEditor)(o.CheckboxEditor),(0,p.registerEditor)(s.DateEditor),(0,p.registerEditor)(a.DropdownEditor),(0,p.registerEditor)(l.HandsontableEditor),(0,p.registerEditor)(u.NumericEditor),(0,p.registerEditor)(c.PasswordEditor),(0,p.registerEditor)(d.SelectEditor),(0,p.registerEditor)(h.TextEditor),(0,p.registerEditor)(f.TimeEditor)};var r=n(622),i=(t.AutocompleteEditor=r.AutocompleteEditor,t.AUTOCOMPLETE_EDITOR=r.EDITOR_TYPE,n(610)),o=(t.BaseEditor=i.BaseEditor,t.BASE_EDITOR=i.EDITOR_TYPE,n(626)),s=(t.CheckboxEditor=o.CheckboxEditor,t.CHECKBOX_EDITOR=o.EDITOR_TYPE,n(628)),a=(t.DateEditor=s.DateEditor,t.DATE_EDITOR=s.EDITOR_TYPE,n(632)),l=(t.DropdownEditor=a.DropdownEditor,t.DROPDOWN_EDITOR=a.EDITOR_TYPE,n(624)),u=(t.HandsontableEditor=l.HandsontableEditor,t.HANDSONTABLE_EDITOR=l.EDITOR_TYPE,n(634)),c=(t.NumericEditor=u.NumericEditor,t.NUMERIC_EDITOR=u.EDITOR_TYPE,n(636)),d=(t.PasswordEditor=c.PasswordEditor,t.PASSWORD_EDITOR=c.EDITOR_TYPE,n(638)),h=(t.SelectEditor=d.SelectEditor,t.SELECT_EDITOR=d.EDITOR_TYPE,n(608)),f=(t.TextEditor=h.TextEditor,t.TEXT_EDITOR=h.EDITOR_TYPE,n(640)),p=(t.TimeEditor=f.TimeEditor,t.TIME_EDITOR=f.EDITOR_TYPE,n(453));t.registerEditor=p.registerEditor,t.RegisteredEditor=p.RegisteredEditor,t._getEditorInstance=p._getEditorInstance,t.getEditor=p.getEditor,t.getEditorInstance=p.getEditorInstance,t.getRegisteredEditorNames=p.getRegisteredEditorNames,t.getRegisteredEditors=p.getRegisteredEditors,t.hasEditor=p.hasEditor},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(623);t.EDITOR_TYPE=n.EDITOR_TYPE,t.AutocompleteEditor=n.AutocompleteEditor},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),r(n(467))),r=n(624),c=n(444),d=n(302),h=n(305),f=n(303),o=n(451),l=n(616);const s=new WeakMap,a="autocomplete";t.EDITOR_TYPE=a;class u extends r.HandsontableEditor{static get EDITOR_TYPE(){return a}constructor(e){super(e),(0,i.default)(this,"sortByRelevance",function(e,t,n){var r=[],i=[],o=e.length;let s=t.length,a,l;if(0===o)for(a=0;a<s;a++)i.push(a);else{for(a=0;a<s;a++){var u,c=(0,f.stripTags)((0,h.stringify)(t[a]));-1!==(l=n?c.indexOf(e):(u=this.cellProperties.locale,c.toLocaleLowerCase(u).indexOf(e.toLocaleLowerCase(u))))&&(u=c.length-l-o,r.push({baseIndex:a,index:l,charsLeft:u,value:c}))}for(r.sort((e,t)=>{if(-1===t.index)return-1;if(-1===e.index)return 1;if(e.index<t.index)return-1;if(t.index<e.index)return 1;if(e.index===t.index){if(e.charsLeft<t.charsLeft)return-1;if(e.charsLeft>t.charsLeft)return 1}return 0}),a=0,s=r.length;a<s;a++)i.push(r[a].baseIndex)}return i}),this.query=null,this.strippedChoices=[],this.rawChoices=[],s.set(this,{skipOne:!1,isMacOS:-1<this.hot.rootWindow.navigator.platform.indexOf("Mac")})}getValue(){var e=this.rawChoices.find(e=>{return this.stripValueIfNeeded(e)===this.TEXTAREA.value});return(0,h.isDefined)(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),(0,d.addClass)(this.htContainer,"autocompleteEditor"),(0,d.addClass)(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll")}open(){var e=s.get(this),t=(super.open(),this.htEditor.getInstance()),n=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();let r=(0,d.getScrollbarWidth)();0===r&&e.isMacOS&&(r+=15),this.addHook("beforeKeyDown",e=>this.onBeforeKeyDown(e)),t.updateSettings({colWidths:n?[(0,d.outerWidth)(this.TEXTAREA)-2]:void 0,width:n?(0,d.outerWidth)(this.TEXTAREA)+r:void 0,renderer:(e,t,n,r,i,o,s)=>{(0,l.textRenderer)(e,t,n,r,i,o,s);var{filteringCaseSensitive:e,allowHtml:n,locale:r}=this.cellProperties,i=this.query;let a=(0,h.stringify)(o);a&&!n&&-1!==(s=!0===e?a.indexOf(i):a.toLocaleLowerCase(r).indexOf(i.toLocaleLowerCase(r)))&&(o=a.substr(s,i.length),a=a.replace(o,`<strong>${o}</strong>`)),t.innerHTML=a},autoColumnSize:!0}),e.skipOne&&(e.skipOne=!1),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close()}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){var t=this.cellProperties.source;this.query=e,"function"==typeof t?t.call(this.cellProperties,e,e=>{this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){var t=(0,d.getCaretPosition)(this.TEXTAREA),n=(0,d.getSelectionEndPosition)(this.TEXTAREA),r=this.cellProperties.sortByRelevance,i=this.cellProperties.filter;let o=null,s=null,a=e;r&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),a,this.cellProperties.filteringCaseSensitive));var l=Array.isArray(o)?o.length:0;if(!1===i)l&&(s=o[0]);else{var u=[];for(let e=0,t=a.length;e<t&&!(r&&l<=e);e++)u.push(l?a[o[e]]:a[e]);s=0,a=u}this.strippedChoices=a,this.htEditor.loadData((0,c.pivot)([a])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(s),this.hot.listen(),(0,d.setCaretPosition)(this.TEXTAREA,t,t===n?void 0:n)}flipDropdownIfNeeded(){var e,t,n,r,i=(0,d.getTrimmingContainer)(this.hot.view._wt.wtTable.TABLE),o=i===this.hot.rootWindow,s=this.cellProperties.preventOverflow;return!o&&(o||!s&&"horizontal"!==s)&&(o=(0,d.offset)(this.TEXTAREA),s=(0,d.outerHeight)(this.TEXTAREA),e=this.getDropdownHeight(),r=i.scrollTop,t=(0,d.outerHeight)(this.hot.view._wt.wtTable.THEAD),n=(0,d.offset)(i),o=o.top-n.top-t+r,(r=(n=i.scrollHeight-o-t-s)<e&&n<o)?this.flipDropdown(e):this.unflipDropdown(),this.limitDropdownIfNeeded(r?o:n,e),r)}limitDropdownIfNeeded(r,i){if(r<i){let e=0,t=0,n=0;for(var o;n=this.htEditor.getRowHeight(t)||this.htEditor.view._wt.getSetting("defaultRowHeight"),e+=n,t+=1,e<r;);o=e-n,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+i-o+"px"),this.setDropdownHeight(e-n)}}flipDropdown(e){var t=this.htEditor.rootElement.style;t.position="absolute",t.top=-e+"px",this.htEditor.flipped=!0}unflipDropdown(){var e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){var e=this.htEditor.getColWidth(0)+(0,d.getScrollbarWidth)(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){"number"==typeof e?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){var e=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const t=this.cellProperties["allowHtml"];e=(0,c.arrayMap)(e,e=>(0,h.stringify)(e));return(0,c.arrayMap)(e,e=>t?e:(0,f.stripTags)(e))}allowKeyEventPropagation(e){var t=this.htEditor.getSelectedRangeLast();const n=t?t.from.row:-1;let r=!1;return e===o.KEY_CODES.ARROW_DOWN&&0<n&&n<this.htEditor.countRows()-1&&(r=!0),r=e===o.KEY_CODES.ARROW_UP&&-1<n?!0:r}onBeforeKeyDown(t){const n=s.get(this);if((n.skipOne=!1,o.isPrintableChar)(t.keyCode)||t.keyCode===o.KEY_CODES.BACKSPACE||t.keyCode===o.KEY_CODES.DELETE||t.keyCode===o.KEY_CODES.INSERT){let e=10;t.keyCode===o.KEY_CODES.C&&(t.ctrlKey||t.metaKey)||(this.isOpened()||(e+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value),n.skipOne=!0},e))}}}t.AutocompleteEditor=u},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(625);t.EDITOR_TYPE=n.EDITOR_TYPE,t.HandsontableEditor=n.HandsontableEditor},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(608),i=n(302),o=n(452),a=n(447),s=n(450);const l="handsontableEditor",u="handsontable";t.EDITOR_TYPE=u;class c extends r.TextEditor{static get EDITOR_TYPE(){return u}open(){super.open(),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),(0,i.setCaretPosition)(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o);const s=this;e={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown(e,t){t=this.getSourceData(t.row,t.col);void 0!==t&&s.setValue(t),s.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&(0,a.extend)(e,o.handsontable),this.htOptions=e}beginEditing(e,t){var n=this.hot.getSettings().onBeginEditing;n&&!1===n()||super.beginEditing(e,t)}createElements(){super.createElements();var e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,n){var r;this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()&&void 0!==(r=this.htEditor.getInstance().getValue())&&this.setValue(r),super.finishEditing(e,t,n)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){var e=this.hot.getShortcutManager().getContext("editor"),t=(super.registerShortcuts(),{group:l,relativeToGroup:s.SHORTCUTS_GROUP_NAVIGATION,position:"before"});const i=(e,t)=>{var n=this.htEditor.getInstance();if(void 0!==e&&(e<0||n.flipped&&e>n.countRows()-1?n.deselectCell():n.selectCell(e,0),n.getData().length))return t.preventDefault(),(0,o.stopImmediatePropagation)(t),this.hot.listen(),this.TEXTAREA.focus(),!1};e.addShortcuts([{keys:[["ArrowUp"]],callback:e=>{var t=this.htEditor.getInstance();let n,r;return!t.getSelectedLast()&&t.flipped?n=t.countRows()-1:t.getSelectedLast()&&(n=t.flipped?(r=t.getSelectedLast()[0],Math.max(0,r-1)):(r=t.getSelectedLast()[0])-1),i(n,e)},preventDefault:!1},{keys:[["ArrowDown"]],callback:e=>{var t,n=this.htEditor.getInstance();let r;return n.getSelectedLast()||n.flipped?n.getSelectedLast()&&(n.flipped?r=n.getSelectedLast()[0]+1:n.flipped||(t=n.countRows()-1,n=n.getSelectedLast()[0],r=Math.min(t,n+1))):r=0,i(r,e)},preventDefault:!1}],t)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(l)}}t.HandsontableEditor=c},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(627);t.EDITOR_TYPE=n.EDITOR_TYPE,t.CheckboxEditor=n.CheckboxEditor},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(610),i=n(302);t.EDITOR_TYPE="checkbox";class o extends r.BaseEditor{static get EDITOR_TYPE(){return"checkbox"}beginEditing(e,t){t&&"mouseup"===t.type&&(t=this.TD.querySelector('input[type="checkbox"]'),(0,i.hasClass)(t,"htBadValue")||t.click())}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}t.CheckboxEditor=o},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(629);t.EDITOR_TYPE=n.EDITOR_TYPE,t.DateEditor=n.DateEditor},(e,t,n)=>{"use strict";var r=n(196),s=(t.__esModule=!0,n(273),r(n(306))),a=r(n(630)),i=n(608),o=r(n(457)),l=n(302),u=n(447),c=n(451);n(631);t.EDITOR_TYPE="date";const d="dateEditor";class h extends i.TextEditor{static get EDITOR_TYPE(){return"date"}constructor(e){super(e),this.defaultDateFormat="DD/MM/YYYY",this.isCellEdited=!1,this.parentDestroyed=!1,this.$datePicker=null}init(){if("function"!=typeof s.default)throw new Error("You need to include moment.js to your project.");if("function"!=typeof a.default)throw new Error("You need to include Pikaday to your project.");super.init(),this.instance.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),(0,l.addClass)(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),new o.default(this).addEventListener(this.datePicker,"mousedown",e=>e.stopPropagation())}destroyElements(){var e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o)}open(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),t.addShortcut({keys:[["Enter"]],callback:e=>{e.stopPropagation()},group:d})}close(){var e;this._opened=!1,null!=(e=this.$datePicker)&&e.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(()=>{this.instance._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(d),super.close()}finishEditing(){var e,t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];t&&void 0!==(e=this.originalValue)&&this.setValue(e),super.finishEditing(t,n)}showDatepicker(e){var t=this.TD.getBoundingClientRect(),n=this.cellProperties.dateFormat||this.defaultDateFormat,r=this.instance.view.isMouseDown(),e=!!e&&(0,c.isFunctionKey)(e.keyCode);let i,o=(this.datePicker.style.display="block",this.$datePicker=new a.default(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=this.hot.rootWindow.pageYOffset+t.top+(0,l.outerHeight)(this.TD)+"px",this.hot.rootWindow.pageXOffset);o=this.hot.isRtl()?t.right-(0,l.outerWidth)(this.datePicker):t.left,this.datePickerStyle.left=o+"px",this.originalValue?(i=this.originalValue,(0,s.default)(i,n,!0).isValid()&&this.$datePicker.setMoment((0,s.default)(i,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),e||r||this.setValue("")):this.cellProperties.defaultDate?(i=this.cellProperties.defaultDate,(0,s.default)(i,n,!0).isValid()&&this.$datePicker.setMoment((0,s.default)(i,n),!0),e||r||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e=this.TEXTAREA,t={};this.cellProperties&&this.cellProperties.datePickerConfig&&(0,u.deepExtend)(t,this.cellProperties.datePickerConfig);const n=t.onSelect,r=t.onClose;return t.field=e,t.trigger=e,t.container=this.datePicker,t.bound=!1,t.format=t.format||this.defaultDateFormat,t.reposition=t.reposition||!1,t.isRTL=!1,t.onSelect=e=>{let t=e;isNaN(t.getTime())||(t=(0,s.default)(t).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(t),this.hideDatepicker(),n&&n()},t.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),r&&r()},t}}t.DateEditor=h},function(t,e,n){!function(){"use strict";var e;try{e=n(306)}catch(e){}t.exports=function(s){"use strict";var a=typeof s==="function",o=!!window.addEventListener,h=window.document,u=window.setTimeout,l=function(e,t,n,r){if(o)e.addEventListener(t,n,!!r);else e.attachEvent("on"+t,n)},t=function(e,t,n,r){if(o)e.removeEventListener(t,n,!!r);else e.detachEvent("on"+t,n)},n=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},c=function(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")!==-1},f=function(e,t){if(!c(e,t))e.className=e.className===""?t:e.className+" "+t},p=function(e,t){e.className=n((" "+e.className+" ").replace(" "+t+" "," "))},y=function(e){return/Array/.test(Object.prototype.toString.call(e))},M=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},k=function(e){var t=e.getDay();return t===0||t===6},r=function(e){return e%4===0&&e%100!==0||e%400===0},D=function(e,t){return[31,r(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},L=function(e){if(M(e))e.setHours(0,0,0,0)},P=function(e,t){return e.getTime()===t.getTime()},d=function(e,t,n){var r,i;for(r in t){i=e[r]!==undefined;if(i&&typeof t[r]==="object"&&t[r]!==null&&t[r].nodeName===undefined)if(M(t[r])){if(n)e[r]=new Date(t[r].getTime())}else if(y(t[r])){if(n)e[r]=t[r].slice(0)}else e[r]=d({},t[r],n);else if(n||!i)e[r]=t[r]}return e},i=function(e,t,n){var r;if(h.createEvent){r=h.createEvent("HTMLEvents");r.initEvent(t,true,false);r=d(r,n);e.dispatchEvent(r)}else if(h.createEventObject){r=h.createEventObject();r=d(r,n);e.fireEvent("on"+t,r)}},g=function(e){if(e.month<0){e.year-=Math.ceil(Math.abs(e.month)/12);e.month+=12}if(e.month>11){e.year+=Math.floor(Math.abs(e.month)/12);e.month-=12}return e},m={field:null,bound:undefined,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:true,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:false,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:false,minDate:null,maxDate:null,yearRange:10,showWeekNumber:false,pickWholeWeek:false,minYear:0,maxYear:9999,minMonth:undefined,maxMonth:undefined,startRange:null,endRange:null,isRTL:false,yearSuffix:"",showMonthAfterYear:false,showDaysInNextAndPreviousMonths:false,enableSelectionDaysInNextAndPreviousMonths:false,numberOfMonths:1,mainCalendar:"left",container:undefined,blurFieldOnSelect:true,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:true},v=function(e,t,n){t+=e.firstDay;while(t>=7)t-=7;return n?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},F=function(e){var t=[];var n="false";if(e.isEmpty)if(e.showDaysInNextAndPreviousMonths){t.push("is-outside-current-month");if(!e.enableSelectionDaysInNextAndPreviousMonths)t.push("is-selection-disabled")}else return'<td class="is-empty"></td>';if(e.isDisabled)t.push("is-disabled");if(e.isToday)t.push("is-today");if(e.isSelected){t.push("is-selected");n="true"}if(e.hasEvent)t.push("has-event");if(e.isInRange)t.push("is-inrange");if(e.isStartRange)t.push("is-startrange");if(e.isEndRange)t.push("is-endrange");return'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+n+'">'+'<button class="pika-button pika-day" type="button" '+'data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button>"+"</td>"},b=function(e,t){e.setHours(0,0,0,0);var n=e.getDate(),r=e.getDay(),i=t,o=i-1,s=7,a=function(e){return(e+s-1)%s};e.setDate(n+o-a(r));var l=new Date(e.getFullYear(),0,i),u=24*60*60*1e3,c=(e.getTime()-l.getTime())/u,d=1+Math.round((c-o+a(l.getDay()))/s);return d},B=function(e,t,n,r){var i=new Date(n,t,e),o=a?s(i).isoWeek():b(i,r);return'<td class="pika-week">'+o+"</td>"},H=function(e,t,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(t?e.reverse():e).join("")+"</tr>"},E=function(e){return"<tbody>"+e.join("")+"</tbody>"},C=function(e){var t,n=[];if(e.showWeekNumber)n.push("<th></th>");for(t=0;t<7;t++)n.push('<th scope="col"><abbr title="'+v(e,t)+'">'+v(e,t,true)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?n.reverse():n).join("")+"</tr></thead>"},w=function(e,t,n,r,i,o){var s,a,l,u=e._o,c=n===u.minYear,d=n===u.maxYear,h='<div id="'+o+'" class="pika-title" role="heading" aria-live="assertive">',f,p,g=true,m=true;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-t:12+s-t)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||d&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>";if(y(u.yearRange)){s=u.yearRange[0];a=u.yearRange[1]+1}else{s=n-u.yearRange;a=1+n+u.yearRange}for(l=[];s<a&&s<=u.maxYear;s++)if(s>=u.minYear)l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");p='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>";if(u.showMonthAfterYear)h+=p+f;else h+=f+p;if(c&&(r===0||u.minMonth>=r))g=false;if(d&&(r===11||u.maxMonth<=r))m=false;if(t===0)h+='<button class="pika-prev'+(g?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>";if(t===e._o.numberOfMonths-1)h+='<button class="pika-next'+(m?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>";return h+="</div>"},U=function(e,t,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+C(e)+E(t)+"</table>"},e=function(e){var r=this,i=r.config(e);r._onMouseDown=function(e){if(!r._v)return;e=e||window.event;var t=e.target||e.srcElement;if(!t)return;if(!c(t,"is-disabled"))if(c(t,"pika-button")&&!c(t,"is-empty")&&!c(t.parentNode,"is-disabled")){r.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day")));if(i.bound)u(function(){r.hide();if(i.blurFieldOnSelect&&i.field)i.field.blur()},100)}else if(c(t,"pika-prev"))r.prevMonth();else if(c(t,"pika-next"))r.nextMonth();if(!c(t,"pika-select"))if(e.preventDefault)e.preventDefault();else{e.returnValue=false;return false}else r._c=true};r._onChange=function(e){e=e||window.event;var t=e.target||e.srcElement;if(!t)return;if(c(t,"pika-select-month"))r.gotoMonth(t.value);else if(c(t,"pika-select-year"))r.gotoYear(t.value)};r._onKeyChange=function(e){e=e||window.event;if(r.isVisible())switch(e.keyCode){case 13:case 27:if(i.field)i.field.blur();break;case 37:r.adjustDate("subtract",1);break;case 38:r.adjustDate("subtract",7);break;case 39:r.adjustDate("add",1);break;case 40:r.adjustDate("add",7);break;case 8:case 46:r.setDate(null);break}};r._parseFieldValue=function(){if(i.parse)return i.parse(i.field.value,i.format);else if(a){var e=s(i.field.value,i.format,i.formatStrict);return e&&e.isValid()?e.toDate():null}else return new Date(Date.parse(i.field.value))};r._onInputChange=function(e){var t;if(e.firedBy===r)return;t=r._parseFieldValue();if(M(t))r.setDate(t);if(!r._v)r.show()};r._onInputFocus=function(){r.show()};r._onInputClick=function(){r.show()};r._onInputBlur=function(){var e=h.activeElement;do{if(c(e,"pika-single"))return}while(e=e.parentNode);if(!r._c)r._b=u(function(){r.hide()},50);r._c=false};r._onClick=function(e){e=e||window.event;var t=e.target||e.srcElement,n=t;if(!t)return;if(!o&&c(t,"pika-select"))if(!t.onchange){t.setAttribute("onchange","return;");l(t,"change",r._onChange)}do{if(c(n,"pika-single")||n===i.trigger)return}while(n=n.parentNode);if(r._v&&t!==i.trigger&&n!==i.trigger)r.hide()};r.el=h.createElement("div");r.el.className="pika-single"+(i.isRTL?" is-rtl":"")+(i.theme?" "+i.theme:"");l(r.el,"mousedown",r._onMouseDown,true);l(r.el,"touchend",r._onMouseDown,true);l(r.el,"change",r._onChange);if(i.keyboardInput)l(h,"keydown",r._onKeyChange);if(i.field){if(i.container)i.container.appendChild(r.el);else if(i.bound)h.body.appendChild(r.el);else i.field.parentNode.insertBefore(r.el,i.field.nextSibling);l(i.field,"change",r._onInputChange);if(!i.defaultDate){i.defaultDate=r._parseFieldValue();i.setDefaultDate=true}}var t=i.defaultDate;if(M(t))if(i.setDefaultDate)r.setDate(t,true);else r.gotoDate(t);else r.gotoDate(new Date);if(i.bound){this.hide();r.el.className+=" is-bound";l(i.trigger,"click",r._onInputClick);l(i.trigger,"focus",r._onInputFocus);l(i.trigger,"blur",r._onInputBlur)}else this.show()};return e.prototype={config:function(e){if(!this._o)this._o=d({},m,true);var t=d(this._o,e,true);t.isRTL=!!t.isRTL;t.field=t.field&&t.field.nodeName?t.field:null;t.theme=typeof t.theme==="string"&&t.theme?t.theme:null;t.bound=!!(t.bound!==undefined?t.field&&t.bound:t.field);t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field;t.disableWeekends=!!t.disableWeekends;t.disableDayFn=typeof t.disableDayFn==="function"?t.disableDayFn:null;var n=parseInt(t.numberOfMonths,10)||1;t.numberOfMonths=n>4?4:n;if(!M(t.minDate))t.minDate=false;if(!M(t.maxDate))t.maxDate=false;if(t.minDate&&t.maxDate&&t.maxDate<t.minDate)t.maxDate=t.minDate=false;if(t.minDate)this.setMinDate(t.minDate);if(t.maxDate)this.setMaxDate(t.maxDate);if(y(t.yearRange)){var r=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||r;t.yearRange[1]=parseInt(t.yearRange[1],10)||r}else{t.yearRange=Math.abs(parseInt(t.yearRange,10))||m.yearRange;if(t.yearRange>100)t.yearRange=100}return t},toString:function(e){e=e||this._o.format;if(!M(this._d))return"";if(this._o.toString)return this._o.toString(this._d,e);if(a)return s(this._d).format(e);return this._d.toDateString()},getMoment:function(){return a?s(this._d):null},setMoment:function(e,t){if(a&&s.isMoment(e))this.setDate(e.toDate(),t)},getDate:function(){return M(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e){this._d=null;if(this._o.field){this._o.field.value="";i(this._o.field,"change",{firedBy:this})}return this.draw()}if(typeof e==="string")e=new Date(Date.parse(e));if(!M(e))return;var n=this._o.minDate,r=this._o.maxDate;if(M(n)&&e<n)e=n;else if(M(r)&&e>r)e=r;this._d=new Date(e.getTime());L(this._d);this.gotoDate(this._d);if(this._o.field){this._o.field.value=this.toString();i(this._o.field,"change",{firedBy:this})}if(!t&&typeof this._o.onSelect==="function")this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(e){var t=true;if(!M(e))return;if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=e.getTime();r.setMonth(r.getMonth()+1);r.setDate(r.getDate()-1);t=i<n.getTime()||r.getTime()<i}if(t){this.calendars=[{month:e.getMonth(),year:e.getFullYear()}];if(this._o.mainCalendar==="right")this.calendars[0].month+=1-this._o.numberOfMonths}this.adjustCalendars()},adjustDate:function(e,t){var n=this.getDate()||new Date;var r=parseInt(t)*24*60*60*1e3;var i;if(e==="add")i=new Date(n.valueOf()+r);else if(e==="subtract")i=new Date(n.valueOf()-r);this.setDate(i)},adjustCalendars:function(){this.calendars[0]=g(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=g({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){if(!isNaN(e)){this.calendars[0].month=parseInt(e,10);this.adjustCalendars()}},nextMonth:function(){this.calendars[0].month++;this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--;this.adjustCalendars()},gotoYear:function(e){if(!isNaN(e)){this.calendars[0].year=parseInt(e,10);this.adjustCalendars()}},setMinDate:function(e){if(e instanceof Date){L(e);this._o.minDate=e;this._o.minYear=e.getFullYear();this._o.minMonth=e.getMonth()}else{this._o.minDate=m.minDate;this._o.minYear=m.minYear;this._o.minMonth=m.minMonth;this._o.startRange=m.startRange}this.draw()},setMaxDate:function(e){if(e instanceof Date){L(e);this._o.maxDate=e;this._o.maxYear=e.getFullYear();this._o.maxMonth=e.getMonth()}else{this._o.maxDate=m.maxDate;this._o.maxYear=m.maxYear;this._o.maxMonth=m.maxMonth;this._o.endRange=m.endRange}this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(!this._v&&!e)return;var t=this._o,n=t.minYear,r=t.maxYear,i=t.minMonth,o=t.maxMonth,s="",a;if(this._y<=n){this._y=n;if(!isNaN(i)&&this._m<i)this._m=i}if(this._y>=r){this._y=r;if(!isNaN(o)&&this._m>o)this._m=o}for(var l=0;l<t.numberOfMonths;l++){a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);s+='<div class="pika-lendar">'+w(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>"}this.el.innerHTML=s;if(t.bound)if(t.field.type!=="hidden")u(function(){t.trigger.focus()},1);if(typeof this._o.onDraw==="function")this._o.onDraw(this);if(t.bound)t.field.setAttribute("aria-label",t.ariaLabel)},adjustPosition:function(){var e,t,n,r,i,o,s,a,l,u,c,d;if(this._o.container)return;this.el.style.position="absolute";e=this._o.trigger;t=e;n=this.el.offsetWidth;r=this.el.offsetHeight;i=window.innerWidth||h.documentElement.clientWidth;o=window.innerHeight||h.documentElement.clientHeight;s=window.pageYOffset||h.body.scrollTop||h.documentElement.scrollTop;c=true;d=true;if(typeof e.getBoundingClientRect==="function"){u=e.getBoundingClientRect();a=u.left+window.pageXOffset;l=u.bottom+window.pageYOffset}else{a=t.offsetLeft;l=t.offsetTop+t.offsetHeight;while(t=t.offsetParent){a+=t.offsetLeft;l+=t.offsetTop}}if(this._o.reposition&&a+n>i||this._o.position.indexOf("right")>-1&&a-n+e.offsetWidth>0){a=a-n+e.offsetWidth;c=false}if(this._o.reposition&&l+r>o+s||this._o.position.indexOf("top")>-1&&l-r-e.offsetHeight>0){l=l-r-e.offsetHeight;d=false}this.el.style.left=a+"px";this.el.style.top=l+"px";f(this.el,c?"left-aligned":"right-aligned");f(this.el,d?"bottom-aligned":"top-aligned");p(this.el,!c?"left-aligned":"right-aligned");p(this.el,!d?"bottom-aligned":"top-aligned")},render:function(e,t,n){var r=this._o,i=new Date,o=D(e,t),s=new Date(e,t,1).getDay(),a=[],l=[];L(i);if(r.firstDay>0){s-=r.firstDay;if(s<0)s+=7}var u=t===0?11:t-1,c=t===11?0:t+1,d=t===0?e-1:e,h=t===11?e+1:e,f=D(d,u);var p=o+s,g=p;while(g>7)g-=7;p+=7-g;var m=false;for(var y=0,v=0;y<p;y++){var b=new Date(e,t,1+(y-s)),E=M(this._d)?P(b,this._d):false,C=P(b,i),w=r.events.indexOf(b.toDateString())!==-1?true:false,S=y<s||y>=o+s,T=1+(y-s),R=t,A=e,_=r.startRange&&P(r.startRange,b),N=r.endRange&&P(r.endRange,b),x=r.startRange&&r.endRange&&r.startRange<b&&b<r.endRange,O=r.minDate&&b<r.minDate||r.maxDate&&b>r.maxDate||r.disableWeekends&&k(b)||r.disableDayFn&&r.disableDayFn(b);if(S)if(y<s){T=f+T;R=u;A=d}else{T=T-o;R=c;A=h}var I={day:T,month:R,year:A,hasEvent:w,isSelected:E,isToday:C,isDisabled:O,isEmpty:S,isStartRange:_,isEndRange:N,isInRange:x,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};if(r.pickWholeWeek&&E)m=true;l.push(F(I));if(++v===7){if(r.showWeekNumber)l.unshift(B(y-s,t,e,r.firstWeekOfYearMinDays));a.push(H(l,r.isRTL,r.pickWholeWeek,m));l=[];v=0;m=false}}return U(r,a,n)},isVisible:function(){return this._v},show:function(){if(!this.isVisible()){this._v=true;this.draw();p(this.el,"is-hidden");if(this._o.bound){l(h,"click",this._onClick);this.adjustPosition()}if(typeof this._o.onOpen==="function")this._o.onOpen.call(this)}},hide:function(){var e=this._v;if(e!==false){if(this._o.bound)t(h,"click",this._onClick);if(!this._o.container){this.el.style.position="static";this.el.style.left="auto";this.el.style.top="auto"}f(this.el,"is-hidden");this._v=false;if(e!==undefined&&typeof this._o.onClose==="function")this._o.onClose.call(this)}},destroy:function(){var e=this._o;this.hide();t(this.el,"mousedown",this._onMouseDown,true);t(this.el,"touchend",this._onMouseDown,true);t(this.el,"change",this._onChange);if(e.keyboardInput)t(h,"keydown",this._onKeyChange);if(e.field){t(e.field,"change",this._onInputChange);if(e.bound){t(e.trigger,"click",this._onInputClick);t(e.trigger,"focus",this._onInputFocus);t(e.trigger,"blur",this._onInputBlur)}}if(this.el.parentNode)this.el.parentNode.removeChild(this.el)}},e}(e)}()},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(633);t.EDITOR_TYPE=n.EDITOR_TYPE,t.DropdownEditor=n.DropdownEditor},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(622)),r=r(n(454));t.EDITOR_TYPE="dropdown";class o extends i.AutocompleteEditor{static get EDITOR_TYPE(){return"dropdown"}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}t.DropdownEditor=o,r.default.getSingleton().add("beforeValidate",function(e,t,n){t=this.getCellMeta(t,this.propToCol(n));t.editor===o&&void 0===t.strict&&(t.filter=!1,t.strict=!0)})},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(635);t.EDITOR_TYPE=n.EDITOR_TYPE,t.NumericEditor=n.NumericEditor},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(608);t.EDITOR_TYPE="numeric";class r extends n.TextEditor{static get EDITOR_TYPE(){return"numeric"}}t.NumericEditor=r},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(637);t.EDITOR_TYPE=n.EDITOR_TYPE,t.PasswordEditor=n.PasswordEditor},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(608),i=n(302);t.EDITOR_TYPE="password";class o extends r.TextEditor{static get EDITOR_TYPE(){return"password"}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,(this.textareaStyle.height=0,i.empty)(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}t.PasswordEditor=o},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(639);t.EDITOR_TYPE=n.EDITOR_TYPE,t.SelectEditor=n.SelectEditor},(e,t,n)=>{"use strict";t.__esModule=!0;var o=n(610),a=n(302),l=n(447);const s="ht_editor_visible",r="selectEditor";t.EDITOR_TYPE="select";class i extends o.BaseEditor{static get EDITOR_TYPE(){return"select"}init(){this.select=this.hot.rootDocument.createElement("SELECT"),(0,a.addClass)(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",(0,a.hasClass)(this.select,s)&&(0,a.removeClass)(this.select,s),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o);e=this.cellProperties.selectOptions;let s;s="function"==typeof e?this.prepareOptions(e(this.row,this.col,this.prop)):this.prepareOptions(e),(0,a.empty)(this.select),(0,l.objectEach)(s,(e,t)=>{var n=this.hot.rootDocument.createElement("OPTION");n.value=t,(0,a.fastInnerHTML)(n,e),this.select.appendChild(n)})}prepareOptions(n){let r={};if(Array.isArray(n))for(let e=0,t=n.length;e<t;e++)r[n[e]]=n[e];else"object"==typeof n&&(r=n);return r}refreshValue(){var e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){var e,t,n,r,i;this.state===o.EDITOR_STATE.EDITING&&(this.TD=this.getEditedCell(),this.TD?({top:e,start:t,width:n,height:r}=this.getEditedCellRect(),(i=this.select.style).height=r+"px",i.width=n+"px",i.top=e+"px",i[this.hot.isRtl()?"right":"left"]=t+"px",i.margin="0px",(0,a.addClass)(this.select,s)):this.close())}registerShortcuts(){var e=this.hot.getShortcutManager().getContext("editor"),t={group:r};!1!==this.isInFullEditMode()&&e.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{var e=this.select.selectedIndex-1;0<=e&&(this.select[e].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{var e=this.select.selectedIndex+1;e<=this.select.length-1&&(this.select[e].selected=!0)}}],t)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(r)}}t.SelectEditor=i},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(641);t.EDITOR_TYPE=n.EDITOR_TYPE,t.TimeEditor=n.TimeEditor},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(608);t.EDITOR_TYPE="time";class r extends n.TextEditor{static get EDITOR_TYPE(){return"time"}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o),this.TEXTAREA.dir="ltr"}}t.TimeEditor=r},(e,t,n)=>{"use strict";t.__esModule=!0,t.registerAllRenderers=function(){(0,d.registerRenderer)(r.autocompleteRenderer),(0,d.registerRenderer)(i.baseRenderer),(0,d.registerRenderer)(o.checkboxRenderer),(0,d.registerRenderer)(s.htmlRenderer),(0,d.registerRenderer)(a.numericRenderer),(0,d.registerRenderer)(l.passwordRenderer),(0,d.registerRenderer)(u.textRenderer),(0,d.registerRenderer)(c.timeRenderer)};var r=n(643),i=(t.autocompleteRenderer=r.autocompleteRenderer,t.AUTOCOMPLETE_RENDERER=r.RENDERER_TYPE,n(618)),o=(t.baseRenderer=i.baseRenderer,t.BASE_RENDERER=i.RENDERER_TYPE,n(648)),s=(t.checkboxRenderer=o.checkboxRenderer,t.CHECKBOX_RENDERER=o.RENDERER_TYPE,n(645)),a=(t.htmlRenderer=s.htmlRenderer,t.HTML_RENDERER=s.RENDERER_TYPE,n(651)),l=(t.numericRenderer=a.numericRenderer,t.NUMERIC_RENDERER=a.RENDERER_TYPE,n(654)),u=(t.passwordRenderer=l.passwordRenderer,t.PASSWORD_RENDERER=l.RENDERER_TYPE,n(616)),c=(t.textRenderer=u.textRenderer,t.TEXT_RENDERER=u.RENDERER_TYPE,n(656)),d=(t.timeRenderer=c.timeRenderer,t.TIME_RENDERER=c.RENDERER_TYPE,n(464));t.registerRenderer=d.registerRenderer,t.getRegisteredRendererNames=d.getRegisteredRendererNames,t.getRegisteredRenderers=d.getRegisteredRenderers,t.getRenderer=d.getRenderer,t.hasRenderer=d.hasRenderer},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(644);t.RENDERER_TYPE=n.RENDERER_TYPE,t.autocompleteRenderer=n.autocompleteRenderer},(e,t,n)=>{"use strict";var r=n(196),d=(t.__esModule=!0,t.autocompleteRenderer=i,n(645)),h=n(616),f=r(n(457)),p=n(302),r=(n(647),"autocomplete");function i(t,n,r,i,e,o,s){var a=t["rootDocument"],l=s.allowHtml?d.htmlRenderer:h.textRenderer,u=a.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,n,r,i,e,o,s]),n.firstChild||n.appendChild(a.createTextNode(String.fromCharCode(160))),n.insertBefore(u,n.firstChild),(0,p.addClass)(n,"htAutocomplete"),!t.acArrowListener){const c=new f.default(t);t.acArrowListener=function(e){(0,p.hasClass)(e.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(r,i),n)},c.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{c.destroy()})}}t.RENDERER_TYPE=r,i.RENDERER_TYPE=r},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(646);t.RENDERER_TYPE=n.RENDERER_TYPE,t.htmlRenderer=n.htmlRenderer},(e,t,n)=>{"use strict";t.__esModule=!0,t.htmlRenderer=r;var a=n(618),l=n(302);function r(e,t,n,r,i,o,s){a.baseRenderer.apply(this,[e,t,n,r,i,o,s]),(0,l.fastInnerHTML)(t,null==o?"":o,!1)}t.RENDERER_TYPE="html",r.RENDERER_TYPE="html"},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(649);t.RENDERER_TYPE=n.RENDERER_TYPE,t.checkboxRenderer=n.checkboxRenderer},(e,t,n)=>{"use strict";var r=n(196),p=(t.__esModule=!0,t.checkboxRenderer=i,n(203),n(618)),g=r(n(457)),m=n(302),y=n(305),v=n(450),r=(n(650),r(n(454)));const b=new WeakMap,E=new WeakMap,C="htBadValue",w="data-row",S="data-col",T="checkboxRenderer",l="checkbox";function i(c,t,n,r,i,o,s){var a=c["rootDocument"];p.baseRenderer.apply(this,[c,t,n,r,i,o,s]);{var l=c;let e=E.get(l);e||(d=l["rootElement"],(e=new g.default(l)).addEventListener(d,"click",e=>{var t,n,r;t=l,R(n=(e=e).target)&&n.hasAttribute(w)&&n.hasAttribute(S)&&(r=parseInt(n.getAttribute(w),10),n=parseInt(n.getAttribute(S),10),t.getCellMeta(r,n).readOnly)&&e.preventDefault()}),e.addEventListener(d,"mouseup",e=>{var t=l;R(e=e.target)&&e.hasAttribute(w)&&e.hasAttribute(S)&&setTimeout(t.listen,10)}),e.addEventListener(d,"change",t=>{var n=l,r=t.target;if(R(r)&&r.hasAttribute(w)&&r.hasAttribute(S)){var i=parseInt(r.getAttribute(w),10),r=parseInt(r.getAttribute(S),10),o=n.getCellMeta(i,r);if(!o.readOnly){let e=null;e=t.target.checked?void 0===o.uncheckedTemplate||o.checkedTemplate:void 0!==o.uncheckedTemplate&&o.uncheckedTemplate,n.setDataAtCell(i,r,e)}}}),E.set(l,e)),e}let u=function(e){e=e.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}(a);var d=s.label;let e=!1;if(void 0===s.checkedTemplate&&(s.checkedTemplate=!0),void 0===s.uncheckedTemplate&&(s.uncheckedTemplate=!1),(0,m.empty)(t),o===s.checkedTemplate||(0,y.stringify)(o).toLocaleLowerCase(s.locale)===(0,y.stringify)(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||(0,y.stringify)(o).toLocaleLowerCase(s.locale)===(0,y.stringify)(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:(0,y.isEmpty)(o)?(0,m.addClass)(u,"noValue"):(u.style.display="none",(0,m.addClass)(u,C),e=!0),u.setAttribute(w,n),u.setAttribute(S,r),!e&&d){let e="";d.value?e="function"==typeof d.value?d.value.call(this,n,r,i,o):d.value:d.property&&(s=c.getDataAtRowProp(n,d.property),e=null!==s?s:""),r=a,i=e,o=!0!==d.separated,(n=r.createElement("label")).className="htCheckboxRendererLabel "+(o?"fullWidth":""),n.appendChild(r.createTextNode(i));s=n.cloneNode(!0);"before"===d.position?d.separated?(t.appendChild(s),t.appendChild(u)):(s.appendChild(u),u=s):d.position&&"after"!==d.position||(d.separated?(t.appendChild(u),t.appendChild(s)):(s.insertBefore(u,s.firstChild),u=s))}function h(e){var n=0<arguments.length&&void 0!==e&&e,t=c.getSelectedRange();if(t)for(let e=0;e<t.length;e++){var{row:r,col:i}=t[e].getTopStartCorner(),{row:o,col:s}=t[e].getBottomEndCorner(),a=[];for(let t=r;t<=o;t+=1)for(let e=i;e<=s;e+=1){var l,u=c.getCellMeta(t,e);if("checkbox"!==u.type)return;!0!==u.readOnly&&(void 0===u.checkedTemplate&&(u.checkedTemplate=!0),void 0===u.uncheckedTemplate&&(u.uncheckedTemplate=!1),l=c.getDataAtCell(t,e),!1!==n||[u.checkedTemplate,u.checkedTemplate.toString()].includes(l)?a.push([t,e,u.uncheckedTemplate]):[u.uncheckedTemplate,u.uncheckedTemplate.toString(),null,void 0].includes(l)&&a.push([t,e,u.checkedTemplate]))}0<a.length&&c.setDataAtCell(a)}}function f(){var t=c.getSelectedRange();if(t)for(let e=0;e<t.length;e++){var n=t[e].getTopStartCorner(),r=t[e].getBottomEndCorner();for(let t=n.row;t<=r.row;t++)for(let e=n.col;e<=r.col;e++){var i=c.getCellMeta(t,e);if("checkbox"!==i.type)return;var o=c.getCell(t,e);if(null==o)return 1;if(0<o.querySelectorAll("input[type=checkbox]").length&&!i.readOnly)return 1}}}d&&d.separated||t.appendChild(u),e&&t.appendChild(a.createTextNode("#bad-value#")),b.has(c)||(b.set(c,!0),o=(o=c.getShortcutManager()).getContext("grid"),r={group:T},o.addShortcuts([{keys:[["space"]],callback:()=>(h(),!f())},{keys:[["enter"]],callback:()=>(h(),!f()),runOnlyIf:()=>c.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(h(!0),!f()),relativeToGroup:v.SHORTCUTS_GROUP_EDITOR,position:"before"}],r))}function R(e){return"INPUT"===e.tagName&&"checkbox"===e.getAttribute("type")}t.RENDERER_TYPE=l,r.default.getSingleton().add("modifyAutoColumnSizeSeed",function(t,n,r){var{label:n,type:i,row:o,column:s,prop:a}=n;if(i===l){if(n){var{value:i,property:n}=n;let e=r;i?e="function"==typeof i?i(o,s,a,r):i:n&&(s=this.getDataAtRowProp(o,n),e=null!==s?s:r),t=e}return t}}),i.RENDERER_TYPE=l},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(652);t.RENDERER_TYPE=n.RENDERER_TYPE,t.numericRenderer=n.numericRenderer},(e,t,n)=>{"use strict";var r=n(196),d=(t.__esModule=!0,t.numericRenderer=i,n(203),r(n(653))),h=n(616),f=n(461);function i(e,t,n,r,i,o,s){let a=o;var l,u,c;(0,f.isNumeric)(a)&&(l=(o=s.numericFormat)&&o.culture||"-",o=o&&o.pattern,u=(u=s.className||"").length?u.split(" "):[],void 0!==l&&!d.default.languages()[l]&&(c=l.replace("-",""),c=d.default.allLanguages?d.default.allLanguages[l]:d.default[c])&&d.default.registerLanguage(c),d.default.setLanguage(l),a=(0,d.default)(a).format(o||"0"),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),t.dir="ltr"),(0,h.textRenderer)(e,t,n,r,i,a,s)}t.RENDERER_TYPE="numeric",i.RENDERER_TYPE="numeric"},(e,t,n)=>{e.exports=function r(i,o,s){function a(t,e){if(!o[t]){if(!i[t]){if(l)return l(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}n=o[t]={exports:{}};i[t][0].call(n.exports,function(e){return a(i[t][1][e]||e)},n,n.exports,r,i,o,s)}return o[t].exports}for(var l=void 0,e=0;e<s.length;e++)a(s[e]);return a}({1:[function(e,n,t){!function(e){"use strict";var t,P=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,F=Math.ceil,B=Math.floor,H="[BigNumber Error] ",U=H+"Number primitive has more than 15 significant digits: ",V=1e14,W=9007199254740991,$=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13];function j(e){var t=0|e;return 0<e||e===t?t:t-1}function z(e){for(var t,n,r=1,i=e.length,o=e[0]+"";r<i;){for(n=14-(t=e[r++]+"").length;n--;t="0"+t);o+=t}for(i=o.length;48===o.charCodeAt(--i););return o.slice(0,i+1||1)}function G(e,t){var n,r,i=e.c,o=t.c,s=e.s,a=t.s,e=e.e,t=t.e;if(!s||!a)return null;if(n=i&&!i[0],r=o&&!o[0],n||r)return n?r?0:-a:s;if(s!=a)return s;if(n=s<0,r=e==t,!i||!o)return r?0:!i^n?1:-1;if(!r)return t<e^n?1:-1;for(a=(e=i.length)<(t=o.length)?e:t,s=0;s<a;s++)if(i[s]!=o[s])return i[s]>o[s]^n?1:-1;return e==t?0:t<e^n?1:-1}function Y(e,t,n,r){if(e<t||n<e||e!==(e<0?F:B)(e))throw Error(H+(r||"Argument")+("number"==typeof e?e<t||n<e?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function X(e){var t=e.c.length-1;return j(e.e/14)==t&&e.c[t]%2!=0}function K(e,t){return(1<e.length?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function q(e,t,n){var r,i;if(t<0){for(i=n+".";++t;i+=n);e=i+e}else if(++t>(r=e.length)){for(i=n,t-=r;--t;i+=n);e+=i}else t<r&&(e=e.slice(0,t)+"."+e.slice(t));return e}(t=function e(t){var m,d,h,n,u,s,a,l,c,f,y,r=_.prototype={constructor:_,toString:null,valueOf:null},p=new _(1),v=20,b=4,g=-7,E=21,C=-1e7,w=1e7,S=!1,i=1,T=0,R={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},A="0123456789abcdefghijklmnopqrstuvwxyz";function _(e,t){var n,r,i,o,s,a,l,u,c=this;if(!(c instanceof _))return new _(e,t);if(null==t){if(e instanceof _)return c.s=e.s,c.e=e.e,void(c.c=(e=e.c)&&e.slice());if((a="number"==typeof e)&&0*e==0){if(c.s=1/e<0?(e=-e,-1):1,e===~~e){for(o=0,s=e;10<=s;s/=10,o++);return c.e=o,void(c.c=[e])}u=String(e)}else{if(u=String(e),!P.test(u))return h(c,u,a);c.s=45==u.charCodeAt(0)?(u=u.slice(1),-1):1}0<(s=(u=-1<(o=u.indexOf("."))?u.replace(".",""):u).search(/e/i))?(o<0&&(o=s),o+=+u.slice(s+1),u=u.substring(0,s)):o<0&&(o=u.length)}else{if(Y(t,2,A.length,"Base"),u=String(e),10==t)return O(c=new _(e instanceof _?e:u),v+c.e+1,b);if(a="number"==typeof e){if(0*e!=0)return h(c,u,a,t);if(c.s=1/e<0?(u=u.slice(1),-1):1,_.DEBUG&&15<u.replace(/^0\.0*|\./,"").length)throw Error(U+e);a=!1}else c.s=45===u.charCodeAt(0)?(u=u.slice(1),-1):1;for(n=A.slice(0,t),o=s=0,l=u.length;s<l;s++)if(n.indexOf(r=u.charAt(s))<0){if("."==r){if(o<s){o=l;continue}}else if(!i&&(u==u.toUpperCase()&&(u=u.toLowerCase())||u==u.toLowerCase()&&(u=u.toUpperCase()))){i=!0,s=-1,o=0;continue}return h(c,String(e),a,t)}-1<(o=(u=d(u,t,10,c.s)).indexOf("."))?u=u.replace(".",""):o=u.length}for(s=0;48===u.charCodeAt(s);s++);for(l=u.length;48===u.charCodeAt(--l););if(u=u.slice(s,++l)){if(l-=s,a&&_.DEBUG&&15<l&&(W<e||e!==B(e)))throw Error(U+c.s*e);if(w<(o=o-s-1))c.c=c.e=null;else if(o<C)c.c=[c.e=0];else{if(c.e=o,c.c=[],s=(o+1)%14,o<0&&(s+=14),s<l){for(s&&c.c.push(+u.slice(0,s)),l-=14;s<l;)c.c.push(+u.slice(s,s+=14));s=14-(u=u.slice(s)).length}else s-=l;for(;s--;u+="0");c.c.push(+u)}}else c.c=[c.e=0]}function o(e,t,n,r){var i,o,s,a;if(null==n?n=b:Y(n,0,8),!e.c)return e.toString();if(i=e.c[0],o=e.e,null==t)a=z(e.c),a=1==r||2==r&&(o<=g||E<=o)?K(a,o):q(a,o,"0");else if(n=(e=O(new _(e),t,n)).e,s=(a=z(e.c)).length,1==r||2==r&&(t<=n||n<=g)){for(;s<t;a+="0",s++);a=K(a,n)}else if(t-=o,a=q(a,n,"0"),s<n+1){if(0<--t)for(a+=".";t--;a+="0");}else if(0<(t+=n-s))for(n+1==s&&(a+=".");t--;a+="0");return e.s<0&&i?"-"+a:a}function N(e,t){for(var n,r=1,i=new _(e[0]);r<e.length;r++){if(!(n=new _(e[r])).s){i=n;break}t.call(i,n)&&(i=n)}return i}function x(e,t,n){for(var r=1,i=t.length;!t[--i];t.pop());for(i=t[0];10<=i;i/=10,r++);return(n=r+14*n-1)>w?e.c=e.e=null:e.c=n<C?[e.e=0]:(e.e=n,t),e}function O(e,t,n,r){var i,o,s,a,l,u,c,d=e.c,h=$;if(d){e:{for(i=1,a=d[0];10<=a;a/=10,i++);if((o=t-i)<0)o+=14,s=t,c=(l=d[u=0])/h[i-s-1]%10|0;else if((u=F((o+1)/14))>=d.length){if(!r)break e;for(;d.length<=u;d.push(0));l=c=0,s=(o%=14)-14+(i=1)}else{for(l=a=d[u],i=1;10<=a;a/=10,i++);c=(s=(o%=14)-14+i)<0?0:l/h[i-s-1]%10|0}if(r=r||t<0||null!=d[u+1]||(s<0?l:l%h[i-s-1]),r=n<4?(c||r)&&(0==n||n==(e.s<0?3:2)):5<c||5==c&&(4==n||r||6==n&&(0<o?0<s?l/h[i-s]:0:d[u-1])%10&1||n==(e.s<0?8:7)),t<1||!d[0])return d.length=0,r?(t-=e.e+1,d[0]=h[(14-t%14)%14],e.e=-t||0):d[0]=e.e=0,e;if(0==o?(d.length=u,a=1,u--):(d.length=u+1,a=h[14-o],d[u]=0<s?B(l/h[i-s]%h[s])*a:0),r)for(;;){if(0==u){for(o=1,s=d[0];10<=s;s/=10,o++);for(s=d[0]+=a,a=1;10<=s;s/=10,a++);o!=a&&(e.e++,d[0]==V)&&(d[0]=1);break}if(d[u]+=a,d[u]!=V)break;d[u--]=0,a=1}for(o=d.length;0===d[--o];d.pop());}e.e>w?e.c=e.e=null:e.e<C&&(e.c=[e.e=0])}return e}function I(e){var t,n=e.e;return null===n?e.toString():(t=z(e.c),t=n<=g||E<=n?K(t,n):q(t,n,"0"),e.s<0?"-"+t:t)}return _.clone=e,_.ROUND_UP=0,_.ROUND_DOWN=1,_.ROUND_CEIL=2,_.ROUND_FLOOR=3,_.ROUND_HALF_UP=4,_.ROUND_HALF_DOWN=5,_.ROUND_HALF_EVEN=6,_.ROUND_HALF_CEIL=7,_.ROUND_HALF_FLOOR=8,_.EUCLID=9,_.config=_.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error(H+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(Y(n=e[t],0,1e9,t),v=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(Y(n=e[t],0,8,t),b=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(Y(n[0],-1e9,0,t),Y(n[1],0,1e9,t),g=n[0],E=n[1]):(Y(n,-1e9,1e9,t),g=-(E=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)Y(n[0],-1e9,-1,t),Y(n[1],1,1e9,t),C=n[0],w=n[1];else{if(Y(n,-1e9,1e9,t),!n)throw Error(H+t+" cannot be zero: "+n);C=-(w=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(H+t+" not true or false: "+n);if(n&&("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes))throw S=!n,Error(H+"crypto unavailable");S=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(Y(n=e[t],0,9,t),i=n),e.hasOwnProperty(t="POW_PRECISION")&&(Y(n=e[t],0,1e9,t),T=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error(H+t+" not an object: "+n);R=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.$|[+-.\s]|(.).*\1/.test(n))throw Error(H+t+" invalid: "+n);A=n}}return{DECIMAL_PLACES:v,ROUNDING_MODE:b,EXPONENTIAL_AT:[g,E],RANGE:[C,w],CRYPTO:S,MODULO_MODE:i,POW_PRECISION:T,FORMAT:R,ALPHABET:A}},_.isBigNumber=function(e){return e instanceof _||e&&!0===e._isBigNumber||!1},_.maximum=_.max=function(){return N(arguments,r.lt)},_.minimum=_.min=function(){return N(arguments,r.gt)},_.random=(n=9007199254740992,u=Math.random()*n&2097151?function(){return B(Math.random()*n)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,n,r,i,o,s=0,a=[],l=new _(p);if(null==e?e=v:Y(e,0,1e9),i=F(e/14),S)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(i*=2));s<i;)9e15<=(o=131072*t[s]+(t[s+1]>>>11))?(n=crypto.getRandomValues(new Uint32Array(2)),t[s]=n[0],t[s+1]=n[1]):(a.push(o%1e14),s+=2);s=i/2}else{if(!crypto.randomBytes)throw S=!1,Error(H+"crypto unavailable");for(t=crypto.randomBytes(i*=7);s<i;)9e15<=(o=281474976710656*(31&t[s])+1099511627776*t[s+1]+4294967296*t[s+2]+16777216*t[s+3]+(t[s+4]<<16)+(t[s+5]<<8)+t[s+6])?crypto.randomBytes(7).copy(t,s):(a.push(o%1e14),s+=7);s=i/7}if(!S)for(;s<i;)(o=u())<9e15&&(a[s++]=o%1e14);for(e%=14,(i=a[--s])&&e&&(a[s]=B(i/(o=$[14-e]))*o);0===a[s];a.pop(),s--);if(s<0)a=[r=0];else{for(r=-1;0===a[0];a.splice(0,1),r-=14);for(s=1,o=a[0];10<=o;o/=10,s++);s<14&&(r-=14-s)}return l.e=r,l.c=a,l}),_.sum=function(){for(var e=1,t=arguments,n=new _(t[0]);e<t.length;)n=n.plus(t[e++]);return n},y="0123456789",d=function(e,t,n,r,i){var o,s,a,l,u,c,d,h,f=e.indexOf("."),p=v,g=b;for(0<=f&&(l=T,T=0,e=e.replace(".",""),c=(h=new _(t)).pow(e.length-f),T=l,h.c=L(q(z(c.c),c.e,"0"),10,n,y),h.e=h.c.length),a=l=(d=L(e,t,n,i?(o=A,y):(o=y,A))).length;0==d[--l];d.pop());if(!d[0])return o.charAt(0);if(f<0?--a:(c.c=d,c.e=a,c.s=r,d=(c=m(c,h,p,g,n)).c,u=c.r,a=c.e),f=d[s=a+p+1],l=n/2,u=u||s<0||null!=d[s+1],u=g<4?(null!=f||u)&&(0==g||g==(c.s<0?3:2)):l<f||f==l&&(4==g||u||6==g&&1&d[s-1]||g==(c.s<0?8:7)),s<1||!d[0])e=u?q(o.charAt(1),-p,o.charAt(0)):o.charAt(0);else{if(d.length=s,u)for(--n;++d[--s]>n;)d[s]=0,s||(++a,d=[1].concat(d));for(l=d.length;!d[--l];);for(f=0,e="";f<=l;e+=o.charAt(d[f++]));e=q(e,a,o.charAt(0))}return e},m=function(e,t,n,r,i){var o,s,a,l,u,c,d,h,f,p,g,m,y,v,b,E,C,w=e.s==t.s?1:-1,S=e.c,T=t.c;if(!(S&&S[0]&&T&&T[0]))return new _(e.s&&t.s&&(S?!T||S[0]!=T[0]:T)?S&&0==S[0]||!T?0*w:w/0:NaN);for(f=(h=new _(w)).c=[],w=n+(s=e.e-t.e)+1,i||(i=V,s=j(e.e/14)-j(t.e/14),w=w/14|0),a=0;T[a]==(S[a]||0);a++);if(T[a]>(S[a]||0)&&s--,w<0)f.push(1),l=!0;else{for(v=S.length,E=T.length,w+=2,1<(u=B(i/(T[a=0]+1)))&&(T=M(T,u,i),S=M(S,u,i),E=T.length,v=S.length),y=E,g=(p=S.slice(0,E)).length;g<E;p[g++]=0);C=T.slice(),C=[0].concat(C),b=T[0],T[1]>=i/2&&b++;do{if(u=0,(o=k(T,p,E,g))<0){if(m=p[0],E!=g&&(m=m*i+(p[1]||0)),1<(u=B(m/b)))for(d=(c=M(T,u=i<=u?i-1:u,i)).length,g=p.length;1==k(c,p,d,g);)u--,D(c,E<d?C:T,d,i),d=c.length,o=1;else 0==u&&(o=u=1),d=(c=T.slice()).length;if(D(p,c=d<g?[0].concat(c):c,g,i),g=p.length,-1==o)for(;k(T,p,E,g)<1;)u++,D(p,E<g?C:T,g,i),g=p.length}else 0===o&&(u++,p=[0])}while(f[a++]=u,p[0]?p[g++]=S[y]||0:(p=[S[y]],g=1),(y++<v||null!=p[0])&&w--);l=null!=p[0],f[0]||f.splice(0,1)}if(i==V){for(a=1,w=f[0];10<=w;w/=10,a++);O(h,n+(h.e=a+14*s-1)+1,r,l)}else h.e=s,h.r=+l;return h},s=/^(-?)0([xbo])(?=\w[\w.]*$)/i,a=/^([^.]+)\.$/,l=/^\.([^.]+)$/,c=/^-?(Infinity|NaN)$/,f=/^\s*\+(?=[\w.])|^\s+|\s+$/g,h=function(e,t,n,r){var i,o=n?t:t.replace(f,"");if(c.test(o))e.s=isNaN(o)?null:o<0?-1:1,e.c=e.e=null;else{if(!n&&(o=o.replace(s,function(e,t,n){return i="x"==(n=n.toLowerCase())?16:"b"==n?2:8,r&&r!=i?e:t}),r&&(i=r,o=o.replace(a,"$1").replace(l,"0.$1")),t!=o))return new _(o,i);if(_.DEBUG)throw Error(H+"Not a"+(r?" base "+r:"")+" number: "+t);e.c=e.e=e.s=null}},r.absoluteValue=r.abs=function(){var e=new _(this);return e.s<0&&(e.s=1),e},r.comparedTo=function(e,t){return G(this,new _(e,t))},r.decimalPlaces=r.dp=function(e,t){var n,r;if(null!=e)return Y(e,0,1e9),null==t?t=b:Y(t,0,8),O(new _(this),e+this.e+1,t);if(!(e=this.c))return null;if(n=14*((r=e.length-1)-j(this.e/14)),r=e[r])for(;r%10==0;r/=10,n--);return n=n<0?0:n},r.dividedBy=r.div=function(e,t){return m(this,new _(e,t),v,b)},r.dividedToIntegerBy=r.idiv=function(e,t){return m(this,new _(e,t),0,1)},r.exponentiatedBy=r.pow=function(e,t){var n,r,i,o,s,a,l,u,c=this;if((e=new _(e)).c&&!e.isInteger())throw Error(H+"Exponent not an integer: "+I(e));if(null!=t&&(t=new _(t)),s=14<e.e,!c.c||!c.c[0]||1==c.c[0]&&!c.e&&1==c.c.length||!e.c||!e.c[0])return u=new _(Math.pow(+I(c),s?2-X(e):+I(e))),t?u.mod(t):u;if(a=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new _(NaN);(r=!a&&c.isInteger()&&t.isInteger())&&(c=c.mod(t))}else{if(9<e.e&&(0<c.e||c.e<-1||(0==c.e?1<c.c[0]||s&&24e7<=c.c[1]:c.c[0]<8e13||s&&c.c[0]<=9999975e7)))return o=c.s<0&&X(e)?-0:0,-1<c.e&&(o=1/o),new _(a?1/o:o);T&&(o=F(T/14+2))}for(l=s?(n=new _(.5),a&&(e.s=1),X(e)):(i=Math.abs(+I(e)))%2,u=new _(p);;){if(l){if(!(u=u.times(c)).c)break;o?u.c.length>o&&(u.c.length=o):r&&(u=u.mod(t))}if(i){if(0===(i=B(i/2)))break;l=i%2}else if(O(e=e.times(n),e.e+1,1),14<e.e)l=X(e);else{if(0==(i=+I(e)))break;l=i%2}c=c.times(c),o?c.c&&c.c.length>o&&(c.c.length=o):r&&(c=c.mod(t))}return r?u:(a&&(u=p.div(u)),t?u.mod(t):o?O(u,T,b,void 0):u)},r.integerValue=function(e){var t=new _(this);return null==e?e=b:Y(e,0,8),O(t,t.e+1,e)},r.isEqualTo=r.eq=function(e,t){return 0===G(this,new _(e,t))},r.isFinite=function(){return!!this.c},r.isGreaterThan=r.gt=function(e,t){return 0<G(this,new _(e,t))},r.isGreaterThanOrEqualTo=r.gte=function(e,t){return 1===(t=G(this,new _(e,t)))||0===t},r.isInteger=function(){return!!this.c&&j(this.e/14)>this.c.length-2},r.isLessThan=r.lt=function(e,t){return G(this,new _(e,t))<0},r.isLessThanOrEqualTo=r.lte=function(e,t){return-1===(t=G(this,new _(e,t)))||0===t},r.isNaN=function(){return!this.s},r.isNegative=function(){return this.s<0},r.isPositive=function(){return 0<this.s},r.isZero=function(){return!!this.c&&0==this.c[0]},r.minus=function(e,t){var n,r,i,o,s=this.s;if(t=(e=new _(e,t)).s,!s||!t)return new _(NaN);if(s!=t)return e.s=-t,this.plus(e);var a=this.e/14,l=e.e/14,u=this.c,c=e.c;if(!a||!l){if(!u||!c)return u?(e.s=-t,e):new _(c?this:NaN);if(!u[0]||!c[0])return c[0]?(e.s=-t,e):new _(u[0]?this:3==b?-0:0)}if(a=j(a),l=j(l),u=u.slice(),s=a-l){for((i=(o=s<0)?(s=-s,u):(l=a,c)).reverse(),t=s;t--;i.push(0));i.reverse()}else for(r=(o=(s=u.length)<(t=c.length))?s:t,s=t=0;t<r;t++)if(u[t]!=c[t]){o=u[t]<c[t];break}if(o&&(i=u,u=c,c=i,e.s=-e.s),0<(t=(r=c.length)-(n=u.length)))for(;t--;u[n++]=0);for(t=V-1;s<r;){if(u[--r]<c[r]){for(n=r;n&&!u[--n];u[n]=t);--u[n],u[r]+=V}u[r]-=c[r]}for(;0==u[0];u.splice(0,1),--l);return u[0]?x(e,u,l):(e.s=3==b?-1:1,e.c=[e.e=0],e)},r.modulo=r.mod=function(e,t){var n;return e=new _(e,t),!this.c||!e.s||e.c&&!e.c[0]?new _(NaN):!e.c||this.c&&!this.c[0]?new _(this):(9==i?(t=e.s,e.s=1,n=m(this,e,0,3),e.s=t,n.s*=t):n=m(this,e,0,i),(e=this.minus(n.times(e))).c[0]||1!=i||(e.s=this.s),e)},r.multipliedBy=r.times=function(e,t){var n,r,i,o,s,a,l,u,c,d,h,f,p=this.c,g=(e=new _(e,t)).c;if(!(p&&g&&p[0]&&g[0]))return!this.s||!e.s||p&&!p[0]&&!g||g&&!g[0]&&!p?e.c=e.e=e.s=null:(e.s*=this.s,p&&g?(e.c=[0],e.e=0):e.c=e.e=null),e;for(t=j(this.e/14)+j(e.e/14),e.s*=this.s,(a=p.length)<(c=g.length)&&(f=p,p=g,g=f,r=a,a=c,c=r),r=a+c,f=[];r--;f.push(0));for(r=c;0<=--r;){for(d=g[r]%1e7,h=g[r]/1e7|(n=0),i=r+(o=a);r<i;)n=((l=d*(l=p[--o]%1e7)+(s=h*l+(u=p[o]/1e7|0)*d)%1e7*1e7+f[i]+n)/1e14|0)+(s/1e7|0)+h*u,f[i--]=l%1e14;f[i]=n}return n?++t:f.splice(0,1),x(e,f,t)},r.negated=function(){var e=new _(this);return e.s=-e.s||null,e},r.plus=function(e,t){var n,r=this.s;if(t=(e=new _(e,t)).s,!r||!t)return new _(NaN);if(r!=t)return e.s=-t,this.minus(e);var i=this.e/14,o=e.e/14,s=this.c,a=e.c;if(!i||!o){if(!s||!a)return new _(r/0);if(!s[0]||!a[0])return a[0]?e:new _(s[0]?this:0*r)}if(i=j(i),o=j(o),s=s.slice(),r=i-o){for((n=0<r?(o=i,a):(r=-r,s)).reverse();r--;n.push(0));n.reverse()}for((r=s.length)-(t=a.length)<0&&(n=a,a=s,s=n,t=r),r=0;t;)r=(s[--t]=s[t]+a[t]+r)/V|0,s[t]=V===s[t]?0:s[t]%V;return r&&(s=[r].concat(s),++o),x(e,s,o)},r.precision=r.sd=function(e,t){var n,r;if(null!=e&&e!==!!e)return Y(e,1,1e9),null==t?t=b:Y(t,0,8),O(new _(this),e,t);if(!(t=this.c))return null;if(n=14*(r=t.length-1)+1,r=t[r]){for(;r%10==0;r/=10,n--);for(r=t[0];10<=r;r/=10,n++);}return n=e&&this.e+1>n?this.e+1:n},r.shiftedBy=function(e){return Y(e,-W,W),this.times("1e"+e)},r.squareRoot=r.sqrt=function(){var e,t,n,r,i,o=this.c,s=this.s,a=this.e,l=v+4,u=new _("0.5");if(1!==s||!o||!o[0])return new _(!s||s<0&&(!o||o[0])?NaN:o?this:1/0);if((n=0==(s=Math.sqrt(+I(this)))||s==1/0?(((t=z(o)).length+a)%2==0&&(t+="0"),s=Math.sqrt(+t),a=j((a+1)/2)-(a<0||a%2),new _(t=s==1/0?"1e"+a:(t=s.toExponential()).slice(0,t.indexOf("e")+1)+a)):new _(s+"")).c[0])for((s=(a=n.e)+l)<3&&(s=0);;)if(i=n,n=u.times(i.plus(m(this,i,l,1))),z(i.c).slice(0,s)===(t=z(n.c)).slice(0,s)){if(n.e<a&&--s,"9999"!=(t=t.slice(s-3,s+1))&&(r||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(O(n,n.e+v+2,1),e=!n.times(n).eq(this));break}if(!r&&(O(i,i.e+v+2,0),i.times(i).eq(this))){n=i;break}l+=4,s+=4,r=1}return O(n,n.e+v+1,b,e)},r.toExponential=function(e,t){return null!=e&&(Y(e,0,1e9),e++),o(this,e,t,1)},r.toFixed=function(e,t){return null!=e&&(Y(e,0,1e9),e=e+this.e+1),o(this,e,t)},r.toFormat=function(e,t,n){if(null==n)null!=e&&t&&"object"==typeof t?(n=t,t=null):e&&"object"==typeof e?(n=e,e=t=null):n=R;else if("object"!=typeof n)throw Error(H+"Argument not an object: "+n);if(e=this.toFixed(e,t),this.c){var r,t=e.split("."),i=+n.groupSize,o=+n.secondaryGroupSize,s=n.groupSeparator||"",a=t[0],t=t[1],l=this.s<0,u=l?a.slice(1):a,c=u.length;if(o&&(r=i,i=o,c-=o=r),0<i&&0<c){for(a=u.substr(0,r=c%i||i);r<c;r+=i)a+=s+u.substr(r,i);0<o&&(a+=s+u.slice(r)),l&&(a="-"+a)}e=t?a+(n.decimalSeparator||"")+((o=+n.fractionGroupSize)?t.replace(new RegExp("\\d{"+o+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):t):a}return(n.prefix||"")+e+(n.suffix||"")},r.toFraction=function(e){var t,n,r,i,o,s,a,l,u,c,d=this.c;if(null!=e&&(!(a=new _(e)).isInteger()&&(a.c||1!==a.s)||a.lt(p)))throw Error(H+"Argument "+(a.isInteger()?"out of range: ":"not an integer: ")+I(a));if(!d)return new _(this);for(t=new _(p),u=n=new _(p),r=l=new _(p),d=z(d),o=t.e=d.length-this.e-1,t.c[0]=$[(s=o%14)<0?14+s:s],e=!e||0<a.comparedTo(t)?0<o?t:u:a,s=w,w=1/0,a=new _(d),l.c[0]=0;c=m(a,t,0,1),1!=(i=n.plus(c.times(r))).comparedTo(e);)n=r,r=i,u=l.plus(c.times(i=u)),l=i,t=a.minus(c.times(i=t)),a=i;return i=m(e.minus(n),r,0,1),l=l.plus(i.times(u)),n=n.plus(i.times(r)),l.s=u.s=this.s,d=m(u,r,o*=2,b).minus(this).abs().comparedTo(m(l,n,o,b).minus(this).abs())<1?[u,r]:[l,n],w=s,d},r.toNumber=function(){return+I(this)},r.toPrecision=function(e,t){return null!=e&&Y(e,1,1e9),o(this,e,t,2)},r.toString=function(e){var t,n=this,r=n.s,i=n.e;return null===i?r?(t="Infinity",r<0&&(t="-"+t)):t="NaN":(t=null==e?i<=g||E<=i?K(z(n.c),i):q(z(n.c),i,"0"):10===e?q(z((n=O(new _(n),v+i+1,b)).c),n.e,"0"):(Y(e,2,A.length,"Base"),d(q(z(n.c),i,"0"),10,e,r,!0)),r<0&&n.c[0]&&(t="-"+t)),t},r.valueOf=r.toJSON=function(){return I(this)},r._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(r[Symbol.toStringTag]="BigNumber",r[Symbol.for("nodejs.util.inspect.custom")]=r.valueOf),null!=t&&_.set(t),_;function M(e,t,n){var r,i,o,s=0,a=e.length,l=t%1e7,u=t/1e7|0;for(e=e.slice();a--;)s=((i=l*(o=e[a]%1e7)+(r=u*o+(o=e[a]/1e7|0)*l)%1e7*1e7+s)/n|0)+(r/1e7|0)+u*o,e[a]=i%n;return e=s?[s].concat(e):e}function k(e,t,n,r){var i,o;if(n!=r)o=r<n?1:-1;else for(i=o=0;i<n;i++)if(e[i]!=t[i]){o=e[i]>t[i]?1:-1;break}return o}function D(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&1<e.length;e.splice(0,1));}function L(e,t,n,r){for(var i,o,s=[0],a=0,l=e.length;a<l;){for(o=s.length;o--;s[o]*=t);for(s[0]+=r.indexOf(e.charAt(a++)),i=0;i<s.length;i++)n-1<s[i]&&(null==s[i+1]&&(s[i+1]=0),s[i+1]+=s[i]/n|0,s[i]%=n)}return s.reverse()}}()).default=t.BigNumber=t,void 0!==n&&n.exports?n.exports=t:(e=e||("undefined"!=typeof self&&self?self:window)).BigNumber=t}(this)},{}],2:[function(e,t,n){"use strict";t.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1==t?"st":2==t?"nd":3==t?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(e,t,n){"use strict";function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var k=e("./globalState"),o=e("./validating"),s=e("./parsing"),e=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],y={general:{scale:1024,suffixes:e,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:e,marker:"d"}},D={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function i(e){var t,n,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=2<arguments.length?arguments[2]:void 0;return"string"==typeof r&&(r=s.parseFormat(r)),o.validateFormat(r)?(t=r.prefix||"",n=r.postfix||"",t+function(e,t,n){switch(t.output){case"currency":return t=E(t,k.currentCurrencyDefaultFormat()),r=e,f=t,h=(i=k).currentCurrency(),o=Object.assign({},D,f),s=void 0,u="",d=!!o.totalLength||!!o.forceAverage||o.average,c=f.currencyPosition||h.position,h=f.currencySymbol||h.symbol,o.spaceSeparated&&(u=" "),f=b({instance:r,providedFormat:f,state:i,decimalSeparator:s="infix"===c?u+h+u:s}),"prefix"===c&&(f=r._value<0&&"sign"===o.negative?"-".concat(u).concat(h).concat(f.slice(1)):h+u+f),f=c&&"postfix"!==c?f:f+(u=d?"":u)+h;case"percent":return t=E(t,k.currentPercentageDefaultFormat()),i=k,s=n,o=(r=t).prefixSymbol,s=b({instance:s(100*e._value),providedFormat:r,state:i}),i=Object.assign({},D,r),o?"%".concat(i.spaceSeparated?" ":"").concat(s):"".concat(s).concat(i.spaceSeparated?" ":"","%");case"byte":return t=E(t,k.currentByteDefaultFormat()),c=k,d=n,h=(u=t).base||"binary",g=(p=v(e._value,(f=y[h]).suffixes,f.scale)).value,p=p.suffix,g=b({instance:d(g),providedFormat:u,state:c,defaults:c.currentByteDefaultFormat()}),m=c.currentAbbreviations(),"".concat(g).concat(m.spaced?" ":"").concat(p);case"time":return t=E(t,k.currentTimeDefaultFormat()),g=e,m=Math.floor(g._value/60/60),p=Math.floor((g._value-60*m*60)/60),g=Math.round(g._value-60*m*60-60*p),"".concat(m,":").concat(p<10?"0":"").concat(p,":").concat(g<10?"0":"").concat(g);case"ordinal":return t=E(t,k.currentOrdinalDefaultFormat()),m=e,p=t,a=(g=k).currentOrdinal(),l=Object.assign({},D,p),p=b({instance:m,providedFormat:p,state:g}),g=a(m._value),"".concat(p).concat(l.spaceSeparated?" ":"").concat(g);default:return b({instance:e,providedFormat:t,numbro:n})}var r,i,o,s,a,l,u,c,d,h,f,p,g,m}(e,r,i)+n):"ERROR: invalid format"}function v(e,t,n){var r=t[0],i=Math.abs(e);if(n<=i){for(var o=1;o<t.length;++o){var s=Math.pow(n,o),a=Math.pow(n,o+1);if(s<=i&&i<a){r=t[o],e/=s;break}}r===t[0]&&(e/=Math.pow(n,t.length-1),r=t[t.length-1])}return{value:e,suffix:r}}function L(e){for(var t="",n=0;n<e;n++)t+="0";return t}function b(e){var t=e.instance,n=e.providedFormat,r=e.state,r=void 0===r?k:r,i=e.decimalSeparator,e=e.defaults,e=void 0===e?r.currentDefaults():e,t=t._value;if(0===t&&r.hasZeroFormat())return r.getZeroFormat();if(!isFinite(t))return t.toString();var o,s,a,l,u,c,e=Object.assign({},D,e,n),d=e.totalLength,h=d?0:e.characteristic,f=e.optionalCharacteristic,p=e.forceAverage,g=!!d||!!p||e.average,m=d?-1:g&&void 0===n.mantissa?0:e.mantissa,n=!d&&(void 0===n.optionalMantissa?-1===m:e.optionalMantissa),y=e.trimMantissa,v=e.thousandSeparated,b=e.spaceSeparated,E=e.negative,C=e.forceSign,e=e.exponential,w="";g&&(p={value:t,forceAverage:p,abbreviations:r.currentAbbreviations(),spaceSeparated:b,totalLength:d},b=p.value,c=p.forceAverage,o=p.abbreviations,s=void 0!==(s=p.spaceSeparated)&&s,p=void 0===(p=p.totalLength)?0:p,a="",l=Math.abs(b),u=-1,l>=Math.pow(10,12)&&!c||"trillion"===c?(a=o.trillion,b/=Math.pow(10,12)):l<Math.pow(10,12)&&l>=Math.pow(10,9)&&!c||"billion"===c?(a=o.billion,b/=Math.pow(10,9)):l<Math.pow(10,9)&&l>=Math.pow(10,6)&&!c||"million"===c?(a=o.million,b/=Math.pow(10,6)):(l<Math.pow(10,6)&&l>=Math.pow(10,3)&&!c||"thousand"===c)&&(a=o.thousand,b/=Math.pow(10,3)),a=a&&(s?" ":"")+a,p&&(l=b.toString().split(".")[0],u=Math.max(p-l.length,0)),t=(c={value:b,abbreviation:a,mantissaPrecision:u}).value,w+=c.abbreviation,d)&&(m=c.mantissaPrecision),e&&(s=(o={value:t,characteristicPrecision:h}).value,l=void 0===(p=o.characteristicPrecision)?0:p,a=(b=M(s.toExponential().split("e"),2))[0],u=b[1],d=+a,l&&1<l&&(d*=Math.pow(10,l-1),u=0<=(u=+u-(l-1))?"+".concat(u):u),t=(c={value:d,abbreviation:"e".concat(u)}).value,w=c.abbreviation+w);p=t.toString(),b=n,d=y;var S,T,R,A,_,N,x,O,I=-1===m?p:(p=m,A=-1!==(n=t).toString().indexOf("e")?(S=p,R=M((N=n.toString()).split("e"),2),A=R[0],R=R[1],A=M(A.split("."),2),_=A[0],A=void 0===(A=A[1])?"":A,N=0<+R?_+A+L(R-A.length):(T=(+_<0?"-0":"0").concat(T="."),(_=(L(-R-1)+Math.abs(_)+A).substr(0,S)).length<S&&(_+=L(S-_.length)),T+_),0<+R&&0<S&&(N+=".".concat(L(S))),N):(Math.round(+"".concat(n,"e+").concat(p))/Math.pow(10,p)).toFixed(p),_=(T=M(A.toString().split("."),2))[0],(S=void 0===(R=T[1])?"":R).match(/^0+$/)&&(b||d)?_:(N=S.match(/0+$/),d&&N?"".concat(_,".").concat(S.toString().slice(0,N.index)):A.toString()));return y=I=function(e,t){var n=I,r=M(n.toString().split("."),2),i=r[0],r=r[1];if(i.match(/^-?0$/)&&e)return r?"".concat(i.replace("0",""),".").concat(r):i.replace("0","");if(i.length<t)for(var o=t-i.length,s=0;s<o;s++)n="0".concat(n);return n.toString()}(f,h),m=t,n=v,p=i,b=r.currentDelimiters(),x=b.thousands,p=p||b.decimal,b=b.thousandsSize||3,y=y.toString(),O=y.split(".")[0],y=y.split(".")[1],n&&(function(e,t){for(var n=[],r=0,i=e;0<i;i--)r===t&&(n.unshift(i),r=0),r++;return n}((O=m<0?O.slice(1):O).length,b).forEach(function(e,t){O=O.slice(0,e+t)+x+O.slice(e+t)}),m<0)&&(O="-".concat(O)),I=y?O+p+y:O,(g||e)&&(I+=w),(C||t<0)&&(d=I,f=E,I=0===(h=t)?d:0==+d?d.replace("-",""):0<h?"+".concat(d):"sign"===f?d:"(".concat(d.replace("-",""),")")),I}function E(e,t){var n;return!e||1===(n=Object.keys(e)).length&&"output"===n[0]?t:e}t.exports=function(r){return{format:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.apply(void 0,t.concat([r]))},getByteUnit:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){var t=y.general;return v(e._value,t.suffixes,t.scale).suffix}.apply(void 0,t.concat([r]))},getBinaryByteUnit:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){var t=y.binary;return v(e._value,t.suffixes,t.scale).suffix}.apply(void 0,t.concat([r]))},getDecimalByteUnit:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){var t=y.decimal;return v(e._value,t.suffixes,t.scale).suffix}.apply(void 0,t.concat([r]))},formatOrDefault:E}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(e,t,n){"use strict";var i=e("./en-US"),r=e("./validating"),o=e("./parsing"),s={},a=void 0,l={},u=null,c={};function d(e){a=e}function h(){return l[a]}s.languages=function(){return Object.assign({},l)},s.currentLanguage=function(){return a},s.currentCurrency=function(){return h().currency},s.currentAbbreviations=function(){return h().abbreviations},s.currentDelimiters=function(){return h().delimiters},s.currentOrdinal=function(){return h().ordinal},s.currentDefaults=function(){return Object.assign({},h().defaults,c)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),h().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),h().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),h().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),h().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),h().timeFormat)},s.setDefaults=function(e){e=o.parseFormat(e),r.validateFormat(e)&&(c=e)},s.getZeroFormat=function(){return u},s.setZeroFormat=function(e){return u="string"==typeof e?e:null},s.hasZeroFormat=function(){return null!==u},s.languageData=function(e){if(e){if(l[e])return l[e];throw new Error('Unknown tag "'.concat(e,'"'))}return h()},s.registerLanguage=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!r.validateLanguage(e))throw new Error("Invalid language data");l[e.languageTag]=e,t&&d(e.languageTag)},s.setLanguage=function(e){var t,n,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:i.languageTag;if(!l[e])return t=e.split("-")[0],n=Object.keys(l).find(function(e){return e.split("-")[0]===t}),l[n]?void d(n):void d(r);d(e)},s.registerLanguage(i),a=i.languageTag,t.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,e,t){"use strict";e.exports=function(t){return{loadLanguagesInNode:function(e){var n=t;e.forEach(function(e){var t=void 0;try{t=r("../languages/".concat(e))}catch(t){console.error('Unable to load "'.concat(e,'". No matching language file found.'))}t&&n.registerLanguage(t)})}}}},{}],6:[function(e,t,n){"use strict";var o=e("bignumber.js");function r(e,t,n){var r=new o(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new o(i),e._value=r.minus(i).toNumber(),e}t.exports=function(i){return{add:function(e,t){return t=t,r=i,n=new o((e=e)._value),r.isNumbro(r=t)&&(r=t._value),r=new o(r),e._value=n.plus(r).toNumber(),e;var n,r},subtract:function(e,t){return r(e,t,i)},multiply:function(e,t){return t=t,r=i,n=new o((e=e)._value),r.isNumbro(r=t)&&(r=t._value),r=new o(r),e._value=n.times(r).toNumber(),e;var n,r},divide:function(e,t){return t=t,r=i,n=new o((e=e)._value),r.isNumbro(r=t)&&(r=t._value),r=new o(r),e._value=n.dividedBy(r).toNumber(),e;var n,r},set:function(e,t){return e=e,n=t=t,i.isNumbro(t)&&(n=t._value),e._value=n,e;var n},difference:function(e,t){return t=t,r(e=(n=i)(e._value),t,n),Math.abs(e._value);var n}}}},{"bignumber.js":1}],7:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=e("./globalState"),o=e("./validating"),s=e("./loading")(p),a=e("./unformatting"),l=e("./formatting")(p),u=e("./manipulating")(p),c=e("./parsing"),d=(r(h.prototype,[{key:"clone",value:function(){return p(this._value)}},{key:"format",value:function(){return l.format(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}},{key:"formatCurrency",value:function(e){return"string"==typeof e&&(e=c.parseFormat(e)),(e=l.formatOrDefault(e,i.currentCurrencyDefaultFormat())).output="currency",l.format(this,e)}},{key:"formatTime",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.output="time",l.format(this,e)}},{key:"binaryByteUnits",value:function(){return l.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return l.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return l.getByteUnit(this)}},{key:"difference",value:function(e){return u.difference(this,e)}},{key:"add",value:function(e){return u.add(this,e)}},{key:"subtract",value:function(e){return u.subtract(this,e)}},{key:"multiply",value:function(e){return u.multiply(this,e)}},{key:"divide",value:function(e){return u.divide(this,e)}},{key:"set",value:function(e){return u.set(this,f(e))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}]),h);function h(e){if(!(this instanceof h))throw new TypeError("Cannot call a class as a function");this._value=e}function f(e){var t=e;return p.isNumbro(e)?t=e._value:"string"==typeof e?t=p.unformat(e):isNaN(e)&&(t=NaN),t}function p(e){return new d(f(e))}p.version="2.1.2",p.isNumbro=function(e){return e instanceof d},p.language=i.currentLanguage,p.registerLanguage=i.registerLanguage,p.setLanguage=i.setLanguage,p.languages=i.languages,p.languageData=i.languageData,p.zeroFormat=i.setZeroFormat,p.defaultFormat=i.currentDefaults,p.setDefaults=i.setDefaults,p.defaultCurrencyFormat=i.currentCurrencyDefaultFormat,p.validate=o.validate,p.loadLanguagesInNode=s.loadLanguagesInNode,p.unformat=a.unformat,t.exports=p},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(e,t,n){"use strict";t.exports={parseFormat:function(e){var t,n,r,i,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof e?e:(r=t=o,function(e,t){if(-1===e.indexOf("$")){if(-1===e.indexOf("%"))return-1!==e.indexOf("bd")?(t.output="byte",t.base="general"):-1!==e.indexOf("b")?(t.output="byte",t.base="binary"):-1!==e.indexOf("d")?(t.output="byte",t.base="decimal"):-1===e.indexOf(":")?-1!==e.indexOf("o")&&(t.output="ordinal"):t.output="time";t.output="percent"}else t.output="currency"}(e=(n=(t=e=(n=(i=e).match(/^{([^}]*)}/))?(t.prefix=n[1],i.slice(n[0].length)):i).match(/{([^}]*)}$/))?(r.postfix=n[1],t.slice(0,-n[0].length)):t,o),i=o,(r=e.match(/[1-9]+[0-9]*/))&&(i.totalLength=+r[0]),n=o,(t=e.split(".")[0].match(/0+/))&&(n.characteristic=t[0].length),i=o,-1!==(r=e).indexOf(".")&&(r=r.split(".")[0],i.optionalCharacteristic=-1===r.indexOf("0")),n=o,-1!==e.indexOf("a")&&(n.average=!0),t=o,-1!==(i=e).indexOf("K")?t.forceAverage="thousand":-1!==i.indexOf("M")?t.forceAverage="million":-1!==i.indexOf("B")?t.forceAverage="billion":-1!==i.indexOf("T")&&(t.forceAverage="trillion"),r=o,(n=e.split(".")[1])&&(n=n.match(/0+/))&&(r.mantissa=n[0].length),i=o,(t=e).match(/\[\.]/)?i.optionalMantissa=!0:t.match(/\./)&&(i.optionalMantissa=!1),r=o,-1!==e.indexOf(",")&&(r.thousandSeparated=!0),n=o,-1!==e.indexOf(" ")&&(n.spaceSeparated=!0),t=o,(i=e).match(/^\+?\([^)]*\)$/)&&(t.negative="parenthesis"),i.match(/^\+?-/)&&(t.negative="sign"),r=o,e.match(/^\+/)&&(r.forceSign=!0),o)}}},{}],9:[function(d,e,t){"use strict";var b=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function E(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}e.exports={unformat:function(e,t){var n,r,i,o=d("./globalState"),s=o.currentDelimiters(),a=o.currentCurrency().symbol,l=o.currentOrdinal(),u=o.getZeroFormat(),o=o.currentAbbreviations(),c=void 0;if("string"==typeof e)c=function(e,t){if(e.indexOf(":")&&":"!==t.thousands){var n,t=e.split(":");if(3===t.length)return e=+t[0],n=+t[1],t=+t[2],!isNaN(e)&&!isNaN(n)&&!isNaN(t)}}(e,s)?(r=+(n=e.split(":"))[0],i=+n[1],+n[2]+60*i+3600*r):function(e,t,n,r,i,o,s){if(n=2<arguments.length&&void 0!==n?n:"",r=3<arguments.length?r:void 0,i=4<arguments.length?i:void 0,o=5<arguments.length?o:void 0,s=6<arguments.length?s:void 0,""!==e)return e===i?0:function e(t,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",i=3<arguments.length?arguments[3]:void 0,o=4<arguments.length?arguments[4]:void 0,s=5<arguments.length?arguments[5]:void 0,a=6<arguments.length?arguments[6]:void 0;if(!isNaN(+t))return+t;var l="",u=t.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(u!==t)return-1*e(u,n,r,i,o,s,a);for(var c=0;c<b.length;c++){var d=b[c];if((l=t.replace(d.key,""))!==t)return e(l,n,r,i,o,s,a)*d.factor}if((l=t.replace("%",""))!==t)return e(l,n,r,i,o,s,a)/100;u=parseFloat(t);if(!isNaN(u)){u=i(u);if(u&&"."!==u&&(l=t.replace(new RegExp("".concat(E(u),"$")),""))!==t)return e(l,n,r,i,o,s,a);var h={};Object.keys(s).forEach(function(e){h[s[e]]=e});for(var f=Object.keys(h).sort().reverse(),p=f.length,g=0;g<p;g++){var m=f[g],y=h[m];if((l=t.replace(m,""))!==t){var v=void 0;switch(y){case"thousand":v=Math.pow(10,3);break;case"million":v=Math.pow(10,6);break;case"billion":v=Math.pow(10,9);break;case"trillion":v=Math.pow(10,12)}return e(l,n,r,i,o,s,a)*v}}}}(function(e,t,n){e=e.replace(2<arguments.length&&void 0!==n?n:"","");return(e=e.replace(new RegExp("([0-9])".concat(E(t.thousands),"([0-9])"),"g"),"$1$2")).replace(t.decimal,".")}(e,t,n),t,n,r,i,o,s)}(e,s,a,l,u,o,t);else{if("number"!=typeof e)return;c=e}if(void 0!==c)return c}}},{"./globalState":4}],10:[function(e,t,n){"use strict";function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r=e("./unformatting"),i=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,d={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(e,t){return"byte"===t.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(e){return"byte"===e.output}},characteristic:{type:"number",restriction:function(e){return 0<=e},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(e){return 0<=e},message:"value must be positive"},{restriction:function(e,t){return!t.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(e){return 0<=e},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(e,t){return"percent"===t.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},o={languageTag:{type:"string",mandatory:!0,restriction:function(e){return e.match(i)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function s(e){return!!r.unformat(e)}function h(a,l,u,e){var e=3<arguments.length&&void 0!==e&&e,t=Object.keys(a).map(function(e){if(!l[e])return console.error("".concat(u," Invalid key: ").concat(e)),!1;var t=a[e],n=l[e];if("format"===(n="string"==typeof n?{type:n}:n).type){if(!h(t,d,"[Validate ".concat(e,"]"),!0))return!1}else if(c(t)!==n.type)return console.error("".concat(u," ").concat(e,' type mismatched: "').concat(n.type,'" expected, "').concat(c(t),'" provided')),!1;if(n.restrictions&&n.restrictions.length)for(var r=n.restrictions.length,i=0;i<r;i++){var o=n.restrictions[i],s=o.restriction,o=o.message;if(!s(t,a))return console.error("".concat(u," ").concat(e," invalid value: ").concat(o)),!1}return n.restriction&&!n.restriction(t,a)?(console.error("".concat(u," ").concat(e," invalid value: ").concat(n.message)),!1):n.validValues&&-1===n.validValues.indexOf(t)?(console.error("".concat(u," ").concat(e," invalid value: must be among ").concat(JSON.stringify(n.validValues),', "').concat(t,'" provided')),!1):!(n.children&&!h(t,n.children,"[Validate ".concat(e,"]")))});return e||t.push.apply(t,function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e=Object.keys(l).map(function(e){var t=l[e];if((t="string"==typeof t?{type:t}:t).mandatory){t=t.mandatory;if((t="function"==typeof t?t(a):t)&&void 0===a[e])return console.error("".concat(u,' Missing mandatory key "').concat(e,'"')),!1}return!0}))||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()),t.reduce(function(e,t){return e&&t},!0)}function a(e){return h(e,d,"[Validate format]")}t.exports={validate:function(e,t){e=s(e),t=a(t);return e&&t},validateFormat:a,validateInput:s,validateLanguage:function(e){return h(e,o,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7),window.numbro=n(653)},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(655);t.RENDERER_TYPE=n.RENDERER_TYPE,t.passwordRenderer=n.passwordRenderer},(e,t,n)=>{"use strict";t.__esModule=!0,t.passwordRenderer=r;var u=n(616),c=n(302),d=n(461);function r(e,t,n,r,i,o,s){u.textRenderer.apply(this,[e,t,n,r,i,o,s]);e=s.hashLength||t.innerHTML.length;const a=s.hashSymbol||"*";let l="";(0,d.rangeEach)(e-1,()=>{l+=a}),(0,c.fastInnerHTML)(t,l)}t.RENDERER_TYPE="password",r.RENDERER_TYPE="password"},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(657);t.RENDERER_TYPE=n.RENDERER_TYPE,t.timeRenderer=n.timeRenderer},(e,t,n)=>{"use strict";t.__esModule=!0,t.timeRenderer=r;var a=n(616);function r(e,t,n,r,i,o,s){a.textRenderer.apply(this,[e,t,n,r,i,o,s]),t.dir="ltr"}t.RENDERER_TYPE="time",r.RENDERER_TYPE="time"},(e,t,n)=>{"use strict";t.__esModule=!0,t.registerAllValidators=function(){(0,a.registerValidator)(r.autocompleteValidator),(0,a.registerValidator)(i.dateValidator),(0,a.registerValidator)(o.numericValidator),(0,a.registerValidator)(s.timeValidator)};var r=n(659),i=(t.autocompleteValidator=r.autocompleteValidator,t.AUTOCOMPLETE_VALIDATOR=r.VALIDATOR_TYPE,n(661)),o=(t.dateValidator=i.dateValidator,t.DATE_VALIDATOR=i.VALIDATOR_TYPE,n(664)),s=(t.numericValidator=o.numericValidator,t.NUMERIC_VALIDATOR=o.VALIDATOR_TYPE,n(666)),a=(t.timeValidator=s.timeValidator,t.TIME_VALIDATOR=s.VALIDATOR_TYPE,n(465));t.registerValidator=a.registerValidator,t.getRegisteredValidatorNames=a.getRegisteredValidatorNames,t.getRegisteredValidators=a.getRegisteredValidators,t.getValidator=a.getValidator,t.hasValidator=a.hasValidator},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(660);t.VALIDATOR_TYPE=n.VALIDATOR_TYPE,t.autocompleteValidator=n.autocompleteValidator},(e,t)=>{"use strict";t.__esModule=!0,t.autocompleteValidator=r;var n="autocomplete";function r(e,t){let n=e;null!==n&&void 0!==n||(n=""),(!this.allowEmpty||""!==n)&&this.strict&&this.source?"function"==typeof this.source?this.source(n,i(n,t)):i(n,t)(this.source):t(!0)}function i(e,t){const i=e;return function(n){let r=!1;for(let e=0,t=n.length;e<t;e++)if(i===n[e]){r=!0;break}t(r)}}t.VALIDATOR_TYPE=n,r.VALIDATOR_TYPE=n},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(662);t.VALIDATOR_TYPE=n.VALIDATOR_TYPE,t.correctFormat=n.correctFormat,t.dateValidator=n.dateValidator},(e,t,n)=>{"use strict";var r=n(196),a=(t.__esModule=!0,t.correctFormat=c,t.dateValidator=i,r(n(306))),l=n(453),u=n(628),o=n(663);function i(e,t){var n=(0,l.getEditorInstance)(u.EDITOR_TYPE,this.instance);let r=e,i=!0,o=(null!==r&&void 0!==r||(r=""),(0,a.default)(r,this.dateFormat||n.defaultDateFormat,!0).isValid()),s=(0,a.default)(new Date(r)).isValid()||o;this.allowEmpty&&""===r&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),t(i=s&&!o?!0===this.correctFormat&&(e=c(r,this.dateFormat),n=this.instance.toVisualRow(this.row),t=this.instance.toVisualColumn(this.col),this.instance.setDataAtCell(n,t,e,"dateValidator"),!0):i)}function c(e,t){var n=(0,a.default)((0,o.getNormalizedDate)(e)),r=(0,a.default)(e,t),e=-1<e.search(/[A-z]/g);let i;return(i=n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||e?n:r).format(t)}t.VALIDATOR_TYPE="date",i.VALIDATOR_TYPE="date"},(e,t)=>{"use strict";t.__esModule=!0,t.getNormalizedDate=function(e){var t=new Date(e);return isNaN(new Date(e+"T00:00").getDate())?t:new Date(t.getTime()+6e4*t.getTimezoneOffset())}},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(665);t.VALIDATOR_TYPE=n.VALIDATOR_TYPE,t.numericValidator=n.numericValidator},(e,t,n)=>{"use strict";t.__esModule=!0,t.numericValidator=i;var r=n(461);function i(e,t){let n=e;null!==n&&void 0!==n||(n=""),this.allowEmpty&&""===n?t(!0):""===n?t(!1):t((0,r.isNumeric)(e))}t.VALIDATOR_TYPE="numeric",i.VALIDATOR_TYPE="numeric"},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(667);t.VALIDATOR_TYPE=n.VALIDATOR_TYPE,t.timeValidator=n.timeValidator},(e,t,n)=>{"use strict";var r=n(196),l=(t.__esModule=!0,t.timeValidator=i,r(n(306)));const u=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function i(e,t){var n=this.timeFormat||"h:mm:ss a";let r=!0,i=e;null===i&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;var e=/^\d{1,2}$/.test(i),o=(e&&(i+=":00"),(0,l.default)(i,u,!0).isValid()?(0,l.default)(i):(0,l.default)(i,n));let s=o.isValid(),a=(0,l.default)(i,n,!0).isValid()&&!e;this.allowEmpty&&""===i&&(s=!0,a=!0),s||(r=!1),!s&&a&&(r=!0),t(r=s&&!a?!0===this.correctFormat&&(e=o.format(n),t=this.instance.toVisualRow(this.row),o=this.instance.toVisualColumn(this.col),this.instance.setDataAtCell(t,o,e,"timeValidator"),!0):r)}t.VALIDATOR_TYPE="time",i.VALIDATOR_TYPE="time"},(e,t,n)=>{"use strict";t.__esModule=!0,t.registerAllCellTypes=function(){(0,h.registerCellType)(r.AutocompleteCellType),(0,h.registerCellType)(i.CheckboxCellType),(0,h.registerCellType)(o.DateCellType),(0,h.registerCellType)(s.DropdownCellType),(0,h.registerCellType)(a.HandsontableCellType),(0,h.registerCellType)(l.NumericCellType),(0,h.registerCellType)(u.PasswordCellType),(0,h.registerCellType)(c.TextCellType),(0,h.registerCellType)(d.TimeCellType)};var r=n(669),i=(t.AutocompleteCellType=r.AutocompleteCellType,t.AUTOCOMPLETE_TYPE=r.CELL_TYPE,n(671)),o=(t.CheckboxCellType=i.CheckboxCellType,t.CHECKBOX_TYPE=i.CELL_TYPE,n(673)),s=(t.DateCellType=o.DateCellType,t.DATE_TYPE=o.CELL_TYPE,n(675)),a=(t.DropdownCellType=s.DropdownCellType,t.DROPDOWN_TYPE=s.CELL_TYPE,n(677)),l=(t.HandsontableCellType=a.HandsontableCellType,t.HANDSONTABLE_TYPE=a.CELL_TYPE,n(679)),u=(t.NumericCellType=l.NumericCellType,t.NUMERIC_TYPE=l.CELL_TYPE,n(681)),c=(t.PasswordCellType=u.PasswordCellType,t.PASSWORD_TYPE=u.CELL_TYPE,n(606)),d=(t.TextCellType=c.TextCellType,t.TEXT_TYPE=c.CELL_TYPE,n(683)),h=(t.TimeCellType=d.TimeCellType,t.TIME_TYPE=d.CELL_TYPE,n(591));t.registerCellType=h.registerCellType,t.getCellType=h.getCellType,t.getRegisteredCellTypeNames=h.getRegisteredCellTypeNames,t.getRegisteredCellTypes=h.getRegisteredCellTypes,t.hasCellType=h.hasCellType},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(670);t.AutocompleteCellType=n.AutocompleteCellType,t.CELL_TYPE=n.CELL_TYPE},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(622),i=n(643),n=n(659),o="autocomplete",o={CELL_TYPE:t.CELL_TYPE=o,editor:r.AutocompleteEditor,renderer:i.autocompleteRenderer,validator:n.autocompleteValidator};t.AutocompleteCellType=o},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(672);t.CELL_TYPE=n.CELL_TYPE,t.CheckboxCellType=n.CheckboxCellType},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(626),n=n(648),r={CELL_TYPE:t.CELL_TYPE="checkbox",editor:r.CheckboxEditor,renderer:n.checkboxRenderer};t.CheckboxCellType=r},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(674);t.CELL_TYPE=n.CELL_TYPE,t.DateCellType=n.DateCellType},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(628),i=n(643),n=n(661),r={CELL_TYPE:t.CELL_TYPE="date",editor:r.DateEditor,renderer:i.autocompleteRenderer,validator:n.dateValidator};t.DateCellType=r},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(676);t.CELL_TYPE=n.CELL_TYPE,t.DropdownCellType=n.DropdownCellType},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(632),i=n(643),n=n(659),r={CELL_TYPE:t.CELL_TYPE="dropdown",editor:r.DropdownEditor,renderer:i.autocompleteRenderer,validator:n.autocompleteValidator};t.DropdownCellType=r},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(678);t.CELL_TYPE=n.CELL_TYPE,t.HandsontableCellType=n.HandsontableCellType},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(624),n=n(643),i="handsontable",i={CELL_TYPE:t.CELL_TYPE=i,editor:r.HandsontableEditor,renderer:n.autocompleteRenderer};t.HandsontableCellType=i},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(680);t.CELL_TYPE=n.CELL_TYPE,t.NumericCellType=n.NumericCellType},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(634),i=n(651),n=n(664),r={CELL_TYPE:t.CELL_TYPE="numeric",editor:r.NumericEditor,renderer:i.numericRenderer,validator:n.numericValidator,dataType:"number"};t.NumericCellType=r},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(682);t.CELL_TYPE=n.CELL_TYPE,t.PasswordCellType=n.PasswordCellType},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(636),n=n(654),r={CELL_TYPE:t.CELL_TYPE="password",editor:r.PasswordEditor,renderer:n.passwordRenderer,copyable:!1};t.PasswordCellType=r},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(684);t.CELL_TYPE=n.CELL_TYPE,t.TimeCellType=n.TimeCellType},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(640),i=n(656),n=n(666),r={CELL_TYPE:t.CELL_TYPE="time",editor:r.TimeEditor,renderer:i.timeRenderer,validator:n.timeValidator};t.TimeCellType=r},(P,e,t)=>{"use strict";e.__esModule=!0,e.registerAllPlugins=function(){(0,L.registerPlugin)(n.AutoColumnSize),(0,L.registerPlugin)(r.Autofill),(0,L.registerPlugin)(i.AutoRowSize),(0,L.registerPlugin)(o.BindRowsWithHeaders),(0,L.registerPlugin)(s.CollapsibleColumns),(0,L.registerPlugin)(a.ColumnSorting),(0,L.registerPlugin)(l.ColumnSummary),(0,L.registerPlugin)(u.Comments),(0,L.registerPlugin)(c.ContextMenu),(0,L.registerPlugin)(d.CopyPaste),(0,L.registerPlugin)(h.CustomBorders),(0,L.registerPlugin)(f.DragToScroll),(0,L.registerPlugin)(p.DropdownMenu),(0,L.registerPlugin)(g.ExportFile),(0,L.registerPlugin)(m.Filters),(0,L.registerPlugin)(y.Formulas),(0,L.registerPlugin)(v.HiddenColumns),(0,L.registerPlugin)(b.HiddenRows),(0,L.registerPlugin)(E.ManualColumnFreeze),(0,L.registerPlugin)(C.ManualColumnMove),(0,L.registerPlugin)(w.ManualColumnResize),(0,L.registerPlugin)(S.ManualRowMove),(0,L.registerPlugin)(T.ManualRowResize),(0,L.registerPlugin)(R.MergeCells),(0,L.registerPlugin)(A.MultiColumnSorting),(0,L.registerPlugin)(_.MultipleSelectionHandles),(0,L.registerPlugin)(N.NestedHeaders),(0,L.registerPlugin)(x.NestedRows),(0,L.registerPlugin)(O.PersistentState),(0,L.registerPlugin)(I.Search),(0,L.registerPlugin)(M.TouchScroll),(0,L.registerPlugin)(k.TrimRows),(0,L.registerPlugin)(D.UndoRedo)};var n=t(686),r=(e.AutoColumnSize=n.AutoColumnSize,t(692)),i=(e.Autofill=r.Autofill,t(695)),F=(e.AutoRowSize=i.AutoRowSize,t(688)),o=(e.BasePlugin=F.BasePlugin,t(697)),s=(e.BindRowsWithHeaders=o.BindRowsWithHeaders,t(701)),a=(e.CollapsibleColumns=s.CollapsibleColumns,t(703)),l=(e.ColumnSorting=a.ColumnSorting,t(716)),u=(e.ColumnSummary=l.ColumnSummary,t(720)),c=(e.Comments=u.Comments,t(727)),d=(e.ContextMenu=c.ContextMenu,t(749)),h=(e.CopyPaste=d.CopyPaste,t(761)),f=(e.CustomBorders=h.CustomBorders,t(770)),p=(e.DragToScroll=f.DragToScroll,t(772)),g=(e.DropdownMenu=p.DropdownMenu,t(775)),m=(e.ExportFile=g.ExportFile,t(781)),y=(e.Filters=m.Filters,t(828)),v=(e.Formulas=y.Formulas,t(835)),b=(e.HiddenColumns=v.HiddenColumns,t(840)),E=(e.HiddenRows=b.HiddenRows,t(845)),C=(e.ManualColumnFreeze=E.ManualColumnFreeze,t(850)),w=(e.ManualColumnMove=C.ManualColumnMove,t(856)),S=(e.ManualColumnResize=w.ManualColumnResize,t(858)),T=(e.ManualRowMove=S.ManualRowMove,t(864)),R=(e.ManualRowResize=T.ManualRowResize,t(866)),A=(e.MergeCells=R.MergeCells,t(875)),_=(e.MultiColumnSorting=A.MultiColumnSorting,t(881)),N=(e.MultipleSelectionHandles=_.MultipleSelectionHandles,t(883)),x=(e.NestedHeaders=N.NestedHeaders,t(900)),O=(e.NestedRows=x.NestedRows,t(909)),I=(e.PersistentState=O.PersistentState,t(912)),M=(e.Search=I.Search,t(914)),k=(e.TouchScroll=M.TouchScroll,t(916)),D=(e.TrimRows=k.TrimRows,t(918)),L=(e.UndoRedo=D.UndoRedo,t(459));e.registerPlugin=L.registerPlugin,e.getPlugin=L.getPlugin,e.getPluginsNames=L.getPluginsNames},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(687);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.AutoColumnSize=n.AutoColumnSize},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),n(688)),o=n(444),s=n(490),a=r(n(690)),l=r(n(454)),u=n(447),c=n(461),d=r(n(691)),h=n(303),f=n(476),p=n(543),g=n(305);l.default.getSingleton().register("modifyAutoColumnSizeSeed");const m="autoColumnSize",y=(t.PLUGIN_KEY=m,t.PLUGIN_PRIORITY=10,new WeakMap);class v extends i.BasePlugin{static get PLUGIN_KEY(){return m}static get PLUGIN_PRIORITY(){return 10}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),y.set(this,{cachedColumnHeaders:[]}),this.ghostTable=new a.default(this.hot),this.samplesGenerator=new d.default((e,t)=>{var n=this.hot.getCellMeta(e,t);let r="",i=(n.spanned||(r=this.hot.getDataAtCell(e,t)),"");return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(i=this.hot.runHooks("modifyAutoColumnSizeSeed",i,n,r)),{value:r,bundleSeed:i}}),this.firstCalculation=!0,this.inProgress=!1,this.measuredColumns=0,this.columnWidthsMap=new p.PhysicalIndexToValueMap,this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap),this.addHook("beforeColumnResize",(e,t,n)=>this.onBeforeColumnResize(e,t,n))}isEnabled(){return!1!==this.hot.getSettings()[m]&&!this.hot.getSettings().colWidths}enablePlugin(){var e,t=this;this.enabled||((e=this.hot.getSettings()[m])&&null!==e.useHeaders&&void 0!==e.useHeaders&&this.ghostTable.setSetting("useHeaders",e.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return t.onAfterLoadData(...arguments)}),this.addHook("beforeChangeRender",e=>this.onBeforeChange(e)),this.addHook("afterFormulasValuesUpdate",e=>this.onAfterFormulasValuesUpdate(e)),this.addHook("beforeViewRender",e=>this.onBeforeViewRender(e)),this.addHook("modifyColWidth",(e,t)=>this.getColumnWidth(t,e)),this.addHook("afterInit",()=>this.onAfterInit()),super.enablePlugin())}updatePlugin(){var e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,n)=>this.onBeforeColumnResize(e,t,n))}calculateVisibleColumnsWidth(){var e,t,n;this.hot.countRows()&&(e=this.hot.renderCall,t=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn(),-1!==t)&&-1!==n&&this.calculateColumnsWidth({from:t,to:n},void 0,e)}calculateColumnsWidth(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1};let n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];e="number"==typeof e?{from:e,to:e}:e;const r="number"==typeof t?{from:t,to:t}:t;(0,c.rangeEach)(e.from,e.to,e=>{let t=this.hot.toPhysicalColumn(e);null===t&&(t=e),(n||null===this.columnWidthsMap.getValueAtIndex(t)&&!this.hot._getColWidthFromSettings(t))&&(e=this.samplesGenerator.generateColumnSamples(e,r),(0,o.arrayEach)(e,e=>{var[e,t]=e;return this.ghostTable.addColumn(e,t)}))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((e,t)=>{e=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(e,t)})},!0),this.measuredColumns=e.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=0;const n=this.hot.countCols()-1;let r=null;this.inProgress=!0;const i=()=>{this.hot?(this.calculateColumnsWidth({from:t,to:Math.min(t+v.CALCULATION_STEP,n)},e),(t=t+v.CALCULATION_STEP+1)<n?r=(0,s.requestAnimationFrame)(i):((0,s.cancelAnimationFrame)(r),this.inProgress=!1,this.hot.view.adjustElementsSize())):((0,s.cancelAnimationFrame)(r),this.inProgress=!1)};var o=this.getSyncCalculationLimit();this.firstCalculation&&0<=o&&(this.calculateColumnsWidth({from:0,to:o},e),this.firstCalculation=!1,t=o+1),t<n?i():this.inProgress=!1}setSamplingOptions(){var e=this.hot.getSettings()[m],t=e&&(0,u.hasOwnProperty)(e,"samplingRatio")?e.samplingRatio:void 0,e=e&&(0,u.hasOwnProperty)(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),e&&this.samplesGenerator.setAllowDuplicates(e)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){var e=this.hot.getSettings()[m];let t=v.SYNC_CALCULATION_LIMIT;var n=this.hot.countCols()-1;return(0,u.isObject)(e)&&(t=e.syncLimit,(0,h.isPercentValue)(t)?t=(0,c.valueAccordingPercent)(n,t):t>>=0),Math.min(t,n)}getColumnWidth(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0,n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];let r=t;return r=void 0===r&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n)&&"number"==typeof r?Math.max(r,f.ViewportColumnsCalculator.DEFAULT_WIDTH):r}getFirstVisibleColumn(){var e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){var t=e.wtTable.getFirstVisibleColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){t=e.wtTable.getFirstRenderedColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}return-1}getLastVisibleColumn(){var e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){var t=e.wtTable.getLastVisibleColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){t=e.wtTable.getLastRenderedColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}return-1}findColumnsWhereHeaderWasChanged(){var e=this.hot.getColHeader();const i=y.get(this)["cachedColumnHeaders"];return(0,o.arrayReduce)(e,(e,t,n)=>{var r=i.length;return(r-1<n||i[n]!==t)&&e.push(n),r-1<n?i.push(t):i[n]=t,e},[])}clearCache(){let e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];e.length?this.hot.batchExecution(()=>{(0,o.arrayEach)(e,e=>{this.columnWidthsMap.setValueAtIndex(e,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!(0,o.arrayFilter)(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>null===e).length}onBeforeViewRender(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}onAfterLoadData(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}onBeforeChange(e){e=(0,o.arrayMap)(e,e=>{var[,e]=e;return this.hot.toPhysicalColumn(this.hot.propToCol(e))});this.clearCache(Array.from(new Set(e)))}onBeforeColumnResize(e,t,n){let r=e;return n&&(this.calculateColumnsWidth(t,void 0,!0),r=this.getColumnWidth(t,void 0,!1)),r}onAfterInit(){y.get(this).cachedColumnHeaders=this.hot.getColHeader()}onAfterFormulasValuesUpdate(e){e=(0,o.arrayFilter)(e,e=>{return(0,g.isDefined)(null==(e=e.address)?void 0:e.col)}),e=(0,o.arrayMap)(e,e=>e.address.col);this.clearCache(Array.from(new Set(e)))}destroy(){this.ghostTable.clean(),super.destroy()}}t.AutoColumnSize=v},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(689);t.PLUGIN_KEY=n.PLUGIN_KEY,t.BasePlugin=n.BasePlugin},(e,t,n)=>{"use strict";t.__esModule=!0,n(273),n(203);var r=n(447),i=n(444),o=n(459),s=n(591),a=n(453),l=n(464),n=n(465);function u(e,t){var n=e;if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object");t.add(e)}const c=new Map([["plugin",o.hasPlugin],["cell-type",s.hasCellType],["editor",a.hasEditor],["renderer",l.hasRenderer],["validator",n.hasValidator]]),d=(t.PLUGIN_KEY="base",new WeakMap),h=[];let f=null;var p=new WeakSet;function g(t){if(t){var n=this.constructor.SETTING_KEYS;if("boolean"==typeof n)return n;for(let e=0;e<n.length;e++)if(void 0!==t[n[e]])return!0}return!1}t.BasePlugin=class{static get PLUGIN_KEY(){return"base"}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){u(this,p),(0,r.defineGetter)(this,"hot",e,{writable:!1}),d.set(this,{hooks:{}}),f=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",e=>this.onUpdateSettings(e)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);var e=this.constructor.PLUGIN_DEPS,e=Array.isArray(e)?e:[];if(0<e.length){const n=[];e.forEach(e=>{var[e,t]=e.split(":");if(!c.has(e))throw new Error(`Unknown plugin dependency type "${e}" was found.`);c.get(e)(t)||n.push(` - ${t} (${e})`)}),0<n.length&&(e=[`The ${this.pluginName} plugin requires the following modules:
`,n.join("\n")+`
`].join(""),h.push(e))}if(0<=(f=f||(0,o.getPluginsNames)()).indexOf("UndoRedo")&&f.splice(f.indexOf("UndoRedo"),1),0<=f.indexOf(this.pluginName)&&f.splice(f.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),0===f.length){if(0<h.length)throw e=[h.join("\n")+`
`,"You have to import and register them manually."].join(""),new Error(e);this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}addHook(e,t){d.get(this).hooks[e]=d.get(this).hooks[e]||[];var n=d.get(this).hooks[e];this.hot.addHook(e,t),n.push(t),d.get(this).hooks[e]=n}removeHooks(t){(0,i.arrayEach)(d.get(this).hooks[t]||[],e=>{this.hot.removeHook(t,e)})}clearHooks(){var e=d.get(this).hooks;(0,r.objectEach)(e,(e,t)=>this.removeHooks(t)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){(0,i.arrayEach)(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){var t=function(e,t,n){if(t.has(e))return n;throw new TypeError("attempted to get private field on non-instance")}(this,p,g).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled)&&this.isEnabled()&&t&&this.updatePlugin(e)}updatePlugin(){}destroy(){this.eventManager&&this.eventManager.destroy(),this.clearHooks(),(0,r.objectEach)(this,(e,t)=>{"hot"!==t&&(this[t]=null)}),delete this.t,delete this.hot}}},(e,t,n)=>{"use strict";t.__esModule=!0,n(273),n(203);var l=n(302),u=n(444);t.default=class{constructor(e){this.hot=e,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={row:e};this.rows.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){var t=this.hot.getColHeader(0);null!=t&&(this.rows.push(t={row:-1}),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),t.table=this.table.table)}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={col:e};this.columns.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(e)&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(t){this.injected||this.injectTable(),(0,u.arrayEach)(this.rows,e=>{t(e.row,(0,l.outerHeight)(e.table)-1)})}getWidths(n){this.injected||this.injectTable(),(0,u.arrayEach)(this.columns,e=>{var t=e.table.getBoundingClientRect()["width"];n(e.col,Math.ceil(t))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(){const t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1)),this.samples.forEach(e=>{(0,u.arrayEach)(e.strings,e=>{t.appendChild(this.createColElement(e.col))})}),t}createRow(o){const s=this.hot["rootDocument"],a=s.createDocumentFragment();var e=s.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(o,e),a.appendChild(e)),this.samples.forEach(e=>{(0,u.arrayEach)(e.strings,e=>{var t=e.col,n=this.hot.getCellMeta(o,t),r=(n.col=t,n.row=o,this.hot.getCellRenderer(n)),i=s.createElement("td");i.setAttribute("ghost-table",1),r(this.hot,i,o,t,this.hot.colToProp(t),e.value,n),a.appendChild(i)})}),a}appendColumnHeadersRow(){const n=this.hot["rootDocument"],r=n.createDocumentFragment(),i=[];var e;this.hot.hasRowHeaders()&&(e=n.createElement("th"),i.push([-1,e]),r.appendChild(e)),this.samples.forEach(e=>{(0,u.arrayEach)(e.strings,e=>{var e=e.col,t=n.createElement("th");i.push([e,t]),r.appendChild(t)})}),this.table.tHead.appendChild(r),(0,u.arrayEach)(i,e=>{var[e,t]=e;this.hot.view.appendColHeader(e,t)})}createCol(s){const a=this.hot["rootDocument"],l=a.createDocumentFragment();return this.samples.forEach(e=>{(0,u.arrayEach)(e.strings,e=>{var t=e.row,n=this.hot.getCellMeta(t,s),r=(n.col=s,n.row=t,this.hot.getCellRenderer(n)),i=a.createElement("td"),o=a.createElement("tr");i.setAttribute("ghost-table",1),r(this.hot,i,t,s,this.hot.colToProp(s),e.value,n),o.appendChild(i),l.appendChild(o)})}),l}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e){var t=this.hot.rootDocument.createElement("col");return t.style.width=this.hot.view._wt.wtTable.getStretchedColumnWidth(e)+"px",t}createTable(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=this.hot["rootDocument"],n=t.createDocumentFragment(),r=t.createElement("table"),i=t.createElement("thead"),o=t.createElement("tbody"),s=t.createElement("colgroup"),a=t.createElement("tr"),t=t.createElement("th");return this.isVertical()&&r.appendChild(s),this.isHorizontal()&&(a.appendChild(t),i.appendChild(a),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(i),this.isVertical()&&o.appendChild(a),r.appendChild(o),(0,l.addClass)(r,e),n.appendChild(r),{fragment:n,table:r,tHead:i,tBody:o,colGroup:s,tr:a,th:t}}createContainer(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=this.hot["rootDocument"],n=t.createDocumentFragment(),t=t.createElement("div"),e="htGhostTable htAutoSize "+e.trim();return(0,l.addClass)(t,e),n.appendChild(t),{fragment:n,container:t}}isVertical(){return!(!this.rows.length||this.columns.length)}isHorizontal(){return!(!this.columns.length||this.rows.length)}}},(e,t,n)=>{"use strict";t.__esModule=!0,n(273),n(203);var c=n(447),d=n(461),h=n(305);t.default=class r{static get SAMPLE_COUNT(){return 3}constructor(e){this.samples=null,this.dataFactory=e,this.customSampleCount=null,this.allowDuplicates=!1}getSampleCount(){return this.customSampleCount||r.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(n,r,e){const i=new Map;var{from:e,to:t}="number"==typeof e?{from:e,to:e}:e;return(0,d.rangeEach)(e,t,e=>{var t=this.generateSample(n,r,e);i.set(e,t)}),i}generateSample(o,e,s){if("row"!==o&&"col"!==o)throw new Error("Unsupported sample type");const a=new Map,l="row"===o?"col":"row",u=[];return(0,d.rangeEach)(e.from,e.to,e=>{var{value:t,bundleSeed:n}="row"===o?this.dataFactory(s,e):this.dataFactory(e,s),r="string"==typeof n&&0<n.length;let i;i=r?n:(0,c.isObject)(t)?""+Object.keys(t).length:Array.isArray(t)?""+t.length:""+(0,h.stringify)(t).length,a.has(i)||a.set(i,{needed:this.getSampleCount(),strings:[]}),!(n=a.get(i)).needed||-1<u.indexOf(t)&&!this.allowDuplicates&&!r||(n.strings.push({value:t,[l]:e}),u.push(t),--n.needed)}),a}}},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(693);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.Autofill=n.Autofill},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),n(688)),o=r(n(454)),s=n(302),a=n(444),l=r(n(457)),p=n(694);o.default.getSingleton().register("modifyAutofillRange"),o.default.getSingleton().register("beforeAutofill"),o.default.getSingleton().register("afterAutofill");const u="autofill",c=(t.PLUGIN_KEY=u,t.PLUGIN_PRIORITY=20,["fillHandle"]);class d extends i.BasePlugin{static get PLUGIN_KEY(){return u}static get PLUGIN_PRIORITY(){return 20}static get SETTING_KEYS(){return[u,...c]}constructor(e){super(e),this.eventManager=new l.default(this),this.addingStarted=!1,this.mouseDownOnCellCorner=!1,this.mouseDragOutside=!1,this.handleDraggedCells=0,this.directions=[],this.autoInsertRow=!1}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>this.onAfterCellCornerMouseDown(e)),this.addHook("afterOnCellCornerDblClick",e=>this.onCellCornerDblClick(e)),this.addHook("beforeOnCellMouseOver",(e,t)=>this.onBeforeCellMouseOver(t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){var e=this.hot.getSelectedRangeLast(),{row:t,col:n}=e.getTopStartCorner(),{row:e,col:r}=e.getBottomEndCorner(),t=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:n,endRow:e,endCol:r}]);const i=[],o=[],s=[];return(0,a.arrayEach)(t,t=>{for(let e=t.startRow;e<=t.endRow;e+=1)-1===i.indexOf(e)&&i.push(e);for(let e=t.startCol;e<=t.endCol;e+=1)-1===o.indexOf(e)&&o.push(e)}),(0,a.arrayEach)(i,t=>{const n=[];(0,a.arrayEach)(o,e=>{n.push(this.hot.getCopyableData(t,e))}),s.push(n)}),s}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;var[e,t,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner(),l=(this.resetSelectionOfDraggedArea(),[s.row,s.col,a.row,a.col]),e=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,t),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:s,startOfDragCoords:t,endOfDragCoords:r}=(0,p.getDragDirectionAndRange)(l,e,(e,t)=>this.hot._createCellCoords(e,t));if(t&&-1<t.row&&-1<t.col){a=this.getSelectionData(),i=o.clone(),l=this.hot._createCellRange(t,t,r),o=this.hot.runHooks("beforeAutofill",a,i,l,s);if(!1===o)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let n=o;var u=o;if(-1<["up","left"].indexOf(s)&&(1!==u.length||0!==u[0].length))if(n=[],"up"===s){var c=r.row-t.row+1,d=c%u.length;for(let e=0;e<c;e++)n.push(u[(e+(u.length-d))%u.length])}else{var h=r.col-t.col+1,f=h%u[0].length;for(let t=0;t<u.length;t++){n.push([]);for(let e=0;e<h;e++)n[t].push(u[t][(e+(u[t].length-f))%u[t].length])}}this.hot.populateFromArray(t.row,t.col,n,r.row,r.col,this.pluginName+".fill",null),this.setSelection(e),this.hot.runHooks("afterAutofill",n,i,l,s),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){var t=this.hot.getSelectedRangeLast(),n=t.getBottomEndCorner();let r=e;if(this.directions.includes(p.DIRECTIONS.vertical)&&this.directions.includes(p.DIRECTIONS.horizontal)){t=t.getTopStartCorner();(n.col<=e.col||t.col>=e.col)&&(r=this.hot._createCellCoords(n.row,e.col)),(n.row<e.row||t.row>e.row)&&(r=this.hot._createCellCoords(e.row,n.col))}else if(this.directions.includes(p.DIRECTIONS.vertical))r=this.hot._createCellCoords(e.row,n.col);else{if(!this.directions.includes(p.DIRECTIONS.horizontal))return;r=this.hot._createCellCoords(n.row,e.col)}return this.reduceSelectionAreaIfNeeded(r)}showBorder(e){e=this.getCoordsOfDragAndDropBorders(e);e&&this.redrawBorders(e)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter("insert_row_below",void 0,1,this.pluginName+".fill"),this.addingStarted=!1},200)}addNewRowIfNeeded(){var e,t,n;!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow&&(e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows(),e[2]<n-1)&&t[2]===n-1&&(this.addingStarted=!0,this.addRow())}getIndexOfLastAdjacentFilledInRow(n){var r=this.hot.getData(),e=this.hot.countRows();let i;for(let t=n[2]+1;t<e;t++){for(let e=n[1];e<=n[3];e++)if(r[t][e])return-1;var o=r[t][n[1]-1],s=r[t][n[3]+1];(o||s)&&(i=t)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...(0,a.arrayMap)(e,e=>Math.max(e,0)),!1,!1)}selectAdjacent(){var e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return-1!==t&&void 0!==t&&(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){var t=this.hot.rootDocument["documentElement"],n=(0,s.offset)(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+(0,s.outerHeight)(this.hot.table),t=(0,s.offset)(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+(0,s.outerWidth)(this.hot.table);return e.clientY>n&&e.clientX<=t}registerEvents(){var e=this.hot.rootDocument["documentElement"];this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(e,"mousemove",e=>this.onMouseMove(e))}onCellCornerDblClick(){this.selectAdjacent()&&this.fillIn()}onAfterCellCornerMouseDown(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}onBeforeCellMouseOver(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}onMouseUp(){this.handleDraggedCells&&(1<this.handleDraggedCells&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}onMouseMove(e){e=this.getIfMouseWasDraggedOutside(e);!1===this.addingStarted&&0<this.handleDraggedCells&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){var e=(0,p.getMappedFillHandleSetting)(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}t.Autofill=d},(e,t,n)=>{"use strict";t.__esModule=!0,t.getDragDirectionAndRange=function(e,t,n){let r,i,o;t[0]===e[0]&&t[1]<e[1]?(o="left",r=n(t[0],t[1]),i=n(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(o="right",r=n(t[0],e[3]+1),i=n(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(o="up",r=n(t[0],t[1]),i=n(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(o="down",r=n(e[2]+1,t[1]),i=n(t[2],t[3]));r&&r.normalize();i&&i.normalize();return{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}},t.getMappedFillHandleSetting=function(e){var t={};!0===e?(t.directions=Object.keys(o),t.autoInsertRow=!0):(0,r.isObject)(e)?(!(0,i.isDefined)(e.autoInsertRow)||e.direction===o.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow,(0,i.isDefined)(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(o)):"string"==typeof e?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1);return t};var r=n(447),i=n(305);const o={horizontal:"horizontal",vertical:"vertical"};t.DIRECTIONS=o},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(696);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.AutoRowSize=n.AutoRowSize},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(688)),o=n(444),s=n(490),a=n(302),l=r(n(690)),u=n(447),c=n(461),d=r(n(691)),h=n(303),f=n(543);const p="autoRowSize";t.PLUGIN_KEY=p,t.PLUGIN_PRIORITY=40;class g extends i.BasePlugin{static get PLUGIN_KEY(){return p}static get PLUGIN_PRIORITY(){return 40}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),this.rowHeightsMap=void 0,this.headerHeight=null,this.ghostTable=new l.default(this.hot),this.samplesGenerator=new d.default((e,t)=>{let n;return 0<=e?n=this.hot.getDataAtCell(e,t):-1===e&&(n=this.hot.getColHeader(t)),{value:n}}),this.firstCalculation=!0,this.inProgress=!1,this.measuredRows=0,this.rowHeightsMap=new f.PhysicalIndexToValueMap,this.hot.rowIndexMapper.registerMap("autoRowSize",this.rowHeightsMap),this.addHook("beforeRowResize",(e,t,n)=>this.onBeforeRowResize(e,t,n))}isEnabled(){var e=this.hot.getSettings()[p];return!0===e||(0,u.isObject)(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeChangeRender",e=>this.onBeforeChange(e)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",e=>this.onBeforeViewRender(e)),this.addHook("modifyRowHeight",(e,t)=>this.getRowHeight(t,e)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,t,n)=>this.onBeforeRowResize(e,t,n))}calculateRowsHeight(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1};let n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];e="number"==typeof e?{from:e,to:e}:e;const r="number"==typeof t?{from:t,to:t}:t;null!==this.hot.getColHeader(0)&&(t=this.samplesGenerator.generateRowSamples(-1,r),this.ghostTable.addColumnHeadersRow(t.get(-1))),(0,c.rangeEach)(e.from,e.to,e=>{!n&&null!==this.rowHeightsMap.getValueAtIndex(e)||(e=this.samplesGenerator.generateRowSamples(e,r),(0,o.arrayEach)(e,e=>{var[e,t]=e;return this.ghostTable.addRow(e,t)}))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((e,t)=>{e<0?this.headerHeight=t:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(e),t)})},!0),this.measuredRows=e.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=0;const n=this.hot.countRows()-1;let r=null;this.inProgress=!0;const i=()=>{this.hot?(this.calculateRowsHeight({from:t,to:Math.min(t+g.CALCULATION_STEP,n)},e),(t=t+g.CALCULATION_STEP+1)<n?r=(0,s.requestAnimationFrame)(i):((0,s.cancelAnimationFrame)(r),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())):((0,s.cancelAnimationFrame)(r),this.inProgress=!1)};var o=this.getSyncCalculationLimit();this.firstCalculation&&0<=o&&(this.calculateRowsHeight({from:0,to:o},e),this.firstCalculation=!1,t=o+1),t<n?i():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){var e=this.hot.getSettings()[p],t=e&&(0,u.hasOwnProperty)(e,"samplingRatio")?e.samplingRatio:void 0,e=e&&(0,u.hasOwnProperty)(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),e&&this.samplesGenerator.setAllowDuplicates(e)}recalculateAllRowsHeight(){(0,a.isVisible)(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){var e=this.hot.getSettings()[p];let t=g.SYNC_CALCULATION_LIMIT;var n=this.hot.countRows()-1;return(0,u.isObject)(e)&&(t=e.syncLimit,(0,h.isPercentValue)(t)?t=(0,c.valueAccordingPercent)(n,t):t>>=0),Math.min(t,n)}getRowHeight(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0,e=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let n=null!==e&&(t||0)<e?e:t;return n}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){var e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:t,to:n}="number"==typeof e?{from:e,to:e}:e;this.hot.batchExecution(()=>{(0,c.rangeEach)(Math.min(t,n),Math.max(t,n),e=>{this.rowHeightsMap.setValueAtIndex(e,null)})},!0)}isNeedRecalculate(){return!!(0,o.arrayFilter)(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>null===e).length}onBeforeViewRender(){var e=this.hot.renderCall,t=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();-1!==n&&-1!==r&&(this.calculateRowsHeight({from:n,to:r},void 0,e),t&&(n=this.hot.countRows()-1,this.calculateRowsHeight({from:n-t,to:n})),this.isNeedRecalculate())&&!this.inProgress&&this.calculateAllRowsHeight()}onBeforeRowMove(e,t){this.clearCacheByRange({from:e,to:t}),this.calculateAllRowsHeight()}onBeforeRowResize(e,t,n){let r=e;return n&&(this.calculateRowsHeight(t,void 0,!0),r=this.getRowHeight(t)),r}onAfterLoadData(){this.hot.view?this.recalculateAllRowsHeight():setTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()},0)}onBeforeChange(e){let t=null;1===e.length?t=e[0][0]:1<e.length&&(t={from:e[0][0],to:e[e.length-1][0]}),null!==t&&this.clearCacheByRange(t)}destroy(){this.ghostTable.clean(),super.destroy()}}t.AutoRowSize=g},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(698);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.BindRowsWithHeaders=n.BindRowsWithHeaders},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(688)),o=r(n(699)),r=r(n(700));const s="bindRowsWithHeaders",a=(t.PLUGIN_KEY=s,t.PLUGIN_PRIORITY=210,new Map([["loose",o.default],["strict",r.default]]));class l extends i.BasePlugin{static get PLUGIN_KEY(){return s}static get PLUGIN_PRIORITY(){return 210}constructor(e){super(e),this.headerIndexes=null}isEnabled(){return!!this.hot.getSettings()[s]}enablePlugin(){if(!this.enabled){let e=this.hot.getSettings()[s];"string"!=typeof e&&(e="loose");var t=a.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",e=>this.onModifyRowHeader(e)),super.enablePlugin()}}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}onModifyRowHeader(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}destroy(){super.destroy()}}t.BindRowsWithHeaders=l},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(543);const{getListWithInsertedItems:i,getListWithRemovedItems:o}=(0,r.alterUtilsFactory)("physicallyIndexed");class s extends r.IndexMap{constructor(){super(e=>e)}insert(e,t){var n=(0,r.getIncreasedIndexes)(this.indexedValues,t);this.indexedValues=i(n,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){var t=o(this.indexedValues,e);this.indexedValues=(0,r.getDecreasedIndexes)(t,e),super.remove(e)}}t.default=s},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(543);const{getListWithInsertedItems:r,getListWithRemovedItems:i}=(0,n.alterUtilsFactory)("physicallyIndexed");class o extends n.IndexMap{constructor(){super(e=>e)}insert(e,t){this.indexedValues=r(this.indexedValues,e,t,(e,t)=>this.getNextValue(t)),super.insert(e,t)}remove(e){this.indexedValues=i(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}t.default=o},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(702);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.CollapsibleColumns=n.CollapsibleColumns},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(273),n(203),r(n(467))),l=r(n(471)),o=r(n(474)),s=n(688),u=n(444),c=n(461),a=n(455),d=n(302),h=r(n(457)),f=n(452);function p(e,t,n){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,n)}const g="collapsibleColumns",m=(t.PLUGIN_KEY=g,t.PLUGIN_PRIORITY=290,["nestedHeaders"]),y="collapsibleIndicator",v=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var b=new WeakMap;class E extends s.BasePlugin{constructor(){super(...arguments),(0,i.default)(this,"nestedHeadersPlugin",null),(0,i.default)(this,"eventManager",new h.default(this)),(0,i.default)(this,"headerStateManager",null),p(this,b,{writable:!0,value:null})}static get PLUGIN_KEY(){return g}static get PLUGIN_PRIORITY(){return 290}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[g,...m]}isEnabled(){return!!this.hot.getSettings()[g]}enablePlugin(){var e,t=this;this.enabled||(e=this.hot.getSettings()["nestedHeaders"],e||(0,a.warn)("You need to configure the Nested Headers plugin in order to use collapsible headers."),(0,o.default)(this,b,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>this.onInit()),this.addHook("afterLoadData",function(){return t.onAfterLoadData(...arguments)}),this.addHook("afterGetColHeader",function(){return t.onAfterGetColHeader(...arguments)}),this.addHook("beforeOnCellMouseDown",(e,t,n)=>this.onBeforeOnCellMouseDown(e,t,n)),super.enablePlugin(),this.updatePlugin())}updatePlugin(){var e;this.hot.view&&(this.nestedHeadersPlugin.detectedOverlappedHeaders||(e=this.hot.getSettings()["collapsibleColumns"],"boolean"==typeof e?this.headerStateManager.mapState(e=>({collapsible:1<e.origColspan})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))),super.updatePlugin())}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),(0,o.default)(this,b,null),this.nestedHeadersPlugin=null,this.clearButtons(),super.disablePlugin()}clearButtons(){if(this.hot.view){var e=this.hot.view._wt.getSetting("columnHeaders").length;const t=this.hot.view._wt.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,a=function(e){e&&e.parentNode.removeChild(e)};(0,c.rangeEach)(0,e-1,e=>{const n=t.childNodes[e],r=o.childNodes[e],i=s?s.childNodes[e]:null;(0,c.rangeEach)(0,n.childNodes.length-1,e=>{let t=n.childNodes[e].querySelector("."+y);a(t),r&&r.childNodes[e]&&(t=r.childNodes[e].querySelector("."+y),a(t)),s&&i&&i.childNodes[e]&&(t=i.childNodes[e].querySelector("."+y),a(t))})},!0)}}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(o){var e=this.headerStateManager.mapNodes(e=>{var{collapsible:e,origColspan:t,headerLevel:n,columnIndex:r,isCollapsed:i}=e;if(!0===e&&1<t&&(i&&"expand"===o||!i&&"collapse"===o))return{row:this.headerStateManager.levelToRowCoords(n),col:r}});this.toggleCollapsibleSection(e,o)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(t,r){if(!v.has(r))throw new Error(`Unsupported action is passed (${r}).`);if(Array.isArray(t)){t=(0,u.arrayFilter)(t,e=>{e=e.row;return e<0});let n=0<t.length;(0,u.arrayEach)(t,e=>{var{row:e,col:t}=e,{collapsible:t,isCollapsed:e}=null!=(e=this.headerStateManager.getHeaderSettings(e,t))?e:{};if(!t||e&&"collapse"===r||!e&&"expand"===r)return n=!1});const o=[],s=[];n&&(0,u.arrayEach)(t,e=>{var{row:e,col:t}=e,{colspanCompensation:e,affectedColumns:t,rollbackModification:n}=this.headerStateManager.triggerNodeModification(r,e,t);0<e&&(s.push(...t),o.push(n))});var i,t=this.getCollapsedColumns();let e=[];"collapse"===r?e=(0,u.arrayUnique)([...t,...s]):"expand"===r&&(e=(0,u.arrayFilter)(t,e=>!s.includes(e)));const a=v.get(r);!1===this.hot.runHooks(a.beforeHook,t,e,n)?(0,u.arrayEach)(o,e=>{e()}):(this.hot.batchExecution(()=>{(0,u.arrayEach)(s,e=>{(0,l.default)(this,b).setValueAtIndex(this.hot.toPhysicalColumn(e),a.hideColumn)})},!0),i=this.getCollapsedColumns().length!==t.length,this.hot.runHooks(a.afterHook,t,e,n,i),this.hot.render(),this.hot.view.adjustElementsSize(!0))}}getCollapsedColumns(){return(0,l.default)(this,b).getHiddenIndexes()}onAfterGetColHeader(e,t,n){var{collapsible:n,origColspan:r,isCollapsed:i}=null!=(n=this.headerStateManager.getHeaderSettings(n,e))?n:{},n=n&&1<r&&e>=this.hot.getSettings().fixedColumnsStart;let o=t.querySelector("."+y);n?(o||(o=this.hot.rootDocument.createElement("div"),(0,d.addClass)(o,y),t.querySelector("div:first-child").appendChild(o)),(0,d.removeClass)(o,["collapsed","expanded"]),i?((0,d.addClass)(o,"collapsed"),(0,d.fastInnerText)(o,"+")):((0,d.addClass)(o,"expanded"),(0,d.fastInnerText)(o,"-"))):null!=(r=o)&&r.remove()}onBeforeOnCellMouseDown(e,t){(0,d.hasClass)(e.target,y)&&((0,d.hasClass)(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):(0,d.hasClass)(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),(0,f.stopImmediatePropagation)(e))}onInit(){this.updatePlugin()}onAfterLoadData(e,t){t||this.updatePlugin()}destroy(){(0,o.default)(this,b,null),super.destroy()}}t.CollapsibleColumns=E},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(704);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.ColumnSorting=n.ColumnSorting},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),n(302)),o=n(305),s=n(447),a=n(445),l=n(444),u=n(688),c=n(543),r=r(n(454)),d=n(705),h=n(706),f=n(707),p=n(708),g=n(709);const m="columnSorting";t.PLUGIN_KEY=m,t.PLUGIN_PRIORITY=50;(0,g.registerRootComparator)(m,p.rootComparator),r.default.getSingleton().register("beforeColumnSort"),r.default.getSingleton().register("afterColumnSort");class y extends u.BasePlugin{static get PLUGIN_KEY(){return m}static get PLUGIN_PRIORITY(){return 50}constructor(e){super(e),this.columnStatesManager=null,this.columnMetaCache=null,this.pluginKey=m,this.indexesSequenceCache=null}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new d.ColumnStatesManager(this.hot,this.pluginKey+".sortingStates"),this.columnMetaCache=new c.PhysicalIndexToValueMap(e=>{let t=this.hot.toVisualColumn(e);return null===t&&(t=e),this.getMergedPluginSettings(t)}),this.hot.columnIndexMapper.registerMap(this.pluginKey+".columnMeta",this.columnMetaCache),this.addHook("afterGetColHeader",(e,t)=>this.onAfterGetColHeader(e,t)),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("afterOnCellMouseDown",(e,t)=>this.onAfterOnCellMouseDown(e,t)),this.addHook("afterInit",()=>this.loadOrSortBySettings()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.hot.view&&this.loadOrSortBySettings(),super.enablePlugin())}disablePlugin(){const e=(e,t)=>{var n=(0,h.getHeaderSpanElement)(t);!1!==(0,h.isFirstLevelColumnHeader)(e,t)&&null!==n&&this.updateHeaderClasses(n)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(this.pluginKey+".columnMeta"),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,super.disablePlugin()}sort(e){var t=this.getSortConfig(),e=this.getNormalizedSortConfigs(e),n=this.areValidSortConfigs(e);!1!==this.hot.runHooks("beforeColumnSort",t,e,n)&&(0===t.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new c.IndexesSequence),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),n&&(this.columnStatesManager.setSortStates(e),this.sortByPresetSortStates(e),this.saveAllSortSettings(e)),this.hot.runHooks("afterColumnSort",t,n?e:t,n),n)&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return(0,o.isDefined)(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){e=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(e)&&this.columnStatesManager.setSortStates(e)}getNormalizedSortConfigs(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return(0,h.areValidSortStates)(e)&&e.every(e=>{e=e.column;return e<=t&&0<=e})}saveAllSortSettings(e){var t=this.columnStatesManager.getAllColumnsProperties();t.initialConfig=(0,l.arrayMap)(e,e=>{let{column:t,...n}=e;return{column:this.hot.toPhysicalColumn(t),...n}}),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){var e={},e=(this.hot.runHooks("persistentStateLoad","columnSorting",e),e.value),t=e=>{let{column:t,...n}=e;return{column:this.hot.toVisualColumn(t),...n}};return(0,o.isDefined)(e)&&Array.isArray(e.initialConfig)&&(e.initialConfig=(0,l.arrayMap)(e.initialConfig,t)),e}getColumnNextConfig(e){var t=this.columnStatesManager.getSortOrderOfColumn(e);return(0,o.isDefined)(t)?(t=(0,h.getNextSortOrder)(t),(0,o.isDefined)(t)?{column:e,sortOrder:t}:void 0):(t=this.hot.countCols(),Number.isInteger(e)&&0<=e&&e<t?{column:e,sortOrder:(0,h.getNextSortOrder)()}:void 0)}getNextSortConfig(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"append",n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=-1!==n,i=this.getSortConfig(),e=this.getColumnNextConfig(e);if(r){if((0,o.isUndefined)(e))return[...i.slice(0,n),...i.slice(n+1)];if("append"===t)return[...i.slice(0,n),...i.slice(n+1),e];if("replace"===t)return[...i.slice(0,n),e,...i.slice(n+1)]}return(0,o.isDefined)(e)?i.concat(e):i}getPluginColumnConfig(e){if((0,s.isObject)(e)){e=e[this.pluginKey];if((0,s.isObject)(e))return e}return{}}getMergedPluginSettings(e){var t=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),r=Object.getPrototypeOf(r);return Array.isArray(r.columns)?Object.assign(n,t,this.getPluginColumnConfig(r.columns[e])):(0,a.isFunction)(r.columns)?Object.assign(n,t,this.getPluginColumnConfig(r.columns(e))):Object.assign(n,t)}getFirstCellSettings(e){var t=this.hot.getCellMeta(0,e),t=Object.create(t);return t[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),t}getNumberOfRowsToSort(e){var t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(0===e.length)this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());else{var t=[],n=this.hot.countRows(),r=t=>(0,l.arrayMap)(e,e=>this.hot.getDataAtCell(t,e.column));for(let e=0;e<this.getNumberOfRowsToSort(n);e+=1)t.push([this.hot.toPhysicalRow(e)].concat(r(e)));var i=(0,l.arrayMap)(t,e=>e[0]);(0,g.sort)(t,this.pluginKey,(0,l.arrayMap)(e,e=>e.sortOrder),(0,l.arrayMap)(e,e=>this.getFirstCellSettings(e.column)));for(let e=t.length;e<n;e+=1)t.push([e].concat(r(e)));const o=(0,l.arrayMap)(t,e=>e[0]),s=new Map((0,l.arrayMap)(i,(e,t)=>[e,o[t]]));i=(0,l.arrayMap)(this.hot.rowIndexMapper.getIndexesSequence(),e=>s.has(e)?s.get(e):e);this.hot.rowIndexMapper.setIndexesSequence(i)}}loadOrSortBySettings(){var e=this.getAllSavedSortSettings();(0,s.isObject)(e)?this.sortBySettings(e):(e=this.hot.getSettings()[this.pluginKey],this.sortBySettings(e))}sortBySettings(e){(0,s.isObject)(e)?(this.columnStatesManager.updateAllColumnsProperties(e),e=e.initialConfig,(Array.isArray(e)||(0,s.isObject)(e))&&this.sort(e)):this.hot.render()}onAfterGetColHeader(e,t){var n,r=(0,h.getHeaderSpanElement)(t);!1!==(0,h.isFirstLevelColumnHeader)(e,t)&&null!==r&&(n=(t=this.getFirstCellSettings(e)[this.pluginKey]).indicator,t=t.headerAction,this.updateHeaderClasses(r,this.columnStatesManager,e,n,t))}updateHeaderClasses(e){if((0,i.removeClass)(e,(0,f.getClassesToRemove)(e)),!1!==this.enabled){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];(0,i.addClass)(e,(0,f.getClassesToAdd)(...n))}}onUpdateSettings(e){super.onUpdateSettings(),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),(0,o.isDefined)(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}onAfterLoadData(e){!0===e&&this.hot.view&&this.loadOrSortBySettings()}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&"SPAN"===e.target.nodeName}onBeforeOnCellMouseDown(e,t,n,r){!1!==(0,h.wasHeaderClickedProperly)(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}onAfterOnCellMouseDown(e,t){!1!==(0,h.wasHeaderClickedProperly)(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col)),this.sort(this.getColumnNextConfig(t.col)))}destroy(){var e;null!=(e=this.columnStatesManager)&&e.destroy(),super.destroy()}}t.ColumnSorting=y},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(447),i=n(543),o=n(305);const s=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"];t.ColumnStatesManager=class{constructor(e,t){this.hot=e,this.sortingStates=new i.LinkedPhysicalIndexToValueMap,this.sortEmptyCells=!1,this.indicator=!0,this.headerAction=!0,this.compareFunctionFactory=void 0,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){(0,r.isObject)(e)&&(0,r.objectEach)(e,(e,t)=>{s.includes(t)&&(this[t]=e)})}getAllColumnsProperties(){var e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){return null==(e=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))?void 0:e.sortOrder}getIndexOfColumnInSortQueue(t){return t=this.hot.toPhysicalColumn(t),this.sortingStates.getEntries().findIndex(e=>{var[e]=e;return e===t})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(e){return(0,r.isObject)(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return null===this.sortingStates?[]:this.sortingStates.getEntries().map(e=>{var[e,t]=e;return{column:this.hot.toVisualColumn(e),...t}})}getColumnSortState(e){var t=this.getSortOrderOfColumn(e);if((0,o.isDefined)(t))return{column:e,sortOrder:t}}setSortStates(t){this.sortingStates.clear();for(let e=0;e<t.length;e+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(t[e].column),{sortOrder:t[e].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}},(e,t,n)=>{"use strict";t.__esModule=!0,t.areValidSortStates=function(e){if(e.some(e=>!1===function(e){if(!1===(0,r.isObject)(e))return!1;var{column:e,sortOrder:t}=e;return Number.isInteger(e)&&[o,s].includes(t)}(e)))return!1;e=e.map(e=>{e=e.column;return e});return new Set(e).size===e.length},t.getHeaderSpanElement=function(e){e=e.querySelector("."+a);return e},t.getNextSortOrder=function(e){if(e!==s)return e===o?s:o},t.isFirstLevelColumnHeader=function(e,t){if(e<0||!t.parentNode)return!1;e=t.parentNode.parentNode.childNodes,t=Array.from(e).indexOf(t.parentNode)-e.length;return-1==t},t.wasHeaderClickedProperly=function(e,t,n){return-1===e&&0<=t&&!1===(0,i.isRightClick)(n)};var r=n(447),i=n(452);const o="asc",s=(t.ASC_SORT_STATE=o,"desc"),a=(t.DESC_SORT_STATE=s,"colHeader");t.HEADER_SPAN_CLASS=a},(e,t,n)=>{"use strict";t.__esModule=!0,t.getClassesToAdd=function(e,t,n,r){var i=[a];r&&i.push(l);return!1===n?i.push(s):(r=e.getSortOrderOfColumn(t),(0,o.isDefined)(r)&&i.push(u.get(r))),i},t.getClassesToRemove=function(){return Array.from(u.values()).concat(l,s,a)},n(203);var o=n(305),t=n(706);const s="indicatorDisabled",a="columnSorting",l="sortAction",u=new Map([[t.ASC_SORT_STATE,"ascending"],[t.DESC_SORT_STATE,"descending"]])},(e,t,n)=>{"use strict";t.__esModule=!0,t.rootComparator=function(a,l){return function(e,t){const[,...n]=e,[,...r]=t;return t=a[e=0],i=l[e],o=n[e],e=r[e],((s=i.columnSorting).compareFunctionFactory||(0,u.getCompareFunctionFactory)(i.type))(t,i,s)(o,e);var i,o,s}};var u=n(709)},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(710),r=(t.registerRootComparator=r.registerRootComparator,t.getRootComparator=r.getRootComparator,t.getCompareFunctionFactory=r.getCompareFunctionFactory,n(715));t.FIRST_AFTER_SECOND=r.FIRST_AFTER_SECOND,t.FIRST_BEFORE_SECOND=r.FIRST_BEFORE_SECOND,t.DO_NOT_SWAP=r.DO_NOT_SWAP,t.sort=r.sort},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,t.getCompareFunctionFactory=function(e){if(c(e))return u(e);return u(i.COLUMN_DATA_TYPE)},n(711)),o=n(712),s=n(713),a=n(714),r=r(n(456));const{register:l,getItem:u,hasItem:c}=(0,r.default)("sorting.compareFunctionFactory");var{register:n,getItem:r}=(0,r.default)("sorting.mainSortComparator");t.getRootComparator=r,t.registerRootComparator=n,l(o.COLUMN_DATA_TYPE,o.compareFunctionFactory),l(s.COLUMN_DATA_TYPE,s.compareFunctionFactory),l(a.COLUMN_DATA_TYPE,a.compareFunctionFactory),l(i.COLUMN_DATA_TYPE,i.compareFunctionFactory)},(e,t,n)=>{"use strict";t.__esModule=!0,t.compareFunctionFactory=function(r,e,i){const o=e.locale;return function(e,t){var n=i["sortEmptyCells"];return(e="string"==typeof e?e.toLocaleLowerCase(o):e)===(t="string"==typeof t?t.toLocaleLowerCase(o):t)?a.DO_NOT_SWAP:(0,s.isEmpty)(e)?(0,s.isEmpty)(t)?a.DO_NOT_SWAP:n&&"asc"===r?a.FIRST_BEFORE_SECOND:a.FIRST_AFTER_SECOND:(0,s.isEmpty)(t)?n&&"asc"===r?a.FIRST_AFTER_SECOND:a.FIRST_BEFORE_SECOND:isNaN(e)&&!isNaN(t)?"asc"===r?a.FIRST_AFTER_SECOND:a.FIRST_BEFORE_SECOND:!isNaN(e)&&isNaN(t)||(isNaN(e)||isNaN(t)||(e=parseFloat(e),t=parseFloat(t)),e<t)?"asc"===r?a.FIRST_BEFORE_SECOND:a.FIRST_AFTER_SECOND:t<e?"asc"===r?a.FIRST_AFTER_SECOND:a.FIRST_BEFORE_SECOND:a.DO_NOT_SWAP}};var s=n(305),a=n(709);t.COLUMN_DATA_TYPE="default"},(e,t,n)=>{"use strict";t.__esModule=!0,t.compareFunctionFactory=function(o,e,s){return function(e,t){var n=parseFloat(e),r=parseFloat(t),i=s["sortEmptyCells"];if(n===r||isNaN(n)&&isNaN(r))return l.DO_NOT_SWAP;if(i){if((0,a.isEmpty)(e))return"asc"===o?l.FIRST_BEFORE_SECOND:l.FIRST_AFTER_SECOND;if((0,a.isEmpty)(t))return"asc"===o?l.FIRST_AFTER_SECOND:l.FIRST_BEFORE_SECOND}return isNaN(n)?l.FIRST_AFTER_SECOND:isNaN(r)?l.FIRST_BEFORE_SECOND:n<r?"asc"===o?l.FIRST_BEFORE_SECOND:l.FIRST_AFTER_SECOND:r<n?"asc"===o?l.FIRST_AFTER_SECOND:l.FIRST_BEFORE_SECOND:l.DO_NOT_SWAP}};var a=n(305),l=n(709);t.COLUMN_DATA_TYPE="numeric"},(e,t,n)=>{"use strict";t.__esModule=!0,t.compareFunctionFactory=function(l,u,c){const d=u.checkedTemplate,h=u.uncheckedTemplate,f=c["sortEmptyCells"];return function(e,t){var n=(0,m.isEmpty)(e),r=(0,m.isEmpty)(t),i=n?h:e,o=r?h:t,s=i===h||i===d,a=o===h||o===d;if(!1===f){if(n&&!1===r)return p.FIRST_AFTER_SECOND;if(!1===n&&r)return p.FIRST_BEFORE_SECOND}return!1==s&&a?"asc"===l?p.FIRST_BEFORE_SECOND:p.FIRST_AFTER_SECOND:s&&!1==a?"asc"===l?p.FIRST_AFTER_SECOND:p.FIRST_BEFORE_SECOND:!1==s&&!1==a?(0,g.compareFunctionFactory)(l,u,c)(e,t):i===h&&o===d?"asc"===l?p.FIRST_BEFORE_SECOND:p.FIRST_AFTER_SECOND:i===d&&o===h?"asc"===l?p.FIRST_AFTER_SECOND:p.FIRST_BEFORE_SECOND:p.DO_NOT_SWAP}};var p=n(709),g=n(711),m=n(305);t.COLUMN_DATA_TYPE="checkbox"},(e,t,n)=>{"use strict";var r=n(196),s=(t.__esModule=!0,t.compareFunctionFactory=function(r,i,o){return function(e,t){var n=o["sortEmptyCells"];return e===t?l.DO_NOT_SWAP:(0,a.isEmpty)(e)?(0,a.isEmpty)(t)?l.DO_NOT_SWAP:n&&"asc"===r?l.FIRST_BEFORE_SECOND:l.FIRST_AFTER_SECOND:(0,a.isEmpty)(t)?n&&"asc"===r?l.FIRST_AFTER_SECOND:l.FIRST_BEFORE_SECOND:(n=i.dateFormat,e=(0,s.default)(e,n),t=(0,s.default)(t,n),e.isValid()?t.isValid()?t.isAfter(e)?"asc"===r?l.FIRST_BEFORE_SECOND:l.FIRST_AFTER_SECOND:t.isBefore(e)?"asc"===r?l.FIRST_AFTER_SECOND:l.FIRST_BEFORE_SECOND:l.DO_NOT_SWAP:l.FIRST_BEFORE_SECOND:l.FIRST_AFTER_SECOND)}},r(n(306))),a=n(305),l=n(709);t.COLUMN_DATA_TYPE="date"},(e,t,n)=>{"use strict";t.__esModule=!0,t.sort=function(e,t){t=(0,o.getRootComparator)(t);for(var n=arguments.length,r=new Array(2<n?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];e.sort(t(...r))};var o=n(710);t.DO_NOT_SWAP=0,t.FIRST_BEFORE_SECOND=-1;t.FIRST_AFTER_SECOND=1},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(717);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.ColumnSummary=n.ColumnSummary},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(273),n(688)),o=n(447),s=r(n(718)),a=n(443),l=n(719);const u="columnSummary";t.PLUGIN_KEY=u;t.PLUGIN_PRIORITY=220;class c extends i.BasePlugin{static get PLUGIN_KEY(){return u}static get PLUGIN_PRIORITY(){return 220}constructor(e){super(e),this.endpoints=null}isEnabled(){return!!this.hot.getSettings()[u]}enablePlugin(){var r=this;this.enabled||(this.settings=this.hot.getSettings()[u],this.endpoints=new s.default(this,this.settings),this.addHook("afterInit",function(){return r.onAfterInit(...arguments)}),this.addHook("afterChange",function(){return r.onAfterChange(...arguments)}),this.addHook("beforeCreateRow",(e,t,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",e,t,null,n)),this.addHook("beforeCreateCol",(e,t,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",e,t,null,n)),this.addHook("beforeRemoveRow",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.endpoints.resetSetupBeforeStructureAlteration("remove_row",...t)}),this.addHook("beforeRemoveCol",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.endpoints.resetSetupBeforeStructureAlteration("remove_col",...t)}),this.addHook("afterCreateRow",(e,t,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",e,t,null,n)),this.addHook("afterCreateCol",(e,t,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",e,t,null,n)),this.addHook("afterRemoveRow",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.endpoints.resetSetupAfterStructureAlteration("remove_row",...t)}),this.addHook("afterRemoveCol",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.endpoints.resetSetupAfterStructureAlteration("remove_col",...t)}),this.addHook("afterRowMove",function(){return r.onAfterRowMove(...arguments)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e)}}calculateSum(t){let n=0;return(0,o.objectEach)(t.ranges,e=>{n+=this.getPartialSum(e,t.sourceColumn)}),n}getPartialSum(e,t){let n=0,r=e[1]||e[0];let i=0;do{var o,s=this.getCellValue(r,t);null!==(s=(0,l.isNullishOrNaN)(s)?null:s)&&(o=((""+s).split(".")[1]||[]).length||1)>i&&(i=o),n+=s||0,--r}while(r>=e[0]);return Math.round(n*10**i)/10**i}calculateMinMax(n,r){let i=null;return(0,o.objectEach)(n.ranges,e=>{var t=this.getPartialMinMax(e,n.sourceColumn,r);if(null===i&&null!==t&&(i=t),null!==t)switch(r){case"min":i=Math.min(i,t);break;case"max":i=Math.max(i,t)}}),null===i?"Not enough data":i}getPartialMinMax(e,t,n){let r=null,i=e[1]||e[0];var o;do{if(o=this.getCellValue(i,t),o=(0,l.isNullishOrNaN)(o)?null:o,null===r)r=o;else if(null!==o)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o)}}while(--i>=e[0]);return r}countEmpty(e,t){var n;let r=0,i=e[1]||e[0];for(;n=this.getCellValue(i,t),null===((0,l.isNullishOrNaN)(n)?null:n)&&(r+=1),--i>=e[0];);return r}countEntries(n){let r=0;var e=n.ranges;return(0,o.objectEach)(e,e=>{var t=void 0===e[1]?1:e[1]-e[0]+1,e=this.countEmpty(e,n.sourceColumn);r=r+t-e}),r}calculateAverage(e){return this.calculateSum(e)/this.countEntries(e)}getCellValue(e,t){var n=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(t);let i=this.hot.getSourceDataAtCell(e,t),o="";if(-1<(o=null!==n&&null!==r?this.hot.getCellMeta(n,r).className||"":o).indexOf("columnSummaryResult"))return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof i&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error((0,a.toSingleLine)`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return i}onAfterInit(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}onAfterChange(e,t){e&&"ColumnSummary.reset"!==t&&"ColumnSummary.set"!==t&&"loadData"!==t&&this.endpoints.refreshChangedEndpoints(e)}onAfterRowMove(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}}t.ColumnSummary=c},(e,t,n)=>{"use strict";t.__esModule=!0,n(273),n(203);var d=n(444),r=n(455);t.default=class{constructor(e,t){this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=t,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}getEndpoint(e){return("function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints)[e]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let t=e;if(t||"function"!=typeof this.settings)return t=t||this.settings,(0,d.arrayEach)(t,e=>{var t={};this.assignSetting(e,t,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(e,t,"reversedRowCoords",!1),this.assignSetting(e,t,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(e,t,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(e,t,"sourceColumn",e.destinationColumn),this.assignSetting(e,t,"type","sum"),this.assignSetting(e,t,"forceNumeric",!1),this.assignSetting(e,t,"suppressDataTypeErrors",!0),this.assignSetting(e,t,"suppressDataTypeErrors",!0),this.assignSetting(e,t,"customFunction",null),this.assignSetting(e,t,"readOnly",!0),this.assignSetting(e,t,"roundFloat",!1),n.push(t)}),n;this.settingsType="function"}assignSetting(e,t,n,r){if("ranges"===n&&void 0===e[n])t[n]=r;else if("ranges"!==n||0!==e[n].length)if(void 0===e[n]){if(r instanceof Error)throw r;t[n]=r}else"destinationRow"===n&&t.reversedRowCoords?t[n]=this.hot.countRows()-e[n]-1:t[n]=e[n]}resetSetupBeforeStructureAlteration(t,n,r){if("function"===this.settingsType){const i=-1<t.indexOf("row")?"row":"col";var e=this.getAllEndpoints();(0,d.arrayEach)(e,e=>{"row"==i&&e.destinationRow>=n&&("insert_row"===t?e.alterRowOffset=r:"remove_row"===t&&(e.alterRowOffset=-1*r)),"col"==i&&e.destinationColumn>=n&&("insert_col"===t?e.alterColumnOffset=r:"remove_col"===t&&(e.alterColumnOffset=-1*r))}),this.resetAllEndpoints(e,!1)}}resetSetupAfterStructureAlteration(e,t,n,r,i){var o=!(5<arguments.length&&void 0!==arguments[5])||arguments[5];if("function"===this.settingsType){const a=()=>(this.hot.removeHook("beforeViewRender",a),this.refreshAllEndpoints());void this.hot.addHookOnce("beforeViewRender",a)}else{const l=-1<e.indexOf("row")?"row":"col",u=-1<e.indexOf("remove")?-1:1;var s=this.getAllEndpoints(),e=0===e.indexOf("move_row");const c=t;(0,d.arrayEach)(s,e=>{"row"==l&&e.destinationRow>=c&&(e.alterRowOffset=u*n),"col"==l&&e.destinationColumn>=c&&(e.alterColumnOffset=u*n)}),this.resetAllEndpoints(s,!e),e?(0,d.arrayEach)(s,e=>{this.extendEndpointRanges(e,c,r[0],r.length),this.recreatePhysicalRanges(e),this.clearOffsetInformation(e)}):(0,d.arrayEach)(s,e=>{this.shiftEndpointCoordinates(e,c)}),o&&this.refreshAllEndpoints()}}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,n,r){(0,d.arrayEach)(e.ranges,e=>{e[1]&&(t>=e[0]&&t<=e[1]?n>e[1]?e[1]+=r:n<e[0]&&(e[0]-=r):n>=e[0]&&n<=e[1]&&(e[1]-=r,t<=e[0])&&(e[0]+=1,e[1]+=1))})}recreatePhysicalRanges(e){var t=e.ranges;const i=[],r=[];(0,d.arrayEach)(t,t=>{var n=[];if(t[1])for(let e=t[0];e<=t[1];e++)n.push(this.hot.toPhysicalRow(e));else n.push(this.hot.toPhysicalRow(t[0]));r.push(n)}),(0,d.arrayEach)(r,n=>{let r=[];(0,d.arrayEach)(n,(e,t)=>{0===t?r.push(e):n[t]!==n[t-1]+1&&(r.push(n[t-1]),i.push(r),(r=[]).push(e)),t===n.length-1&&(r.push(e),i.push(r))})}),e.ranges=i}shiftEndpointCoordinates(r,i){r.alterRowOffset&&0!==r.alterRowOffset?(r.destinationRow+=r.alterRowOffset||0,(0,d.arrayEach)(r.ranges,n=>{(0,d.arrayEach)(n,(e,t)=>{i<=e&&(n[t]+=r.alterRowOffset||0)})})):r.alterColumnOffset&&0!==r.alterColumnOffset&&(r.destinationColumn+=r.alterColumnOffset||0,r.sourceColumn+=r.alterColumnOffset||0)}resetAllEndpoints(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints();let t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];e.some(e=>{var t=e.alterRowOffset||0,n=e.alterColumnOffset||0;return e.destinationRow+t>=this.hot.countRows()||e.destinationColumn+n>=this.hot.countCols()})||(this.cellsToSetCache=[],(0,d.arrayEach)(e,e=>{this.resetEndpointValue(e,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],(0,d.arrayEach)(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const i=[];this.cellsToSetCache=[],(0,d.arrayEach)(e,(e,n,r)=>{""+(e[2]||"")!=""+e[3]&&(0,d.arrayEach)(this.getAllEndpoints(),(e,t)=>{this.hot.propToCol(r[n][1])===e.sourceColumn&&-1===i.indexOf(t)&&i.push(t)})}),(0,d.arrayEach)(i,e=>{this.refreshEndpoint(this.getEndpoint(e))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=e.alterRowOffset||0,r=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?n:0)),this.hot.toVisualColumn(e.destinationColumn+(t?r:0)),""])}setEndpointValue(e,t){var n,r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i=this.hot.toVisualRow(e.destinationRow);e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()?this.throwOutOfBoundsWarning():(null!==(n=this.hot.toVisualRow(e.destinationRow))&&(n=this.hot.getCellMeta(n,e.destinationColumn),"init"!==t&&n.readOnly===e.readOnly||(n.readOnly=e.readOnly,n.className="columnSummaryResult")),e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0)}throwOutOfBoundsWarning(){(0,r.warn)("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}},(e,t)=>{"use strict";t.__esModule=!0,t.isNullishOrNaN=function(e){return null==e||isNaN(e)}},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(721);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.Comments=n.Comments},(e,t,n)=>{"use strict";var r=n(196),v=(t.__esModule=!0,n(273),n(203),n(302)),o=n(447),i=r(n(457)),s=n(688),a=r(n(722)),l=n(723),u=r(n(725)),c=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=d(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function d(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(d=function(e){return e?n:t})(e))}n(726);const h="comments",f=(t.PLUGIN_KEY=h,t.PLUGIN_PRIORITY=60,new WeakMap),p="comment",g="value",b="readOnly";class m extends s.BasePlugin{static get PLUGIN_KEY(){return h}static get PLUGIN_PRIORITY(){return 60}constructor(e){super(e),this.editor=null,this.displaySwitch=null,this.eventManager=null,this.range={},this.preventEditorAutoSwitch=!1,f.set(this,{tempEditorDimensions:{},cellBelowCursor:null})}isEnabled(){return!!this.hot.getSettings()[h]}enablePlugin(){this.enabled||(this.editor||(this.editor=new a.default(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new i.default(this)),this.displaySwitch||(this.displaySwitch=new u.default(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,t,n,r,i,o)=>this.onAfterRenderer(e,o)),this.addHook("afterScrollHorizontally",()=>this.hide()),this.addHook("afterScrollVertically",()=>this.hide()),this.addHook("afterBeginEditing",()=>this.hide()),this.displaySwitch.addLocalHook("hide",()=>this.hide()),this.displaySwitch.addLocalHook("show",(e,t)=>this.showAtCell(e,t)),this.registerListeners(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin(),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}disablePlugin(){super.disablePlugin()}registerListeners(){var e=this.hot["rootDocument"];this.eventManager.addEventListener(e,"mouseover",e=>this.onMouseOver(e)),this.eventManager.addEventListener(e,"mousedown",e=>this.onMouseDown(e)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",()=>this.onEditorBlur()),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",e=>this.onEditorMouseDown(e)),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",e=>this.onEditorMouseUp(e))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){e=(0,v.closest)(e.target,"TD","TBODY");return!!(e&&(0,v.hasClass)(e,"htCommentCell")&&(0,v.closest)(e,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.editor.getInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var t=this.editor.getValue();let n="";null!=e?n=e:null!=t&&(n=t);e=this.range.from.row,t=this.range.from.col;this.updateCommentMeta(e,t,{value:n}),this.hot.render()}setCommentAtCell(e,t,n){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(n)}removeComment(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,p),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(n)}getComment(){var e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,g)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,g)}show(){var e,t;if(this.range.from)return{row:t,col:e}=this.range["from"],!(t<0||t>this.hot.countSourceRows()-1||e<0||e>this.hot.countSourceCols()-1||(t=this.hot.getCellMeta(this.range.from.row,this.range.from.col),this.editor.setValue(t[p]?t[p][g]:""),this.editor.show(),this.refreshEditor(!0),0));throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())')}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){this.editor.hide()}refreshEditor(){if(0<arguments.length&&void 0!==arguments[0]&&arguments[0]||this.range.from&&this.editor.isVisible()){var{rowIndexMapper:i,columnIndexMapper:o}=this.hot,{row:s,col:a}=this.range.from;let e=i.getRenderableFromVisualIndex(s),t=o.getRenderableFromVisualIndex(a);var l=null===e,i=(this.editor.setPosition(0,0),null===e&&(e=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1))),null===t&&(t=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,-1))),null===e),o=null===t,{rootWindow:u,view:{_wt:c}}=(e=null!=(u=e)?u:0,t=null!=(u=t)?u:0,this.hot),d=c["wtTable"],c=c.getCell({row:e,col:t},!0),h=this.getCommentMeta(s,a,"style"),h=(h?this.editor.setSize(h.width,h.height):this.editor.resetSize(),o?0:d.getStretchedColumnWidth(t)),o=l&&!i?(0,v.outerHeight)(c):0,{left:d,top:l,width:i,height:c}=c.getBoundingClientRect(),{width:f,height:p}=this.editor.getSize(),{innerWidth:g,innerHeight:m}=this.hot.rootWindow,y=this.hot.rootDocument.documentElement;let n=d+u.scrollX+h,r=l+u.scrollY+o;this.hot.isRtl()&&(n-=f+h),this.hot.isLtr()&&g<d+i+f?n=d+u.scrollX-f-1:this.hot.isRtl()&&n<-(y.scrollWidth-y.clientWidth)&&(n=d+u.scrollX+h+1),m<l+p&&(r-=p-c+1),this.editor.setPosition(n,r),this.editor.setReadOnlyState(this.getCommentMeta(s,a,b))}}checkSelectionCommentsConsistency(){var e=this.hot.getSelectedRangeLast();if(!e)return!1;let t=!1;e=e.getTopStartCorner();return t=this.getCommentMeta(e.row,e.col,g)?!0:t}updateCommentMeta(e,t,n){var r=this.hot.getCellMeta(e,t)[p];let i;r?(i=(0,o.deepClone)(r),(0,o.deepExtend)(i,n)):i=n,this.hot.setCellMeta(e,t,p,i)}getCommentMeta(e,t,n){e=this.hot.getCellMeta(e,t);if(e[p])return e[p][n]}onMouseDown(t){if(this.hot.view&&this.hot.view._wt&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(t)){t=(0,v.closest)(t.target,"TD","TBODY");let e=null;t&&(e=this.hot.getCoords(t)),t&&(!this.range.from||!e||this.range.from.row===e.row&&this.range.from.col===e.col)||this.hide()}}onMouseOver(e){var t=f.get(this),n=this.hot["rootDocument"];this.preventEditorAutoSwitch||this.editor.isFocused()||(0,v.hasClass)(e.target,"wtBorder")||t.cellBelowCursor===e.target||!this.editor||(t.cellBelowCursor=n.elementFromPoint(e.clientX,e.clientY),this.targetIsCellWithComment(e)?(t=this.hot._createCellRange(this.hot.getCoords(e.target)),this.displaySwitch.show(t)):(0,v.isChildOf)(e.target,n)&&!this.targetIsCommentTextArea(e)&&this.displaySwitch.hide())}onMouseUp(){this.preventEditorAutoSwitch=!1}onAfterRenderer(e,t){t[p]&&t[p][g]&&(0,v.addClass)(e,t.commentedCellClassName)}onEditorBlur(){this.setComment()}onEditorMouseDown(e){f.get(this).tempEditorDimensions={width:(0,v.outerWidth)(e.target),height:(0,v.outerHeight)(e.target)}}onEditorMouseUp(e){var t=f.get(this),n=(0,v.outerWidth)(e.target),e=(0,v.outerHeight)(e.target);n===t.tempEditorDimensions.width+1&&e===t.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,{style:{width:n,height:e}})}onContextMenuAddComment(){var e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:e.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}onContextMenuRemoveComment(){var e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll((e,t)=>{0<=e&&0<=t&&this.removeCommentAtCell(e,t,!1)}),this.hot.render()}onContextMenuMakeReadOnly(){var e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll((e,t)=>{var n;0<=e&&0<=t&&(n=!!this.getCommentMeta(e,t,b),this.updateCommentMeta(e,t,{readOnly:!n}))})}addToContextMenu(e){const t=()=>0<this.hot.rowIndexMapper.getRenderableIndexesLength()&&0<this.hot.columnIndexMapper.getRenderableIndexesLength();e.items.push({name:"---------"},{key:"commentsAddEdit",name:()=>this.checkSelectionCommentsConsistency()?this.hot.getTranslatedPhrase(c.CONTEXTMENU_ITEMS_EDIT_COMMENT):this.hot.getTranslatedPhrase(c.CONTEXTMENU_ITEMS_ADD_COMMENT),callback:()=>this.onContextMenuAddComment(),disabled:()=>!t()||!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner())},{key:"commentsRemove",name(){return this.getTranslatedPhrase(c.CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback:()=>this.onContextMenuRemoveComment(),disabled:()=>!t()||!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner())},{key:"commentsReadOnly",name(){let e=this.getTranslatedPhrase(c.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);var t=(0,l.checkSelectionConsistency)(this.getSelectedRangeLast(),(e,t)=>{let n=this.getCellMeta(e,t)[p];if(n=n&&n[b])return!0});return e=t?(0,l.markLabelAsSelected)(e):e},callback:()=>this.onContextMenuMakeReadOnly(),disabled:()=>!t()||!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner()&&this.checkSelectionCommentsConsistency())})}getDisplayDelaySetting(){var e=this.hot.getSettings()[h];if((0,o.isObject)(e))return e.displayDelay}destroy(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),super.destroy()}}t.Comments=m},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(302);t.default=class i{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){this.rootDocument=e,this.isRtl=t,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}setPosition(e,t){this.editorStyle.left=e+"px",this.editorStyle.top=t+"px"}setSize(e,t){var n;e&&t&&((n=this.getInputElement()).style.width=e+"px",n.style.height=t+"px")}getSize(){return{width:(0,r.outerWidth)(this.getInputElement()),height:(0,r.outerHeight)(this.getInputElement())}}resetSize(){var e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){this.getInputElement().readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return"block"===this.editorStyle.display}setValue(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"")||"";this.getInputElement().value=e}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){var e=this.rootDocument.createElement("div"),t=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),(0,r.addClass)(this.container,i.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),(0,r.addClass)(e,i.CLASS_EDITOR),(0,r.addClass)(t,i.CLASS_INPUT),e.appendChild(t),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector("."+i.CLASS_INPUT)}destroy(){var e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}},(e,t,n)=>{"use strict";t.__esModule=!0,t.align=function(e,a,l,u,c){(0,i.arrayEach)(e,e=>{e.forAll((t,n)=>{if(0<=t&&0<=n){var r=a;var i=l;var o=u;var s=c;o=o(t,n);let e=i;o.className&&(e=("vertical"===r?d:h)(o.className,i));s(t,n,"className",e)}})})},t.checkSelectionConsistency=function(e,n){let r=!1;Array.isArray(e)&&(0,i.arrayEach)(e,e=>(e.forAll((e,t)=>{if(0<=e&&0<=t&&n(e,t))return!(r=!0)}),r));return r},t.filterSeparators=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:o.KEY,e=e.slice(0);return function(e){const n=[];return(0,i.arrayEach)(e,(e,t)=>{(!(0<t)||n[n.length-1].name!==e.name)&&n.push(e)}),n}(e=function(e,t){let n=e.slice(0);return n.reverse(),(n=s(n,t)).reverse(),n}(e=s(e,t),t))},t.getAlignmentClasses=function(e,n){const r={};return(0,i.arrayEach)(e,e=>{e.forAll((e,t)=>{0<=e&&0<=t&&(r[e]||(r[e]=[]),r[e][t]=n(e,t))})}),r},t.getValidSelection=function(e){e=e.getSelected();if(!e)return null;if(e[0]<0)return null;return e},t.hasSubMenu=function(e){return(0,r.hasClass)(e,"htSubmenu")},t.isDisabled=function(e){return(0,r.hasClass)(e,"htDisabled")},t.isItemHidden=function(e,t){return!e.hidden||!("function"==typeof e.hidden&&e.hidden.call(t))},t.isSelectionDisabled=function(e){return(0,r.hasClass)(e,"htSelectionDisabled")},t.isSeparator=function(e){return(0,r.hasClass)(e,"htSeparator")},t.markLabelAsSelected=function(e){return`<span class="selected">${String.fromCharCode(10003)}</span>`+e},t.normalizeSelection=function(e){return(0,i.arrayMap)(e,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))},t.prepareHorizontalAlignClass=h,t.prepareVerticalAlignClass=d,n(203);var i=n(444),r=n(302),o=n(724);function d(e,t){return-1!==e.indexOf(t)?e:e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")+" "+t}function h(e,t){return-1!==e.indexOf(t)?e:e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")+" "+t}function s(e,t){for(var n=e.slice(0);0<n.length&&n[0].name===t;)n.shift();return n}},(e,t)=>{"use strict";t.__esModule=!0,t.default=function(){return{name:n}};const n="---------";t.KEY=n},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(445)),o=n(447),r=r(n(549));class s{constructor(e){this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")},250)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){this.showDebounced=(0,i.debounce)(e=>{this.wasLastActionShow&&this.runLocalHooks("show",e.from.row,e.from.col)},0<arguments.length&&void 0!==arguments[0]?arguments[0]:250)}destroy(){this.clearLocalHooks()}}(0,o.mixin)(s,r.default),t.default=s},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(728);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.ContextMenu=n.ContextMenu},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(688)),o=r(n(454)),s=n(444),a=r(n(729)),l=r(n(457)),u=r(n(732)),c=r(n(746)),d=n(302),h=n(733);n(748);const f="contextMenu";t.PLUGIN_KEY=f;t.PLUGIN_PRIORITY=70,o.default.getSingleton().register("afterContextMenuDefaultOptions"),o.default.getSingleton().register("beforeContextMenuShow"),o.default.getSingleton().register("afterContextMenuShow"),o.default.getSingleton().register("afterContextMenuHide"),o.default.getSingleton().register("afterContextMenuExecute");class p extends i.BasePlugin{static get PLUGIN_KEY(){return f}static get PLUGIN_PRIORITY(){return 70}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[h.ROW_ABOVE,h.ROW_BELOW,h.SEPARATOR,h.COLUMN_LEFT,h.COLUMN_RIGHT,h.SEPARATOR,h.REMOVE_ROW,h.REMOVE_COLUMN,h.SEPARATOR,h.UNDO,h.REDO,h.SEPARATOR,h.READ_ONLY,h.SEPARATOR,h.ALIGNMENT]}constructor(e){super(e),this.eventManager=new l.default(this),this.commandExecutor=new a.default(this.hot),this.itemsFactory=null,this.menu=null}isEnabled(){return!!this.hot.getSettings()[f]}enablePlugin(){var e,r=this;this.enabled||("function"==typeof(e=this.hot.getSettings()[f]).callback&&this.commandExecutor.setCommonCallback(e.callback),this.menu=new c.default(this.hot,{className:"htContextMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>this.onMenuBeforeOpen()),this.menu.addLocalHook("afterOpen",()=>this.onMenuAfterOpen()),this.menu.addLocalHook("afterClose",()=>this.onMenuAfterClose()),this.menu.addLocalHook("executeCommand",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.executeCommand.call(r,...t)}),this.addHook("afterOnCellContextMenu",e=>this.onAfterOnCellContextMenu(e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),super.disablePlugin()}open(n){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),this.menu.isOpened())){let e=0,t=0;var r,i;t=this.hot.rootDocument!==this.menu.container.ownerDocument?(r=this.hot.rootWindow["frameElement"],{top:r,left:i}=r.getBoundingClientRect(),e=r-(0,d.getWindowScrollTop)(n.view),i-(0,d.getWindowScrollLeft)(n.view)):(e=-1*(0,d.getWindowScrollTop)(this.menu.hotMenu.rootWindow),-1*(0,d.getWindowScrollLeft)(this.menu.hotMenu.rootWindow)),this.menu.setPosition({top:parseInt(n.pageY,10)+e,left:parseInt(n.pageX,10)+t})}}close(){this.menu&&(this.menu.close(),this.itemsFactory=null)}executeCommand(e){null===this.itemsFactory&&this.prepareMenuItems();for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new u.default(this.hot,p.DEFAULT_ITEMS);var e=this.hot.getSettings()[f],t={items:this.itemsFactory.getItems(e)},t=(this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items),this.itemsFactory.getItems(e));this.hot.runHooks("beforeContextMenuSetItems",t),this.menu.setMenuItems(t),(0,s.arrayEach)(t,e=>this.commandExecutor.registerCommand(e.key,e))}onAfterOnCellContextMenu(e){var t=this.hot.getSettings(),n=t.rowHeaders,t=t.colHeaders;var r=e.target;this.close(),!(0,d.hasClass)(r,"handsontableInput")&&(e.preventDefault(),e.stopPropagation(),n||t||"TD"===(n=r).nodeName||"TD"===n.parentNode.nodeName||(0,d.hasClass)(r,"current")&&(0,d.hasClass)(r,"wtBorder"))&&this.open(e)}onMenuBeforeOpen(){this.hot.runHooks("beforeContextMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterContextMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}(t.ContextMenu=p).SEPARATOR={name:h.SEPARATOR}},(e,t,n)=>{"use strict";t.__esModule=!0,n(273),n(203),n(730);var a=n(444),l=n(447);t.default=class{constructor(e){this.hot=e,this.commands={},this.commonCallback=null}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var e=e.split(":"),i=e[0],o=2===e.length?e[1]:null;let s=this.commands[i];if(!s)throw new Error(`Menu command '${i}' not exists.`);!0===(s=o&&s.submenu?function(n,e){let r;return(0,a.arrayEach)(e,e=>{var t=e.key?e.key.split(":"):null;if(Array.isArray(t)&&t[1]===n)return r=e,!1}),r}(o,s.submenu.items):s).disabled||"function"==typeof s.disabled&&!0===s.disabled.call(this.hot)||(0,l.hasOwnProperty)(s,"submenu")||(i=[],"function"==typeof s.callback&&i.push(s.callback),"function"==typeof this.commonCallback&&i.push(this.commonCallback),n.unshift(e.join(":")),(0,a.arrayEach)(i,e=>e.apply(this.hot,n)))}}},(e,t,n)=>{"use strict";var r=n(204),a=n(241),l=n(265),u=n(270),c=n(731),d=n(272);r({target:"Array",proto:!0,arity:1,forced:1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(e){return e instanceof TypeError}}()},{unshift:function(e){var t=a(this),n=l(t),r=arguments.length;if(r){d(n+r);for(var i=n;i--;){var o=i+r;i in t?t[o]=t[i]:c(t,o)}for(var s=0;s<r;s++)t[s]=arguments[s]}return u(t,n+r)}})},(e,t,n)=>{"use strict";var r=n(233),i=TypeError;e.exports=function(e,t){if(!delete e[t])throw i("Cannot delete property "+r(t)+" of "+r(e))}},(e,t,n)=>{"use strict";t.__esModule=!0,n(203);var o=n(447),s=n(444),a=n(733);t.default=class{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this.hot=e,this.predefinedItems=(0,a.predefinedItems)(),this.defaultOrderPattern=t}setPredefinedItems(e){const r={};(this.defaultOrderPattern.length=0,o.objectEach)(e,(e,t)=>{let n="";n=e.name===a.SEPARATOR?(r[a.SEPARATOR]=e,a.SEPARATOR):(isNaN(parseInt(t,10))?(e.key=void 0===e.key?t:e.key,r[t]=e):r[e.key]=e,e.key),this.defaultOrderPattern.push(n)}),this.predefinedItems=r}getItems(){return function(){let e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};const i=[];let n=e;n&&n.items?n=n.items:Array.isArray(n)||(n=t);(0,o.isObject)(n)?(0,o.objectEach)(n,(e,t)=>{let n=r["string"==typeof e?e:t];n=n||e,(0,o.isObject)(e)?(0,o.extend)(n,e):"string"==typeof n&&(n={name:n}),void 0===n.key&&(n.key=t),i.push(n)}):(0,s.arrayEach)(n,(e,t)=>{let n=r[e];!n&&0<=a.ITEMS.indexOf(e)||(n=n||{name:e,key:""+t},(0,o.isObject)(e)&&(0,o.extend)(n,e),void 0===n.key&&(n.key=t),i.push(n))});return i}(0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,this.defaultOrderPattern,this.predefinedItems)}}},(e,t,n)=>{"use strict";t.__esModule=!0,t.addItem=function(e,t){-1===v.indexOf(e)&&(b[e]=t)},t.predefinedItems=function(){const n={};return(0,r.objectEach)(b,(e,t)=>{n[t]=e()}),n};var r=n(447),i=y(n(734)),o=(t.ALIGNMENT=i.KEY,y(n(735))),s=(t.CLEAR_COLUMN=o.KEY,y(n(736))),a=(t.COLUMN_LEFT=s.KEY,y(n(737))),l=(t.COLUMN_RIGHT=a.KEY,y(n(738))),u=(t.READ_ONLY=l.KEY,y(n(739))),c=(t.REDO=u.KEY,y(n(740))),d=(t.REMOVE_COLUMN=c.KEY,y(n(741))),h=(t.REMOVE_ROW=d.KEY,y(n(742))),f=(t.ROW_ABOVE=h.KEY,y(n(743))),p=(t.ROW_BELOW=f.KEY,y(n(724))),g=(t.SEPARATOR=p.KEY,y(n(744))),n=(t.NO_ITEMS=g.KEY,y(n(745)));function m(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(m=function(e){return e?n:t})(e))}function y(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=m(t);if(t&&t.has(e))return t.get(e);var n,r,i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((r=o?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(i,n,r):i[n]=e[n]);return i.default=e,t&&t.set(e,i),i}t.UNDO=n.KEY;const v=[h.KEY,f.KEY,s.KEY,a.KEY,o.KEY,d.KEY,c.KEY,n.KEY,u.KEY,l.KEY,i.KEY,p.KEY,g.KEY],b=(t.ITEMS=v,{[p.KEY]:p.default,[g.KEY]:g.default,[h.KEY]:h.default,[f.KEY]:f.default,[s.KEY]:s.default,[a.KEY]:a.default,[o.KEY]:o.default,[d.KEY]:d.default,[c.KEY]:c.default,[n.KEY]:n.default,[u.KEY]:u.default,[l.KEY]:l.default,[i.KEY]:i.default})},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:a,name(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled(){return 0===this.countRows()||0===this.countCols()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:a+":left",name(){let e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT);var t=(0,r.checkSelectionConsistency)(this.getSelectedRange(),(e,t)=>{e=this.getCellMeta(e,t).className;if(e&&-1!==e.indexOf("htLeft"))return!0});return e=t?(0,r.markLabelAsSelected)(e):e},callback(){var e=this.getSelectedRange(),t=(0,r.getAlignmentClasses)(e,(e,t)=>this.getCellMeta(e,t).className),n="horizontal";this.runHooks("beforeCellAlignment",t,e,n,"htLeft"),(0,r.align)(e,n,"htLeft",(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1},{key:a+":center",name(){let e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER);var t=(0,r.checkSelectionConsistency)(this.getSelectedRange(),(e,t)=>{e=this.getCellMeta(e,t).className;if(e&&-1!==e.indexOf("htCenter"))return!0});return e=t?(0,r.markLabelAsSelected)(e):e},callback(){var e=this.getSelectedRange(),t=(0,r.getAlignmentClasses)(e,(e,t)=>this.getCellMeta(e,t).className),n="horizontal";this.runHooks("beforeCellAlignment",t,e,n,"htCenter"),(0,r.align)(e,n,"htCenter",(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1},{key:a+":right",name(){let e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT);var t=(0,r.checkSelectionConsistency)(this.getSelectedRange(),(e,t)=>{e=this.getCellMeta(e,t).className;if(e&&-1!==e.indexOf("htRight"))return!0});return e=t?(0,r.markLabelAsSelected)(e):e},callback(){var e=this.getSelectedRange(),t=(0,r.getAlignmentClasses)(e,(e,t)=>this.getCellMeta(e,t).className),n="horizontal";this.runHooks("beforeCellAlignment",t,e,n,"htRight"),(0,r.align)(e,n,"htRight",(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1},{key:a+":justify",name(){let e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY);var t=(0,r.checkSelectionConsistency)(this.getSelectedRange(),(e,t)=>{e=this.getCellMeta(e,t).className;if(e&&-1!==e.indexOf("htJustify"))return!0});return e=t?(0,r.markLabelAsSelected)(e):e},callback(){var e=this.getSelectedRange(),t=(0,r.getAlignmentClasses)(e,(e,t)=>this.getCellMeta(e,t).className),n="horizontal";this.runHooks("beforeCellAlignment",t,e,n,"htJustify"),(0,r.align)(e,n,"htJustify",(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1},{name:i.KEY},{key:a+":top",name(){let e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_TOP);var t=(0,r.checkSelectionConsistency)(this.getSelectedRange(),(e,t)=>{e=this.getCellMeta(e,t).className;if(e&&-1!==e.indexOf("htTop"))return!0});return e=t?(0,r.markLabelAsSelected)(e):e},callback(){var e=this.getSelectedRange(),t=(0,r.getAlignmentClasses)(e,(e,t)=>this.getCellMeta(e,t).className);this.runHooks("beforeCellAlignment",t,e,"vertical","htTop"),(0,r.align)(e,"vertical","htTop",(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1},{key:a+":middle",name(){let e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE);var t=(0,r.checkSelectionConsistency)(this.getSelectedRange(),(e,t)=>{e=this.getCellMeta(e,t).className;if(e&&-1!==e.indexOf("htMiddle"))return!0});return e=t?(0,r.markLabelAsSelected)(e):e},callback(){var e=this.getSelectedRange(),t=(0,r.getAlignmentClasses)(e,(e,t)=>this.getCellMeta(e,t).className);this.runHooks("beforeCellAlignment",t,e,"vertical","htMiddle"),(0,r.align)(e,"vertical","htMiddle",(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1},{key:a+":bottom",name(){let e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM);var t=(0,r.checkSelectionConsistency)(this.getSelectedRange(),(e,t)=>{e=this.getCellMeta(e,t).className;if(e&&-1!==e.indexOf("htBottom"))return!0});return e=t?(0,r.markLabelAsSelected)(e):e},callback(){var e=this.getSelectedRange(),t=(0,r.getAlignmentClasses)(e,(e,t)=>this.getCellMeta(e,t).className);this.runHooks("beforeCellAlignment",t,e,"vertical","htBottom"),(0,r.align)(e,"vertical","htBottom",(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1}]}}};var r=n(723),i=n(724),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}const a="alignment";t.KEY=a},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:o,name(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback(e,t){var n=t[0].start.col,r=t[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(t[0].start.row,t[0].end.row),r,"ContextMenu.clearColumn")},disabled(){return!(0,r.getValidSelection)(this)||!this.selection.isSelectedByColumnHeader()}}};var r=n(723),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}const o="clear_column";t.KEY=o},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:o,name(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback(){var e=this.getSelectedRangeLast().getTopLeftCorner(),t=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(t,e.col,1,"ContextMenu.columnLeft")},disabled(){return!this.isColumnModificationAllowed()||!(0,r.getValidSelection)(this)||(this.selection.isSelectedByCorner()?0===this.countCols():this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}};var r=n(723),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}const o="col_left";t.KEY=o},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:o,name(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback(){var e=this.getSelectedRangeLast().getTopRightCorner(),t=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(t,e.col,1,"ContextMenu.columnRight")},disabled(){return!this.isColumnModificationAllowed()||!(0,r.getValidSelection)(this)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}};var r=n(723),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}const o="col_right";t.KEY=o},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:a,name(){let e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_READ_ONLY);var t=(0,r.checkSelectionConsistency)(this.getSelectedRange(),(e,t)=>this.getCellMeta(e,t).readOnly);return e=t?(0,r.markLabelAsSelected)(e):e},callback(){var e=this.getSelectedRange();const n=(0,r.checkSelectionConsistency)(e,(e,t)=>this.getCellMeta(e,t).readOnly);(0,i.arrayEach)(e,e=>{e.forAll((e,t)=>{0<=e&&0<=t&&this.setCellMeta(e,t,"readOnly",!n)})}),this.render()},disabled(){return!!this.selection.isSelectedByCorner()||0===this.countRows()||0===this.countCols()||!this.getSelectedRange()||0===this.getSelectedRange().length}}};var r=n(723),i=n(444),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}const a="make_read_only";t.KEY=a},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:i,name(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_REDO)},callback(){this.redo()},hidden(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}};var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}const i="redo";t.KEY=i},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:a,name(){var e,t=this.getSelected();let n=0;return t&&(1<t.length||([,t,,e]=t[0],t-e!=0))&&(n=1),this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_REMOVE_COLUMN,n)},callback(){this.alter("remove_col",(0,i.transformSelectionToColumnDistance)(this.getSelected()),null,"ContextMenu.removeColumn")},disabled(){var e;return!this.isColumnModificationAllowed()||!(0,r.getValidSelection)(this)||(e=this.countCols(),!this.selection.isSelectedByCorner()&&this.selection.isSelectedByRowHeader())||0===e},hidden(){return!this.getSettings().allowRemoveColumn}}};var r=n(723),i=n(583),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}const a="remove_col";t.KEY=a},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:a,name(){var e,t=this.getSelected();let n=0;return t&&(1<t.length||([t,,e]=t[0],t-e!=0))&&(n=1),this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_REMOVE_ROW,n)},callback(){this.alter("remove_row",(0,i.transformSelectionToRowDistance)(this.getSelected()),1,"ContextMenu.removeRow")},disabled(){var e;return!(0,r.getValidSelection)(this)||(e=this.countRows(),!this.selection.isSelectedByCorner()&&this.selection.isSelectedByColumnHeader())||0===e},hidden(){return!this.getSettings().allowRemoveRow}}};var r=n(723),i=n(583),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}const a="remove_row";t.KEY=a},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:o,name(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback(){var e=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",e.row,1,"ContextMenu.rowAbove")},disabled(){return!(0,r.getValidSelection)(this)||(this.selection.isSelectedByCorner()?0===this.countRows():this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}};var r=n(723),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}const o="row_above";t.KEY=o},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:o,name(){return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_ROW_BELOW)},callback(){var e=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",e.row,1,"ContextMenu.rowBelow")},disabled(){return!(0,r.getValidSelection)(this)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}};var r=n(723),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}const o="row_below";t.KEY=o},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:i,name(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}};var r=n(568);const i="no_items";t.KEY=i},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(){return{key:i,name(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_UNDO)},callback(){this.undo()},hidden(){var e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}};var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}const i="undo";t.KEY=i},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),r(n(747))),d=n(733),u=n(723),c=r(n(202)),o=r(n(457)),h=n(444),f=n(446),p=n(302),g=n(452),m=n(445),y=n(305),v=n(447),r=r(n(549));class s{constructor(e,t){this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.eventManager=new o.default(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",e=>this.onDocumentMouseDown(e)),this.eventManager.addEventListener(e.document,"contextmenu",e=>this.onDocumentContextMenu(e)),e=(0,p.getParentWindow)(e)}setMenuItems(e){this.menuItems=e}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}setOffset(e){this.offset[e]=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0}isSubMenu(){return null!==this.parentMenu}open(){var e=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const n=(0,m.debounce)(e=>this.openSubMenu(e),300),t=this.options.minWidth||215;let r=!1,i=(0,h.arrayFilter)(this.menuItems,e=>(e.key===d.NO_ITEMS&&(r=!0),(0,u.isItemHidden)(e,this.hot)));if(i.length<1&&!r)i.push((0,d.predefinedItems)()[d.NO_ITEMS]);else if(0===i.length)return;i=(0,u.filterSeparators)(i,d.SEPARATOR);let o=!1;var s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(e){return(0,y.isDefined)(e)&&e<t?t:e},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:(e,t,n,r,i,o)=>this.menuItemRenderer(e,t,n,r,i,o)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:(e,t)=>{this.isAllSubMenusClosed()?n(t.row):this.openSubMenu(t.row)},rowHeights:e=>i[e].name===d.SEPARATOR?1:23,afterOnCellContextMenu:e=>{e.preventDefault(),(0,f.isWindowsOS)()&&o&&this.hasSelectedItem()&&this.close(!0)},beforeOnCellMouseUp:e=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(e))},afterOnCellMouseUp:e=>{(0,f.isWindowsOS)()&&(0,g.isRightClick)(e)||!o||!this.hasSelectedItem()||((0,f.isMobileBrowser)()||(0,f.isIpadOS)()?setTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}},s=(this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new c.default(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.addHook("afterSelection",function(){return e.onAfterSelection(...arguments)}),this.hotMenu.init(),this.hotMenu.listen(),this.hotMenu.getShortcutManager()),a=s.addContext("menu"),l={...{group:"menu"},runOnlyIf:e=>!1===(0,p.isInput)(e.target)||!1===this.container.contains(e.target)};s.setActiveContextName("menu"),a.addShortcuts([{keys:[["Escape"]],callback:()=>{this.keyEvent=!0,this.close(),this.keyEvent=!1}},{keys:[["ArrowDown"]],callback:()=>{var e=this.hotMenu.getSelectedLast();this.keyEvent=!0,e?this.selectNextCell(e[0],e[1]):this.selectFirstCell(),this.keyEvent=!1}},{keys:[["ArrowUp"]],callback:()=>{var e=this.hotMenu.getSelectedLast();this.keyEvent=!0,e?this.selectPrevCell(e[0],e[1]):this.selectLastCell(),this.keyEvent=!1}},{keys:[["ArrowRight"]],callback:()=>{var e=this.hotMenu.getSelectedLast();this.keyEvent=!0,e&&(e=this.openSubMenu(e[0]))&&e.selectFirstCell(),this.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:()=>{var e=this.hotMenu.getSelectedLast();this.keyEvent=!0,e&&this.isSubMenu()&&(this.close(),this.parentMenu)&&this.parentMenu.hotMenu.listen(),this.keyEvent=!1}},{keys:[["Enter"]],callback:e=>{var t=this.hotMenu.getSelectedLast();this.keyEvent=!0,this.hotMenu.getSourceDataAtRow(t[0]).submenu||(this.executeCommand(e),this.close(!0)),this.keyEvent=!1}},{keys:[["PageUp"]],callback:()=>{var e=this.hotMenu.getSelectedLast();this.keyEvent=!0,e?this.hotMenu.selection.transformStart(-this.hotMenu.countVisibleRows(),0):this.selectFirstCell(),this.keyEvent=!1}},{keys:[["PageDown"]],callback:()=>{var e=this.hotMenu.getSelectedLast();this.keyEvent=!0,e?this.hotMenu.selection.transformStart(this.hotMenu.countVisibleRows(),0):this.selectLastCell(),this.keyEvent=!1}}],l),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}close(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.isOpened()&&(e&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}openSubMenu(e){var t,n;return!(!this.hotMenu||(t=this.hotMenu.getCell(e,0),this.closeAllSubMenus(),!t)||!(0,u.hasSubMenu)(t))&&(e=this.hotMenu.getSourceDataAtRow(e),(n=new s(this.hot,{parent:this,name:e.name,className:this.options.className,keepInViewport:!0,container:this.options.container})).setMenuItems(e.submenu.items),n.open(),n.setPosition(t.getBoundingClientRect()),this.hotSubMenus[e.key]=n)}closeSubMenu(e){var e=this.hotMenu.getSourceDataAtRow(e),t=this.hotSubMenus[e.key];t&&(t.destroy(),delete this.hotSubMenus[e.key])}closeAllSubMenus(){(0,h.arrayEach)(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}destroy(){var e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(e){var t,n;this.isOpened()&&this.hasSelectedItem()&&(t=this.getSelectedItem(),this.runLocalHooks("select",t,e),this.isCommandPassive(t)||(n=(n=this.hot.getSelectedRange())?(0,u.normalizeSelection)(n):[],this.runLocalHooks("executeCommand",t.key,n,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,n,e)))}isCommandPassive(e){var{isCommand:e,name:t,disabled:n,submenu:r}=e,n=!0===n||"function"==typeof n&&!0===n.call(this.hot);return!1===e||t===d.SEPARATOR||!0==n||r}setPosition(e){e=new i.default(e,this.container.ownerDocument.defaultView);this.options.keepInViewport?(!e.fitsBelow(this.container)&&e.fitsAbove(this.container)?this.setPositionAboveCursor(e):this.setPositionBelowCursor(e),this.hot.isLtr()?this.setHorizontalPositionForLtr(e):this.setHorizontalPositionForRtl(e)):(this.setPositionBelowCursor(e),this.setPositionOnRightOfCursor(e))}setHorizontalPositionForRtl(e){e.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(e):this.setPositionOnRightOfCursor(e)}setHorizontalPositionForLtr(e){e.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(e):this.setPositionOnLeftOfCursor(e)}setPositionAboveCursor(e){let t=this.offset.above+e.top-this.container.offsetHeight;this.isSubMenu()&&(t=e.top+e.cellHeight-this.container.offsetHeight+3),this.container.style.top=t+"px"}setPositionBelowCursor(e){let t=this.offset.below+e.top+1;this.isSubMenu()&&(t=e.top-1),this.container.style.top=t+"px"}setPositionOnRightOfCursor(e){let t=e.left;var n;this.isSubMenu()?(n=this.parentMenu.container.getBoundingClientRect()["right"],t+=e.cellWidth+n-(e.left+e.cellWidth)):t+=this.offset.right,this.container.style.left=t+"px"}setPositionOnLeftOfCursor(e){let t=this.offset.left+e.left-this.container.offsetWidth;var n;this.isSubMenu()&&(n=this.parentMenu.container.getBoundingClientRect()["left"],t-=e.left-n),this.container.style.left=t+"px"}selectFirstCell(){var e=this.hotMenu.getCell(0,0);(0,u.isSeparator)(e)||(0,u.isDisabled)(e)||(0,u.isSelectionDisabled)(e)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}selectLastCell(){var e=this.hotMenu.countRows()-1,t=this.hotMenu.getCell(e,0);(0,u.isSeparator)(t)||(0,u.isDisabled)(t)||(0,u.isSelectionDisabled)(t)?this.selectPrevCell(e,0):(this.hotMenu.selectCell(e,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(e,0,!0,!1))}selectNextCell(e,t){var e=e+1,n=e<this.hotMenu.countRows()?this.hotMenu.getCell(e,t):null;n&&((0,u.isSeparator)(n)||(0,u.isDisabled)(n)||(0,u.isSelectionDisabled)(n)?this.selectNextCell(e,t):this.hotMenu.selectCell(e,t))}selectPrevCell(e,t){var e=e-1,n=0<=e?this.hotMenu.getCell(e,t):null;n&&((0,u.isSeparator)(n)||(0,u.isDisabled)(n)||(0,u.isSelectionDisabled)(n)?this.selectPrevCell(e,t):this.hotMenu.selectCell(e,t))}menuItemRenderer(e,t,n,r,i,o){var s=e.getSourceDataAtRow(n),a=this.hot.rootDocument.createElement("div"),l=e=>!0===e.disabled||"function"==typeof e.disabled&&!0===e.disabled.call(this.hot),u=e=>e.disableSelection;let c=o;"function"==typeof c&&(c=c.call(this.hot)),(0,p.empty)(t),(0,p.addClass)(a,"htItemWrapper"),t.appendChild(a),o=s,new RegExp(d.SEPARATOR,"i").test(o.name)?(0,p.addClass)(t,"htSeparator"):"function"==typeof s.renderer?((0,p.addClass)(t,"htCustomMenuRenderer"),t.appendChild(s.renderer(e,a,n,r,i,c))):(0,p.fastInnerHTML)(a,c),l(s)?((0,p.addClass)(t,"htDisabled"),this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell())):u(s)?((0,p.addClass)(t,"htSelectionDisabled"),this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell())):((0,v.hasOwnProperty)(s,"submenu")?(0,p.addClass)(t,"htSubmenu"):(0,p.removeClass)(t,["htSubmenu","htDisabled"]),u(s)?this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell()):this.eventManager.addEventListener(t,"mouseenter",()=>e.selectCell(n,r,void 0,void 0,!1,!1)))}createContainer(){var e=this.options.container.ownerDocument;let t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,n;return t&&(t=(t=(0,m.isFunction)(t)?null===(t=t.call(this.hot))||(0,y.isUndefined)(t)?"":t.toString():t).replace(/[^A-z0-9]/g,"_"),t=this.options.className+"Sub_"+t,n=e.querySelector(`.${this.options.className}.`+t)),n||(n=e.createElement("div"),(0,p.addClass)(n,"htMenu "+this.options.className),t&&(0,p.addClass)(n,t),this.options.container.appendChild(n)),n}blockMainTableCallbacks(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}releaseMainTableCallbacks(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}onAfterInit(){var e=this.hotMenu.view._wt["wtTable"],t=this.hotMenu.getSettings().data,n=e.hider.style,e=e.holder.style,r=parseInt(n.width,10),t=(0,h.arrayReduce)(t,(e,t)=>e+(t.name===d.SEPARATOR?1:26),0);e.width=r+3+"px",e.height=t+3+"px",n.height=e.height}onAfterSelection(e,t,n,r,i){!1===this.keyEvent&&(i.value=!0)}onDocumentMouseDown(e){!this.isOpened()||(this.options.standalone&&this.hotMenu&&!(0,p.isChildOf)(e.target,this.hotMenu.rootElement)||(this.isAllSubMenusClosed()||this.isSubMenu())&&!(0,p.isChildOf)(e.target,".htMenu"))&&this.close(!0)}onDocumentContextMenu(e){this.isOpened()&&(0,p.hasClass)(e.target,"htCore")&&(0,p.isChildOf)(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}(0,v.mixin)(s,r.default);n=s;t.default=n},(e,t,n)=>{"use strict";t.__esModule=!0;var c=n(302);t.default=class{constructor(e,t){var n=(0,c.getWindowScrollTop)(t),r=(0,c.getWindowScrollLeft)(t);let i,o,s,a,l,u;this.rootWindow=t,this.type=this.getSourceType(e),"literal"===this.type?(i=parseInt(e.top,10),s=parseInt(e.left,10),l=e.height||0,u=e.width||0,o=i,a=s,i+=n,s+=r):"event"===this.type&&(i=parseInt(e.pageY,10),s=parseInt(e.pageX,10),l=e.target.clientHeight,u=e.target.clientWidth,o=i-n,a=s-r),this.top=i,this.topRelative=o,this.left=s,this.leftRelative=a,this.scrollTop=n,this.scrollLeft=r,this.cellHeight=l,this.cellWidth=u}getSourceType(e){let t="literal";return t=e instanceof Event?"event":t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(750);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.CopyPaste=n.CopyPaste},(P,e,t)=>{"use strict";t(273);var n=t(196),r=(e.__esModule=!0,t(203),n(t(467))),o=n(t(471)),s=n(t(474)),i=t(688),a=n(t(454)),l=t(586),u=t(444),c=t(303),d=t(302),h=n(t(751)),f=n(t(752)),p=n(t(753)),g=n(t(754)),m=n(t(755)),y=n(t(756)),v=t(758),b=t(759),E=t(458);function C(e,t,n){w(e,t),t.set(e,n)}function w(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}t(760),a.default.getSingleton().register("afterCopyLimit"),a.default.getSingleton().register("modifyCopyableRange"),a.default.getSingleton().register("beforeCut"),a.default.getSingleton().register("afterCut"),a.default.getSingleton().register("beforePaste"),a.default.getSingleton().register("afterPaste"),a.default.getSingleton().register("beforeCopy"),a.default.getSingleton().register("afterCopy");const S="copyPaste",T=(e.PLUGIN_KEY=S,e.PLUGIN_PRIORITY=80,["fragmentSelection"]),R=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var A=new WeakMap,_=new WeakMap,N=new WeakMap,x=new WeakMap,O=new WeakMap,I=new WeakMap,M=new WeakMap,k=new WeakSet;class D extends i.BasePlugin{constructor(){var e,t;super(...arguments),w(e=this,t=k),t.add(e),(0,r.default)(this,"columnsLimit",1/0),(0,r.default)(this,"rowsLimit",1/0),(0,r.default)(this,"pasteMode","overwrite"),(0,r.default)(this,"uiContainer",this.hot.rootDocument.body),C(this,A,{writable:!0,value:!1}),C(this,_,{writable:!0,value:!1}),C(this,N,{writable:!0,value:!1}),C(this,x,{writable:!0,value:"cells-only"}),C(this,O,{writable:!0,value:!1}),C(this,I,{writable:!0,value:!1}),C(this,M,{writable:!0,value:new b.CopyableRangesFactory({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),(0,r.default)(this,"copyableRanges",[]),(0,r.default)(this,"focusableElement",void 0)}static get PLUGIN_KEY(){return S}static get SETTING_KEYS(){return[S,...T]}static get PLUGIN_PRIORITY(){return 80}isEnabled(){return!!this.hot.getSettings()[S]}enablePlugin(){var e,t;this.enabled||(e=this.hot.getSettings()["copyPaste"],"object"==typeof e&&(this.pasteMode=null!=(t=e.pasteMode)?t:this.pasteMode,this.rowsLimit=(isNaN(e.rowsLimit)?this:e).rowsLimit,this.columnsLimit=(isNaN(e.columnsLimit)?this:e).columnsLimit,(0,s.default)(this,A,!!e.copyColumnHeaders),(0,s.default)(this,_,!!e.copyColumnGroupHeaders),(0,s.default)(this,N,!!e.copyColumnHeadersOnly),this.uiContainer=null!=(t=e.uiContainer)?t:this.uiContainer),this.addHook("afterContextMenuDefaultOptions",e=>this.onAfterContextMenuDefaultOptions(e)),this.addHook("afterOnCellMouseUp",()=>this.onAfterOnCellMouseUp()),this.addHook("afterSelectionEnd",()=>this.onAfterSelectionEnd()),this.addHook("beforeKeyDown",()=>this.onBeforeKeyDown()),this.focusableElement=(0,v.createElement)(this.uiContainer),this.focusableElement.addLocalHook("copy",e=>this.onCopy(e)).addLocalHook("cut",e=>this.onCut(e)).addLocalHook("paste",e=>this.onPaste(e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),super.updatePlugin()}disablePlugin(){this.focusableElement&&(0,v.destroyElement)(this.focusableElement),super.disablePlugin()}copy(){(0,s.default)(this,x,0<arguments.length&&void 0!==arguments[0]?arguments[0]:"cells-only"),(0,s.default)(this,O,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){(0,s.default)(this,I,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}getRangedCopyableData(e){return(0,l.stringify)(this.getRangedData(e))}getRangedData(e){const r=[],{rows:t,columns:i}=(0,b.normalizeRanges)(e);return(0,u.arrayEach)(t,t=>{const n=[];(0,u.arrayEach)(i,e=>{t<0?n.push(this.hot.getColHeader(e,t)):n.push(this.hot.getCopyableData(t,e))}),r.push(n)}),r}paste(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:t;(t||n)&&(e=new y.default,t&&e.clipboardData.setData("text/plain",t),n&&e.clipboardData.setData("text/html",n),this.getOrCreateFocusableElement(),this.onPaste(e))}setCopyableText(){var e,t,n,r=this.hot.getSelectedRangeLast();r&&((0,o.default)(this,M).setSelectedRange(r),r=new Map([["headers",null],["cells",null]]),"column-headers-only"===(0,o.default)(this,x)?r.set("headers",(0,o.default)(this,M).getMostBottomColumnHeadersRange()):("with-column-headers"===(0,o.default)(this,x)?r.set("headers",(0,o.default)(this,M).getMostBottomColumnHeadersRange()):"with-column-group-headers"===(0,o.default)(this,x)&&r.set("headers",(0,o.default)(this,M).getAllColumnHeadersRange()),r.set("cells",(0,o.default)(this,M).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(e=>null!==e).map(e=>{var{startRow:e,startCol:t,endRow:n,endCol:r}=e;return{startRow:e,startCol:t,endRow:n,endCol:r}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),null!==(r=r.get("cells")))&&r.isRangeTrimmed&&({startRow:r,startCol:e,endRow:t,endCol:n}=r,this.hot.runHooks("afterCopyLimit",t-r+1,n-e+1,this.rowsLimit,this.columnsLimit))}getOrCreateFocusableElement(){var e=null==(e=this.hot.getActiveEditor())?void 0:e.TEXTAREA;e?this.focusableElement.setFocusableElement(e):this.focusableElement.useSecondaryElement()}isEditorOpened(){var e;return null==(e=this.hot.getActiveEditor())?void 0:e.isOpened()}populateValues(i){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(i.length){var s=i.length,a=i[0].length,l=[],{row:u,col:c}=o.getTopStartCorner(),{row:d,col:h}=o.getBottomEndCorner();let e=u,t=c,n=u,r=c;for(;l.length<s||e<=d;){var{skipRowOnPaste:f,visualRow:p}=this.hot.getCellMeta(e,c);if(e=p+1,!0!==f){n=p,t=c;for(var g=[],m=l.length%s;g.length<a||t<=h;){var{skipColumnOnPaste:y,visualCol:v}=this.hot.getCellMeta(u,t);t=v+1,!0!==y&&(r=v,g.push(i[m][g.length%a]))}l.push(g)}}return this.hot.populateFromArray(u,c,l,void 0,void 0,"CopyPaste.paste",this.pasteMode),[u,c,n,r]}}onCopy(e){var t,n,r,i;!this.hot.isListening()&&!(0,o.default)(this,O)||this.isEditorOpened()||(this.setCopyableText(),(0,s.default)(this,O,!1),t=this.getRangedData(this.copyableRanges),n=function(e,t,n){if(t.has(e))return n;throw new TypeError("attempted to get private field on non-instance")}(this,k,L).call(this,this.copyableRanges),this.hot.runHooks("beforeCopy",t,this.copyableRanges,n)&&(r=(0,l.stringify)(t),e&&e.clipboardData?(i=(0,E._dataToHTML)(t,this.hot.rootDocument),e.clipboardData.setData("text/plain",r),e.clipboardData.setData("text/html",[R,i].join(""))):"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r),this.hot.runHooks("afterCopy",t,this.copyableRanges,n)),(0,s.default)(this,x,"cells-only"),e.preventDefault())}onCut(e){var t,n,r;!this.hot.isListening()&&!(0,o.default)(this,I)||this.isEditorOpened()||(this.setCopyableText(),(0,s.default)(this,I,!1),t=this.getRangedData(this.copyableRanges),this.hot.runHooks("beforeCut",t,this.copyableRanges)&&(n=(0,l.stringify)(t),e&&e.clipboardData?(r=(0,E._dataToHTML)(t,this.hot.rootDocument),e.clipboardData.setData("text/plain",n),e.clipboardData.setData("text/html",[R,r].join(""))):"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",n),this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",t,this.copyableRanges)),e.preventDefault())}onPaste(t){if(this.hot.isListening()&&!this.isEditorOpened()){t&&t.preventDefault&&t.preventDefault();let e;var n,r,i;t&&void 0!==t.clipboardData?(n=(0,c.sanitize)(t.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0}),e=n&&/(<table)|(<TABLE)/g.test(n)?(0,E.htmlToGridSettings)(n,this.hot.rootDocument).data:t.clipboardData.getData("text/plain")):"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(e=this.hot.rootWindow.clipboardData.getData("Text")),(e="string"==typeof e?(0,l.parse)(e):e)&&0===e.length||!1!==this.hot.runHooks("beforePaste",e,this.copyableRanges)&&([n,t,r,i]=this.populateValues(e),this.hot.selectCell(n,t,Math.min(this.hot.countRows()-1,r),Math.min(this.hot.countCols()-1,i)),this.hot.runHooks("afterPaste",e,this.copyableRanges))}}onAfterContextMenuDefaultOptions(e){e.items.push({name:"---------"},(0,h.default)(this)),(0,o.default)(this,A)&&e.items.push((0,g.default)(this)),(0,o.default)(this,_)&&e.items.push((0,p.default)(this)),(0,o.default)(this,N)&&e.items.push((0,f.default)(this)),e.items.push((0,m.default)(this))}onAfterOnCellMouseUp(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}onAfterSelectionEnd(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&(0,d.getSelectionText)())||(this.setCopyableText(),this.focusableElement.focus())}onBeforeKeyDown(){var e,t;this.hot.isListening()&&!this.isEditorOpened()&&(e=this.hot.rootDocument.activeElement,t=this.hot.getActiveEditor())&&(e===this.focusableElement.getFocusableElement()||e===t.select)&&(this.getOrCreateFocusableElement(),this.focusableElement.focus())}destroy(){this.focusableElement&&((0,v.destroyElement)(this.focusableElement),this.focusableElement=null),super.destroy()}}function L(e){var t=(0,b.normalizeRanges)(e)["rows"];let n=0;for(let e=0;e<t.length&&!(0<=t[e]);e++)n+=1;return{columnHeadersCount:n}}e.CopyPaste=D},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(e){return{key:"copy",name(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_COPY)},callback(){e.copyCellsOnly()},disabled(){var e;return 0===this.countRows()||0===this.countCols()||!(e=this.getSelected())||1<e.length},hidden:!1}};var r=n(568)},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(e){return{key:"copy_column_headers_only",name(){var e=this.getSelectedRangeLast(),e=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,e)},callback(){e.copyColumnHeadersOnly()},disabled(){var e;return!this.hasColHeaders()||!(e=this.getSelected())||1<e.length},hidden:!1}};var r=n(568)},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(e){return{key:"copy_with_column_group_headers",name(){var e=this.getSelectedRangeLast(),e=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,e)},callback(){e.copyWithAllColumnHeaders()},disabled(){var e;return!this.hasColHeaders()||!this.getSettings().nestedHeaders||!(e=this.getSelected())||1<e.length},hidden:!1}};var r=n(568)},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(e){return{key:"copy_with_column_headers",name(){var e=this.getSelectedRangeLast(),e=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,e)},callback(){e.copyWithColumnHeaders()},disabled(){var e;return!this.hasColHeaders()||!(e=this.getSelected())||1<e.length},hidden:!1}};var r=n(568)},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(e){return{key:"cut",name(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_CUT)},callback(){e.cut()},disabled(){var e;return 0===this.countRows()||0===this.countCols()||!(e=this.getSelected())||1<e.length},hidden:!1}};var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,r(n(757)));t.default=class{constructor(){this.clipboardData=new i.default}}},(e,t)=>{"use strict";t.__esModule=!0;t.default=class{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,t.createElement=function(e){var t=new a(e);var n=l.get(e);return n=isNaN(n)?0:n,l.set(e,n+1),t},t.deactivateElement=u,t.destroyElement=function(t){if(t instanceof a){let e=l.get(t.container);var n;0<(e=isNaN(e)?0:e)&&--e,u(t),e<=0&&(e=0,(n=h.get(t.container))&&n.parentNode&&(n.parentNode.removeChild(n),h.delete(t.container)),t.mainElement=null),l.set(t.container,e)}},r(n(457))),t=r(n(549)),r=n(447),o=n(446),s=n(302);class a{constructor(e){this.rootDocument=e.defaultView?e:e.ownerDocument,this.mainElement=null,this.eventManager=new i.default(this),this.listenersCount=new WeakSet,this.container=e}useSecondaryElement(){var e=function(e){var t=h.get(e);if(t)return t.parentElement||e.appendChild(t),t;t=e.defaultView?e:e.ownerDocument,t=t.createElement("textarea");return h.set(e,t),t.setAttribute("data-hot-input",""),t.className="HandsontableCopyPaste",t.tabIndex=-1,t.autocomplete="off",t.wrap="hard",t.value=" ",e.appendChild(t),t}(this.container);this.listenersCount.has(e)||(this.listenersCount.add(e),d(this.eventManager,e,this)),this.mainElement=e}setFocusableElement(e){this.listenersCount.has(e)||(this.listenersCount.add(e),d(this.eventManager,e,this)),this.mainElement=e}getFocusableElement(){return this.mainElement}focus(){this.mainElement.value=" ",(0,o.isMobileBrowser)()||(0,s.selectElementIfAllowed)(this.mainElement)}}(0,r.mixin)(a,t.default);const l=new WeakMap;function u(e){e.eventManager.clear()}const c=(t,n)=>e=>n.runLocalHooks(t,e);function d(e,t,n){e.addEventListener(t,"copy",c("copy",n)),e.addEventListener(t,"cut",c("cut",n)),e.addEventListener(t,"paste",c("paste",n))}const h=new WeakMap},(e,t,n)=>{"use strict";n(273);var r=n(196),s=(t.__esModule=!0,t.normalizeRanges=function(e){const r=[],i=[];return(0,a.arrayEach)(e,e=>{var t=Math.min(e.startRow,e.endRow),n=Math.max(e.startRow,e.endRow),t=((0,l.rangeEach)(t,n,e=>{-1===r.indexOf(e)&&r.push(e)}),Math.min(e.startCol,e.endCol)),n=Math.max(e.startCol,e.endCol);(0,l.rangeEach)(t,n,e=>{-1===i.indexOf(e)&&i.push(e)})}),{rows:r,columns:i}},n(203),r(n(471))),o=r(n(474)),a=n(444),l=n(461);function u(e,t){i(e,t),t.add(e)}function c(e,t,n){i(e,t),t.set(e,n)}function i(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function d(e,t,n){if(t.has(e))return n;throw new TypeError("attempted to get private field on non-instance")}var h=new WeakMap,f=new WeakMap,p=new WeakMap,g=new WeakMap,m=new WeakMap,y=new WeakMap,v=new WeakSet,b=new WeakSet;function E(e,t){return Math.min(t,Math.max(e+(0,s.default)(this,m).call(this)-1,e))}function C(e,t){return Math.min(t,Math.max(e+(0,s.default)(this,g).call(this)-1,e))}t.CopyableRangesFactory=class{constructor(e){var{countRows:e,countColumns:t,rowsLimit:n,columnsLimit:r,countColumnHeaders:i}=e;u(this,b),u(this,v),c(this,h,{writable:!0,value:void 0}),c(this,f,{writable:!0,value:void 0}),c(this,p,{writable:!0,value:void 0}),c(this,g,{writable:!0,value:void 0}),c(this,m,{writable:!0,value:void 0}),c(this,y,{writable:!0,value:void 0}),(0,o.default)(this,f,e),(0,o.default)(this,p,t),(0,o.default)(this,g,n),(0,o.default)(this,m,r),(0,o.default)(this,y,i)}setSelectedRange(e){(0,o.default)(this,h,e)}getCellsRange(){var e,t,n,r,i,o;return 0===(0,s.default)(this,f).call(this)||0===(0,s.default)(this,p).call(this)?null:({row:e,col:t}=(0,s.default)(this,h).getTopStartCorner(),{row:n,col:r}=(0,s.default)(this,h).getBottomEndCorner(),i=d(this,b,C).call(this,e,n),o=d(this,v,E).call(this,t,r),{isRangeTrimmed:n!==i||r!==o,startRow:e,startCol:t,endRow:i,endCol:o})}getMostBottomColumnHeadersRange(){var e,t;return 0===(0,s.default)(this,p).call(this)||0===(0,s.default)(this,y).call(this)?null:(e=(0,s.default)(this,h).getTopStartCorner()["col"],t=(0,s.default)(this,h).getBottomEndCorner()["col"],{isRangeTrimmed:t!==(t=d(this,v,E).call(this,e,t)),startRow:-1,startCol:e,endRow:-1,endCol:t})}getAllColumnHeadersRange(){var e,t;return 0===(0,s.default)(this,p).call(this)||0===(0,s.default)(this,y).call(this)?null:(e=(0,s.default)(this,h).getTopStartCorner()["col"],t=(0,s.default)(this,h).getBottomEndCorner()["col"],{isRangeTrimmed:t!==(t=d(this,v,E).call(this,e,t)),startRow:-(0,s.default)(this,y).call(this),startCol:e,endRow:-1,endCol:t})}}},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(762);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.CustomBorders=n.CustomBorders},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),n(273),r(n(467))),r=n(688),s=n(447),a=n(461),l=n(444),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=h(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),u=n(763),c=n(765),d=n(569);function h(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(h=function(e){return e?n:t})(e))}const f="customBorders";t.PLUGIN_KEY=f;t.PLUGIN_PRIORITY=90;class p extends r.BasePlugin{constructor(){super(...arguments),(0,i.default)(this,"savedBorders",[])}static get PLUGIN_KEY(){return f}static get PLUGIN_PRIORITY(){return 90}isEnabled(){return!!this.hot.getSettings()[f]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>this.onAfterContextMenuDefaultOptions(e)),this.addHook("init",()=>this.onAfterInit()),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let o=["top","bottom","start","end"],s=null;t&&(this.checkSettingsCohesion([t]),o=Object.keys(t),s=(0,c.normalizeBorder)(t));t=(0,d.detectSelectionType)(e);const n=(0,d.normalizeSelectionFactory)(t);(0,l.arrayEach)(e,e=>{var[e,r,t,i]=n(e);for(let n=e;n<=t;n+=1)for(let t=r;t<=i;t+=1)(0,l.arrayEach)(o,e=>{this.prepareBorderFromCustomAdded(n,t,s,(0,c.toInlinePropName)(e))})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;var t=(0,d.detectSelectionType)(e);const n=(0,d.normalizeSelectionFactory)(t),o=[];return(0,l.arrayEach)(e,e=>{var[e,r,t,i]=n(e);for(let n=e;n<=t;n+=1)for(let t=r;t<=i;t+=1)(0,l.arrayEach)(this.savedBorders,e=>{e.row===n&&e.col===t&&o.push((0,c.denormalizeBorder)(e))})}),o}clearBorders(e){e?this.setBorders(e):((0,l.arrayEach)(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange(),this.hot.removeCellMeta(e.row,e.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);var n=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,n,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:n})}prepareBorderFromCustomAdded(e,n,r,i){var t=this.hot.countRows(),o=this.hot.countCols();if(!(t<=e||o<=n)){let t=(0,c.createEmptyBorders)(e,n);r&&(t=(0,c.extendDefaultBorder)(t,r),(0,l.arrayEach)(this.hot.selection.highlight.customSelections,e=>{if(t.id===e.settings.id)return Object.assign(e.settings,r),t.id=e.settings.id,t.top=e.settings.top,t.bottom=e.settings.bottom,t.start=e.settings.start,t.end=e.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",(0,c.denormalizeBorder)(t)),this.insertBorderIntoSettings(t,i)}}prepareBorderFromCustomAddedRange(i,o){var e=Math.min(i.to.row,this.hot.countRows()-1);const t=Math.min(i.to.col,this.hot.countCols()-1);(0,a.rangeEach)(i.from.row,e,r=>{(0,a.rangeEach)(i.from.col,t,e=>{var t=(0,c.createEmptyBorders)(r,e);let n=0;r===i.from.row&&(0,s.hasOwnProperty)(o,"top")&&(n+=1,t.top=o.top),r===i.to.row&&(0,s.hasOwnProperty)(o,"bottom")&&(n+=1,t.bottom=o.bottom),e===i.from.col&&(0,s.hasOwnProperty)(o,"start")&&(n+=1,t.start=o.start),e===i.to.col&&(0,s.hasOwnProperty)(o,"end")&&(n+=1,t.end=o.end),0<n&&(this.hot.setCellMeta(r,e,"borders",(0,c.denormalizeBorder)(t)),this.insertBorderIntoSettings(t))})})}removeAllBorders(e,t){var n=(0,c.createId)(e,t);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,n,r){let i=this.hot.getCellMeta(e,t).borders;i=i&&void 0!==i.border?(0,c.normalizeBorder)(i):(0,c.createEmptyBorders)(e,t),r?(i[n]=(0,c.createSingleEmptyBorder)(),4===this.countHide(i)?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(i,n,r)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,t,"borders",(0,c.denormalizeBorder)(i)))):(i[n]=(0,c.createDefaultCustomBorder)(),this.checkCustomSelectionsFromContextMenu(i,n,r)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,t,"borders",(0,c.denormalizeBorder)(i)))}prepareBorder(e,t,i){(0,l.arrayEach)(e,e=>{let{start:n,end:r}=e;if(n.row===r.row&&n.col===r.col)"noBorders"===t?this.removeAllBorders(n.row,n.col):this.setBorder(n.row,n.col,t,i);else switch(t){case"noBorders":(0,a.rangeEach)(n.col,r.col,t=>{(0,a.rangeEach)(n.row,r.row,e=>{this.removeAllBorders(e,t)})});break;case"top":(0,a.rangeEach)(n.col,r.col,e=>{this.setBorder(n.row,e,t,i)});break;case"bottom":(0,a.rangeEach)(n.col,r.col,e=>{this.setBorder(r.row,e,t,i)});break;case"start":(0,a.rangeEach)(n.row,r.row,e=>{this.setBorder(e,n.col,t,i)});break;case"end":(0,a.rangeEach)(n.row,r.row,e=>{this.setBorder(e,r.col,t,i)})}})}createCustomBorders(e){(0,l.arrayEach)(e,e=>{var t=(0,c.normalizeBorder)(e);e.range?this.prepareBorderFromCustomAddedRange(e.range,t):this.prepareBorderFromCustomAdded(e.row,e.col,t)})}countHide(e){var{top:e,bottom:t,start:n,end:r}=e;return(0,l.arrayReduce)([e,t,n,r],(e,t)=>{let n=e;return t&&t.hide&&(n+=1),n},0)}clearBordersFromSelectionSettings(e){e=(0,l.arrayMap)(this.hot.selection.highlight.customSelections,e=>e.settings.id).indexOf(e);-1<e&&this.hot.selection.highlight.customSelections[e].clear()}clearNullCellRange(){(0,l.arrayEach)(this.hot.selection.highlight.customSelections,(e,t)=>{if(null===e.cellRange)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){(0,l.arrayEach)(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){e=(0,l.arrayMap)(this.savedBorders,e=>e.id).indexOf(e);-1<e&&this.savedBorders.splice(e,1)}checkSavedBorders(n){let r=!1;return 4===this.countHide(n)?(this.spliceBorder(n.id),r=!0):(0,l.arrayEach)(this.savedBorders,(e,t)=>{if(n.id===e.id)return this.savedBorders[t]=n,!(r=!0)}),r}checkCustomSelectionsFromContextMenu(t,n,r){let i=!1;return(0,l.arrayEach)(this.hot.selection.highlight.customSelections,e=>{if(t.id===e.settings.id)return(0,s.objectEach)(e.instanceBorders,e=>{e.toggleHiddenClass(n,r)}),!(i=!0)}),i}checkCustomSelections(t,n,r){var e=this.countHide(t);let i=!1;return 4===e?(this.removeAllBorders(t.row,t.col),i=!0):(0,l.arrayEach)(this.hot.selection.highlight.customSelections,e=>{if(t.id===e.settings.id)return e.visualCellRange=n,e.commit(),r&&(0,s.objectEach)(e.instanceBorders,e=>{e.changeBorderStyle(r,t)}),!(i=!0)}),i}changeBorderSettings(){var e,t=this.hot.getSettings()[f];Array.isArray(t)?(e=(0,s.deepClone)(t),this.checkSettingsCohesion(e),e.length||(this.savedBorders=e),this.createCustomBorders(e)):void 0!==t&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){var t=(0,c.hasLeftRightTypeOptions)(e),e=(0,c.hasStartEndTypeOptions)(e);if(t&&e)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}onAfterContextMenuDefaultOptions(e){this.hot.getSettings()[f]&&e.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_BORDERS)},disabled(){return this.selection.isSelectedByCorner()},submenu:{items:[(0,u.top)(this),(0,u.right)(this),(0,u.bottom)(this),(0,u.left)(this),(0,u.noBorders)(this)]}})}onAfterInit(){this.changeBorderSettings()}destroy(){super.destroy()}}t.CustomBorders=p},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,r(n(764))),i=(t.bottom=i.default,r(n(766))),i=(t.left=i.default,r(n(767))),i=(t.noBorders=i.default,r(n(768))),i=(t.right=i.default,r(n(769)));t.top=i.default},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(r){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_BORDERS_BOTTOM);var t=(0,o.checkSelectionBorders)(this,"bottom");return e=t?(0,o.markSelected)(e):e},callback(e,t){var n=(0,o.checkSelectionBorders)(this,"bottom");r.prepareBorder(t,"bottom",n)}}};var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),o=n(765);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}},(e,t,n)=>{"use strict";t.__esModule=!0,t.checkSelectionBorders=function(n,r){let i=!1;return(0,s.arrayEach)(n.getSelectedRange(),e=>{e.forAll((e,t)=>{return e<0||t<0||!(e=n.getCellMeta(e,t).borders)||r&&(0,o.hasOwnProperty)(e[r],"hide")&&!1!==e[r].hide?void 0:!(i=!0)})}),i},t.createDefaultCustomBorder=a,t.createDefaultHtBorder=u,t.createEmptyBorders=function(e,t){return{id:i(e,t),border:u(),row:e,col:t,top:l(),bottom:l(),start:l(),end:l()}},t.createId=i,t.createSingleEmptyBorder=l,t.denormalizeBorder=function(e){(0,r.isDefined)(e.start)&&(e.left=e.start);(0,r.isDefined)(e.end)&&(e.right=e.end);return e},t.extendDefaultBorder=function(e,t){(0,o.hasOwnProperty)(t,"border")&&t.border&&(e.border=t.border);(0,o.hasOwnProperty)(t,"top")&&(0,r.isDefined)(t.top)&&(t.top?(0,o.isObject)(t.top)||(t.top=a()):t.top=l(),e.top=t.top);(0,o.hasOwnProperty)(t,"bottom")&&(0,r.isDefined)(t.bottom)&&(t.bottom?(0,o.isObject)(t.bottom)||(t.bottom=a()):t.bottom=l(),e.bottom=t.bottom);(0,o.hasOwnProperty)(t,"start")&&(0,r.isDefined)(t.start)&&(t.start?(0,o.isObject)(t.start)||(t.start=a()):t.start=l(),e.start=t.start);(0,o.hasOwnProperty)(t,"end")&&(0,r.isDefined)(t.end)&&(t.end?(0,o.isObject)(t.end)||(t.end=a()):t.end=l(),e.end=t.end);return e},t.hasLeftRightTypeOptions=function(e){return e.some(e=>(0,r.isDefined)(e.left)||(0,r.isDefined)(e.right))},t.hasStartEndTypeOptions=function(e){return e.some(e=>(0,r.isDefined)(e.start)||(0,r.isDefined)(e.end))},t.markSelected=function(e){return`<span class="selected">${String.fromCharCode(10003)}</span>`+e},t.normalizeBorder=function(e){var t;((0,r.isDefined)(e.start)||(0,r.isDefined)(e.left))&&(e.start=null!=(t=e.start)?t:e.left);((0,r.isDefined)(e.end)||(0,r.isDefined)(e.right))&&(e.end=null!=(t=e.end)?t:e.right);return delete e.left,delete e.right,e},t.toInlinePropName=function(e){var t;return null!=(t=c.get(e))?t:e};var o=n(447),r=n(305),s=n(444);function i(e,t){return`border_row${e}col`+t}function a(){return{width:1,color:"#000"}}function l(){return{hide:!0}}function u(){return{width:1,color:"#000",cornerVisible:!1}}const c=new Map([["left","start"],["right","end"]])},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(r){const i=r.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_BORDERS_LEFT);var t=(0,s.checkSelectionBorders)(this,i);return e=t?(0,s.markSelected)(e):e},callback(e,t){var n=(0,s.checkSelectionBorders)(this,i);r.prepareBorder(t,i,n)}}};var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=a(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),s=n(765);function a(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(a=function(e){return e?n:t})(e))}},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(n){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback(e,t){n.prepareBorder(t,"noBorders")},disabled(){return!(0,i.checkSelectionBorders)(this)}}};var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),i=n(765);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(r){const i=r.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let e=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_BORDERS_RIGHT);var t=(0,s.checkSelectionBorders)(this,i);return e=t?(0,s.markSelected)(e):e},callback(e,t){var n=(0,s.checkSelectionBorders)(this,i);r.prepareBorder(t,i,n)}}};var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=a(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),s=n(765);function a(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(a=function(e){return e?n:t})(e))}},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(r){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_BORDERS_TOP);var t=(0,o.checkSelectionBorders)(this,"top");return e=t?(0,o.markSelected)(e):e},callback(e,t){var n=(0,o.checkSelectionBorders)(this,"top");r.prepareBorder(t,"top",n)}}};var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),o=n(765);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(771);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.DragToScroll=n.DragToScroll},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(688)),o=r(n(457)),s=n(452),a=n(302);const l="dragToScroll";t.PLUGIN_KEY=l;t.PLUGIN_PRIORITY=100;class u extends i.BasePlugin{static get PLUGIN_KEY(){return l}static get PLUGIN_PRIORITY(){return 100}constructor(e){super(e),this.eventManager=new o.default(this),this.boundaries=null,this.callback=null,this.listening=!1}isEnabled(){return!!this.hot.getSettings()[l]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>this.setupListening(e)),this.addHook("afterOnCellCornerMouseDown",e=>this.setupListening(e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let n=0,r=0;t<this.boundaries.top?r=t-this.boundaries.top:t>this.boundaries.bottom&&(r=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){var e=this.hot["rootWindow"];let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",e=>this.onMouseMove(e)),t=(0,a.getParentWindow)(t)}unregisterEvents(){this.eventManager.clear()}setupListening(e){if(!(0,s.isRightClick)(e)){const n=this.hot.view._wt.wtTable.holder;n!==this.hot.rootWindow&&(this.setBoundaries(n.getBoundingClientRect()),this.setCallback((e,t)=>{e<0?n.scrollLeft-=50:0<e&&(n.scrollLeft+=50),t<0?n.scrollTop-=20:0<t&&(n.scrollTop+=20)}),this.listen())}}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}t.DragToScroll=u},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(773);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.DropdownMenu=n.DropdownMenu},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(688)),o=n(444),s=r(n(729)),a=r(n(457)),l=n(302),u=r(n(732)),c=r(n(746)),r=r(n(454)),d=n(733);n(774),r.default.getSingleton().register("afterDropdownMenuDefaultOptions"),r.default.getSingleton().register("beforeDropdownMenuShow"),r.default.getSingleton().register("afterDropdownMenuShow"),r.default.getSingleton().register("afterDropdownMenuHide"),r.default.getSingleton().register("afterDropdownMenuExecute");const h="dropdownMenu",f=(t.PLUGIN_KEY=h,t.PLUGIN_PRIORITY=230,"changeType");class p extends i.BasePlugin{static get PLUGIN_KEY(){return h}static get PLUGIN_PRIORITY(){return 230}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[d.COLUMN_LEFT,d.COLUMN_RIGHT,d.SEPARATOR,d.REMOVE_COLUMN,d.SEPARATOR,d.CLEAR_COLUMN,d.SEPARATOR,d.READ_ONLY,d.SEPARATOR,d.ALIGNMENT]}constructor(e){super(e),this.eventManager=new a.default(this),this.commandExecutor=new s.default(this.hot),this.itemsFactory=null,this.menu=null,this.hot.addHook("afterGetColHeader",(e,t)=>this.onAfterGetColHeader(e,t))}isEnabled(){return this.hot.getSettings()[h]}enablePlugin(){var r=this;if(!this.enabled){this.itemsFactory=new u.default(this.hot,p.DEFAULT_ITEMS);const t=this.hot.getSettings()[h],n={items:this.itemsFactory.getItems(t)};this.registerEvents(),"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);var e=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new c.default(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",e),this.menu.setMenuItems(e),this.menu.addLocalHook("beforeOpen",()=>this.onMenuBeforeOpen()),this.menu.addLocalHook("afterOpen",()=>this.onMenuAfterOpen()),this.menu.addLocalHook("afterClose",()=>this.onMenuAfterClose()),this.menu.addLocalHook("executeCommand",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.executeCommand.call(r,...t)}),(0,o.arrayEach)(e,e=>this.commandExecutor.registerCommand(e.key,e))})}}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),super.disablePlugin()}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>this.onTableClick(e))}open(e){this.menu&&(this.menu.open(),e.width&&this.menu.setOffset("left",e.width),this.menu.setPosition(e))}close(){this.menu&&this.menu.close()}executeCommand(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.commandExecutor.execute(e,...n)}setListening(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}onTableClick(n){if(n.stopPropagation(),(0,l.hasClass)(n.target,f)&&!this.menu.isOpened()){let e=0,t=0;this.hot.rootDocument!==this.menu.container.ownerDocument&&(i=this.hot.rootWindow["frameElement"],{top:i,left:r}=i.getBoundingClientRect(),e=i,t=r);var r,i=n.target.getBoundingClientRect();this.open({left:i.left+t,top:i.top+n.target.offsetHeight+3+e,width:i.width,height:i.height})}}onAfterGetColHeader(e,t){var n,r=t.parentNode;r&&(n=r.parentNode.childNodes,r=Array.prototype.indexOf.call(n,r),e<0||r!==n.length-1||(e=t.querySelector("."+f),this.enabled&&e)||(this.enabled?((r=this.hot.rootDocument.createElement("button")).className=f,r.type="button",r.onclick=function(){return!1},t.firstChild.insertBefore(r,t.firstChild.firstChild)):e&&e.parentNode.removeChild(e)))}onMenuBeforeOpen(){this.hot.runHooks("beforeDropdownMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterDropdownMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}(t.DropdownMenu=p).SEPARATOR={name:d.SEPARATOR}},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(776);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.ExportFile=n.ExportFile},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(273),n(688)),o=r(n(777)),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=a(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(778));function a(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(a=function(e){return e?n:t})(e))}const l="exportFile";t.PLUGIN_KEY=l;t.PLUGIN_PRIORITY=240;class u extends i.BasePlugin{static get PLUGIN_KEY(){return l}static get PLUGIN_PRIORITY(){return 240}isEnabled(){return!0}exportAsString(e){return this._createTypeFormatter(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).export()}exportAsBlob(e){return this._createBlob(this._createTypeFormatter(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}))}downloadFile(e){var{rootDocument:t,rootWindow:n}=this.hot,e=this._createTypeFormatter(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}),r=this._createBlob(e);const i=n.URL||n.webkitURL;n=t.createElement("a"),e=e.options.filename+"."+e.options.fileExtension;if(void 0!==n.download){const o=i.createObjectURL(r);n.style.display="none",n.setAttribute("href",o),n.setAttribute("download",e),t.body.appendChild(n),n.dispatchEvent(new MouseEvent("click")),t.body.removeChild(n),setTimeout(()=>{i.revokeObjectURL(o)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(r,e)}_createTypeFormatter(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(s.EXPORT_TYPES[e])return(0,s.default)(e,new o.default(this.hot),t);throw new Error(`Export format type "${e}" is not supported.`)}_createBlob(e){let t=null;return t="undefined"!=typeof Blob?new Blob([e.export()],{type:e.options.mimeType+";charset="+e.options.encoding}):t}}t.ExportFile=u},(e,t,n)=>{"use strict";t.__esModule=!0,n(203);var a=n(461);t.default=class{constructor(e){this.hot=e,this.options={}}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:r,endRow:t,endCol:i}=this._getDataRange(),o=this.options,s=[];return(0,a.rangeEach)(e,t,t=>{const n=[];!o.exportHiddenRows&&this._isHiddenRow(t)||((0,a.rangeEach)(r,i,e=>{!o.exportHiddenColumns&&this._isHiddenColumn(e)||n.push(this.hot.getDataAtCell(t,e))}),s.push(n))}),s}getRowHeaders(){const t=[];if(this.options.rowHeaders){var{startRow:e,endRow:n}=this._getDataRange();const r=this.hot.getRowHeader();(0,a.rangeEach)(e,n,e=>{!this.options.exportHiddenRows&&this._isHiddenRow(e)||t.push(r[e])})}return t}getColumnHeaders(){const t=[];if(this.options.columnHeaders){var{startCol:e,endCol:n}=this._getDataRange();const r=this.hot.getColHeader();(0,a.rangeEach)(e,n,e=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(e)||t.push(r[e])})}return t}_getDataRange(){var e=this.hot.countCols()-1,t=this.hot.countRows()-1,[n=0,r=0,i=t,o=e]=this.options.range;return{startRow:Math.max(n,0),startCol:Math.max(r,0),endRow:Math.min(i,t),endCol:Math.min(o,e)}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}},(e,t,n)=>{"use strict";var r=n(196),r=(t.__esModule=!0,t.default=function(e,t,n){return"function"!=typeof i[e]?null:new i[e](t,n)},r(n(779)));t.TYPE_CSV="csv",t.TYPE_EXCEL="excel";t.TYPE_PDF="pdf";const i={csv:r.default};t.EXPORT_TYPES=i},(e,t,n)=>{"use strict";var r=n(196),a=(t.__esModule=!0,n(444)),i=n(305),r=r(n(780));const o=String.fromCharCode(13),s=String.fromCharCode(34),l=String.fromCharCode(10);class u extends r.default{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}export(){const n=this.options;var e=this.dataProvider.getData(),t=this.dataProvider.getColumnHeaders(),r=0<t.length;const i=this.dataProvider.getRowHeaders(),o=0<i.length;let s=n.bom?String.fromCharCode(65279):"";return r&&(t=(0,a.arrayMap)(t,e=>this._escapeCell(e,!0)),o&&(s+=n.columnDelimiter),s=(s+=t.join(n.columnDelimiter))+n.rowDelimiter),(0,a.arrayEach)(e,(e,t)=>{0<t&&(s+=n.rowDelimiter),o&&(s+=this._escapeCell(i[t])+n.columnDelimiter),s+=e.map(e=>this._escapeCell(e)).join(n.columnDelimiter)}),s}_escapeCell(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];let n=(0,i.stringify)(e);return n=""!==n&&(t||0<=n.indexOf(o)||0<=n.indexOf(s)||0<=n.indexOf(l)||0<=n.indexOf(this.options.columnDelimiter))?`"${n=n.replace(new RegExp('"',"g"),'""')}"`:n}}t.default=u},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(447),i=n(303);t.default=class o{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){var t=(0,r.clone)(this.constructor.DEFAULT_OPTIONS),n=new Date,t=(0,r.extend)((0,r.clone)(o.DEFAULT_OPTIONS),t);return(t=(0,r.extend)(t,e)).filename=(0,i.substitute)(t.filename,{YYYY:n.getFullYear(),MM:(""+(n.getMonth()+1)).padStart(2,"0"),DD:(""+n.getDate()).padStart(2,"0")}),t}}},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(782);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.Filters=n.Filters},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),n(688)),o=n(444),s=n(443),a=n(455),l=n(461),u=r(n(457)),c=n(302),d=n(733),h=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=S(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),f=r(n(783)),p=r(n(818)),g=r(n(820)),m=r(n(823)),y=r(n(824)),v=r(n(825)),b=r(n(826)),E=n(808),C=n(785),w=n(543);function S(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(S=function(e){return e?n:t})(e))}n(827);const T="filters";t.PLUGIN_KEY=T;t.PLUGIN_PRIORITY=250;class R extends i.BasePlugin{static get PLUGIN_KEY(){return T}static get PLUGIN_PRIORITY(){return 250}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),this.eventManager=new u.default(this),this.dropdownMenuPlugin=null,this.conditionCollection=null,this.conditionUpdateObserver=null,this.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),this.filtersRowsMap=null,this.hot.addHook("afterGetColHeader",(e,t)=>this.onAfterGetColHeader(e,t))}isEnabled(){return!!this.hot.getSettings()[T]}enablePlugin(){var e,t,n,r;this.enabled||(this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new w.TrimmingMap),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu"),e=(e=this.hot.getSettings().dropdownMenu)&&e.uiContainer||this.hot.rootDocument.body,t=t=>(t.addLocalHook("accept",()=>this.onActionBarSubmit("accept")),t.addLocalHook("cancel",()=>this.onActionBarSubmit("cancel")),t.addLocalHook("change",e=>this.onComponentChange(t,e)),t),r=()=>this.hot.getTranslatedPhrase(h.FILTERS_DIVS_FILTER_BY_CONDITION)+":",n=()=>this.hot.getTranslatedPhrase(h.FILTERS_DIVS_FILTER_BY_VALUE)+":",this.components.get("filter_by_condition")||((r=new f.default(this.hot,{id:"filter_by_condition",name:r,addSeparator:!1,menuContainer:e})).addLocalHook("afterClose",()=>this.onSelectUIClosed()),this.components.set("filter_by_condition",t(r))),this.components.get("filter_operators")||this.components.set("filter_operators",new p.default(this.hot,{id:"filter_operators",name:"Operators"})),this.components.get("filter_by_condition2")||((r=new f.default(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:e})).addLocalHook("afterClose",()=>this.onSelectUIClosed()),this.components.set("filter_by_condition2",t(r))),this.components.get("filter_by_value")||this.components.set("filter_by_value",t(new g.default(this.hot,{id:"filter_by_value",name:n}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",t(new m.default(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new y.default(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new b.default(this.hot,this.conditionCollection,e=>this.getDataMapAtColumn(e)),this.conditionUpdateObserver.addLocalHook("update",e=>this.updateComponents(e))),this.components.forEach(e=>e.show()),this.addHook("beforeDropdownMenuSetItems",e=>this.onBeforeDropdownMenuSetItems(e)),this.addHook("afterDropdownMenuDefaultOptions",e=>this.onAfterDropdownMenuDefaultOptions(e)),this.addHook("afterDropdownMenuShow",()=>this.onAfterDropdownMenuShow()),this.addHook("afterDropdownMenuHide",()=>this.onAfterDropdownMenuHide()),this.addHook("afterChange",e=>this.onAfterChange(e)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),super.enablePlugin())}disablePlugin(){var e;this.enabled&&(null!=(e=this.dropdownMenuPlugin)&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((e,t)=>{e.destroy(),this.components.set(t,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.disablePlugin()}addCondition(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:C.OPERATION_AND,e=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(e,{command:{key:t},args:n},r)}removeConditions(e){e=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(e)}clearConditions(e){void 0===e?this.conditionCollection.clean():(e=this.hot.toPhysicalColumn(e),this.conditionCollection.removeConditions(e))}filter(){const e=this._createDataFilter();var t=!this.conditionCollection.isEmpty();let n=[];var r=this.conditionCollection.exportAllConditions();if(!1!==this.hot.runHooks("beforeFilter",r))if(t){const i=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),n=(0,o.arrayMap)(e.filter(),e=>e.meta.visualRow);const t=(0,E.createArrayAssertion)(n);(0,l.rangeEach)(this.hot.countSourceRows()-1,e=>{t(e)||i.push(e)}),(0,o.arrayEach)(i,e=>{this.filtersRowsMap.setValueAtIndex(e,!0)})},!0),n.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",r),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}getSelectedColumn(){var e=null==(e=this.hot.getSelectedRangeLast())?void 0:e.highlight;return e?{visualIndex:e.col,physicalIndex:this.hot.toPhysicalColumn(e.col)}:null}clearColumnSelection(){var e=this.getSelectedColumn();null!==e&&this.hot.selectCell(0,e.visualIndex)}getDataMapAtColumn(e){const c=this.hot.toVisualColumn(e),d=[];return(0,o.arrayEach)(this.hot.getSourceDataAtCol(c),(e,t)=>{var{row:n,col:r,visualCol:i,visualRow:o,type:s,instance:a,dateFormat:l,locale:u}=this.hot.getCellMeta(t,c),t=null!=(t=this.hot.getDataAtCell(this.hot.toVisualRow(t),c))?t:e;d.push({meta:{row:n,col:r,visualCol:i,visualRow:o,type:s,instance:a,dateFormat:l,locale:u},value:(0,E.toEmptyString)(t)})}),d}onAfterChange(e){e&&(0,o.arrayEach)(e,e=>{var[,e]=e,e=this.hot.propToCol(e);this.conditionCollection.hasConditions(e)&&this.updateValueComponentCondition(e)})}updateValueComponentCondition(e){var t=this.hot.getDataAtCol(e),t=(0,E.unifyColumnValues)(t);this.conditionUpdateObserver.updateStatesAtColumn(e,t)}restoreComponents(e){var t;const n=null==(t=this.getSelectedColumn())?void 0:t.physicalIndex;e.forEach(e=>{e.isHidden()||e.restoreState(n)}),this.updateDependentComponentsVisibility()}onAfterDropdownMenuShow(){this.restoreComponents(Array.from(this.components.values()))}onAfterDropdownMenuHide(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}onBeforeDropdownMenuSetItems(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",()=>{this.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}onAfterDropdownMenuDefaultOptions(t){t.items.push({name:d.SEPARATOR}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}getOperationBasedOnArguments(e,t,n,r){let i=e;return i===C.OPERATION_OR&&t.command.key!==C.CONDITION_NONE&&n.command.key!==C.CONDITION_NONE&&r.command.key!==C.CONDITION_NONE?i=C.OPERATION_OR_THEN_VARIABLE:r.command.key===C.CONDITION_NONE||t.command.key!==C.CONDITION_NONE&&n.command.key!==C.CONDITION_NONE||(i=C.OPERATION_AND),i}onActionBarSubmit(t){if("accept"===t){t=this.getSelectedColumn();if(null===t)return void(null!=(n=this.dropdownMenuPlugin)&&n.close());const o=t["physicalIndex"];var n=this.components.get("filter_by_condition").getState(),t=this.components.get("filter_by_condition2").getState(),r=this.components.get("filter_by_value").getState(),i=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),n,t,r);this.conditionUpdateObserver.groupChanges();let e=this.conditionCollection.getColumnStackPosition(o);-1===e&&(e=void 0),this.conditionCollection.removeConditions(o),n.command.key!==C.CONDITION_NONE&&(this.conditionCollection.addCondition(o,n,i,e),t.command.key!==C.CONDITION_NONE)&&this.conditionCollection.addCondition(o,t,i,e),r.command.key!==C.CONDITION_NONE&&this.conditionCollection.addCondition(o,r,i,e),this.conditionUpdateObserver.flush(),this.components.forEach(e=>e.saveState(o)),this.filtersRowsMap.clear(),this.filter()}null!=(n=this.dropdownMenuPlugin)&&n.close()}onComponentChange(e,t){this.updateDependentComponentsVisibility(),e.constructor!==f.default||t.inputsCount||this.setListeningDropdownMenu()}onSelectUIClosed(){this.setListeningDropdownMenu()}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){var e=this.components.get("filter_by_condition").getState()["command"],t=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];e.showOperators?this.showComponents(...t):this.hideComponents(...t)}onAfterGetColHeader(e,t){e=this.hot.toPhysicalColumn(e);(this.enabled&&this.conditionCollection.hasConditions(e)?(0,c.addClass):(0,c.removeClass))(t,"htFiltersActive")}_createDataFilter(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new v.default(e,e=>this.getDataMapAtColumn(e))}updateComponents(e){var t,n,r;null!=(n=this.dropdownMenuPlugin)&&n.enabled&&({conditions:n,column:t}=e["editedConditionStack"],r=n.filter(e=>e.name===C.CONDITION_BY_VALUE),n=n.filter(e=>e.name!==C.CONDITION_BY_VALUE),2<=r.length||3<=n.length?(0,a.warn)((0,s.toSingleLine)`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`):(r=this.conditionCollection.getOperation(t),this.components.get("filter_by_condition").updateState(n[0],t),this.components.get("filter_by_condition2").updateState(n[1],t),this.components.get("filter_operators").updateState(r,t),this.components.get("filter_by_value").updateState(e)))}getIndexesOfComponents(){const r=[];if(this.dropdownMenuPlugin){const i=this.dropdownMenuPlugin.menu;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];(0,o.arrayEach)(t,n=>{(0,o.arrayEach)(i.menuItems,(e,t)=>{e.key===n.getMenuItemDescriptor().key&&r.push(t)})})}return r}changeComponentsVisibility(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];if(this.dropdownMenuPlugin){for(var t=this.dropdownMenuPlugin.menu.hotMenu,n=t.getPlugin("hiddenRows"),r=arguments.length,i=new Array(1<r?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var s=this.getIndexesOfComponents(...i);e?n.showRows(s):n.hideRows(s),t.render()}}hideComponents(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{null!==e&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}t.Filters=R},(e,t,n)=>{"use strict";var r=n(196),a=(t.__esModule=!0,n(203),n(302)),i=n(452),l=n(444),o=n(451),s=n(447),u=m(n(568)),c=r(n(784)),d=m(n(785)),h=r(n(815)),f=r(n(817)),p=n(786);function g(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(g=function(e){return e?n:t})(e))}function m(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=g(t);if(t&&t.has(e))return t.get(e);var n,r,i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((r=o?Object.getOwnPropertyDescriptor(e,n):null)&&(r.get||r.set)?Object.defineProperty(i,n,r):i[n]=e[n]);return i.default=e,t&&t.set(e,i),i}class y extends c.default{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new f.default(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new h.default(this.hot,{placeholder:u.FILTERS_BUTTONS_PLACEHOLDER_VALUE})),this.elements.push(new h.default(this.hot,{placeholder:u.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>this.onConditionSelect(e)),this.getSelectElement().addLocalHook("afterClose",()=>this.onSelectUIClosed()),(0,l.arrayEach)(this.getInputElements(),e=>{e.addLocalHook("keydown",e=>this.onInputKeyDown(e))})}setState(e){if(this.reset(),e){const r=(0,s.clone)(e.command);r.name.startsWith(u.FILTERS_CONDITIONS_NAMESPACE)&&(r.name=this.hot.getTranslatedPhrase(r.name)),this.getSelectElement().setValue(r),(0,l.arrayEach)(e.args,(e,t)=>{if(t>r.inputsCount-1)return!1;const n=this.getInputElement(t);n.setValue(e),n[r.inputsCount>t?"show":"hide"](),t||setTimeout(()=>n.focus(),10)})}}getState(){const n=this.getSelectElement().getValue()||(0,p.getConditionDescriptor)(d.CONDITION_NONE),r=[];return(0,l.arrayEach)(this.getInputElements(),(e,t)=>{n.inputsCount>t&&r.push(e.getValue())}),{command:n,args:r}}updateState(e,t){var n=e?(0,p.getConditionDescriptor)(e.name):(0,p.getConditionDescriptor)(d.CONDITION_NONE);this.state.setValueAtIndex(t,{command:n,args:e?e.args:[]}),e||(0,l.arrayEach)(this.getInputElements(),e=>e.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof f.default)[0]}getInputElement(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof h.default)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,n,r,i,o)=>{(0,a.addClass)(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&(0,a.addClass)(t.parentNode,"border");var s=this.hot.rootDocument.createElement("div");return(0,a.addClass)(s,"htFiltersMenuLabel"),s.textContent=o,t.appendChild(s),t.parentNode.hasAttribute("ghost-table")||(0,l.arrayEach)(this.elements,e=>t.appendChild(e.element)),t}}}reset(){var e=this.hot.getPlugin("filters").getSelectedColumn();let t=[(0,p.getConditionDescriptor)(d.CONDITION_NONE)];null!==e&&(e=e["visualIndex"],t=(0,d.default)(this.hot.getDataType(0,e,this.hot.countRows(),e))),(0,l.arrayEach)(this.getInputElements(),e=>e.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}onConditionSelect(n){(0,l.arrayEach)(this.getInputElements(),(e,t)=>{e[n.inputsCount>t?"show":"hide"](),0===t&&setTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",n)}onSelectUIClosed(){this.runLocalHooks("afterClose")}onInputKeyDown(e){(0,o.isKey)(e.keyCode,"ENTER")?(this.runLocalHooks("accept"),(0,i.stopImmediatePropagation)(e)):(0,o.isKey)(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,i.stopImmediatePropagation)(e))}}t.default=y},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(273),n(444)),o=n(447),r=r(n(549)),s=n(543);class a{constructor(e,t){var{id:t,stateless:n=!0}=t;this.hot=e,this.id=t,this.elements=[],this.hidden=!1,this.stateId="Filters.component."+this.id,this.state=n?null:this.hot.columnIndexMapper.registerMap(this.stateId,new s.LinkedPhysicalIndexToValueMap)}reset(){(0,i.arrayEach)(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),(0,i.arrayEach)(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}(0,o.mixin)(a,r.default),t.default=a},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(e){const n=[];let t=e;x[t]||(t=N);return(0,i.arrayEach)(x[t],e=>{let t;t=e===o.SEPARATOR?{name:o.SEPARATOR}:(0,r.clone)((0,s.getConditionDescriptor)(e)),n.push(t)}),n},n(203);var r=n(447),i=n(444),o=n(733),s=n(786),a=n(787),l=(t.CONDITION_NONE=a.CONDITION_NAME,n(788)),u=(t.CONDITION_EMPTY=l.CONDITION_NAME,n(789)),c=(t.CONDITION_NOT_EMPTY=u.CONDITION_NAME,n(790)),d=(t.CONDITION_EQUAL=c.CONDITION_NAME,n(791)),h=(t.CONDITION_NOT_EQUAL=d.CONDITION_NAME,n(792)),f=(t.CONDITION_GREATER_THAN=h.CONDITION_NAME,n(793)),p=(t.CONDITION_GREATER_THAN_OR_EQUAL=f.CONDITION_NAME,n(794)),g=(t.CONDITION_LESS_THAN=p.CONDITION_NAME,n(795)),m=(t.CONDITION_LESS_THAN_OR_EQUAL=g.CONDITION_NAME,n(796)),y=(t.CONDITION_BETWEEN=m.CONDITION_NAME,n(799)),v=(t.CONDITION_NOT_BETWEEN=y.CONDITION_NAME,n(800)),b=(t.CONDITION_BEGINS_WITH=v.CONDITION_NAME,n(801)),E=(t.CONDITION_ENDS_WITH=b.CONDITION_NAME,n(802)),C=(t.CONDITION_CONTAINS=E.CONDITION_NAME,n(803)),w=(t.CONDITION_NOT_CONTAINS=C.CONDITION_NAME,n(798)),S=(t.CONDITION_DATE_BEFORE=w.CONDITION_NAME,n(797)),T=(t.CONDITION_DATE_AFTER=S.CONDITION_NAME,n(804)),R=(t.CONDITION_TOMORROW=T.CONDITION_NAME,n(805)),A=(t.CONDITION_TODAY=R.CONDITION_NAME,n(806)),_=(t.CONDITION_YESTERDAY=A.CONDITION_NAME,n(807)),_=(t.CONDITION_BY_VALUE=_.CONDITION_NAME,n(809)),_=(t.CONDITION_TRUE=_.CONDITION_NAME,n(810)),_=(t.CONDITION_FALSE=_.CONDITION_NAME,n(811)),_=(t.OPERATION_AND=_.OPERATION_ID,n(813)),_=(t.OPERATION_OR=_.OPERATION_ID,n(814));t.OPERATION_OR_THEN_VARIABLE=_.OPERATION_ID;t.TYPE_NUMERIC="numeric";const N="text";t.TYPE_TEXT=N;t.TYPE_DATE="date";const x={numeric:[a.CONDITION_NAME,o.SEPARATOR,l.CONDITION_NAME,u.CONDITION_NAME,o.SEPARATOR,c.CONDITION_NAME,d.CONDITION_NAME,o.SEPARATOR,h.CONDITION_NAME,f.CONDITION_NAME,p.CONDITION_NAME,g.CONDITION_NAME,m.CONDITION_NAME,y.CONDITION_NAME],[N]:[a.CONDITION_NAME,o.SEPARATOR,l.CONDITION_NAME,u.CONDITION_NAME,o.SEPARATOR,c.CONDITION_NAME,d.CONDITION_NAME,o.SEPARATOR,v.CONDITION_NAME,b.CONDITION_NAME,o.SEPARATOR,E.CONDITION_NAME,C.CONDITION_NAME],date:[a.CONDITION_NAME,o.SEPARATOR,l.CONDITION_NAME,u.CONDITION_NAME,o.SEPARATOR,c.CONDITION_NAME,d.CONDITION_NAME,o.SEPARATOR,w.CONDITION_NAME,S.CONDITION_NAME,m.CONDITION_NAME,o.SEPARATOR,T.CONDITION_NAME,R.CONDITION_NAME,A.CONDITION_NAME]};t.TYPES=x},(e,t,n)=>{"use strict";t.__esModule=!0,t.getCondition=function(e,t){if(!o[e])throw Error(`Filter condition "${e}" does not exist.`);const{condition:n,descriptor:r}=o[e];let i=t;r.inputValuesDecorator&&(i=r.inputValuesDecorator(i));return function(e){return n.apply(e.meta.instance,[].concat([e],[i]))}},t.getConditionDescriptor=function(e){if(o[e])return o[e].descriptor;throw Error(`Filter condition "${e}" does not exist.`)},t.registerCondition=function(e,t,n){n.key=e,o[e]={condition:t,descriptor:n}},n(273);const o={};t.conditions=o},(e,t,n)=>{"use strict";t.__esModule=!0,t.condition=i;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),n=n(786);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function i(){return!0}t.CONDITION_NAME="none",(0,n.registerCondition)("none",i,{name:r.FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1})},(e,t,n)=>{"use strict";t.__esModule=!0,t.condition=a;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),i=n(786),o=n(305);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function a(e){return(0,o.isEmpty)(e.value)}t.CONDITION_NAME="empty",(0,i.registerCondition)("empty",a,{name:r.FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0})},(e,t,n)=>{"use strict";t.__esModule=!0,t.condition=a;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),i=n(786),o=n(788);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function a(e,t){return!(0,i.getCondition)(o.CONDITION_NAME,t)(e)}t.CONDITION_NAME="not_empty",(0,i.registerCondition)("not_empty",a,{name:r.FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0})},(e,t,n)=>{"use strict";t.__esModule=!0,t.condition=o;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),i=n(305),n=n(786);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function o(e,t){var[t]=t;return(0,i.stringify)(e.value).toLocaleLowerCase(e.meta.locale)===(0,i.stringify)(t)}t.CONDITION_NAME="eq",(0,n.registerCondition)("eq",o,{name:r.FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0})},(e,t,n)=>{"use strict";t.__esModule=!0,t.condition=a;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),i=n(786),o=n(790);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function a(e,t){return!(0,i.getCondition)(o.CONDITION_NAME,t)(e)}t.CONDITION_NAME="neq",(0,i.registerCondition)("neq",a,{name:r.FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0})},(e,t,n)=>{"use strict";t.__esModule=!0,t.condition=i;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),n=n(786);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function i(e,t){var[t]=t;let n=t;return"numeric"===e.meta.type&&(n=parseFloat(n,10)),e.value>n}t.CONDITION_NAME="gt",(0,n.registerCondition)("gt",i,{name:r.FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0})},(e,t,n)=>{"use strict";t.__esModule=!0,t.condition=i;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),n=n(786);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function i(e,t){var[t]=t;let n=t;return"numeric"===e.meta.type&&(n=parseFloat(n,10)),e.value>=n}t.CONDITION_NAME="gte",(0,n.registerCondition)("gte",i,{name:r.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0})},(e,t,n)=>{"use strict";t.__esModule=!0,t.condition=i;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),n=n(786);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function i(e,t){var[t]=t;let n=t;return"numeric"===e.meta.type&&(n=parseFloat(n,10)),e.value<n}t.CONDITION_NAME="lt",(0,n.registerCondition)("lt",i,{name:r.FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0})},(e,t,n)=>{"use strict";t.__esModule=!0,t.condition=i;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),n=n(786);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function i(e,t){var[t]=t;let n=t;return"numeric"===e.meta.type&&(n=parseFloat(n,10)),e.value<=n}t.CONDITION_NAME="lte",(0,n.registerCondition)("lte",i,{name:r.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0})},(e,t,n)=>{"use strict";t.__esModule=!0,t.condition=i;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=l(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),o=n(786),s=n(797),a=n(798);function l(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(l=function(e){return e?n:t})(e))}function i(e,t){var[t,n]=t;let r=t,i=n;if("numeric"===e.meta.type){var t=parseFloat(r,10),n=parseFloat(i,10);r=Math.min(t,n),i=Math.max(t,n)}else if("date"===e.meta.type)return t=(0,o.getCondition)(a.CONDITION_NAME,[i]),n=(0,o.getCondition)(s.CONDITION_NAME,[r]),t(e)&&n(e);return e.value>=r&&e.value<=i}t.CONDITION_NAME="between",(0,o.registerCondition)("between",i,{name:r.FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0})},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,t.condition=a,r(n(306))),r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),n=n(786);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}var o="date_after";function a(e,t){var[t]=t,n=(0,i.default)(e.value,e.meta.dateFormat),t=(0,i.default)(t,e.meta.dateFormat);return!(!n.isValid()||!t.isValid())&&0<=n.diff(t)}t.CONDITION_NAME=o,(0,n.registerCondition)(o,a,{name:r.FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0})},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,t.condition=a,r(n(306))),r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),n=n(786);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}var o="date_before";function a(e,t){var[t]=t,n=(0,i.default)(e.value,e.meta.dateFormat),t=(0,i.default)(t,e.meta.dateFormat);return!(!n.isValid()||!t.isValid())&&n.diff(t)<=0}t.CONDITION_NAME=o,(0,n.registerCondition)(o,a,{name:r.FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0})},(e,t,n)=>{"use strict";t.__esModule=!0,t.condition=a;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),i=n(786),o=n(796);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}n="not_between";function a(e,t){return!(0,i.getCondition)(o.CONDITION_NAME,t)(e)}t.CONDITION_NAME=n,(0,i.registerCondition)(n,a,{name:r.FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0})},(e,t,n)=>{"use strict";t.__esModule=!0,t.condition=a;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),i=n(305),n=n(786);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}var o="begins_with";function a(e,t){var[t]=t;return(0,i.stringify)(e.value).toLocaleLowerCase(e.meta.locale).startsWith((0,i.stringify)(t))}t.CONDITION_NAME=o,(0,n.registerCondition)(o,a,{name:r.FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0})},(e,t,n)=>{"use strict";t.__esModule=!0,t.condition=o;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),i=n(305),n=n(786);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function o(e,t){var[t]=t;return(0,i.stringify)(e.value).toLocaleLowerCase(e.meta.locale).endsWith((0,i.stringify)(t))}t.CONDITION_NAME="ends_with",(0,n.registerCondition)("ends_with",o,{name:r.FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0})},(e,t,n)=>{"use strict";t.__esModule=!0,t.condition=o;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),i=n(305),n=n(786);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}function o(e,t){var[t]=t;return 0<=(0,i.stringify)(e.value).toLocaleLowerCase(e.meta.locale).indexOf((0,i.stringify)(t))}t.CONDITION_NAME="contains",(0,n.registerCondition)("contains",o,{name:r.FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0})},(e,t,n)=>{"use strict";t.__esModule=!0,t.condition=a;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),i=n(786),o=n(802);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}n="not_contains";function a(e,t){return!(0,i.getCondition)(o.CONDITION_NAME,t)(e)}t.CONDITION_NAME=n,(0,i.registerCondition)(n,a,{name:r.FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0})},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,t.condition=a,r(n(306))),r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),n=n(786);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}var o="date_tomorrow";function a(e){e=(0,i.default)(e.value,e.meta.dateFormat);return!!e.isValid()&&e.isSame((0,i.default)().subtract(-1,"days").startOf("day"),"d")}t.CONDITION_NAME=o,(0,n.registerCondition)(o,a,{name:r.FILTERS_CONDITIONS_TOMORROW,inputsCount:0})},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,t.condition=a,r(n(306))),r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),n=n(786);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}var o="date_today";function a(e){e=(0,i.default)(e.value,e.meta.dateFormat);return!!e.isValid()&&e.isSame((0,i.default)().startOf("day"),"d")}t.CONDITION_NAME=o,(0,n.registerCondition)(o,a,{name:r.FILTERS_CONDITIONS_TODAY,inputsCount:0})},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,t.condition=a,r(n(306))),r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),n=n(786);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}var o="date_yesterday";function a(e){e=(0,i.default)(e.value,e.meta.dateFormat);return!!e.isValid()&&e.isSame((0,i.default)().subtract(1,"days").startOf("day"),"d")}t.CONDITION_NAME=o,(0,n.registerCondition)(o,a,{name:r.FILTERS_CONDITIONS_YESTERDAY,inputsCount:0})},(e,t,n)=>{"use strict";t.__esModule=!0,t.condition=o;var r=n(786),i=n(808);function o(e,t){var[t]=t;return t(e.value)}t.CONDITION_NAME="by_value",(0,r.registerCondition)("by_value",o,{name:"By value",inputsCount:0,inputValuesDecorator(e){var[e]=e;return[(0,i.createArrayAssertion)(e)]},showOperators:!1})},(e,t,n)=>{"use strict";t.__esModule=!0,t.createArrayAssertion=u,t.intersectValues=function(e,t,n,r){const i=[],o=e===t;let s;o||(s=u(t));return(0,a.arrayEach)(e,e=>{let t=!1;e={checked:t=o||s(e)?!0:t,value:e,visualValue:l(e,n)};r&&r(e),i.push(e)}),i},t.sortComparison=function(e,t){return"number"!=typeof e||"number"!=typeof t?r(e,t):e-t},t.toEmptyString=function(e){return null==e?"":e},t.toVisualValue=l,t.unifyColumnValues=function(e){let t=e;t=o?Array.from(new Set(t)):(0,a.arrayUnique)(t);return t=t.sort((e,t)=>"number"==typeof e&&"number"==typeof t?e-t:e===t?0:t<e?1:-1)},n(203);var t=n(490),a=n(444);const r=(0,t.getComparisonFunction)();function l(e,t){let n=e;return n=""===n?`(${t})`:n}const i=new Set([1]).has(1),o=i&&"function"==typeof Array.from;function u(e){let n=e;return i&&(n=new Set(n)),function(e){let t;return t=i?n.has(e):!!~n.indexOf(e)}}},(e,t,n)=>{"use strict";t.__esModule=!0,t.condition=r;n=n(786);function r(){return!0}t.CONDITION_NAME="true",(0,n.registerCondition)("true",r,{name:"True"})},(e,t,n)=>{"use strict";t.__esModule=!0,t.condition=r;n=n(786);function r(){return!1}t.CONDITION_NAME="false",(0,n.registerCondition)("false",r,{name:"False"})},(e,t,n)=>{"use strict";t.__esModule=!0,t.operationResult=o;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),n=n(812);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}var i="conjunction",r=(t.OPERATION_ID=i,r.FILTERS_LABELS_CONJUNCTION);function o(e,t){return e.every(e=>e.func(t))}t.SHORT_NAME_FOR_COMPONENT=r,(0,n.registerOperation)(i,r,o)},(e,t,n)=>{"use strict";t.__esModule=!0,t.getOperationFunc=function(e){if(!r[e])throw Error(`Operation with id "${e}" does not exist.`);const n=r[e].func;return function(e,t){return n(e,t)}},t.getOperationName=function(e){return r[e].name},t.registerOperation=function(e,t,n){r[e]={name:t,func:n}},n(273);const r={};t.operations=r},(e,t,n)=>{"use strict";t.__esModule=!0,t.operationResult=o;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),n=n(812);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}var i="disjunction",r=(t.OPERATION_ID=i,r.FILTERS_LABELS_DISJUNCTION);function o(e,t){return e.some(e=>e.func(t))}t.SHORT_NAME_FOR_COMPONENT=r,(0,n.registerOperation)(i,r,o)},(e,t,n)=>{"use strict";t.__esModule=!0,t.operationResult=o,n(273);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),n=n(812);function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}var i="disjunctionWithExtraCondition",r=(t.OPERATION_ID=i,r.FILTERS_LABELS_DISJUNCTION);function o(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(e=>e.func(t))&&e[e.length-1].func(t)}t.SHORT_NAME_FOR_COMPONENT=r,(0,n.registerOperation)(i,r,o)},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(302)),o=n(447),r=r(n(816));const s=new WeakMap;class a extends r.default{static get DEFAULTS(){return(0,o.clone)({placeholder:"",type:"text",tagName:"input"})}constructor(e,t){super(e,(0,o.extend)(a.DEFAULTS,t)),s.set(this,{}),this.registerHooks()}registerHooks(){this.addLocalHook("click",()=>this.onClick()),this.addLocalHook("keyup",e=>this.onKeyup(e))}build(){super.build();var e=s.get(this),t=this.hot.rootDocument.createElement("div");e.input=this._element.firstChild,(0,i.addClass)(this._element,"htUIInput"),(0,i.addClass)(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}update(){var e;this.isBuilt()&&((e=s.get(this).input).type=this.options.type,e.placeholder=this.translateIfPossible(this.options.placeholder),e.value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&s.get(this).input.focus()}onClick(){}onKeyup(e){this.options.value=e.target.value}}n=a;t.default=n},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(447)),o=r(n(549)),s=r(n(457)),a=n(302),l=n(444),u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=c(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function c(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(c=function(e){return e?n:t})(e))}const d="building",h=["click","input","keydown","keypress","keyup","focus","blur","change"];class f{static get DEFAULTS(){return(0,i.clone)({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){this.hot=e,this.eventManager=new s.default(this),this.options=(0,i.extend)(f.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState!==d&&("built"===this.buildState?this.update():(this.buildState=d,this.build(),this.buildState="built")),this._element}isBuilt(){return"built"===this.buildState}translateIfPossible(e){return"string"==typeof e&&e.startsWith(u.FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(e):e}build(){const t=(e,t)=>{this.eventManager.addEventListener(e,t,e=>this.runLocalHooks(t,e,this))};if(this.buildState||(this.buildState=d),this.options.className&&(0,a.addClass)(this._element,this.options.className),this.options.children.length)(0,l.arrayEach)(this.options.children,e=>this._element.appendChild(e.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);(0,i.objectEach)(this.options,(e,t)=>{void 0!==n[t]&&"className"!==t&&"tagName"!==t&&"children"!==t&&(n[t]=this.translateIfPossible(e))}),this._element.appendChild(n),(0,l.arrayEach)(h,e=>t(n,e))}else(0,l.arrayEach)(h,e=>t(this._element,e))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}(0,i.mixin)(f,o.default);r=f;t.default=r},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,r(n(746))),o=n(447),s=n(444),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=c(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),l=n(733),u=r(n(816));function c(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(c=function(e){return e?n:t})(e))}const d=new WeakMap;class h extends u.default{static get DEFAULTS(){return(0,o.clone)({className:"htUISelect",wrapIt:!1})}constructor(e,t){super(e,(0,o.extend)(h.DEFAULTS,t)),d.set(this,{}),this.menu=null,this.items=[],this.registerHooks()}registerHooks(){this.addLocalHook("click",()=>this.onClick())}setItems(e){this.items=this.translateNames(e),this.menu&&this.menu.setMenuItems(this.items)}translateNames(e){return(0,s.arrayEach)(e,e=>{e.name=this.translateIfPossible(e.name)}),e}build(){super.build(),this.menu=new i.default(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var e=new u.default(this.hot,{className:"htUISelectCaption"}),t=new u.default(this.hot,{className:"htUISelectDropdown"}),n=d.get(this);n.caption=e,n.captionElement=e.element,n.dropdown=t,(0,s.arrayEach)([e,t],e=>this._element.appendChild(e.element)),this.menu.addLocalHook("select",e=>this.onMenuSelect(e)),this.menu.addLocalHook("afterClose",()=>this.onMenuClosed()),this.update()}update(){if(this.isBuilt()){let e;e=this.options.value?this.options.value.name:this.menu.hot.getTranslatedPhrase(a.FILTERS_CONDITIONS_NONE),d.get(this).captionElement.textContent=e,super.update()}}openOptions(){var e=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}))}closeOptions(){this.menu&&this.menu.close()}onMenuSelect(e){e.name!==l.SEPARATOR&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}onMenuClosed(){this.runLocalHooks("afterClose")}onClick(){this.openOptions()}destroy(){this.menu&&(this.menu.destroy(),this.menu=null);var{caption:e,dropdown:t}=d.get(this);e&&e.destroy(),t&&t.destroy(),super.destroy()}}r=h;t.default=r},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),n(273),n(302)),o=n(444),s=n(443),a=r(n(784)),l=n(812),u=n(811),c=n(813),d=n(814),h=r(n(819));class f extends a.default{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>((0,i.addClass)(t.parentNode,"htFiltersMenuOperators"),t.parentNode.hasAttribute("ghost-table")||(0,o.arrayEach)(this.elements,e=>t.appendChild(e.element)),t)}}buildOperatorsElement(){const t=[u.OPERATION_ID,c.OPERATION_ID];(0,o.arrayEach)(t,e=>{e=new h.default(this.hot,{name:"operator",label:{htmlFor:e,textContent:(0,l.getOperationName)(e)},value:e,checked:e===t[0],id:e});e.addLocalHook("change",e=>this.onRadioInputChange(e)),this.elements.push(e)})}setChecked(n){if(this.elements.length<n)throw Error((0,s.toSingleLine)`Radio button with index ${n} doesn't exist.`);(0,o.arrayEach)(this.elements,(e,t)=>{e.setChecked(t===n)})}getActiveOperationId(){var e=this.elements.find(e=>e instanceof h.default&&e.isChecked());return e?e.getValue():u.OPERATION_ID}getState(){return this.getActiveOperationId()}setState(t){this.reset(),t&&this.getActiveOperationId()!==t&&(0,o.arrayEach)(this.elements,e=>{e.setChecked(e.getValue()===t)})}updateState(){let e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:u.OPERATION_ID;e===d.OPERATION_ID&&(e=c.OPERATION_ID),this.state.setValueAtIndex(1<arguments.length?arguments[1]:void 0,e)}reset(){this.setChecked(0)}onRadioInputChange(e){this.setState(e.target.value)}}t.default=f},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(447)),r=r(n(816));const o=new WeakMap;class s extends r.default{static get DEFAULTS(){return(0,i.clone)({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,(0,i.extend)(s.DEFAULTS,t)),o.set(this,{})}build(){super.build();var e=o.get(this),t=(e.input=this._element.firstChild,this.hot.rootDocument.createElement("label"));t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),e.label=t,this._element.appendChild(t),this.update()}update(){var e;this.isBuilt()&&((e=o.get(this)).input.checked=this.options.checked,e.label.textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.options.checked}setChecked(){this.options.checked=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],this.update()}focus(){this.isBuilt()&&o.get(this).input.focus()}}n=s;t.default=n},(e,t,n)=>{"use strict";var r=n(196),a=(t.__esModule=!0,n(203),n(302)),i=n(452),u=n(444),o=n(451),c=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=p(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),d=n(808),s=r(n(784)),l=r(n(821)),h=n(785),f=n(786);function p(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(p=function(e){return e?n:t})(e))}class g extends s.default{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.elements.push(new l.default(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>this.onInputKeyDown(e))}setState(e){var t;this.reset(),e&&e.command.key===h.CONDITION_BY_VALUE&&((t=this.getMultipleSelectElement()).setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale))}getState(){var e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?h.CONDITION_NONE:h.CONDITION_BY_VALUE},args:[e.getValue()],itemsSnapshot:t}}updateState(l){var e=(e,t,n,r,i)=>{var[t]=(0,u.arrayFilter)(t,e=>e.name===h.CONDITION_BY_VALUE),o={},s=this.hot.getTranslatedPhrase(c.FILTERS_VALUES_BLANK_CELLS);if(t){r=(0,d.unifyColumnValues)((0,u.arrayMap)(r(e,i),e=>e.value));n&&(t.args[0]=n);const a=[];i=(0,d.intersectValues)(r,t.args[0],s,e=>{e.checked&&a.push(e.value)}),n=l.editedConditionStack.column;o.locale=this.hot.getCellMeta(0,n).locale,o.args=[a],o.command=(0,f.getConditionDescriptor)(h.CONDITION_BY_VALUE),o.itemsSnapshot=i}else o.args=[],o.command=(0,f.getConditionDescriptor)(h.CONDITION_NONE);this.state.setValueAtIndex(e,o)};e(l.editedConditionStack.column,l.editedConditionStack.conditions,l.conditionArgsChange,l.filteredRowsFactory),l.dependentConditionStacks.length&&e(l.dependentConditionStacks[0].column,l.dependentConditionStacks[0].conditions,l.conditionArgsChange,l.filteredRowsFactory,l.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof l.default)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,n,r,i,o)=>{(0,a.addClass)(t.parentNode,"htFiltersMenuValue");var s=this.hot.rootDocument.createElement("div");return(0,a.addClass)(s,"htFiltersMenuLabel"),s.textContent=o,t.appendChild(s),t.parentNode.hasAttribute("ghost-table")||(0,u.arrayEach)(this.elements,e=>t.appendChild(e.element)),t}}}reset(){var e=this.hot.getTranslatedPhrase(c.FILTERS_VALUES_BLANK_CELLS),t=(0,d.unifyColumnValues)(this._getColumnVisibleValues()),e=(0,d.intersectValues)(t,t,e),e=(this.getMultipleSelectElement().setItems(e),super.reset(),this.getMultipleSelectElement().setValue(t),this.hot.getPlugin("filters").getSelectedColumn());null!==e&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,e.visualIndex).locale)}onInputKeyDown(e){(0,o.isKey)(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,i.stopImmediatePropagation)(e))}_getColumnVisibleValues(){var e=this.hot.getPlugin("filters").getSelectedColumn();return null===e?[]:(0,u.arrayMap)(this.hot.getDataAtCol(e.visualIndex),e=>(0,d.toEmptyString)(e))}}t.default=g},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),n(302)),o=n(447),s=n(444),a=n(451),l=n(445),u=n(542),c=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=m(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),d=n(452),h=r(n(816)),f=r(n(815)),p=r(n(822)),g=n(808);function m(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(m=function(e){return e?n:t})(e))}const y=new WeakMap;class v extends h.default{static get DEFAULTS(){return(0,o.clone)({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,(0,o.extend)(v.DEFAULTS,t)),y.set(this,{}),this.searchInput=new f.default(this.hot,{placeholder:c.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"}),this.selectAllUI=new p.default(this.hot,{textContent:c.FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"}),this.clearAllUI=new p.default(this.hot,{textContent:c.FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"}),this.items=[],this.itemsBox=null,this.registerHooks()}registerHooks(){this.searchInput.addLocalHook("keydown",e=>this.onInputKeyDown(e)),this.searchInput.addLocalHook("input",e=>this.onInput(e)),this.selectAllUI.addLocalHook("click",e=>this.onSelectAllClick(e)),this.clearAllUI.addLocalHook("click",e=>this.onClearAllClick(e))}setItems(e){this.items=e,this.itemsBox&&this.itemsBox.loadData(this.items)}setLocale(e){this.locale=e}getLocale(){return this.locale}getItems(){return[...this.items]}getValue(){{var e=this.items;const t=[];return(0,s.arrayEach)(e,e=>{e.checked&&t.push(e.value)}),t}}isSelectedAllValues(){return this.items.length===this.getValue().length}build(){super.build();const t=this.hot["rootDocument"],e=t.createElement("div");var n=new h.default(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(n.element),this._element.appendChild(e);const r=e=>{this._element&&(this.itemsBox&&this.itemsBox.destroy(),(0,i.addClass)(e,"htUIMultipleSelectHot"),this.itemsBox=new this.hot.constructor(e,{data:this.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(e,t,n,r,i,o)=>{e.title=o.instance.getDataAtRowProp(t,o.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>this.itemsBox.container.scrollWidth-(0,i.getScrollbarWidth)(t),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"}),this.itemsBox.init(),this.itemsBox.getShortcutManager().getContext("grid").addShortcut({keys:[["Escape"]],callback:e=>{this.runLocalHooks("keydown",e,this)},group:"multipleSelect.itemBox"}))};r(e),setTimeout(()=>r(e),100)}reset(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}update(){this.isBuilt()&&(this.itemsBox.loadData(function(e,t){const n=(0,g.createArrayAssertion)(t);return(0,s.arrayMap)(e,e=>(e.checked=n(e.value),e))}(this.items,this.options.value)),super.update())}destroy(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,super.destroy()}onInput(e){const t=e.target.value.toLocaleLowerCase(this.getLocale());let n;n=""===t?[...this.items]:(0,s.arrayFilter)(this.items,e=>0<=(""+e.value).toLocaleLowerCase(this.getLocale()).indexOf(t)),this.itemsBox.loadData(n)}onInputKeyDown(e){this.runLocalHooks("keydown",e,this),(0,l.partial)(a.isKey,e.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&((0,d.stopImmediatePropagation)(e),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}onSelectAllClick(e){const n=[];e.preventDefault(),(0,s.arrayEach)(this.itemsBox.getSourceData(),(e,t)=>{e.checked=!0,n.push((0,u.dataRowToChangesArray)(e,t)[0])}),this.itemsBox.setSourceDataAtCell(n)}onClearAllClick(e){const n=[];e.preventDefault(),(0,s.arrayEach)(this.itemsBox.getSourceData(),(e,t)=>{e.checked=!1,n.push((0,u.dataRowToChangesArray)(e,t)[0])}),this.itemsBox.setSourceDataAtCell(n)}}r=v;t.default=r},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(447)),r=r(n(816));const o=new WeakMap;class s extends r.default{static get DEFAULTS(){return(0,i.clone)({href:"#",tagName:"a"})}constructor(e,t){super(e,(0,i.extend)(s.DEFAULTS,t)),o.set(this,{})}build(){super.build(),o.get(this).link=this._element.firstChild}update(){this.isBuilt()&&(o.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}n=s;t.default=n},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),n(302)),o=n(444),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=u(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),a=r(n(784)),l=r(n(815));function u(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(u=function(e){return e?n:t})(e))}class c extends a.default{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),this.name=t.name,this.elements.push(new l.default(this.hot,{type:"button",value:s.FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:c.BUTTON_OK})),this.elements.push(new l.default(this.hot,{type:"button",value:s.FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:c.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){(0,o.arrayEach)(this.elements,e=>{e.addLocalHook("click",(e,t)=>this.onButtonClick(e,t))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>((0,i.addClass)(t.parentNode,"htFiltersMenuActionBar"),t.parentNode.hasAttribute("ghost-table")||(0,o.arrayEach)(this.elements,e=>t.appendChild(e.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}onButtonClick(e,t){t.options.identifier===c.BUTTON_OK?this.accept():this.cancel()}}r=c;t.default=r},(e,t,n)=>{"use strict";var r=n(196),a=(t.__esModule=!0,n(273),n(203),n(444)),i=n(447),l=n(443),r=r(n(549)),u=n(786),c=n(811),d=n(812),h=n(305),o=n(543);const s="ConditionCollection.filteringStates";class f{constructor(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.hot=e,this.isMapRegistrable=t,this.filteringStates=new o.LinkedPhysicalIndexToValueMap,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(s,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(e,t){var t=this.filteringStates.getValueAtIndex(t),n=null!=(n=null==t?void 0:t.conditions)?n:[],t=null==t?void 0:t.operation;return this.isMatchInConditions(n,e,t)}isMatchInConditions(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:c.OPERATION_ID;return!e.length||(0,d.getOperationFunc)(n)(e,t)}addCondition(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:c.OPERATION_ID,r=3<arguments.length?arguments[3]:void 0;const i=this.hot.getCellMeta(0,e).locale;var o=(0,a.arrayMap)(t.args,e=>"string"==typeof e?e.toLocaleLowerCase(i):e),t=t.name||t.command.key,s=(this.runLocalHooks("beforeAdd",e),this.getOperation(e));if(s){if(s!==n)throw Error((0,l.toSingleLine)`The column of index ${e} has been already applied with a \`${s}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if((0,h.isUndefined)(d.operations[n]))throw new Error((0,l.toSingleLine)`Unexpected operation named \`${n}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);s=this.getConditions(e);0===s.length?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:t,args:o,func:(0,u.getCondition)(t,o)}]},r):s.push({name:t,args:o,func:(0,u.getCondition)(t,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){return null!=(e=null==(e=this.filteringStates.getValueAtIndex(e))?void 0:e.conditions)?e:[]}getOperation(e){return null==(e=this.filteringStates.getValueAtIndex(e))?void 0:e.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{var[e]=e;return e})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return(0,a.arrayReduce)(this.filteringStates.getEntries(),(e,t)=>{var[t,{operation:n,conditions:r}]=t;return e.push({column:t,operation:n,conditions:(0,a.arrayMap)(r,e=>{var{name:e,args:t}=e;return{name:e,args:t}})}),e},[])}importAllConditions(e){this.clean(),(0,a.arrayEach)(e,t=>{(0,a.arrayEach)(t.conditions,e=>this.addCondition(t.column,e))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){e=this.getConditions(e);return t?e.some(e=>e.name===t):0<e.length}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(s),this.filteringStates=null,this.clearLocalHooks()}}(0,i.mixin)(f,r.default),t.default=f},(e,t,n)=>{"use strict";t.__esModule=!0,n(203);var i=n(444);t.default=class{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:()=>[];this.conditionCollection=e,this.columnDataFactory=t}filter(){let r=[];return(0,i.arrayEach)(this.conditionCollection.getFilteredColumns(),(e,t)=>{let n=this.columnDataFactory(e);t&&(n=this._getIntersectData(n,r)),r=this.filterByColumn(e,n)}),r}filterByColumn(t){const n=[];return(0,i.arrayEach)(1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],e=>{void 0!==e&&this.conditionCollection.isMatch(e,t)&&n.push(e)}),n}_getIntersectData(t,e){const n=[];return(0,i.arrayEach)(e,e=>{e=e.meta.visualRow;void 0!==t[e]&&(n[e]=t[e])}),n}}},(e,t,n)=>{"use strict";var r=n(196),a=(t.__esModule=!0,n(203),n(444)),i=n(447),l=n(445),o=r(n(549)),u=r(n(824)),c=r(n(825)),d=n(808);class s{constructor(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:()=>[];this.hot=e,this.conditionCollection=t,this.columnDataFactory=n,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",e=>this._onConditionBeforeModify(e)),this.conditionCollection.addLocalHook("afterRemove",e=>this.updateStatesAtColumn(e)),this.conditionCollection.addLocalHook("afterAdd",e=>this.updateStatesAtColumn(e)),this.conditionCollection.addLocalHook("beforeClean",()=>this._onConditionBeforeClean()),this.conditionCollection.addLocalHook("afterClean",()=>this._onConditionAfterClean())}groupChanges(){this.grouping=!0}flush(){(this.grouping=!1,a.arrayEach)(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}_onConditionBeforeModify(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}updateStatesAtColumn(t,n){var s=this;if(this.grouping)-1===this.changes.indexOf(t)&&this.changes.push(t);else{var r=this.conditionCollection.exportAllConditions();let e=this.conditionCollection.getColumnStackPosition(t);-1===e&&(e=this.latestEditedColumnPosition);var i=r.slice(0,e),r=r.slice(e),i=(r.length&&r[0].column===t&&r.shift(),(0,l.curry)(function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],r=new u.default(s.hot,!1),e=[].concat(e,n),n=(r.importAllConditions(e),s.columnDataFactory(t));let i;i=r.isEmpty()?n:new c.default(r,e=>s.columnDataFactory(e)).filter(),i=(0,a.arrayMap)(i,e=>e.meta.visualRow);const o=(0,d.createArrayAssertion)(i);return r.destroy(),(0,a.arrayFilter)(n,e=>o(e.meta.visualRow))})(i)),o=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:o},dependentConditionStacks:r,filteredRowsFactory:i,conditionArgsChange:n})}}_onConditionBeforeClean(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}_onConditionAfterClean(){(0,a.arrayEach)(this.latestOrderStack,e=>{this.updateStatesAtColumn(e)})}destroy(){this.clearLocalHooks(),(0,i.objectEach)(this,(e,t)=>{this[t]=null})}}(0,i.mixin)(s,o.default),t.default=s},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(829);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.Formulas=n.Formulas},(e,t,n)=>{"use strict";n(273);var r=n(196),i=(t.__esModule=!0,n(448),n(203),r(n(467))),a=r(n(474)),o=r(n(471)),s=n(688),l=r(n(456)),u=n(455),c=n(461),d=n(305),h=n(830),m=n(832),f=n(831),p=n(542),g=n(303),y=r(n(454)),v=r(n(833));function b(e,t,n){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,n)}const E="formulas",C=(t.PLUGIN_KEY=E,["maxRows","maxColumns","language"]),w=(t.SETTING_KEYS=C,t.PLUGIN_PRIORITY=260,y.default.getSingleton().register("afterNamedExpressionAdded"),y.default.getSingleton().register("afterNamedExpressionRemoved"),y.default.getSingleton().register("afterSheetAdded"),y.default.getSingleton().register("afterSheetRemoved"),y.default.getSingleton().register("afterSheetRenamed"),y.default.getSingleton().register("afterFormulasValuesUpdate"),e=>"UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e);var S=new WeakMap,T=new WeakMap,R=new WeakMap;class A extends s.BasePlugin{constructor(){var e;super(...arguments),b(e=this,S,{writable:!0,value:!1}),b(this,T,{writable:!0,value:!1}),b(this,R,{writable:!0,value:[["valuesUpdated",function(){return e.onEngineValuesUpdated(...arguments)}],["namedExpressionAdded",function(){return e.onEngineNamedExpressionsAdded(...arguments)}],["namedExpressionRemoved",function(){return e.onEngineNamedExpressionsRemoved(...arguments)}],["sheetAdded",function(){return e.onEngineSheetAdded(...arguments)}],["sheetRenamed",function(){return e.onEngineSheetRenamed(...arguments)}],["sheetRemoved",function(){return e.onEngineSheetRemoved(...arguments)}]]}),(0,i.default)(this,"staticRegister",(0,l.default)("formulas")),(0,i.default)(this,"engine",null),(0,i.default)(this,"sheetName",null),(0,i.default)(this,"indexSyncer",null),(0,i.default)(this,"rowAxisSyncer",null),(0,i.default)(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return E}static get PLUGIN_PRIORITY(){return 260}static get SETTING_KEYS(){return[E,...C]}get sheetId(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[E]}enablePlugin(){var e,t=this;this.enabled||(this.engine=null!=(e=(0,h.setupEngine)(this.hot))?e:this.engine,this.engine?(null===this.sheetName||this.engine.doesSheetExist(this.sheetName)||!1!==(e=this.addSheet(this.sheetName,this.hot.getSourceDataArray()))&&(this.sheetName=e),this.addHook("beforeLoadData",function(){return t.onBeforeLoadData(...arguments)}),this.addHook("afterLoadData",function(){return t.onAfterLoadData(...arguments)}),this.addHook("beforeUpdateData",function(){return t.onBeforeLoadData(...arguments)}),this.addHook("afterUpdateData",function(){return t.onAfterLoadData(...arguments)}),this.addHook("modifyData",function(){return t.onModifyData(...arguments)}),this.addHook("modifySourceData",function(){return t.onModifySourceData(...arguments)}),this.addHook("beforeValidate",function(){return t.onBeforeValidate(...arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return t.onAfterSetSourceDataAtCell(...arguments)}),this.addHook("afterSetDataAtCell",function(){return t.onAfterSetDataAtCell(...arguments)}),this.addHook("afterSetDataAtRowProp",function(){return t.onAfterSetDataAtCell(...arguments)}),this.addHook("beforeCreateRow",function(){return t.onBeforeCreateRow(...arguments)}),this.addHook("beforeCreateCol",function(){return t.onBeforeCreateCol(...arguments)}),this.addHook("afterCreateRow",function(){return t.onAfterCreateRow(...arguments)}),this.addHook("afterCreateCol",function(){return t.onAfterCreateCol(...arguments)}),this.addHook("beforeRemoveRow",function(){return t.onBeforeRemoveRow(...arguments)}),this.addHook("beforeRemoveCol",function(){return t.onBeforeRemoveCol(...arguments)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow(...arguments)}),this.addHook("afterRemoveCol",function(){return t.onAfterRemoveCol(...arguments)}),this.indexSyncer=new v.default(this.hot.rowIndexMapper,this.hot.columnIndexMapper,e=>{this.hot.addHookOnce("init",()=>{e()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(e,t,n,r)=>{this.rowAxisSyncer.storeMovesInformation(e,t,r)}),this.hot.addHook("beforeColumnMove",(e,t,n,r)=>{this.columnAxisSyncer.storeMovesInformation(e,t,r)}),this.hot.addHook("afterRowMove",(e,t,n,r,i)=>{this.rowAxisSyncer.calculateAndSyncMoves(r,i)}),this.hot.addHook("afterColumnMove",(e,t,n,r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,i)}),this.hot.addHook("beforeColumnFreeze",(e,t)=>{this.columnAxisSyncer.storeMovesInformation([e],this.hot.getSettings().fixedColumnsStart,t)}),this.hot.addHook("afterColumnFreeze",(e,t)=>{this.columnAxisSyncer.calculateAndSyncMoves(t,t)}),this.hot.addHook("beforeColumnUnfreeze",(e,t)=>{this.columnAxisSyncer.storeMovesInformation([e],this.hot.getSettings().fixedColumnsStart-1,t)}),this.hot.addHook("afterColumnUnfreeze",(e,t)=>{this.columnAxisSyncer.calculateAndSyncMoves(t,t)}),this.addHook("afterCellMetaReset",function(){return t.onAfterCellMetaReset(...arguments)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){return t.onAfterDetachChild(...arguments)}),this.addHook("beforeAutofill",function(){return t.onBeforeAutofill(...arguments)}),(0,o.default)(this,R).forEach(e=>{var[e,t]=e;return this.engine.on(e,t)}),super.enablePlugin()):(0,u.warn)("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance."))}disablePlugin(){(0,o.default)(this,R).forEach(e=>{var[e,t]=e;return this.engine.off(e,t)}),(0,h.unregisterEngine)(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){var t=(0,f.getEngineSettingsWithOverrides)(this.hot.getSettings()),t=((0,f.haveEngineSettingsChanged)(this.engine.getConfig(),t)&&this.engine.updateConfig(t),this.hot.getSettings()[E]);(0,d.isDefined)(t)&&(0,d.isDefined)(t.sheetName)&&t.sheetName!==this.sheetName&&this.switchSheet(t.sheetName),e.data||null!==this.sheetName||((t=this.hot.getSettings()[E].sheetName)&&this.engine.doesSheetExist(t)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!=t?t:void 0,this.hot.getSourceDataArray())),super.updatePlugin(e)}destroy(){(0,o.default)(this,R).forEach(e=>{var t,[e,n]=e;return null==(t=this.engine)?void 0:t.off(e,n)}),(0,a.default)(this,R,null),(0,h.unregisterEngine)(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if((0,d.isDefined)(t)&&!(0,p.isArrayOfArrays)(t))return(0,u.warn)("The provided data should be an array of arrays."),!1;if(null!=e&&this.engine.doesSheetExist(e))return(0,u.warn)("Sheet with the provided name already exists."),!1;try{var n=this.engine.addSheet(null!=e?e:void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(n),t),n}catch(e){return(0,u.warn)(e.message),!1}}switchSheet(e){var t;this.engine.doesSheetExist(e)?(this.sheetName=e,0<(t=this.engine.getSheetSerialized(this.sheetId)).length&&this.hot.loadData(t,(0,g.toUpperCaseFirst)(E)+".switchSheet")):(0,u.error)(`The sheet named \`${e}\` does not exist, switch aborted.`)}getCellType(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.sheetId,r=this.hot.toPhysicalRow(e),i=this.hot.toPhysicalColumn(t);return null!==r&&null!==i?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];const r=new Set;e.forEach(e=>{e=null==e||null==(e=e.address)?void 0:e.sheet;void 0===e||r.has(e)||r.add(e)}),(0,h.getRegisteredHotInstances)(this.engine).forEach((e,t)=>{(n||t!==this.sheetId)&&r.has(t)&&(e.render(),null!=(t=e.view))&&t.adjustElementsSize()})}validateDependentCells(e){const i=e=>{var{row:e,col:t,sheet:n}=null!=(e=null==e?void 0:e.address)?e:{};return(0,d.isDefined)(n)?n+`:${e}x`+t:""},o=new Set((1<arguments.length&&void 0!==arguments[1]?arguments[1]:[]).map(e=>i(e)));e.forEach(e=>{var t,{row:n,col:r}=null!=(n=e.address)?n:{};!1===(0,d.isDefined)(n)||!1===(0,d.isDefined)(r)||n>=this.hot.countRows()||r>=this.hot.countCols()||(t=null==e||null==(t=e.address)?void 0:t.sheet,e=i(e),void 0===t)||o.has(e)||(e=(0,h.getRegisteredHotInstances)(this.engine).get(t))&&e.validateCell(e.getDataAtCell(n,r),e.getCellMeta(n,r),()=>{})})}syncChangeWithEngine(e,t,n){var r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(this.engine.isItPossibleToSetCellContents(r))return e=this.hot.getCellMeta(e,t),(0,m.isDate)(n,e.type)&&((0,m.isDateValid)(n,e.dateFormat)?n=(0,m.getDateInHfFormat)(n,e.dateFormat):!1===(0,m.isFormula)(n)&&(n="'"+n)),this.engine.setCellContents(r,n);(0,u.warn)("Not possible to set cell data at "+JSON.stringify(r))}onBeforeValidate(e,t,n){n=this.hot.propToCol(n);if(this.isFormulaCellType(t,n)){var r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},t=this.hot.getCellMeta(t,n);let e=this.engine.getCellValue(r);return"object"==typeof(e="date"===t.type&&(0,c.isNumeric)(e)?(0,m.getDateFromExcelDate)(e,t.dateFormat):e)&&null!==e?e.value:e}return e}onBeforeAutofill(e,t,n){var{row:r,col:i}=t.getTopStartCorner(),{row:t,col:o}=t.getBottomEndCorner(),{row:s,col:a}=n.getTopStartCorner(),{row:n,col:l}=n.getBottomEndCorner(),r={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId}},i={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(i))return!1;var u=this.engine.getFillRangeData(r,i),{row:t,col:o}=r.start,{row:s,col:a}=r.end,c=s-t+1,d=a-o+1;for(let t=0;t<u.length;t+=1)for(let e=0;e<u[t].length;e+=1){var h=u[t][e],f=t%c,p=e%d,g=this.hot.getCellMeta(f,p);(0,m.isDate)(h,g.type)&&(h.startsWith("'")?u[t][e]=h.slice(1):!1===this.isFormulaCellType(f,p,this.sheetId)&&(u[t][e]=(0,m.getDateInHotFormat)(h,g.dateFormat)))}return u}onBeforeLoadData(e,t){(2<arguments.length&&void 0!==arguments[2]?arguments[2]:"").includes((0,g.toUpperCaseFirst)(E))||(0,a.default)(this,T,(0,d.isUndefined)(this.hot.getSettings().data))}onAfterCellMetaReset(){const o=this.hot.getSourceDataArray();let s=!1;o.forEach((e,i)=>{e.forEach((e,t)=>{var n=this.hot.getCellMeta(i,t),r=n.dateFormat;(0,m.isDate)(e,n.type)&&(s=!0,(0,m.isDateValid)(e,r)?o[i][t]=(0,m.getDateInHfFormat)(e,r):!1===this.isFormulaCellType(i,t)&&(o[i][t]="'"+e))})}),!0===s&&((0,a.default)(this,S,!0),this.engine.setSheetContent(this.sheetId,o),(0,a.default)(this,S,!1))}onAfterLoadData(e,t){var n;(2<arguments.length&&void 0!==arguments[2]?arguments[2]:"").includes((0,g.toUpperCaseFirst)(E))||(this.sheetName=(0,h.setupSheet)(this.engine,this.hot.getSettings()[E].sheetName),(0,o.default)(this,T)?this.switchSheet(this.sheetName):(n=this.hot.getSourceDataArray(),this.engine.isItPossibleToReplaceSheetContent(this.sheetId,n)&&((0,a.default)(this,S,!0),n=this.engine.setSheetContent(this.sheetId,n),this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(n),(0,a.default)(this,S,!1))))}onModifyData(t,n,r,i){if("get"===i&&!(0,o.default)(this,S)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){i=this.hot.toVisualRow(t);if(null!==i&&null!==n){t=this.isFormulaCellType(i,n);if(!t)if("ARRAY"!==this.getCellType(i,n))return void((0,m.isEscapedFormulaExpression)(r.value)&&(r.value=(0,m.unescapeFormulaExpression)(r.value)));t={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};let e=this.engine.getCellValue(t);t=this.hot.getCellMeta(i,n),i="object"==typeof(e="date"===t.type&&(0,c.isNumeric)(e)?(0,m.getDateFromExcelDate)(e,t.dateFormat):e)&&null!==e?e.value:e;r.value=i}}}onModifySourceData(e,t,n,r){if("get"===r&&!(0,o.default)(this,S)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){r=this.hot.toVisualRow(e),e=this.hot.propToCol(t);if(null!==r&&null!==e){t=this.isFormulaCellType(r,e);if(!t)if("ARRAY"!==this.getCellType(r,e))return;var t=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));0===t.width&&0===t.height||(t={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId},n.value=this.engine.getCellSerialized(t))}}}onAfterSetDataAtCell(e,t){if(!w(t)){const s=[],a=[];t=this.engine.batch(()=>{e.forEach(e=>{var[e,t,,n]=e,t=this.hot.propToCol(t),r=this.hot.toPhysicalRow(e),i=this.hot.toPhysicalColumn(t),o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};null!==r&&null!==i?this.syncChangeWithEngine(e,t,n):s.push([e,t,n]),a.push({address:o})})});s.length&&this.hot.addHookOnce("afterChange",()=>{var e=this.engine.batch(()=>{s.forEach(e=>{var[e,t,n]=e;this.syncChangeWithEngine(e,t,n)})});this.renderDependentSheets(e,!0)}),this.renderDependentSheets(t),this.validateDependentCells(t,a)}}onAfterSetSourceDataAtCell(e,t){if(!w(t)){const r=[],i=[];e.forEach(e=>{var[e,t,,n]=e,t=this.hot.propToCol(t);(0,c.isNumeric)(t)&&(e={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId},this.engine.isItPossibleToSetCellContents(e)?(i.push({address:e}),r.push(...this.engine.setCellContents(e,n))):(0,u.warn)("Not possible to set source cell data at "+JSON.stringify(e)))}),this.renderDependentSheets(r),this.validateDependentCells(r,i)}}onBeforeCreateRow(e,t){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countRows()&&(n=e),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,t]))return!1}onBeforeCreateCol(e,t){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countCols()&&(n=e),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,t]))return!1}onBeforeRemoveRow(e,t,n){return!1!==this.rowAxisSyncer.setRemovedHfIndexes(n).every(e=>this.engine.isItPossibleToRemoveRows(this.sheetId,[e,1]))&&void 0}onBeforeRemoveCol(e,t,n){return!1!==this.columnAxisSyncer.setRemovedHfIndexes(n).every(e=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[e,1]))&&void 0}onAfterCreateRow(e,t,n){w(n)||(n=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(e),t]),this.renderDependentSheets(n))}onAfterCreateCol(e,t,n){w(n)||(n=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(e),t]),this.renderDependentSheets(n))}onAfterRemoveRow(e,t,n,r){if(!w(r)){const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse();r=this.engine.batch(()=>{i.forEach(e=>{this.engine.removeRows(this.sheetId,[e,1])})});this.renderDependentSheets(r)}}onAfterRemoveCol(e,t,n,r){if(!w(r)){const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse();r=this.engine.batch(()=>{i.forEach(e=>{this.engine.removeColumns(this.sheetId,[e,1])})});this.renderDependentSheets(r)}}onAfterDetachChild(e,t,r){(0,a.default)(this,S,!0);t=this.hot.getSourceDataArray(r,0,r+((null==(t=t.__children)?void 0:t.length)||0),this.hot.countSourceCols());(0,a.default)(this,S,!1),t.forEach((e,n)=>{e.forEach((e,t)=>{this.engine.setCellContents({col:t,row:r+n,sheet:this.sheetId},[[e]])})})}onEngineValuesUpdated(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}onEngineNamedExpressionsAdded(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}onEngineNamedExpressionsRemoved(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}onEngineSheetAdded(e){this.hot.runHooks("afterSheetAdded",e)}onEngineSheetRenamed(e,t){this.hot.runHooks("afterSheetRenamed",e,t)}onEngineSheetRemoved(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}}t.Formulas=A},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,t.getRegisteredHotInstances=function(e){var t=d(),e=0===t.size?[]:Array.from(null!=(t=t.get(e))?t:[]);return new Map(e.map(e=>[e.getPlugin("formulas").sheetId,e]))},t.registerCustomFunctions=p,t.registerEngine=f,t.registerLanguage=g,t.registerNamedExpressions=m,t.setupEngine=function(e){var t=e.getSettings(),n=t[u.PLUGIN_KEY],r=null==n?void 0:n.engine;if(!0!==n&&!(0,o.isUndefined)(r)){if("function"==typeof r.hyperformula||"function"==typeof r)return f(null!=(n=r.hyperformula)?n:r,t,e);if("object"==typeof r&&(0,o.isUndefined)(r.hyperformula))return n=d(),t=h().get(r),n.has(r)||n.set(r,[]),n.get(r).push(e),t&&t.push(e.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:c.DEFAULT_LICENSE_KEY}),r.getConfig().leapYear1900===c.DEFAULT_SETTINGS.leapYear1900&&!1!==(0,l.isObjectEqual)(r.getConfig().nullDate,c.DEFAULT_SETTINGS.nullDate)||(0,a.warn)((0,s.toSingleLine)`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null},t.setupSheet=function(e,t){!(0,o.isUndefined)(t)&&e.doesSheetExist(t)||(t=e.addSheet(t));return t},t.unregisterEngine=function(e,t){{var n,r,i,o;e&&(n=d(),r=n.get(e),i=h(),o=i.get(e),r&&r.includes(t)&&(r.splice(r.indexOf(t),1),0===r.length)&&n.delete(e),o)&&o.includes(t.guid)&&(o.splice(o.indexOf(t.guid),1),0===o.length)&&(i.delete(e),e.destroy())}},n(203),r(n(456))),o=n(305),s=n(443),a=n(455),l=n(447),u=n(829),c=n(831);function d(){var e="engine_relationship",t=(0,i.default)(u.PLUGIN_KEY);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function h(){var e="shared_engine_usage",t=(0,i.default)(u.PLUGIN_KEY);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function f(e,t,n){var r=t[u.PLUGIN_KEY],t=(0,c.getEngineSettingsWithDefaultsAndOverrides)(t),i=d(),o=h();p(e,r.functions),g(e,r.language);const s=e.buildEmpty(t);return i.set(s,[n]),o.set(s,[n.guid]),m(s,r.namedExpressions),s.on("sheetAdded",()=>{s.rebuildAndRecalculate()}),s.on("sheetRemoved",()=>{s.rebuildAndRecalculate()}),s}function p(r,e){e&&e.forEach(e=>{var{name:e,plugin:t,translations:n}=e;try{r.registerFunction(e,t,n)}catch(e){(0,a.warn)(e.message)}})}function g(e,t){if(t){var n=t["langCode"];try{e.registerLanguage(n,t)}catch(e){(0,a.warn)(e.message)}}}function m(i,e){e&&(i.suspendEvaluation(),e.forEach(e=>{var{name:e,expression:t,scope:n,options:r}=e;try{i.addNamedExpression(e,t,n,r)}catch(e){(0,a.warn)(e.message)}}),i.resumeEvaluation())}},(e,t,n)=>{"use strict";t.__esModule=!0,t.getEngineSettingsOverrides=o,t.getEngineSettingsWithDefaultsAndOverrides=function(e){var t=e[r.PLUGIN_KEY],n=s(null!=t&&null!=(n=t.engine)&&n.hyperformula?t.engine:{}),t=o(e);return{...i,...n,...t}},t.getEngineSettingsWithOverrides=function(e){var t=e[r.PLUGIN_KEY],n=s(null!=t&&null!=(n=t.engine)&&n.hyperformula?t.engine:{}),t=o(e);return{...n,...t}},t.haveEngineSettingsChanged=function(t,n){return Object.keys(n).some(e=>void 0!==n[e]&&n[e]!==t[e])};var r=n(829),n="internal-use-in-handsontable";const i={licenseKey:t.DEFAULT_LICENSE_KEY=n,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function o(e){return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:null==(e=e[r.PLUGIN_KEY])||null==(e=e.language)?void 0:e.langCode}}function s(n){return Object.keys(n).reduce((e,t)=>("hyperformula"!==t&&(e[t]=n[t]),e),{})}t.DEFAULT_SETTINGS=i},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,t.getDateFromExcelDate=function(e,t){e=new Date(Date.UTC(0,0,e+-1));return(0,i.default)(e).format(t)},t.getDateInHfFormat=function(e,t){return(0,i.default)(e,t,!0).format(o)},t.getDateInHotFormat=function(e,t){return(0,i.default)(e,o,!0).format(t)},t.isDate=function(e,t){return"string"==typeof e&&"date"===t},t.isDateValid=function(e,t){return(0,i.default)(e,t,!0).isValid()},t.isEscapedFormulaExpression=s,t.isFormula=function(e){return"string"==typeof e&&e.startsWith("=")},t.unescapeFormulaExpression=function(e){return s(e)?e.substr(1):e},r(n(306)));const o="DD/MM/YYYY";function s(e){return"string"==typeof e&&"'"===e.charAt(0)&&"="===e.charAt(1)}},(e,t,n)=>{"use strict";n(273);var r=n(196),i=(t.__esModule=!0,r(n(471))),o=r(n(474)),s=r(n(834));function a(e,t,n){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,n)}var l=new WeakMap,u=new WeakMap,c=new WeakMap,d=new WeakMap,h=new WeakMap,f=new WeakMap,p=new WeakMap;t.default=class{constructor(e,t,n){a(this,l,{writable:!0,value:void 0}),a(this,u,{writable:!0,value:void 0}),a(this,c,{writable:!0,value:void 0}),a(this,d,{writable:!0,value:!1}),a(this,h,{writable:!0,value:!1}),a(this,f,{writable:!0,value:null}),a(this,p,{writable:!0,value:null}),(0,o.default)(this,l,new s.default("row",e,this)),(0,o.default)(this,u,new s.default("column",t,this)),(0,o.default)(this,c,n)}getForAxis(e){return"row"===e?(0,i.default)(this,l):(0,i.default)(this,u)}setPerformUndo(e){(0,o.default)(this,d,e)}setPerformRedo(e){(0,o.default)(this,h,e)}isPerformingUndoRedo(){return(0,i.default)(this,d)||(0,i.default)(this,h)}getSheetId(){return(0,i.default)(this,p)}getEngine(){return(0,i.default)(this,f)}getPostponeAction(){return(0,i.default)(this,c)}setupSyncEndpoint(e,t){(0,o.default)(this,f,e),(0,o.default)(this,p,t),(0,i.default)(this,l).init(),(0,i.default)(this,u).init()}}},(e,t,n)=>{"use strict";n(273);var r=n(196),o=(t.__esModule=!0,n(203),r(n(471))),s=r(n(474)),a=n(303);function i(e,t,n){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,n)}var l=new WeakMap,u=new WeakMap,c=new WeakMap,d=new WeakMap,h=new WeakMap,f=new WeakMap,p=new WeakMap;t.default=class{constructor(e,t,n){i(this,l,{writable:!0,value:void 0}),i(this,u,{writable:!0,value:void 0}),i(this,c,{writable:!0,value:void 0}),i(this,d,{writable:!0,value:[]}),i(this,h,{writable:!0,value:[]}),i(this,f,{writable:!0,value:void 0}),i(this,p,{writable:!0,value:[]}),(0,s.default)(this,l,e),(0,s.default)(this,u,t),(0,s.default)(this,c,n)}setRemovedHfIndexes(e){return(0,s.default)(this,p,e.map(e=>{e=(0,o.default)(this,u).getVisualFromPhysicalIndex(e);return this.getHfIndexFromVisualIndex(e)})),(0,o.default)(this,p)}getRemovedHfIndexes(){return(0,o.default)(this,p)}getHfIndexFromVisualIndex(e){var t=(0,o.default)(this,u).getIndexesSequence(),n=(0,o.default)(this,u).getNotTrimmedIndexes();return t.indexOf(n[e])}syncMoves(e){const r=`move${(0,a.toUpperCaseFirst)((0,o.default)(this,l))}s`;(0,o.default)(this,c).getEngine().batch(()=>{e.forEach(e=>{var t=e.from!==e.to,n=e.from+1!==e.to;t&&n&&(0,o.default)(this,c).getEngine()[r]((0,o.default)(this,c).getSheetId(),e.from,1,e.to)})})}storeMovesInformation(e,t,n){!1!==n&&((0,s.default)(this,h,e.map(e=>this.getHfIndexFromVisualIndex(e))),(0,s.default)(this,f,this.getHfIndexFromVisualIndex(t)))}getMoveLine(t,e){var n,r=(0,o.default)(this,u).getNumberOfIndexes(),r=Array.from(Array(r).keys()).filter(e=>!1===t.includes(e));return 0===e?null!=(n=r[e])?n:0:r[e-1]+1}getInitiallyCalculatedMoves(e,t){let n=this.getMoveLine(e,t);const i=[];return e.forEach(e=>{const r={from:e,to:n};i.forEach(e=>{var t=e.from>e.to,n=e.to<=r.from;e.from>r.from&&n&&t&&(r.from+=1)}),r.from>=n&&(n+=1),i.push(r)}),i}adjustedCalculatedMoves(t){return t.forEach((n,e)=>{t.slice(e+1).forEach(e=>{var t=e.from<e.to;e.from>n.from&&t&&--e.from})}),t}calculateAndSyncMoves(e,t){if(!(0,o.default)(this,c).isPerformingUndoRedo()&&!1!==e&&!1!==t){const n=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves((0,o.default)(this,h),(0,o.default)(this,f)));null===(0,o.default)(this,c).getSheetId()?(0,o.default)(this,c).getPostponeAction(()=>this.syncMoves(n)):this.syncMoves(n)}}getIndexesChangeSyncMethod(){const i=`set${(0,a.toUpperCaseFirst)((0,o.default)(this,l))}Order`;return e=>{if(!(0,o.default)(this,c).isPerformingUndoRedo()){const r=(0,o.default)(this,u).getIndexesSequence();if("update"===e){var n=(0,o.default)(this,d).map(e=>r.indexOf(e)),e=(0,o.default)(this,c).getEngine().getSheetDimensions((0,o.default)(this,c).getSheetId());let t;t="row"===(0,o.default)(this,l)?e.height:e.width;for(let e=n.length;e<t;e+=1)n.push(e);(0,o.default)(this,c).getEngine()[i]((0,o.default)(this,c).getSheetId(),n)}(0,s.default)(this,d,r)}}}init(){(0,s.default)(this,d,(0,o.default)(this,u).getIndexesSequence())}}},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(836);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.HiddenColumns=n.HiddenColumns},(e,t,n)=>{"use strict";n(273);var r=n(196),s=(t.__esModule=!0,n(203),r(n(471))),i=r(n(474)),o=n(688),a=n(302),l=n(461),u=n(444),c=n(447),d=n(305),h=n(733),f=r(n(454)),p=r(n(837)),g=r(n(838)),m=n(543);function y(e,t,n){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,n)}n(839),f.default.getSingleton().register("beforeHideColumns"),f.default.getSingleton().register("afterHideColumns"),f.default.getSingleton().register("beforeUnhideColumns"),f.default.getSingleton().register("afterUnhideColumns");const v="hiddenColumns";t.PLUGIN_KEY=v;t.PLUGIN_PRIORITY=310;var b=new WeakMap,E=new WeakMap;class C extends o.BasePlugin{constructor(){super(...arguments),y(this,b,{writable:!0,value:{}}),y(this,E,{writable:!0,value:null})}static get PLUGIN_KEY(){return v}static get PLUGIN_PRIORITY(){return 310}isEnabled(){return!!this.hot.getSettings()[v]}enablePlugin(){var e,t=this;this.enabled||(e=this.hot.getSettings()[v],(0,c.isObject)(e)&&((0,i.default)(this,b,e),(0,d.isUndefined)(e.copyPasteEnabled))&&(e.copyPasteEnabled=!0),(0,i.default)(this,E,new m.HidingMap),(0,s.default)(this,E).addLocalHook("init",()=>this.onMapInit()),this.hot.columnIndexMapper.registerMap(this.pluginName,(0,s.default)(this,E)),this.addHook("afterContextMenuDefaultOptions",function(){return t.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetCellMeta",(e,t,n)=>this.onAfterGetCellMeta(e,t,n)),this.addHook("modifyColWidth",(e,t)=>this.onModifyColWidth(e,t)),this.addHook("afterGetColHeader",function(){return t.onAfterGetColHeader(...arguments)}),this.addHook("modifyCopyableRange",e=>this.onModifyCopyableRange(e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),(0,i.default)(this,b,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){var t=this.getHiddenColumns(),n=this.isValidConfig(e);let r=t;const i=(0,s.default)(this,E).getValues().slice();var o=0<e.length,e=(n&&o&&(e=e.map(e=>this.hot.toPhysicalColumn(e)),(0,u.arrayEach)(e,e=>{i[e]=!1}),r=(0,u.arrayReduce)(i,(e,t,n)=>(t&&e.push(this.hot.toVisualColumn(n)),e),[])),this.hot.runHooks("beforeUnhideColumns",t,r,n&&o));!1!==e&&(n&&o&&(0,s.default)(this,E).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,r,n&&o,n&&r.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showColumns(t)}hideColumns(e){var t=this.getHiddenColumns(),n=this.isValidConfig(e);let r=t;n&&(r=Array.from(new Set(t.concat(e)))),!1!==this.hot.runHooks("beforeHideColumns",t,r,n)&&(n&&this.hot.batchExecution(()=>{(0,u.arrayEach)(e,e=>{(0,s.default)(this,E).setValueAtIndex(this.hot.toPhysicalColumn(e),!0)})},!0),this.hot.runHooks("afterHideColumns",t,r,n,n&&r.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideColumns(t)}getHiddenColumns(){return(0,u.arrayMap)((0,s.default)(this,E).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return(0,s.default)(this,E).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return!!(Array.isArray(e)&&0<e.length)&&e.every(e=>Number.isInteger(e)&&0<=e&&e<t)}resetCellsMeta(){(0,u.arrayEach)(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}onModifyColWidth(e,t){return this.isHidden(t)?0:(0,s.default)(this,b).indicators&&(this.isHidden(t+1)||this.isHidden(t-1))&&"number"==typeof e&&this.hot.hasColHeaders()?e+15:void 0}onAfterGetCellMeta(e,t,n){var r;!1===(0,s.default)(this,b).copyPasteEnabled&&this.isHidden(t)&&(n.skipColumnOnPaste=!0),this.isHidden(t-1)?(n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn")):n.className&&0<(t=n.className.split(" ")).length&&(-1<(r=t.indexOf("afterHiddenColumn"))&&t.splice(r,1),n.className=t.join(" "))}onModifyCopyableRange(e){if((0,s.default)(this,b).copyPasteEnabled)return e;const i=[],o=(e,t,n,r)=>{i.push({startRow:e,endRow:t,startCol:n,endCol:r})};return(0,u.arrayEach)(e,t=>{let n=!0,r=0;(0,l.rangeEach)(t.startCol,t.endCol,e=>{n=this.isHidden(e)?(n||o(t.startRow,t.endRow,r,e-1),!0):(n&&(r=e),e===t.endCol&&o(t.startRow,t.endRow,r,e),!1)})}),i}onAfterGetColHeader(e,t){var n;!(0,s.default)(this,b).indicators||e<0||(n=[],1<=e&&this.isHidden(e-1)&&n.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&n.push("beforeHiddenColumn"),(0,a.addClass)(t,n))}onAfterContextMenuDefaultOptions(e){e.items.push({name:h.SEPARATOR},(0,p.default)(this),(0,g.default)(this))}onMapInit(){Array.isArray((0,s.default)(this,b).columns)&&this.hideColumns((0,s.default)(this,b).columns)}destroy(){(0,i.default)(this,b,null),(0,i.default)(this,E,null),super.destroy()}}t.HiddenColumns=C},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(o){return{key:"hidden_columns_hide",name(){var e,t=this.getSelectedLast();let n=0;return Array.isArray(t)&&([,t,,e]=t,t-e!=0)&&(n=1),this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_HIDE_COLUMN,n)},callback(){var{from:e,to:t}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.col,t.col),0),r=Math.max(e.col,t.col),i=[];for(let e=n;e<=r;e+=1)i.push(e);o.hideColumns(i);e=this.columnIndexMapper.getNearestNotHiddenIndex(i[i.length-1],1,!0);Number.isInteger(e)&&0<=e?this.selectColumns(e):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}},n(203);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(u){const c=[];return{key:"hidden_columns_show",name(){var e=1<c.length?1:0;return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_SHOW_COLUMN,e)},callback(){var e,t,n;0!==c.length&&(t=c[0],n=c[c.length-1],t=null!=(e=this.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1))?e:0,n=null!=(e=this.columnIndexMapper.getNearestNotHiddenIndex(n+1,1))?e:this.countCols()-1,u.showColumns(c),this.render(),this.view.adjustElementsSize(!0),n-t+1!==this.countCols())&&this.selectColumns(t,n)},disabled:!1,hidden(){const t=(0,d.arrayMap)(u.getHiddenColumns(),e=>this.toPhysicalColumn(e));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||t.length<1)return!0;c.length=0;var e,n=this.getSelectedRangeLast(),r=n.getTopStartCorner().col,n=n.getBottomEndCorner().col,i=this.columnIndexMapper,o=i.getRenderableFromVisualIndex(r),s=i.getRenderableFromVisualIndex(n),a=i.getNotTrimmedIndexes(),l=[];return r!==n?s-o+1<n-r+1&&(e=a.slice(r,n+1),l.push(...e.filter(e=>t.includes(e)))):0===o&&o<r?l.push(...a.slice(0,r)):null===o?l.push(...a.slice(0,this.countCols())):(e=this.countCols()-1,s===i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(e,-1))&&n<e&&l.push(...a.slice(n+1))),(0,d.arrayEach)(l,e=>{c.push(this.toVisualColumn(e))}),0===c.length}}},n(203);var d=n(444),r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(841);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.HiddenRows=n.HiddenRows},(e,t,n)=>{"use strict";n(273);var r=n(196),s=(t.__esModule=!0,n(203),r(n(471))),i=r(n(474)),o=n(688),a=n(302),l=n(461),u=n(444),c=n(447),d=n(305),h=n(733),f=r(n(454)),p=r(n(842)),g=r(n(843)),m=n(543);function y(e,t,n){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,n)}n(844),f.default.getSingleton().register("beforeHideRows"),f.default.getSingleton().register("afterHideRows"),f.default.getSingleton().register("beforeUnhideRows"),f.default.getSingleton().register("afterUnhideRows");const v="hiddenRows";t.PLUGIN_KEY=v;t.PLUGIN_PRIORITY=320;var b=new WeakMap,E=new WeakMap;class C extends o.BasePlugin{constructor(){super(...arguments),y(this,b,{writable:!0,value:{}}),y(this,E,{writable:!0,value:null})}static get PLUGIN_KEY(){return v}static get PLUGIN_PRIORITY(){return 320}isEnabled(){return!!this.hot.getSettings()[v]}enablePlugin(){var e,t=this;this.enabled||(e=this.hot.getSettings()[v],(0,c.isObject)(e)&&((0,i.default)(this,b,e),(0,d.isUndefined)(e.copyPasteEnabled))&&(e.copyPasteEnabled=!0),(0,i.default)(this,E,new m.HidingMap),(0,s.default)(this,E).addLocalHook("init",()=>this.onMapInit()),this.hot.rowIndexMapper.registerMap(this.pluginName,(0,s.default)(this,E)),this.addHook("afterContextMenuDefaultOptions",function(){return t.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetCellMeta",(e,t,n)=>this.onAfterGetCellMeta(e,t,n)),this.addHook("modifyRowHeight",(e,t)=>this.onModifyRowHeight(e,t)),this.addHook("afterGetRowHeader",function(){return t.onAfterGetRowHeader(...arguments)}),this.addHook("modifyCopyableRange",e=>this.onModifyCopyableRange(e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),(0,i.default)(this,b,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){var t=this.getHiddenRows(),n=this.isValidConfig(e);let r=t;const i=(0,s.default)(this,E).getValues().slice();var o=0<e.length,e=(n&&o&&(e=e.map(e=>this.hot.toPhysicalRow(e)),(0,u.arrayEach)(e,e=>{i[e]=!1}),r=(0,u.arrayReduce)(i,(e,t,n)=>(t&&e.push(this.hot.toVisualRow(n)),e),[])),this.hot.runHooks("beforeUnhideRows",t,r,n&&o));!1!==e&&(n&&o&&(0,s.default)(this,E).setValues(i),this.hot.runHooks("afterUnhideRows",t,r,n&&o,n&&r.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showRows(t)}hideRows(e){var t=this.getHiddenRows(),n=this.isValidConfig(e);let r=t;n&&(r=Array.from(new Set(t.concat(e)))),!1!==this.hot.runHooks("beforeHideRows",t,r,n)&&(n&&this.hot.batchExecution(()=>{(0,u.arrayEach)(e,e=>{(0,s.default)(this,E).setValueAtIndex(this.hot.toPhysicalRow(e),!0)})},!0),this.hot.runHooks("afterHideRows",t,r,n,n&&r.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideRows(t)}getHiddenRows(){return(0,u.arrayMap)((0,s.default)(this,E).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return(0,s.default)(this,E).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return!!(Array.isArray(e)&&0<e.length)&&e.every(e=>Number.isInteger(e)&&0<=e&&e<t)}resetCellsMeta(){(0,u.arrayEach)(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}onModifyRowHeight(e,t){return this.isHidden(t)?0:e}onAfterGetCellMeta(e,t,n){var r;!1===(0,s.default)(this,b).copyPasteEnabled&&this.isHidden(e)&&(n.skipRowOnPaste=!0),this.isHidden(e-1)?(n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow")):n.className&&0<(e=n.className.split(" ")).length&&(-1<(r=e.indexOf("afterHiddenRow"))&&e.splice(r,1),n.className=e.join(" "))}onModifyCopyableRange(e){if((0,s.default)(this,b).copyPasteEnabled)return e;const i=[],o=(e,t,n,r)=>{i.push({startRow:e,endRow:t,startCol:n,endCol:r})};return(0,u.arrayEach)(e,t=>{let n=!0,r=0;(0,l.rangeEach)(t.startRow,t.endRow,e=>{n=this.isHidden(e)?(n||o(r,e-1,t.startCol,t.endCol),!0):(n&&(r=e),e===t.endRow&&o(r,e,t.startCol,t.endCol),!1)})}),i}onAfterGetRowHeader(e,t){var n;!(0,s.default)(this,b).indicators||e<0||(n=[],1<=e&&this.isHidden(e-1)&&n.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&n.push("beforeHiddenRow"),(0,a.addClass)(t,n))}onAfterContextMenuDefaultOptions(e){e.items.push({name:h.SEPARATOR},(0,p.default)(this),(0,g.default)(this))}onMapInit(){Array.isArray((0,s.default)(this,b).rows)&&this.hideRows((0,s.default)(this,b).rows)}destroy(){(0,i.default)(this,b,null),(0,i.default)(this,E,null),super.destroy()}}t.HiddenRows=C},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(o){return{key:"hidden_rows_hide",name(){var e,t=this.getSelectedLast();let n=0;return Array.isArray(t)&&([t,,e]=t,t-e!=0)&&(n=1),this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_HIDE_ROW,n)},callback(){var{from:e,to:t}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.row,t.row),0),r=Math.max(e.row,t.row),i=[];for(let e=n;e<=r;e+=1)i.push(e);o.hideRows(i);e=this.rowIndexMapper.getNearestNotHiddenIndex(i[i.length-1],1,!0);Number.isInteger(e)&&0<=e?this.selectRows(e):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}},n(203);var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(u){const c=[];return{key:"hidden_rows_show",name(){var e=1<c.length?1:0;return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_SHOW_ROW,e)},callback(){var e,t,n;0!==c.length&&(t=c[0],n=c[c.length-1],t=null!=(e=this.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1))?e:0,n=null!=(e=this.rowIndexMapper.getNearestNotHiddenIndex(n+1,1))?e:this.countRows()-1,u.showRows(c),this.render(),this.view.adjustElementsSize(!0),n-t+1!==this.countRows())&&this.selectRows(t,n)},disabled:!1,hidden(){const t=(0,d.arrayMap)(u.getHiddenRows(),e=>this.toPhysicalRow(e));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||t.length<1)return!0;c.length=0;var e,n=this.getSelectedRangeLast(),r=n.getTopStartCorner().row,n=n.getBottomEndCorner().row,i=this.rowIndexMapper,o=i.getRenderableFromVisualIndex(r),s=i.getRenderableFromVisualIndex(n),a=i.getNotTrimmedIndexes(),l=[];return r!==n?s-o+1<n-r+1&&(e=a.slice(r,n+1),l.push(...e.filter(e=>t.includes(e)))):0===o&&o<r?l.push(...a.slice(0,r)):null===o?l.push(...a.slice(0,this.countRows())):(e=this.countRows()-1,s===i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(e,-1))&&n<e&&l.push(...a.slice(n+1))),(0,d.arrayEach)(l,e=>{c.push(this.toVisualRow(e))}),0===c.length}}},n(203);var d=n(444),r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(846);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.ManualColumnFreeze=n.ManualColumnFreeze},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),n(688)),o=r(n(454)),s=r(n(847)),a=r(n(848));n(849),o.default.getSingleton().register("beforeColumnFreeze"),o.default.getSingleton().register("afterColumnFreeze"),o.default.getSingleton().register("beforeColumnUnfreeze"),o.default.getSingleton().register("afterColumnUnfreeze");const l="manualColumnFreeze",u=(t.PLUGIN_KEY=l,t.PLUGIN_PRIORITY=110,new WeakMap);class c extends i.BasePlugin{static get PLUGIN_KEY(){return l}static get PLUGIN_PRIORITY(){return 110}constructor(e){super(e),u.set(this,{afterFirstUse:!1})}isEnabled(){return!!this.hot.getSettings()[l]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>this.addContextMenuEntry(e)),this.addHook("beforeColumnMove",(e,t)=>this.onBeforeColumnMove(e,t)),super.enablePlugin())}disablePlugin(){u.get(this).afterFirstUse=!1,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){var t=u.get(this),n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1,t=(t.afterFirstUse||(t.afterFirstUse=!0),this.hot.runHooks("beforeColumnFreeze",e,r));!1!==t&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){var t=u.get(this),n=this.hot.getSettings(),r=0<n.fixedColumnsStart&&e<=n.fixedColumnsStart-1,t=(t.afterFirstUse||(t.afterFirstUse=!0),this.hot.runHooks("beforeColumnUnfreeze",e,r));!1!==t&&(r&&(--n._fixedColumnsStart,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}addContextMenuEntry(e){e.items.push({name:"---------"},(0,s.default)(this),(0,a.default)(this))}onBeforeColumnMove(e,t){if(u.get(this).afterFirstUse){const n=this.hot.getSettings().fixedColumnsStart;return t<n?!1:!e.some(e=>e<n)&&void 0}}}t.ManualColumnFreeze=c},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(n){return{key:"freeze_column",name(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback(e,t){var[{start:{col:t}}]=t;n.freezeColumn(t),this.render(),this.view.adjustElementsSize(!0)},hidden(){var e=this.getSelectedRange();let t=!1;return t=void 0===e||1<e.length||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1?!0:t}}};var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(n){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback(e,t){var[{start:{col:t}}]=t;n.unfreezeColumn(t),this.render(),this.view.adjustElementsSize(!0)},hidden(){var e=this.getSelectedRange();let t=!1;return t=void 0===e||1<e.length||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart?!0:t}}};var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(851);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.ManualColumnMove=n.ManualColumnMove},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),n(688)),o=r(n(454)),s=n(444),g=n(302),a=n(461),l=r(n(457)),u=r(n(852)),c=r(n(854));n(855),o.default.getSingleton().register("beforeColumnMove"),o.default.getSingleton().register("afterColumnMove");const d="manualColumnMove",m=(t.PLUGIN_KEY=d,t.PLUGIN_PRIORITY=120,new WeakMap),h="ht__manualColumnMove",f="show-ui",p="on-moving--columns",y="after-selection--columns";class v extends i.BasePlugin{static get PLUGIN_KEY(){return d}static get PLUGIN_PRIORITY(){return 120}constructor(e){super(e),m.set(this,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),this.eventManager=new l.default(this),this.backlight=new u.default(e),this.guideline=new c.default(e)}isEnabled(){return!!this.hot.getSettings()[d]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterScrollVertically",()=>this.onAfterScrollVertically()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.buildPluginUI(),this.registerEvents(),(0,g.addClass)(this.hot.rootElement,h),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){(0,g.removeClass)(this.hot.rootElement,h),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){var n=m.get(this),r=n.cachedDropIndex,i=this.isMovePossible(e,t),o=this.hot.runHooks("beforeColumnMove",e,t,r,i);if(n.cachedDropIndex=void 0,!1!==o)return i&&this.hot.columnIndexMapper.moveIndexes(e,t),n=i&&this.isColumnOrderChanged(e,t),this.hot.runHooks("afterColumnMove",e,t,r,i,n),n}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){var n=this.countFinalIndex(e,t);return m.get(this).cachedDropIndex=t,this.moveColumns(e,n)}isMovePossible(e,t){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength();var r=e.length+t>n,t=t<0,i=e.some(e=>e<0),e=e.some(e=>e>=n);return!(r||t||i||e)}isColumnOrderChanged(e,n){return e.some((e,t)=>e-t!==n)}countFinalIndex(e,n){e=(0,s.arrayReduce)(e,(e,t)=>(t<n&&(e+=1),e),0);return n-e}getColumnsWidth(t,n){var r=this.hot.columnIndexMapper;let i=0;for(let e=t;e<=n;e+=1){var o=r.getRenderableFromVisualIndex(e);e<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==o&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(o)||0)}return i}moveBySettingsOrLoad(){var e=this.hot.getSettings()[d];Array.isArray(e)?this.moveColumns(e,0):void 0!==e&&(e=this.persistentStateLoad()).length&&this.moveColumns(e,0)}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){var e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value||[]}prepareColumnsToMoving(e,t){const n=[];return(0,a.rangeEach)(e,t,e=>{n.push(e)}),n}refreshPositions(){var e=m.get(this),t=this.hot.view.getFirstFullyVisibleColumn(),n=(this.isFixedColumnsStart(e.hoveredColumn)&&0<t&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.hot.view._wt.wtTable),r=this.hot.view._wt.wtOverlays.scrollableElement,i="number"==typeof r.scrollX?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,e.hoveredColumn-1);var s,a,l=n.hider.offsetWidth,n=n.TBODY.offsetLeft,u=this.backlight.getOffset().start,c=this.backlight.getSize().width;let d=0,h=0,f=(h=this.hot.isRtl()?(a=this.hot.rootWindow,s=(0,g.outerWidth)(this.hot.rootElement),s=a.innerWidth-e.rootElementOffset-s,a.innerWidth-e.target.eventPageX-s-(void 0===r.scrollX?i:0)):e.target.eventPageX-(e.rootElementOffset-(void 0===r.scrollX?i:0)),e.hasRowHeaders&&(d=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(e.hoveredColumn)&&(o+=i),o+=d,e.hoveredColumn<0?0<e.fixedColumnsStart?e.target.col=0:e.target.col=0<t?t-1:t:e.target.TD.offsetWidth/2+o<=h?(a=e.hoveredColumn>=e.countCols?e.countCols-1:e.hoveredColumn,e.target.col=a+1,o+=e.target.TD.offsetWidth):e.target.col=e.hoveredColumn,h),p=o;h+c+u>=l?f=l-c-u:h+u<n+d&&(f=n+d+Math.abs(u)),o>=l-1?p=l-1:0===p?p=1:void 0!==r.scrollX&&e.hoveredColumn<e.fixedColumnsStart&&(p-=e.rootElementOffset<=r.scrollX?e.rootElementOffset:0),this.backlight.setPosition(null,f),this.guideline.setPosition(null,p)}registerEvents(){var e=this.hot.rootDocument["documentElement"];this.eventManager.addEventListener(e,"mousemove",e=>this.onMouseMove(e)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp())}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(e,t,n,r){var i,o=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),l=m.get(this),u=(0,g.hasClass)(e.target,"sortAction");!a||!s||l.pressed||0!==e.button||u?(l.pressed=!1,(l.columnsToMove.length=0,g.removeClass)(this.hot.rootElement,[p,f])):(s=this.guideline.isBuilt()&&!this.guideline.isAppended(),u=this.backlight.isBuilt()&&!this.backlight.isAppended(),{from:s,to:u}=(s&&u&&(this.guideline.appendTo(o.hider),this.backlight.appendTo(o.hider)),a),a=Math.min(s.col,u.col),s=Math.max(s.col,u.col),t.row<0&&t.col>=a&&t.col<=s?(r.column=!0,l.pressed=!0,l.target.eventPageX=e.pageX,l.target.eventOffsetX=e.offsetX,l.hoveredColumn=t.col,l.target.TD=n,l.target.col=t.col,l.columnsToMove=this.prepareColumnsToMoving(a,s),l.hasRowHeaders=!!this.hot.getSettings().rowHeaders,l.countCols=this.hot.countCols(),l.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,l.rootElementOffset=(0,g.offset)(this.hot.rootElement).left,u=l.hasRowHeaders?-1:0,r=o.holder.scrollTop+o.getColumnHeaderHeight(0)+1,n=t.col<l.fixedColumnsStart,i=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),e=Math.abs(e.offsetX-(this.hot.isRtl()?e.target.offsetWidth:0)),t=this.getColumnsWidth(a,t.col-1)+e,e=this.getColumnsWidth(u,a-1)+(n?i:0)+t,this.backlight.setPosition(r,e),this.backlight.setSize(this.getColumnsWidth(a,s),o.hider.offsetHeight-r),this.backlight.setOffset(null,-t),(0,g.addClass)(this.hot.rootElement,p)):((0,g.removeClass)(this.hot.rootElement,y),l.pressed=!1,l.columnsToMove.length=0))}onMouseMove(e){var t=m.get(this);if(t.pressed){if(e.target===this.backlight.element){const n=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(n)})}t.target.eventPageX=e.pageX,this.refreshPositions()}}onBeforeOnCellMouseOver(e,t,n,r){var i=this.hot.getSelectedRangeLast(),o=m.get(this);i&&o.pressed&&((-1<o.columnsToMove.indexOf(t.col)?(0,g.removeClass):(0,g.addClass))(this.hot.rootElement,f),r.row=!0,r.column=!0,r.cell=!0,o.hoveredColumn=t.col,o.target.TD=n)}onMouseUp(){var e,t=m.get(this),n=t.target.col,r=t.columnsToMove.length;t.hoveredColumn=void 0,t.pressed=!1,(t.backlightWidth=0,g.removeClass)(this.hot.rootElement,[p,f,y]),this.hot.selection.isSelectedByColumnHeader()&&(0,g.addClass)(this.hot.rootElement,y),r<1||void 0===n||(e=t.columnsToMove[0],e=this.hot.toPhysicalColumn(e),n=this.dragColumns(t.columnsToMove,n),!(t.columnsToMove.length=0)===n&&(this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0),t=this.hot.toVisualColumn(e),this.hot.selectColumns(t,t+r-1)))}onAfterScrollVertically(){var e=this.hot.view._wt.wtTable,t=e.getColumnHeaderHeight(0)+1+e.holder.scrollTop;this.backlight.setPosition(t),this.backlight.setSize(null,e.hider.offsetHeight-t)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}t.ManualColumnMove=v},(e,t,n)=>{"use strict";var r=n(196),r=(t.__esModule=!0,r(n(853))),i=n(302);class o extends r.default{build(){super.build(),(0,i.addClass)(this._element,"ht__manualColumnMove--backlight")}}t.default=o},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(461),i=n(303);t.default=class{constructor(e){this.hot=e,this._element=null,this.state=0,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return 1<=this.state}setPosition(e,t){(0,r.isNumeric)(e)&&(this._element.style.top=e+"px"),(0,r.isNumeric)(t)&&(this._element.style[this.inlineProperty]=t+"px")}getPosition(){var e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){(0,r.isNumeric)(e)&&(this._element.style.width=e+"px"),(0,r.isNumeric)(t)&&(this._element.style.height=t+"px")}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){(0,r.isNumeric)(e)&&(this._element.style.marginTop=e+"px"),(0,r.isNumeric)(t)&&(this._element.style["margin"+(0,i.toUpperCaseFirst)(this.inlineProperty)]=t+"px")}getOffset(){var e=this._element.style,t="margin"+(0,i.toUpperCaseFirst)(this.inlineProperty);return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}}},(e,t,n)=>{"use strict";var r=n(196),r=(t.__esModule=!0,r(n(853))),i=n(302);class o extends r.default{build(){super.build(),(0,i.addClass)(this._element,"ht__manualColumnMove--guideline")}}t.default=o},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(857);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.ManualColumnResize=n.ManualColumnResize},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),n(688)),a=n(302),o=r(n(457)),l=n(444),u=n(461),s=n(543);const c="manualColumnResize",d=(t.PLUGIN_KEY=c,t.PLUGIN_PRIORITY=130,"manualColumnWidths"),h=new WeakMap;class f extends i.BasePlugin{static get PLUGIN_KEY(){return c}static get PLUGIN_PRIORITY(){return 130}constructor(e){super(e);e=this.hot.rootDocument;this.currentTH=null,this.currentCol=null,this.selectedCols=[],this.currentWidth=null,this.newSize=null,this.startY=null,this.startWidth=null,this.startOffset=null,this.handle=e.createElement("DIV"),this.guide=e.createElement("DIV"),this.eventManager=new o.default(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.columnWidthsMap=void 0,h.set(this,{config:void 0}),(0,a.addClass)(this.handle,"manualColumnResizer"),(0,a.addClass)(this.guide,"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[c]}enablePlugin(){this.enabled||(this.columnWidthsMap=new s.PhysicalIndexToValueMap,this.columnWidthsMap.addLocalHook("init",()=>this.onMapInit()),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(e,t)=>this.onModifyColWidth(e,t)),this.addHook("beforeStretchingColumnWidth",(e,t)=>this.onBeforeStretchingColumnWidth(e,t)),this.addHook("beforeColumnResize",(e,t,n)=>this.onBeforeColumnResize(e,t,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){h.get(this).config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",d,this.columnWidthsMap.getValues())}loadManualColumnWidths(){var e={};return this.hot.runHooks("persistentStateLoad",d,e),e.value}setManualSize(e,t){t=Math.max(t,20),e=this.hot.toPhysicalColumn(e);return this.columnWidthsMap.setValueAtIndex(e,t),t}clearManualSize(e){e=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(e,null)}onMapInit(){const e=h.get(this),t=this.hot.getSettings()[c],n=this.loadManualColumnWidths();void 0!==n?this.hot.batchExecution(()=>{n.forEach((e,t)=>{this.columnWidthsMap.setValueAtIndex(t,e)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((e,t)=>{this.columnWidthsMap.setValueAtIndex(t,e)})},!0),e.config=t):!0===t&&Array.isArray(e.config)&&this.hot.batchExecution(()=>{e.config.forEach((e,t)=>{this.columnWidthsMap.setValueAtIndex(t,e)})},!0)}setupHandlePosition(t){if(t.parentNode){this.currentTH=t;var t=this.hot.view["_wt"],n=t.wtTable.getCoords(this.currentTH),r=n.col;if(!(r<0)){var i=(0,a.outerHeight)(this.currentTH),o=this.currentTH.getBoundingClientRect(),s=r<t.getSetting("fixedColumnsStart");let e;e=(e=s?t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,n.row,n.col):e)||t.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,n.row,n.col),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),this.selectedCols=[];s=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();this.hot.selection.isSelected()&&s&&(t=this.hot.getSelectedRange(),(0,l.arrayEach)(t,e=>{var t=e.getTopStartCorner().col,e=e.getBottomEndCorner().col;(0,u.rangeEach)(t,e,e=>{this.selectedCols.includes(e)||this.selectedCols.push(e)})})),this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=e.start-6,this.startWidth=parseInt(o.width,10),this.handle.style.top=e.top+"px",this.handle.style[this.inlineDir]=this.startOffset+this.startWidth+"px",this.handle.style.height=i+"px",this.hot.rootElement.appendChild(this.handle)}}}refreshHandlePosition(){this.handle.style[this.inlineDir]=this.startOffset+this.currentWidth+"px"}setupGuidePosition(){var e=parseInt((0,a.outerHeight)(this.handle),10),t=parseInt(this.handle.style.top,10)+e,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);(0,a.addClass)(this.handle,"active"),(0,a.addClass)(this.guide,"active"),this.guide.style.top=t+"px",this.refreshGuidePosition(),this.guide.style.height=n-e+"px",this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}hideHandleAndGuide(){(0,a.removeClass)(this.handle,"active"),(0,a.removeClass)(this.guide,"active")}checkIfColumnHeader(e){return!!(0,a.closest)(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}onMouseOver(e){var t;(0,a.isDetached)(e.target)||!0!==this.isTriggeredByRMB&&this.checkIfColumnHeader(e.target)&&(e=this.getClosestTHParent(e.target))&&(t=e.getAttribute("colspan"),!e||null!==t&&"1"!==t||this.pressed||this.setupHandlePosition(e))}afterMouseDownTimeout(){const r=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(e,t)=>{var n=this.hot.runHooks("beforeColumnResize",this.newSize,e,!0);void 0!==n&&(this.newSize=n),"all"===this.hot.getSettings().stretchH?this.clearManualSize(e):this.setManualSize(e,this.newSize),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,e,!0),t&&r()};2<=this.dblclick&&(1<this.selectedCols.length?((0,l.arrayEach)(this.selectedCols,e=>{t(e)}),r()):(0,l.arrayEach)(this.selectedCols,e=>{t(e,!0)})),this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(e){(0,a.hasClass)(e.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=e.pageX,this.newSize=this.startWidth)}onMouseMove(e){this.pressed&&(e=(e.pageX-this.startX)*this.hot.getDirectionFactor(),this.currentWidth=this.startWidth+e,(0,l.arrayEach)(this.selectedCols,e=>{this.newSize=this.setManualSize(e,this.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition())}onMouseUp(){const n=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(e,t)=>{this.hot.runHooks("beforeColumnResize",this.newSize,e,!1),t&&n(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,e,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth&&(1<this.selectedCols.length?((0,l.arrayEach)(this.selectedCols,e=>{t(e)}),n()):(0,l.arrayEach)(this.selectedCols,e=>{t(e,!0)})),this.setupHandlePosition(this.currentTH))}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}bindEvents(){var{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",e=>this.onMouseOver(e)),this.eventManager.addEventListener(t,"mousedown",e=>this.onMouseDown(e)),this.eventManager.addEventListener(e,"mousemove",e=>this.onMouseMove(e)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.handle,"contextmenu",()=>this.onContextMenu())}onModifyColWidth(e,t){let n=e;return n=this.enabled&&(e=this.hot.toPhysicalColumn(t),t=this.columnWidthsMap.getValueAtIndex(e),this.hot.getSettings()[c])&&t?t:n}onBeforeStretchingColumnWidth(e,t){let n=this.columnWidthsMap.getValueAtIndex(t);return n=null===n?e:n}onBeforeColumnResize(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}destroy(){super.destroy()}}t.ManualColumnResize=f},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(859);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.ManualRowMove=n.ManualRowMove},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),n(688)),o=r(n(454)),s=n(444),g=n(302),a=n(461),l=r(n(457)),u=r(n(860)),c=r(n(862));n(863),o.default.getSingleton().register("beforeRowMove"),o.default.getSingleton().register("afterRowMove");const d="manualRowMove",m=(t.PLUGIN_KEY=d,t.PLUGIN_PRIORITY=140,new WeakMap),h="ht__manualRowMove",f="show-ui",p="on-moving--rows",y="after-selection--rows";class v extends i.BasePlugin{static get PLUGIN_KEY(){return d}static get PLUGIN_PRIORITY(){return 140}constructor(e){super(e),m.set(this,{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),this.eventManager=new l.default(this),this.backlight=new u.default(e),this.guideline=new c.default(e)}isEnabled(){return!!this.hot.getSettings()[d]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterScrollHorizontally",()=>this.onAfterScrollHorizontally()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.buildPluginUI(),this.registerEvents(),(0,g.addClass)(this.hot.rootElement,h),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){(0,g.removeClass)(this.hot.rootElement,h),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){var n=m.get(this),r=n.cachedDropIndex,i=this.isMovePossible(e,t),o=this.hot.runHooks("beforeRowMove",e,t,r,i);if(n.cachedDropIndex=void 0,!1!==o)return i&&this.hot.rowIndexMapper.moveIndexes(e,t),n=i&&this.isRowOrderChanged(e,t),this.hot.runHooks("afterRowMove",e,t,r,i,n),n}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){var n=this.countFinalIndex(e,t);return m.get(this).cachedDropIndex=t,this.moveRows(e,n)}isMovePossible(e,t){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();var r=e.length+t>n,t=t<0,i=e.some(e=>e<0),e=e.some(e=>e>=n);return!(r||t||i||e)}isRowOrderChanged(e,n){return e.some((e,t)=>e-t!==n)}countFinalIndex(e,n){e=(0,s.arrayReduce)(e,(e,t)=>(t<n&&(e+=1),e),0);return n-e}getRowsHeight(t,n){var r=this.hot.rowIndexMapper;let i=0;for(let e=t;e<=n;e++){var o=r.getRenderableFromVisualIndex(e);null!==o&&(i+=this.hot.view._wt.wtTable.getRowHeight(o)||23)}return i}moveBySettingsOrLoad(){var e=this.hot.getSettings()[d];Array.isArray(e)?this.moveRows(e,0):void 0!==e&&(e=this.persistentStateLoad()).length&&this.moveRows(e,0)}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){var e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value||[]}prepareRowsToMoving(){var e,t,n=this.hot.getSelectedRangeLast();const r=[];return n&&({from:n,to:e}=n,t=Math.min(n.row,e.row),n=Math.max(n.row,e.row),(0,a.rangeEach)(t,n,e=>{r.push(e)})),r}refreshPositions(){var e=m.get(this),t=e.target.coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows(),i=(this.isFixedRowTop(t.row)&&0<n&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(t.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0),this.hot.view._wt.wtTable),r=e.target.TD,o=this.hot.rootElement,s=(0,g.offset)(o),o=(0,g.getTrimmingContainer)(o),a=i.holder.scrollTop;let l;l=this.hot.rootWindow===o?o.scrollY:o.scrollTop;var o=s.top-l,s=e.target.eventPageY-o+a,o=i.hider.offsetHeight,a=i.TBODY.offsetTop,u=this.backlight.getOffset().top,c=this.backlight.getSize().height,d=r.offsetHeight/2,r=r.offsetHeight;let h=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1);d=s>=h+d;this.isFixedRowTop(t.row)&&(h+=i.holder.scrollTop),t.row<0?e.target.row=0<n?n-1:n:d?(e.target.row=t.row+1,h+=0===t.row?r-1:r):e.target.row=t.row;let f=s,p=h;o<=s+c+u?f=o-c-u:s+u<a&&(f=a+Math.abs(u)),h>=o-1&&(p=o-1),this.backlight.setPosition(f),this.guideline.setPosition(p)}registerEvents(){var e=this.hot.rootDocument["documentElement"];this.eventManager.addEventListener(e,"mousemove",e=>this.onMouseMove(e)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp())}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(e,t,n,r){var i,{wtTable:o,wtViewport:s}=this.hot.view._wt,a=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast(),u=m.get(this);l&&a&&!u.pressed&&0===e.button?(a=this.guideline.isBuilt()&&!this.guideline.isAppended(),i=this.backlight.isBuilt()&&!this.backlight.isAppended(),{from:a,to:i}=(a&&i&&(this.guideline.appendTo(o.hider),this.backlight.appendTo(o.hider)),l),l=Math.min(a.row,i.row),a=Math.max(a.row,i.row),t.col<0&&t.row>=l&&t.row<=a?(r.row=!0,u.pressed=!0,u.target.eventPageY=e.pageY,u.target.coords=t,u.target.TD=n,u.rowsToMove=this.prepareRowsToMoving(),i=o.holder.scrollLeft+s.getRowHeaderWidth(),this.backlight.setPosition(null,i),this.backlight.setSize(o.hider.offsetWidth-i,this.getRowsHeight(l,a)),this.backlight.setOffset(-1*(this.getRowsHeight(l,t.row-1)+e.offsetY),null),(0,g.addClass)(this.hot.rootElement,p),this.refreshPositions()):((0,g.removeClass)(this.hot.rootElement,y),u.pressed=!1,u.rowsToMove.length=0)):(u.pressed=!1,(u.rowsToMove.length=0,g.removeClass)(this.hot.rootElement,[p,f]))}onMouseMove(e){var t=m.get(this);if(t.pressed){if(e.target===this.backlight.element){const n=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,n)})}t.target.eventPageY=e.pageY,this.refreshPositions()}}onBeforeOnCellMouseOver(e,t,n,r){var i=this.hot.getSelectedRangeLast(),o=m.get(this);i&&o.pressed&&((-1<o.rowsToMove.indexOf(t.row)?(0,g.removeClass):(0,g.addClass))(this.hot.rootElement,f),r.row=!0,r.column=!0,r.cell=!0,o.target.coords=t,o.target.TD=n)}onMouseUp(){var e,t=m.get(this),n=t.target.row,r=t.rowsToMove.length;t.pressed=!1,(t.backlightHeight=0,g.removeClass)(this.hot.rootElement,[p,f,y]),this.hot.selection.isSelectedByRowHeader()&&(0,g.addClass)(this.hot.rootElement,y),r<1||void 0===n||(e=t.rowsToMove[0],e=this.hot.toPhysicalRow(e),n=this.dragRows(t.rowsToMove,n),!(t.rowsToMove.length=0)===n&&(this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0),t=this.hot.toVisualRow(e),this.hot.selectRows(t,t+r-1)))}onAfterScrollHorizontally(){var e=this.hot.view._wt.wtTable,t=this.hot.view._wt.wtViewport.getRowHeaderWidth()+e.holder.scrollLeft;this.backlight.setPosition(null,t),this.backlight.setSize(e.hider.offsetWidth-t)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}t.ManualRowMove=v},(e,t,n)=>{"use strict";var r=n(196),r=(t.__esModule=!0,r(n(861))),i=n(302);class o extends r.default{build(){super.build(),(0,i.addClass)(this._element,"ht__manualRowMove--backlight")}}t.default=o},(e,t)=>{"use strict";t.__esModule=!0;t.default=class{constructor(e){this.hot=e,this._element=null,this.state=0}appendTo(e){e.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return 1<=this.state}setPosition(e,t){void 0!==e&&(this._element.style.top=e+"px"),void 0!==t&&(this._element.style.left=t+"px")}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+"px"),t&&(this._element.style.height=t+"px")}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+"px"),t&&(this._element.style.marginLeft=t+"px")}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}},(e,t,n)=>{"use strict";var r=n(196),r=(t.__esModule=!0,r(n(861))),i=n(302);class o extends r.default{build(){super.build(),(0,i.addClass)(this._element,"ht__manualRowMove--guideline")}}t.default=o},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(865);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.ManualRowResize=n.ManualRowResize},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),n(688)),l=n(302),o=r(n(457)),u=n(444),c=n(461),s=n(543),a=n(476);const d="manualRowResize",h=(t.PLUGIN_KEY=d,t.PLUGIN_PRIORITY=30,"manualRowHeights"),f=new WeakMap;class p extends i.BasePlugin{static get PLUGIN_KEY(){return d}static get PLUGIN_PRIORITY(){return 30}constructor(e){super(e);e=this.hot.rootDocument;this.currentTH=null,this.currentRow=null,this.selectedRows=[],this.currentHeight=null,this.newSize=null,this.startY=null,this.startHeight=null,this.startOffset=null,this.handle=e.createElement("DIV"),this.guide=e.createElement("DIV"),this.eventManager=new o.default(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.rowHeightsMap=void 0,f.set(this,{config:void 0}),(0,l.addClass)(this.handle,"manualRowResizer"),(0,l.addClass)(this.guide,"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[d]}enablePlugin(){this.enabled||(this.rowHeightsMap=new s.PhysicalIndexToValueMap,this.rowHeightsMap.addLocalHook("init",()=>this.onMapInit()),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(e,t)=>this.onModifyRowHeight(e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){f.get(this).config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",h,this.rowHeightsMap.getValues())}loadManualRowHeights(){var e={};return this.hot.runHooks("persistentStateLoad",h,e),e.value}setManualSize(e,t){e=this.hot.toPhysicalRow(e),t=Math.max(t,a.ViewportRowsCalculator.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(e,t),t}setupHandlePosition(t){this.currentTH=t;var t=this.hot["view"],n=t["_wt"],r=n.wtTable.getCoords(this.currentTH),i=r.row;if(!(i<0)){var o=(0,l.outerWidth)(this.currentTH),s=this.currentTH.getBoundingClientRect(),a=i<n.getSetting("fixedRowsTop"),t=i>=t.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let e;a?e=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col):t&&(e=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),e=e||n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.selectedRows=[];a=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();this.hot.selection.isSelected()&&a&&(t=this.hot.getSelectedRange(),(0,u.arrayEach)(t,e=>{var t=e.getTopStartCorner().row,e=e.getBottomStartCorner().row;(0,c.rangeEach)(t,e,e=>{this.selectedRows.includes(e)||this.selectedRows.push(e)})})),this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=e.top-6,this.startHeight=parseInt(s.height,10),this.handle.style.top=this.startOffset+this.startHeight+"px",this.handle.style[this.inlineDir]=e.start+"px",this.handle.style.width=o+"px",this.hot.rootElement.appendChild(this.handle)}}refreshHandlePosition(){this.handle.style.top=this.startOffset+this.currentHeight+"px"}setupGuidePosition(){var e=parseInt((0,l.outerWidth)(this.handle),10),t=parseInt(this.handle.style[this.inlineDir],10)+e,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);(0,l.addClass)(this.handle,"active"),(0,l.addClass)(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]=t+"px",this.guide.style.width=n-e+"px",this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style.top=this.handle.style.top}hideHandleAndGuide(){(0,l.removeClass)(this.handle,"active"),(0,l.removeClass)(this.guide,"active")}checkIfRowHeader(e){return(0,l.closest)(e,["TH"],this.hot.rootElement)&&"TBODY"===(null==(e=e.parentNode)||null==(e=e.parentNode)?void 0:e.tagName)}getClosestTHParent(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){e=this.hot.view._wt.wtTable.getRowHeight(e);return void 0!==e&&this.newSize<e?e:this.newSize}onMouseOver(e){(0,l.isDetached)(e.target)||!0!==this.isTriggeredByRMB&&this.checkIfRowHeader(e.target)&&(e=this.getClosestTHParent(e.target))&&!this.pressed&&this.setupHandlePosition(e)}afterMouseDownTimeout(){const r=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(e,t)=>{var n=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!0);void 0!==n&&(this.newSize=n),this.setManualSize(e,this.newSize),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!0),t&&r()};2<=this.dblclick&&(1<this.selectedRows.length?((0,u.arrayEach)(this.selectedRows,e=>{t(e)}),r()):(0,u.arrayEach)(this.selectedRows,e=>{t(e,!0)})),this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(e){(0,l.hasClass)(e.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=e.pageY,this.newSize=this.startHeight)}onMouseMove(e){this.pressed&&(this.currentHeight=this.startHeight+(e.pageY-this.startY),(0,u.arrayEach)(this.selectedRows,e=>{this.newSize=this.setManualSize(e,this.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}onMouseUp(){const n=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(e,t)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!1),t&&n(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight&&(1<this.selectedRows.length?((0,u.arrayEach)(this.selectedRows,e=>{t(e)}),n()):(0,u.arrayEach)(this.selectedRows,e=>{t(e,!0)})),this.setupHandlePosition(this.currentTH))}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}bindEvents(){var{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",e=>this.onMouseOver(e)),this.eventManager.addEventListener(e,"mousedown",e=>this.onMouseDown(e)),this.eventManager.addEventListener(t,"mousemove",e=>this.onMouseMove(e)),this.eventManager.addEventListener(t,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.handle,"contextmenu",()=>this.onContextMenu())}onModifyRowHeight(e,t){let n=e;return n=this.enabled&&(e=this.hot.toPhysicalRow(t),t=this.rowHeightsMap.getValueAtIndex(e),this.hot.getSettings()[d])&&t?t:n}onMapInit(){const e=f.get(this),t=this.hot.getSettings()[d],n=this.loadManualRowHeights();this.hot.batchExecution(()=>{void 0!==n?n.forEach((e,t)=>{this.rowHeightsMap.setValueAtIndex(t,e)}):Array.isArray(t)?(t.forEach((e,t)=>{this.rowHeightsMap.setValueAtIndex(t,e)}),e.config=t):!0===t&&Array.isArray(e.config)&&e.config.forEach((e,t)=>{this.rowHeightsMap.setValueAtIndex(t,e)})},!0)}destroy(){super.destroy()}}t.ManualRowResize=p},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(867);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.MergeCells=n.MergeCells},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),n(688)),o=r(n(454)),s=r(n(868)),a=r(n(869)),l=r(n(871)),u=r(n(872)),c=r(n(873)),d=n(444),h=n(447),f=n(455),p=n(461),g=n(870),m=(n(874),n(302)),y=n(446);o.default.getSingleton().register("beforeMergeCells"),o.default.getSingleton().register("afterMergeCells"),o.default.getSingleton().register("beforeUnmergeCells"),o.default.getSingleton().register("afterUnmergeCells");const v="mergeCells",b=(t.PLUGIN_KEY=v,t.PLUGIN_PRIORITY=150,new WeakMap),E=v;class C extends i.BasePlugin{static get PLUGIN_KEY(){return v}static get PLUGIN_PRIORITY(){return 150}constructor(e){super(e),b.set(this,{lastDesiredCoords:null}),this.mergedCellsCollection=null,this.autofillCalculations=null,this.selectionCalculations=null}isEnabled(){return!!this.hot.getSettings()[v]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new s.default(this),this.autofillCalculations=new l.default(this),this.selectionCalculations=new u.default(this),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("modifyTransformStart",function(){return e.onModifyTransformStart(...arguments)}),this.addHook("afterModifyTransformStart",function(){return e.onAfterModifyTransformStart(...arguments)}),this.addHook("modifyTransformEnd",function(){return e.onModifyTransformEnd(...arguments)}),this.addHook("modifyGetCellCoords",function(){return e.onModifyGetCellCoords(...arguments)}),this.addHook("beforeSetRangeStart",function(){return e.onBeforeSetRangeStart(...arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return e.onBeforeSetRangeStart(...arguments)}),this.addHook("beforeSetRangeEnd",function(){return e.onBeforeSetRangeEnd(...arguments)}),this.addHook("afterIsMultipleSelection",function(){return e.onAfterIsMultipleSelection(...arguments)}),this.addHook("afterRenderer",function(){return e.onAfterRenderer(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return e.addMergeActionsToContextMenu(...arguments)}),this.addHook("afterGetCellMeta",function(){return e.onAfterGetCellMeta(...arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return e.onAfterViewportRowCalculatorOverride(...arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return e.onAfterViewportColumnCalculatorOverride(...arguments)}),this.addHook("modifyAutofillRange",function(){return e.onModifyAutofillRange(...arguments)}),this.addHook("afterCreateCol",function(){return e.onAfterCreateCol(...arguments)}),this.addHook("afterRemoveCol",function(){return e.onAfterRemoveCol(...arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow(...arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow(...arguments)}),this.addHook("afterChange",function(){return e.onAfterChange(...arguments)}),this.addHook("beforeDrawBorders",function(){return e.onBeforeDrawAreaBorders(...arguments)}),this.addHook("afterDrawSelection",function(){return e.onAfterDrawSelection(...arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return e.onBeforeRemoveCellClassNames(...arguments)}),this.addHook("beforeUndoStackChange",(e,t)=>{if("MergeCells"===t)return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){var e=this.hot.getSettings()[v];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if((0,y.isChrome)()){const n=[];let r=[];this.mergedCellsCollection.mergedCells.forEach(e=>{var{row:t,rowspan:n}=e;for(let e=t+1;e<t+n;e++)r.push(e)}),(r=[...new Set(r)]).forEach(e=>{const t=this.hot.rowIndexMapper.getRenderableFromVisualIndex(e);this.hot.view._wt.wtOverlays.getOverlays(!0).map(e=>"master"===(null==e?void 0:e.name)?e:e.clone.wtTable).forEach(e=>{e=e.getRow(t);e&&(e.style.background=(0,m.getStyle)(e,"backgroundColor").replace(")",", 0.99)"),n.push(e))})}),this.hot._registerTimeout(()=>{n.forEach(e=>{e.style.background=(0,m.getStyle)(e,"backgroundColor").replace(", 0.99)",")")})},1)}}validateSetting(e){let t=!0;return!!e&&(a.default.containsNegativeValues(e)?((0,f.warn)(a.default.NEGATIVE_VALUES_WARNING(e)),t=!1):a.default.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?((0,f.warn)(a.default.IS_OUT_OF_BOUNDS_WARNING(e)),t=!1):a.default.isSingleCell(e)?((0,f.warn)(a.default.IS_SINGLE_CELL(e)),t=!1):a.default.containsZeroSpan(e)&&((0,f.warn)(a.default.ZERO_SPAN_WARNING(e)),t=!1),t)}generateFromSettings(e){if(Array.isArray(e)){const r=[];(0,d.arrayEach)(e,n=>{var e,t;this.validateSetting(n)&&(t=this.hot._createCellCoords(n.row,n.col),e=this.hot._createCellCoords(n.row+n.rowspan-1,n.col+n.colspan-1),t=this.hot._createCellRange(t,t,e),this.mergeRange(t,!0,!0),(0,p.rangeEach)(n.row,n.row+n.rowspan-1,t=>{(0,p.rangeEach)(n.col,n.col+n.colspan-1,e=>{!1==(t===n.row&&e===n.col)&&r.push([t,e,null])})}))}),0!==r.length&&this.hot.setDataAtCell(r)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return!!(1<arguments.length&&void 0!==arguments[1]&&arguments[1])||this.validateSetting(e)}toggleMergeOnSelection(){var e,t,n=this.hot.getSelectedRangeLast();n&&(n.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE"),{from:e,to:t}=n,this.toggleMerge(n),this.hot.selectCell(e.row,e.col,t.row,t.col,!1))}mergeSelection(){var e,t,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();n&&(n.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE"),{from:e,to:t}=n,this.unmergeRange(n,!0),this.mergeRange(n),this.hot.selectCell(e.row,e.col,t.row,t.col,!1))}unmergeSelection(){var e,t,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();n&&({from:e,to:t}=n,this.unmergeRange(n,!0),this.hot.selectCell(e.row,e.col,t.row,t.col,!1))}mergeRange(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r=e.getTopStartCorner(),i=e.getBottomEndCorner();const o={row:r.row,col:r.col,rowspan:i.row-r.row+1,colspan:i.col-r.col+1},s=[];let a=null;return!!this.canMergeRange(o,t)&&(this.hot.runHooks("beforeMergeCells",e,t),(0,p.rangeEach)(0,o.rowspan-1,n=>{(0,p.rangeEach)(0,o.colspan-1,e=>{let t=null;s[n]||(s[n]=[]),0===n&&0===e?t=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+n,o.col+e,"hidden",!0),s[n][e]=t})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),!this.mergedCellsCollection.add(o)||(n?a=[o.row,o.col,s]:this.hot.populateFromArray(o.row,o.col,s,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,t),a))}unmergeRange(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=this.mergedCellsCollection.getWithinRange(e);n&&(this.hot.runHooks("beforeUnmergeCells",e,t),(0,d.arrayEach)(n,n=>{this.mergedCellsCollection.remove(n.row,n.col),(0,p.rangeEach)(0,n.rowspan-1,t=>{(0,p.rangeEach)(0,n.colspan-1,e=>{this.hot.removeCellMeta(n.row+t,n.col+e,"hidden"),this.hot.removeCellMeta(n.row+t,n.col+e,"copyable")})}),this.hot.removeCellMeta(n.row,n.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){var t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,n,r){e=this.hot._createCellCoords(e,t),t=this.hot._createCellCoords(n,r);this.mergeRange(this.hot._createCellRange(e,e,t))}unmerge(e,t,n,r){e=this.hot._createCellCoords(e,t),t=this.hot._createCellCoords(n,r);this.unmergeRange(this.hot._createCellRange(e,e,t))}onAfterInit(){this.generateFromSettings(this.hot.getSettings()[v]),this.hot.render()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render()},runOnlyIf:e=>!e.altKey,group:E})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(E)}onAfterIsMultipleSelection(e){if(e){var t=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast();for(let e=0;e<t.length;e+=1)if(n.from.row===t[e].row&&n.from.col===t[e].col&&n.to.row===t[e].row+t[e].rowspan-1&&n.to.col===t[e].col+t[e].colspan-1)return!1}return e}onModifyTransformStart(e){var t=b.get(this),n=this.hot.getSelectedRangeLast();let r={row:e.row,col:e.col};var i,o=this.hot._createCellCoords(n.highlight.row,n.highlight.col),s=this.mergedCellsCollection.get(o.row,o.col),a=(t.lastDesiredCoords||(t.lastDesiredCoords=this.hot._createCellCoords(null,null)),s&&(i=this.hot._createCellCoords(s.row,s.col),a=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),this.hot._createCellRange(i,i,a).includes(t.lastDesiredCoords)||(t.lastDesiredCoords=this.hot._createCellCoords(null,null)),r.row=t.lastDesiredCoords.row?t.lastDesiredCoords.row-o.row:r.row,r.col=t.lastDesiredCoords.col?t.lastDesiredCoords.col-o.col:r.col,0<e.row?r.row=s.row+s.rowspan-1-o.row+e.row:e.row<0&&(r.row=o.row-s.row+e.row),0<e.col?r.col=s.col+s.colspan-1-o.col+e.col:e.col<0&&(r.col=o.col-s.col+e.col)),i=this.hot._createCellCoords(n.highlight.row+r.row,n.highlight.col+r.col),this.mergedCellsCollection.get(i.row,i.col));a&&(s=this.mergedCellsCollection.getFirstRenderableCoords(a.row,a.col),t.lastDesiredCoords=i,r={row:s.row-o.row,col:s.col-o.col}),0!==r.row&&(e.row=r.row),0!==r.col&&(e.col=r.col)}onModifyTransformEnd(e){const t=this.hot.getSelectedRangeLast(),n=(0,h.clone)(e);for(var r,i=this.selectionCalculations.getUpdatedSelectionRange(t,e),o=((0,h.clone)(n),this.mergedCellsCollection.getWithinRange(i,!0));r=(0,h.clone)(n),this.selectionCalculations.getUpdatedSelectionRange(t,n),(0,d.arrayEach)(o,e=>{this.selectionCalculations.snapDelta(n,t,e)}),n.row!==r.row||n.col!==r.col;);e.row=n.row,e.col=n.col}onModifyGetCellCoords(e,t){if(!(e<0||t<0)){var n,r,e=this.mergedCellsCollection.get(e,t);if(e)return{row:t,col:e,colspan:n,rowspan:r}=e,[t,e,t+r-1,e+n-1]}}addMergeActionsToContextMenu(e){e.items.push({name:"---------"},(0,c.default)(this))}onAfterRenderer(e,t,n){var r,i,o,s,a,l,u=this.mergedCellsCollection.get(t,n),u=(0,h.isObject)(u)?(0,h.clone)(u):void 0;(0,h.isObject)(u)&&({rowIndexMapper:r,columnIndexMapper:i}=this.hot,{row:o,col:a,colspan:l,rowspan:s}=u,[o,s]=this.translateMergedCellToRenderable(o,s,a,l),a=o-r.getRenderableFromVisualIndex(t)+1,l=s-i.getRenderableFromVisualIndex(n)+1,u.row=r.getNearestNotHiddenIndex(u.row,1),u.col=i.getNearestNotHiddenIndex(u.col,1),u.rowspan=Math.min(u.rowspan,a),u.colspan=Math.min(u.colspan,l)),(0,g.applySpanProperties)(e,u,t,n)}onBeforeSetRangeStart(e){var t;this.mergedCellsCollection.isFirstRenderableMergedCell(e.row,e.col)&&(t=this.mergedCellsCollection.get(e.row,e.col),[e.row,e.col]=[t.row,t.col])}onBeforeSetRangeEnd(t){var n=this.hot.getSelectedRangeLast();n.highlight=this.hot._createCellCoords(n.highlight.row,n.highlight.col),n.to=t;let r=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{r=!1;for(let e=0;e<this.mergedCellsCollection.mergedCells.length;e+=1){var i=this.mergedCellsCollection.mergedCells[e].getRange();n.expandByRange(i)&&(t.row=n.to.row,t.col=n.to.col,r=!0)}}while(r)}onAfterGetCellMeta(e,t,n){var r=this.mergedCellsCollection.get(e,t);r&&(r.row!==e||r.col!==t?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}onAfterViewportRowCalculatorOverride(e){var t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}modifyViewportRowStart(t,n){var r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(t.startRow);for(let e=0;e<n;e+=1){var o=this.mergedCellsCollection.get(i,e);if((0,h.isObject)(o)){o=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o.row,1));if(o<t.startRow)return t.startRow=o,void this.modifyViewportRowStart(t,n)}}}modifyViewportRowEnd(t,n){var r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(t.endRow);for(let e=0;e<n;e+=1){var o=this.mergedCellsCollection.get(i,e);if((0,h.isObject)(o)){o=o.row+o.rowspan-1,o=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1));if(o>t.endRow)return t.endRow=o,void this.modifyViewportRowEnd(t,n)}}}onAfterViewportColumnCalculatorOverride(e){var t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}modifyViewportColumnStart(t,n){var r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(t.startColumn);for(let e=0;e<n;e+=1){var o=this.mergedCellsCollection.get(e,i);if((0,h.isObject)(o)){o=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o.col,1));if(o<t.startColumn)return t.startColumn=o,void this.modifyViewportColumnStart(t,n)}}}modifyViewportColumnEnd(t,n){var r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(t.endColumn);for(let e=0;e<n;e+=1){var o=this.mergedCellsCollection.get(e,i);if((0,h.isObject)(o)){o=o.col+o.colspan-1,o=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1));if(o>t.endColumn)return t.endColumn=o,void this.modifyViewportColumnEnd(t,n)}}}translateMergedCellToRenderable(e,t,n,r){var{rowIndexMapper:i,columnIndexMapper:o}=this.hot;let s,a;return s=0===t?i.getNearestNotHiddenIndex(e,1):i.getNearestNotHiddenIndex(e+t-1,-1),a=0===r?o.getNearestNotHiddenIndex(n,1):o.getNearestNotHiddenIndex(n+r-1,-1),[0<=e?i.getRenderableFromVisualIndex(s):e,0<=n?o.getRenderableFromVisualIndex(a):n]}onModifyAutofillRange(e,t){this.autofillCalculations.correctSelectionAreaSize(t);var n=this.autofillCalculations.getDirection(t,e);let r=e;return r=this.autofillCalculations.dragAreaOverlapsCollections(t,r,n)?t:(e=this.mergedCellsCollection.getWithinRange({from:{row:t[0],col:t[1]},to:{row:t[2],col:t[3]}}),e?this.autofillCalculations.snapDragArea(t,r,n,e):r)}onAfterCreateCol(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}onAfterRemoveCol(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}onAfterCreateRow(e,t,n){"auto"!==n&&this.mergedCellsCollection.shiftCollections("down",e,t)}onAfterRemoveRow(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}onAfterChange(e,t){"Autofill.fill"===t&&this.autofillCalculations.recreateAfterDataPopulation(e)}onBeforeDrawAreaBorders(t,e){if(e&&"area"===e){const n=this.hot.getSelectedRangeLast();e=this.mergedCellsCollection.getWithinRange(n);(0,d.arrayEach)(e,e=>{n.getBottomEndCorner().row===e.getLastRow()&&n.getBottomEndCorner().col===e.getLastColumn()&&(t[2]=e.row,t[3]=e.col)})}}onAfterModifyTransformStart(e,t,n){var r,i,o,s,a,l,u;this.enabled&&(r=this.mergedCellsCollection.get(e.row,e.col))&&(i=0<t,t=t<0,o=n<0,n=0<n,s=r.row+r.rowspan-1==this.hot.countRows()-1,a=0===r.row,l=r.col+r.colspan-1==this.hot.countCols()-1,u=0===r.col,i&&s||t&&a||n&&l||o&&u)&&(e.row=r.row,e.col=r.col)}onAfterDrawSelection(e,t,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,n,r)}onBeforeRemoveCellClassNames(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}t.MergeCells=C},(e,t,n)=>{"use strict";var r=n(196),o=(t.__esModule=!0,n(203),r(n(869))),s=n(461),a=n(455),l=n(444),u=n(870),i=n(443);class c{constructor(e){this.plugin=e,this.mergedCells=[],this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return(0,i.toSingleLine)`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(t,n){var e=this.mergedCells;let r=!1;return(0,l.arrayEach)(e,e=>!(e.row<=t&&e.row+e.rowspan-1>=t&&e.col<=n&&e.col+e.colspan-1>=n&&(r=e,1))),r}getByRange(t){var e=this.mergedCells;let n=!1;return(0,l.arrayEach)(e,e=>!(e.row<=t.from.row&&e.row+e.rowspan-1>=t.to.row&&e.col<=t.from.col&&e.col+e.colspan-1>=t.to.col)||(n=e)),n}getWithinRange(e){let r=1<arguments.length&&void 0!==arguments[1]&&arguments[1];var t,n=this.mergedCells;const i=[];let o=e;return o.includesRange||(e=this.hot._createCellCoords(o.from.row,o.from.col),t=this.hot._createCellCoords(o.to.row,o.to.col),o=this.hot._createCellRange(e,e,t)),(0,l.arrayEach)(n,e=>{var t=this.hot._createCellCoords(e.row,e.col),n=this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1),t=this.hot._createCellRange(t,t,n);r?o.overlaps(t)&&i.push(e):o.includesRange(t)&&i.push(e)}),!!i.length&&i}add(e){var t=this.mergedCells,n=e.row,r=e.col,i=e.rowspan,e=e.colspan,i=new o.default(n,r,i,e,this.hot._createCellCoords,this.hot._createCellRange),e=this.get(n,r),n=this.isOverlapping(i);return e||n?((0,a.warn)(c.IS_OVERLAPPING_WARNING(i)),!1):(this.hot&&i.normalize(this.hot),t.push(i),i)}remove(e,t){var n=this.mergedCells,e=this.get(e,t),t=e?this.mergedCells.indexOf(e):-1;return!(!e||-1===t)&&(n.splice(t,1),e)}clear(){var e=this.mergedCells;const r=[],i=[];(0,l.arrayEach)(e,e=>{var t=this.hot.getCell(e.row,e.col);t&&r.push([t,this.get(e.row,e.col),e.row,e.col])}),(this.mergedCells.length=0,l.arrayEach)(r,(n,e)=>{(0,s.rangeEach)(0,n.rowspan-1,t=>{(0,s.rangeEach)(0,n.colspan-1,e=>{0===e&&0===t||(e=this.hot.getCell(n.row+t,n.col+e))&&i.push([e,null,null,null])})}),r[e][1]=null}),(0,l.arrayEach)(r,e=>{(0,u.applySpanProperties)(...e)}),(0,l.arrayEach)(i,e=>{(0,u.applySpanProperties)(...e)})}isOverlapping(e){const t=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let n=!1;return(0,l.arrayEach)(this.mergedCells,e=>{return!this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1)).overlaps(t)||!(n=!0)}),n}isFirstRenderableMergedCell(e,t){var n=this.get(e,t);return n&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1)===t}getFirstRenderableCoords(e,t){var n=this.get(e,t);return!n||this.isFirstRenderableMergedCell(e,t)||(e=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),t=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1)),this.hot._createCellCoords(e,t)}shiftCollections(e,t,n){const r=[0,0];switch(e){case"right":r[0]+=n;break;case"left":r[0]-=n;break;case"down":r[1]+=n;break;case"up":r[1]-=n}(0,l.arrayEach)(this.mergedCells,e=>{e.shift(r,t)}),(0,s.rangeEachReverse)(this.mergedCells.length-1,0,e=>{e=this.mergedCells[e];e&&e.removed&&this.mergedCells.splice(this.mergedCells.indexOf(e),1)})}}r=c;t.default=r},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(443);t.default=class{constructor(e,t,n,r,i,o){this.row=e,this.col=t,this.rowspan=n,this.colspan=r,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){return(0,r.toSingleLine)`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return(0,r.toSingleLine)`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return(0,r.toSingleLine)`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return(0,r.toSingleLine)`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return 1===e.colspan&&1===e.rowspan}static containsZeroSpan(e){return 0===e.colspan||0===e.rowspan}static isOutOfBounds(e,t,n){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=n||e.col+e.colspan-1>=n}normalize(e){var t=e.countRows(),e=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>e-1&&(this.col=e-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>e-1&&(this.colspan=e-this.col)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){var n,r=e[0]||e[1],i=t+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",e=e[0]?"col":"row",s=Math.min(t,i),i=Math.max(t,i),a=this[e],l=this[e]+this[o]-1;if(t<=a&&(this[e]+=r),0<r)t<=l&&a<t&&(this[o]+=r);else if(r<0){if(s<=a&&l<=i)return!(this.removed=!0);s<=a&&a<=i?(t=i-a+1,n=Math.abs(r)-t,this[e]-=n+r,this[o]-=t):a<=s&&i<=l?this[o]+=r:a<=s&&s<=l&&l<i&&(this[o]-=l-s+1)}return!0}isFarther(e,t){return!e||("down"===t?e.row+e.rowspan-1<this.row+this.rowspan-1:"up"===t?e.row>this.row:"right"===t?e.col+e.colspan-1<this.col+this.colspan-1:"left"===t?e.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}},(e,t)=>{"use strict";t.__esModule=!0,t.applySpanProperties=function(e,t,n,r){t?t.row===n&&t.col===r?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(447),g=n(444);t.default=class{constructor(e){this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}correctSelectionAreaSize(e){var t;e[0]===e[2]&&e[1]===e[3]&&(t=this.mergedCellsCollection.get(e[0],e[1]))&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}getDirection(e,t){let n=null;return n=t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?"down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?"up":t[1]===e[1]&&t[2]===e[2]?"right":"left"}snapDragArea(e,t,n,r){var i=t.slice(0),o=this.getAutofillSize(e,t,n),[s,a,l,u]=e,c=-1<["up","down"].indexOf(n)?l-s+1:u-a+1,d=o-Math.floor(o/c)*c,t=this.getFarthestCollection(e,t,n,r);return t&&("down"===n?(s=t.row+t.rowspan-s-d,i[2]+s>=this.plugin.hot.countRows()?i[2]-=d:i[2]+=d?s:0):"right"===n?(s=t.col+t.colspan-a-d,i[3]+s>=this.plugin.hot.countCols()?i[3]-=d:i[3]+=d?s:0):"up"===n?(a=l-d-t.row+1,i[0]+a<0?i[0]+=d:i[0]-=d?a:0):"left"===n&&(s=u-d-t.col+1,i[1]+s<0?i[1]+=d:i[1]-=d?s:0)),this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:r,fillSize:o,dragArea:i,cycleLength:c}),i}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),(0,r.extend)(this.currentFillData,e)}getAutofillSize(e,t,n){var[r,i,o,s]=e,[a,l,u,c]=t;switch(n){case"up":return r-a;case"down":return u-o;case"left":return i-l;case"right":return c-s;default:return null}}getDragArea(e,t,n){var[r,i,o,s]=e,[a,l,u,c]=t;switch(n){case"up":return[a,l,r-1,s];case"down":return[o+1,i,u,s];case"left":return[a,l,o,i-1];case"right":return[r,s+1,u,c];default:return null}}getFarthestCollection(e,t,n,r){var[i,o,s,a]=e,l=-1<["up","down"].indexOf(n),u=l?s:a,c=l?i:o,e=this.getAutofillSize(e,t,n),t=l?s-i+1:a-o+1,d=e-Math.floor(e/t)*t;let h=null,f=null,p=null;switch(n){case"up":h="includesVertically",p=u-d+1;break;case"left":h="includesHorizontally",p=u-d+1;break;case"down":h="includesVertically",p=c+d-1;break;case"right":h="includesHorizontally",p=c+d-1}return(0,g.arrayEach)(r,e=>{e[h](p)&&e.isFarther(f,n)&&(f=e)}),f}recreateAfterDataPopulation(e){if(this.currentFillData){const s=this.getRangeFromChanges(e);var i=this.currentFillData.foundMergedCells;const a=this.currentFillData.dragDirection;var o=(e,t)=>{switch(a){case"up":return e.row-t>=s.from.row;case"down":return e.row+e.rowspan-1+t<=s.to.row;case"left":return e.col-t>=s.from.column;case"right":return e.col+e.colspan-1+t<=s.to.column;default:return null}};let t=0,n=null,r=1;do{for(let e=0;e<i.length;e+=1){if(n=i[e],t=r*this.currentFillData.cycleLength,o(n,t))switch(a){case"up":this.plugin.mergedCellsCollection.add({row:n.row-t,rowspan:n.rowspan,col:n.col,colspan:n.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:n.row+t,rowspan:n.rowspan,col:n.col,colspan:n.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:n.row,rowspan:n.rowspan,col:n.col-t,colspan:n.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:n.row,rowspan:n.rowspan,col:n.col+t,colspan:n.colspan})}e===i.length-1&&(r+=1)}}while(o(n,t));this.currentFillData=null,this.plugin.hot.render(),0<i.length&&this.plugin.ifChromeForceRepaint()}}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return(0,g.arrayEach)(e,e=>{var t=e[0],e=this.plugin.hot.propToCol(e[1]);(null===n.min||t<n.min)&&(n.min=t),(null===n.max||t>n.max)&&(n.max=t),(null===r.min||e<r.min)&&(r.min=e),(null===r.max||e>r.max)&&(r.max=e)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,t,n){var[e,t,n,r]=this.getDragArea(e,t,n),e=this.plugin.hot._createCellCoords(e,t),t=this.plugin.hot._createCellCoords(n,r),n=this.plugin.hot._createCellRange(e,e,t);return!!this.mergedCellsCollection.getWithinRange(n,!0)}}},(e,t,n)=>{"use strict";t.__esModule=!0,n(203);t.default=class{constructor(e){this.plugin=e,this.hot=e.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}snapDelta(e,t,n){var t=t.to,r=t.row+e.row,t=t.col+e.col;e.row?this.jumpOverMergedCell(e,n,r):e.col&&this.jumpOverMergedCell(e,n,t)}jumpOverMergedCell(e,t,n){let r=e.row||e.col,i=null,o=null,s=null;e.row?(i=t.includesVertically(n),o=t.row,s=t.getLastRow()):e.col&&(i=t.includesHorizontally(n),o=t.col,s=t.getLastColumn()),0!==r&&(0<r?i&&n!==o&&(r+=s-n+1):i&&n!==s&&(r-=n-o+1),e.row?e.row=r:e.col&&(e.col=r))}getUpdatedSelectionRange(e,t){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+t.row,e.to.col+t.col))}getSelectedMergedCellClassName(e,t,n,r){var i=Math.min(n[0],n[2]),o=Math.min(n[1],n[3]),s=Math.max(n[0],n[2]),n=Math.max(n[1],n[3]);if(void 0!==r&&this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t)){var a,e=this.plugin.mergedCellsCollection.get(e,t);if(e)return t=e.getLastRow(),a=e.getLastColumn(),i<=e.row&&o<=e.col&&t<=s&&a<=n?this.fullySelectedMergedCellClassName+"-"+r:this.plugin.selectionCalculations.isMergeCellFullySelected(e,this.plugin.hot.getSelectedRange())?this.fullySelectedMergedCellClassName+"-multiple":void 0}}isMergeCellFullySelected(n,r){var i=[];if(!r||!n)return!1;for(let t=0;t<n.rowspan;t+=1)for(let e=0;e<n.colspan;e+=1)i.push(this.hot._createCellCoords(n.row+t,n.col+e));for(let t=0;t<i.length;t+=1){var o=[];for(let e=0;e<r.length;e+=1)o[e]=r[e].includes(i[t]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){var t=[];for(let e=0;e<=7;e+=1)t.push(this.fullySelectedMergedCellClassName+"-"+e);return t.push(this.fullySelectedMergedCellClassName+"-multiple"),t}}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,t.default=function(n){return{key:"mergeCells",name(){var e=this.getSelectedLast();if(e){var t=n.mergedCellsCollection.get(e[0],e[1]);if(t.row===e[0]&&t.col===e[1]&&t.row+t.rowspan-1===e[2]&&t.col+t.colspan-1===e[3])return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(i.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback(){n.toggleMergeOnSelection()},disabled(){var e=this.getSelectedLast();return!e||o.default.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}},function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568))),o=r(n(869));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(876);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.MultiColumnSorting=n.MultiColumnSorting},(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(703),i=n(709),o=n(706),s=n(302),a=n(877),l=n(878),u=n(879);n(880);const c="multiColumnSorting",d=(t.PLUGIN_KEY=c,t.PLUGIN_PRIORITY=170,"columnSorting");(0,i.registerRootComparator)(c,a.rootComparator);class h extends r.ColumnSorting{static get PLUGIN_KEY(){return c}static get PLUGIN_PRIORITY(){return 170}constructor(e){super(e),this.pluginKey=c}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[d]&&(0,l.warnAboutPluginsConflict)(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];super.updateHeaderClasses(e,...n),(0,s.removeClass)(e,(0,u.getClassesToRemove)(e)),!1!==this.enabled&&(0,s.addClass)(e,(0,u.getClassesToAdd)(...n))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[d]&&(0,l.warnAboutPluginsConflict)(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,t){!1!==(0,o.wasHeaderClickedProperly)(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,"append"))):this.sort(this.getColumnNextConfig(t.col)))}}t.MultiColumnSorting=h},(e,t,n)=>{"use strict";t.__esModule=!0,t.rootComparator=function(u,c){return function(e,t){const[,...a]=e,[,...l]=t;return function e(t){var n=u[t],r=c[t],i=a[t],o=l[t],s=r.multiColumnSorting,n=(s.compareFunctionFactory||(0,d.getCompareFunctionFactory)(r.type))(n,r,s)(i,o);if(n===d.DO_NOT_SWAP){r=t+1;if(void 0!==c[r])return e(r)}return n}(0)}};var d=n(709)},(e,t,n)=>{"use strict";t.__esModule=!0,t.warnAboutPluginsConflict=function(){(0,r.warn)((0,i.toSingleLine)`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)};var r=n(455),i=n(443)},(e,t,n)=>{"use strict";t.__esModule=!0,t.getClassesToAdd=function(e,t,n){var r=[];return!1!==n&&e.isColumnSorted(t)&&1<e.getNumberOfSortedColumns()&&r.push(i+"-"+(e.getIndexOfColumnInSortQueue(t)+1)),r},t.getClassesToRemove=function(e){const t=e.className.split(" "),n=new RegExp(`^${i}-[0-9]{1,2}$`);return t.filter(e=>n.test(e))},n(203);const i="sort"},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(882);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.MultipleSelectionHandles=n.MultipleSelectionHandles},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),n(302)),o=n(446),s=n(688),a=r(n(457));const l="multipleSelectionHandles";t.PLUGIN_KEY=l;t.PLUGIN_PRIORITY=160;class u extends s.BasePlugin{static get PLUGIN_KEY(){return l}static get PLUGIN_PRIORITY(){return 160}constructor(e){super(e),this.dragged=[],this.eventManager=null,this.lastSetCell=null}isEnabled(){return(0,o.isMobileBrowser)()}enablePlugin(){this.enabled||(this.eventManager||(this.eventManager=new a.default(this)),this.registerListeners(),super.enablePlugin())}registerListeners(){const a=this;var e=this.hot["rootElement"];function t(e){return 1===a.dragged.length?(a.dragged.splice(0,a.dragged.length),!0):-1!==(e=a.dragged.indexOf(e))&&void(0===e?a.dragged=a.dragged.slice(0,1):1===e&&(a.dragged=a.dragged.slice(-1)))}this.eventManager.addEventListener(e,"touchstart",e=>{let t;return(0,i.hasClass)(e.target,"topSelectionHandle-HitArea")?(t=a.hot.getSelectedRangeLast(),a.dragged.push("top"),a.touchStartRange={width:t.getWidth(),height:t.getHeight(),direction:t.getDirection()},e.preventDefault(),!1):(0,i.hasClass)(e.target,"bottomSelectionHandle-HitArea")?(t=a.hot.getSelectedRangeLast(),a.dragged.push("bottom"),a.touchStartRange={width:t.getWidth(),height:t.getHeight(),direction:t.getDirection()},e.preventDefault(),!1):void 0}),this.eventManager.addEventListener(e,"touchend",e=>(0,i.hasClass)(e.target,"topSelectionHandle-HitArea")?(t.call(a,"top"),a.touchStartRange=void 0,e.preventDefault(),!1):(0,i.hasClass)(e.target,"bottomSelectionHandle-HitArea")?(t.call(a,"bottom"),a.touchStartRange=void 0,e.preventDefault(),!1):void 0),this.eventManager.addEventListener(e,"touchmove",e=>{var t,n,r,i,o,s=this.hot["rootDocument"];0!==a.dragged.length&&(s=s.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY))&&s!==a.lastSetCell&&("TD"!==s.nodeName&&"TH"!==s.nodeName||(-1===(t=a.hot.getCoords(s)).col&&(t.col=0),o=(n=a.hot.getSelectedRangeLast()).getWidth(),r=n.getHeight(),i=n.getDirection(),1===o&&1===r&&a.hot.selection.setRangeEnd(t),null!==(o=a.getCurrentRangeCoords(n,t,a.touchStartRange.direction,i,a.dragged[0])).start&&a.hot.selection.setRangeStart(o.start),a.hot.selection.setRangeEnd(o.end),a.lastSetCell=s),e.preventDefault())})}getCurrentRangeCoords(e,t,n,r,i){var o=e.getTopStartCorner(),s=e.getBottomEndCorner(),a=e.getBottomStartCorner(),l=e.getTopEndCorner();let u={start:null,end:null};switch(n){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":u="top"===i?{start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(a.row,t.col)}:{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,o.col)};break;case"SE-NW":"bottom"===i&&(u={start:this.hot._createCellCoords(s.row,t.col),end:this.hot._createCellCoords(t.row,o.col)})}break;case"NW-SE":switch(r){case"NE-SW":"top"===i?u={start:t,end:a}:u.end=t;break;case"NW-SE":"top"===i?u={start:t,end:s}:u.end=t;break;case"SE-NW":"top"===i?u={start:t,end:o}:u.end=t;break;case"SW-NE":"top"===i?u={start:t,end:l}:u.end=t}break;case"SW-NE":switch(r){case"NW-SE":u="bottom"===i?{start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(a.row,t.col)}:{start:this.hot._createCellCoords(o.row,t.col),end:this.hot._createCellCoords(t.row,s.col)};break;case"SW-NE":u="top"===i?{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,s.col)}:{start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(o.row,t.col)};break;case"SE-NW":"bottom"===i?u={start:this.hot._createCellCoords(t.row,l.col),end:this.hot._createCellCoords(o.row,t.col)}:"top"===i&&(u={start:a,end:t})}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"top"===i&&(u.end=t);break;case"SE-NW":"top"===i?u.end=t:u={start:t,end:o}}}return u}isDragged(){return 0<this.dragged.length}}t.MultipleSelectionHandles=u},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(884);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.NestedHeaders=n.NestedHeaders},(e,t,n)=>{"use strict";n(273);var r=n(196),i=(t.__esModule=!0,n(203),r(n(467))),o=r(n(474)),d=r(n(471)),c=n(302),a=n(461),l=n(452),s=n(443),u=n(455),h=n(569),f=n(688),p=r(n(885)),g=r(n(898));function m(e,t,n){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,n)}n(899);const y="nestedHeaders";t.PLUGIN_KEY=y;t.PLUGIN_PRIORITY=280;var v=new WeakMap,b=new WeakMap;class E extends f.BasePlugin{constructor(){super(...arguments),m(this,v,{writable:!0,value:new p.default}),m(this,b,{writable:!0,value:null}),(0,i.default)(this,"ghostTable",new g.default(this.hot,(e,t)=>this.getHeaderSettings(e,t))),(0,i.default)(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return y}static get PLUGIN_PRIORITY(){return 280}isEnabled(){return!!this.hot.getSettings()[y]}enablePlugin(){var e,t=this;this.enabled||(e=this.hot.getSettings()["nestedHeaders"],Array.isArray(e)&&Array.isArray(e[0])||(0,u.warn)((0,s.toSingleLine)`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>this.onInit()),this.addHook("afterLoadData",function(){return t.onAfterLoadData(...arguments)}),this.addHook("beforeOnCellMouseDown",function(){return t.onBeforeOnCellMouseDown(...arguments)}),this.addHook("afterOnCellMouseDown",function(){return t.onAfterOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return t.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterGetColumnHeaderRenderers",e=>this.onAfterGetColumnHeaderRenderers(e)),this.addHook("modifyColWidth",function(){return t.onModifyColWidth(...arguments)}),this.addHook("modifyColumnHeaderValue",function(){return t.onModifyColumnHeaderValue(...arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return t.onBeforeHighlightingColumnHeader(...arguments)}),this.addHook("beforeCopy",function(){return t.onBeforeCopy(...arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return t.onAfterViewportColumnCalculatorOverride(...arguments)}),super.enablePlugin(),this.updatePlugin())}updatePlugin(){var e;this.hot.view&&(e=this.hot.getSettings()["nestedHeaders"],(0,d.default)(this,v).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=(0,d.default)(this,v).setState(e)),this.detectedOverlappedHeaders&&(0,u.warn)((0,s.toSingleLine)`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((e,t)=>{e=!0===e?"hide-column":"show-column";(0,d.default)(this,v).triggerColumnModification(e,t)}),!(0,d.default)(this,b)&&this.enabled&&(0,o.default)(this,b,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(e=>{e.forEach(e=>{var{op:e,index:t,newValue:n}=e;"replace"===e&&(e=!0===n?"hide-column":"show-column",(0,d.default)(this,v).triggerColumnModification(e,t))}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin())}disablePlugin(){this.clearColspans(),(0,d.default)(this,v).clear(),(0,d.default)(this,b).unsubscribe(),(0,o.default)(this,b,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return(0,d.default)(this,v)}getLayersCount(){return(0,d.default)(this,v).getLayersCount()}getHeaderSettings(e,t){return(0,d.default)(this,v).getHeaderSettings(e,t)}clearColspans(){if(this.hot.view){var e=this.hot.view["_wt"],t=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,i=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let e=0;e<t;e++){var o=n.childNodes[e];if(!o)break;var s=r.childNodes[e],a=i?i.childNodes[e]:null;for(let e=0,t=o.childNodes.length;e<t;e++)o.childNodes[e].removeAttribute("colspan"),(0,c.removeClass)(o.childNodes[e],"hiddenHeader"),s&&s.childNodes[e]&&(s.childNodes[e].removeAttribute("colspan"),(0,c.removeClass)(s.childNodes[e],"hiddenHeader")),i&&a&&a.childNodes[e]&&(a.childNodes[e].removeAttribute("colspan"),(0,c.removeClass)(a.childNodes[e],"hiddenHeader"))}}}headerRendererFactory(a){var l=this;const u=this.hot.view._wt.getSetting("fixedColumnsStart");return(e,t)=>{var{columnIndexMapper:n,view:r}=this.hot;let i=n.getVisualFromRenderableIndex(e);null===i&&(i=e),t.removeAttribute("colspan"),(0,c.removeClass)(t,"hiddenHeader");var{colspan:n,isHidden:o,isPlaceholder:s}=null!=(n=(0,d.default)(this,v).getHeaderSettings(a,i))?n:{label:""};s||o?(0,c.addClass)(t,"hiddenHeader"):1<n&&(s=r._wt["wtOverlays"],r=null==(o=s.topInlineStartCornerOverlay)?void 0:o.clone.wtTable.THEAD.contains(t),s=null==(o=s.inlineStartOverlay)?void 0:o.clone.wtTable.THEAD.contains(t),1<(o=r||s?Math.min(n,u-e):n))&&t.setAttribute("colspan",o),this.hot.view.appendColHeader(i,t,function(){return l.getColumnHeaderValue(...arguments)},a)}}getColumnHeaderValue(e,t){var{isHidden:n,isPlaceholder:r}=null!=(n=(0,d.default)(this,v).getHeaderSettings(t,e))?n:{};return r||n?"":this.hot.getColHeader(e,t)}onBeforeHighlightingColumnHeader(e,t,n){var r=(0,d.default)(this,v).getHeaderTreeNodeData(t,e);if(r){var{classNames:n,columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:t,colspan:a}=(0,d.default)(this,v).getHeaderSettings(t,e);if(o===h.HEADER_TYPE){if(!t)return r.columnIndex}else o===h.ACTIVE_HEADER_TYPE&&(s-i<a||!t)&&(n.length=0)}return e}onBeforeCopy(n,t,e){e=e.columnHeadersCount;if(0!==e)for(let e=0;e<t.length;e++){var{startRow:r,startCol:i,endRow:o,endCol:s}=t[e],a=o-r+1;if(0<=r||1==i-s+1)break;for(let t=i;t<=s;t++)for(let e=r;e<=o;e++){var l,u=a+e,c=t-i;0!=c&&!1===(null==(l=(0,d.default)(this,v).getHeaderTreeNodeData(e,t))?void 0:l.isRoot)&&(n[u][c]="")}}}onBeforeOnCellMouseDown(e,t,n,r){this._getHeaderTreeNodeDataByCoords(t)&&(r.column=!0)}onAfterOnCellMouseDown(e,t){var n,r,i,o,s,a=this._getHeaderTreeNodeDataByCoords(t);a&&(n=this.hot["selection"],r=n.isSelected()?n.getSelectedRange().current():null,i=[],{columnIndex:a,origColspan:o}=a,s=!n.inInSelection(t),e.shiftKey&&r?t.col<r.from.col?i.push(r.getTopEndCorner().col,a,t.row):t.col>r.from.col?i.push(r.getTopStartCorner().col,a+o-1,t.row):i.push(a,a+o-1,t.row):((0,l.isLeftClick)(e)||(0,l.isRightClick)(e)&&s)&&i.push(a,a+o-1,t.row),n.selectColumns(...i))}onBeforeOnCellMouseOver(e,t,n,r){var i,o,s,a,l;this.hot.view.isMouseDown()&&(i=this._getHeaderTreeNodeDataByCoords(t))&&({columnIndex:i,origColspan:o}=i,s=(l=this.hot.getSelectedRangeLast()).getTopStartCorner(),a=l.getBottomEndCorner(),l=l["from"],r.column=!0,r.cell=!0,r=[],t.col<l.col?r.push(a.col,i):t.col>l.col?r.push(s.col,i+o-1):r.push(i,i+o-1),this.hot.selectColumns(...r))}onAfterGetColumnHeaderRenderers(t){for(let e=t.length=0;e<(0,d.default)(this,v).getLayersCount();e++)t.push(this.headerRendererFactory(e))}onAfterViewportColumnCalculatorOverride(t){var n=(0,d.default)(this,v).getLayersCount();let r=t.startColumn,i=!!n;for(let e=0;e<n;e++){var o=(0,d.default)(this,v).findLeftMostColumnIndex(e,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(0<=o&&(i=!1),(0,a.isNumeric)(s)&&s<t.startColumn){r=s;break}}t.startColumn=i?(0,d.default)(this,v).getHeaderTreeNodeData(0,r).columnIndex:r}onModifyColWidth(e,t){t=this.ghostTable.getWidth(t);return t<e?e:t}onModifyColumnHeaderValue(e,t,n){t=(null!=(n=(0,d.default)(this,v).getHeaderTreeNodeData(n,t))?n:{label:""}).label;return t}onInit(){this.updatePlugin()}onAfterLoadData(e,t){t||this.updatePlugin()}destroy(){(0,o.default)(this,v,null),null!==(0,d.default)(this,b)&&((0,d.default)(this,b).unsubscribe(),(0,o.default)(this,b,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(0<=e.row||e.col<0))return(0,d.default)(this,v).getHeaderTreeNodeData(e.row,e.col)}}t.NestedHeaders=E},(e,t,n)=>{"use strict";n(273);var r=n(196),i=(t.__esModule=!0,n(203),r(n(474))),o=r(n(471)),s=n(444),a=r(n(886)),l=r(n(889)),u=n(891),c=n(897);function d(e,t,n){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,n)}var h=new WeakMap,f=new WeakMap,p=new WeakMap;t.default=class{constructor(){d(this,h,{writable:!0,value:new a.default}),d(this,f,{writable:!0,value:new l.default((0,o.default)(this,h))}),d(this,p,{writable:!0,value:[[]]})}setState(e){(0,o.default)(this,h).setData(e);let t=!1;try{(0,o.default)(this,f).buildTree()}catch(e){(0,o.default)(this,f).clear(),(0,o.default)(this,h).clear(),t=!0}return(0,i.default)(this,p,(0,c.generateMatrix)((0,o.default)(this,f).getRoots())),t}setColumnsLimit(e){(0,o.default)(this,h).setColumnsLimit(e)}mergeStateWith(e){e=(0,s.arrayMap)(e,e=>{let{row:t,...n}=e;return{row:t<0?this.rowCoordsToLevel(t):t,...n}});(0,o.default)(this,h).mergeWith(e),(0,o.default)(this,f).buildTree(),(0,i.default)(this,p,(0,c.generateMatrix)((0,o.default)(this,f).getRoots()))}mapState(e){(0,o.default)(this,h).map(e),(0,o.default)(this,f).buildTree(),(0,i.default)(this,p,(0,c.generateMatrix)((0,o.default)(this,f).getRoots()))}mapNodes(n){return(0,s.arrayReduce)((0,o.default)(this,f).getRoots(),(t,e)=>(e.walkDown(e=>{e=n(e.data);void 0!==e&&t.push(e)}),t),[])}triggerNodeModification(e,t,n){t<0&&(t=this.rowCoordsToLevel(t));t=(0,o.default)(this,f).getNode(t,n);let r;return t&&(r=(0,u.triggerNodeModification)(e,t,n),(0,i.default)(this,p,(0,c.generateMatrix)((0,o.default)(this,f).getRoots()))),r}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){return 0<=e||(e=e+Math.max(this.getLayersCount(),1))<0?null:e}levelToRowCoords(e){return e<0||0<=(e=e-Math.max(this.getLayersCount(),1))?null:e}getHeaderSettings(e,t){return!(null===(e=e<0?this.rowCoordsToLevel(e):e)||e>=this.getLayersCount())&&null!=(e=null==(e=(0,o.default)(this,p)[e])?void 0:e[t])?e:null}getHeaderTreeNodeData(e,t){return!(null===(e=e<0?this.rowCoordsToLevel(e):e)||e>=this.getLayersCount())&&(e=(0,o.default)(this,f).getNode(e,t))?{...e.data}:null}findLeftMostColumnIndex(e,t){var n=(null!=(n=this.getHeaderSettings(e,t))?n:{isRoot:!0})["isRoot"];if(n)return t;let r=t-1;for(;0<=r;){var i=(null!=(i=this.getHeaderSettings(e,r))?i:{isRoot:!0})["isRoot"];if(i)break;--r}return r}getLayersCount(){return(0,o.default)(this,h).getLayersCount()}getColumnsCount(){return(0,o.default)(this,h).getColumnsCount()}clear(){(0,i.default)(this,p,[]),(0,o.default)(this,h).clear(),(0,o.default)(this,f).clear()}}},(e,t,n)=>{"use strict";var r=n(196),a=(t.__esModule=!0,n(273),n(203),r(n(471))),i=r(n(474)),o=n(447),s=n(444),l=n(887);function u(e,t,n){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,n)}const c=["label","collapsible"];t.HEADER_CONFIGURABLE_PROPS=c;var d=new WeakMap,h=new WeakMap,f=new WeakMap;t.default=class{constructor(){u(this,d,{writable:!0,value:[]}),u(this,h,{writable:!0,value:0}),u(this,f,{writable:!0,value:1/0})}setColumnsLimit(e){(0,i.default)(this,f,e)}setData(){(0,i.default)(this,d,(0,l.normalizeSettings)(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],(0,a.default)(this,f))),(0,i.default)(this,h,(0,a.default)(this,d).length)}getData(){return(0,a.default)(this,d)}mergeWith(e){(0,s.arrayEach)(e,e=>{let{row:t,col:n,...r}=e;e=this.getHeaderSettings(t,n);null!==e&&(0,o.extend)(e,r,c)})}map(n){(0,s.arrayEach)((0,a.default)(this,d),e=>{(0,s.arrayEach)(e,e=>{var t=n({...e});(0,o.isObject)(t)&&(0,o.extend)(e,t,c)})})}getHeaderSettings(e,t){return!(e>=(0,a.default)(this,h)||e<0||t>=(e=(0,a.default)(this,d)[e]).length||null==(e=e[t]))?e:null}getHeadersSettings(e,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,i=[];if(!(e>=(0,a.default)(this,h)||e<0)){var o=(0,a.default)(this,d)[e];let t=0;for(let e=n;e<o.length;e++){var s=o[e];if(s.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(t+=s.colspan,i.push(s),1<s.colspan&&(e+=s.colspan-1),t===r)break;if(t>r)throw new Error("The last column settings cannot overlap the other header layers")}}return i}getLayersCount(){return(0,a.default)(this,h)}getColumnsCount(){return 0<(0,a.default)(this,h)?(0,a.default)(this,d)[0].length:0}clear(){(0,i.default)(this,d,[]),(0,i.default)(this,h,0)}}},(e,t,n)=>{"use strict";t.__esModule=!0,t.normalizeSettings=function(e){let a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1/0;const t=[];if(0!==a){(0,r.arrayEach)(e,e=>{const o=[];let s=0;t.push(o),(0,r.arrayEach)(e,e=>{var t,n,r=(0,c.createDefaultHeaderSettings)();(0,l.isObject)(e)?({label:t,colspan:n}=e,r.label=(0,u.stringify)(t),"number"==typeof n&&1<n&&(r.colspan=n,r.origColspan=n)):r.label=(0,u.stringify)(e);let i=!1;if((s+=r.origColspan)>=a&&(r.colspan=r.origColspan-(s-a),r.origColspan=r.colspan,i=!0),o.push(r),1<r.colspan)for(let e=0;e<r.colspan-1;e++)o.push((0,c.createPlaceholderHeaderSettings)());return!i})});const n=Math.max(...(0,r.arrayMap)(t,e=>e.length));(0,r.arrayEach)(t,e=>{var t;e.length<n&&(t=(0,r.arrayMap)(new Array(n-e.length),()=>(0,c.createDefaultHeaderSettings)()),e.splice(e.length,0,...t))})}return t},n(203);var r=n(444),l=n(447),u=n(305),c=n(888)},(e,t)=>{"use strict";t.__esModule=!0,t.createDefaultHeaderSettings=function(){var{label:e="",colspan:t=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return{label:e,colspan:t,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l}},t.createPlaceholderHeaderSettings=function(){return{label:"",isPlaceholder:!0}}},(e,t,n)=>{"use strict";n(273);var r=n(196),l=(t.__esModule=!0,r(n(471))),i=r(n(474)),s=n(444),a=r(n(890));function o(e,t,n){var r=e;if(t.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object");t.set(e,n)}var u=new WeakMap,c=new WeakMap,d=new WeakMap;t.default=class{constructor(e){o(this,u,{writable:!0,value:new Map}),o(this,c,{writable:!0,value:new Map}),o(this,d,{writable:!0,value:null}),(0,i.default)(this,d,e)}getRoots(){return Array.from((0,l.default)(this,u).values())}getRootByColumn(e){let t;return t=(0,l.default)(this,c).has(e)?(0,l.default)(this,u).get((0,l.default)(this,c).get(e)):t}getNode(o,s){var e=this.getRootByColumn(s);if(e){const a=s-(0,l.default)(this,c).get(s);let r=0,i;return e.walkDown(e=>{var{origColspan:t,headerLevel:n}=e["data"];if(o===n){if(a>=r&&a<=r+t-1)return(i=e).data.isRoot=s===i.data.columnIndex,!1;r+=t}}),i}}rebuildTreeIndex(){let n=0;(0,l.default)(this,c).clear(),(0,s.arrayEach)((0,l.default)(this,u),e=>{var[,{data:{colspan:t}}]=e;for(let e=n;e<n+t;e++)(0,l.default)(this,c).set(e,n);n+=t})}buildTree(){this.clear();var e=(0,l.default)(this,d).getColumnsCount();let t=0;for(;t<e;){var n=(0,l.default)(this,d).getHeaderSettings(0,t),r=new a.default;(0,l.default)(this,u).set(t,r),this.buildLeaves(r,t,0,n.origColspan),t+=n.origColspan}this.rebuildTreeIndex()}buildLeaves(r,i,o){var e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,e=(0,l.default)(this,d).getHeadersSettings(o,i,e);o+=1,(0,s.arrayEach)(e,e=>{var t={...e,headerLevel:o-1,columnIndex:i};let n;1===o?(r.data=t,n=r):(n=new a.default(t),r.addChild(n)),o<(0,l.default)(this,d).getLayersCount()&&this.buildLeaves(n,i,o,e.origColspan),i+=e.origColspan})}clear(){(0,l.default)(this,u).clear(),(0,l.default)(this,c).clear()}}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,t.depthFirstPreOrder=o,r(n(467))),r=(n(203),n(273),"DF-pre-order");function o(t,n){let r=t.call(n,this);for(let e=0;e<this.childs.length;e++){if(!1===r)return!1;r=o.call(this.childs[e],t,n)}return r}t.TRAVERSAL_DF_PRE=r;n="DF-post-order";function s(t,n){for(let e=0;e<this.childs.length;e++)if(!1===s.call(this.childs[e],t,n))return!1;return t.call(n,this)}t.TRAVERSAL_DF_POST=n;t.TRAVERSAL_BF="BF";const a=new Map([[r,o],[n,s],["BF",function(n,r){const i=[this];!function e(){var t;0!==i.length&&(t=i.shift(),i.push(...t.childs),!1!==n.call(r,t))&&e()}()}]]);t.default=class l{constructor(e){(0,i.default)(this,"data",{}),(0,i.default)(this,"parent",null),(0,i.default)(this,"childs",[]),this.data=e}addChild(e){(e.parent=this).childs.push(e)}cloneTree(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this,n=new l({...t.data});for(let e=0;e<t.childs.length;e++)n.addChild(this.cloneTree(t.childs[e]));return n}replaceTreeWith(t){this.data={...t.data},this.childs=[];for(let e=0;e<t.childs.length;e++)this.addChild(t.childs[e])}walkDown(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"BF";if(!a.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);a.get(t).call(this,e,this)}walkUp(t){const n=this,r=e=>{!1!==t.call(n,e)&&null!==e.parent&&r(e.parent)};r(this)}}},(e,t,n)=>{"use strict";t.__esModule=!0,t.triggerNodeModification=function(e,t,n){if(o.has(e))return o.get(e)(t,n);throw new Error(`The node modifier action ("${e}") does not exist.`)},n(273);var t=n(892),r=n(893),i=n(895),n=n(896);const o=new Map([["collapse",t.collapseNode],["expand",r.expandNode],["hide-column",i.hideColumn],["show-column",n.showColumn]])},(e,t,n)=>{"use strict";t.__esModule=!0,t.collapseNode=function e(t){var n;const{data:r,childs:i}=t;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};const o=(0,p.isNodeReflectsFirstChildColspan)(t);if(o)return e(i[0]);r.isCollapsed=!0;const s=i.slice(1);const a=new Set;if(0<s.length)(0,h.arrayEach)(s,e=>{(0,p.traverseHiddenNodeColumnIndexes)(e,e=>{a.add(e)}),e.data.clonedTree=e.cloneTree(),e.walkDown(e=>{let t=e["data"];t.isHidden=!0})});else{const{origColspan:u,columnIndex:c}=r;for(let e=1;e<u;e++){const d=c+e;a.add(d)}}const l=r.colspan-(null!=(n=(0,p.getFirstChildProperty)(t,"colspan"))?n:1);t.walkUp(e=>{const t=e["data"];t.colspan-=l,t.colspan<=1?(t.colspan=1,t.isCollapsed=!0):(0,p.isNodeReflectsFirstChildColspan)(e)&&(t.isCollapsed=(0,p.getFirstChildProperty)(e,"isCollapsed"))});return{rollbackModification:()=>(0,f.expandNode)(t),affectedColumns:Array.from(a),colspanCompensation:l}};var h=n(444),f=n(893),p=n(894)},(e,t,n)=>{"use strict";t.__esModule=!0,t.expandNode=function e(t){const{data:n,childs:r}=t;if(!n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};const i=(0,f.isNodeReflectsFirstChildColspan)(t);if(i)return e(r[0]);n.isCollapsed=!1;const o=r.slice(1);const s=new Set;let a=0;if(0<o.length)(0,d.arrayEach)(o,e=>{e.replaceTreeWith(e.data.clonedTree),e.data.clonedTree=null;const t=e.data;a+=t.colspan,(0,f.traverseHiddenNodeColumnIndexes)(e,e=>{s.add(e)})});else{const{colspan:l,origColspan:u,columnIndex:c}=n;a=u-l;for(let e=1;e<u;e++)s.add(c+e)}t.walkUp(e=>{const t=e["data"];t.colspan+=a,t.colspan>=t.origColspan?(t.colspan=t.origColspan,t.isCollapsed=!1):(0,f.isNodeReflectsFirstChildColspan)(e)&&(t.isCollapsed=(0,f.getFirstChildProperty)(e,"isCollapsed"))});return{rollbackModification:()=>(0,h.collapseNode)(t),affectedColumns:Array.from(s),colspanCompensation:a}};var d=n(444),h=n(892),f=n(894)},(e,t)=>{"use strict";function n(e,t){e=e.childs;if(0!==e.length)return e[0].data[t]}t.__esModule=!0,t.getFirstChildProperty=n,t.isNodeReflectsFirstChildColspan=function(e){return n(e,"origColspan")===e.data.origColspan},t.traverseHiddenNodeColumnIndexes=function(e,n){e.walkDown(e=>{var{data:t,childs:e}=e;if(!t.isHidden&&(n(t.columnIndex),0===e.length))for(let e=1;e<t.colspan;e++)n(t.columnIndex+e)})}},(e,t,n)=>{"use strict";t.__esModule=!0,t.hideColumn=function(e,n){if(!Number.isInteger(n))throw new Error("The passed gridColumnIndex argument has invalid type.");if(0<e.childs.length)throw new Error((0,r.toSingleLine)`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);var t=e.data["crossHiddenColumns"];if(!t.includes(n)){let t=!1;e.walkUp(e=>{var e=e["data"]["collapsible"];if(e)return!(t=!0)}),t||e.walkUp(e=>{e=e.data;e.crossHiddenColumns.push(n),1<e.colspan?--e.colspan:e.isHidden=!0})}},n(273),n(203);var r=n(443)},(e,t,n)=>{"use strict";t.__esModule=!0,t.showColumn=function(e,n){if(!Number.isInteger(n))throw new Error("The passed gridColumnIndex argument has invalid type.");if(0<e.childs.length)throw new Error((0,r.toSingleLine)`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);var t=e.data["crossHiddenColumns"];if(t.includes(n)){let t=!1;e.walkUp(e=>{var e=e["data"]["collapsible"];if(e)return!(t=!0)}),t||e.walkUp(e=>{e=e.data;e.crossHiddenColumns.splice(e.crossHiddenColumns.indexOf(n),1),!e.isHidden&&e.colspan<e.origColspan&&(e.colspan+=1),e.isHidden=!1})}},n(273);var r=n(443)},(e,t,n)=>{"use strict";t.__esModule=!0,t.generateMatrix=function(e){const l=[];return(0,r.arrayEach)(e,e=>{e.walkDown(e=>{var t,n=e.data,{origColspan:r,columnIndex:i,headerLevel:e,crossHiddenColumns:o}=n,s=function(e,t){let n;Array.isArray(e[t])?n=e[t]:(n=[],e[t]=n);return n}(l,e);let a=!1;for(let e=i;e<i+r;e++)o.includes(e)||a?s.push((0,u.createPlaceholderHeaderSettings)(n)):((t=function(e){const{crossHiddenColumns:t,...n}=(0,u.createDefaultHeaderSettings)(e);return n}(n)).isRoot=!0,s.push(t),a=!0)})}),l},n(203);var r=n(444),u=n(888)},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,r(n(467))),d=n(302);t.default=class{constructor(e,t){(0,i.default)(this,"hot",void 0),(0,i.default)(this,"nestedHeaderSettingsGetter",void 0),(0,i.default)(this,"layersCount",0),(0,i.default)(this,"container",void 0),(0,i.default)(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var t=this.container.querySelectorAll("tr:last-of-type th"),n=t.length;this.widthsMap.clear();for(let e=0;e<n;e++){var r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e),r=this.hot.toPhysicalColumn(r);this.widthsMap.setValueAtIndex(r,t[e].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){var{rootDocument:r,columnIndexMapper:i}=this.hot,t=r.createDocumentFragment(),o=r.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=i.getRenderableIndexesLength();for(let n=0;n<this.layersCount;n++){var l=r.createElement("tr");for(let t=0;t<a;t++){let e=i.getVisualFromRenderableIndex(t);null===e&&(e=t);var u=r.createElement("th"),c=this.nestedHeaderSettingsGetter(n,e);if(c&&(!c.isPlaceholder||c.isHidden)){let e=c.label;s&&(e+='<button class="changeType"></button>'),(0,d.fastInnerHTML)(u,e),u.colSpan=c.colspan,l.appendChild(u)}}o.appendChild(l)}t.appendChild(o),e.appendChild(t)}clear(){this.widthsMap.clear(),this.container=null}}},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(901);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.NestedRows=n.NestedRows},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),n(688)),o=r(n(902)),s=r(n(903)),a=r(n(905)),l=r(n(906)),u=n(455),c=n(542),d=n(543),h=r(n(907));n(908);const f="nestedRows",p=(t.PLUGIN_KEY=f,t.PLUGIN_PRIORITY=300,new WeakMap);class g extends i.BasePlugin{static get PLUGIN_KEY(){return f}static get PLUGIN_PRIORITY(){return 300}constructor(e){super(e),this.dataManager=null,this.headersUI=null,this.collapsedRowsMap=null,p.set(this,{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1})}isEnabled(){return!!this.hot.getSettings()[f]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new d.TrimmingMap),this.dataManager=new o.default(this,this.hot),this.collapsingUI=new s.default(this,this.hot),this.headersUI=new a.default(this,this.hot),this.contextMenuUI=new l.default(this,this.hot),this.rowMoveController=new h.default(this),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("beforeViewRender",function(){return e.onBeforeViewRender(...arguments)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){return e.onFilterData(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetRowHeader",function(){return e.onAfterGetRowHeader(...arguments)}),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeRemoveRow",function(){return e.onBeforeRemoveRow(...arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow(...arguments)}),this.addHook("beforeAddChild",function(){return e.onBeforeAddChild(...arguments)}),this.addHook("afterAddChild",function(){return e.onAfterAddChild(...arguments)}),this.addHook("beforeDetachChild",function(){return e.onBeforeDetachChild(...arguments)}),this.addHook("afterDetachChild",function(){return e.onAfterDetachChild(...arguments)}),this.addHook("modifyRowHeaderWidth",function(){return e.onModifyRowHeaderWidth(...arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow(...arguments)}),this.addHook("beforeRowMove",function(){return e.onBeforeRowMove(...arguments)}),this.addHook("beforeLoadData",e=>this.onBeforeLoadData(e)),this.addHook("beforeUpdateData",e=>this.onBeforeLoadData(e)),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),super.disablePlugin()}updatePlugin(){this.disablePlugin();var e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}onBeforeRowMove(e,t,n,r){return this.rowMoveController.onBeforeRowMove(e,t,n,r)}disableCoreAPIModifiers(){p.get(this).skipCoreAPIModifiers=!0}enableCoreAPIModifiers(){p.get(this).skipCoreAPIModifiers=!1}onBeforeOnCellMouseDown(e,t,n){this.collapsingUI.toggleState(e,t,n)}onModifyRowData(e){var t=p.get(this);if(!t.skipCoreAPIModifiers)return this.dataManager.getDataObject(e)}onModifySourceLength(){var e=p.get(this);if(!e.skipCoreAPIModifiers)return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,n){return!(!p.get(this).skipCoreAPIModifiers&&!this.dataManager.isRowHighestLevel(e)&&(this.dataManager.spliceData(e,t,n),1))}onFilterData(e,t,n){var r=p.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*t),this.dataManager.filterData(e,t,n),r.skipRender=!0,this.dataManager.getData().slice()}onAfterContextMenuDefaultOptions(e){return this.contextMenuUI.appendOptions(e)}onAfterGetRowHeader(e,t){this.headersUI.appendLevelIndicators(e,t)}onModifyRowHeaderWidth(e){return this.headersUI.rowHeaderWidthCache||e}onAfterRemoveRow(e,t,n,r){if(r!==this.pluginName){const i=p.get(this);setTimeout(()=>{i.skipRender=null,this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()},0)}}onBeforeRemoveRow(e,t,n){var r=Array.from(n.reduce((t,e)=>{var n;return this.dataManager.isParent(e)?(n=this.dataManager.getDataObject(e).__children,t.add(e),Array.isArray(n)&&n.forEach(e=>t.add(this.dataManager.getRowIndex(e))),t):t.add(e)},new Set));n.length=0,n.push(...r)}onBeforeAddChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterAddChild(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onBeforeDetachChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterDetachChild(e,t,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onAfterCreateRow(){this.dataManager.rewriteCache()}onAfterInit(){var e=Math.max(...this.dataManager.cache.levels);0<e&&this.headersUI.updateRowHeaderWidth(e)}onBeforeViewRender(e,t){p.get(this).skipRender&&(t.skipRender=!0)}destroy(){super.destroy()}onBeforeLoadData(e){(0,c.isArrayOfObjects)(e)?(this.dataManager.setData(e),this.dataManager.rewriteCache()):((0,u.error)("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),this.hot.getSettings()[f]=!1,this.disablePlugin())}}t.NestedRows=g},(e,t,n)=>{"use strict";t.__esModule=!0,n(203);var d=n(461),r=n(447),s=n(444);t.default=class{constructor(e,t){this.hot=t,this.data=null,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){var e;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},(0,d.rangeEach)(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(t,n,e){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:e,row:this.cache.rows.length-1,level:n}),this.hasChildren(t)&&(0,s.arrayEach)(t.__children,e=>{this.cacheNode(e,n+1,t)})}getDataObject(e){return null==e?null:this.cache.rows[e]}readTreeNodes(e,t,n,r){let i=!1,o=t;if(!isNaN(o)||!o.end){let t=e;if(t||(t={__children:this.data},i=!0,--o),null!=n&&o===n)return{result:t,end:!0};if(null!=r&&t===r)return{result:o,end:!0};o+=1,t.__children&&(0,s.arrayEach)(t.__children,e=>{if(this.parentReference.set(e,i?null:t),o=this.readTreeNodes(e,o,n,r),isNaN(o)&&o.end)return!1})}return o}mockParent(){var e=this.mockNode();return e.__children=this.data,e}mockNode(){const n={};return(0,r.objectEach)(this.data[0],(e,t)=>{n[t]=null}),n}getRowIndex(e){return null==e?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;t=isNaN(e)?e:this.getDataObject(e);e=this.getRowParent(e);return(null==e?this.data:e.__children).indexOf(t)}countAllRows(){var e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,n=e;return(n=isNaN(n)?n:this.getDataObject(n))&&n.__children?((0,s.arrayEach)(n.__children,e=>{t+=1,e.__children&&(t+=this.countChildren(e))}),t):0}getRowParent(e){let t;return t=isNaN(e)?e:this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return e&&"object"==typeof e?this.cache.nodeInfo.get(e).parent:null}getRowLevel(e){let t=null;return(t=isNaN(e)?e:this.getDataObject(e))?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return null==e?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return!(!(t=isNaN(t)?t:this.getDataObject(t)).__children||!t.__children.length)}isChild(e){return null!==this.getRowParent(e)}getChild(e,t){return(null==(e=e.__children)?void 0:e[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){let t=e;return(t=isNaN(t)?t:this.getDataObject(t))&&!!t.__children&&0!==(null==(e=t.__children)?void 0:e.length)}addChild(e,t){let n=t,r=(this.hot.runHooks("beforeAddChild",e,n),null),i=(e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1),e);(i=e?i:this.mockParent()).__children||(i.__children=[]),n=n||this.mockNode(),i.__children.push(n),this.rewriteCache();t=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(t,1),this.hot.runHooks("afterCreateRow",t,1),this.hot.runHooks("afterAddChild",e,n)}addChildAtIndex(e,t,n){let r=n,i;r=r||this.mockNode(),this.hot.runHooks("beforeAddChild",e,r,t),i=e?(n=this.getRowIndex(e)+t+1,this.hot.runHooks("beforeCreateRow",n,1),e.__children.splice(t,null,r),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(n,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",n,1),n):(this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),this.getRowIndex(this.data[t])),r=this.getDataObject(i),this.hot.runHooks("afterAddChild",e,r,t)}addSibling(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"below",e=this.translateTrimmedRow(e),n=this.getRowParent(e),r=this.getRowIndexWithinParent(e);switch(t){case"below":this.addChildAtIndex(n,r+1,null);break;case"above":this.addChildAtIndex(n,r,null)}}detachFromParent(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];let n=null;const r=[];n=Array.isArray(e)?((0,d.rangeEach)(e[0],e[2],e=>{e=this.translateTrimmedRow(e);r.push(this.getDataObject(e))}),(0,d.rangeEach)(0,r.length-2,e=>{this.detachFromParent(r[e],!1)}),r[r.length-1]):e;var i,e=this.getRowIndex(n),o=this.countChildren(n),s=this.getRowIndexWithinParent(n),a=this.getRowParent(n),l=this.getRowParent(a),u=this.getRowIndex(l);let c=null;this.hot.runHooks("beforeDetachChild",a,n),null!=s&&(i=Array.from(new Array(e+o+1).keys()).splice(-1*(o+1)),this.hot.runHooks("beforeRemoveRow",e,o+1,i,this.plugin.pluginName),a.__children.splice(s,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",e,o+1,i,this.plugin.pluginName),(l?(c=u+this.countChildren(l),s=this.getChild(l,this.countChildren(l)-1),e=this.getRowIndex(s),this.hot.runHooks("beforeCreateRow",e+1,o+1,this.plugin.pluginName),l.__children):(c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c-2,o+1,this.plugin.pluginName),this.data)).push(n)),this.rewriteCache(),this.hot.runHooks("afterCreateRow",c-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",a,n,this.getRowIndex(n)),t&&this.hot.render()}filterData(e,t,n){const r=[];(0,s.arrayEach)(n,e=>{r.push(this.getDataObject(e))}),(0,s.arrayEach)(r,e=>{var t=this.getRowIndexWithinParent(e),e=this.getRowParent(e);(null===e?this.data:e.__children).splice(t,1)}),this.rewriteCache()}spliceData(e,t,n){var r=this.getDataObject(e-1);let i=null,o=e;r&&r.__children&&0===r.__children.length?(i=r,o=0):e<this.countAllRows()&&(i=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),i?n?i.__children.splice(o,t,...n):i.__children.splice(o,t):n?this.data.splice(o,t,...n):this.data.splice(o,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,n=null;for(;null!==(n=this.getRowParent(n))&&(t=n),null!==n;);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,n,r){var i=t===this.hot.countRows(),o=this.getRowParent(e),s=this.getRowIndexWithinParent(e),a=o.__children.slice(s,s+1),e=t<e;let l=i?this.getRowParent(t-1):this.getRowParent(t);(l=null!==(l=null!==l&&void 0!==l?l:this.getRowParent(t-1))&&void 0!==l?l:this.getDataObject(t-1))?l.__children||(l.__children=[]):(l=this.getDataObject(t)).__children=[];i=i||n||r?l.__children.length:this.getRowIndexWithinParent(t),n=o===l;l.__children.splice(i,0,a[0]),o.__children.splice(s+(e&&n?1:0),1),this.syncRowWithRawSource(o),n||this.syncRowWithRawSource(l)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(203),n(452)),s=n(444),a=n(461),o=n(302),l=r(n(904)),u=r(n(905));class c extends l.default{constructor(e,t){var o;super(e,t),(o=this).dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];o.lastCollapsedRows=o.collapsedRows.slice(0),o.expandMultipleChildren(o.lastCollapsedRows,e)},shiftStash:function(n,r){let i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;null==r&&(r=1/0),(0,s.arrayEach)(o.lastCollapsedRows,(e,t)=>{n<=e&&e<r&&(o.lastCollapsedRows[t]=e+i)})},applyStash:function(){o.collapseMultipleChildren(o.lastCollapsedRows,!(0<arguments.length&&void 0!==arguments[0])||arguments[0]),o.lastCollapsedRows=void 0},trimStash:(e,t)=>{(0,a.rangeEach)(e,e+t-1,e=>{e=this.lastCollapsedRows.indexOf(e);-1<e&&this.lastCollapsedRows.splice(e,1)})}}}collapseChildren(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];const r=[];let i=null,o=null;return o=isNaN(e)?(i=e,this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(e),e),this.dataManager.hasChildren(i)&&(0,s.arrayEach)(i.__children,e=>{r.push(this.dataManager.getRowIndex(e))}),e=this.collapseRows(r,!0,!1),n&&this.trimRows(e),t&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(o)&&this.collapsedRows.push(o),e}collapseMultipleChildren(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];const r=[];(0,s.arrayEach)(e,e=>{r.push(...this.collapseChildren(e,!1,!1))}),n&&this.trimRows(r),t&&this.renderAndAdjust()}collapseRow(e){this.collapseRows([e],!(1<arguments.length&&void 0!==arguments[1])||arguments[1])}collapseRows(e){let t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];const r=[];return(0,s.arrayEach)(e,e=>{r.push(e),t&&this.collapseChildRows(e,r)}),n&&this.trimRows(r),r}collapseChildRows(e){let t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];var n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];this.dataManager.hasChildren(e)&&(e=this.dataManager.getDataObject(e),(0,s.arrayEach)(e.__children,e=>{e=this.dataManager.getRowIndex(e);t.push(e),this.collapseChildRows(e,t)})),n&&this.trimRows(t)}expandRow(e){this.expandRows([e],!(1<arguments.length&&void 0!==arguments[1])||arguments[1])}expandRows(e){let t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];const r=[];return(0,s.arrayEach)(e,e=>{r.push(e),t&&this.expandChildRows(e,r)}),n&&this.untrimRows(r),r}expandChildRows(e){let t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];var n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];this.dataManager.hasChildren(e)&&(e=this.dataManager.getDataObject(e),(0,s.arrayEach)(e.__children,e=>{this.isAnyParentCollapsed(e)||(e=this.dataManager.getRowIndex(e),t.push(e),this.expandChildRows(e,t))})),n&&this.untrimRows(t)}expandChildren(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];const r=[];let i=null,o=null;return o=isNaN(e)?(i=e,this.dataManager.getRowIndex(e)):(i=this.dataManager.getDataObject(e),e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(i)&&(0,s.arrayEach)(i.__children,e=>{e=this.dataManager.getRowIndex(e);r.push(e)}),e=this.expandRows(r,!0,!1),n&&this.untrimRows(e),t&&this.renderAndAdjust(),e}expandMultipleChildren(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];const r=[];(0,s.arrayEach)(e,e=>{r.push(...this.expandChildren(e,!1,!1))}),n&&this.untrimRows(r),t&&this.renderAndAdjust()}collapseAll(){var e=this.dataManager.getData();const t=[];(0,s.arrayEach)(e,e=>{this.dataManager.hasChildren(e)&&t.push(e)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){var e=this.dataManager.getData();const t=[];(0,s.arrayEach)(e,e=>{this.dataManager.hasChildren(e)&&t.push(e)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{(0,s.arrayEach)(e,e=>{this.plugin.collapsedRowsMap.setValueAtIndex(e,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{(0,s.arrayEach)(e,e=>{this.plugin.collapsedRowsMap.setValueAtIndex(e,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),n=!0;return null===t&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&(0,s.arrayEach)(t.__children,e=>{e=this.dataManager.getRowIndex(e);if(!this.plugin.collapsedRowsMap.getValueAtIndex(e))return n=!1}),n}isAnyParentCollapsed(e){let t=e;for(;null!==t;){t=this.dataManager.getRowParent(t);var n=this.dataManager.getRowIndex(t);if(-1<this.collapsedRows.indexOf(n))return!0}return!1}toggleState(e,t){0<=t.col||(t=this.translateTrimmedRow(t.row),(0,o.hasClass)(e.target,u.default.CSS_CLASSES.button)&&(this.areChildrenCollapsed(t)?this.expandChildren(t):this.collapseChildren(t),(0,i.stopImmediatePropagation)(e)))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}t.default=c},(e,t)=>{"use strict";t.__esModule=!0;t.default=class{constructor(e,t){this.hot=t,this.plugin=e}}},(e,t,n)=>{"use strict";var r=n(196),l=(t.__esModule=!0,n(444)),u=n(461),c=n(302);class d extends r(n(904)).default{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){var e=this.hot.toPhysicalRow(e),n=this.dataManager.getRowLevel(e),r=this.dataManager.getDataObject(e);const i=t.getElementsByTagName("DIV")[0];var o=i.querySelector("span.rowHeader"),s=i.querySelectorAll('[class^="ht_nesting"]');if((0,l.arrayEach)(s,e=>{e&&i.removeChild(e)}),(0,c.addClass)(t,d.CSS_CLASSES.indicatorContainer),n){const a=this.hot["rootDocument"];s=o.cloneNode(!0);(i.innerHTML="",u.rangeEach)(0,n-1,()=>{var e=a.createElement("SPAN");(0,c.addClass)(e,d.CSS_CLASSES.emptyIndicator),i.appendChild(e)}),i.appendChild(s)}this.dataManager.hasChildren(r)&&(o=this.hot.rootDocument.createElement("DIV"),(0,c.addClass)(t,d.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(e)?(0,c.addClass)(o,d.CSS_CLASSES.button+" "+d.CSS_CLASSES.expandButton):(0,c.addClass)(o,d.CSS_CLASSES.button+" "+d.CSS_CLASSES.collapseButton),i.appendChild(o))}updateRowHeaderWidth(e){let t=e;t=t||this.dataManager.cache.levelCount,this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}r=d;t.default=r},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(461)),o=n(444),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=a(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(568)),r=r(n(904));function a(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(a=function(e){return e?n:t})(e))}const l=new WeakMap;class u extends r.default{constructor(e,t){super(e,t),l.set(this,{row_above:(e,t)=>{t=t[t.length-1];this.dataManager.addSibling(t.start.row,"above")},row_below:(e,t)=>{t=t[t.length-1];this.dataManager.addSibling(t.start.row,"below")}}),this.dataManager=this.plugin.dataManager}appendOptions(r){const e=[{key:"add_child",name(){return this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:()=>{var e=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),e=this.dataManager.getDataObject(e);this.dataManager.addChild(e)},disabled:()=>{var e=this.hot.getSelectedLast();return!e||e[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(s.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{var e=this.hot.getSelectedLast(),t=this.dataManager.translateTrimmedRow(e[0]);return!this.dataManager.getRowParent(t)||!e||e[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return(0,i.rangeEach)(0,r.items.length-1,n=>{if(0===n)return(0,o.arrayEach)(e,(e,t)=>{r.items.splice(n+t,0,e)}),!1}),this.modifyRowInsertingOptions(r)}modifyRowInsertingOptions(n){const r=l.get(this);return(0,i.rangeEach)(0,n.items.length-1,e=>{var t=r[n.items[e].key];null!=t&&(n.items[e].callback=t)}),n}}t.default=u},(e,t,n)=>{"use strict";t.__esModule=!0,n(203);var o=n(305),s=n(455),a=n(443);t.default=class{constructor(e){this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){var o=this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i});if(!o){this.movedToCollapsed=!1;o=r===this.hot.countRows();const l=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let t=!0;var s=e.map(e=>{return!!t&&(e=this.dataManager.translateTrimmedRow(e),t=this.shouldAllowMoving(e,l),e)}),a=-1===s.indexOf(l);t&&a&&(o=this.getBaseParent(s)===(a=this.getTargetParent(o,l)),this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(a),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(s,l,o),this.moveRows(s,l,a),this.dataManager.rewriteCache(),this.moveCellsMeta(s,l),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r))}return!1}displayAPICompatibilityWarning(e){var{rows:e,finalIndex:t,dropIndex:n,movePossible:r}=e;let i=!1;return(0,o.isUndefined)(n)&&((0,s.warn)((0,a.toSingleLine)`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",e,t,n,r,!1),i=!0),i}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||0===t)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let n=this.dataManager.getRowParent(e?t-1:t);return n=null!==n&&void 0!==n?n:this.dataManager.getRowParent(t-1)}shiftCollapsibleParentsLocations(e,t,n){n||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,n){const r=t===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender(()=>{e.forEach(e=>{this.dataManager.moveRow(e,t,this.movedToCollapsed,r)})})}moveCellsMeta(e,t){const n=[];var r=Math.max(...e)<t;e.forEach(e=>{n.push(this.hot.getCellMetaAtRow(e))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(r?n.length:0),0,...n)}selectCells(t,n){var r=t.length;let i=0,o=0;var e=null;if(this.movedToCollapsed){let e=null;e=t[r-1]<n?this.dataManager.translateTrimmedRow(n-r):this.dataManager.translateTrimmedRow(n);var s=this.dataManager.getRowParent(null===e?this.hot.countSourceRows()-1:e-1),s=this.dataManager.getRowIndex(s);i=this.dataManager.untranslateTrimmedRow(s),o=i}else t[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);e=this.hot.selection,s=this.hot.countCols()-1,e.setRangeStart(this.hot._createCellCoords(i,0)),e.setRangeEnd(this.hot._createCellCoords(o,s),!0)}isRowOrderChanged(e,n){return e.some((e,t)=>e-t!==n)}}},(e,t,n)=>{"use strict";n.r(t)},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(910);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.PersistentState=n.PersistentState},(e,t,n)=>{"use strict";var r=n(196),i=(t.__esModule=!0,n(688)),o=r(n(911)),r=r(n(454));r.default.getSingleton().register("persistentStateSave"),r.default.getSingleton().register("persistentStateLoad"),r.default.getSingleton().register("persistentStateReset");const s="persistentState";t.PLUGIN_KEY=s;t.PLUGIN_PRIORITY=0;class a extends i.BasePlugin{static get PLUGIN_KEY(){return s}static get PLUGIN_PRIORITY(){return 0}constructor(e){super(e),this.storage=void 0}isEnabled(){return!!this.hot.getSettings()[s]}enablePlugin(){this.enabled||(this.storage||(this.storage=new o.default(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){void 0===e?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}t.PersistentState=a},(e,t,n)=>{"use strict";t.__esModule=!0,n(448),n(203);var r=n(444);t.default=class{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window;this.rootWindow=t,this.prefix=e,this.savedKeys=[],this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(this.prefix+"_"+e,JSON.stringify(t)),-1===this.savedKeys.indexOf(e)&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){t=this.rootWindow.localStorage.getItem(this.prefix+"_"+(void 0===e?t:e));return null===t?void 0:JSON.parse(t)}reset(e){this.rootWindow.localStorage.removeItem(this.prefix+"_"+e)}resetAll(){(0,r.arrayEach)(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(this.prefix+"_"+this.savedKeys[t])}),this.clearSavedKeys()}loadSavedKeys(){var e=this.rootWindow.localStorage.getItem(this.prefix+"__persistentStateKeys"),e="string"==typeof e?JSON.parse(e):void 0;this.savedKeys=e||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(this.prefix+"__persistentStateKeys",JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(913);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.Search=n.Search},(e,t,n)=>{"use strict";t.__esModule=!0,n(203);var r=n(688),i=n(447),d=n(461),o=n(305);function s(e,t,n,r,i){e.getCellMeta(t,n).isSearchResult=i}function a(e,t,n){return!((0,o.isUndefined)(e)||null===e||!e.toLocaleLowerCase||0===e.length||(0,o.isUndefined)(t)||null===t||-1===t.toString().toLocaleLowerCase(n.locale).indexOf(e.toLocaleLowerCase(n.locale)))}const l="search";t.PLUGIN_KEY=l,t.PLUGIN_PRIORITY=190;class u extends r.BasePlugin{static get PLUGIN_KEY(){return l}static get PLUGIN_PRIORITY(){return 190}constructor(e){super(e),this.callback=s,this.queryMethod=a,this.searchResultClass="htSearchResult"}isEnabled(){return this.hot.getSettings()[l]}enablePlugin(){var e,t=this;this.enabled||(e=this.hot.getSettings()[l],this.updatePluginSettings(e),this.addHook("beforeRenderer",function(){return t.onBeforeRenderer(...arguments)}),super.enablePlugin())}disablePlugin(){var e=this;function t(){return e.onBeforeRenderer(...arguments)}this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(s){let a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.getCallback(),l=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod();var e=this.hot.countRows();const t=this.hot.countCols(),u=[],c=this.hot;return(0,d.rangeEach)(0,e-1,o=>{(0,d.rangeEach)(0,t-1,e=>{var t,n=this.hot.getDataAtCell(o,e),r=this.hot.getCellMeta(o,e),i=r.search.callback||a,r=(r.search.queryMethod||l)(s,n,r);r&&(t={row:o,col:e,data:n},u.push(t)),i&&i(c,o,e,n,r)})}),u}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){(0,i.isObject)(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback)&&this.setCallback(e.callback)}onBeforeRenderer(e,t,n,r,i,o){var s=o.className||[];let a=[];"string"==typeof s?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(""+this.searchResultClass):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}destroy(){super.destroy()}}t.Search=u},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(915);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.TouchScroll=n.TouchScroll},(e,t,n)=>{"use strict";t.__esModule=!0,n(203);var r=n(302),i=n(444),o=n(688),s=n(490);const a="touchScroll";t.PLUGIN_KEY=a;t.PLUGIN_PRIORITY=200;class l extends o.BasePlugin{static get PLUGIN_KEY(){return a}static get PLUGIN_PRIORITY(){return 200}static get SETTING_KEYS(){return!0}constructor(e){super(e),this.scrollbars=[],this.clones=[],this.lockedCollection=!1,this.freezeOverlays=!1}isEnabled(){return(0,s.isTouchSupported)()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>this.onAfterViewRender()),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>this.onBeforeTouchScroll()),this.addHook("afterMomentumScroll",()=>this.onAfterMomentumScroll())}onAfterViewRender(){var e,t,n,r,i;this.lockedCollection||({topOverlay:e,bottomOverlay:t,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays,this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),t.clone&&this.scrollbars.push(t),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode))}onBeforeTouchScroll(){this.freezeOverlays=!0,(0,i.arrayEach)(this.clones,e=>{(0,r.addClass)(e,"hide-tween")})}onAfterMomentumScroll(){(this.freezeOverlays=!1,i.arrayEach)(this.clones,e=>{(0,r.removeClass)(e,"hide-tween"),(0,r.addClass)(e,"show-tween")}),this.hot._registerTimeout(()=>{(0,i.arrayEach)(this.clones,e=>{(0,r.removeClass)(e,"show-tween")})},400),(0,i.arrayEach)(this.scrollbars,e=>{e.refresh(),e.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}t.TouchScroll=l},(e,t,n)=>{"use strict";t.__esModule=!0;n=n(917);t.PLUGIN_KEY=n.PLUGIN_KEY,t.PLUGIN_PRIORITY=n.PLUGIN_PRIORITY,t.TrimRows=n.TrimRows},(e,t,n)=>{"use strict";t.__esModule=!0,n(203);var r=n(688),i=n(543),s=n(444);const o="trimRows";t.PLUGIN_KEY=o;t.PLUGIN_PRIORITY=330;class a extends r.BasePlugin{static get PLUGIN_KEY(){return o}static get PLUGIN_PRIORITY(){return 330}constructor(e){super(e),this.trimmedRowsMap=null}isEnabled(){return!!this.hot.getSettings()[o]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new i.TrimmingMap),this.trimmedRowsMap.addLocalHook("init",()=>this.onMapInit()),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[o];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),(0,s.arrayEach)(e,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){var t=this.getTrimmedRows(),n=this.isValidConfig(e);let r=t;n&&(r=Array.from(new Set(t.concat(e)))),!1!==this.hot.runHooks("beforeTrimRow",t,r,n)&&(n&&this.hot.batchExecution(()=>{(0,s.arrayEach)(e,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0),this.hot.runHooks("afterTrimRow",t,r,n,n&&r.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.trimRows(t)}untrimRows(e){var t=this.getTrimmedRows(),n=this.isValidConfig(e);let r=t;const i=this.trimmedRowsMap.getValues().slice();var o=0<e.length,e=(n&&o&&((0,s.arrayEach)(e,e=>{i[e]=!1}),r=(0,s.arrayReduce)(i,(e,t,n)=>(t&&e.push(n),e),[])),this.hot.runHooks("beforeUntrimRow",t,r,n&&o));!1!==e&&(n&&o&&this.trimmedRowsMap.setValues(i),this.hot.runHooks("afterUntrimRow",t,r,n&&o,n&&r.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(e=>Number.isInteger(e)&&0<=e&&e<t)}onMapInit(){const e=this.hot.getSettings()[o];Array.isArray(e)&&this.hot.batchExecution(()=>{(0,s.arrayEach)(e,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}destroy(){super.destroy()}}t.TrimRows=a},(e,t,n)=>{"use strict";t.__esModule=!0;n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var n,r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e){var o;"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&((o=i?Object.getOwnPropertyDescriptor(e,n):null)&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n])}r.default=e,t&&t.set(e,r);return r}(n(919));function s(e){var t,n;return"function"!=typeof WeakMap?null:(t=new WeakMap,n=new WeakMap,(s=function(e){return e?n:t})(e))}t.UndoRedo=n.default,t.PLUGIN_KEY=n.PLUGIN_KEY},(e,t,n)=>{"use strict";var r=n(196),r=(t.__esModule=!0,n(203),r(n(454))),l=n(444),d=n(461),h=n(447),o=n(723);function f(u){const c=this;this.instance=u,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,u.addHook("afterChange",function(n,e){const r=n&&n.length;r&&n.find(e=>{var[,,e,t]=e;return e!==t})&&c.done(()=>{var e=n.reduce((e,t)=>(e.push([...t]),e),[]),t=((0,l.arrayEach)(e,e=>{e[1]=u.propToCol(e[1])}),1<r?this.getSelected():[[e[0][0],e[0][1]]]);return new f.ChangeAction(e,t)},e)}),u.addHook("afterCreateRow",(e,t,n)=>{c.done(()=>new f.CreateRowAction(e,t),n)}),u.addHook("beforeRemoveRow",(n,r,e,t)=>{c.done(()=>{var e=u.toPhysicalRow(n),t=(0,h.deepClone)(c.instance.getSourceData(e,0,e+r-1,c.instance.countSourceCols()-1));return new f.RemoveRowAction(e,t,u.getSettings().fixedRowsBottom,u.getSettings().fixedRowsTop,u.rowIndexMapper.getIndexesSequence())},t)}),u.addHook("afterCreateCol",(e,t,n)=>{c.done(()=>new f.CreateColumnAction(e,t),n)}),u.addHook("beforeRemoveCol",(a,l,e,t)=>{c.done(()=>{const r=c.instance.getSourceDataArray(),i=(c.instance.countCols()+a)%c.instance.countCols(),o=[],t=[],n=[];(0,d.rangeEach)(r.length-1,e=>{const t=[],n=r[e];(0,d.rangeEach)(i,i+(l-1),e=>{t.push(n[u.toPhysicalColumn(e)])}),o.push(t)}),(0,d.rangeEach)(l-1,e=>{n.push(u.toPhysicalColumn(i+e))}),Array.isArray(u.getSettings().colHeaders)&&(0,d.rangeEach)(l-1,e=>{t.push(u.getSettings().colHeaders[u.toPhysicalColumn(i+e)]||null)});var e=u.columnIndexMapper.getIndexesSequence(),s=u.rowIndexMapper.getIndexesSequence();return new f.RemoveColumnAction(i,n,o,t,e,s,u.getSettings().fixedColumnsStart)},t)}),u.addHook("beforeCellAlignment",(e,t,n,r)=>{c.done(()=>new f.CellAlignmentAction(e,t,n,r))}),u.addHook("beforeFilter",e=>{c.done(()=>new f.FiltersAction(e))}),u.addHook("beforeRowMove",(e,t)=>{!1!==e&&c.done(()=>new f.RowMoveAction(e,t))}),u.addHook("beforeMergeCells",(e,t)=>{t||c.done(()=>new f.MergeCellsAction(u,e))}),u.addHook("afterUnmergeCells",(e,t)=>{t||c.done(()=>new f.UnmergeCellsAction(u,e))}),u.addHook("afterInit",()=>{c.init()})}t.PLUGIN_KEY="undoRedo",f.prototype.done=function(e,t){var n;this.ignoreNewActions||"UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t||(n=this.doneActions.slice(),!1!==this.instance.runHooks("beforeUndoStackChange",n,t)&&(t=e(),e=this.undoneActions.slice(),this.doneActions.push(t),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",e),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice())))},f.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());var e=(0,h.deepClone)(n),t=this.instance.runHooks("beforeUndo",e);if(!1!==t){this.ignoreNewActions=!0;const r=this;t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t),n.undo(this.instance,()=>{r.ignoreNewActions=!1,r.undoneActions.push(n)}),this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice()),this.instance.runHooks("afterUndo",e)}}},f.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());var e=(0,h.deepClone)(n),t=this.instance.runHooks("beforeRedo",e);if(!1!==t){this.ignoreNewActions=!0;const r=this;t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t),n.redo(this.instance,()=>{r.ignoreNewActions=!1,r.doneActions.push(n)}),this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice()),this.instance.runHooks("afterRedo",e)}}},f.prototype.isUndoAvailable=function(){return 0<this.doneActions.length},f.prototype.isRedoAvailable=function(){return 0<this.undoneActions.length},f.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},f.prototype.isEnabled=function(){return this.enabled},f.prototype.enable=function(){var e,t;this.isEnabled()||(e=this.instance,this.enabled=!0,(t=e).undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()},this.registerShortcuts(),e.addHook("afterChange",a))},f.prototype.disable=function(){var e,t;this.isEnabled()&&(e=this.instance,this.enabled=!1,delete(t=e).undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo,this.unregisterShortcuts(),e.removeHook("afterChange",a))},f.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},f.Action=function(){},f.Action.prototype.undo=function(){},f.Action.prototype.redo=function(){},f.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"},(0,h.inherit)(f.ChangeAction,f.Action),f.ChangeAction.prototype.undo=function(n,e){var r=(0,h.deepClone)(this.changes),i=n.countEmptyRows(!0),o=n.countEmptyCols(!0);for(let e=0,t=r.length;e<t;e++)r[e].splice(3,1);n.addHookOnce("afterChange",e),n.setDataAtCell(r,null,null,"UndoRedo.undo");for(let e=0,t=r.length;e<t;e++){var[s,a]=r[e];n.getSettings().minSpareRows&&s+1+n.getSettings().minSpareRows===n.countRows()&&i===n.getSettings().minSpareRows&&(n.alter("remove_row",parseInt(s+1,10),n.getSettings().minSpareRows),n.undoRedo.doneActions.pop()),n.getSettings().minSpareCols&&a+1+n.getSettings().minSpareCols===n.countCols()&&o===n.getSettings().minSpareCols&&(n.alter("remove_col",parseInt(a+1,10),n.getSettings().minSpareCols),n.undoRedo.doneActions.pop())}n.selectCells(this.selected,!1,!1)},f.ChangeAction.prototype.redo=function(e,t){var n=(0,h.deepClone)(this.changes);for(let e=0,t=n.length;e<t;e++)n[e].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)},f.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"},(0,h.inherit)(f.CreateRowAction,f.Action),f.CreateRowAction.prototype.undo=function(e,t){var n=e.countRows(),r=e.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},f.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},f.RemoveRowAction=function(e,t,n,r,i){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=i},(0,h.inherit)(f.RemoveRowAction,f.Action),f.RemoveRowAction.prototype.undo=function(e,t){var n=e.getSettings();const i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((n,r)=>{Object.keys(n).forEach(e=>{var t=parseInt(e,10);i.push([this.index+r,isNaN(t)?e:t,n[e]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},f.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},f.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"},(0,h.inherit)(f.CreateColumnAction,f.Action),f.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},f.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},f.RemoveColumnAction=function(e,t,n,r,i,o,s){this.index=e,this.indexes=t,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s},(0,h.inherit)(f.RemoveColumnAction,f.Action),f.RemoveColumnAction.prototype.undo=function(n,e){n.getSettings().fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort();var t=(e,t,n)=>n[this.indexes.indexOf(i[t])],r=this.data.length;const o=[];for(let e=0;e<r;e++)o.push((0,l.arrayMap)(this.data[e],t));var s=(0,l.arrayMap)(this.headers,t);const a=[];n.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),(0,l.arrayEach)(n.getSourceDataArray(),(n,r)=>{(0,l.arrayEach)(i,(e,t)=>{n[e]=o[r][t],a.push([r,e,n[e]])})}),n.setSourceDataAtCell(a,void 0,void 0,"UndoRedo.undo"),void 0!==this.headers&&(0,l.arrayEach)(s,(e,t)=>{n.getSettings().colHeaders[i[t]]=e}),n.batchExecution(()=>{n.rowIndexMapper.setIndexesSequence(this.rowPositions),n.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),n.addHookOnce("afterViewRender",e),n.render()},f.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},f.CellAlignmentAction=function(e,t,n,r){this.stateBefore=e,this.range=t,this.type=n,this.alignment=r},f.CellAlignmentAction.prototype.undo=function(n,e){(0,l.arrayEach)(this.range,e=>{e.forAll((e,t)=>{0<=e&&0<=t&&n.setCellMeta(e,t,"className",this.stateBefore[e][t]||" htLeft")})}),n.addHookOnce("afterViewRender",e),n.render()},f.CellAlignmentAction.prototype.redo=function(i,e){(0,o.align)(this.range,this.type,this.alignment,(e,t)=>i.getCellMeta(e,t),(e,t,n,r)=>i.setCellMeta(e,t,n,r)),i.addHookOnce("afterViewRender",e),i.render()},f.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"},(0,h.inherit)(f.FiltersAction,f.Action),f.FiltersAction.prototype.undo=function(e,t){var n=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()},f.FiltersAction.prototype.redo=function(e,t){var n=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class i extends f.Action{constructor(e,t){super(),this.cellRange=t;var t=this.cellRange.getTopStartCorner(),n=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(t.row,t.col,n.row,n.col)}undo(e,t){var n=e.getPlugin("mergeCells"),t=(e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0),this.cellRange.getTopStartCorner());e.populateFromArray(t.row,t.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange)}}f.MergeCellsAction=i;class s extends f.Action{constructor(e,t){super(),this.cellRange=t}undo(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange,!0)}redo(e,t){var n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0),e.render()}}function a(e,t){if("loadData"===t)return this.undoRedo.clear()}f.UnmergeCellsAction=s,f.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t,this.actionType="row_move"},(0,h.inherit)(f.RowMoveAction,f.Action),f.RowMoveAction.prototype.undo=function(t,e){var n=t.getPlugin("manualRowMove"),r=[].concat(this.rows),i=r.filter(e=>e>this.finalIndex),r=r.filter(e=>e<=this.finalIndex),o=i.sort((e,t)=>t-e).concat(r.sort((e,t)=>e-t));t.addHookOnce("afterViewRender",e);for(let e=0;e<o.length;e+=1){var s=t.toVisualRow(o[e]);n.moveRow(s,o[e])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},f.RowMoveAction.prototype.redo=function(e,t){var n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),n.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)},f.prototype.init=function(){var e=this.instance.getSettings().undo,e=void 0===e||e;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},f.prototype.registerShortcuts=function(){this.instance.getShortcutManager().getContext("grid").addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],{runOnlyIf:e=>!e.altKey,group:"undoRedo"})},f.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup("undoRedo")};n=r.default.getSingleton(),n.add("afterUpdateSettings",function(){var e;null!=(e=this.getPlugin("undoRedo"))&&e.init()}),n.register("beforeUndo"),n.register("afterUndo"),n.register("beforeRedo"),n.register("afterRedo"),f.PLUGIN_KEY="undoRedo",f.SETTING_KEYS=!0,r=f;t.default=r},(e,t,n)=>{"use strict";t.__esModule=!0,t.default=function(l){var e="undefined"!=typeof window&&window.jQuery;e&&(e.fn.handsontable=function(e){var t,n=this.first();let r=n.data("handsontable");if("string"!=typeof e)return t=e||{},r?r.updateSettings(t):(r=new l.Core(n[0],t),n.data("handsontable",r),r.init()),n;let i;if(r){if(void 0===r[e])throw new Error("Handsontable do not provide action: "+e);for(var o=arguments.length,s=new Array(1<o?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];i=r[e].call(r,...s),"destroy"===e&&n.removeData()}return i})},n(273)}],r={};function i(e){var t=r[e];return void 0!==t||(t=r[e]={id:e,loaded:!1,exports:{}},n[e].call(t.exports,t,t.exports,i),t.loaded=!0),t.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),i(0);var e=i(195),e=e.default;return e})()),!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("handsontable"));else if("function"==typeof define&&define.amd)define(["handsontable"],t);else{var n,r="object"==typeof exports?t(require("handsontable")):t(e.Handsontable);for(n in r)("object"==typeof exports?exports:e)[n]=r[n]}}("undefined"!=typeof self?self:this,t=>{return n=[,e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},e=>{"use strict";e.exports=t}],i={},o={},(()=>{"use strict";var e=o,t=r(1),t=(e.__esModule=!0,t(r(2))),n=t.default.languages.dictionaryKeys,n={languageCode:"ko-KR",[n.CONTEXTMENU_ITEMS_ROW_ABOVE]:"위쪽에 행 삽입",[n.CONTEXTMENU_ITEMS_ROW_BELOW]:"아래쪽에 행 삽입",[n.CONTEXTMENU_ITEMS_INSERT_LEFT]:"왼쪽에 열 삽입",[n.CONTEXTMENU_ITEMS_INSERT_RIGHT]:"오른쪽에 열 삽입",[n.CONTEXTMENU_ITEMS_REMOVE_ROW]:["행 삭제","여러 행 삭제"],[n.CONTEXTMENU_ITEMS_REMOVE_COLUMN]:["열 삭제","여러 열 삭제"],[n.CONTEXTMENU_ITEMS_UNDO]:"되돌리기",[n.CONTEXTMENU_ITEMS_REDO]:"다시하기",[n.CONTEXTMENU_ITEMS_READ_ONLY]:"읽기 전용",[n.CONTEXTMENU_ITEMS_CLEAR_COLUMN]:"열 지우기",[n.CONTEXTMENU_ITEMS_ALIGNMENT]:"정렬",[n.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT]:"왼쪽",[n.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER]:"중앙",[n.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT]:"오른쪽",[n.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY]:"자동",[n.CONTEXTMENU_ITEMS_ALIGNMENT_TOP]:"위쪽",[n.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE]:"가운데",[n.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM]:"아래쪽",[n.CONTEXTMENU_ITEMS_FREEZE_COLUMN]:"열 고정",[n.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN]:"열 고정 해제",[n.CONTEXTMENU_ITEMS_BORDERS]:"테두리",[n.CONTEXTMENU_ITEMS_BORDERS_TOP]:"위쪽",[n.CONTEXTMENU_ITEMS_BORDERS_RIGHT]:"오른쪽",[n.CONTEXTMENU_ITEMS_BORDERS_BOTTOM]:"아래쪽",[n.CONTEXTMENU_ITEMS_BORDERS_LEFT]:"왼쪽",[n.CONTEXTMENU_ITEMS_REMOVE_BORDERS]:"테두리 지우기",[n.CONTEXTMENU_ITEMS_ADD_COMMENT]:"댓글 달기",[n.CONTEXTMENU_ITEMS_EDIT_COMMENT]:"댓글 편집",[n.CONTEXTMENU_ITEMS_REMOVE_COMMENT]:"댓글 삭제",[n.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT]:"읽기 전용 댓글",[n.CONTEXTMENU_ITEMS_MERGE_CELLS]:"셀 병합",[n.CONTEXTMENU_ITEMS_UNMERGE_CELLS]:"셀 병합 해제",[n.CONTEXTMENU_ITEMS_COPY]:"복사",[n.CONTEXTMENU_ITEMS_CUT]:"잘라내기",[n.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD]:"자녀 행 추가",[n.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD]:"부모행에서 제거",[n.CONTEXTMENU_ITEMS_HIDE_COLUMN]:["열 숨기기","여러 열 숨기기"],[n.CONTEXTMENU_ITEMS_SHOW_COLUMN]:["열 숨기기 해제","여러 열 숨기기 해제"],[n.CONTEXTMENU_ITEMS_HIDE_ROW]:["행 숨기기","여러 행 숨기기"],[n.CONTEXTMENU_ITEMS_SHOW_ROW]:["행 숨기기 해제","여러 행 숨기기 해제"],[n.FILTERS_CONDITIONS_NONE]:"조건없음",[n.FILTERS_CONDITIONS_EMPTY]:"비어있음",[n.FILTERS_CONDITIONS_NOT_EMPTY]:"비어있지 않음",[n.FILTERS_CONDITIONS_EQUAL]:"같",[n.FILTERS_CONDITIONS_NOT_EQUAL]:"같지 않음",[n.FILTERS_CONDITIONS_BEGINS_WITH]:"시작 문자",[n.FILTERS_CONDITIONS_ENDS_WITH]:"끝 문자",[n.FILTERS_CONDITIONS_CONTAINS]:"포함",[n.FILTERS_CONDITIONS_NOT_CONTAIN]:"포함하지 않음",[n.FILTERS_CONDITIONS_GREATER_THAN]:"보다 큼",[n.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL]:"크거나 같음",[n.FILTERS_CONDITIONS_LESS_THAN]:"보다 작",[n.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL]:"작거나 같음",[n.FILTERS_CONDITIONS_BETWEEN]:"사이",[n.FILTERS_CONDITIONS_NOT_BETWEEN]:"사이 제외",[n.FILTERS_CONDITIONS_AFTER]:"다음",[n.FILTERS_CONDITIONS_BEFORE]:"전",[n.FILTERS_CONDITIONS_TODAY]:"오늘",[n.FILTERS_CONDITIONS_TOMORROW]:"내일",[n.FILTERS_CONDITIONS_YESTERDAY]:"어제",[n.FILTERS_VALUES_BLANK_CELLS]:"공란",[n.FILTERS_DIVS_FILTER_BY_CONDITION]:"조건부 필터",[n.FILTERS_DIVS_FILTER_BY_VALUE]:"값 필터",[n.FILTERS_LABELS_CONJUNCTION]:"그리고",[n.FILTERS_LABELS_DISJUNCTION]:"또는",[n.FILTERS_BUTTONS_SELECT_ALL]:"전체선택",[n.FILTERS_BUTTONS_CLEAR]:"지우기",[n.FILTERS_BUTTONS_OK]:"확인",[n.FILTERS_BUTTONS_CANCEL]:"취소",[n.FILTERS_BUTTONS_PLACEHOLDER_SEARCH]:"찾기",[n.FILTERS_BUTTONS_PLACEHOLDER_VALUE]:"값",[n.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE]:"두번째 값"};t.default.languages.registerLanguageDictionary(n),e.default=n})(),o.___;function r(e){var t=i[e];return void 0!==t||(t=i[e]={exports:{}},n[e](t,t.exports,r)),t.exports}var n,i,o}),!function(Z,Q){var r="__instance__",o="firstChild",c=setTimeout;function d(e){return void 0!==e}function h(e){return"object"==typeof e}function f(e){return Object.keys(e).length}function J(e,t,n){return e<t?t:n<e?n:e}function p(e){return Math.round(e)}function ee(e){var t,n,r,i=+e[0],o=+e[1],s=+e[2],e=Math.floor(6*i),i=6*i-e,a=s*(1-o),l=s*(1-i*o),u=s*(1-(1-i)*o);switch(l=l||0,u=u||0,(e||0)%6){case 0:t=s,n=u,r=a;break;case 1:t=l,n=s,r=a;break;case 2:t=a,n=s,r=u;break;case 3:t=a,n=l,r=s;break;case 4:t=u,n=a,r=s;break;case 5:t=s,n=a,r=l}return[p(255*t),p(255*n),p(255*r)]}function te(e){return t(ee(e))}function t(e){return("000000"+(+e[2]|+e[1]<<8|+e[0]<<16).toString(16)).slice(-6)}Z.CP=function(g,m,j){var z=Q.body,s=Q.documentElement,y=this,t=Z.CP,n=!1,i={},v=Q.createElement("div"),b="touchstart mousedown",E="touchmove mousemove",G="touchend mouseup",Y="orientationchange resize";if(!(y instanceof t))return new t(g,m);function C(e,t,n){for(var r=0,i=(e=e.split(/\s+/)).length;r<i;++r)t.addEventListener(e[r],n,!1)}function w(e,t,n){for(var r=0,i=(e=e.split(/\s+/)).length;r<i;++r)t.removeEventListener(e[r],n)}function X(e,t){var n="touches",r=(t[n]?t[n][0]:t).clientX,n=(t[n]?t[n][0]:t).clientY,t=a(e);return{x:r-t.l,y:n-t.t}}function a(e){var t,e=e===Z?(t=Z.pageXOffset||s.scrollLeft,Z.pageYOffset||s.scrollTop):(t=(e=e.getBoundingClientRect()).left,e.top);return{l:t,t:e}}function S(e,t){for(;(e=e.parentElement)&&e!==t;);return e}function T(e){e&&e.preventDefault()}function R(e){return e===Z?{w:Z.innerWidth,h:Z.innerHeight}:{w:e.offsetWidth,h:e.offsetHeight}}function A(e){return n||!!d(e)&&e}function _(e){n=e}function N(e,t,n){if(d(i[e]))if(d(n))d(i[e][n])&&i[e][n].apply(y,t);else for(var r in i[e])i[e][r].apply(y,t);return y}t[r][g.id||g.name||f(t[r])]=y,d(m)&&!0!==m||(m=b),_(t.parse(g.getAttribute("data-color")||g.value||[0,1,1])),v.className="color-picker",v.innerHTML='<div class="color-picker-container"><span class="color-picker-h"><i></i></span><span class="color-picker-sv"><i></i></span></div>';var x,e=v[o].children,O=A([0,1,1]),I=e[0],M=e[1],k=I[o],D=M[o],L=0,P=0,F=0,B=0,l=0,u=0,K=0,q=0,H=[te(O)];function U(e,t){e&&"h"!==e||N("change:h",t),e&&"sv"!==e||N("change:sv",t),N("change",t)}function V(){return v.parentNode}function W(e,t){e||((j||t||z).appendChild(v),y.visible=!0),K=R(v).w,q=R(v).h;var t=R(M),n=R(D),r=R(I).h,i=t.w,o=t.h,s=R(k).h,a=n.w,l=n.h;function u(e){e=e.target;e===g||S(e,g)===g?V()||(W(),N("enter")):y.exit()}function c(e){ee(O);var t=ee([O[0],1,1]);M.style.backgroundColor="rgb("+t.join(",")+")",_(O),T(e)}function d(e){var t,n;F&&(t=J(X(I,n=e).y,0,r),O[0]=(r-t)/r,k.style.top=t-s/2+"px",c(n),H=[te(O)],L||(N("drag:h",H),N("drag",H),U("h",H))),B&&(e=J((n=X(M,t=e)).x,0,i),n=J(n.y,0,o),O[1]=1-(i-e)/i,O[2]=(o-n)/o,D.style.right=i-e-a/2+"px",D.style.top=n-l/2+"px",c(t),H=[te(O)],P||(N("drag:sv",H),N("drag",H),U("sv",H))),P=L=0}function h(e){var e=e.target,t=F?"h":"sv",n=[te(O),y],r=e===g||S(e,g)===g,e=e===v||S(e,v)===v;r||e?e&&(N("stop:"+t,n),N("stop",n),U(t,n)):V()&&!1!==m&&(y.exit(),U(0,n)),B=F=0}function f(e){F=L=1,d(e),T(e),N("start:h",H),N("start",H),U("h",H)}function p(e){B=P=1,d(e),T(e),N("start:sv",H),N("start",H),U("sv",H)}e?(!(v.style.left=v.style.top="-9999px")!==m&&C(m,g,u),y.create=function(){return W(1),N("create"),y},y.destroy=function(){return!1!==m&&w(m,g,u),y.exit(),_(!1),N("destroy"),y}):$(),x=function(){O=A(O),c(),k.style.top=r-s/2-r*+O[0]+"px",D.style.right=i-a/2-i*+O[1]+"px",D.style.top=o-l/2-o*+O[2]+"px"},y.exit=function(e){var t=V();return t&&(t.removeChild(v),y.visible=!1),w(b,I,f),w(b,M,p),w(E,Q,d),w(G,Q,h),w(Y,Z,$),N("exit"),y},x(),e||(C(b,I,f),C(b,M,p),C(E,Q,d),C(G,Q,h),C(Y,Z,$))}function $(){return y.fit()}return W(1),c(function(){var e=[te(O)];N("create",e),U(0,e)},0),y.fit=function(e){var t=R(Z),n=R(s),n=t.w-n.w,r=t.h-s.clientHeight,i=a(Z),o=a(g);return l=o.l+i.l,u=o.t+i.t+R(g).h,h(e)?(d(e[0])&&(l=e[0]),d(e[1])&&(u=e[1])):(o=i.l,e=i.t,n=i.l+t.w-K-n,i=i.t+t.h-q-r,l=J(l,o,n)>>0,u=J(u,e,i)>>0),v.style.left=l+"px",v.style.top=u+"px",N("fit"),y},y.set=function(e){return d(e)?(_(e="string"==typeof e?t.parse(e):e),x(),y):A()},y.get=A,y.source=g,y.self=v,y.visible=!1,y.on=function(e,t,n){return d(e)?d(t)?(d(i[e])||(i[e]={}),d(n)||(n=f(i[e])),i[e][n]=t,y):i[e]:i},y.off=function(e,t){return d(e)?d(t)?delete i[e][t]:i[e]={}:i={},y},y.fire=N,y.hooks=i,y.enter=function(e){return W(0,e),N("enter"),y},y}}(window,document),!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ISpin=t()}(this,function(){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function s(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);(t="function"==typeof Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})):t).forEach(function(e){var t,n;t=r,n=i[e=e],e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n})}return r}function a(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var e=function(){function r(e,t){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");this.el=e,this.options={},this._onKeyDown=this._onKeyDown.bind(this),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onMouseLeave=this._onMouseLeave.bind(this),this._onWheel=this._onWheel.bind(this),this.build(),this.update(t)}var e,t,n;return e=r,(t=[{key:"build",value:function(){var t=this;this._wrapper=document.createElement("div"),this.el.parentNode&&this.el.parentNode.replaceChild(this._wrapper,this.el),this._wrapper.appendChild(this.el),this._buttons={inc:document.createElement("button"),dec:document.createElement("button")},Object.keys(this._buttons).forEach(function(e){e=t._buttons[e];t._wrapper.appendChild(e),e.setAttribute("type","button"),e.addEventListener("mousedown",t._onMouseDown),e.addEventListener("mouseup",t._onMouseUp),e.addEventListener("mouseleave",t._onMouseLeave)}),this.el.addEventListener("keydown",this._onKeyDown),this.el.addEventListener("wheel",this._onWheel)}},{key:"update",value:function(t){var n=this;(t=s({},r.DEFAULTS,this.options,t)).wrapperClass!==this.options.wrapperClass&&(this.options.wrapperClass&&this._wrapper.classList.remove(this.options.wrapperClass),t.wrapperClass)&&this._wrapper.classList.add(t.wrapperClass),t.buttonsClass!==this.options.buttonsClass&&(this.options.buttonsClass&&Object.keys(this._buttons).forEach(function(e){n._buttons[e].classList.remove(n.options.buttonsClass),n._buttons[e].classList.remove(n.options.buttonsClass+"-"+e)}),t.buttonsClass)&&Object.keys(this._buttons).forEach(function(e){n._buttons[e].classList.add(t.buttonsClass),n._buttons[e].classList.add(t.buttonsClass+"-"+e)}),this.disabled=t.disabled,o(this.options,t)}},{key:"destroy",value:function(){this._wrapper.parentNode&&this._wrapper.parentNode.replaceChild(this.el,this._wrapper),delete this.el,delete this._wrapper,delete this._buttons}},{key:"_onKeyDown",value:function(e){switch(e.keyCode){case 38:return e.preventDefault(),this.spin(this.options.step);case 40:return e.preventDefault(),this.spin(-this.options.step);case 33:return e.preventDefault(),this.spin(this.options.pageStep);case 34:return e.preventDefault(),this.spin(-this.options.pageStep)}}},{key:"_onMouseDown",value:function(e){e.preventDefault();e=e.currentTarget===this._buttons.inc?1:-1;this.spin(e*this.options.step),this.el.focus(),this._startSpinning(e)}},{key:"_onMouseUp",value:function(e){this._stopSpinning()}},{key:"_onMouseLeave",value:function(e){this._stopSpinning()}},{key:"_startSpinning",value:function(e){var t=this;this._stopSpinning(),this._spinTimer=setInterval(function(){return t.spin(e*t.options.step)},this.options.repeatInterval)}},{key:"_stopSpinning",value:function(){clearInterval(this._spinTimer)}},{key:"_onWheel",value:function(e){document.activeElement===this.el&&(e.preventDefault(),e=0<e.deltaY?-1:1,this.spin(e*this.options.step))}},{key:"adjustValue",value:function(e){return e=Number(e.toFixed(this.precision)),null!=this.options.max&&e>this.options.max&&(e=this.options.max),e=null!=this.options.min&&e<this.options.min?this.options.min:e}},{key:"wrapValue",value:function(e){return this.options.wrapOverflow&&null!=this.options.max&&null!=this.options.min&&(e<this.options.min?e=this.options.max:e>this.options.max&&(e=this.options.min)),e}},{key:"spin",value:function(e){this.value=this.adjustValue(this.wrapValue(this.value+e))}},{key:"value",get:function(){return this.options.parse(this.el.value)||0},set:function(e){e=this.options.format(this.options.parse(String(e)));this.el.value=e,this.options.onChange&&this.options.onChange(e)}},{key:"disabled",get:function(){return this._buttons.inc.disabled},set:function(e){this.disabled!==e&&(this._buttons.inc.disabled=this._buttons.dec.disabled=e)}},{key:"precision",get:function(){return Math.max.apply(Math,a([this.options.step,this.options.min].filter(function(e){return null!=e}).map(l)))}}])&&i(e.prototype,t),n&&i(e,n),r}();function l(e){return(String(e).split(".")[1]||"").length}return e.DEFAULTS={wrapperClass:"ispin-wrapper",buttonsClass:"ispin-button",step:1,pageStep:10,disabled:!1,repeatInterval:200,wrapOverflow:!1,parse:Number,format:String},e}),!function(e,t){"use strict";var n;if("object"==typeof exports){try{n=require("moment")}catch(e){}module.exports=t(n)}else"function"==typeof define&&define.amd?define(function(e){try{n=e("moment")}catch(e){}return t(n)}):e.Pikaday=t(e.moment)}(this,function(O){"use strict";function i(e,t,n,r){l?e.addEventListener(t,n,!!r):e.attachEvent("on"+t,n)}function t(e,t,n,r){l?e.removeEventListener(t,n,!!r):e.detachEvent("on"+t,n)}function o(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")}function h(e,t){o(e,t)||(e.className=""===e.className?t:e.className+" "+t)}function f(e,t){e.className=(e=(" "+e.className+" ").replace(" "+t+" "," ")).trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function m(e){return/Array/.test(Object.prototype.toString.call(e))}function I(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())}function M(e,t){return[31,(e=e)%4==0&&e%100!=0||e%400==0?29:28,31,30,31,30,31,31,30,31,30,31][t]}function k(e){I(e)&&e.setHours(0,0,0,0)}function D(e,t){return e.getTime()===t.getTime()}function s(e,t,n){var r,i;for(r in t)(i=void 0!==e[r])&&"object"==typeof t[r]&&null!==t[r]&&void 0===t[r].nodeName?I(t[r])?n&&(e[r]=new Date(t[r].getTime())):m(t[r])?n&&(e[r]=t[r].slice(0)):e[r]=s({},t[r],n):!n&&i||(e[r]=t[r]);return e}function a(e,t,n){var r;p.createEvent?((r=p.createEvent("HTMLEvents")).initEvent(t,!0,!1),r=s(r,n),e.dispatchEvent(r)):p.createEventObject&&(r=p.createEventObject(),r=s(r,n),e.fireEvent("on"+t,r))}function n(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),11<e.month&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e}function L(e){function t(e){return(e+7-1)%7}e.setHours(0,0,0,0);var n=e.getDate(),r=e.getDay(),n=(e.setDate(n+3-t(r)),new Date(e.getFullYear(),0,4)),r=(e.getTime()-n.getTime())/864e5;return 1+Math.round((r-3+t(n.getDay()))/7)}function P(e,t,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+function(e){var t,n=[];for(e.showWeekNumber&&n.push("<th></th>"),t=0;t<7;t++)n.push('<th scope="col"><abbr title="'+c(e,t)+'">'+c(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?n.reverse():n).join("")+"</tr></thead>"}(e)+"<tbody>"+t.join("")+"</tbody></table>"}function e(e){var n=this,r=n.config(e),e=(n._onMouseDown=function(e){if(n._v){var t=(e=e||window.event).target||e.srcElement;if(t)if(o(t,"is-disabled")||(!o(t,"pika-button")||o(t,"is-empty")||o(t.parentNode,"is-disabled")?o(t,"pika-prev")?n.prevMonth():o(t,"pika-next")&&n.nextMonth():(n.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day"))),r.bound&&u(function(){n.hide(),r.blurFieldOnSelect&&r.field&&r.field.blur()},100))),o(t,"pika-select"))n._c=!0;else{if(!e.preventDefault)return e.returnValue=!1;e.preventDefault()}}},n._onChange=function(e){e=(e=e||window.event).target||e.srcElement;e&&(o(e,"pika-select-month")?n.gotoMonth(e.value):o(e,"pika-select-year")&&n.gotoYear(e.value))},n._onKeyChange=function(e){if(e=e||window.event,n.isVisible())switch(e.keyCode){case 13:case 27:r.field&&r.field.blur();break;case 37:n.adjustDate("subtract",1);break;case 38:n.adjustDate("subtract",7);break;case 39:n.adjustDate("add",1);break;case 40:n.adjustDate("add",7);break;case 8:case 46:n.setDate(null)}},n._parseFieldValue=function(){var e;return r.parse?r.parse(r.field.value,r.format):F?(e=O(r.field.value,r.format,r.formatStrict))&&e.isValid()?e.toDate():null:new Date(Date.parse(r.field.value))},n._onInputChange=function(e){e.firedBy===n||(e=n._parseFieldValue(),I(e)&&n.setDate(e),n._v)||n.show()},n._onInputFocus=function(){n.show()},n._onInputClick=function(){n.show()},n._onInputBlur=function(){var e=p.activeElement;do{if(o(e,"pika-single"))return}while(e=e.parentNode);n._c||(n._b=u(function(){n.hide()},50)),n._c=!1},n._onClick=function(e){var e=(e=e||window.event).target||e.srcElement,t=e;if(e){l||!o(e,"pika-select")||e.onchange||(e.setAttribute("onchange","return;"),i(e,"change",n._onChange));do{if(o(t,"pika-single")||t===r.trigger)return}while(t=t.parentNode);n._v&&e!==r.trigger&&t!==r.trigger&&n.hide()}},n.el=p.createElement("div"),n.el.className="pika-single"+(r.isRTL?" is-rtl":"")+(r.theme?" "+r.theme:""),i(n.el,"mousedown",n._onMouseDown,!0),i(n.el,"touchend",n._onMouseDown,!0),i(n.el,"change",n._onChange),r.keyboardInput&&i(p,"keydown",n._onKeyChange),r.field&&(r.container?r.container.appendChild(n.el):r.bound?p.body.appendChild(n.el):r.field.parentNode.insertBefore(n.el,r.field.nextSibling),i(r.field,"change",n._onInputChange),r.defaultDate||(r.defaultDate=n._parseFieldValue(),r.setDefaultDate=!0)),r.defaultDate);I(e)?r.setDefaultDate?n.setDate(e,!0):n.gotoDate(e):n.gotoDate(new Date),r.bound?(this.hide(),n.el.className+=" is-bound",i(r.trigger,"click",n._onInputClick),i(r.trigger,"focus",n._onInputFocus),i(r.trigger,"blur",n._onInputBlur)):this.show()}var F="function"==typeof O,l=!!window.addEventListener,p=window.document,u=window.setTimeout,r={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},c=function(e,t,n){for(t+=e.firstDay;7<=t;)t-=7;return(n?e.i18n.weekdaysShort:e.i18n.weekdays)[t]};return e.prototype={config:function(e){this._o||(this._o=s({},r,!0));var e=s(this._o,e,!0),t=(e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme="string"==typeof e.theme&&e.theme?e.theme:null,e.bound=!!(void 0!==e.bound?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn="function"==typeof e.disableDayFn?e.disableDayFn:null,parseInt(e.numberOfMonths,10)||1);return e.numberOfMonths=4<t?4:t,I(e.minDate)||(e.minDate=!1),I(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),m(e.yearRange)?(t=(new Date).getFullYear()-10,e.yearRange[0]=parseInt(e.yearRange[0],10)||t,e.yearRange[1]=parseInt(e.yearRange[1],10)||t):(e.yearRange=Math.abs(parseInt(e.yearRange,10))||r.yearRange,100<e.yearRange&&(e.yearRange=100)),e},toString:function(e){return e=e||this._o.format,I(this._d)?this._o.toString?this._o.toString(this._d,e):F?O(this._d).format(e):this._d.toDateString():""},getMoment:function(){return F?O(this._d):null},setMoment:function(e,t){F&&O.isMoment(e)&&this.setDate(e.toDate(),t)},getDate:function(){return I(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",a(this._o.field,"change",{firedBy:this})),this.draw();var n,r;"string"==typeof e&&(e=new Date(Date.parse(e))),I(e)&&(n=this._o.minDate,r=this._o.maxDate,I(n)&&e<n?e=n:I(r)&&r<e&&(e=r),this._d=new Date(e.getTime()),k(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),a(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate()))},clear:function(){this.setDate(null)},gotoDate:function(e){var t,n,r,i=!0;I(e)&&(this.calendars&&(t=new Date(this.calendars[0].year,this.calendars[0].month,1),n=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),r=e.getTime(),n.setMonth(n.getMonth()+1),n.setDate(n.getDate()-1),i=r<t.getTime()||n.getTime()<r),i&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar)&&(this.calendars[0].month+=1-this._o.numberOfMonths),this.adjustCalendars())},adjustDate:function(e,t){var n,r=this.getDate()||new Date,t=24*parseInt(t)*60*60*1e3;"add"===e?n=new Date(r.valueOf()+t):"subtract"===e&&(n=new Date(r.valueOf()-t)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=n(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=n({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(k(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=r.minDate,this._o.minYear=r.minYear,this._o.minMonth=r.minMonth,this._o.startRange=r.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(k(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=r.maxDate,this._o.maxYear=r.maxYear,this._o.maxMonth=r.maxMonth,this._o.endRange=r.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(this._v||e){var t,n=this._o,e=n.minYear,r=n.maxYear,i=n.minMonth,o=n.maxMonth,s="";this._y<=e&&(this._y=e,!isNaN(i))&&this._m<i&&(this._m=i),this._y>=r&&(this._y=r,!isNaN(o))&&this._m>o&&(this._m=o);for(var a=0;a<n.numberOfMonths;a++)t="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+function(e,t,n,r,i,o){for(var s,a,l,u=e._o,c=n===u.minYear,d=n===u.maxYear,o='<div id="'+o+'" class="pika-title" role="heading" aria-live="assertive">',h=!0,f=!0,p=[],g=0;g<12;g++)p.push('<option value="'+(n===i?g-t:12+g-t)+'"'+(g===r?' selected="selected"':"")+(c&&g<u.minMonth||d&&g>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[g]+"</option>");for(a='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+p.join("")+"</select></div>",s=m(u.yearRange)?(g=u.yearRange[0],u.yearRange[1]+1):(g=n-u.yearRange,1+n+u.yearRange),p=[];g<s&&g<=u.maxYear;g++)g>=u.minYear&&p.push('<option value="'+g+'"'+(g===n?' selected="selected"':"")+">"+g+"</option>");return l='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+p.join("")+"</select></div>",u.showMonthAfterYear?o+=l+a:o+=a+l,c&&(0===r||u.minMonth>=r)&&(h=!1),d&&(11===r||u.maxMonth<=r)&&(f=!1),0===t&&(o+='<button class="pika-prev'+(h?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(o+='<button class="pika-next'+(f?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),o+"</div>"}(this,a,this.calendars[a].year,this.calendars[a].month,this.calendars[0].year,t)+this.render(this.calendars[a].year,this.calendars[a].month,t)+"</div>";this.el.innerHTML=s,n.bound&&"hidden"!==n.field.type&&u(function(){n.trigger.focus()},1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label",n.ariaLabel)}},adjustPosition:function(){var e,t,n,r,i,o,s,a,l,u,c,d;if(!this._o.container){if(this.el.style.position="absolute",t=e=this._o.trigger,n=this.el.offsetWidth,r=this.el.offsetHeight,i=window.innerWidth||p.documentElement.clientWidth,o=window.innerHeight||p.documentElement.clientHeight,s=window.pageYOffset||p.body.scrollTop||p.documentElement.scrollTop,d=c=!0,"function"==typeof e.getBoundingClientRect)a=(u=e.getBoundingClientRect()).left+window.pageXOffset,l=u.bottom+window.pageYOffset;else for(a=t.offsetLeft,l=t.offsetTop+t.offsetHeight;t=t.offsetParent;)a+=t.offsetLeft,l+=t.offsetTop;(this._o.reposition&&i<a+n||-1<this._o.position.indexOf("right")&&0<a-n+e.offsetWidth)&&(a=a-n+e.offsetWidth,c=!1),(this._o.reposition&&o+s<l+r||-1<this._o.position.indexOf("top")&&0<l-r-e.offsetHeight)&&(l=l-r-e.offsetHeight,d=!1),this.el.style.left=a+"px",this.el.style.top=l+"px",h(this.el,c?"left-aligned":"right-aligned"),h(this.el,d?"bottom-aligned":"top-aligned"),f(this.el,c?"right-aligned":"left-aligned"),f(this.el,d?"top-aligned":"bottom-aligned")}},render:function(e,t,n){for(var r=this._o,i=new Date,o=M(e,t),s=new Date(e,t,1).getDay(),a=[],l=[],u=(k(i),0<r.firstDay&&(s-=r.firstDay)<0&&(s+=7),0===t?11:t-1),c=11===t?0:t+1,d=0===t?e-1:e,h=11===t?e+1:e,f=M(d,u),p=o+s,g=p;7<g;)g-=7;p+=7-g;for(var m=!1,y=0,v=0;y<p;y++){var b=new Date(e,t,y-s+1),E=!!I(this._d)&&D(b,this._d),C=D(b,i),w=-1!==r.events.indexOf(b.toDateString()),S=y<s||o+s<=y,T=y-s+1,R=t,A=e,_=r.startRange&&D(r.startRange,b),N=r.endRange&&D(r.endRange,b),x=r.startRange&&r.endRange&&r.startRange<b&&b<r.endRange,T=(S&&(A=y<s?(T=f+T,R=u,d):(T-=o,R=c,h)),{day:T,month:R,year:A,hasEvent:w,isSelected:E,isToday:C,isDisabled:r.minDate&&b<r.minDate||r.maxDate&&b>r.maxDate||r.disableWeekends&&function(e){e=e.getDay();return 0===e||6===e}(b)||r.disableDayFn&&r.disableDayFn(b),isEmpty:S,isStartRange:_,isEndRange:N,isInRange:x,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths});r.pickWholeWeek&&E&&(m=!0),l.push(function(e){var t=[],n="false";if(e.isEmpty){if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';t.push("is-outside-current-month"),e.enableSelectionDaysInNextAndPreviousMonths||t.push("is-selection-disabled")}return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),n="true"),e.hasEvent&&t.push("has-event"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"}(T)),7==++v&&(r.showWeekNumber&&l.unshift(function(e,t,n){n=new Date(n,t,e);return'<td class="pika-week">'+(F?O(n).isoWeek():L(n))+"</td>"}(y-s,t,e)),a.push((R=l,A=r.isRTL,'<tr class="pika-row'+(r.pickWholeWeek?" pick-whole-week":"")+(m?" is-selected":"")+'">'+(A?R.reverse():R).join("")+"</tr>")),v=0,m=!(l=[]))}return P(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),f(this.el,"is-hidden"),this._o.bound&&(i(p,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var e=this._v;!1!==e&&(this._o.bound&&t(p,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",h(this.el,"is-hidden"),this._v=!1,void 0!==e)&&"function"==typeof this._o.onClose&&this._o.onClose.call(this)},destroy:function(){var e=this._o;this.hide(),t(this.el,"mousedown",this._onMouseDown,!0),t(this.el,"touchend",this._onMouseDown,!0),t(this.el,"change",this._onChange),e.keyboardInput&&t(p,"keydown",this._onKeyChange),e.field&&(t(e.field,"change",this._onInputChange),e.bound)&&(t(e.trigger,"click",this._onInputClick),t(e.trigger,"focus",this._onInputFocus),t(e.trigger,"blur",this._onInputBlur)),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},e}),!function(){var n="placeholder"in document.createElement("input");var s=Object.freeze({START:"start",STOP:"stop",NOTHING:!1}),a={letterDelay:100,sentenceDelay:1e3,loop:!1,startOnFocus:!0,shuffle:!1,showCursor:!0,cursor:"|",autoStart:!1,onFocusAction:s.START,onBlurAction:s.STOP};function r(e,t,n){var r,i;if(this.el=e,this.texts=t,this.options=function(e,t){var n,r={};for(n in e)r[n]=(void 0===t[n]?e:t)[n];return r}(a,n=n||{}),this.options.startOnFocus||(console.warn("Superplaceholder.js: `startOnFocus` option has been deprecated. Please use `onFocusAction`, `onBlurAction` and `autoStart`"),this.options.autoStart=!0,this.options.onFocusAction=s.NOTHING,this.options.onBlurAction=s.NOTHING),this.timeouts=[],this.isPlaying=!1,this.options.shuffle)for(var o=this.texts.length;o--;)i=~~(Math.random()*o),r=this.texts[i],this.texts[i]=this.texts[o],this.texts[o]=r;this.begin()}r.prototype.begin=function(){var e=this;e.originalPlaceholder=e.el.getAttribute("placeholder"),(e.options.onFocusAction||e.options.onBlurAction)&&(e.listeners={focus:e.onFocus.bind(e),blur:e.onBlur.bind(e)},e.el.addEventListener("focus",e.listeners.focus),e.el.addEventListener("blur",e.listeners.blur)),e.options.autoStart&&e.processText(0)},r.prototype.onFocus=function(){this.options.onFocusAction===s.START?this.isInProgress()||this.processText(0):this.options.onFocusAction===s.STOP&&this.cleanUp()},r.prototype.onBlur=function(){this.options.onBlurAction===s.STOP?this.cleanUp():this.options.onBlurAction!==s.START||this.isInProgress()||this.processText(0)},r.prototype.cleanUp=function(){for(var e=this.timeouts.length;e--;)clearTimeout(this.timeouts[e]);null===this.originalPlaceholder?this.el.removeAttribute("placeholder"):this.el.setAttribute("placeholder",this.originalPlaceholder),this.timeouts.length=0,this.isPlaying=!1},r.prototype.isInProgress=function(){return this.isPlaying},r.prototype.typeString=function(t,n){var e,r=this;if(!t)return!1;function i(e){r.el.setAttribute("placeholder",t.substr(0,e+1)+(e!==t.length-1&&r.options.showCursor?r.options.cursor:"")),e===t.length-1&&n()}for(var o=0;o<t.length;o++)e=setTimeout(i,o*r.options.letterDelay,o),r.timeouts.push(e)},r.prototype.processText=function(e){var t,n=this;this.isPlaying=!0,n.typeString(n.texts[e],function(){n.timeouts.length=0,n.options.loop||n.texts[e+1]||(n.isPlaying=!1),t=setTimeout(function(){n.processText(n.options.loop?(e+1)%n.texts.length:e+1)},n.options.sentenceDelay),n.timeouts.push(t)})};function e(e){var t;if(n)return t=new r(e.el,e.sentences,e.options),{start:function(){t.isInProgress()||t.processText(0)},stop:function(){t.cleanUp()},destroy:function(){for(var e in t.cleanUp(),t.listeners)t.el.removeEventListener(e,t.listeners[e])}}}e.Actions=s,"object"==typeof exports?module.exports=e:"function"==typeof define&&define.amd?define(function(){return e}):window.superplaceholder=e}(),!function(e,t){"function"==typeof define&&define.amd?define(function(){return t(e)}):"object"==typeof module&&module.exports?module.exports=t(e):(void 0===e.tail&&(e.tail={}),e.tail.select=t(e),"undefined"!=typeof jQuery&&(jQuery.fn.tailselect=function(e){var t,n=[];return this.each(function(){!1!==(t=tail.select(this,e))&&n.push(t)}),1===n.length?n[0]:0!==n.length&&n}),"undefined"!=typeof MooTools&&Element.implement({tailselect:function(e){return new tail.select(this,e)}}))}(window,function(e){"use strict";var s=e,u=e.document;function f(e,t){return!!(e&&"classList"in e)&&e.classList.contains(t)}function a(e,t){e&&"classList"in e&&e.classList.add(t)}function l(e,t){e&&"classList"in e&&e.classList.remove(t)}function i(e,t,n){var r;CustomEvent&&CustomEvent.name?r=new CustomEvent(t,n):(r=u.createEvent("CustomEvent")).initCustomEvent(t,!!n.bubbles,!!n.cancelable,n.detail),e.dispatchEvent(r)}function c(e,t){if("function"==typeof Object.assign)return Object.assign({},e,t||{});var n,r=Object.constructor();for(n in e)r[n]=(n in t?t:e)[n];return r}function p(e,t){e=u.createElement(e);return e.className=t&&t.join?t.join(" "):t||"",e}function d(e,t){if((e="string"==typeof e?u.querySelectorAll(e):e)instanceof NodeList||e instanceof HTMLCollection||e instanceof Array){for(var n=[],r=e.length,i=0;i<r;i++)n.push(new d(e[i],c(t,{})));return 1===n.length?n[0]:0!==n.length&&n}var o,s,a;return e instanceof Element&&this instanceof d?d.inst[e.getAttribute("data-tail-select")]?d.inst[e.getAttribute("data-tail-select")]:(e.getAttribute("data-select")&&(o=JSON.parse(e.getAttribute("data-select").replace(/\'/g,'"')))instanceof Object&&(t=c(t,o)),o=e.getAttribute("placeholder")||e.getAttribute("data-placeholder"),s="bindSourceSelect",a="sourceHide",(t=t instanceof Object?t:{}).multiple=("multiple"in t?t:e).multiple,t.disabled=("disabled"in t?t:e).disabled,t.placeholder=o||t.placeholder||null,t.width="auto"===t.width?e.offsetWidth+50:t.width,t.sourceBind=s in t?t[s]:t.sourceBind||!1,t.sourceHide=a in t?t[a]:t.sourceHide||!0,t.multiLimit=0<=t.multiLimit?t.multiLimit:1/0,this.e=e,this.id=++d.count,this.con=c(d.defaults,t),this.events={},(d.inst["tail-"+this.id]=this).init().bind()):e instanceof Element&&new d(e,t)}var h;return d.version="0.5.16",d.status="beta",d.count=0,d.inst={},d.defaults={animate:!0,classNames:null,csvOutput:!1,csvSeparator:",",descriptions:!1,deselect:!1,disabled:!1,height:350,hideDisabled:!1,hideSelected:!1,items:{},locale:"en",linguisticRules:{"е":"ё",a:"ä",o:"ö",u:"ü",ss:"ß"},multiple:!1,multiLimit:1/0,multiPinSelected:!1,multiContainer:!1,multiShowCount:!0,multiShowLimit:!1,multiSelectAll:!1,multiSelectGroup:!0,openAbove:null,placeholder:null,search:!1,searchConfig:["text","value"],searchFocus:!0,searchMarked:!0,searchMinLength:1,searchDisabled:!0,sortItems:!1,sortGroups:!1,sourceBind:!1,sourceHide:!0,startOpen:!1,stayOpen:!1,width:null,cbComplete:void 0,cbEmpty:void 0,cbLoopItem:void 0,cbLoopGroup:void 0},d.strings={en:{all:"전체",none:"없음",empty:"항목 없음",emptySearch:"항목 없음",limit:"더 많은 항목을 선택할 수 없습니다",placeholder:"항목 선택...",placeholderMulti:"항목 선택...",search:"검색 항목을 입력...",disabled:"항목 (사용 안함)"},modify:function(e,t,n){if(!(e in this))return!1;if(t instanceof Object)for(var r in t)this.modify(e,r,t[r]);else this[e][t]="string"==typeof n?n:this[e][t];return!0},register:function(e,t){return"string"==typeof e&&t instanceof Object&&(this[e]=t,!0)}},d.prototype={_e:function(e,t,n){if(!(e in this.__))return n||e;if("function"==typeof(e=this.__[e])&&(e=e.call(this,t)),"object"==typeof t)for(var r in t)e=e.replace(r,t[r]);return e},init:function(){var t=this,e=["tail-select"],n=this.con,r=!0===n.classNames?this.e.className:n.classNames;e.push(r&&r.push?r.join(" "):r&&r.split?r:"no-classes"),n.hideSelected&&e.push("hide-selected"),n.hideDisabled&&e.push("hide-disabled"),0==n.multiLimit&&e.push("disabled"),n.multiple&&e.push("multiple"),n.deselect&&e.push("deselect"),n.disabled&&e.push("disabled"),this.__=c(d.strings.en,d.strings[n.locale]||{}),this._init=!0,this._query=!1,this.select=p("DIV",e),this.label=p("DIV","select-label"),this.dropdown=p("DIV","select-dropdown"),this.search=p("DIV","dropdown-search"),this.csvInput=p("INPUT","select-search"),null!==this.e.getAttribute("tabindex")?this.select.setAttribute("tabindex",this.e.getAttribute("tabindex")):this.select.setAttribute("tabindex",0),n.width&&/^[0-9.]+(?:cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|\%)$/i.test(n.width)?this.select.style.width=n.width:n.width&&!isNaN(parseFloat(n.width,10))&&(this.select.style.width=n.width+"px"),this.label.addEventListener("click",function(e){t.toggle.call(t,t.con.animate)}),this.select.appendChild(this.label),isNaN(parseInt(n.height,10))||(this.dropdown.style.maxHeight=parseInt(n.height,10)+"px"),n.search&&(this.search.innerHTML='<input type="text" class="search-input" />',this.search.children[0].placeholder=this._e("search"),this.search.children[0].addEventListener("input",function(e){t.query.call(t,this.value.length>n.searchMinLength?this.value:void 0)}),this.dropdown.appendChild(this.search)),this.select.appendChild(this.dropdown),this.csvInput.type="hidden",n.csvOutput&&(this.csvInput.name=this.e.name,this.e.removeAttribute("name"),this.select.appendChild(this.csvInput)),n.multiple&&n.multiContainer&&(u.querySelector(n.multiContainer)?(this.container=u.querySelector(n.multiContainer),this.container.className+=" tail-select-container"):!0===n.multiContainer&&(this.container=this.label,this.container.className+=" tail-select-container")),this.options=new h(this.e,this);for(var i,o=this.e.options.length,s=0;s<o;s++)this.options.set(this.e.options[s],!1);for(i in n.items)"string"==typeof n.items[i]&&(n.items[i]={value:n.items[i]}),this.options.add(n.items[i].key||i,n.items[i].value,n.items[i].group,n.items[i].selected,n.items[i].disabled,n.items[i].description);return this.query(),this.e.nextElementSibling?this.e.parentElement.insertBefore(this.select,this.e.nextElementSibling):this.e.parentElement.appendChild(this.select),n.sourceHide&&("none"==this.e.style.display?(this.select.style.display="none",this.e.setAttribute("data-select-hidden","display")):"hidden"==this.e.style.visibility?(this.select.style.visibiltiy="hidden",this.e.setAttribute("data-select-hidden","visibility")):(this.e.style.display="none",this.e.setAttribute("data-select-hidden","0"))),this.e.setAttribute("data-tail-select","tail-"+this.id),t.con.startOpen&&this.open(n.animate),(n.cbComplete||function(){}).call(this,this.select),this._init=!1,this},bind:function(){var s=this;return u.addEventListener("keydown",function(e){var t,n,r,i,o=e.keyCode||e.which;if(!(32==o&&s.select===document.activeElement)&&(!f(s.select,"active")||[13,27,38,40].indexOf(o)<0))return!1;if(e.preventDefault(),e.stopPropagation(),32===o)return s.open(s.con.animate);if(13==o&&(t=s.dropdown.querySelector(".dropdown-option.hover:not(.disabled)"))&&s.options.select.call(s.options,t),27==o||13==o)return s.close(s.con.animate);if(t=s.dropdown.querySelector(".dropdown-option.hover:not(.disabled)"))for(l(t,"hover"),r=[(40==o?"next":"previous")+"ElementSibling"];(t=null!==(i=t[r])&&"LI"==t.tagName?i:null!==(i=t.parentElement[r])&&0<i.children.length&&"UL"==i.tagName&&i.children[40==o?0:i.children.length-1])&&(!f(t,"dropdown-option")||f(t,"disabled")););return t||40!=o?t||38!=o||(t=(e=s.dropdown.querySelectorAll(".dropdown-option:not(.disabled)"))[e.length-1]):t=s.dropdown.querySelector(".dropdown-option:not(.disabled)"),t&&(n=s.dropdown.querySelector(".dropdown-inner"))&&(e=function(e){for(var t={top:e.offsetTop,height:e.offsetHeight};(e=e.parentElement)!=n;)t.top+=e.offsetTop;return t}(t),a(t,"hover"),n.scrollTop=Math.max(0,e.top-2*e.height)),!0}),u.addEventListener("click",function(e){if(!f(s.select,"active")||f(s.select,"idle"))return!1;if(!0===s.con.stayOpen)return!1;for(var t=[s.e,s.select,s.container],n=t.length,r=0;r<n;r++){if(t[r]&&(t[r].contains(e.target)||t[r]==e.target))return!1;if(!e.target.parentElement)return!1}return s.close.call(s,s.con.animate)}),this.con.sourceBind&&this.e.addEventListener("change",function(e){if(null!=e.detail)return!1;var t;e.preventDefault(),e.stopPropagation(),!this.multiple&&this.selectedIndex?s.options.select.call(s.options,this.options[this.selectedIndex]):(t=[].concat(s.options.selected),e=[].filter.call(this.querySelectorAll("option:checked"),function(e){return!(0<=t.indexOf(e)&&(t.splice(t.indexOf(e),1),1))}),s.options.walk.call(s.options,"unselect",t),s.options.walk.call(s.options,"select",e))}),!0},callback:function(e,t,n){var r="[data-key='"+e.key.replace(/('|\\)/g,"\\$1")+"'][data-group='"+e.group.replace(/('|\\)/g,"\\$1")+"']";return"rebuild"==t?this.query():((r=this.dropdown.querySelector(r))&&0<=["select","disable"].indexOf(t)?a(r,"select"==t?"selected":"disabled"):r&&0<=["unselect","enable"].indexOf(t)&&l(r,"unselect"==t?"selected":"disabled"),this.update(e),!0===n||this.trigger("change",e,t))},trigger:function(e){var t,n,r;return!this._init&&(t={bubbles:!1,cancelable:!0,detail:{args:arguments,self:this}},"change"==e&&arguments[2]&&0<=arguments[2].indexOf("select")&&(i(this.e,"input",t),i(this.e,"change",t)),i(this.select,"tail::"+e,t),n=[],Array.prototype.map.call(arguments,function(e,t){0<t&&n.push(e)}),(this.events[e]||[]).forEach(function(e){(r=[].concat(n)).push(e.args||null),(e.cb||function(){}).apply(t.detail.self,r)}),!0)},calc:function(){var e=this.dropdown.cloneNode(!0),t=this.con.height,n=0,r=this.dropdown.querySelector(".dropdown-inner"),e=((e=this.dropdown.cloneNode(!0)).style.cssText="height:auto;min-height:auto;max-height:none;opacity:0;display:block;visibility:hidden;",e.style.maxHeight=this.con.height+"px",e.className+=" cloned",this.dropdown.parentElement.appendChild(e),t=t>e.clientHeight?e.clientHeight:t,this.con.search&&(n=e.querySelector(".dropdown-search").clientHeight),this.dropdown.parentElement.removeChild(e),this.select.getBoundingClientRect()),i=s.innerHeight-(e.top+e.height),o=i<t+n&&e.top>i;return(!0===this.con.openAbove||!1!==this.con.openAbove&&o?(o=!0,t=Math.min(t,e.top-10),a):(o=!1,t=Math.min(t,i-10),l))(this.select,"open-top"),r&&(this.dropdown.style.maxHeight=t+"px",r.style.maxHeight=t-n+"px"),this},query:function(e,t){var n,r,i,o,s,a=this,l=this.con,u="getAttribute",c=p("DIV","dropdown-inner"),d=e?"finder":"walker",h=e?[e,t]:[l.sortItems,l.sortGroups];for(this._query="string"==typeof e&&e;n=this.options[d].apply(this.options,h);){if(!i||i[u]("data-group")!==n.group){if(!((r=(l.cbLoopGroup||this.cbGroup).call(this,n.group,e,c))instanceof Element))break;(i=r).setAttribute("data-group",n.group),c.appendChild(i)}if(null!==(o=(l.cbLoopItem||this.cbItem).call(this,n,i,e,c))){if(!1===o)break;o.setAttribute("data-key",n.key),o.setAttribute("data-group",n.group),o.addEventListener("click",function(e){if(!this.hasAttribute("data-key"))return!1;var t=this[u]("data-key"),n=this[u]("data-group")||"#";a.options.toggle.call(a.options,t,n)&&!1===a.con.stayOpen&&!a.con.multiple&&a.close.call(a,a.con.animate)}),i.appendChild(o)}}var t=c.querySelectorAll("*[data-key]").length,t=(0==t&&(this.con.cbEmpty||function(e){var t=p("SPAN","dropdown-empty");t.innerText=this._e("empty"),e.appendChild(t)}).call(this,c,e),0<t&&l.multiple&&l.multiLimit==1/0&&l.multiSelectAll&&(t=p("BUTTON","tail-all"),s=p("BUTTON","tail-none"),t.innerText=this._e("all"),t.addEventListener("click",function(e){e.preventDefault();e=a.dropdown.querySelectorAll(".dropdown-inner .dropdown-option");a.options.walk.call(a.options,"select",e)}),s.innerText=this._e("none"),s.addEventListener("click",function(e){e.preventDefault();e=a.dropdown.querySelectorAll(".dropdown-inner .dropdown-option");a.options.walk.call(a.options,"unselect",e)}),(o=p("SPAN","dropdown-action")).appendChild(t),o.appendChild(s),c.insertBefore(o,c.children[0])),this.dropdown.querySelector(".dropdown-inner"));return this.dropdown[(t?"replace":"append")+"Child"](c,t),f(this.select,"active")&&this.calc(),this.updateCSV().updateLabel()},cbGroup:function(e,t){var n,r=p("UL","dropdown-optgroup"),i=this;return"#"!=e&&(r.innerHTML='<li class="optgroup-title"><b>'+e+"</b></li>",this.con.multiple&&this.con.multiLimit==1/0&&this.con.multiSelectAll)&&(e=p("BUTTON","tail-none"),n=p("BUTTON","tail-all"),e.innerText=this._e("none"),e.addEventListener("click",function(e){e.preventDefault();e=this.parentElement.parentElement.getAttribute("data-group");i.options.all.call(i.options,"unselect",e)}),n.innerText=this._e("all"),n.addEventListener("click",function(e){e.preventDefault();e=this.parentElement.parentElement.getAttribute("data-group");i.options.all.call(i.options,"select",e)}),r.children[0].appendChild(e),r.children[0].appendChild(n)),r},cbItem:function(e,t,n){var r=p("LI","dropdown-option"+(e.selected?" selected":"")+(e.disabled?" disabled":""));return n&&0<n.length&&this.con.searchMarked?(n=this.options.applyLinguisticRules(n),r.innerHTML=e.value.replace(new RegExp("("+n+")","i"),"<mark>$1</mark>")):r.innerText=e.value,this.con.descriptions&&e.description&&(r.innerHTML+='<span class="option-description">'+e.description+"</span>"),r},update:function(e){return this.updateLabel().updateContainer(e).updatePin(e).updateCSV(e)},updateLabel:function(e){var t,n,r;return this.container==this.label&&0<this.options.selected.length?(this.label.querySelector(".label-inner")&&this.label.removeChild(this.label.querySelector(".label-inner")),this.label.querySelector(".label-count")&&this.label.removeChild(this.label.querySelector(".label-count"))):(t=this.con,n=this.options.selected.length,"string"!=typeof e&&(e=t.disabled?"disabled":0==this.dropdown.querySelectorAll("*[data-key]").length?"empty"+(f(this.select,"in-search")?"Search":""):t.multiLimit<=n?"limit":!t.multiple&&0<this.options.selected.length?this.options.selected[0].innerText:"string"==typeof t.placeholder?t.placeholder:"placeholder"+(t.multiple&&t.multiLimit<1/0?"Multi":"")),e='<span class="label-inner">'+(e=this._e(e,{":limit":t.multiLimit},e))+"</span>",r=t.multiShowLimit&&t.multiLimit<1/0,t.multiple&&t.multiShowCount&&(e=(e='<span class="label-count">:c</span>'+e).replace(":c",n+(r?" / "+t.multiLimit:""))),this.label.innerHTML=e),this},updateContainer:function(e){var n,t;return this.container&&this.con.multiContainer&&(t="[data-group='"+e.group+"'][data-key='"+e.key+"']",this.container.querySelector(t)?e.selected||this.container.removeChild(this.container.querySelector(t)):e.selected&&(n=this,(t=p("DIV","select-handle")).innerText=e.value,t.setAttribute("data-key",e.key),t.setAttribute("data-group",e.group),t.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var e=this.getAttribute("data-key"),t=this.getAttribute("data-group");n.options.unselect.call(n.options,e,t)}),this.container.appendChild(t))),this},updatePin:function(e){var t=this.dropdown.querySelector(".dropdown-inner ul"),n="li[data-key='"+e.key+"'][data-group='"+e.group+"']";if(this.con.multiPinSelected&&t&&!1===this._query)if(n=this.dropdown.querySelector(n),e.selected)t.insertBefore(n,t.children[0]);else{for(var r=this.dropdown.querySelector("ul[data-group='"+e.group+"']"),i=this.options[e.index-1],o=!1;i&&i.group==e.group&&!(o=r.querySelector("li[data-key='"+i.key+"']"));)i=this.options[i.index-1];o&&o.nextElementSibling?r.insertBefore(n,o.nextElementSibling):r.appendChild(n)}return this},updateCSV:function(e){if(this.csvInput&&this.con.csvOutput){for(var t=[],n=this.options.selected.length,r=0;r<n;r++)t.push(this.options.selected[r].value);this.csvInput.value=t.join(this.con.csvSeparator||",")}return this},open:function(e){if(f(this.select,"active")||f(this.select,"idle")||this.con.disabled)return!1;this.calc();function r(){a(i.select,"active"),l(i.select,"idle"),this.dropdown.style.height="auto",this.dropdown.style.overflow="visible",this.label.removeAttribute("style"),this.con.search&&this.con.searchFocus&&this.dropdown.querySelector("input").focus(),this.trigger.call(this,"open")}var i=this,o=this.dropdown.style;return!1!==e?(this.label.style.zIndex=25,this.dropdown.style.cssText+="height:0;display:block;overflow:hidden;",a(i.select,"idle"),function e(){var t=parseInt(o.height,10),n=parseInt(o.maxHeight,10);return n<=t?r.call(i):(o.height=(n<t+50?n:t+50)+"px",void setTimeout(e,20))}()):(o.cssText="height:"+o.maxHeight+";display:block;overflow:hidden;",r.call(this)),this},close:function(e){var t,n,r;return!(!f(this.select,"active")||f(this.select,"idle"))&&(r=(n=this).dropdown,!(t=function(){l(this.select,"active"),l(this.select,"idle"),this.dropdown.removeAttribute("style"),this.dropdown.querySelector(".dropdown-inner").removeAttribute("style"),this.trigger.call(this,"close")})!==e?(a(this.select,"idle"),this.dropdown.style.overflow="hidden",function e(){return parseInt(r.offsetHeight,10)-50<=0?t.call(n):(r.style.height=parseInt(r.offsetHeight,10)-50+"px",void setTimeout(e,20))}()):t.call(this),this)},toggle:function(e){return f(this.select,"active")?this.close(e):f(this.select,"idle")?this:this.open(e)},remove:function(){if(this.e.removeAttribute("data-tail-select"),this.e.hasAttribute("data-select-hidden")&&("0"==this.e.getAttribute("data-select-hidden")&&this.e.style.removeProperty("display"),this.e.removeAttribute("data-select-hidden")),Array.prototype.map.call(this.e.querySelectorAll("[data-select-option='add']"),function(e){e.parentElement.removeChild(e)}),Array.prototype.map.call(this.e.querySelectorAll("[data-select-optgroup='add']"),function(e){e.parentElement.removeChild(e)}),this.e.name=(this.csvInput.hasAttribute("name")?this.csvInput:this.e).name,this.select.parentElement&&this.select.parentElement.removeChild(this.select),this.container)for(var e=this.container.querySelectorAll(".select-handle"),t=e.length,n=0;n<t;n++)this.container.removeChild(e[n]);return this},reload:function(){return this.remove().init()},config:function(e,t,n){if(e instanceof Object){for(var r in e)this.config(r,e[r],!1);return this.reload(),this.con}return void 0===e?this.con:e in this.con&&(void 0===t?this.con[e]:(this.con[e]=t,!1!==n&&this.reload(),this))},enable:function(e){return l(this.select,"disabled"),this.e.disabled=!1,(this.con.disabled=!1)===e?this:this.reload()},disable:function(e){return a(this.select,"disabled"),this.e.disabled=!0,!(this.con.disabled=!0)===e?this:this.reload()},on:function(e,t,n){return!(["open","close","change"].indexOf(e)<0||"function"!=typeof t)&&(e in this.events||(this.events[e]=[]),this.events[e].push({cb:t,args:n instanceof Array?n:[]}),this)},value:function(){return 0==this.options.selected.length?null:this.con.multiple?this.options.selected.map(function(e){return e.value}):this.options.selected[0].value}},(h=d.options=function(e,t){return this instanceof h?(this.self=t,this.element=e,this.length=0,this.selected=[],this.disabled=[],this.items={"#":{}},this.groups={},this):new h(e,t)}).prototype={_r:function(e){return e.replace("disabled","disable").replace("enabled","enable").replace("selected","select").replace("unselected","unselect")},get:function(e,t){var n="getAttribute";if("object"==typeof e&&e.key&&e.group)t=e.group||t,e=e.key;else if(e instanceof Element)"OPTION"==e.tagName?(t=e.parentElement.label||"#",e=e.value||e.innerText):e.hasAttribute("data-key")&&(t=e[n]("data-group")||e.parentElement[n]("data-group")||"#",e=e[n]("data-key"));else if("string"!=typeof e)return!1;return e=/^[0-9]+$/.test(e)?"_"+e:e,t in this.items&&this.items[t][e]},set:function(e,t){var n,r,i=e.value||e.innerText,o=e.parentElement.label||"#";return o in this.items||(this.items[o]={},this.groups[o]=e.parentElement),!(i in this.items[o])&&(n=/^[0-9]+$/.test(i)?"_"+i:i,(r=this.self.con).multiple&&this.selected.length>=r.multiLimit&&(e.selected=!1),!e.selected||!r.deselect||e.hasAttribute("selected")&&0!=r.multiLimit||(e.selected=!1,e.parentElement.selectedIndex=-1),e.hasAttribute("data-description")&&((r=p("SPAN")).innerHTML=e.getAttribute("data-description"),e.setAttribute("data-description",r.innerHTML)),this.items[o][n]={key:i,value:e.text,description:e.getAttribute("data-description")||null,group:o,option:e,optgroup:"#"!=o?this.groups[o]:void 0,selected:e.selected,disabled:e.disabled,hidden:e.hidden||!1},this.length++,e.selected&&this.select(this.items[o][n]),e.disabled&&this.disable(this.items[o][n]),!t||this.self.callback(this.items[o][i],"rebuild"))},add:function(e,t,n,r,i,o,s){if(e instanceof Object){for(var a in e)this.add(e[a].key||a,e[a].value,e[a].group,e[a].selected,e[a].disabled,e[a].description,!1);return this.self.query()}var l;return!this.get(e,n)&&("#"===(n="string"==typeof n?n:"#")||n in this.groups||((l=p("OPTGROUP")).label=n,l.setAttribute("data-select-optgroup","add"),this.element.appendChild(l),this.items[n]={},this.groups[n]=l),this.self.con.multiple&&this.selected.length>=this.self.con.multiLimit&&(r=!1),i=!!i,(l=u.createElement("OPTION")).value=e,l.selected=r,l.disabled=i,l.innerText=t,l.setAttribute("data-select-option","add"),o&&0<o.length&&l.setAttribute("data-description",o),("#"==n?this.element:this.groups[n]).appendChild(l),this.set(l,s))},move:function(e,t,n,r){return!!(e=this.get(e,t))&&("#"===n||n in this.groups||((t=p("OPTGROUP")).label=n,this.element.appendChild(t),this.items[n]={},this.groups[n]=t,this.groups[n].appendChild(e.option)),delete this.items[e.group][e.key],e.group=n,e.optgroup=this.groups[n]||void 0,this.items[n][e.key]=e,!r||this.self.query())},remove:function(e,t,n){if(!(e=this.get(e,t)))return!1;e.selected&&this.unselect(e),e.disabled&&this.enable(e),e.option.parentElement.removeChild(e.option);t=/^[0-9]+$/.test(e.key)?"_"+e.key:e.key;return delete this.items[e.group][t],this.length--,0===Object.keys(this.items[e.group]).length&&(delete this.items[e.group],delete this.groups[e.group]),!n||this.self.query()},is:function(e,t,n){e=this._r(e),t=this.get(t,n);return!t||["select","unselect","disable","enable"].indexOf(e)<0?null:"disable"==e||"enable"==e?"disable"==e?t.disabled:!t.disabled:("select"==e||"unselect"==e)&&("select"==e?t.selected:!t.selected)},handle:function(e,t,n,r){t=this.get(t,n),e=this._r(e);if(!t||["select","unselect","disable","enable"].indexOf(e)<0)return null;if("disable"==e||"enable"==e)return t.option in this.disabled||"disable"!=e?t.option in this.disabled&&"enable"==e&&this.disabled.splice(this.disabled.indexOf(t.option),1):this.disabled.push(t.option),t.disabled="disable"==e,t.option.disabled="disable"==e,this.self.callback.call(this.self,t,e);var n=f(this.self.select,"disabled")||t.disabled||t.option.disabled,i=this.self.con.multiple&&this.self.con.multiLimit<=this.selected.length,o=!this.self.con.multiple&&0<this.selected.indexOf(t.option),s=0==this.self.con.multiLimit&&1==this.self.con.deselect,a=!this.self.con.multiple&&!this.self.con.deselect&&!0!==r;if("select"==e){if(n||i||s||o)return!1;if(!this.self.con.multiple)for(var l in this.selected)this.unselect(this.selected[l],void 0,!0);this.selected.indexOf(t.option)<0&&this.selected.push(t.option)}else if("unselect"==e){if(n||a)return!1;this.selected.splice(this.selected.indexOf(t.option),1)}return t.selected="select"==e,t.option.selected="select"==e,t.option[(6<e.length?"remove":"set")+"Attribute"]("selected","selected"),this.self.callback.call(this.self,t,e,r)},enable:function(e,t){return this.handle("enable",e,t,!1)},disable:function(e,t){return this.handle("disable",e,t,!1)},select:function(e,t){return this.handle("select",e,t,!1)},unselect:function(e,t,n){return this.handle("unselect",e,t,n)},toggle:function(e,t){return!!(e=this.get(e,t))&&this.handle(e.selected?"unselect":"select",e,t,!1)},invert:function(t){t=this._r(t),0<=["enable","disable"].indexOf(t)?(n=this.disabled,r="enable"==t?"disable":"enable"):0<=["select","unselect"].indexOf(t)&&(n=this.selected,r="select"==t?"unselect":"select");var n,r,e=Array.prototype.filter.call(this,function(e){return!(e in n)}),i=this;return[].concat(n).forEach(function(e){i.handle.call(i,r,e)}),[].concat(e).forEach(function(e){i.handle.call(i,t,e)}),!0},all:function(t,n){var r=this,e=this;return n in this.items?e=Object.keys(this.items[n]):0<=["unselect","enable"].indexOf(t)&&(e=[].concat("unselect"==t?this.selected:this.disabled)),Array.prototype.forEach.call(e,function(e){r.handle.call(r,t,e,n,!1)}),!0},walk:function(t,e,n){if(e instanceof Array||e.length)for(var r=e.length,i=0;i<r;i++)this.handle.apply(this,[t,e[i],null].concat(n));else if(e instanceof Object){var o=this;if(e.forEach)e.forEach(function(e){o.handle.apply(o,[t,e,null].concat(n))});else for(var s in e)("string"==typeof e[s]||"number"==typeof e[s]||e[s]instanceof Element)&&this.handle.apply(this,[t,e[s],s in this.items?s:null]).concat(n)}return this},applyLinguisticRules:function(e,t){var n=this.self.con.linguisticRules,r=[];return Object.keys(n).forEach(function(e){r.push("("+e+"|["+n[e]+"])")}),t&&(r=r.concat(r.map(function(e){return e.toUpperCase()}))),e.replace(new RegExp(r.join("|"),t?"g":"ig"),function(e){return r[[].indexOf.call(arguments,e,1)-1]})},find:function(e,t){var n,r,i,o,s=this,a={};return"function"==typeof(t=t||this.self.con.searchConfig)?o=t.bind(this,e):((t=t instanceof Array?t:[t]).forEach(function(e){"string"==typeof e&&(a[e]=!0)}),a.any=a.any||a.attributes&&a.value,a.regex&&!a.text||(e=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")),a.exactglyphes||(e=this.self.options.applyLinguisticRules(e,a.case)),a.word&&(e="\\b"+e+"\\b"),n=new RegExp(e,a.case?"m":"mi"),r=function(e){return n.test(e.text||e.value)},o=a.any?function(e){return r(e)||[].some.call(e.attributes,r)}:a.attributes?function(e){return[].some.call(e.attributes,r)}:r,this.self.con.searchDisabled||(i=o,o=function(e){return!e.disabled&&i(e)})),[].filter.call(this.self.e.options,o).map(function(e){return!e.hidden&&s.get(e)})},finder:function(e,t){return void 0===this._finderLoop&&(this._finderLoop=this.find(e,t)),void 0!==(e=this._finderLoop.shift())?e:(delete this._finderLoop,!1)},walker:function(e,t){if(void 0!==this._inLoop&&this._inLoop){if(0<this._inItems.length){do{var n=this.items[this._inGroup][this._inItems.shift()]}while(!0===n.hidden);return n}if(0<this._inGroups.length){for(;0<this._inGroups.length;){var r=this._inGroups.shift();if(!(r in this.items))return!1;var i=Object.keys(this.items[r]);if(0<i.length)break}return"ASC"==e?i.sort():"DESC"==e?i.sort().reverse():"function"==typeof e&&(i=e.call(this,i)),this._inItems=i,this._inGroup=r,this.walker(null,null)}return delete this._inLoop,delete this._inItems,delete this._inGroup,delete this._inGroups,!1}var o=Object.keys(this.groups)||[];return"ASC"==t?o.sort():"DESC"==t?o.sort().reverse():"function"==typeof t&&(o=t.call(this,o)),o.unshift("#"),this._inLoop=!0,this._inItems=[],this._inGroups=o,this.walker(e,null)}},d}),!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.VMasker=t()}(this,function(){function c(e){return(e={delimiter:(e=e||{}).delimiter||".",lastOutput:e.lastOutput,precision:e.hasOwnProperty("precision")?e.precision:2,separator:e.separator||",",showSignal:e.showSignal,suffixUnit:e.suffixUnit&&" "+e.suffixUnit.replace(/[\s]/g,"")||"",unit:e.unit&&e.unit.replace(/[\s]/g,"")+" "||"",zeroCents:e.zeroCents}).moneyPrecision=e.zeroCents?0:e.precision,e}function d(e,t,n){for(;t<e.length;t++)"9"!==e[t]&&"A"!==e[t]&&"S"!==e[t]||(e[t]=n);return e}function t(e){this.elements=e}var o=[9,16,17,18,36,37,38,39,40,91,92,93],s=(t.prototype.unbindElementToMask=function(){for(var e=0,t=this.elements.length;e<t;e++)this.elements[e].lastOutput="",this.elements[e].onkeyup=!1,this.elements[e].onkeydown=!1,this.elements[e].value.length&&(this.elements[e].value=this.elements[e].value.replace(/\D/g,""))},t.prototype.bindElementToMask=function(n){function e(e){var t=(e=e||window.event).target||e.srcElement;!function(e){for(var t=0,n=o.length;t<n;t++)if(e==o[t])return!1;return!0}(e.keyCode)||setTimeout(function(){r.opts.lastOutput=t.lastOutput,t.value=s[n](t.value,r.opts),t.lastOutput=t.value,t.setSelectionRange&&r.opts.suffixUnit&&t.setSelectionRange(t.value.length,t.value.length-r.opts.suffixUnit.length)},0)}for(var r=this,t=0,i=this.elements.length;t<i;t++)this.elements[t].lastOutput="",this.elements[t].onkeyup=e,this.elements[t].value.length&&(this.elements[t].value=s[n](this.elements[t].value,this.opts))},t.prototype.maskMoney=function(e){this.opts=c(e),this.bindElementToMask("toMoney")},t.prototype.maskNumber=function(){this.opts={},this.bindElementToMask("toNumber")},t.prototype.maskAlphaNum=function(){this.opts={},this.bindElementToMask("toAlphaNumeric")},t.prototype.maskPattern=function(e){this.opts={pattern:e},this.bindElementToMask("toPattern")},t.prototype.unMask=function(){this.unbindElementToMask()},function(e){if(e)return e="length"in e?e.length?e:[]:[e],new t(e);throw new Error("VanillaMasker: There is no element to bind.")});return s.toMoney=function(e,t){for(var n=(e=(t=c(t)).zeroCents&&(t.lastOutput=t.lastOutput||"",n="("+t.separator+"[0]{0,"+t.precision+"})",n=new RegExp(n,"g"),r=e.toString().replace(/[\D]/g,"").length||0,i=t.lastOutput.toString().replace(/[\D]/g,"").length||0,e=e.toString().replace(n,""),r<i)?e.slice(0,e.length-1):e).toString(),r=n.indexOf(t.separator),i=t.precision-(n.length-r-1),r=(-1!==r&&0<i&&(n+="0"*i),n=n.replace(/[\D]/g,""),new RegExp("^(0|\\"+t.delimiter+")")),i=new RegExp("(\\"+t.separator+")$"),o=n.substr(0,n.length-t.moneyPrecision),s=o.substr(0,o.length%3),a=new Array(t.precision+1).join("0"),l=0,u=(o=o.substr(o.length%3,o.length)).length;l<u;l++)l%3==0&&(s+=t.delimiter),s+=o[l];s=(s=s.replace(r,"")).length?s:"0",r="";return!0===t.showSignal&&(r=e<0||e.startsWith&&e.startsWith("-")?"-":""),t.zeroCents||(e=Math.max(0,n.length-t.precision),e=(n=n.substr(e,t.precision)).length,e=t.precision>e?t.precision:e,a=(a+n).slice(-e)),(t.unit+r+s+t.separator+a).replace(i,"")+t.suffixUnit},s.toPattern=function(e,t){for(var n="object"==typeof t?t.pattern:t,r=n.replace(/\W/g,""),i=n.split(""),o=e.toString().replace(/\W/g,""),s=o.replace(/\W/g,""),a=0,l=i.length,u="object"==typeof t?t.placeholder:void 0,c=0;c<l;c++){if(a>=o.length){if(r.length==s.length)return i.join("");if(void 0!==u&&r.length>s.length)return d(i,c,u).join("");break}if("9"===i[c]&&o[a].match(/[0-9]/)||"A"===i[c]&&o[a].match(/[a-zA-Z]/)||"S"===i[c]&&o[a].match(/[0-9a-zA-Z]/))i[c]=o[a++];else{if("9"===i[c]||"A"===i[c]||"S"===i[c])return(void 0!==u?d(i,c,u):i.slice(0,c)).join("");i[c]===o[a]&&a++}}return i.join("").substr(0,c)},s.toNumber=function(e){return e.toString().replace(/(?!^-)[^0-9]/g,"")},s.toAlphaNumeric=function(e){return e.toString().replace(/[^a-z0-9 ]+/i,"")},s}),!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).CodeMirror=t()}(this,function(){"use strict";var e=navigator.userAgent,a=navigator.platform,V=/gecko\/\d/i.test(e),t=/MSIE \d/.test(e),l=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(e),u=/Edge\/(\d+)/.exec(e),y=t||l||u,v=y&&(t?document.documentMode||6:+(u||l)[1]),E=!u&&/WebKit\//.test(e),t=E&&/Qt\/\d+\.\d+/.test(e),c=!u&&/Chrome\//.test(e),W=/Opera\//.test(e),$=/Apple Computer/.test(navigator.vendor),h=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(e),j=/PhantomJS/.test(e),z=!u&&/AppleWebKit/.test(e)&&/Mobile\/\w+/.test(e),G=/Android/.test(e),Y=z||G||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(e),C=z||/Mac/.test(a),X=/\bCrOS\b/.test(e),l=/win/i.test(a),u=W&&e.match(/Version\/(\d*\.\d*)/),K=((u=u&&Number(u[1]))&&15<=u&&(E=!(W=!1)),C&&(t||W&&(null==u||u<12.11))),q=V||y&&9<=v;function Z(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}var Q=function(e,t){var n,r=e.className,t=Z(t).exec(r);t&&(n=r.slice(t.index+t[0].length),e.className=r.slice(0,t.index)+(n?t[1]+n:""))};function J(e){for(var t=e.childNodes.length;0<t;--t)e.removeChild(e.firstChild);return e}function b(e,t){return J(e).appendChild(t)}function _(e,t,n,r){var i=document.createElement(e);if(n&&(i.className=n),r&&(i.style.cssText=r),"string"==typeof t)i.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)i.appendChild(t[o]);return i}function ee(e,t,n,r){e=_(e,t,n,r);return e.setAttribute("role","presentation"),e}function te(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do{if((t=11==t.nodeType?t.host:t)==e)return!0}while(t=t.parentNode)}function ne(){var t;try{t=document.activeElement}catch(e){t=document.body||null}for(;t&&t.shadowRoot&&t.shadowRoot.activeElement;)t=t.shadowRoot.activeElement;return t}function re(e,t){var n=e.className;Z(t).test(n)||(e.className+=(n?" ":"")+t)}function ie(e,t){for(var n=e.split(" "),r=0;r<n.length;r++)n[r]&&!Z(n[r]).test(t)&&(t+=" "+n[r]);return t}var oe=document.createRange?function(e,t,n,r){var i=document.createRange();return i.setEnd(r||e,n),i.setStart(e,t),i}:function(e,t,n){var r=document.body.createTextRange();try{r.moveToElementText(e.parentNode)}catch(e){return r}return r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",t),r},se=function(e){e.select()};function ae(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function le(e,t,n){for(var r in t=t||{},e)!e.hasOwnProperty(r)||!1===n&&t.hasOwnProperty(r)||(t[r]=e[r]);return t}function ue(e,t,n,r,i){null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length);for(var o=r||0,s=i||0;;){var a=e.indexOf("\t",o);if(a<0||t<=a)return s+(t-o);s=(s+=a-o)+(n-s%n),o=a+1}}z?se=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:y&&(se=function(e){try{e.select()}catch(e){}});function ce(){this.id=null,this.f=null,this.time=0,this.handler=ae(this.onTimeout,this)}function w(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return n;return-1}ce.prototype.onTimeout=function(e){e.id=0,e.time<=+new Date?e.f():setTimeout(e.handler,e.time-+new Date)};var de=30,he={toString:function(){return"CodeMirror.Pass"}},fe={scroll:!(ce.prototype.set=function(e,t){this.f=t;t=+new Date+e;(!this.id||t<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,e),this.time=t)})},pe={origin:"*mouse"},ge={origin:"+move"};function me(e,t,n){for(var r=0,i=0;;){var o=e.indexOf("\t",r),s=(o=-1==o?e.length:o)-r;if(o==e.length||t<=i+s)return r+Math.min(s,t-i);if(i+=o-r,r=o+1,t<=(i+=n-i%n))return r}}var ye=[""];function ve(e){for(;ye.length<=e;)ye.push(F(ye)+" ");return ye[e]}function F(e){return e[e.length-1]}function be(e,t){for(var n=[],r=0;r<e.length;r++)n[r]=t(e[r],r);return n}function Ee(){}function Ce(e,t){e=Object.create?Object.create(e):(Ee.prototype=e,new Ee);return t&&le(t,e),e}var we=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function Se(e){return/\w/.test(e)||""<e&&(e.toUpperCase()!=e.toLowerCase()||we.test(e))}function Te(e,t){return t?!!(-1<t.source.indexOf("\\w")&&Se(e))||t.test(e):Se(e)}function Re(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return;return 1}var Ae=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function _e(e){return 768<=e.charCodeAt(0)&&Ae.test(e)}function Ne(e,t,n){for(;(n<0?0<t:t<e.length)&&_e(e.charAt(t));)t+=n;return t}function xe(e,t,n){for(var r=n<t?-1:1;;){if(t==n)return t;var i=(t+n)/2,i=r<0?Math.ceil(i):Math.floor(i);if(i==t)return e(i)?t:n;e(i)?n=i:t=i+r}}var Oe=null;function Ie(e,t,n){var r;Oe=null;for(var i=0;i<e.length;++i){var o=e[i];if(o.from<t&&o.to>t)return i;o.to==t&&(o.from!=o.to&&"before"==n?r=i:Oe=i),o.from==t&&(o.from!=o.to&&"before"!=n?r=i:Oe=i)}return null!=r?r:Oe}Me=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,ke=/[stwN]/,De=/[LRr]/,Le=/[Lb1n]/,Pe=/[1n]/;var Me,ke,De,Le,Pe,Fe=function(e,t){var n="ltr"==t?"L":"R";if(0==e.length||"ltr"==t&&!Me.test(e))return!1;for(var r,i=e.length,o=[],s=0;s<i;++s)o.push((r=e.charCodeAt(s))<=247?"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN".charAt(r):1424<=r&&r<=1524?"R":1536<=r&&r<=1785?"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111".charAt(r-1536):1774<=r&&r<=2220?"r":8192<=r&&r<=8203?"w":8204==r?"b":"L");for(var a=0,l=n;a<i;++a){var u=o[a];"m"==u?o[a]=l:l=u}for(var c=0,d=n;c<i;++c){var h=o[c];"1"==h&&"r"==d?o[c]="n":De.test(h)&&"r"==(d=h)&&(o[c]="R")}for(var f=1,p=o[0];f<i-1;++f){var g=o[f];"+"==g&&"1"==p&&"1"==o[f+1]?o[f]="1":","!=g||p!=o[f+1]||"1"!=p&&"n"!=p||(o[f]=p),p=g}for(var m=0;m<i;++m){var y=o[m];if(","==y)o[m]="N";else if("%"==y){for(var v=void 0,v=m+1;v<i&&"%"==o[v];++v);for(var b=m&&"!"==o[m-1]||v<i&&"1"==o[v]?"1":"N",E=m;E<v;++E)o[E]=b;m=v-1}}for(var C=0,w=n;C<i;++C){var S=o[C];"L"==w&&"1"==S?o[C]="L":De.test(S)&&(w=S)}for(var T=0;T<i;++T)if(ke.test(o[T])){for(var R=void 0,R=T+1;R<i&&ke.test(o[R]);++R);for(var A="L"==(T?o[T-1]:n),_=A==("L"==(R<i?o[R]:n))?A?"L":"R":n,N=T;N<R;++N)o[N]=_;T=R-1}for(var x,O=[],I=0;I<i;)if(Le.test(o[I])){var M=I;for(++I;I<i&&Le.test(o[I]);++I);O.push(new Be(0,M,I))}else{var k=I,D=O.length;for(++I;I<i&&"L"!=o[I];++I);for(var L=k;L<I;)if(Pe.test(o[L])){k<L&&O.splice(D,0,new Be(1,k,L));var P=L;for(++L;L<I&&Pe.test(o[L]);++L);O.splice(D,0,new Be(2,P,L)),k=L}else++L;k<I&&O.splice(D,0,new Be(1,k,I))}return"ltr"==t&&(1==O[0].level&&(x=e.match(/^\s+/))&&(O[0].from=x[0].length,O.unshift(new Be(0,0,x[0].length))),1==F(O).level)&&(x=e.match(/\s+$/))&&(F(O).to-=x[0].length,O.push(new Be(0,i-x[0].length,i))),"rtl"==t?O.reverse():O};function Be(e,t,n){this.level=e,this.from=t,this.to=n}function He(e,t){var n=e.order;return n=null==n?e.order=Fe(e.text,t):n}var Ue=[],S=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):(e=e._handlers||(e._handlers={}))[t]=(e[t]||Ue).concat(n)};function Ve(e,t){return e._handlers&&e._handlers[t]||Ue}function T(e,t,n){var r;e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):(r=(e=e._handlers)&&e[t])&&-1<(n=w(r,n))&&(e[t]=r.slice(0,n).concat(r.slice(n+1)))}function N(e,t){var n=Ve(e,t);if(n.length)for(var r=Array.prototype.slice.call(arguments,2),i=0;i<n.length;++i)n[i].apply(null,r)}function x(e,t,n){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),N(e,n||t.type,e,t),Ge(t)||t.codemirrorIgnore}function We(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var n=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),r=0;r<t.length;++r)-1==w(n,t[r])&&n.push(t[r])}function $e(e,t){return 0<Ve(e,t).length}function je(e){e.prototype.on=function(e,t){S(this,e,t)},e.prototype.off=function(e,t){T(this,e,t)}}function R(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function ze(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function Ge(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function Ye(e){R(e),ze(e)}function Xe(e){return e.target||e.srcElement}function Ke(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),t=C&&e.ctrlKey&&1==t?3:t}var qe,Ze,Qe=!(y&&v<9)&&("draggable"in(a=_("div"))||"dragDrop"in a);var Je=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],r=e.length;t<=r;){var i=e.indexOf("\n",t),o=(-1==i&&(i=e.length),e.slice(t,"\r"==e.charAt(i-1)?i-1:i)),s=o.indexOf("\r");-1!=s?(n.push(o.slice(0,s)),t+=s+1):(n.push(o),t=i+1)}return n}:function(e){return e.split(/\r\n?|\n/)},et=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(e){return!1}}:function(e){var t;try{t=e.ownerDocument.selection.createRange()}catch(e){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},tt="oncopy"in(e=_("div"))||(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy),nt=null;var rt={},it={};function ot(e){if("string"==typeof e&&it.hasOwnProperty(e))e=it[e];else if(e&&"string"==typeof e.name&&it.hasOwnProperty(e.name)){var t=it[e.name];(e=Ce(t="string"==typeof t?{name:t}:t,e)).name=t.name}else{if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return ot("application/xml");if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return ot("application/json")}return"string"==typeof e?{name:e}:e||{name:"null"}}function st(e,t){t=ot(t);var n=rt[t.name];if(!n)return st(e,"text/plain");var r=n(e,t);if(at.hasOwnProperty(t.name)){var i,o=at[t.name];for(i in o)o.hasOwnProperty(i)&&(r.hasOwnProperty(i)&&(r["_"+i]=r[i]),r[i]=o[i])}if(r.name=t.name,t.helperType&&(r.helperType=t.helperType),t.modeProps)for(var s in t.modeProps)r[s]=t.modeProps[s];return r}var at={};function lt(e,t){le(t,at.hasOwnProperty(e)?at[e]:at[e]={})}function ut(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);var n,r={};for(n in t){var i=t[n];i instanceof Array&&(i=i.concat([])),r[n]=i}return r}function ct(e,t){for(var n;e.innerMode&&(n=e.innerMode(t))&&n.mode!=e;)t=n.state,e=n.mode;return n||{mode:e,state:t}}function dt(e,t,n){return!e.startState||e.startState(t,n)}var g=function(e,t,n){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=n};function O(e,t){if((t-=e.first)<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var n=e;!n.lines;)for(var r=0;;++r){var i=n.children[r],o=i.chunkSize();if(t<o){n=i;break}t-=o}return n.lines[t]}function ht(e,t,n){var r=[],i=t.line;return e.iter(t.line,n.line+1,function(e){e=e.text;i==n.line&&(e=e.slice(0,n.ch)),i==t.line&&(e=e.slice(t.ch)),r.push(e),++i}),r}function ft(e,t,n){var r=[];return e.iter(t,n,function(e){r.push(e.text)}),r}function pt(e,t){var n=t-e.height;if(n)for(var r=e;r;r=r.parent)r.height+=n}function A(e){if(null==e.parent)return null;for(var t=e.parent,n=w(t.lines,e),r=t.parent;r;r=(t=r).parent)for(var i=0;r.children[i]!=t;++i)n+=r.children[i].chunkSize();return n+t.first}function gt(e,t){var n=e.first;e:do{for(var r=0;r<e.children.length;++r){var i=e.children[r],o=i.height;if(t<o){e=i;continue e}t-=o,n+=i.chunkSize()}return n}while(!e.lines);for(var s=0;s<e.lines.length;++s){var a=e.lines[s].height;if(t<a)break;t-=a}return n+s}function mt(e,t){return t>=e.first&&t<e.first+e.size}function yt(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function I(e,t,n){if(void 0===n&&(n=null),!(this instanceof I))return new I(e,t,n);this.line=e,this.ch=t,this.sticky=n}function M(e,t){return e.line-t.line||e.ch-t.ch}function vt(e,t){return e.sticky==t.sticky&&0==M(e,t)}function bt(e){return I(e.line,e.ch)}function Et(e,t){return M(e,t)<0?t:e}function Ct(e,t){return M(e,t)<0?e:t}function wt(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function k(e,t){var n;return t.line<e.first?I(e.first,0):(n=e.first+e.size-1,t.line>n?I(n,O(e,n).text.length):(e=O(e,(n=t).line).text.length,null==(t=n.ch)||e<t?I(n.line,e):t<0?I(n.line,0):n))}function St(e,t){for(var n=[],r=0;r<t.length;r++)n[r]=k(e,t[r]);return n}g.prototype.eol=function(){return this.pos>=this.string.length},g.prototype.sol=function(){return this.pos==this.lineStart},g.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},g.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},g.prototype.eat=function(e){var t=this.string.charAt(this.pos),e="string"==typeof e?t==e:t&&(e.test?e.test(t):e(t));if(e)return++this.pos,t},g.prototype.eatWhile=function(e){for(var t=this.pos;this.eat(e););return this.pos>t},g.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},g.prototype.skipToEnd=function(){this.pos=this.string.length},g.prototype.skipTo=function(e){e=this.string.indexOf(e,this.pos);if(-1<e)return this.pos=e,!0},g.prototype.backUp=function(e){this.pos-=e},g.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=ue(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?ue(this.string,this.lineStart,this.tabSize):0)},g.prototype.indentation=function(){return ue(this.string,null,this.tabSize)-(this.lineStart?ue(this.string,this.lineStart,this.tabSize):0)},g.prototype.match=function(e,t,n){var r;return"string"!=typeof e?(r=this.string.slice(this.pos).match(e))&&0<r.index?null:(r&&!1!==t&&(this.pos+=r[0].length),r):(r=function(e){return n?e.toLowerCase():e})(this.string.substr(this.pos,e.length))==r(e)?(!1!==t&&(this.pos+=e.length),!0):void 0},g.prototype.current=function(){return this.string.slice(this.start,this.pos)},g.prototype.hideFirstChars=function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}},g.prototype.lookAhead=function(e){var t=this.lineOracle;return t&&t.lookAhead(e)},g.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)};function Tt(e,t){this.state=e,this.lookAhead=t}var Rt=function(e,t,n,r){this.state=t,this.doc=e,this.line=n,this.maxLookAhead=r||0,this.baseTokens=null,this.baseTokenPos=1};function At(t,n,r,e){for(var l=[t.state.modeGen],i={},u=(Lt(t,n.text,t.doc.mode,r,function(e,t){l.push(e,t)},i,e),r.state),o=0;o<t.state.overlays.length;++o)!function(e){r.baseTokens=l;var o=t.state.overlays[e],s=1,a=0;r.state=!0,Lt(t,n.text,o.mode,r,function(e,t){for(var n=s;a<e;){var r=l[s];e<r&&l.splice(s,1,e,l[s+1],r),s+=2,a=Math.min(e,r)}if(t)if(o.opaque)l.splice(n,s-n,e,"overlay "+t),s=n+2;else for(;n<s;n+=2){var i=l[n+1];l[n+1]=(i?i+" ":"")+"overlay "+t}},i),r.state=u,r.baseTokens=null,r.baseTokenPos=1}(o);return{styles:l,classes:i.bgClass||i.textClass?i:null}}function _t(e,t,n){var r,i,o;return t.styles&&t.styles[0]==e.state.modeGen||(r=Nt(e,A(t)),i=t.text.length>e.options.maxHighlightLength&&ut(e.doc.mode,r.state),o=At(e,t,r),i&&(r.state=i),t.stateAfter=r.save(!i),t.styles=o.styles,o.classes?t.styleClasses=o.classes:t.styleClasses&&(t.styleClasses=null),n===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))),t.styles}function Nt(n,r,e){var t,i,o,s=n.doc,a=n.display;return s.mode.startState?(i=(t=function(e,t,n){for(var r,i,o=e.doc,s=n?-1:t-(e.doc.mode.innerMode?1e3:100),a=t;s<a;--a){if(a<=o.first)return o.first;var l=O(o,a-1),u=l.stateAfter;if(u&&(!n||a+(u instanceof Tt?u.lookAhead:0)<=o.modeFrontier))return a;u=ue(l.text,null,e.options.tabSize);(null==i||u<r)&&(i=a-1,r=u)}return i}(n,r,e))>s.first&&O(s,t-1).stateAfter,o=i?Rt.fromSaved(s,i,t):new Rt(s,dt(s.mode),t),s.iter(t,r,function(e){xt(n,e.text,o);var t=o.line;e.stateAfter=t==r-1||t%5==0||t>=a.viewFrom&&t<a.viewTo?o.save():null,o.nextLine()}),e&&(s.modeFrontier=o.line),o):new Rt(s,!0,r)}function xt(e,t,n,r){var i=e.doc.mode,o=new g(t,e.options.tabSize,n);for(o.start=o.pos=r||0,""==t&&Ot(i,n.state);!o.eol();)It(i,o,n.state),o.start=o.pos}function Ot(e,t){return e.blankLine?e.blankLine(t):e.innerMode&&(e=ct(e,t)).mode.blankLine?e.mode.blankLine(e.state):void 0}function It(e,t,n,r){for(var i=0;i<10;i++){r&&(r[0]=ct(e,n).mode);var o=e.token(t,n);if(t.pos>t.start)return o}throw new Error("Mode "+e.name+" failed to advance stream.")}Rt.prototype.lookAhead=function(e){var t=this.doc.getLine(this.line+e);return null!=t&&e>this.maxLookAhead&&(this.maxLookAhead=e),t},Rt.prototype.baseToken=function(e){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;var t=this.baseTokens[this.baseTokenPos+1];return{type:t&&t.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},Rt.prototype.nextLine=function(){this.line++,0<this.maxLookAhead&&this.maxLookAhead--},Rt.fromSaved=function(e,t,n){return t instanceof Tt?new Rt(e,ut(e.mode,t.state),n,t.lookAhead):new Rt(e,ut(e.mode,t),n)},Rt.prototype.save=function(e){e=!1!==e?ut(this.doc.mode,this.state):this.state;return 0<this.maxLookAhead?new Tt(e,this.maxLookAhead):e};var Mt=function(e,t,n){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=t||null,this.state=n};function kt(e,t,n,r){var i,o,s=e.doc,a=s.mode,l=O(s,(t=k(s,t)).line),u=Nt(e,t.line,n),c=new g(l.text,e.options.tabSize,u);for(r&&(o=[]);(r||c.pos<t.ch)&&!c.eol();)c.start=c.pos,i=It(a,c,u.state),r&&o.push(new Mt(c,i,ut(s.mode,u.state)));return r?o:new Mt(c,i,u.state)}function Dt(e,t){if(e)for(;;){var n=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;e=e.slice(0,n.index)+e.slice(n.index+n[0].length);var r=n[1]?"bgClass":"textClass";null==t[r]?t[r]=n[2]:new RegExp("(?:^|s)"+n[2]+"(?:$|s)").test(t[r])||(t[r]+=" "+n[2])}return e}function Lt(e,t,n,r,i,o,s){var a=n.flattenSpans,l=(null==a&&(a=e.options.flattenSpans),0),u=null,c=new g(t,e.options.tabSize,r),d=e.options.addModeClass&&[null];for(""==t&&Dt(Ot(n,r.state),o);!c.eol();){var h,f=c.pos>e.options.maxHighlightLength?(a=!1,s&&xt(e,t,r,c.pos),c.pos=t.length,null):Dt(It(n,c,r.state,d),o);if(d&&(h=d[0].name)&&(f="m-"+(f?h+" "+f:h)),!a||u!=f){for(;l<c.start;)i(l=Math.min(c.start,l+5e3),u);u=f}c.start=c.pos}for(;l<c.pos;){var p=Math.min(c.pos,l+5e3);i(p,u),l=p}}var Pt=!1,Ft=!1;function Bt(e,t,n){this.marker=e,this.from=t,this.to=n}function Ht(e,t){if(e)for(var n=0;n<e.length;++n){var r=e[n];if(r.marker==t)return r}}function Ut(e,t){if(t.full)return null;var n=mt(e,t.from.line)&&O(e,t.from.line).markedSpans,e=mt(e,t.to.line)&&O(e,t.to.line).markedSpans;if(!n&&!e)return null;var r=t.from.ch,i=t.to.ch,o=0==M(t.from,t.to),s=function(e,t,n){var r;if(e)for(var i=0;i<e.length;++i){var o,s=e[i],a=s.marker;!(null==s.from||(a.inclusiveLeft?s.from<=t:s.from<t))&&(s.from!=t||"bookmark"!=a.type||n&&s.marker.insertLeft)||(o=null==s.to||(a.inclusiveRight?s.to>=t:s.to>t),(r=r||[]).push(new Bt(a,s.from,o?null:s.to)))}return r}(n,r,o),a=function(e,t,n){var r;if(e)for(var i=0;i<e.length;++i){var o,s=e[i],a=s.marker;!(null==s.to||(a.inclusiveRight?s.to>=t:s.to>t))&&(s.from!=t||"bookmark"!=a.type||n&&!s.marker.insertLeft)||(o=null==s.from||(a.inclusiveLeft?s.from<=t:s.from<t),(r=r||[]).push(new Bt(a,o?null:s.from-t,null==s.to?null:s.to-t)))}return r}(e,i,o),l=1==t.text.length,u=F(t.text).length+(l?r:0);if(s)for(var c=0;c<s.length;++c){var d,h=s[c];null==h.to&&((d=Ht(a,h.marker))?l&&(h.to=null==d.to?null:d.to+u):h.to=r)}if(a)for(var f=0;f<a.length;++f){var p=a[f];null!=p.to&&(p.to+=u),null==p.from?Ht(s,p.marker)||(p.from=u,l&&(s=s||[]).push(p)):(p.from+=u,l&&(s=s||[]).push(p))}s=s&&Vt(s),a&&a!=s&&(a=Vt(a));var g=[s];if(!l){var m,y=t.text.length-2;if(0<y&&s)for(var v=0;v<s.length;++v)null==s[v].to&&(m=m||[]).push(new Bt(s[v].marker,null,null));for(var b=0;b<y;++b)g.push(m);g.push(a)}return g}function Vt(e){for(var t=0;t<e.length;++t){var n=e[t];null!=n.from&&n.from==n.to&&!1!==n.marker.clearWhenEmpty&&e.splice(t--,1)}return e.length?e:null}function Wt(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function $t(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function jt(e){return e.inclusiveLeft?-1:0}function zt(e){return e.inclusiveRight?1:0}function Gt(e,t){var n,r,i=e.lines.length-t.lines.length;return 0!=i?i:(i=e.find(),n=t.find(),(r=M(i.from,n.from)||jt(e)-jt(t))?-r:M(i.to,n.to)||zt(e)-zt(t)||t.id-e.id)}function Yt(e,t){var n,r=Ft&&e.markedSpans;if(r)for(var i,o=0;o<r.length;++o)(i=r[o]).marker.collapsed&&null==(t?i.from:i.to)&&(!n||Gt(n,i.marker)<0)&&(n=i.marker);return n}function Xt(e){return Yt(e,!0)}function Kt(e){return Yt(e,!1)}function qt(e,t,n,r,i){var e=O(e,t),o=Ft&&e.markedSpans;if(o)for(var s=0;s<o.length;++s){var a=o[s];if(a.marker.collapsed){var l=a.marker.find(0),u=M(l.from,n)||jt(a.marker)-jt(i),c=M(l.to,r)||zt(a.marker)-zt(i);if(!(0<=u&&c<=0||u<=0&&0<=c)&&(u<=0&&(a.marker.inclusiveRight&&i.inclusiveLeft?0<=M(l.to,n):0<M(l.to,n))||0<=u&&(a.marker.inclusiveRight&&i.inclusiveLeft?M(l.from,r)<=0:M(l.from,r)<0)))return 1}}}function Zt(e){for(var t;t=Xt(e);)e=t.find(-1,!0).line;return e}function Qt(e,t){var e=O(e,t),n=Zt(e);return e==n?t:A(n)}function Jt(e,t){if(t>e.lastLine())return t;var n,r=O(e,t);if(!en(e,r))return t;for(;n=Kt(r);)r=n.find(1,!0).line;return A(r)+1}function en(e,t){var n=Ft&&t.markedSpans;if(n)for(var r,i=0;i<n.length;++i)if((r=n[i]).marker.collapsed){if(null==r.from)return!0;if(!r.marker.widgetNode&&0==r.from&&r.marker.inclusiveLeft&&function e(t,n,r){{var i;if(null==r.to)return i=r.marker.find(1,!0),e(t,i.line,Ht(i.line.markedSpans,r.marker))}if(r.marker.inclusiveRight&&r.to==n.text.length)return!0;for(var o=void 0,s=0;s<n.markedSpans.length;++s)if((o=n.markedSpans[s]).marker.collapsed&&!o.marker.widgetNode&&o.from==r.to&&(null==o.to||o.to!=r.from)&&(o.marker.inclusiveLeft||r.marker.inclusiveRight)&&e(t,n,o))return!0}(e,t,r))return!0}}function tn(e){for(var t=0,n=(e=Zt(e)).parent,r=0;r<n.lines.length;++r){var i=n.lines[r];if(i==e)break;t+=i.height}for(var o=n.parent;o;o=(n=o).parent)for(var s=0;s<o.children.length;++s){var a=o.children[s];if(a==n)break;t+=a.height}return t}function nn(e){if(0==e.height)return 0;for(var t,n=e.text.length,r=e;t=Xt(r);){var i=t.find(0,!0),r=i.from.line;n+=i.from.ch-i.to.ch}for(r=e;t=Kt(r);)var o=t.find(0,!0),n=(n-=r.text.length-o.from.ch)+((r=o.to.line).text.length-o.to.ch);return n}function rn(e){var n=e.display,e=e.doc;n.maxLine=O(e,e.first),n.maxLineLength=nn(n.maxLine),n.maxLineChanged=!0,e.iter(function(e){var t=nn(e);t>n.maxLineLength&&(n.maxLineLength=t,n.maxLine=e)})}var on=function(e,t,n){this.text=e,$t(this,t),this.height=n?n(this):1};on.prototype.lineNo=function(){return A(this)},je(on);var sn={},an={};function ln(e,t){return!e||/^\s*$/.test(e)?null:(t=t.addModeClass?an:sn)[e]||(t[e]=e.replace(/\S+/g,"cm-$&"))}function un(e,t){var n=ee("span",null,null,E?"padding-right: .1px":null),r={pre:ee("pre",[n],"CodeMirror-line"),content:n,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:e.getOption("lineWrapping")};t.measure={};for(var i,o,s=0;s<=(t.rest?t.rest.length:0);s++){var a=s?t.rest[s-1]:t.line,l=void 0,u=(r.pos=0,r.addToken=dn,u=e.display.measure,o=i=void 0,(null!=Ze?Ze:(o=b(u,document.createTextNode("AخA")),i=oe(o,0,1).getBoundingClientRect(),o=oe(o,1,2).getBoundingClientRect(),J(u),i&&i.left!=i.right&&(Ze=o.right-i.right<3)))&&(l=He(a,e.doc.direction))&&(r.addToken=function(d,h){return function(e,t,n,r,i,o,s){n=n?n+" cm-force-border":"cm-force-border";for(var a=e.pos,l=a+t.length;;){for(var u=void 0,c=0;c<h.length&&!((u=h[c]).to>a&&u.from<=a);c++);if(u.to>=l)return d(e,t,n,r,i,o,s);d(e,t.slice(0,u.to-a),n,r,null,o,s),r=null,t=t.slice(u.to-a),a=u.to}}}(r.addToken,l)),r.map=[],t!=e.display.externalMeasured&&A(a));!function(e,t,n){var r=e.markedSpans,i=e.text,o=0;if(r)for(var s,a,l,u,c,d,h,f=i.length,p=0,g=1,m="",y=0;;){if(y==p){l=u=c=a="",d=h=null,y=1/0;for(var v=[],b=void 0,E=0;E<r.length;++E){var C=r[E],w=C.marker;if("bookmark"==w.type&&C.from==p&&w.widgetNode)v.push(w);else if(C.from<=p&&(null==C.to||C.to>p||w.collapsed&&C.to==p&&C.from==p)){if(null!=C.to&&C.to!=p&&y>C.to&&(y=C.to,u=""),w.className&&(l+=" "+w.className),w.css&&(a=(a?a+";":"")+w.css),w.startStyle&&C.from==p&&(c+=" "+w.startStyle),w.endStyle&&C.to==y&&(b=b||[]).push(w.endStyle,C.to),w.title&&((h=h||{}).title=w.title),w.attributes)for(var S in w.attributes)(h=h||{})[S]=w.attributes[S];w.collapsed&&(!d||Gt(d.marker,w)<0)&&(d=C)}else C.from>p&&y>C.from&&(y=C.from)}if(b)for(var T=0;T<b.length;T+=2)b[T+1]==y&&(u+=" "+b[T]);if(!d||d.from==p)for(var R=0;R<v.length;++R)hn(t,0,v[R]);if(d&&(d.from||0)==p){if(hn(t,(null==d.to?f+1:d.to)-p,d.marker,null==d.from),null==d.to)return;d.to==p&&(d=!1)}}if(f<=p)break;for(var A=Math.min(f,y);;){if(m){var _,N=p+m.length;if(d||(_=A<N?m.slice(0,A-p):m,t.addToken(t,_,s?s+l:l,c,p+_.length==y?u:"",a,h)),A<=N){m=m.slice(A-p),p=A;break}p=N,c=""}m=i.slice(o,o=n[g++]),s=ln(n[g++],t.cm.options)}}else for(var x=1;x<n.length;x+=2)t.addToken(t,i.slice(o,o=n[x]),ln(n[x+1],t.cm.options))}(a,r,_t(e,a,u)),a.styleClasses&&(a.styleClasses.bgClass&&(r.bgClass=ie(a.styleClasses.bgClass,r.bgClass||"")),a.styleClasses.textClass)&&(r.textClass=ie(a.styleClasses.textClass,r.textClass||"")),0==r.map.length&&r.map.push(0,0,r.content.appendChild((o=e.display.measure,i=void 0,(o=(qe=null==qe&&(i=_("span","​"),b(o,_("span",[i,document.createTextNode("x")])),0!=o.firstChild.offsetHeight)?i.offsetWidth<=1&&2<i.offsetHeight&&!(y&&v<8):qe)?_("span","​"):_("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px")).setAttribute("cm-text",""),o))),0==s?(t.measure.map=r.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(r.map),(t.measure.caches||(t.measure.caches=[])).push({}))}return E&&(n=r.content.lastChild,/\bcm-tab\b/.test(n.className)||n.querySelector&&n.querySelector(".cm-tab"))&&(r.content.className="cm-tab-wrap-hack"),N(e,"renderLine",e,t.line,r.pre),r.pre.className&&(r.textClass=ie(r.pre.className,r.textClass||"")),r}function cn(e){var t=_("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function dn(e,t,n,r,i,o,s){if(t){var a=e.splitSpaces?function(e,t){if(1<e.length&&!/  /.test(e))return e;for(var n=t,r="",i=0;i<e.length;i++){var o=e.charAt(i);" "!=o||!n||i!=e.length-1&&32!=e.charCodeAt(i+1)||(o=" "),r+=o,n=" "==o}return r}(t,e.trailingSpace):t,l=e.cm.state.specialChars,u=!1;if(l.test(t))for(var c=document.createDocumentFragment(),d=0;;){l.lastIndex=d;var h=l.exec(t),f=h?h.index-d:t.length-d;if(f&&(p=document.createTextNode(a.slice(d,d+f)),y&&v<9?c.appendChild(_("span",[p])):c.appendChild(p),e.map.push(e.pos,e.pos+f,p),e.col+=f,e.pos+=f),!h)break;d+=1+f;var p=void 0;"\t"==h[0]?(f=(f=e.cm.options.tabSize)-e.col%f,(p=c.appendChild(_("span",ve(f),"cm-tab"))).setAttribute("role","presentation"),p.setAttribute("cm-text","\t"),e.col+=f):("\r"==h[0]||"\n"==h[0]?(p=c.appendChild(_("span","\r"==h[0]?"␍":"␤","cm-invalidchar"))).setAttribute("cm-text",h[0]):((p=e.cm.options.specialCharPlaceholder(h[0])).setAttribute("cm-text",h[0]),y&&v<9?c.appendChild(_("span",[p])):c.appendChild(p)),e.col+=1),e.map.push(e.pos,e.pos+1,p),e.pos++}else e.col+=t.length,c=document.createTextNode(a),e.map.push(e.pos,e.pos+t.length,c),y&&v<9&&(u=!0),e.pos+=t.length;if(e.trailingSpace=32==a.charCodeAt(t.length-1),n||r||i||u||o){var u=n||"",g=(r&&(u+=r),i&&(u+=i),_("span",[c],u,o));if(s)for(var m in s)s.hasOwnProperty(m)&&"style"!=m&&"class"!=m&&g.setAttribute(m,s[m]);return e.content.appendChild(g)}e.content.appendChild(c)}}function hn(e,t,n,r){var i=!r&&n.widgetNode;i&&e.map.push(e.pos,e.pos+t,i),!r&&e.cm.display.input.needsContentAttribute&&(i=i||e.content.appendChild(document.createElement("span"))).setAttribute("cm-marker",n.id),i&&(e.cm.display.input.setUneditable(i),e.content.appendChild(i)),e.pos+=t,e.trailingSpace=!1}function fn(e,t,n){this.line=t,this.rest=function(e){for(var t,n;t=Kt(e);)e=t.find(1,!0).line,(n=n||[]).push(e);return n}(t),this.size=this.rest?A(F(this.rest))-n+1:1,this.node=this.text=null,this.hidden=en(e,t)}function pn(e,t,n){for(var r=[],i=t;i<n;i=s){var o=new fn(e.doc,O(e.doc,i),i),s=i+o.size;r.push(o)}return r}var gn=null;var mn=null;function D(e,t){var n=Ve(e,t);if(n.length)for(var r,i=Array.prototype.slice.call(arguments,2),o=(gn?r=gn.delayedCallbacks:mn?r=mn:(r=mn=[],setTimeout(yn,0)),0);o<n.length;++o)!function(e){r.push(function(){return n[e].apply(null,i)})}(o)}function yn(){var e=mn;mn=null;for(var t=0;t<e.length;++t)e[t]()}function vn(e,t,n,r){for(var i=0;i<t.changes.length;i++){var o=t.changes[i];if("text"==o){u=l=a=s=void 0;var s=e,a=t,l=a.text.className,u=En(s,a);a.text==a.node&&(a.node=u.pre),a.text.parentNode.replaceChild(u.pre,a.text),a.text=u.pre,u.bgClass!=a.bgClass||u.textClass!=a.textClass?(a.bgClass=u.bgClass,a.textClass=u.textClass,Cn(s,a)):l&&(a.text.className=l)}else if("gutter"==o)wn(e,t,n,r);else if("class"==o)Cn(e,t);else if("widget"==o){f=h=d=s=c=u=void 0;var u=e,c=t,s=r;c.alignable&&(c.alignable=null);for(var d=Z("CodeMirror-linewidget"),h=c.node.firstChild,f=void 0;h;h=f)f=h.nextSibling,d.test(h.className)&&c.node.removeChild(h);Sn(u,c,s)}}t.changes=null}function bn(e){return e.node==e.text&&(e.node=_("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),y)&&v<8&&(e.node.style.zIndex=2),e.node}function En(e,t){var n=e.display.externalMeasured;return n&&n.line==t.line?(e.display.externalMeasured=null,t.measure=n.measure,n.built):un(e,t)}function Cn(e,t){e=e,(i=(n=t).bgClass?n.bgClass+" "+(n.line.bgClass||""):n.line.bgClass)&&(i+=" CodeMirror-linebackground"),n.background?i?n.background.className=i:(n.background.parentNode.removeChild(n.background),n.background=null):i&&(r=bn(n),n.background=r.insertBefore(_("div",null,i),r.firstChild),e.display.input.setUneditable(n.background)),t.line.wrapClass?bn(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var n,r,i=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=i||""}function wn(e,t,n,r){t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass&&(o=bn(t),t.gutterBackground=_("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px; width: "+r.gutterTotalWidth+"px"),e.display.input.setUneditable(t.gutterBackground),o.insertBefore(t.gutterBackground,t.text));var i=t.line.gutterMarkers;if(e.options.lineNumbers||i){var o=bn(t),s=t.gutter=_("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px");if(e.display.input.setUneditable(s),o.insertBefore(s,t.text),t.line.gutterClass&&(s.className+=" "+t.line.gutterClass),!e.options.lineNumbers||i&&i["CodeMirror-linenumbers"]||(t.lineNumber=s.appendChild(_("div",yt(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+r.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),i)for(var a=0;a<e.display.gutterSpecs.length;++a){var l=e.display.gutterSpecs[a].className,u=i.hasOwnProperty(l)&&i[l];u&&s.appendChild(_("div",[u],"CodeMirror-gutter-elt","left: "+r.gutterLeft[l]+"px; width: "+r.gutterWidth[l]+"px"))}}}function Sn(e,t,n){if(Tn(e,t.line,t,n,!0),t.rest)for(var r=0;r<t.rest.length;r++)Tn(e,t.rest[r],t,n,!1)}function Tn(e,t,n,r,i){if(t.widgets)for(var o=bn(n),s=0,a=t.widgets;s<a.length;++s){var l=a[s],u=_("div",[l.node],"CodeMirror-linewidget"+(l.className?" "+l.className:"")),c=(l.handleMouseEvents||u.setAttribute("cm-ignore-events","true"),f=h=d=c=void 0,l),d=u,h=n,f=r;c.noHScroll&&((h.alignable||(h.alignable=[])).push(d),h=f.wrapperWidth,d.style.left=f.fixedPos+"px",c.coverGutter||(h-=f.gutterTotalWidth,d.style.paddingLeft=f.gutterTotalWidth+"px"),d.style.width=h+"px"),c.coverGutter&&(d.style.zIndex=5,d.style.position="relative",c.noHScroll||(d.style.marginLeft=-f.gutterTotalWidth+"px")),e.display.input.setUneditable(u),i&&l.above?o.insertBefore(u,n.gutter||n.text):o.appendChild(u),D(l,"redraw")}}function Rn(e){var t,n;return null!=e.height?e.height:(t=e.doc.cm)?(te(document.body,e.node)||(n="position: relative;",e.coverGutter&&(n+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(n+="width: "+t.display.wrapper.clientWidth+"px;"),b(t.display.measure,_("div",[e.node],null,n))),e.height=e.node.parentNode.offsetHeight):0}function An(e,t){for(var n=Xe(t);n!=e.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==e.sizer&&n!=e.mover)return 1}function _n(e){return e.lineSpace.offsetTop}function Nn(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function xn(e){var t;return e.cachedPaddingH||(t=b(e.measure,_("pre","x","CodeMirror-line-like")),t=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,t={left:parseInt(t.paddingLeft),right:parseInt(t.paddingRight)},isNaN(t.left)||isNaN(t.right)||(e.cachedPaddingH=t),t)}function On(e){return de-e.display.nativeBarWidth}function In(e){return e.display.scroller.clientWidth-On(e)-e.display.barWidth}function Mn(e){return e.display.scroller.clientHeight-On(e)-e.display.barHeight}function kn(e,t,n){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var r=0;r<e.rest.length;r++)if(e.rest[r]==t)return{map:e.measure.maps[r],cache:e.measure.caches[r]};for(var i=0;i<e.rest.length;i++)if(A(e.rest[i])>n)return{map:e.measure.maps[i],cache:e.measure.caches[i],before:!0}}function Dn(e,t,n,r){return Fn(e,Pn(e,t),n,r)}function Ln(e,t){return t>=e.display.viewFrom&&t<e.display.viewTo?e.display.view[hr(e,t)]:(e=e.display.externalMeasured)&&t>=e.lineN&&t<e.lineN+e.size?e:void 0}function Pn(e,t){var n,r,i=A(t),o=Ln(e,i),e=(o&&!o.text?o=null:o&&o.changes&&(vn(e,o,i,ar(e)),e.curOp.forceUpdate=!0),o||(e=e,r=A(n=Zt(n=t)),(n=e.display.externalMeasured=new fn(e.doc,n,r)).lineN=r,r=n.built=un(e,n),n.text=r.pre,b(e.display.lineMeasure,r.pre),o=n),kn(o,t,i));return{line:t,view:o,rect:null,map:e.map,cache:e.cache,before:e.before,hasHeights:!1}}function Fn(e,t,n,r,i){var o,s=(n=t.before?-1:n)+(r||"");if(t.cache.hasOwnProperty(s))o=t.cache[s];else{if(t.rect||(t.rect=t.view.text.getBoundingClientRect()),!t.hasHeights){var a=e,l=t.view,u=t.rect,c=a.options.lineWrapping,a=c&&In(a);if(!l.measure.heights||c&&l.measure.width!=a){var d=l.measure.heights=[];if(c){l.measure.width=a;for(var h=l.text.firstChild.getClientRects(),f=0;f<h.length-1;f++){var p=h[f],g=h[f+1];2<Math.abs(p.bottom-g.bottom)&&d.push((p.bottom+g.top)/2-u.top)}}d.push(u.bottom-u.top)}t.hasHeights=!0}(o=function(e,t,n,r){var i,o=Un(t.map,n,r),s=o.node,a=o.start,l=o.end,u=o.collapse;if(3==s.nodeType){for(var c=0;c<4;c++){for(;a&&_e(t.line.text.charAt(o.coverStart+a));)--a;for(;o.coverStart+l<o.coverEnd&&_e(t.line.text.charAt(o.coverStart+l));)++l;if((i=y&&v<9&&0==a&&l==o.coverEnd-o.coverStart?s.parentNode.getBoundingClientRect():function(e,t){var n=Hn;if("left"==t)for(var r=0;r<e.length&&(n=e[r]).left==n.right;r++);else for(var i=e.length-1;0<=i&&(n=e[i]).left==n.right;i--);return n}(oe(s,a,l).getClientRects(),r)).left||i.right||0==a)break;l=a,a-=1,u="right"}y&&v<11&&(i=function(e,t){var n;return window.screen&&null!=screen.logicalXDPI&&screen.logicalXDPI!=screen.deviceXDPI&&function(e){var t;return null!=nt?nt:(t=(e=b(e,_("span","x"))).getBoundingClientRect(),e=oe(e,0,1).getBoundingClientRect(),nt=1<Math.abs(t.left-e.left))}(e)?(e=screen.logicalXDPI/screen.deviceXDPI,n=screen.logicalYDPI/screen.deviceYDPI,{left:t.left*e,right:t.right*e,top:t.top*n,bottom:t.bottom*n}):t}(e.display.measure,i))}else 0<a&&(u=r="right"),i=e.options.lineWrapping&&1<(n=s.getClientRects()).length?n["right"==r?n.length-1:0]:s.getBoundingClientRect();!(y&&v<9)||a||i&&(i.left||i.right)||(n=s.parentNode.getClientRects()[0],i=n?{left:n.left,right:n.left+sr(e.display),top:n.top,bottom:n.bottom}:Hn);for(var n=i.top-t.rect.top,d=i.bottom-t.rect.top,h=(n+d)/2,f=t.view.measure.heights,p=0;p<f.length-1&&!(h<f[p]);p++);var g=p?f[p-1]:0,m=f[p],g={left:("right"==u?i.right:i.left)-t.rect.left,right:("left"==u?i.left:i.right)-t.rect.left,top:g,bottom:m};i.left||i.right||(g.bogus=!0);e.options.singleCursorHeightPerLine||(g.rtop=n,g.rbottom=d);return g}(e,t,n,r)).bogus||(t.cache[s]=o)}return{left:o.left,right:o.right,top:i?o.rtop:o.top,bottom:i?o.rbottom:o.bottom}}var Bn,Hn={left:0,right:0,top:0,bottom:0};function Un(e,t,n){for(var r,i,o,s,a,l,u=0;u<e.length;u+=3)if(a=e[u],l=e[u+1],t<a?(i=0,o=1,s="left"):t<l?o=(i=t-a)+1:(u==e.length-3||t==l&&e[u+3]>t)&&(i=(o=l-a)-1,l<=t)&&(s="right"),null!=i){if(r=e[u+2],a==l&&n==(r.insertLeft?"left":"right")&&(s=n),"left"==n&&0==i)for(;u&&e[u-2]==e[u-3]&&e[u-1].insertLeft;)r=e[2+(u-=3)],s="left";if("right"==n&&i==l-a)for(;u<e.length-3&&e[u+3]==e[u+4]&&!e[u+5].insertLeft;)r=e[(u+=3)+2],s="right";break}return{node:r,start:i,end:o,collapse:s,coverStart:a,coverEnd:l}}function Vn(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function Wn(e){e.display.externalMeasure=null,J(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)Vn(e.display.view[t])}function $n(e){Wn(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function jn(){return c&&G?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function zn(){return c&&G?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function Gn(e){var t=0;if(e.widgets)for(var n=0;n<e.widgets.length;++n)e.widgets[n].above&&(t+=Rn(e.widgets[n]));return t}function Yn(e,t,n,r,i){return i||(i=Gn(t),n.top+=i,n.bottom+=i),"line"!=r&&(r=r||"local",i=tn(t),"local"==r?i+=_n(e.display):i-=e.display.viewOffset,"page"!=r&&"window"!=r||(i+=(t=e.display.lineSpace.getBoundingClientRect()).top+("window"==r?0:zn()),e=t.left+("window"==r?0:jn()),n.left+=e,n.right+=e),n.top+=i,n.bottom+=i),n}function Xn(e,t,n){var r;return"div"==n?t:(r=t.left,t=t.top,"page"==n?(r-=jn(),t-=zn()):"local"!=n&&n||(r+=(n=e.display.sizer.getBoundingClientRect()).left,t+=n.top),{left:r-(n=e.display.lineSpace.getBoundingClientRect()).left,top:t-n.top})}function Kn(e,t,n,r,i){return Yn(e,r=r||O(e.doc,t.line),Dn(e,r,t.ch,i),n)}function qn(n,e,r,i,o,s){function a(e,t){e=Fn(n,o,e,t?"right":"left",s);return t?e.left=e.right:e.right=e.left,Yn(n,i,e,r)}i=i||O(n.doc,e.line),o=o||Pn(n,i);var t,l,u=He(i,n.doc.direction),c=e.ch,e=e.sticky;return c>=i.text.length?(c=i.text.length,e="before"):c<=0&&(c=0,e="after"),u?(l=Ie(u,c,e),t=Oe,l=d(c,l,"before"==e),null!=t&&(l.other=d(c,t,"before"!=e)),l):a("before"==e?c-1:c,"before"==e);function d(e,t,n){return a(n?e-1:e,1==u[t].level!=n)}}function Zn(e,t){var n=0,t=(t=k(e.doc,t),e.options.lineWrapping||(n=sr(e.display)*t.ch),O(e.doc,t.line)),e=tn(t)+_n(e.display);return{left:n,right:n,top:e,bottom:e+t.height}}function Qn(e,t,n,r,i){e=I(e,t,n);return e.xRel=i,r&&(e.outside=r),e}function Jn(e,t,n){var r=e.doc;if((n+=e.display.viewOffset)<0)return Qn(r.first,0,null,-1,-1);var i=gt(r,n),o=r.first+r.size-1;if(o<i)return Qn(r.first+r.size-1,O(r,o).text.length,null,1,1);t<0&&(t=0);for(var s=O(r,i);;){var a=function(n,e,t,r,i){i-=tn(e);var o=Pn(n,e),s=Gn(e),a=0,l=e.text.length,u=!0,c=He(e,n.doc.direction);c&&(c=(n.options.lineWrapping?ir:rr)(n,e,t,o,c,r,i),u=1!=c.level,a=u?c.from:c.to-1,l=u?c.to:c.from-1);var d=null,h=null,c=xe(function(e){var t=Fn(n,o,e);return t.top+=s,t.bottom+=s,nr(t,r,i,!1)&&(t.top<=i&&t.left<=r&&(d=e,h=t),1)},a,l),f=!1;{var p,g;h?(p=r-h.left<h.right-r,c=d+((g=p==u)?0:1),g=g?"after":"before",p=p?h.left:h.right):(u||c!=l&&c!=a||c++,g=0==c||c!=e.text.length&&Fn(n,o,c-(u?1:0)).bottom+s<=i==u?"after":"before",l=qn(n,I(t,c,g),"line",e,o),p=l.left,f=i<l.top?-1:i>=l.bottom?1:0)}return c=Ne(e.text,c,1),Qn(t,c,g,f,r-p)}(e,s,i,t,n),l=function(e,t){var n,r=Ft&&e.markedSpans;if(r)for(var i=0;i<r.length;++i){var o=r[i];o.marker.collapsed&&(null==o.from||o.from<t)&&(null==o.to||o.to>t)&&(!n||Gt(n,o.marker)<0)&&(n=o.marker)}return n}(s,a.ch+(0<a.xRel||0<a.outside?1:0));if(!l)return a;a=l.find(1);if(a.line==i)return a;s=O(r,i=a.line)}}function er(t,e,n,r){r-=Gn(e);var e=e.text.length,i=xe(function(e){return Fn(t,n,e-1).bottom<=r},e,0);return{begin:i,end:xe(function(e){return Fn(t,n,e).top>r},i,e)}}function tr(e,t,n,r){return er(e,t,n=n||Pn(e,t),Yn(e,t,Fn(e,n,r),"line").top)}function nr(e,t,n,r){return!(e.bottom<=n)&&(e.top>n||(r?e.left:e.right)>t)}function rr(n,r,i,o,s,a,l){var e,t=xe(function(e){var e=s[e],t=1!=e.level;return nr(qn(n,I(i,t?e.to:e.from,t?"before":"after"),"line",r,o),a,l,!0)},0,s.length-1),u=s[t];return u=0<t&&(e=1!=u.level,nr(e=qn(n,I(i,e?u.from:u.to,e?"after":"before"),"line",r,o),a,l,!0))&&e.top>l?s[t-1]:u}function ir(e,t,n,r,i,o,s){for(var s=er(e,t,r,s),a=s.begin,l=s.end,u=(/\s/.test(t.text.charAt(l-1))&&l--,null),c=null,d=0;d<i.length;d++){var h,f=i[d];f.from>=l||f.to<=a||(h=(h=Fn(e,r,1!=f.level?Math.min(l,f.to)-1:Math.max(a,f.from)).right)<o?o-h+1e9:h-o,(!u||h<c)&&(u=f,c=h))}return u=(u=(u=u||i[i.length-1]).from<a?{from:a,to:u.to,level:u.level}:u).to>l?{from:u.from,to:l,level:u.level}:u}function or(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==Bn){Bn=_("pre",null,"CodeMirror-line-like");for(var t=0;t<49;++t)Bn.appendChild(document.createTextNode("x")),Bn.appendChild(_("br"));Bn.appendChild(document.createTextNode("x"))}b(e.measure,Bn);var n=Bn.offsetHeight/50;return 3<n&&(e.cachedTextHeight=n),J(e.measure),n||1}function sr(e){var t,n;return null!=e.cachedCharWidth?e.cachedCharWidth:(n=_("span","xxxxxxxxxx"),t=_("pre",[n],"CodeMirror-line-like"),b(e.measure,t),2<(n=((t=n.getBoundingClientRect()).right-t.left)/10)&&(e.cachedCharWidth=n),n||10)}function ar(e){for(var t=e.display,n={},r={},i=t.gutters.clientLeft,o=t.gutters.firstChild,s=0;o;o=o.nextSibling,++s){var a=e.display.gutterSpecs[s].className;n[a]=o.offsetLeft+o.clientLeft+i,r[a]=o.clientWidth}return{fixedPos:lr(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:r,wrapperWidth:t.wrapper.clientWidth}}function lr(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function ur(r){var i=or(r.display),o=r.options.lineWrapping,s=o&&Math.max(5,r.display.scroller.clientWidth/sr(r.display)-3);return function(e){if(en(r.doc,e))return 0;var t=0;if(e.widgets)for(var n=0;n<e.widgets.length;n++)e.widgets[n].height&&(t+=e.widgets[n].height);return o?t+(Math.ceil(e.text.length/s)||1)*i:t+i}}function cr(e){var t=e.doc,n=ur(e);t.iter(function(e){var t=n(e);t!=e.height&&pt(e,t)})}function dr(e,t,n,r){var i=e.display;if(!n&&"true"==Xe(t).getAttribute("cm-not-content"))return null;var o,n=i.lineSpace.getBoundingClientRect();try{o=t.clientX-n.left,s=t.clientY-n.top}catch(t){return null}var s,i=Jn(e,o,s);return r&&0<i.xRel&&(n=O(e.doc,i.line).text).length==i.ch&&(s=ue(n,n.length,e.options.tabSize)-n.length,i=I(i.line,Math.max(0,Math.round((o-xn(e.display).left)/sr(e.display))-s))),i}function hr(e,t){if(t>=e.display.viewTo)return null;if((t-=e.display.viewFrom)<0)return null;for(var n=e.display.view,r=0;r<n.length;r++)if((t-=n[r].size)<0)return r}function L(e,t,n,r){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size);var i,o=e.display,s=((r=r||0)&&n<o.viewTo&&(null==o.updateLineNumbers||o.updateLineNumbers>t)&&(o.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=o.viewTo?Ft&&Qt(e.doc,t)<o.viewTo&&pr(e):n<=o.viewFrom?Ft&&Jt(e.doc,n+r)>o.viewFrom?pr(e):(o.viewFrom+=r,o.viewTo+=r):t<=o.viewFrom&&n>=o.viewTo?pr(e):t<=o.viewFrom?(s=gr(e,n,n+r,1))?(o.view=o.view.slice(s.index),o.viewFrom=s.lineN,o.viewTo+=r):pr(e):n>=o.viewTo?(s=gr(e,t,t,-1))?(o.view=o.view.slice(0,s.index),o.viewTo=s.lineN):pr(e):(s=gr(e,t,t,-1),i=gr(e,n,n+r,1),s&&i?(o.view=o.view.slice(0,s.index).concat(pn(e,s.lineN,i.lineN)).concat(o.view.slice(i.index)),o.viewTo+=r):pr(e)),o.externalMeasured);s&&(n<s.lineN?s.lineN+=r:t<s.lineN+s.size&&(o.externalMeasured=null))}function fr(e,t,n){e.curOp.viewChanged=!0;var r=e.display,i=e.display.externalMeasured;i&&t>=i.lineN&&t<i.lineN+i.size&&(r.externalMeasured=null),t<r.viewFrom||t>=r.viewTo||null!=(i=r.view[hr(e,t)]).node&&-1==w(r=i.changes||(i.changes=[]),n)&&r.push(n)}function pr(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function gr(e,t,n,r){var i,o=hr(e,t),s=e.display.view;if(Ft&&n!=e.doc.first+e.doc.size){for(var a=e.display.viewFrom,l=0;l<o;l++)a+=s[l].size;if(a!=t){if(0<r){if(o==s.length-1)return null;i=a+s[o].size-t,o++}else i=a-t;t+=i,n+=i}for(;Qt(e.doc,n)!=n;){if(o==(r<0?0:s.length-1))return null;n+=r*s[o-(r<0?1:0)].size,o+=r}}return{index:o,lineN:n}}function mr(e){for(var t=e.display.view,n=0,r=0;r<t.length;r++){var i=t[r];i.hidden||i.node&&!i.changes||++n}return n}function yr(e){e.display.input.showSelection(e.display.input.prepareSelection())}function vr(e,t){void 0===t&&(t=!0);for(var n,r,i=e.doc,o={},s=o.cursors=document.createDocumentFragment(),a=o.selection=document.createDocumentFragment(),l=0;l<i.sel.ranges.length;l++)!t&&l==i.sel.primIndex||(n=i.sel.ranges[l]).from().line>=e.display.viewTo||n.to().line<e.display.viewFrom||(((r=n.empty())||e.options.showCursorWhenSelecting)&&br(e,n.head,s),r)||function(i,e,t){var n=i.display,o=i.doc,s=document.createDocumentFragment(),r=xn(i.display),S=r.left,T=Math.max(n.sizerWidth,In(i)-n.sizer.offsetLeft)-r.right,R="ltr"==o.direction;function A(e,t,n,r){t<0&&(t=0),t=Math.round(t),r=Math.round(r),s.appendChild(_("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px;\n                             top: "+t+"px; width: "+(null==n?T-e:n)+"px;\n                             height: "+(r-t)+"px"))}function a(n,g,m){var y,v,r=O(o,n),b=r.text.length;function E(e,t){return Kn(i,I(n,e),"div",r,t)}function C(e,t,n){e=tr(i,r,null,e),t="ltr"==t==("after"==n)?"left":"right";return E("after"==n?e.begin:e.end-(/\s/.test(r.text.charAt(e.end-1))?2:1),t)[t]}var w=He(r,o.direction);return function(e,t,n,r){if(!e)return r(t,n,"ltr",0);for(var i=!1,o=0;o<e.length;++o){var s=e[o];(s.from<n&&s.to>t||t==n&&s.to==t)&&(r(Math.max(s.from,t),Math.min(s.to,n),1==s.level?"rtl":"ltr",o),i=!0)}i||r(t,n,"ltr")}(w,g||0,null==m?b:m,function(e,t,n,r){var i,o,s,a,l,u="ltr"==n,c=E(e,u?"left":"right"),d=E(t-1,u?"right":"left"),h=null==g&&0==e,f=null==m&&t==b,p=0==r,r=!w||r==w.length-1;d.top-c.top<=3?(i=(R?h:f)&&p?S:(u?c:d).left,l=(R?f:h)&&r?T:(u?d:c).right,A(i,c.top,l-i,c.bottom)):(l=u?(o=R&&h&&p?S:c.left,s=R?T:C(e,n,"before"),a=R?S:C(t,n,"after"),R&&f&&r?T:d.right):(o=R?C(e,n,"before"):S,s=!R&&h&&p?T:c.right,a=!R&&f&&r?S:d.left,R?C(t,n,"after"):T),A(o,c.top,s-o,c.bottom),c.bottom<d.top&&A(S,c.bottom,null,d.top),A(a,d.top,l-a,d.bottom)),(!y||Er(c,y)<0)&&(y=c),Er(d,y)<0&&(y=d),(!v||Er(c,v)<0)&&(v=c),Er(d,v)<0&&(v=d)}),{start:y,end:v}}n=e.from(),r=e.to();{var l;n.line==r.line?a(n.line,n.ch,r.ch):(e=O(o,n.line),l=O(o,r.line),l=Zt(e)==Zt(l),n=a(n.line,n.ch,l?e.text.length+1:null).end,e=a(r.line,l?0:null,r.ch).start,l&&(n.top<e.top-2?(A(n.right,n.top,null,n.bottom),A(S,e.top,e.left,e.bottom)):A(n.right,n.top,e.left-n.right,n.bottom)),n.bottom<e.top&&A(S,n.bottom,null,e.top))}t.appendChild(s)}(e,n,a);return o}function br(e,t,n){var t=qn(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),r=n.appendChild(_("div"," ","CodeMirror-cursor"));r.style.left=t.left+"px",r.style.top=t.top+"px",r.style.height=Math.max(0,t.bottom-t.top)*e.options.cursorHeight+"px",t.other&&((r=n.appendChild(_("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"))).style.display="",r.style.left=t.other.left+"px",r.style.top=t.other.top+"px",r.style.height=.85*(t.other.bottom-t.other.top)+"px")}function Er(e,t){return e.top-t.top||e.left-t.left}function Cr(e){var t,n;e.state.focused&&(t=e.display,clearInterval(t.blinker),n=!0,t.cursorDiv.style.visibility="",0<e.options.cursorBlinkRate?t.blinker=setInterval(function(){return t.cursorDiv.style.visibility=(n=!n)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden"))}function wr(e){e.state.focused||(e.display.input.focus(),Tr(e))}function Sr(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,Rr(e))},100)}function Tr(e,t){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(N(e,"focus",e,t),e.state.focused=!0,re(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),E&&setTimeout(function(){return e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),Cr(e))}function Rr(e,t){e.state.delayingBlurEvent||(e.state.focused&&(N(e,"blur",e,t),e.state.focused=!1,Q(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function Ar(e){for(var t=e.display,n=t.lineDiv.offsetTop,r=0;r<t.view.length;r++){var i=t.view[r],o=e.options.lineWrapping,s=void 0,a=0;if(!i.hidden){y&&v<8?(s=(l=i.node.offsetTop+i.node.offsetHeight)-n,n=l):(s=(l=i.node.getBoundingClientRect()).bottom-l.top,!o&&i.text.firstChild&&(a=i.text.firstChild.getBoundingClientRect().right-l.left-1));var l,o=i.line.height-s;if((.005<o||o<-.005)&&(pt(i.line,s),_r(i.line),i.rest))for(var u=0;u<i.rest.length;u++)_r(i.rest[u]);a>e.display.sizerWidth&&(o=Math.ceil(a/sr(e.display)))>e.display.maxLineLength&&(e.display.maxLineLength=o,e.display.maxLine=i.line,e.display.maxLineChanged=!0)}}}function _r(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t){var n=e.widgets[t],r=n.node.parentNode;r&&(n.height=r.offsetHeight)}}function Nr(e,t,n){var r,i=n&&null!=n.top?Math.max(0,n.top):e.scroller.scrollTop,i=Math.floor(i-_n(e)),o=n&&null!=n.bottom?n.bottom:i+e.wrapper.clientHeight,i=gt(t,i),o=gt(t,o);return n&&n.ensure&&(r=n.ensure.from.line,n=n.ensure.to.line,r<i?o=gt(t,tn(O(t,i=r))+e.wrapper.clientHeight):Math.min(n,t.lastLine())>=o&&(i=gt(t,tn(O(t,n))-e.wrapper.clientHeight),o=n)),{from:i,to:Math.max(o,i+1)}}function xr(e,t){var n=e.display,r=or(e.display),i=(t.top<0&&(t.top=0),(e.curOp&&null!=e.curOp.scrollTop?e.curOp:n.scroller).scrollTop),o=Mn(e),s={},a=(t.bottom-t.top>o&&(t.bottom=t.top+o),e.doc.height+Nn(n)),l=t.top<r,r=t.bottom>a-r,r=(t.top<i?s.scrollTop=l?0:t.top:t.bottom>i+o&&(l=Math.min(t.top,(r?a:t.bottom)-o))!=i&&(s.scrollTop=l),(e.curOp&&null!=e.curOp.scrollLeft?e.curOp:n.scroller).scrollLeft),a=In(e)-(e.options.fixedGutter?n.gutters.offsetWidth:0),o=t.right-t.left>a;return o&&(t.right=t.left+a),t.left<10?s.scrollLeft=0:t.left<r?s.scrollLeft=Math.max(0,t.left-(o?0:10)):t.right>a+r-3&&(s.scrollLeft=t.right+(o?0:10)-a),s}function Or(e,t){null!=t&&(kr(e),e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc:e.curOp).scrollTop+t)}function Ir(e){kr(e);var t=e.getCursor();e.curOp.scrollToPos={from:t,to:t,margin:e.options.cursorScrollMargin}}function Mr(e,t,n){null==t&&null==n||kr(e),null!=t&&(e.curOp.scrollLeft=t),null!=n&&(e.curOp.scrollTop=n)}function kr(e){var t=e.curOp.scrollToPos;t&&(e.curOp.scrollToPos=null,Dr(e,Zn(e,t.from),Zn(e,t.to),t.margin))}function Dr(e,t,n,r){t=xr(e,{left:Math.min(t.left,n.left),top:Math.min(t.top,n.top)-r,right:Math.max(t.right,n.right),bottom:Math.max(t.bottom,n.bottom)+r});Mr(e,t.scrollLeft,t.scrollTop)}function Lr(e,t){Math.abs(e.doc.scrollTop-t)<2||(V||Jr(e,{top:t}),Pr(e,t,!0),V&&Jr(e),Xr(e,100))}function Pr(e,t,n){t=Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,t),e.display.scroller.scrollTop==t&&!n||(e.doc.scrollTop=t,e.display.scrollbars.setScrollTop(t),e.display.scroller.scrollTop==t)||(e.display.scroller.scrollTop=t)}function Fr(e,t,n,r){t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)&&!r||(e.doc.scrollLeft=t,ni(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function Br(e){var t=e.display,n=t.gutters.offsetWidth,r=Math.round(e.doc.height+Nn(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?n:0,docHeight:r,scrollHeight:r+On(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:n}}function Hr(e,t,n){this.cm=n;var r=this.vert=_("div",[_("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),i=this.horiz=_("div",[_("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");r.tabIndex=i.tabIndex=-1,e(r),e(i),S(r,"scroll",function(){r.clientHeight&&t(r.scrollTop,"vertical")}),S(i,"scroll",function(){i.clientWidth&&t(i.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,y&&v<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}function Ur(){}Hr.prototype.update=function(e){var t,n=e.scrollWidth>e.clientWidth+1,r=e.scrollHeight>e.clientHeight+1,i=e.nativeBarWidth;return r?(this.vert.style.display="block",this.vert.style.bottom=n?i+"px":"0",t=e.viewHeight-(n?i:0),this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+t)+"px"):(this.vert.style.display="",this.vert.firstChild.style.height="0"),n?(this.horiz.style.display="block",this.horiz.style.right=r?i+"px":"0",this.horiz.style.left=e.barLeft+"px",t=e.viewWidth-e.barLeft-(r?i:0),this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+t)+"px"):(this.horiz.style.display="",this.horiz.firstChild.style.width="0"),!this.checkedZeroWidth&&0<e.clientHeight&&(0==i&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:r?i:0,bottom:n?i:0}},Hr.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},Hr.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},Hr.prototype.zeroWidthHack=function(){this.horiz.style.height=this.vert.style.width=C&&!h?"12px":"18px",this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new ce,this.disableVert=new ce},Hr.prototype.enableZeroWidthBar=function(n,r,i){n.style.pointerEvents="auto",r.set(1e3,function e(){var t=n.getBoundingClientRect();("vert"==i?document.elementFromPoint(t.right-1,(t.top+t.bottom)/2):document.elementFromPoint((t.right+t.left)/2,t.bottom-1))!=n?n.style.pointerEvents="none":r.set(1e3,e)})},Hr.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)};function Vr(e,t){t=t||Br(e);var n=e.display.barWidth,r=e.display.barHeight;Wr(e,t);for(var i=0;i<4&&n!=e.display.barWidth||r!=e.display.barHeight;i++)n!=e.display.barWidth&&e.options.lineWrapping&&Ar(e),Wr(e,Br(e)),n=e.display.barWidth,r=e.display.barHeight}function Wr(e,t){var n=e.display,r=n.scrollbars.update(t);n.sizer.style.paddingRight=(n.barWidth=r.right)+"px",n.sizer.style.paddingBottom=(n.barHeight=r.bottom)+"px",n.heightForcer.style.borderBottom=r.bottom+"px solid transparent",r.right&&r.bottom?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=r.bottom+"px",n.scrollbarFiller.style.width=r.right+"px"):n.scrollbarFiller.style.display="",r.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=r.bottom+"px",n.gutterFiller.style.width=t.gutterWidth+"px"):n.gutterFiller.style.display=""}Ur.prototype.update=function(){return{bottom:0,right:0}},Ur.prototype.setScrollLeft=function(){},Ur.prototype.setScrollTop=function(){},Ur.prototype.clear=function(){};var $r={native:Hr,null:Ur};function jr(n){n.display.scrollbars&&(n.display.scrollbars.clear(),n.display.scrollbars.addClass)&&Q(n.display.wrapper,n.display.scrollbars.addClass),n.display.scrollbars=new $r[n.options.scrollbarStyle](function(e){n.display.wrapper.insertBefore(e,n.display.scrollbarFiller),S(e,"mousedown",function(){n.state.focused&&setTimeout(function(){return n.display.input.focus()},0)}),e.setAttribute("cm-not-content","true")},function(e,t){("horizontal"==t?Fr:Lr)(n,e)},n),n.display.scrollbars.addClass&&re(n.display.wrapper,n.display.scrollbars.addClass)}var zr=0;function Gr(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++zr},e=e.curOp,gn?gn.ops.push(e):e.ownsGroup=gn={ops:[e],delayedCallbacks:[]}}function Yr(e){e=e.curOp;if(e){var t=function(e){for(var t=0;t<e.ops.length;t++)e.ops[t].cm.curOp=null;for(var n=e.ops,r=0;r<n.length;r++){s=o=i=void 0;var i=n[r],o=i.cm,s=o.display;(function(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=On(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=On(e)+"px",t.scrollbarsClipped=!0)})(o),i.updateMaxLine&&rn(o),i.mustUpdate=i.viewChanged||i.forceUpdate||null!=i.scrollTop||i.scrollToPos&&(i.scrollToPos.from.line<s.viewFrom||i.scrollToPos.to.line>=s.viewTo)||s.maxLineChanged&&o.options.lineWrapping,i.update=i.mustUpdate&&new qr(o,i.mustUpdate&&{top:i.scrollTop,ensure:i.scrollToPos},i.forceUpdate)}for(var a=0;a<n.length;a++){l=void 0;var l=n[a];l.updatedDisplay=l.mustUpdate&&Zr(l.cm,l.update)}for(var u=0;u<n.length;u++){c=void 0;d=void 0;h=void 0;var c=n[u];var d=c.cm,h=d.display;c.updatedDisplay&&Ar(d);c.barMeasure=Br(d),h.maxLineChanged&&!d.options.lineWrapping&&(c.adjustWidthTo=Dn(d,h.maxLine,h.maxLine.text.length).left+3,d.display.sizerWidth=c.adjustWidthTo,c.barMeasure.scrollWidth=Math.max(h.scroller.clientWidth,h.sizer.offsetLeft+c.adjustWidthTo+On(d)+d.display.barWidth),c.maxScrollLeft=Math.max(0,h.sizer.offsetLeft+c.adjustWidthTo-In(d)));(c.updatedDisplay||c.selectionChanged)&&(c.preparedSelection=h.input.prepareSelection())}for(var f=0;f<n.length;f++){p=void 0;g=void 0;m=void 0;var p=n[f];var g=p.cm;null!=p.adjustWidthTo&&(g.display.sizer.style.minWidth=p.adjustWidthTo+"px",p.maxScrollLeft<g.doc.scrollLeft&&Fr(g,Math.min(g.display.scroller.scrollLeft,p.maxScrollLeft),!0),g.display.maxLineChanged=!1);var m=p.focus&&p.focus==ne();p.preparedSelection&&g.display.input.showSelection(p.preparedSelection,m);!p.updatedDisplay&&p.startHeight==g.doc.height||Vr(g,p.barMeasure);p.updatedDisplay&&ti(g,p.barMeasure);p.selectionChanged&&Cr(g);g.state.focused&&p.updateInput&&g.display.input.reset(p.typing);m&&wr(p.cm)}for(var y,v=0;v<n.length;v++){b=void 0;E=void 0;C=void 0;w=void 0;y=void 0;S=void 0;T=void 0;R=void 0;A=void 0;var b=n[v];var E=b.cm,C=E.display,w=E.doc;b.updatedDisplay&&Qr(E,b.update);null==C.wheelStartX||null==b.scrollTop&&null==b.scrollLeft&&!b.scrollToPos||(C.wheelStartX=C.wheelStartY=null);null!=b.scrollTop&&Pr(E,b.scrollTop,b.forceScroll);null!=b.scrollLeft&&Fr(E,b.scrollLeft,!0,!0);b.scrollToPos&&(y=function(e,t,n,r){null==r&&(r=0),e.options.lineWrapping||t!=n||(n="before"==(t=t.ch?I(t.line,"before"==t.sticky?t.ch-1:t.ch,"after"):t).sticky?I(t.line,t.ch+1,"before"):t);for(var i=0;i<5;i++){var o,s=!1,a=qn(e,t),l=n&&n!=t?qn(e,n):a,a=xr(e,o={left:Math.min(a.left,l.left),top:Math.min(a.top,l.top)-r,right:Math.max(a.left,l.left),bottom:Math.max(a.bottom,l.bottom)+r}),l=e.doc.scrollTop,u=e.doc.scrollLeft;if(null!=a.scrollTop&&(Lr(e,a.scrollTop),1<Math.abs(e.doc.scrollTop-l))&&(s=!0),!(s=null!=a.scrollLeft&&(Fr(e,a.scrollLeft),1<Math.abs(e.doc.scrollLeft-u))?!0:s))break}return o}(E,k(w,b.scrollToPos.from),k(w,b.scrollToPos.to),b.scrollToPos.margin),function(e,t){var n,r,i;x(e,"scrollCursorIntoView")||(i=(n=e.display).sizer.getBoundingClientRect(),r=null,t.top+i.top<0?r=!0:t.bottom+i.top>(window.innerHeight||document.documentElement.clientHeight)&&(r=!1),null==r)||j||(i=_("div","​",null,"position: absolute;\n                         top: "+(t.top-n.viewOffset-_n(e.display))+"px;\n                         height: "+(t.bottom-t.top+On(e)+n.barHeight)+"px;\n                         left: "+t.left+"px; width: "+Math.max(2,t.right-t.left)+"px;"),e.display.lineSpace.appendChild(i),i.scrollIntoView(r),e.display.lineSpace.removeChild(i))}(E,y));var S=b.maybeHiddenMarkers,T=b.maybeUnhiddenMarkers;if(S)for(var R=0;R<S.length;++R)S[R].lines.length||N(S[R],"hide");if(T)for(var A=0;A<T.length;++A)T[A].lines.length&&N(T[A],"unhide");C.wrapper.offsetHeight&&(w.scrollTop=E.display.scroller.scrollTop);b.changeObjs&&N(E,"changes",E,b.changeObjs);b.update&&b.update.finish()}};if(e=e.ownsGroup)try{var n=e,r=n.delayedCallbacks,i=0;do{for(;i<r.length;i++)r[i].call(null);for(var o=0;o<n.ops.length;o++){var s=n.ops[o];if(s.cursorActivityHandlers)for(;s.cursorActivityCalled<s.cursorActivityHandlers.length;)s.cursorActivityHandlers[s.cursorActivityCalled++].call(null,s.cm)}}while(i<r.length)}finally{gn=null,t(e)}}}function d(e,t){if(e.curOp)return t();Gr(e);try{return t()}finally{Yr(e)}}function P(e,t){return function(){if(e.curOp)return t.apply(e,arguments);Gr(e);try{return t.apply(e,arguments)}finally{Yr(e)}}}function n(e){return function(){if(this.curOp)return e.apply(this,arguments);Gr(this);try{return e.apply(this,arguments)}finally{Yr(this)}}}function r(t){return function(){var e=this.cm;if(!e||e.curOp)return t.apply(this,arguments);Gr(e);try{return t.apply(this,arguments)}finally{Yr(e)}}}function Xr(e,t){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(t,ae(Kr,e))}function Kr(s){var a,l,u,c=s.doc;c.highlightFrontier>=s.display.viewTo||(a=+new Date+s.options.workTime,l=Nt(s,c.highlightFrontier),u=[],c.iter(l.line,Math.min(c.first+c.size,s.display.viewTo+500),function(e){if(l.line>=s.display.viewFrom){for(var t=e.styles,n=e.text.length>s.options.maxHighlightLength?ut(c.mode,l.state):null,r=At(s,e,l,!0),n=(n&&(l.state=n),e.styles=r.styles,e.styleClasses),r=r.classes,i=(r?e.styleClasses=r:n&&(e.styleClasses=null),!t||t.length!=e.styles.length||n!=r&&(!n||!r||n.bgClass!=r.bgClass||n.textClass!=r.textClass)),o=0;!i&&o<t.length;++o)i=t[o]!=e.styles[o];i&&u.push(l.line),e.stateAfter=l.save()}else e.text.length<=s.options.maxHighlightLength&&xt(s,e.text,l),e.stateAfter=l.line%5==0?l.save():null;if(l.nextLine(),+new Date>a)return Xr(s,s.options.workDelay),!0}),c.highlightFrontier=l.line,c.modeFrontier=Math.max(c.modeFrontier,l.line),u.length&&d(s,function(){for(var e=0;e<u.length;e++)fr(s,u[e],"text")}))}var qr=function(e,t,n){var r=e.display;this.viewport=t,this.visible=Nr(r,e.doc,t),this.editorIsHidden=!r.wrapper.offsetWidth,this.wrapperHeight=r.wrapper.clientHeight,this.wrapperWidth=r.wrapper.clientWidth,this.oldDisplayWidth=In(e),this.force=n,this.dims=ar(e),this.events=[]};function Zr(e,t){var n=e.display,r=e.doc;if(t.editorIsHidden)return pr(e),!1;if(!t.force&&t.visible.from>=n.viewFrom&&t.visible.to<=n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo)&&n.renderedView==n.view&&0==mr(e))return!1;ri(e)&&(pr(e),t.dims=ar(e));var i=r.first+r.size,o=Math.max(t.visible.from-e.options.viewportMargin,r.first),s=Math.min(i,t.visible.to+e.options.viewportMargin),r=(n.viewFrom<o&&o-n.viewFrom<20&&(o=Math.max(r.first,n.viewFrom)),n.viewTo>s&&n.viewTo-s<20&&(s=Math.min(i,n.viewTo)),Ft&&(o=Qt(e.doc,o),s=Jt(e.doc,s)),o!=n.viewFrom||s!=n.viewTo||n.lastWrapHeight!=t.wrapperHeight||n.lastWrapWidth!=t.wrapperWidth),i=(i=o,o=s,0==(a=(s=e).display).view.length||i>=a.viewTo||o<=a.viewFrom?(a.view=pn(s,i,o),a.viewFrom=i):(a.viewFrom>i?a.view=pn(s,i,a.viewFrom).concat(a.view):a.viewFrom<i&&(a.view=a.view.slice(hr(s,i))),a.viewFrom=i,a.viewTo<o?a.view=a.view.concat(pn(s,a.viewTo,o)):a.viewTo>o&&(a.view=a.view.slice(0,hr(s,o)))),a.viewTo=o,n.viewOffset=tn(O(e.doc,n.viewFrom)),e.display.mover.style.top=n.viewOffset+"px",mr(e));if(!r&&0==i&&!t.force&&n.renderedView==n.view&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo))return!1;var a,s=!(s=e).hasFocus()&&(a=ne())&&te(s.display.lineDiv,a)?(a={activeElt:a},window.getSelection&&(o=window.getSelection()).anchorNode&&o.extend&&te(s.display.lineDiv,o.anchorNode)&&(a.anchorNode=o.anchorNode,a.anchorOffset=o.anchorOffset,a.focusNode=o.focusNode,a.focusOffset=o.focusOffset),a):null,l=(4<i&&(n.lineDiv.style.display="none"),e),u=n.updateLineNumbers,c=t.dims,o=l.display,d=l.options.lineNumbers,h=o.lineDiv,f=h.firstChild;function p(e){var t=e.nextSibling;return E&&C&&l.display.currentWheelTarget==e?e.style.display="none":e.parentNode.removeChild(e),t}for(var g=o.view,m=o.viewFrom,y=0;y<g.length;y++){var v=g[y];if(!v.hidden)if(v.node&&v.node.parentNode==h){for(;f!=v.node;)f=p(f);var b=d&&null!=u&&u<=m&&v.lineNumber;v.changes&&(-1<w(v.changes,"gutter")&&(b=!1),vn(l,v,m,c)),b&&(J(v.lineNumber),v.lineNumber.appendChild(document.createTextNode(yt(l.options,m)))),f=v.node.nextSibling}else{b=function(e,t,n,r){var i=En(e,t);return t.text=t.node=i.pre,i.bgClass&&(t.bgClass=i.bgClass),i.textClass&&(t.textClass=i.textClass),Cn(e,t),wn(e,t,n,r),Sn(e,t,r),t.node}(l,v,m,c);h.insertBefore(b,f)}m+=v.size}for(;f;)f=p(f);return 4<i&&(n.lineDiv.style.display=""),n.renderedView=n.view,(a=s)&&a.activeElt&&a.activeElt!=ne()&&(a.activeElt.focus(),a.anchorNode)&&te(document.body,a.anchorNode)&&te(document.body,a.focusNode)&&(o=window.getSelection(),(i=document.createRange()).setEnd(a.anchorNode,a.anchorOffset),i.collapse(!1),o.removeAllRanges(),o.addRange(i),o.extend(a.focusNode,a.focusOffset)),J(n.cursorDiv),J(n.selectionDiv),n.gutters.style.height=n.sizer.style.minHeight=0,r&&(n.lastWrapHeight=t.wrapperHeight,n.lastWrapWidth=t.wrapperWidth,Xr(e,400)),!(n.updateLineNumbers=null)}function Qr(e,t){for(var n=t.viewport,r=!0;(r&&e.options.lineWrapping&&t.oldDisplayWidth!=In(e)||(n&&null!=n.top&&(n={top:Math.min(e.doc.height+Nn(e.display)-Mn(e),n.top)}),t.visible=Nr(e.display,e.doc,n),!(t.visible.from>=e.display.viewFrom))||!(t.visible.to<=e.display.viewTo))&&Zr(e,t);r=!1){Ar(e);var i=Br(e);yr(e),Vr(e,i),ti(e,i),t.force=!1}t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function Jr(e,t){var n,t=new qr(e,t);Zr(e,t)&&(Ar(e),Qr(e,t),n=Br(e),yr(e),Vr(e,n),ti(e,n),t.finish())}function ei(e){var t=e.gutters.offsetWidth;e.sizer.style.marginLeft=t+"px"}function ti(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+On(e)+"px"}function ni(e){var t=e.display,n=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var r=lr(t)-t.scroller.scrollLeft+e.doc.scrollLeft,i=t.gutters.offsetWidth,o=r+"px",s=0;s<n.length;s++)if(!n[s].hidden){e.options.fixedGutter&&(n[s].gutter&&(n[s].gutter.style.left=o),n[s].gutterBackground)&&(n[s].gutterBackground.style.left=o);var a=n[s].alignable;if(a)for(var l=0;l<a.length;l++)a[l].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=r+i+"px")}}function ri(e){var t,n,r,i;if(e.options.lineNumbers)return t=e.doc,t=yt(e.options,t.first+t.size-1),n=e.display,t.length!=n.lineNumChars?(r=(i=n.measure.appendChild(_("div",[_("div",t)],"CodeMirror-linenumber CodeMirror-gutter-elt"))).firstChild.offsetWidth,i=i.offsetWidth-r,n.lineGutter.style.width="",n.lineNumInnerWidth=Math.max(r,n.lineGutter.offsetWidth-i)+1,n.lineNumWidth=n.lineNumInnerWidth+i,n.lineNumChars=n.lineNumInnerWidth?t.length:-1,n.lineGutter.style.width=n.lineNumWidth+"px",ei(e.display),1):void 0}function ii(e,t){for(var n=[],r=!1,i=0;i<e.length;i++){var o=e[i],s=null;if("string"!=typeof o&&(s=o.style,o=o.className),"CodeMirror-linenumbers"==o){if(!t)continue;r=!0}n.push({className:o,style:s})}return t&&!r&&n.push({className:"CodeMirror-linenumbers",style:null}),n}function oi(e){var t=e.gutters,n=e.gutterSpecs;J(t),e.lineGutter=null;for(var r=0;r<n.length;++r){var i=n[r],o=i.className,i=i.style,s=t.appendChild(_("div",null,"CodeMirror-gutter "+o));i&&(s.style.cssText=i),"CodeMirror-linenumbers"==o&&((e.lineGutter=s).style.width=(e.lineNumWidth||1)+"px")}t.style.display=n.length?"":"none",ei(e)}function si(e){oi(e.display),L(e),ni(e)}function ai(e,t,n,r){var i=this,o=(this.input=n,i.scrollbarFiller=_("div",null,"CodeMirror-scrollbar-filler"),i.scrollbarFiller.setAttribute("cm-not-content","true"),i.gutterFiller=_("div",null,"CodeMirror-gutter-filler"),i.gutterFiller.setAttribute("cm-not-content","true"),i.lineDiv=ee("div",null,"CodeMirror-code"),i.selectionDiv=_("div",null,null,"position: relative; z-index: 1"),i.cursorDiv=_("div",null,"CodeMirror-cursors"),i.measure=_("div",null,"CodeMirror-measure"),i.lineMeasure=_("div",null,"CodeMirror-measure"),i.lineSpace=ee("div",[i.measure,i.lineMeasure,i.selectionDiv,i.cursorDiv,i.lineDiv],null,"position: relative; outline: none"),ee("div",[i.lineSpace],"CodeMirror-lines"));i.mover=_("div",[o],null,"position: relative"),i.sizer=_("div",[i.mover],"CodeMirror-sizer"),i.sizerWidth=null,i.heightForcer=_("div",null,null,"position: absolute; height: "+de+"px; width: 1px;"),i.gutters=_("div",null,"CodeMirror-gutters"),i.lineGutter=null,i.scroller=_("div",[i.sizer,i.heightForcer,i.gutters],"CodeMirror-scroll"),i.scroller.setAttribute("tabIndex","-1"),i.wrapper=_("div",[i.scrollbarFiller,i.gutterFiller,i.scroller],"CodeMirror"),y&&v<8&&(i.gutters.style.zIndex=-1,i.scroller.style.paddingRight=0),E||V&&Y||(i.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(i.wrapper):e(i.wrapper)),i.viewFrom=i.viewTo=t.first,i.reportedViewFrom=i.reportedViewTo=t.first,i.view=[],i.renderedView=null,i.externalMeasured=null,i.viewOffset=0,i.lastWrapHeight=i.lastWrapWidth=0,i.updateLineNumbers=null,i.nativeBarWidth=i.barHeight=i.barWidth=0,i.scrollbarsClipped=!1,i.lineNumWidth=i.lineNumInnerWidth=i.lineNumChars=null,i.alignWidgets=!1,i.cachedCharWidth=i.cachedTextHeight=i.cachedPaddingH=null,i.maxLine=null,i.maxLineLength=0,i.maxLineChanged=!1,i.wheelDX=i.wheelDY=i.wheelStartX=i.wheelStartY=null,i.shift=!1,i.selForContextMenu=null,i.activeTouch=null,i.gutterSpecs=ii(r.gutters,r.lineNumbers),oi(i),n.init(i)}qr.prototype.signal=function(e,t){$e(e,t)&&this.events.push(arguments)},qr.prototype.finish=function(){for(var e=0;e<this.events.length;e++)N.apply(null,this.events[e])};var li=0,f=null;function ui(e){var t=e.wheelDeltaX,n=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==n&&e.detail&&e.axis==e.VERTICAL_AXIS?n=e.detail:null==n&&(n=e.wheelDelta),{x:t,y:n}}function ci(e){e=ui(e);return e.x*=f,e.y*=f,e}function di(e,t){var n,r,i=ui(t),o=i.x,i=i.y,s=e.display,a=s.scroller,l=a.scrollWidth>a.clientWidth,u=a.scrollHeight>a.clientHeight;if(o&&l||i&&u){if(i&&C&&E)e:for(var c=t.target,d=s.view;c!=a;c=c.parentNode)for(var h=0;h<d.length;h++)if(d[h].node==c){e.display.currentWheelTarget=c;break e}!o||V||W||null==f?(i&&null!=f&&(l=i*f,r=(n=e.doc.scrollTop)+s.wrapper.clientHeight,l<0?n=Math.max(0,n+l-50):r=Math.min(e.doc.height,r+l+50),Jr(e,{top:n,bottom:r})),li<20&&(null==s.wheelStartX?(s.wheelStartX=a.scrollLeft,s.wheelStartY=a.scrollTop,s.wheelDX=o,s.wheelDY=i,setTimeout(function(){var e,t;null!=s.wheelStartX&&(e=a.scrollLeft-s.wheelStartX,t=(t=a.scrollTop-s.wheelStartY)&&s.wheelDY&&t/s.wheelDY||e&&s.wheelDX&&e/s.wheelDX,s.wheelStartX=s.wheelStartY=null,t)&&(f=(f*li+t)/(li+1),++li)},200)):(s.wheelDX+=o,s.wheelDY+=i))):(i&&u&&Lr(e,Math.max(0,a.scrollTop+i*f)),Fr(e,Math.max(0,a.scrollLeft+o*f)),i&&!u||R(t),s.wheelStartX=null)}}y?f=-.53:V?f=15:c?f=-.7:$&&(f=-1/3);var B=function(e,t){this.ranges=e,this.primIndex=t},H=(B.prototype.primary=function(){return this.ranges[this.primIndex]},B.prototype.equals=function(e){if(e!=this){if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var n=this.ranges[t],r=e.ranges[t];if(!vt(n.anchor,r.anchor)||!vt(n.head,r.head))return!1}}return!0},B.prototype.deepCopy=function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new H(bt(this.ranges[t].anchor),bt(this.ranges[t].head));return new B(e,this.primIndex)},B.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},B.prototype.contains=function(e,t){t=t||e;for(var n=0;n<this.ranges.length;n++){var r=this.ranges[n];if(0<=M(t,r.from())&&M(e,r.to())<=0)return n}return-1},function(e,t){this.anchor=e,this.head=t});function hi(e,t,n){var r=e&&e.options.selectionsMayTouch,e=t[n];t.sort(function(e,t){return M(e.from(),t.from())}),n=w(t,e);for(var i=1;i<t.length;i++){var o,s=t[i],a=t[i-1],l=M(a.to(),s.from());(r&&!s.empty()?0<l:0<=l)&&(l=Ct(a.from(),s.from()),o=Et(a.to(),s.to()),s=a.empty()?s.from()==s.head:a.from()==a.head,i<=n&&--n,t.splice(--i,2,new H(s?o:l,s?l:o)))}return new B(t,n)}function fi(e,t){return new B([new H(e,t||e)],0)}function pi(e){return e.text?I(e.from.line+e.text.length-1,F(e.text).length+(1==e.text.length?e.from.ch:0)):e.to}function gi(e,t){var n,r;return M(e,t.from)<0?e:M(e,t.to)<=0?pi(t):(n=e.line+t.text.length-(t.to.line-t.from.line)-1,r=e.ch,e.line==t.to.line&&(r+=pi(t).ch-t.to.ch),I(n,r))}function mi(e,t){for(var n=[],r=0;r<e.sel.ranges.length;r++){var i=e.sel.ranges[r];n.push(new H(gi(i.anchor,t),gi(i.head,t)))}return hi(e.cm,n,e.sel.primIndex)}function yi(e,t,n){return e.line==t.line?I(n.line,e.ch-t.ch+n.ch):I(n.line+(e.line-t.line),e.ch)}function vi(e){e.doc.mode=st(e.options,e.doc.modeOption),bi(e)}function bi(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,Xr(e,100),e.state.modeGen++,e.curOp&&L(e)}function Ei(e,t){return 0==t.from.ch&&0==t.to.ch&&""==F(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function Ci(e,o,t,s){function i(e){return t?t[e]:null}function n(e,t,n){var r,i;t=t,n=n,i=s,(r=e).text=t,r.stateAfter&&(r.stateAfter=null),r.styles&&(r.styles=null),null!=r.order&&(r.order=null),Wt(r),$t(r,n),(t=i?i(r):1)!=r.height&&pt(r,t),D(e,"change",e,o)}function r(e,t){for(var n=[],r=e;r<t;++r)n.push(new on(c[r],i(r),s));return n}var a,l=o.from,u=o.to,c=o.text,d=O(e,l.line),h=O(e,u.line),f=F(c),p=i(c.length-1),g=u.line-l.line;o.full?(e.insert(0,r(0,c.length)),e.remove(c.length,e.size-c.length)):Ei(e,o)?(a=r(0,c.length-1),n(h,h.text,p),g&&e.remove(l.line,g),a.length&&e.insert(l.line,a)):d==h?1==c.length?n(d,d.text.slice(0,l.ch)+f+d.text.slice(u.ch),p):((a=r(1,c.length-1)).push(new on(f+d.text.slice(u.ch),p,s)),n(d,d.text.slice(0,l.ch)+c[0],i(0)),e.insert(l.line+1,a)):1==c.length?(n(d,d.text.slice(0,l.ch)+c[0]+h.text.slice(u.ch),i(0)),e.remove(l.line+1,g)):(n(d,d.text.slice(0,l.ch)+c[0],i(0)),n(h,f+h.text.slice(u.ch),p),a=r(1,c.length-1),1<g&&e.remove(l.line+1,g-1),e.insert(l.line+1,a)),D(e,"change",e,o)}function wi(e,a,l){!function e(t,n,r){if(t.linked)for(var i=0;i<t.linked.length;++i){var o,s=t.linked[i];s.doc!=n&&(o=r&&s.sharedHist,!l||o)&&(a(s.doc,o),e(s.doc,t,o))}}(e,null,!0)}function Si(e,t){if(t.cm)throw new Error("This document is already in use.");cr((e.doc=t).cm=e),vi(e),Ti(e),e.options.lineWrapping||rn(e),e.options.mode=t.modeOption,L(e)}function Ti(e){("rtl"==e.doc.direction?re:Q)(e.display.lineDiv,"CodeMirror-rtl")}function Ri(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function Ai(e,t){var n={from:bt(t.from),to:pi(t),text:ht(e,t.from,t.to)};return Ii(e,n,t.from.line,t.to.line+1),wi(e,function(e){return Ii(e,n,t.from.line,t.to.line+1)},!0),n}function _i(e){for(;e.length;){if(!F(e).ranges)break;e.pop()}}function Ni(e,t,n,r){var i,o,s=e.history,a=(s.undone.length=0,+new Date);if((s.lastOp==r||s.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&s.lastModTime>a-(e.cm?e.cm.options.historyEventDelay:500)||"*"==t.origin.charAt(0)))&&(o=(o=s).lastOp==r?(_i(o.done),F(o.done)):o.done.length&&!F(o.done).ranges?F(o.done):1<o.done.length&&!o.done[o.done.length-2].ranges?(o.done.pop(),F(o.done)):void 0))i=F(o.changes),0==M(t.from,t.to)&&0==M(t.from,i.to)?i.to=pi(t):o.changes.push(Ai(e,t));else{var l=F(s.done);for(l&&l.ranges||Oi(e.sel,s.done),o={changes:[Ai(e,t)],generation:s.generation},s.done.push(o);s.done.length>s.undoDepth;)s.done.shift(),s.done[0].ranges||s.done.shift()}s.done.push(n),s.generation=++s.maxGeneration,s.lastModTime=s.lastSelTime=a,s.lastOp=s.lastSelOp=r,s.lastOrigin=s.lastSelOrigin=t.origin,i||N(e,"historyAdded")}function xi(e,t,n,r){var i,o,s,a=e.history,l=r&&r.origin;n==a.lastSelOp||l&&a.lastSelOrigin==l&&(a.lastModTime==a.lastSelTime&&a.lastOrigin==l||(e=e,i=l,o=F(a.done),s=t,"*"==(i=i.charAt(0)))||"+"==i&&o.ranges.length==s.ranges.length&&o.somethingSelected()==s.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500))?a.done[a.done.length-1]=t:Oi(t,a.done),a.lastSelTime=+new Date,a.lastSelOrigin=l,a.lastSelOp=n,r&&!1!==r.clearRedo&&_i(a.undone)}function Oi(e,t){var n=F(t);n&&n.ranges&&n.equals(e)||t.push(e)}function Ii(t,n,e,r){var i=n["spans_"+t.id],o=0;t.iter(Math.max(t.first,e),Math.min(t.first+t.size,r),function(e){e.markedSpans&&((i=i||(n["spans_"+t.id]={}))[o]=e.markedSpans),++o})}function Mi(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var r=[],i=0;i<t.text.length;++i)r.push(function(e){if(!e)return null;for(var t,n=0;n<e.length;++n)e[n].marker.explicitlyCleared?t=t||e.slice(0,n):t&&t.push(e[n]);return t?t.length?t:null:e}(n[i]));return r}function ki(e,t){var n=Mi(e,t),r=Ut(e,t);if(!n)return r;if(r)for(var i=0;i<n.length;++i){var o=n[i],s=r[i];if(o&&s)e:for(var a=0;a<s.length;++a){for(var l=s[a],u=0;u<o.length;++u)if(o[u].marker==l.marker)continue e;o.push(l)}else s&&(n[i]=s)}return n}function Di(e,t,n){for(var r=[],i=0;i<e.length;++i){var o=e[i];if(o.ranges)r.push(n?B.prototype.deepCopy.call(o):o);else{var s=o.changes,a=[];r.push({changes:a});for(var l=0;l<s.length;++l){var u,c=s[l];if(a.push({from:c.from,to:c.to,text:c.text}),t)for(var d in c)(u=d.match(/^spans_(\d+)$/))&&-1<w(t,Number(u[1]))&&(F(a)[d]=c[d],delete c[d])}}}return r}function Li(e,t,n,r){return r?(r=e.anchor,n&&((e=M(t,r)<0)!=M(n,r)<0?(r=t,t=n):e!=M(t,n)<0&&(t=n)),new H(r,t)):new H(n||t,t)}function Pi(e,t,n,r,i){null==i&&(i=e.cm&&(e.cm.display.shift||e.extend)),U(e,new B([Li(e.sel.primary(),t,n,i)],0),r)}function Fi(e,t,n){for(var r=[],i=e.cm&&(e.cm.display.shift||e.extend),o=0;o<e.sel.ranges.length;o++)r[o]=Li(e.sel.ranges[o],t[o],null,i);U(e,hi(e.cm,r,e.sel.primIndex),n)}function Bi(e,t,n,r){var i=e.sel.ranges.slice(0);i[t]=n,U(e,hi(e.cm,i,e.sel.primIndex),r)}function Hi(e,t,n,r){U(e,fi(t,n),r)}function Ui(e,t,n){var r=e.history.done,i=F(r);i&&i.ranges?Vi(e,r[r.length-1]=t,n):U(e,t,n)}function U(e,t,n){Vi(e,t,n),xi(e,e.sel,e.cm?e.cm.curOp.id:NaN,n)}function Vi(e,t,n){($e(e,"beforeSelectionChange")||e.cm&&$e(e.cm,"beforeSelectionChange"))&&(r=e,o=n,o={ranges:(i=t).ranges,update:function(e){this.ranges=[];for(var t=0;t<e.length;t++)this.ranges[t]=new H(k(r,e[t].anchor),k(r,e[t].head))},origin:o&&o.origin},N(r,"beforeSelectionChange",r,o),r.cm&&N(r.cm,"beforeSelectionChange",r.cm,o),t=o.ranges!=i.ranges?hi(r.cm,o.ranges,o.ranges.length-1):i);var r,i,o=n&&n.bias||(M(t.primary().head,e.sel.primary().head)<0?-1:1);Wi(e,ji(e,t,o,!0)),n&&!1===n.scroll||!e.cm||Ir(e.cm)}function Wi(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=1,e.cm.curOp.selectionChanged=!0,We(e.cm)),D(e,"cursorActivity",e))}function $i(e){Wi(e,ji(e,e.sel,null,!1))}function ji(e,t,n,r){for(var i,o=0;o<t.ranges.length;o++){var s=t.ranges[o],a=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[o],l=Gi(e,s.anchor,a&&a.anchor,n,r),a=Gi(e,s.head,a&&a.head,n,r);!i&&l==s.anchor&&a==s.head||((i=i||t.ranges.slice(0,o))[o]=new H(l,a))}return i?hi(e.cm,i,t.primIndex):t}function zi(e,t,n,r,i){var o=O(e,t.line);if(o.markedSpans)for(var s=0;s<o.markedSpans.length;++s){var a=o.markedSpans[s],l=a.marker,u="selectLeft"in l?!l.selectLeft:l.inclusiveLeft,c="selectRight"in l?!l.selectRight:l.inclusiveRight;if((null==a.from||(u?a.from<=t.ch:a.from<t.ch))&&(null==a.to||(c?a.to>=t.ch:a.to>t.ch))){if(i&&(N(l,"beforeCursorEnter"),l.explicitlyCleared)){if(o.markedSpans){--s;continue}break}if(l.atomic){if(n){var a=l.find(r<0?1:-1),d=void 0;if((a=(r<0?c:u)?Yi(e,a,-r,a&&a.line==t.line?o:null):a)&&a.line==t.line&&(d=M(a,n))&&(r<0?d<0:0<d))return zi(e,a,t,r,i)}d=l.find(r<0?-1:1);return(d=(r<0?u:c)?Yi(e,d,r,d.line==t.line?o:null):d)?zi(e,d,t,r,i):null}}}return t}function Gi(e,t,n,r,i){r=r||1,i=zi(e,t,n,r,i)||!i&&zi(e,t,n,r,!0)||zi(e,t,n,-r,i)||!i&&zi(e,t,n,-r,!0);return i||(e.cantEdit=!0,I(e.first,0))}function Yi(e,t,n,r){return n<0&&0==t.ch?t.line>e.first?k(e,I(t.line-1)):null:0<n&&t.ch==(r||O(e,t.line)).text.length?t.line<e.first+e.size-1?I(t.line+1,0):null:new I(t.line,t.ch+n)}function Xi(e){e.setSelection(I(e.firstLine(),0),I(e.lastLine()),fe)}function Ki(i,e,t){var o={canceled:!1,from:e.from,to:e.to,text:e.text,origin:e.origin,cancel:function(){return o.canceled=!0}};return t&&(o.update=function(e,t,n,r){e&&(o.from=k(i,e)),t&&(o.to=k(i,t)),n&&(o.text=n),void 0!==r&&(o.origin=r)}),N(i,"beforeChange",i,o),i.cm&&N(i.cm,"beforeChange",i.cm,o),o.canceled?(i.cm&&(i.cm.curOp.updateInput=2),null):{from:o.from,to:o.to,text:o.text,origin:o.origin}}function qi(e,t,n){if(e.cm){if(!e.cm.curOp)return P(e.cm,qi)(e,t,n);if(e.cm.state.suppressEdits)return}if(!($e(e,"beforeChange")||e.cm&&$e(e.cm,"beforeChange"))||(t=Ki(e,t,!0))){var r=Pt&&!n&&function(e,t,n){var r=null;if(e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;!n.readOnly||r&&-1!=w(r,n)||(r=r||[]).push(n)}}),!r)return null;for(var i=[{from:t,to:n}],o=0;o<r.length;++o)for(var s=r[o],a=s.find(0),l=0;l<i.length;++l){var u,c,d,h=i[l];M(h.to,a.from)<0||0<M(h.from,a.to)||(u=[l,1],c=M(h.from,a.from),d=M(h.to,a.to),(c<0||!s.inclusiveLeft&&!c)&&u.push({from:h.from,to:a.from}),(0<d||!s.inclusiveRight&&!d)&&u.push({from:a.to,to:h.to}),i.splice.apply(i,u),l+=u.length-3)}return i}(e,t.from,t.to);if(r)for(var i=r.length-1;0<=i;--i)Zi(e,{from:r[i].from,to:r[i].to,text:i?[""]:t.text,origin:t.origin});else Zi(e,t)}}function Zi(e,n){var t,r;1==n.text.length&&""==n.text[0]&&0==M(n.from,n.to)||(t=mi(e,n),Ni(e,n,t,e.cm?e.cm.curOp.id:NaN),eo(e,n,t,Ut(e,n)),r=[],wi(e,function(e,t){t||-1!=w(r,e.history)||(io(e.history,n),r.push(e.history)),eo(e,n,null,Ut(e,n))}))}function Qi(i,o,e){var t=i.cm&&i.cm.state.suppressEdits;if(!t||e){for(var s,n=i.history,r=i.sel,a="undo"==o?n.done:n.undone,l="undo"==o?n.undone:n.done,u=0;u<a.length&&(s=a[u],e?!s.ranges||s.equals(i.sel):s.ranges);u++);if(u!=a.length){for(n.lastOrigin=n.lastSelOrigin=null;;){if(!(s=a.pop()).ranges){if(t)return void a.push(s);break}if(Oi(s,l),e&&!s.equals(i.sel))return void U(i,s,{clearRedo:!1});r=s}for(var c=[],d=(Oi(r,l),l.push({changes:c,generation:n.generation}),n.generation=s.generation||++n.maxGeneration,$e(i,"beforeChange")||i.cm&&$e(i.cm,"beforeChange")),h=s.changes.length-1;0<=h;--h){var f=function(e){var n=s.changes[e];if(n.origin=o,d&&!Ki(i,n,!1))return a.length=0,{};c.push(Ai(i,n));var t=e?mi(i,n):F(a),r=(eo(i,n,t,ki(i,n)),!e&&i.cm&&i.cm.scrollIntoView({from:n.from,to:pi(n)}),[]);wi(i,function(e,t){t||-1!=w(r,e.history)||(io(e.history,n),r.push(e.history)),eo(e,n,null,ki(e,n))})}(h);if(f)return f.v}}}}function Ji(e,t){if(0!=t&&(e.first+=t,e.sel=new B(be(e.sel.ranges,function(e){return new H(I(e.anchor.line+t,e.anchor.ch),I(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){L(e.cm,e.first,e.first-t,t);for(var n=e.cm.display,r=n.viewFrom;r<n.viewTo;r++)fr(e.cm,r,"gutter")}}function eo(e,t,n,r){if(e.cm&&!e.cm.curOp)return P(e.cm,eo)(e,t,n,r);if(t.to.line<e.first)Ji(e,t.text.length-1-(t.to.line-t.from.line));else if(!(t.from.line>e.lastLine())){t.from.line<e.first&&(Ji(e,i=t.text.length-1-(e.first-t.from.line)),t={from:I(e.first,0),to:I(t.to.line+i,t.to.ch),text:[F(t.text)],origin:t.origin});var i=e.lastLine();if((t=t.to.line>i?{from:t.from,to:I(i,O(e,i).text.length),text:[t.text[0]],origin:t.origin}:t).removed=ht(e,t.from,t.to),n=n||mi(e,t),e.cm){var i=e.cm,o=t,s=r,a=i.doc,l=i.display,u=o.from,c=o.to,d=!1,h=u.line,f=(i.options.lineWrapping||(h=A(Zt(O(a,u.line))),a.iter(h,c.line+1,function(e){if(e==l.maxLine)return d=!0})),-1<a.sel.contains(o.from,o.to)&&We(i),Ci(a,o,s,ur(i)),i.options.lineWrapping||(a.iter(h,u.line+o.text.length,function(e){var t=nn(e);t>l.maxLineLength&&(l.maxLine=e,l.maxLineLength=t,l.maxLineChanged=!0,d=!1)}),d&&(i.curOp.updateMaxLine=!0)),a),p=u.line;if(f.modeFrontier=Math.min(f.modeFrontier,p),!(f.highlightFrontier<p-10)){for(var g=f.first,m=p-1;g<m;m--){var y=O(f,m).stateAfter;if(y&&(!(y instanceof Tt)||m+y.lookAhead<p)){g=m+1;break}}f.highlightFrontier=Math.min(f.highlightFrontier,g)}Xr(i,400),s=o.text.length-(c.line-u.line)-1,o.full?L(i):u.line!=c.line||1!=o.text.length||Ei(i.doc,o)?L(i,u.line,c.line+1,s):fr(i,u.line,"text"),h=$e(i,"changes"),((a=$e(i,"change"))||h)&&(s={from:u,to:c,text:o.text,removed:o.removed,origin:o.origin},a&&D(i,"change",i,s),h)&&(i.curOp.changeObjs||(i.curOp.changeObjs=[])).push(s),i.display.selForContextMenu=null}else Ci(e,t,r);Vi(e,n,fe),e.cantEdit&&Gi(e,I(e.firstLine(),0))&&(e.cantEdit=!1)}}function to(e,t,n,r,i){var o;M(r=r||n,n)<0&&(n=(o=[r,n])[0],r=o[1]),"string"==typeof t&&(t=e.splitLines(t)),qi(e,{from:n,to:r,text:t,origin:i})}function no(e,t,n,r){n<e.line?e.line+=r:t<e.line&&(e.line=t,e.ch=0)}function ro(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i],s=!0;if(o.ranges){o.copied||((o=e[i]=o.deepCopy()).copied=!0);for(var a=0;a<o.ranges.length;a++)no(o.ranges[a].anchor,t,n,r),no(o.ranges[a].head,t,n,r)}else{for(var l=0;l<o.changes.length;++l){var u=o.changes[l];if(n<u.from.line)u.from=I(u.from.line+r,u.from.ch),u.to=I(u.to.line+r,u.to.ch);else if(t<=u.to.line){s=!1;break}}s||(e.splice(0,i+1),i=0)}}}function io(e,t){var n=t.from.line,r=t.to.line,t=t.text.length-(r-n)-1;ro(e.done,n,r,t),ro(e.undone,n,r,t)}function oo(e,t,n,r){var i=t,o=t;return"number"==typeof t?o=O(e,wt(e,t)):i=A(t),null==i?null:(r(o,i)&&e.cm&&fr(e.cm,i,n),o)}function so(e){this.lines=e,this.parent=null;for(var t=0,n=0;n<e.length;++n)e[n].parent=this,t+=e[n].height;this.height=t}function ao(e){this.children=e;for(var t=0,n=0,r=0;r<e.length;++r){var i=e[r];t+=i.chunkSize(),n+=i.height,i.parent=this}this.size=t,this.height=n,this.parent=null}H.prototype.from=function(){return Ct(this.anchor,this.head)},H.prototype.to=function(){return Et(this.anchor,this.head)},H.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},so.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n,r=e,i=e+t;r<i;++r){var o=this.lines[r];this.height-=o.height,(n=o).parent=null,Wt(n),D(o,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var r=0;r<t.length;++r)t[r].parent=this},iterN:function(e,t,n){for(var r=e+t;e<r;++e)if(n(this.lines[e]))return!0}},ao.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var n,r=0;r<this.children.length;++r){var i=this.children[r],o=i.chunkSize();if(e<o){var s=Math.min(t,o-e),a=i.height;if(i.removeInner(e,s),this.height-=a-i.height,o==s&&(this.children.splice(r--,1),i.parent=null),0==(t-=s))break;e=0}else e-=o}this.size-t<25&&(1<this.children.length||!(this.children[0]instanceof so))&&(this.collapse(n=[]),this.children=[new so(n)],this.children[0].parent=this)},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){this.size+=t.length,this.height+=n;for(var r=0;r<this.children.length;++r){var i=this.children[r],o=i.chunkSize();if(e<=o){if(i.insertInner(e,t,n),i.lines&&50<i.lines.length){for(var s=i.lines.length%25+25,a=s;a<i.lines.length;){var l=new so(i.lines.slice(a,a+=25));i.height-=l.height,this.children.splice(++r,0,l),l.parent=this}i.lines=i.lines.slice(0,s),this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t,n=new ao(e.children.splice(e.children.length-5,5))}while(e.parent?(e.size-=n.size,e.height-=n.height,t=w(e.parent.children,e),e.parent.children.splice(t+1,0,n)):(((t=new ao(e.children)).parent=e).children=[t,n],e=t),n.parent=e.parent,10<e.children.length);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var r=0;r<this.children.length;++r){var i=this.children[r],o=i.chunkSize();if(e<o){var s=Math.min(t,o-e);if(i.iterN(e,s,n))return!0;if(0==(t-=s))break;e=0}else e-=o}}};function lo(e,t,n){if(n)for(var r in n)n.hasOwnProperty(r)&&(this[r]=n[r]);this.doc=e,this.node=t}function uo(e,t,n){tn(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&Or(e,n)}lo.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,n=this.line,r=A(n);if(null!=r&&t){for(var i=0;i<t.length;++i)t[i]==this&&t.splice(i--,1);t.length||(n.widgets=null);var o=Rn(this);pt(n,Math.max(0,n.height-o)),e&&(d(e,function(){uo(e,n,-o),fr(e,r,"widget")}),D(e,"lineWidgetCleared",e,this,r))}},lo.prototype.changed=function(){var e=this,t=this.height,n=this.doc.cm,r=this.line,i=(this.height=null,Rn(this)-t);i&&(en(this.doc,r)||pt(r,r.height+i),n)&&d(n,function(){n.curOp.forceUpdate=!0,uo(n,r,i),D(n,"lineWidgetChanged",n,e,A(r))})},je(lo);function co(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++ho}var ho=0;function fo(t,n,r,e,i){if(e&&e.shared)return f=t,o=n,s=r,l=i,(a=le(a=e)).shared=!1,u=[fo(f,o,s,a,l)],c=u[0],d=a.widgetNode,wi(f,function(e){d&&(a.widgetNode=d.cloneNode(!0)),u.push(fo(e,k(e,o),k(e,s),a,l));for(var t=0;t<e.linked.length;++t)if(e.linked[t].isParent)return;c=F(u)}),new po(u,c);var o,s,a,l,u,c,d;if(t.cm&&!t.cm.curOp)return P(t.cm,fo)(t,n,r,e,i);var h=new co(t,i),f=M(n,r);if(e&&le(e,h,!1),!(0<f||0==f&&!1!==h.clearWhenEmpty)){if(h.replacedWith&&(h.collapsed=!0,h.widgetNode=ee("span",[h.replacedWith],"CodeMirror-widget"),e.handleMouseEvents||h.widgetNode.setAttribute("cm-ignore-events","true"),e.insertLeft)&&(h.widgetNode.insertLeft=!0),h.collapsed){if(qt(t,n.line,n,r,h)||n.line!=r.line&&qt(t,r.line,n,r,h))throw new Error("Inserting collapsed marker partially overlapping an existing one");Ft=!0}h.addToHistory&&Ni(t,{from:n,to:r,origin:"markText"},t.sel,NaN);var p,g=n.line,m=t.cm;if(t.iter(g,r.line+1,function(e){var t;m&&h.collapsed&&!m.options.lineWrapping&&Zt(e)==m.display.maxLine&&(p=!0),h.collapsed&&g!=n.line&&pt(e,0),e=e,t=new Bt(h,g==n.line?n.ch:null,g==r.line?r.ch:null),e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e),++g}),h.collapsed&&t.iter(n.line,r.line+1,function(e){en(t,e)&&pt(e,0)}),h.clearOnEnter&&S(h,"beforeCursorEnter",function(){return h.clear()}),h.readOnly&&(Pt=!0,t.history.done.length||t.history.undone.length)&&t.clearHistory(),h.collapsed&&(h.id=++ho,h.atomic=!0),m){if(p&&(m.curOp.updateMaxLine=!0),h.collapsed)L(m,n.line,r.line+1);else if(h.className||h.startStyle||h.endStyle||h.css||h.attributes||h.title)for(var y=n.line;y<=r.line;y++)fr(m,y,"text");h.atomic&&$i(m.doc),D(m,"markerAdded",m,h)}}return h}co.prototype.clear=function(){if(!this.explicitlyCleared){for(var e,t=this.doc.cm,n=t&&!t.curOp,r=(n&&Gr(t),$e(this,"clear")&&(e=this.find())&&D(this,"clear",e.from,e.to),null),i=null,o=0;o<this.lines.length;++o){var s=this.lines[o],a=Ht(s.markedSpans,this);t&&!this.collapsed?fr(t,A(s),"text"):t&&(null!=a.to&&(i=A(s)),null!=a.from)&&(r=A(s)),s.markedSpans=function(e,t){for(var n,r=0;r<e.length;++r)e[r]!=t&&(n=n||[]).push(e[r]);return n}(s.markedSpans,a),null==a.from&&this.collapsed&&!en(this.doc,s)&&t&&pt(s,or(t.display))}if(t&&this.collapsed&&!t.options.lineWrapping)for(var l=0;l<this.lines.length;++l){var u=Zt(this.lines[l]),c=nn(u);c>t.display.maxLineLength&&(t.display.maxLine=u,t.display.maxLineLength=c,t.display.maxLineChanged=!0)}null!=r&&t&&this.collapsed&&L(t,r,i+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,t)&&$i(t.doc),t&&D(t,"markerCleared",t,this,r,i),n&&Yr(t),this.parent&&this.parent.clear()}},co.prototype.find=function(e,t){var n,r;null==e&&"bookmark"==this.type&&(e=1);for(var i=0;i<this.lines.length;++i){var o=this.lines[i],s=Ht(o.markedSpans,this);if(null!=s.from&&(n=I(t?o:A(o),s.from),-1==e))return n;if(null!=s.to&&(r=I(t?o:A(o),s.to),1==e))return r}return n&&{from:n,to:r}},co.prototype.changed=function(){var n=this,r=this.find(-1,!0),i=this,o=this.doc.cm;r&&o&&d(o,function(){var e=r.line,t=A(r.line),t=Ln(o,t);t&&(Vn(t),o.curOp.selectionChanged=o.curOp.forceUpdate=!0),o.curOp.updateMaxLine=!0,!en(i.doc,e)&&null!=i.height&&(t=i.height,i.height=null,t=Rn(i)-t)&&pt(e,e.height+t),D(o,"markerChanged",o,n)})},co.prototype.attachLine=function(e){var t;this.lines.length||!this.doc.cm||(t=this.doc.cm.curOp).maybeHiddenMarkers&&-1!=w(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this),this.lines.push(e)},co.prototype.detachLine=function(e){this.lines.splice(w(this.lines,e),1),!this.lines.length&&this.doc.cm&&((e=this.doc.cm.curOp).maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this)},je(co);var po=function(e,t){this.markers=e,this.primary=t;for(var n=0;n<e.length;++n)e[n].parent=this};function go(e){return e.findMarks(I(e.first,0),e.clipPos(I(e.lastLine())),function(e){return e.parent})}function mo(o){for(var e=0;e<o.length;e++)!function(e){var t=o[e],n=[t.primary.doc];wi(t.primary.doc,function(e){return n.push(e)});for(var r=0;r<t.markers.length;r++){var i=t.markers[r];-1==w(n,i.doc)&&(i.parent=null,t.markers.splice(r--,1))}}(e)}po.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();D(this,"clear")}},po.prototype.find=function(e,t){return this.primary.find(e,t)},je(po);function p(e,t,n,r,i){if(!(this instanceof p))return new p(e,t,n,r,i);null==n&&(n=0),ao.call(this,[new so([new on("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,n=I(this.modeFrontier=this.highlightFrontier=n,0),this.sel=fi(n),this.history=new Ri(null),this.id=++yo,this.modeOption=t,this.lineSep=r,this.direction="rtl"==i?"rtl":"ltr",this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),Ci(this,{from:n,to:n,text:e}),U(this,fi(n),fe)}var yo=0,vo=((p.prototype=Ce(ao.prototype,{constructor:p,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,r=0;r<t.length;++r)n+=t[r].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=ft(this,this.first,this.first+this.size);return!1===e?t:t.join(e||this.lineSeparator())},setValue:r(function(e){var t=I(this.first,0),n=this.first+this.size-1;qi(this,{from:t,to:I(n,O(this,n).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&Mr(this.cm,0,0),U(this,fi(t),fe)}),replaceRange:function(e,t,n,r){to(this,e,t=k(this,t),n=n?k(this,n):t,r)},getRange:function(e,t,n){e=ht(this,k(this,e),k(this,t));return!1===n?e:e.join(n||this.lineSeparator())},getLine:function(e){e=this.getLineHandle(e);return e&&e.text},getLineHandle:function(e){if(mt(this,e))return O(this,e)},getLineNumber:A,getLineHandleVisualStart:function(e){return Zt(e="number"==typeof e?O(this,e):e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return k(this,e)},getCursor:function(e){var t=this.sel.primary(),e=null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||"to"==e||!1===e?t.to():t.from();return e},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:r(function(e,t,n){Hi(this,k(this,"number"==typeof e?I(e,t||0):e),null,n)}),setSelection:r(function(e,t,n){Hi(this,k(this,e),k(this,t||e),n)}),extendSelection:r(function(e,t,n){Pi(this,k(this,e),t&&k(this,t),n)}),extendSelections:r(function(e,t){Fi(this,St(this,e),t)}),extendSelectionsBy:r(function(e,t){Fi(this,St(this,be(this.sel.ranges,e)),t)}),setSelections:r(function(e,t,n){if(e.length){for(var r=[],i=0;i<e.length;i++)r[i]=new H(k(this,e[i].anchor),k(this,e[i].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),U(this,hi(this.cm,r,t),n)}}),addSelection:r(function(e,t,n){var r=this.sel.ranges.slice(0);r.push(new H(k(this,e),k(this,t||e))),U(this,hi(this.cm,r,r.length-1),n)}),getSelection:function(e){for(var t=this.sel.ranges,n=0;n<t.length;n++)var r=ht(this,t[n].from(),t[n].to()),i=i?i.concat(r):r;return!1===e?i:i.join(e||this.lineSeparator())},getSelections:function(e){for(var t=[],n=this.sel.ranges,r=0;r<n.length;r++){var i=ht(this,n[r].from(),n[r].to());!1!==e&&(i=i.join(e||this.lineSeparator())),t[r]=i}return t},replaceSelection:function(e,t,n){for(var r=[],i=0;i<this.sel.ranges.length;i++)r[i]=e;this.replaceSelections(r,t,n||"+input")},replaceSelections:r(function(e,t,n){for(var r=[],i=this.sel,o=0;o<i.ranges.length;o++){var s=i.ranges[o];r[o]={from:s.from(),to:s.to(),text:this.splitLines(e[o]),origin:n}}for(var t=t&&"end"!=t&&function(e,t,n){for(var r=[],i=u=I(e.first,0),o=0;o<t.length;o++){var s=t[o],a=yi(s.from,u,i),l=yi(pi(s),u,i),u=s.to,i=l;"around"==n?(s=M((s=e.sel.ranges[o]).head,s.anchor)<0,r[o]=new H(s?l:a,s?a:l)):r[o]=new H(a,a)}return new B(r,e.sel.primIndex)}(this,r,t),a=r.length-1;0<=a;a--)qi(this,r[a]);t?Ui(this,t):this.cm&&Ir(this.cm)}),undo:r(function(){Qi(this,"undo")}),redo:r(function(){Qi(this,"redo")}),undoSelection:r(function(){Qi(this,"undo",!0)}),redoSelection:r(function(){Qi(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,n=0,r=0;r<e.done.length;r++)e.done[r].ranges||++t;for(var i=0;i<e.undone.length;i++)e.undone[i].ranges||++n;return{undo:t,redo:n}},clearHistory:function(){this.history=new Ri(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Di(this.history.done),undone:Di(this.history.undone)}},setHistory:function(e){var t=this.history=new Ri(this.history.maxGeneration);t.done=Di(e.done.slice(0),null,!0),t.undone=Di(e.undone.slice(0),null,!0)},setGutterMarker:r(function(e,n,r){return oo(this,e,"gutter",function(e){var t=e.gutterMarkers||(e.gutterMarkers={});return!(t[n]=r)&&Re(t)&&(e.gutterMarkers=null),1})}),clearGutter:r(function(t){var n=this;this.iter(function(e){e.gutterMarkers&&e.gutterMarkers[t]&&oo(n,e,"gutter",function(){return e.gutterMarkers[t]=null,Re(e.gutterMarkers)&&(e.gutterMarkers=null),1})})}),lineInfo:function(e){var t;if("number"==typeof e){if(!mt(this,e))return null;if(!(e=O(this,t=e)))return null}else if(null==(t=A(e)))return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:r(function(e,n,r){return oo(this,e,"gutter"==n?"gutter":"class",function(e){var t="text"==n?"textClass":"background"==n?"bgClass":"gutter"==n?"gutterClass":"wrapClass";if(e[t]){if(Z(r).test(e[t]))return;e[t]+=" "+r}else e[t]=r;return 1})}),removeLineClass:r(function(e,o,s){return oo(this,e,"gutter"==o?"gutter":"class",function(e){var t="text"==o?"textClass":"background"==o?"bgClass":"gutter"==o?"gutterClass":"wrapClass",n=e[t];if(n){if(null==s)e[t]=null;else{var r=n.match(Z(s));if(!r)return;var i=r.index+r[0].length;e[t]=n.slice(0,r.index)+(r.index&&i!=n.length?" ":"")+n.slice(i)||null}return 1}})}),addLineWidget:r(function(e,t,n){return e=e,i=new lo(r=this,t,n),(o=r.cm)&&i.noHScroll&&(o.display.alignWidgets=!0),oo(r,e,"widget",function(e){var t=e.widgets||(e.widgets=[]);return null==i.insertAt?t.push(i):t.splice(Math.min(t.length-1,Math.max(0,i.insertAt)),0,i),i.line=e,o&&!en(r,e)&&(t=tn(e)<r.scrollTop,pt(e,e.height+Rn(i)),t&&Or(o,i.height),o.curOp.forceUpdate=!0),1}),o&&D(o,"lineWidgetAdded",o,i,"number"==typeof e?e:A(e)),i;var r,i,o}),removeLineWidget:function(e){e.clear()},markText:function(e,t,n){return fo(this,k(this,e),k(this,t),n,n&&n.type||"range")},setBookmark:function(e,t){t={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return fo(this,e=k(this,e),e,t,"bookmark")},findMarksAt:function(e){var t=[],n=O(this,(e=k(this,e)).line).markedSpans;if(n)for(var r=0;r<n.length;++r){var i=n[r];(null==i.from||i.from<=e.ch)&&(null==i.to||i.to>=e.ch)&&t.push(i.marker.parent||i.marker)}return t},findMarks:function(i,o,s){i=k(this,i),o=k(this,o);var a=[],l=i.line;return this.iter(i.line,o.line+1,function(e){var t=e.markedSpans;if(t)for(var n=0;n<t.length;n++){var r=t[n];null!=r.to&&l==i.line&&i.ch>=r.to||null==r.from&&l!=i.line||null!=r.from&&l==o.line&&r.from>=o.ch||s&&!s(r.marker)||a.push(r.marker.parent||r.marker)}++l}),a},getAllMarks:function(){var r=[];return this.iter(function(e){var t=e.markedSpans;if(t)for(var n=0;n<t.length;++n)null!=t[n].from&&r.push(t[n].marker)}),r},posFromIndex:function(t){var n,r=this.first,i=this.lineSeparator().length;return this.iter(function(e){e=e.text.length+i;if(t<e)return n=t,!0;t-=e,++r}),k(this,I(r,n))},indexFromPos:function(e){var t,n=(e=k(this,e)).ch;return e.line<this.first||e.ch<0?0:(t=this.lineSeparator().length,this.iter(this.first,e.line,function(e){n+=e.text.length+t}),n)},copy:function(e){var t=new p(ft(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){for(var t=this.first,n=this.first+this.size,n=(null!=(e=e||{}).from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to),new p(ft(this,t,n),e.mode||this.modeOption,t,this.lineSep,this.direction)),r=(e.sharedHist&&(n.history=this.history),(this.linked||(this.linked=[])).push({doc:n,sharedHist:e.sharedHist}),n.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],n),i=go(this),o=0;o<i.length;o++){var s=i[o],a=s.find(),l=r.clipPos(a.from),a=r.clipPos(a.to);M(l,a)&&(l=fo(r,l,a,s.primary,s.primary.type),s.markers.push(l),l.parent=s)}return n},unlinkDoc:function(e){if(e instanceof m&&(e=e.doc),this.linked)for(var t=0;t<this.linked.length;++t){var n=this.linked[t];if(n.doc==e){this.linked.splice(t,1),e.unlinkDoc(this),mo(go(this));break}}var r;e.history==this.history&&(r=[e.id],wi(e,function(e){return r.push(e.id)},!0),e.history=new Ri(null),e.history.done=Di(this.history.done,r),e.history.undone=Di(this.history.undone,r))},iterLinkedDocs:function(e){wi(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):Je(e)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:r(function(e){var t;(e="rtl"!=e?"ltr":e)!=this.direction&&(this.direction=e,this.iter(function(e){return e.order=null}),this.cm)&&d(t=this.cm,function(){Ti(t),L(t)})})})).eachLine=p.prototype.iter,0);function bo(e){var r=this;if(Eo(r),!x(r,e)&&!An(r.display,e)){R(e),y&&(vo=+new Date);var i=dr(r,e,!0),t=e.dataTransfer.files;if(i&&!r.isReadOnly())if(t&&t.length&&window.FileReader&&window.File)for(var o=t.length,s=Array(o),a=0,n=0;n<o;++n)!function(e,t){var n;r.options.allowDropFileTypes&&-1==w(r.options.allowDropFileTypes,e.type)||((n=new FileReader).onload=P(r,function(){var e=n.result;/[\x00-\x08\x0e-\x1f]{2}/.test(e)&&(e=""),s[t]=e,++a==o&&(e={from:i=k(r.doc,i),to:i,text:r.doc.splitLines(s.join(r.doc.lineSeparator())),origin:"paste"},qi(r.doc,e),Ui(r.doc,fi(i,pi(e))))}),n.readAsText(e))}(t[n],n);else if(r.state.draggingText&&-1<r.doc.sel.contains(i))r.state.draggingText(e),setTimeout(function(){return r.display.input.focus()},20);else try{var l,u=e.dataTransfer.getData("Text");if(u){if(r.state.draggingText&&!r.state.draggingText.copy&&(l=r.listSelections()),Vi(r.doc,fi(i,i)),l)for(var c=0;c<l.length;++c)to(r.doc,"",l[c].anchor,l[c].head,"drag");r.replaceSelection(u,"around","paste"),r.display.input.focus()}}catch(e){}}}function Eo(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function Co(t){if(document.getElementsByClassName){for(var e=document.getElementsByClassName("CodeMirror"),n=[],r=0;r<e.length;r++){var i=e[r].CodeMirror;i&&n.push(i)}n.length&&n[0].operation(function(){for(var e=0;e<n.length;e++)t(n[e])})}}var wo=!1;function So(){var e;wo||(S(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,Co(To)},100))}),S(window,"blur",function(){return Co(Rr)}),wo=!0)}function To(e){var t=e.display;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize()}for(var Ro={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Ao=0;Ao<10;Ao++)Ro[Ao+48]=Ro[Ao+96]=String(Ao);for(var _o=65;_o<=90;_o++)Ro[_o]=String.fromCharCode(_o);for(var No=1;No<=12;No++)Ro[No+111]=Ro[No+63235]="F"+No;var xo={};function Oo(e){var t,n,r,i,o=e.split(/-(?!$)/);e=o[o.length-1];for(var s=0;s<o.length-1;s++){var a=o[s];if(/^(cmd|meta|m)$/i.test(a))i=!0;else if(/^a(lt)?$/i.test(a))t=!0;else if(/^(c|ctrl|control)$/i.test(a))n=!0;else{if(!/^s(hift)?$/i.test(a))throw new Error("Unrecognized modifier name: "+a);r=!0}}return t&&(e="Alt-"+e),n&&(e="Ctrl-"+e),i&&(e="Cmd-"+e),e=r?"Shift-"+e:e}function Io(e){var t,n,r={};for(t in e)if(e.hasOwnProperty(t)){var i=e[t];if(!/^(name|fallthrough|(de|at)tach)$/.test(t)){if("..."!=i)for(var o=be(t.split(" "),Oo),s=0;s<o.length;s++){var a=void 0,l=void 0,a=s==o.length-1?(l=o.join(" "),i):(l=o.slice(0,s+1).join(" "),"..."),u=r[l];if(u){if(u!=a)throw new Error("Inconsistent bindings for "+l)}else r[l]=a}delete e[t]}}for(n in r)e[n]=r[n];return e}function Mo(e,t,n,r){var i=(t=Po(t)).call?t.call(e,r):t[e];if(!1===i)return"nothing";if("..."===i)return"multi";if(null!=i&&n(i))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return Mo(e,t.fallthrough,n,r);for(var o=0;o<t.fallthrough.length;o++){var s=Mo(e,t.fallthrough[o],n,r);if(s)return s}}}function ko(e){e="string"==typeof e?e:Ro[e.keyCode];return"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e}function Do(e,t,n){var r=e;return t.altKey&&"Alt"!=r&&(e="Alt-"+e),(K?t.metaKey:t.ctrlKey)&&"Ctrl"!=r&&(e="Ctrl-"+e),(K?t.ctrlKey:t.metaKey)&&"Cmd"!=r&&(e="Cmd-"+e),e=!n&&t.shiftKey&&"Shift"!=r?"Shift-"+e:e}function Lo(e,t){var n;return!(W&&34==e.keyCode&&e.char||null==(n=Ro[e.keyCode])||e.altGraphKey)&&Do(n=3==e.keyCode&&e.code?e.code:n,e,t)}function Po(e){return"string"==typeof e?xo[e]:e}function Fo(t,e){for(var n=t.doc.sel.ranges,r=[],i=0;i<n.length;i++){for(var o=e(n[i]);r.length&&M(o.from,F(r).to)<=0;){var s=r.pop();if(M(s.from,o.from)<0){o.from=s.from;break}}r.push(o)}d(t,function(){for(var e=r.length-1;0<=e;e--)to(t.doc,"",r[e].from,r[e].to,"+delete");Ir(t)})}function Bo(e,t,n){t=Ne(e.text,t+n,n);return t<0||t>e.text.length?null:t}function Ho(e,t,n){e=Bo(e,t.ch,n);return null==e?null:new I(t.line,e,n<0?"after":"before")}function Uo(e,t,n,r,i){if(e){var o,s,a,l,e=He(n,t.doc.direction);if(e)return o=i<0==(1==(e=i<0?F(e):e[0]).level)?"after":"before",0<e.level||"rtl"==t.doc.direction?(s=Pn(t,n),a=i<0?n.text.length-1:0,l=Fn(t,s,a).top,a=xe(function(e){return Fn(t,s,e).top==l},i<0==(1==e.level)?e.from:e.to-1,a),"before"==o&&(a=Bo(n,a,1))):a=i<0?e.to:e.from,new I(r,a,o)}return new I(r,i<0?n.text.length:0,i<0?"before":"after")}function Vo(t,n,a,e){var l=He(n,t.doc.direction);if(!l)return Ho(n,a,e);a.ch>=n.text.length?(a.ch=n.text.length,a.sticky="before"):a.ch<=0&&(a.ch=0,a.sticky="after");var r=Ie(l,a.ch,a.sticky),i=l[r];if("ltr"==t.doc.direction&&i.level%2==0&&(0<e?i.to>a.ch:i.from<a.ch))return Ho(n,a,e);function u(e,t){return Bo(n,e instanceof I?e.ch:e,t)}function o(e){return t.options.lineWrapping?(s=s||Pn(t,n),tr(t,n,s,e)):{begin:0,end:n.text.length}}var s,c=o("before"==a.sticky?u(a,-1):a.ch);if("rtl"==t.doc.direction||1==i.level){var d=1==i.level==e<0,h=u(a,d?1:-1);if(null!=h&&(d?h<=i.to&&h<=c.end:h>=i.from&&h>=c.begin))return new I(a.line,h,d?"before":"after")}function f(e,t,n){for(var r=function(e,t){return t?new I(a.line,u(e,1),"before"):new I(a.line,e,"after")};0<=e&&e<l.length;e+=t){var i=l[e],o=0<t==(1!=i.level),s=o?n.begin:u(n.end,-1);if(i.from<=s&&s<i.to)return r(s,o);if(s=o?i.from:u(i.to,-1),n.begin<=s&&s<n.end)return r(s,o)}}i=f(r+e,e,c);return i||(null==(h=0<e?c.end:u(c.begin,-1))||0<e&&h==n.text.length||!(i=f(0<e?0:l.length-1,e,o(h)))?null:i)}xo.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},xo.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},xo.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},xo.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},xo.default=C?xo.macDefault:xo.pcDefault;var Wo={selectAll:Xi,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),fe)},killLine:function(n){return Fo(n,function(e){var t;return e.empty()?(t=O(n.doc,e.head.line).text.length,e.head.ch==t&&e.head.line<n.lastLine()?{from:e.head,to:I(e.head.line+1,0)}:{from:e.head,to:I(e.head.line,t)}):{from:e.from(),to:e.to()}})},deleteLine:function(t){return Fo(t,function(e){return{from:I(e.from().line,0),to:k(t.doc,I(e.to().line+1,0))}})},delLineLeft:function(e){return Fo(e,function(e){return{from:I(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(n){return Fo(n,function(e){var t=n.charCoords(e.head,"div").top+5;return{from:n.coordsChar({left:0,top:t},"div"),to:e.from()}})},delWrappedLineRight:function(n){return Fo(n,function(e){var t=n.charCoords(e.head,"div").top+5,t=n.coordsChar({left:n.display.lineDiv.offsetWidth+100,top:t},"div");return{from:e.from(),to:t}})},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(I(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(I(e.lastLine()))},goLineStart:function(t){return t.extendSelectionsBy(function(e){return $o(t,e.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(t){return t.extendSelectionsBy(function(e){return jo(t,e.head)},{origin:"+move",bias:1})},goLineEnd:function(i){return i.extendSelectionsBy(function(e){var t=i,e=e.head.line,n=O(t.doc,e),r=function(e){for(var t;t=Kt(e);)e=t.find(1,!0).line;return e}(n);return r!=n&&(e=A(r)),Uo(!0,t,n,e,-1)},{origin:"+move",bias:-1})},goLineRight:function(t){return t.extendSelectionsBy(function(e){e=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:e},"div")},ge)},goLineLeft:function(t){return t.extendSelectionsBy(function(e){e=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:0,top:e},"div")},ge)},goLineLeftSmart:function(n){return n.extendSelectionsBy(function(e){var t=n.cursorCoords(e.head,"div").top+5,t=n.coordsChar({left:0,top:t},"div");return t.ch<n.getLine(t.line).search(/\S/)?jo(n,e.head):t},ge)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"char")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("\t")},insertSoftTab:function(e){for(var t=[],n=e.listSelections(),r=e.options.tabSize,i=0;i<n.length;i++){var o=n[i].from(),o=ue(e.getLine(o.line),o.ch,r);t.push(ve(r-o%r))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(s){return d(s,function(){for(var e,t,n,r=s.listSelections(),i=[],o=0;o<r.length;o++)r[o].empty()&&(e=r[o].head,(t=O(s.doc,e.line).text)&&(0<(e=e.ch==t.length?new I(e.line,e.ch-1):e).ch?(e=new I(e.line,e.ch+1),s.replaceRange(t.charAt(e.ch-1)+t.charAt(e.ch-2),I(e.line,e.ch-2),e,"+transpose")):e.line>s.doc.first&&(n=O(s.doc,e.line-1).text)&&(e=new I(e.line,1),s.replaceRange(t.charAt(0)+s.doc.lineSeparator()+n.charAt(n.length-1),I(e.line-1,n.length-1),e,"+transpose"))),i.push(new H(e,e)));s.setSelections(i)})},newlineAndIndent:function(r){return d(r,function(){for(var e=(t=r.listSelections()).length-1;0<=e;e--)r.replaceRange(r.doc.lineSeparator(),t[e].anchor,t[e].head,"+input");for(var t=r.listSelections(),n=0;n<t.length;n++)r.indentLine(t[n].from().line,null,!0);Ir(r)})},openLine:function(e){return e.replaceSelection("\n","start")},toggleOverwrite:function(e){return e.toggleOverwrite()}};function $o(e,t){var n=O(e.doc,t),r=Zt(n);return Uo(!0,e,r,t=r!=n?A(r):t,1)}function jo(e,t){var n=$o(e,t.line),r=O(e.doc,n.line),e=He(r,e.doc.direction);return e&&0!=e[0].level?n:(e=Math.max(0,r.text.search(/\S/)),r=t.line==n.line&&t.ch<=e&&t.ch,I(n.line,r?0:e,n.sticky))}function zo(e,t,n){if("string"==typeof t&&!(t=Wo[t]))return!1;e.display.input.ensurePolled();var r=e.display.shift,i=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),n&&(e.display.shift=!1),i=t(e)!=he}finally{e.display.shift=r,e.state.suppressEdits=!1}return i}var Go=new ce;function Yo(e,t,n,r){var i=e.state.keySeq;if(i){if(ko(t))return"handled";if(/\'$/.test(t)?e.state.keySeq=null:Go.set(50,function(){e.state.keySeq==i&&(e.state.keySeq=null,e.display.input.reset())}),Xo(e,i+" "+t,n,r))return!0}return Xo(e,t,n,r)}function Xo(e,t,n,r){r=function(e,t,n){for(var r=0;r<e.state.keyMaps.length;r++){var i=Mo(t,e.state.keyMaps[r],n,e);if(i)return i}return e.options.extraKeys&&Mo(t,e.options.extraKeys,n,e)||Mo(t,e.options.keyMap,n,e)}(e,t,r);return"multi"==r&&(e.state.keySeq=t),"handled"==r&&D(e,"keyHandled",e,t,n),"handled"!=r&&"multi"!=r||(R(n),Cr(e)),!!r}function Ko(t,e){var n=Lo(e,!0);return!!n&&(e.shiftKey&&!t.state.keySeq?Yo(t,"Shift-"+n,e,function(e){return zo(t,e,!0)})||Yo(t,n,e,function(e){if("string"==typeof e?/^go[A-Z]/.test(e):e.motion)return zo(t,e)}):Yo(t,n,e,function(e){return zo(t,e)}))}var qo=null;function Zo(e){var t,n,r;function i(e){18!=e.keyCode&&e.altKey||(Q(r,"CodeMirror-crosshair"),T(document,"keyup",i),T(document,"mouseover",i))}this.curOp.focus=ne(),x(this,e)||(y&&v<11&&27==e.keyCode&&(e.returnValue=!1),t=e.keyCode,this.display.shift=16==t||e.shiftKey,n=Ko(this,e),W&&(qo=n?t:null,!n)&&88==t&&!tt&&(C?e.metaKey:e.ctrlKey)&&this.replaceSelection("",null,"cut"),V&&!C&&!n&&46==t&&e.shiftKey&&!e.ctrlKey&&document.execCommand&&document.execCommand("cut"),18!=t)||/\bCodeMirror-crosshair\b/.test(this.display.lineDiv.className)||(re(r=this.display.lineDiv,"CodeMirror-crosshair"),S(document,"keyup",i),S(document,"mouseover",i))}function Qo(e){16==e.keyCode&&(this.doc.sel.shift=!1),x(this,e)}function Jo(e){var t,n,r;An(this.display,e)||x(this,e)||e.ctrlKey&&!e.altKey||C&&e.metaKey||(n=e.keyCode,t=e.charCode,W&&n==qo?(qo=null,R(e)):W&&(!e.which||e.which<10)&&Ko(this,e)||"\b"==(n=String.fromCharCode(null==t?n:t))||Yo(r=this,"'"+n+"'",e,function(e){return zo(r,e,!0)})||this.display.input.onKeyPress(e))}function es(e,t,n){this.time=e,this.pos=t,this.button=n}var ts,ns;function rs(e){var t,n,r,i,o,s,a,l,u,c=this,d=c.display;x(c,e)||d.activeTouch&&d.input.supportsTouch()||(d.input.ensurePolled(),d.shift=e.shiftKey,An(d,e)?E||(d.scroller.draggable=!1,setTimeout(function(){return d.scroller.draggable=!0},100)):ss(c,e)||(t=dr(c,e),n=Ke(e),r=t?(i=t,o=n,r=+new Date,ns&&ns.compare(r,i,o)?(ts=ns=null,"triple"):ts&&ts.compare(r,i,o)?(ns=new es(r,i,o),ts=null,"double"):(ts=new es(r,i,o),ns=null,"single")):"single",window.focus(),1==n&&c.state.selectingText&&c.state.selectingText(e),t&&function(n,e,r,t,i){var o="Click";"double"==t?o="Double"+o:"triple"==t&&(o="Triple"+o);return Yo(n,Do(o=(1==e?"Left":2==e?"Middle":"Right")+o,i),i,function(e){if(!(e="string"==typeof e?Wo[e]:e))return!1;var t=!1;try{n.isReadOnly()&&(n.state.suppressEdits=!0),t=e(n,r)!=he}finally{n.state.suppressEdits=!1}return t})}(c,n,t,r,e))||(1==n?t?(i=c,o=t,s=r,a=e,y?setTimeout(ae(wr,i),0):i.curOp.focus=ne(),l=function(e,t,n){var r=e.getOption("configureMouse"),r=r?r(e,t,n):{};{var i;null==r.unit&&(i=X?n.shiftKey&&n.metaKey:n.altKey,r.unit=i?"rectangle":"single"==t?"char":"double"==t?"word":"line")}null!=r.extend&&!e.doc.extend||(r.extend=e.doc.extend||n.shiftKey);null==r.addNew&&(r.addNew=C?n.metaKey:n.ctrlKey);null==r.moveOnDrag&&(r.moveOnDrag=!(C?n.altKey:n.ctrlKey));return r}(i,s,a),u=i.doc.sel,(i.options.dragDrop&&Qe&&!i.isReadOnly()&&"single"==s&&-1<(s=u.contains(o))&&(M((s=u.ranges[s]).from(),o)<0||0<o.xRel)&&(0<M(s.to(),o)||o.xRel<0)?function(t,n,r,i){var o=t.display,s=!1,a=P(t,function(e){E&&(o.scroller.draggable=!1),t.state.draggingText=!1,T(o.wrapper.ownerDocument,"mouseup",a),T(o.wrapper.ownerDocument,"mousemove",l),T(o.scroller,"dragstart",u),T(o.scroller,"drop",a),s||(R(e),i.addNew||Pi(t.doc,r,null,null,i.extend),E||y&&9==v?setTimeout(function(){o.wrapper.ownerDocument.body.focus(),o.input.focus()},20):o.input.focus())}),l=function(e){s=s||10<=Math.abs(n.clientX-e.clientX)+Math.abs(n.clientY-e.clientY)},u=function(){return s=!0};E&&(o.scroller.draggable=!0);(t.state.draggingText=a).copy=!i.moveOnDrag,o.scroller.dragDrop&&o.scroller.dragDrop();S(o.wrapper.ownerDocument,"mouseup",a),S(o.wrapper.ownerDocument,"mousemove",l),S(o.scroller,"dragstart",u),S(o.scroller,"drop",a),Sr(t),setTimeout(function(){return o.input.focus()},20)}:function(h,e,f,p){var s=h.display,g=h.doc;R(e);var m,y,v=g.sel,t=v.ranges;p.addNew&&!p.extend?(y=g.sel.contains(f),m=-1<y?t[y]:new H(f,f)):(m=g.sel.primary(),y=g.sel.primIndex);"rectangle"==p.unit?(p.addNew||(m=new H(f,f)),f=dr(h,e,!0,!0),y=-1):(e=is(h,f,p.unit),m=p.extend?Li(m,e.anchor,e.head,p.extend):e);p.addNew?-1==y?(y=t.length,U(g,hi(h,t.concat([m]),y),{scroll:!1,origin:"*mouse"})):1<t.length&&t[y].empty()&&"char"==p.unit&&!p.extend?(U(g,hi(h,t.slice(0,y).concat(t.slice(y+1)),0),{scroll:!1,origin:"*mouse"}),v=g.sel):Bi(g,y,m,pe):(U(g,new B([m],y=0),pe),v=g.sel);var b=f;function a(e){if(0!=M(b,e))if(b=e,"rectangle"==p.unit){for(var t=[],n=h.options.tabSize,r=ue(O(g,f.line).text,f.ch,n),i=ue(O(g,e.line).text,e.ch,n),o=Math.min(r,i),s=Math.max(r,i),a=Math.min(f.line,e.line),l=Math.min(h.lastLine(),Math.max(f.line,e.line));a<=l;a++){var u=O(g,a).text,c=me(u,o,n);o==s?t.push(new H(I(a,c),I(a,c))):u.length>c&&t.push(new H(I(a,c),I(a,me(u,s,n))))}t.length||t.push(new H(f,f)),U(g,hi(h,v.ranges.slice(0,y).concat(t),y),{origin:"*mouse",scroll:!1}),h.scrollIntoView(e)}else{var d,r=m,i=is(h,e,p.unit),e=r.anchor,e=0<M(i.anchor,e)?(d=i.head,Ct(r.from(),i.anchor)):(d=i.anchor,Et(r.to(),i.head)),r=v.ranges.slice(0);r[y]=function(e,t){var n=t.anchor,r=t.head,i=O(e.doc,n.line);if(0==M(n,r)&&n.sticky==r.sticky)return t;i=He(i);if(!i)return t;var o=Ie(i,n.ch,n.sticky),s=i[o];if(s.from!=n.ch&&s.to!=n.ch)return t;var a=o+(s.from==n.ch==(1!=s.level)?0:1);if(0==a||a==i.length)return t;s=r.line!=n.line?0<(r.line-n.line)*("ltr"==e.doc.direction?1:-1):(e=Ie(i,r.ch,r.sticky),o=e-o||(r.ch-n.ch)*(1==s.level?-1:1),e==a-1||e==a?o<0:0<o);e=i[a+(s?-1:0)],o=s==(1==e.level),i=o?e.from:e.to,a=o?"after":"before";return n.ch==i&&n.sticky==a?t:new H(new I(n.line,i,a),r)}(h,new H(k(g,e),d)),U(g,hi(h,r,y),pe)}}var l=s.wrapper.getBoundingClientRect(),u=0;function n(e){h.state.selectingText=!1,u=1/0,e&&(R(e),s.input.focus()),T(s.wrapper.ownerDocument,"mousemove",r),T(s.wrapper.ownerDocument,"mouseup",i),g.history.lastSelOrigin=null}var r=P(h,function(e){(0!==e.buttons&&Ke(e)?function e(t){var n,r,i=++u,o=dr(h,t,!0,"rectangle"==p.unit);o&&(0!=M(o,b)?(h.curOp.focus=ne(),a(o),n=Nr(s,g),(o.line>=n.to||o.line<n.from)&&setTimeout(P(h,function(){u==i&&e(t)}),150)):(r=t.clientY<l.top?-20:t.clientY>l.bottom?20:0)&&setTimeout(P(h,function(){u==i&&(s.scroller.scrollTop+=r,e(t))}),50))}:n)(e)}),i=P(h,n);h.state.selectingText=i,S(s.wrapper.ownerDocument,"mousemove",r),S(s.wrapper.ownerDocument,"mouseup",i)})(i,a,o,l)):Xe(e)==d.scroller&&R(e):2==n?(t&&Pi(c.doc,t),setTimeout(function(){return d.input.focus()},20)):3==n&&(q?c.display.input.onContextMenu(e):Sr(c))))}function is(e,t,n){return"char"==n?new H(t,t):"word"==n?e.findWordAt(t):"line"==n?new H(I(t.line,0),k(e.doc,I(t.line+1,0))):(n=n(e,t),new H(n.from,n.to))}function os(e,t,n,r){var i,o;if(t.touches)i=t.touches[0].clientX,o=t.touches[0].clientY;else try{i=t.clientX,o=t.clientY}catch(t){return!1}if(i>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;r&&R(t);var s=e.display,r=s.lineDiv.getBoundingClientRect();if(o>r.bottom||!$e(e,n))return Ge(t);o-=r.top-s.viewOffset;for(var a=0;a<e.display.gutterSpecs.length;++a){var l=s.gutters.childNodes[a];if(l&&l.getBoundingClientRect().right>=i)return N(e,n,e,gt(e.doc,o),e.display.gutterSpecs[a].className,t),Ge(t)}}function ss(e,t){return os(e,t,"gutterClick",!0)}function as(e,t){var n,r;An(e.display,t)||(r=t,$e(n=e,"gutterContextMenu")&&os(n,r,"gutterContextMenu",!1))||(x(e,t,"contextmenu")||q||e.display.input.onContextMenu(t))}function ls(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),$n(e)}es.prototype.compare=function(e,t,n){return this.time+400>e&&0==M(t,this.pos)&&n==this.button};var us={toString:function(){return"CodeMirror.Init"}},cs={},ds={};function hs(e,t,n){!t!=!(n&&n!=us)&&(n=e.display.dragFunctions,(t=t?S:T)(e.display.scroller,"dragstart",n.start),t(e.display.scroller,"dragenter",n.enter),t(e.display.scroller,"dragover",n.over),t(e.display.scroller,"dragleave",n.leave),t(e.display.scroller,"drop",n.drop))}function fs(e){e.options.lineWrapping?(re(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(Q(e.display.wrapper,"CodeMirror-wrap"),rn(e)),cr(e),L(e),$n(e),setTimeout(function(){return Vr(e)},100)}function m(e,t){var n=this;if(!(this instanceof m))return new m(e,t);this.options=t=t?le(t):{},le(cs,t,!1);var r,i=t.value,o=("string"==typeof i?i=new p(i,t.mode,null,t.lineSeparator,t.direction):t.mode&&(i.modeOption=t.mode),this.doc=i,new m.inputStyles[t.inputStyle](this)),e=this.display=new ai(e,i,o,t),s=(ls(e.wrapper.CodeMirror=this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),jr(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new ce,keySeq:null,specialChars:null},t.autofocus&&!Y&&e.input.focus(),y&&v<11&&setTimeout(function(){return n.display.input.reset(!0)},20),this),a=s.display;S(a.scroller,"mousedown",P(s,rs)),S(a.scroller,"dblclick",y&&v<11?P(s,function(e){var t;x(s,e)||!(t=dr(s,e))||ss(s,e)||An(s.display,e)||(R(e),e=s.findWordAt(t),Pi(s.doc,e.anchor,e.head))}):function(e){return x(s,e)||R(e)}),S(a.scroller,"contextmenu",function(e){return as(s,e)});var l,u={end:0};function c(){a.activeTouch&&(l=setTimeout(function(){return a.activeTouch=null},1e3),(u=a.activeTouch).end=+new Date)}function d(e,t){var n;return null==t.left||400<(n=t.left-e.left)*n+(n=t.top-e.top)*n}S(a.scroller,"touchstart",function(e){var t;x(s,e)||function(e){if(1==e.touches.length)return(e=e.touches[0]).radiusX<=1&&e.radiusY<=1}(e)||ss(s,e)||(a.input.ensurePolled(),clearTimeout(l),t=+new Date,a.activeTouch={start:t,moved:!1,prev:t-u.end<=300?u:null},1==e.touches.length&&(a.activeTouch.left=e.touches[0].pageX,a.activeTouch.top=e.touches[0].pageY))}),S(a.scroller,"touchmove",function(){a.activeTouch&&(a.activeTouch.moved=!0)}),S(a.scroller,"touchend",function(e){var t,n=a.activeTouch;n&&!An(a,e)&&null!=n.left&&!n.moved&&new Date-n.start<300&&(t=s.coordsChar(a.activeTouch,"page"),n=!n.prev||d(n,n.prev)?new H(t,t):!n.prev.prev||d(n,n.prev.prev)?s.findWordAt(t):new H(I(t.line,0),k(s.doc,I(t.line+1,0))),s.setSelection(n.anchor,n.head),s.focus(),R(e)),c()}),S(a.scroller,"touchcancel",c),S(a.scroller,"scroll",function(){a.scroller.clientHeight&&(Lr(s,a.scroller.scrollTop),Fr(s,a.scroller.scrollLeft,!0),N(s,"scroll",s))}),S(a.scroller,"mousewheel",function(e){return di(s,e)}),S(a.scroller,"DOMMouseScroll",function(e){return di(s,e)}),S(a.wrapper,"scroll",function(){return a.wrapper.scrollTop=a.wrapper.scrollLeft=0}),a.dragFunctions={enter:function(e){x(s,e)||Ye(e)},over:function(e){var t,n;x(s,e)||((n=dr(t=s,n=e))&&(br(t,n,n=document.createDocumentFragment()),t.display.dragCursor||(t.display.dragCursor=_("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),t.display.lineSpace.insertBefore(t.display.dragCursor,t.display.cursorDiv)),b(t.display.dragCursor,n)),Ye(e))},start:function(e){var t,n;t=s,e=e,y&&(!t.state.draggingText||+new Date-vo<100)?Ye(e):x(t,e)||An(t.display,e)||(e.dataTransfer.setData("Text",t.getSelection()),e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setDragImage&&!$&&((n=_("img",null,null,"position: fixed; left: 0; top: 0;")).src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",W&&(n.width=n.height=1,t.display.wrapper.appendChild(n),n._top=n.offsetTop),e.dataTransfer.setDragImage(n,0,0),W)&&n.parentNode.removeChild(n))},drop:P(s,bo),leave:function(e){x(s,e)||Eo(s)}};o=a.input.getField();for(r in S(o,"keyup",function(e){return Qo.call(s,e)}),S(o,"keydown",P(s,Zo)),S(o,"keypress",P(s,Jo)),S(o,"focus",function(e){return Tr(s,e)}),S(o,"blur",function(e){return Rr(s,e)}),So(),Gr(this),this.curOp.forceUpdate=!0,Si(this,i),t.autofocus&&!Y||this.hasFocus()?setTimeout(ae(Tr,this),20):Rr(this),ds)ds.hasOwnProperty(r)&&ds[r](this,t[r],us);ri(this),t.finishInit&&t.finishInit(this);for(var h=0;h<ps.length;++h)ps[h](this);Yr(this),E&&t.lineWrapping&&"optimizelegibility"==getComputedStyle(e.lineDiv).textRendering&&(e.lineDiv.style.textRendering="auto")}m.defaults=cs,m.optionHandlers=ds;var ps=[];function gs(e,t,n,r){var i,o=e.doc,s=("smart"==(n=null==n?"add":n)&&(o.mode.indent?i=Nt(e,t).state:n="prev"),e.options.tabSize),a=O(o,t),l=ue(a.text,null,s),u=(a.stateAfter&&(a.stateAfter=null),a.text.match(/^\s*/)[0]);if(r||/\S/.test(a.text)){if("smart"==n&&((c=o.mode.indent(i,a.text.slice(u.length),a.text))==he||150<c)){if(!r)return;n="prev"}}else c=0,n="not";"prev"==n?c=t>o.first?ue(O(o,t-1).text,null,s):0:"add"==n?c=l+e.options.indentUnit:"subtract"==n?c=l-e.options.indentUnit:"number"==typeof n&&(c=l+n);var c=Math.max(0,c),d="",h=0;if(e.options.indentWithTabs)for(var f=Math.floor(c/s);f;--f)h+=s,d+="\t";if(h<c&&(d+=ve(c-h)),d!=u)return to(o,d,I(t,0),I(t,u.length),"+input"),!(a.stateAfter=null);for(var p=0;p<o.sel.ranges.length;p++){var g=o.sel.ranges[p];if(g.head.line==t&&g.head.ch<u.length){g=I(t,u.length);Bi(o,p,new H(g,g));break}}}m.defineInitHook=function(e){return ps.push(e)};var ms=null;function ys(e){ms=e}function vs(e,t,n,r,i){var o=e.doc,s=(e.display.shift=!1,r=r||o.sel,+new Date-200),a="paste"==i||e.state.pasteIncoming>s,l=Je(t),u=null;if(a&&1<r.ranges.length)if(ms&&ms.text.join("\n")==t){if(r.ranges.length%ms.text.length==0)for(var u=[],c=0;c<ms.text.length;c++)u.push(o.splitLines(ms.text[c]))}else l.length==r.ranges.length&&e.options.pasteLinesPerSelection&&(u=be(l,function(e){return[e]}));for(var d=e.curOp.updateInput,h=r.ranges.length-1;0<=h;h--){var f=r.ranges[h],p=f.from(),g=f.to(),f=(f.empty()&&(n&&0<n?p=I(p.line,p.ch-n):e.state.overwrite&&!a?g=I(g.line,Math.min(O(o,g.line).text.length,g.ch+F(l).length)):a&&ms&&ms.lineWise&&ms.text.join("\n")==t&&(p=g=I(p.line,0))),{from:p,to:g,text:u?u[h%u.length]:l,origin:i||(a?"paste":e.state.cutIncoming>s?"cut":"+input")});qi(e.doc,f),D(e,"inputRead",e,f)}t&&!a&&Es(e,t),Ir(e),e.curOp.updateInput<2&&(e.curOp.updateInput=d),e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=-1}function bs(e,t){var n=e.clipboardData&&e.clipboardData.getData("Text");return n&&(e.preventDefault(),t.isReadOnly()||t.options.disableInput||d(t,function(){return vs(t,n,0,null,"paste")}),1)}function Es(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var n=e.doc.sel,r=n.ranges.length-1;0<=r;r--){var i=n.ranges[r];if(!(100<i.head.ch||r&&n.ranges[r-1].head.line==i.head.line)){var o=e.getModeAt(i.head),s=!1;if(o.electricChars){for(var a=0;a<o.electricChars.length;a++)if(-1<t.indexOf(o.electricChars.charAt(a))){s=gs(e,i.head.line,"smart");break}}else o.electricInput&&o.electricInput.test(O(e.doc,i.head.line).text.slice(0,i.head.ch))&&(s=gs(e,i.head.line,"smart"));s&&D(e,"electricInput",e,i.head.line)}}}function Cs(e){for(var t=[],n=[],r=0;r<e.doc.sel.ranges.length;r++){var i=e.doc.sel.ranges[r].head.line,i={anchor:I(i,0),head:I(i+1,0)};n.push(i),t.push(e.getRange(i.anchor,i.head))}return{text:t,ranges:n}}function ws(e,t,n,r){e.setAttribute("autocorrect",n?"":"off"),e.setAttribute("autocapitalize",r?"":"off"),e.setAttribute("spellcheck",!!t)}function Ss(){var e=_("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),t=_("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return E?e.style.width="1000px":e.setAttribute("wrap","off"),z&&(e.style.border="1px solid black"),ws(e),t}function Ts(n,r,i,e,o){var t=r,s=i,a=O(n,r.line);function l(e){var t=o?Vo(n.cm,a,r,i):Ho(a,r,i);if(null==t){if(e||(e=r.line+i)<n.first||e>=n.first+n.size||(r=new I(e,r.ch,r.sticky),!(a=O(n,e))))return;r=Uo(o,n.cm,a,r.line,i)}else r=t;return 1}if("char"==e)l();else if("column"==e)l(!0);else if("word"==e||"group"==e)for(var u=null,c="group"==e,d=n.cm&&n.cm.getHelper(r,"wordChars"),h=!0;!(i<0)||l(!h);h=!1){var f=a.text.charAt(r.ch)||"\n",f=Te(f,d)?"w":c&&"\n"==f?"n":!c||/\s/.test(f)?null:"p";if(c&&!h&&(f=f||"s"),u&&u!=f){i<0&&(i=1,l(),r.sticky="after");break}if(f&&(u=f),0<i&&!l(!h))break}e=Gi(n,r,t,s,!0);return vt(t,e)&&(e.hitSide=!0),e}function Rs(e,t,n,r){var i,o,s,a=e.doc,l=t.left;for("page"==r?(i=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),i=Math.max(i-.5*or(e.display),3),o=(0<n?t.bottom:t.top)+n*i):"line"==r&&(o=0<n?t.bottom+3:t.top-3);(s=Jn(e,l,o)).outside;){if(n<0?o<=0:o>=a.height){s.hitSide=!0;break}o+=5*n}return s}function i(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new ce,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null}function As(e,t){var n,r,i=Ln(e,t.line);return!i||i.hidden?null:(n=kn(i,i=O(e.doc,t.line),t.line),r="left",(i=He(i,e.doc.direction))&&(r=Ie(i,t.ch)%2?"right":"left"),(e=Un(n.map,t.ch,r)).offset="right"==e.collapse?e.end:e.start,e)}function _s(e,t){return t&&(e.bad=!0),e}function Ns(e,t,n){var r;if(t==e.display.lineDiv){if(!(r=e.display.lineDiv.childNodes[n]))return _s(e.clipPos(I(e.display.viewTo-1)),!0);t=null,n=0}else for(r=t;;r=r.parentNode){if(!r||r==e.display.lineDiv)return null;if(r.parentNode&&r.parentNode==e.display.lineDiv)break}for(var i=0;i<e.display.view.length;i++){var o=e.display.view[i];if(o.node==r){var u=o,o=t,s=n,a=u.text.firstChild,l=!1;if(!o||!te(a,o))return _s(I(A(u.line),0),!0);if(o==a)if(l=!0,o=a.childNodes[s],s=0,!o)return _s(I(A(c=u.rest?F(u.rest):u.line),c.text.length),l);var c=3==o.nodeType?o:null,d=o;for(c||1!=o.childNodes.length||3!=o.firstChild.nodeType||(c=o.firstChild,s=s&&c.nodeValue.length);d.parentNode!=a;)d=d.parentNode;var h=u.measure,f=h.maps;function p(e,t,n){for(var r=-1;r<(f?f.length:0);r++)for(var i=r<0?h.map:f[r],o=0;o<i.length;o+=3){var s,a,l=i[o+2];if(l==e||l==t)return s=A(r<0?u.line:u.rest[r]),a=i[o]+n,I(s,a=n<0||l!=e?i[o+(n?1:0)]:a)}}var g=p(c,d,s);if(g)return _s(g,l);for(var m=d.nextSibling,y=c?c.nodeValue.length-s:0;m;m=m.nextSibling){if(g=p(m,m.firstChild,0))return _s(I(g.line,g.ch-y),l);y+=m.textContent.length}for(var v=d.previousSibling,b=s;v;v=v.previousSibling){if(g=p(v,v.firstChild,-1))return _s(I(g.line,g.ch+b),l);b+=v.textContent.length}return}}}i.prototype.init=function(e){var t=this,o=this,s=o.cm,a=o.div=e.lineDiv;function n(e){if(!x(s,e)){if(s.somethingSelected())ys({lineWise:!1,text:s.getSelections()}),"cut"==e.type&&s.replaceSelection("",null,"cut");else{if(!s.options.lineWiseCopyCut)return;var t=Cs(s);ys({lineWise:!0,text:t.text}),"cut"==e.type&&s.operation(function(){s.setSelections(t.ranges,0,fe),s.replaceSelection("",null,"cut")})}if(e.clipboardData){e.clipboardData.clearData();var n=ms.text.join("\n");if(e.clipboardData.setData("Text",n),e.clipboardData.getData("Text")==n)return void e.preventDefault()}var r=Ss(),n=r.firstChild,i=(s.display.lineSpace.insertBefore(r,s.display.lineSpace.firstChild),n.value=ms.text.join("\n"),document.activeElement);se(n),setTimeout(function(){s.display.lineSpace.removeChild(r),i.focus(),i==a&&o.showPrimarySelection()},50)}}ws(a,s.options.spellcheck,s.options.autocorrect,s.options.autocapitalize),S(a,"paste",function(e){x(s,e)||bs(e,s)||v<=11&&setTimeout(P(s,function(){return t.updateFromDOM()}),20)}),S(a,"compositionstart",function(e){t.composing={data:e.data,done:!1}}),S(a,"compositionupdate",function(e){t.composing||(t.composing={data:e.data,done:!1})}),S(a,"compositionend",function(e){t.composing&&(e.data!=t.composing.data&&t.readFromDOMSoon(),t.composing.done=!0)}),S(a,"touchstart",function(){return o.forceCompositionEnd()}),S(a,"input",function(){t.composing||t.readFromDOMSoon()}),S(a,"copy",n),S(a,"cut",n)},i.prototype.prepareSelection=function(){var e=vr(this.cm,!1);return e.focus=this.cm.state.focused,e},i.prototype.showSelection=function(e,t){e&&this.cm.display.view.length&&((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},i.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},i.prototype.showPrimarySelection=function(){var e=this.getSelection(),t=this.cm,n=t.doc.sel.primary(),r=n.from(),n=n.to();if(t.display.viewTo==t.display.viewFrom||r.line>=t.display.viewTo||n.line<t.display.viewFrom)e.removeAllRanges();else{var i=Ns(t,e.anchorNode,e.anchorOffset),o=Ns(t,e.focusNode,e.focusOffset);if(!i||i.bad||!o||o.bad||0!=M(Ct(i,o),r)||0!=M(Et(i,o),n)){var i=t.display.view,o=r.line>=t.display.viewFrom&&As(t,r)||{node:i[0].measure.map[2],offset:0},r=n.line<t.display.viewTo&&As(t,n);if(r||(r={node:(i=(n=i[i.length-1].measure).maps?n.maps[n.maps.length-1]:n.map)[i.length-1],offset:i[i.length-2]-i[i.length-3]}),o&&r){var s,n=e.rangeCount&&e.getRangeAt(0);try{s=oe(o.node,o.offset,r.offset,r.node)}catch(e){}s&&(!V&&t.state.focused&&(e.collapse(o.node,o.offset),s.collapsed)||(e.removeAllRanges(),e.addRange(s)),n&&null==e.anchorNode?e.addRange(n):V&&this.startGracePeriod()),this.rememberSelection()}else e.removeAllRanges()}}},i.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){return e.cm.curOp.selectionChanged=!0})},20)},i.prototype.showMultipleSelections=function(e){b(this.cm.display.cursorDiv,e.cursors),b(this.cm.display.selectionDiv,e.selection)},i.prototype.rememberSelection=function(){var e=this.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},i.prototype.selectionInEditor=function(){var e=this.getSelection();return!!e.rangeCount&&(e=e.getRangeAt(0).commonAncestorContainer,te(this.div,e))},i.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()||this.showSelection(this.prepareSelection(),!0),this.div.focus())},i.prototype.blur=function(){this.div.blur()},i.prototype.getField=function(){return this.div},i.prototype.supportsTouch=function(){return!0},i.prototype.receivedFocus=function(){var t=this;this.selectionInEditor()?this.pollSelection():d(this.cm,function(){return t.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,function e(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,e))})},i.prototype.selectionChanged=function(){var e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},i.prototype.pollSelection=function(){var e,t,n,r;null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()&&(e=this.getSelection(),t=this.cm,G&&c&&this.cm.display.gutterSpecs.length&&function(e){for(var t=e;t;t=t.parentNode)if(/CodeMirror-gutter-wrapper/.test(t.className))return 1;return}(e.anchorNode)?(this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),this.focus()):this.composing||(this.rememberSelection(),n=Ns(t,e.anchorNode,e.anchorOffset),r=Ns(t,e.focusNode,e.focusOffset),n&&r&&d(t,function(){U(t.doc,fi(n,r),fe),(n.bad||r.bad)&&(t.curOp.selectionChanged=!0)})))},i.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e,t=this.cm,n=t.display,r=t.doc.sel.primary(),i=r.from(),r=r.to();if(0==i.ch&&i.line>t.firstLine()&&(i=I(i.line-1,O(t.doc,i.line-1).length)),r.ch==O(t.doc,r.line).text.length&&r.line<t.lastLine()&&(r=I(r.line+1,0)),i.line<n.viewFrom||r.line>n.viewTo-1)return!1;var o,s=i.line==n.viewFrom||0==(s=hr(t,i.line))?(e=A(n.view[0].line),n.view[0].node):(e=A(n.view[s].line),n.view[s-1].node.nextSibling),r=hr(t,r.line),n=r==n.view.length-1?(o=n.viewTo-1,n.lineDiv.lastChild):(o=A(n.view[r+1].line)-1,n.view[r+1].node.previousSibling);if(!s)return!1;for(var a=t.doc.splitLines(function(o,e,t,s,a){var n="",l=!1,u=o.doc.lineSeparator(),c=!1;function d(){l&&(n+=u,c&&(n+=u),l=c=!1)}function h(e){e&&(d(),n+=e)}for(;!function e(t){if(1==t.nodeType){var n=t.getAttribute("cm-text");if(n)h(n);else if(n=t.getAttribute("cm-marker"))(n=o.findMarks(I(s,0),I(a+1,0),(i=+n,function(e){return e.id==i}))).length&&(n=n[0].find(0))&&h(ht(o.doc,n.from,n.to).join(u));else if("false"!=t.getAttribute("contenteditable")&&(n=/^(pre|div|p|li|table|br)$/i.test(t.nodeName),/^br$/i.test(t.nodeName)||0!=t.textContent.length)){n&&d();for(var r=0;r<t.childNodes.length;r++)e(t.childNodes[r]);/^(pre|p)$/i.test(t.nodeName)&&(c=!0),n&&(l=!0)}}else 3==t.nodeType&&h(t.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "));var i}(e),e!=t;)e=e.nextSibling,c=!1;return n}(t,s,n,e,o)),l=ht(t.doc,I(e,0),I(o,O(t.doc,o).text.length));1<a.length&&1<l.length;)if(F(a)==F(l))a.pop(),l.pop(),o--;else{if(a[0]!=l[0])break;a.shift(),l.shift(),e++}for(var u=0,c=0,d=a[0],h=l[0],f=Math.min(d.length,h.length);u<f&&d.charCodeAt(u)==h.charCodeAt(u);)++u;for(var p=F(a),g=F(l),m=Math.min(p.length-(1==a.length?u:0),g.length-(1==l.length?u:0));c<m&&p.charCodeAt(p.length-c-1)==g.charCodeAt(g.length-c-1);)++c;if(1==a.length&&1==l.length&&e==i.line)for(;u&&u>i.ch&&p.charCodeAt(p.length-c-1)==g.charCodeAt(g.length-c-1);)u--,c++;a[a.length-1]=p.slice(0,p.length-c).replace(/^\u200b+/,""),a[0]=a[0].slice(u).replace(/\u200b+$/,"");r=I(e,u),s=I(o,l.length?F(l).length-c:0);return 1<a.length||a[0]||M(r,s)?(to(t.doc,a,r,s,"+input"),!0):void 0},i.prototype.ensurePolled=function(){this.forceCompositionEnd()},i.prototype.reset=function(){this.forceCompositionEnd()},i.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},i.prototype.readFromDOMSoon=function(){var e=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){if(e.readDOMTimeout=null,e.composing){if(!e.composing.done)return;e.composing=null}e.updateFromDOM()},80))},i.prototype.updateFromDOM=function(){var e=this;!this.cm.isReadOnly()&&this.pollContent()||d(this.cm,function(){return L(e.cm)})},i.prototype.setUneditable=function(e){e.contentEditable="false"},i.prototype.onKeyPress=function(e){0==e.charCode||this.composing||(e.preventDefault(),this.cm.isReadOnly())||P(this.cm,vs)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0)},i.prototype.readOnlyChanged=function(e){this.div.contentEditable=String("nocursor"!=e)},i.prototype.onContextMenu=function(){},i.prototype.resetPosition=function(){},i.prototype.needsContentAttribute=!0;function o(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new ce,this.hasSelection=!1,this.composing=null}var xs,Os,Is,Ms,ks;function s(e,t,r,n){xs.defaults[e]=t,r&&(Os[e]=n?function(e,t,n){n!=us&&r(e,t,n)}:r)}o.prototype.init=function(n){var e=this,r=this,i=this.cm,o=(this.createField(n),this.textarea);function t(e){if(!x(i,e)){if(i.somethingSelected())ys({lineWise:!1,text:i.getSelections()});else{if(!i.options.lineWiseCopyCut)return;var t=Cs(i);ys({lineWise:!0,text:t.text}),"cut"==e.type?i.setSelections(t.ranges,null,fe):(r.prevInput="",o.value=t.text.join("\n"),se(o))}"cut"==e.type&&(i.state.cutIncoming=+new Date)}}n.wrapper.insertBefore(this.wrapper,n.wrapper.firstChild),z&&(o.style.width="0px"),S(o,"input",function(){y&&9<=v&&e.hasSelection&&(e.hasSelection=null),r.poll()}),S(o,"paste",function(e){x(i,e)||bs(e,i)||(i.state.pasteIncoming=+new Date,r.fastPoll())}),S(o,"cut",t),S(o,"copy",t),S(n.scroller,"paste",function(e){var t;An(n,e)||x(i,e)||(o.dispatchEvent?((t=new Event("paste")).clipboardData=e.clipboardData,o.dispatchEvent(t)):(i.state.pasteIncoming=+new Date,r.focus()))}),S(n.lineSpace,"selectstart",function(e){An(n,e)||R(e)}),S(o,"compositionstart",function(){var e=i.getCursor("from");r.composing&&r.composing.range.clear(),r.composing={start:e,range:i.markText(e,i.getCursor("to"),{className:"CodeMirror-composing"})}}),S(o,"compositionend",function(){r.composing&&(r.poll(),r.composing.range.clear(),r.composing=null)})},o.prototype.createField=function(e){this.wrapper=Ss(),this.textarea=this.wrapper.firstChild},o.prototype.prepareSelection=function(){var e,t=this.cm,n=t.display,r=t.doc,i=vr(t);return t.options.moveInputWithCursor&&(t=qn(t,r.sel.primary().head,"div"),r=n.wrapper.getBoundingClientRect(),e=n.lineDiv.getBoundingClientRect(),i.teTop=Math.max(0,Math.min(n.wrapper.clientHeight-10,t.top+e.top-r.top)),i.teLeft=Math.max(0,Math.min(n.wrapper.clientWidth-10,t.left+e.left-r.left))),i},o.prototype.showSelection=function(e){var t=this.cm.display;b(t.cursorDiv,e.cursors),b(t.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},o.prototype.reset=function(e){var t,n;this.contextMenuPending||this.composing||((t=this.cm).somethingSelected()?(this.prevInput="",n=t.getSelection(),this.textarea.value=n,t.state.focused&&se(this.textarea),y&&9<=v&&(this.hasSelection=n)):e||(this.prevInput=this.textarea.value="",y&&9<=v&&(this.hasSelection=null)))},o.prototype.getField=function(){return this.textarea},o.prototype.supportsTouch=function(){return!1},o.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!Y||ne()!=this.textarea))try{this.textarea.focus()}catch(e){}},o.prototype.blur=function(){this.textarea.blur()},o.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},o.prototype.receivedFocus=function(){this.slowPoll()},o.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},o.prototype.fastPoll=function(){var t=!1,n=this;n.pollingFast=!0,n.polling.set(20,function e(){n.poll()||t?(n.pollingFast=!1,n.slowPoll()):(t=!0,n.polling.set(60,e))})},o.prototype.poll=function(){var e=this,t=this.cm,n=this.textarea,r=this.prevInput;if(this.contextMenuPending||!t.state.focused||et(n)&&!r&&!this.composing||t.isReadOnly()||t.options.disableInput||t.state.keySeq)return!1;var i=n.value;if(i==r&&!t.somethingSelected())return!1;if(y&&9<=v&&this.hasSelection===i||C&&/[\uf700-\uf7ff]/.test(i))return t.display.input.reset(),!1;if(t.doc.sel==t.display.selForContextMenu){var o=i.charCodeAt(0);if(8203==o&&(r=r||"​"),8666==o)return this.reset(),this.cm.execCommand("undo")}for(var s=0,a=Math.min(r.length,i.length);s<a&&r.charCodeAt(s)==i.charCodeAt(s);)++s;return d(t,function(){vs(t,i.slice(s),r.length-s,null,e.composing?"*compose":null),1e3<i.length||-1<i.indexOf("\n")?n.value=e.prevInput="":e.prevInput=i,e.composing&&(e.composing.range.clear(),e.composing.range=t.markText(e.composing.start,t.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},o.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},o.prototype.onKeyPress=function(){y&&9<=v&&(this.hasSelection=null),this.fastPoll()},o.prototype.onContextMenu=function(e){var n,r,t,i,o=this,s=o.cm,a=s.display,l=o.textarea,u=(o.contextMenuPending&&o.contextMenuPending(),dr(s,e)),c=a.scroller.scrollTop;function d(){var e,t;null!=l.selectionStart&&(t="​"+((e=s.somethingSelected())?l.value:""),l.value="⇚",l.value=t,o.prevInput=e?"":"​",l.selectionStart=1,l.selectionEnd=t.length,a.selForContextMenu=s.doc.sel)}function h(){var e,t;o.contextMenuPending==h&&(o.contextMenuPending=!1,o.wrapper.style.cssText=r,l.style.cssText=n,y&&v<9&&a.scrollbars.setScrollTop(a.scroller.scrollTop=c),null!=l.selectionStart)&&((!y||v<9)&&d(),e=0,t=function(){a.selForContextMenu==s.doc.sel&&0==l.selectionStart&&0<l.selectionEnd&&"​"==o.prevInput?P(s,Xi)(s):e++<10?a.detectingSelectAll=setTimeout(t,500):(a.selForContextMenu=null,a.input.reset())},a.detectingSelectAll=setTimeout(t,200))}u&&!W&&(s.options.resetSelectionOnContextMenu&&-1==s.doc.sel.contains(u)&&P(s,U)(s.doc,fi(u),fe),n=l.style.cssText,r=o.wrapper.style.cssText,u=o.wrapper.offsetParent.getBoundingClientRect(),o.wrapper.style.cssText="position: static",l.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(e.clientY-u.top-5)+"px; left: "+(e.clientX-u.left-5)+"px;\n      z-index: 1000; background: "+(y?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",E&&(t=window.scrollY),a.input.focus(),E&&window.scrollTo(null,t),a.input.reset(),s.somethingSelected()||(l.value=o.prevInput=" "),o.contextMenuPending=h,a.selForContextMenu=s.doc.sel,clearTimeout(a.detectingSelectAll),y&&9<=v&&d(),q?(Ye(e),i=function(){T(window,"mouseup",i),setTimeout(h,20)},S(window,"mouseup",i)):setTimeout(h,50))},o.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled="nocursor"==e},o.prototype.setUneditable=function(){},o.prototype.needsContentAttribute=!1,Os=(xs=m).optionHandlers,xs.defineOption=s,xs.Init=us,s("value","",function(e,t){return e.setValue(t)},!0),s("mode",null,function(e,t){e.doc.modeOption=t,vi(e)},!0),s("indentUnit",2,vi,!0),s("indentWithTabs",!1),s("smartIndent",!0),s("tabSize",4,function(e){bi(e),$n(e),L(e)},!0),s("lineSeparator",null,function(e,r){if(e.doc.lineSep=r){var i=[],o=e.doc.first;e.doc.iter(function(e){for(var t=0;;){var n=e.text.indexOf(r,t);if(-1==n)break;t=n+r.length,i.push(I(o,n))}o++});for(var t=i.length-1;0<=t;t--)to(e.doc,r,i[t],I(i[t].line,i[t].ch+r.length))}}),s("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,function(e,t,n){e.state.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g"),n!=us&&e.refresh()}),s("specialCharPlaceholder",cn,function(e){return e.refresh()},!0),s("electricChars",!0),s("inputStyle",Y?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),s("spellcheck",!1,function(e,t){return e.getInputField().spellcheck=t},!0),s("autocorrect",!1,function(e,t){return e.getInputField().autocorrect=t},!0),s("autocapitalize",!1,function(e,t){return e.getInputField().autocapitalize=t},!0),s("rtlMoveVisually",!l),s("wholeLineUpdateBefore",!0),s("theme","default",function(e){ls(e),si(e)},!0),s("keyMap","default",function(e,t,n){t=Po(t),n=n!=us&&Po(n);n&&n.detach&&n.detach(e,t),t.attach&&t.attach(e,n||null)}),s("extraKeys",null),s("configureMouse",null),s("lineWrapping",!1,fs,!0),s("gutters",[],function(e,t){e.display.gutterSpecs=ii(t,e.options.lineNumbers),si(e)},!0),s("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?lr(e.display)+"px":"0",e.refresh()},!0),s("coverGutterNextToScrollbar",!1,function(e){return Vr(e)},!0),s("scrollbarStyle","native",function(e){jr(e),Vr(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),s("lineNumbers",!1,function(e,t){e.display.gutterSpecs=ii(e.options.gutters,t),si(e)},!0),s("firstLineNumber",1,si,!0),s("lineNumberFormatter",function(e){return e},si,!0),s("showCursorWhenSelecting",!1,yr,!0),s("resetSelectionOnContextMenu",!0),s("lineWiseCopyCut",!0),s("pasteLinesPerSelection",!0),s("selectionsMayTouch",!1),s("readOnly",!1,function(e,t){"nocursor"==t&&(Rr(e),e.display.input.blur()),e.display.input.readOnlyChanged(t)}),s("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),s("dragDrop",!0,hs),s("allowDropFileTypes",null),s("cursorBlinkRate",530),s("cursorScrollMargin",0),s("cursorHeight",1,yr,!0),s("singleCursorHeightPerLine",!0,yr,!0),s("workTime",100),s("workDelay",100),s("flattenSpans",!0,bi,!0),s("addModeClass",!1,bi,!0),s("pollInterval",100),s("undoDepth",200,function(e,t){return e.doc.history.undoDepth=t}),s("historyEventDelay",1250),s("viewportMargin",10,function(e){return e.refresh()},!0),s("maxHighlightLength",1e4,bi,!0),s("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),s("tabindex",null,function(e,t){return e.display.input.getField().tabIndex=t||""}),s("autofocus",null),s("direction","ltr",function(e,t){return e.doc.setDirection(t)},!0),s("phrases",null),Ms=(Is=m).optionHandlers,ks=Is.helpers={},Is.prototype={constructor:Is,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,t){var n=this.options,r=n[e];n[e]==t&&"mode"!=e||(n[e]=t,Ms.hasOwnProperty(e)&&P(this,Ms[e])(this,t,r),N(this,"optionChange",this,e))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](Po(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(t[n]==e||t[n].name==e)return t.splice(n,1),!0},addOverlay:n(function(e,t){var n=e.token?e:Is.getMode(this.options,e);if(n.startState)throw new Error("Overlays may not be stateful.");for(var r=this.state.overlays,n={mode:n,modeSpec:e,opaque:t&&t.opaque,priority:t&&t.priority||0},i=function(e){return e.priority},o=0,s=i(n);o<r.length&&i(r[o])<=s;)o++;r.splice(o,0,n),this.state.modeGen++,L(this)}),removeOverlay:n(function(e){for(var t=this.state.overlays,n=0;n<t.length;++n){var r=t[n].modeSpec;if(r==e||"string"==typeof e&&r.name==e)return t.splice(n,1),this.state.modeGen++,void L(this)}}),indentLine:n(function(e,t,n){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),mt(this.doc,e)&&gs(this,e,t,n)}),indentSelection:n(function(e){for(var t=this.doc.sel.ranges,n=-1,r=0;r<t.length;r++){var i=t[r];if(i.empty())i.head.line>n&&(gs(this,i.head.line,e,!0),n=i.head.line,r==this.doc.sel.primIndex)&&Ir(this);else{for(var o=i.from(),i=i.to(),s=Math.max(n,o.line),n=Math.min(this.lastLine(),i.line-(i.ch?0:1))+1,a=s;a<n;++a)gs(this,a,e);i=this.doc.sel.ranges;0==o.ch&&t.length==i.length&&0<i[r].from().ch&&Bi(this.doc,r,new H(o,i[r].to()),fe)}}}),getTokenAt:function(e,t){return kt(this,e,t)},getLineTokens:function(e,t){return kt(this,I(e),t,!0)},getTokenTypeAt:function(e){e=k(this.doc,e);var t,n=_t(this,O(this.doc,e.line)),r=0,i=(n.length-1)/2,o=e.ch;if(0==o)t=n[2];else for(;;){var s=r+i>>1;if((s?n[2*s-1]:0)>=o)i=s;else{if(!(n[2*s+1]<o)){t=n[2*s+2];break}r=1+s}}e=t?t.indexOf("overlay "):-1;return e<0?t:0==e?null:t.slice(0,e-1)},getModeAt:function(e){var t=this.doc.mode;return t.innerMode?Is.innerMode(t,this.getTokenAt(e).state).mode:t},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var n=[];if(ks.hasOwnProperty(t)){var r=ks[t],i=this.getModeAt(e);if("string"==typeof i[t])r[i[t]]&&n.push(r[i[t]]);else if(i[t])for(var o=0;o<i[t].length;o++){var s=r[i[t][o]];s&&n.push(s)}else i.helperType&&r[i.helperType]?n.push(r[i.helperType]):r[i.name]&&n.push(r[i.name]);for(var a=0;a<r._global.length;a++){var l=r._global[a];l.pred(i,this)&&-1==w(n,l.val)&&n.push(l.val)}}return n},getStateAfter:function(e,t){var n=this.doc;return Nt(this,(e=wt(n,null==e?n.first+n.size-1:e))+1,t).state},cursorCoords:function(e,t){var n=this.doc.sel.primary(),e=null==e?n.head:"object"==typeof e?k(this.doc,e):e?n.from():n.to();return qn(this,e,t||"page")},charCoords:function(e,t){return Kn(this,k(this.doc,e),t||"page")},coordsChar:function(e,t){return Jn(this,(e=Xn(this,e,t||"page")).left,e.top)},lineAtHeight:function(e,t){return e=Xn(this,{top:e,left:0},t||"page").top,gt(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t,n){var r=!1,i="number"==typeof e?(i=this.doc.first+this.doc.size-1,e<this.doc.first?e=this.doc.first:i<e&&(e=i,r=!0),O(this.doc,e)):e;return Yn(this,i,{top:0,left:0},t||"page",n||r).top+(r?this.doc.height-tn(i):0)},defaultTextHeight:function(){return or(this.display)},defaultCharWidth:function(){return sr(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,n,r,i){var o,s,a=this.display,l=(e=qn(this,k(this.doc,e))).bottom,u=e.left;t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),a.sizer.appendChild(t),"over"==r?l=e.top:"above"!=r&&"near"!=r||(s=Math.max(a.wrapper.clientHeight,this.doc.height),o=Math.max(a.sizer.clientWidth,a.lineSpace.clientWidth),("above"==r||e.bottom+t.offsetHeight>s)&&e.top>t.offsetHeight?l=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=s&&(l=e.bottom),u+t.offsetWidth>o&&(u=o-t.offsetWidth)),t.style.top=l+"px",t.style.left=t.style.right="","right"==i?(u=a.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==i?u=0:"middle"==i&&(u=(a.sizer.clientWidth-t.offsetWidth)/2),t.style.left=u+"px"),n&&(r=this,s={left:u,top:l,right:u+t.offsetWidth,bottom:l+t.offsetHeight},null!=(s=xr(r,s)).scrollTop&&Lr(r,s.scrollTop),null!=s.scrollLeft)&&Fr(r,s.scrollLeft)},triggerOnKeyDown:n(Zo),triggerOnKeyPress:n(Jo),triggerOnKeyUp:Qo,triggerOnMouseDown:n(rs),execCommand:function(e){if(Wo.hasOwnProperty(e))return Wo[e].call(null,this)},triggerElectric:n(function(e){Es(this,e)}),findPosH:function(e,t,n,r){for(var i=1,o=(t<0&&(i=-1,t=-t),k(this.doc,e)),s=0;s<t&&!(o=Ts(this.doc,o,i,n,r)).hitSide;++s);return o},moveH:n(function(t,n){var r=this;this.extendSelectionsBy(function(e){return r.display.shift||r.doc.extend||e.empty()?Ts(r.doc,e.head,t,n,r.options.rtlMoveVisually):t<0?e.from():e.to()},ge)}),deleteH:n(function(n,r){var e=this.doc.sel,i=this.doc;e.somethingSelected()?i.replaceSelection("",null,"+delete"):Fo(this,function(e){var t=Ts(i,e.head,n,r,!1);return n<0?{from:t,to:e.head}:{from:e.head,to:t}})}),findPosV:function(e,t,n,r){for(var i=1,o=r,s=(t<0&&(i=-1,t=-t),k(this.doc,e)),a=0;a<t;++a){var l=qn(this,s,"div");if(null==o?o=l.left:l.left=o,(s=Rs(this,l,i,n)).hitSide)break}return s},moveV:n(function(r,i){var o=this,s=this.doc,a=[],l=!this.display.shift&&!s.extend&&s.sel.somethingSelected();if(s.extendSelectionsBy(function(e){var t,n;return l?r<0?e.from():e.to():(t=qn(o,e.head,"div"),null!=e.goalColumn&&(t.left=e.goalColumn),a.push(t.left),n=Rs(o,t,r,i),"page"==i&&e==s.sel.primary()&&Or(o,Kn(o,n,"div").top-t.top),n)},ge),a.length)for(var e=0;e<s.sel.ranges.length;e++)s.sel.ranges[e].goalColumn=a[e]}),findWordAt:function(e){var t=O(this.doc,e.line).text,n=e.ch,r=e.ch;if(t){for(var i=this.getHelper(e,"wordChars"),o=("before"!=e.sticky&&r!=t.length||!n?++r:--n,t.charAt(n)),s=Te(o,i)?function(e){return Te(e,i)}:/\s/.test(o)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!Te(e)};0<n&&s(t.charAt(n-1));)--n;for(;r<t.length&&s(t.charAt(r));)++r}return new H(I(e.line,n),I(e.line,r))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||(((this.state.overwrite=!this.state.overwrite)?re:Q)(this.display.cursorDiv,"CodeMirror-overwrite"),N(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==ne()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:n(function(e,t){Mr(this,e,t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-On(this)-this.display.barHeight,width:e.scrollWidth-On(this)-this.display.barWidth,clientHeight:Mn(this),clientWidth:In(this)}},scrollIntoView:n(function(e,t){var n;null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:I(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line?(t=e,kr(n=this),n.curOp.scrollToPos=t):Dr(this,e.from,e.to,e.margin)}),setSize:n(function(e,t){function n(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}var r=this,i=(null!=e&&(this.display.wrapper.style.width=n(e)),null!=t&&(this.display.wrapper.style.height=n(t)),this.options.lineWrapping&&Wn(this),this.display.viewFrom);this.doc.iter(i,this.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){fr(r,i,"widget");break}++i}),this.curOp.forceUpdate=!0,N(this,"refresh",this)}),operation:function(e){return d(this,e)},startOperation:function(){return Gr(this)},endOperation:function(){return Yr(this)},refresh:n(function(){var e=this.display.cachedTextHeight;L(this),this.curOp.forceUpdate=!0,$n(this),Mr(this,this.doc.scrollLeft,this.doc.scrollTop),ei(this.display),(null==e||.5<Math.abs(e-or(this.display)))&&cr(this),N(this,"refresh",this)}),swapDoc:n(function(e){var t=this.doc;return t.cm=null,this.state.selectingText&&this.state.selectingText(),Si(this,e),$n(this),this.display.input.reset(),Mr(this,e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,D(this,"swapDoc",this,t),t}),phrase:function(e){var t=this.options.phrases;return t&&Object.prototype.hasOwnProperty.call(t,e)?t[e]:e},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},je(Is),Is.registerHelper=function(e,t,n){ks.hasOwnProperty(e)||(ks[e]=Is[e]={_global:[]}),ks[e][t]=n},Is.registerGlobalHelper=function(e,t,n,r){Is.registerHelper(e,t,r),ks[e]._global.push({pred:n,val:r})};var Ds,Ls="iter insert remove copy getEditor constructor".split(" ");for(Ds in p.prototype)p.prototype.hasOwnProperty(Ds)&&w(Ls,Ds)<0&&(m.prototype[Ds]=function(e){return function(){return e.apply(this.doc,arguments)}}(p.prototype[Ds]));return je(p),m.inputStyles={textarea:o,contenteditable:i},m.defineMode=function(e){m.defaults.mode||"null"==e||(m.defaults.mode=e),function(e,t){2<arguments.length&&(t.dependencies=Array.prototype.slice.call(arguments,2)),rt[e]=t}.apply(this,arguments)},m.defineMIME=function(e,t){it[e]=t},m.defineMode("null",function(){return{token:function(e){return e.skipToEnd()}}}),m.defineMIME("text/plain","null"),m.defineExtension=function(e,t){m.prototype[e]=t},m.defineDocExtension=function(e,t){p.prototype[e]=t},m.fromTextArea=function(t,n){var e;function r(){t.value=a.getValue()}if((n=n?le(n):{}).value=t.value,!n.tabindex&&t.tabIndex&&(n.tabindex=t.tabIndex),!n.placeholder&&t.placeholder&&(n.placeholder=t.placeholder),null==n.autofocus&&(e=ne(),n.autofocus=e==t||null!=t.getAttribute("autofocus")&&e==document.body),t.form&&(S(t.form,"submit",r),!n.leaveSubmitMethodAlone)){var i=t.form,o=i.submit;try{var s=i.submit=function(){r(),i.submit=o,i.submit(),i.submit=s}}catch(e){}}n.finishInit=function(e){e.save=r,e.getTextArea=function(){return t},e.toTextArea=function(){e.toTextArea=isNaN,r(),t.parentNode.removeChild(e.getWrapperElement()),t.style.display="",t.form&&(T(t.form,"submit",r),n.leaveSubmitMethodAlone||"function"!=typeof t.form.submit||(t.form.submit=o))}},t.style.display="none";var a=m(function(e){return t.parentNode.insertBefore(e,t.nextSibling)},n);return a},(t=m).off=T,t.on=S,t.wheelEventPixels=ci,t.Doc=p,t.splitLines=Je,t.countColumn=ue,t.findColumn=me,t.isWordChar=Se,t.Pass=he,t.signal=N,t.Line=on,t.changeEnd=pi,t.scrollbarModel=$r,t.Pos=I,t.cmpPos=M,t.modes=rt,t.mimeModes=it,t.resolveMode=ot,t.getMode=st,t.modeExtensions=at,t.extendMode=lt,t.copyState=ut,t.startState=dt,t.innerMode=ct,t.commands=Wo,t.keyMap=xo,t.keyName=Lo,t.isModifierKey=ko,t.lookupKey=Mo,t.normalizeKeyMap=Io,t.StringStream=g,t.SharedTextMarker=po,t.TextMarker=co,t.LineWidget=lo,t.e_preventDefault=R,t.e_stopPropagation=ze,t.e_stop=Ye,t.addClass=re,t.contains=te,t.rmClass=Q,t.keyNames=Ro,m.version="5.50.2",m}),!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.download=t()}(this,function(){return function t(e,n,r){function i(e){return String(e)}var o=window,s="application/octet-stream",a=r||s,l=e,e=!n&&!r&&l,u=document.createElement("a"),c=o.Blob||o.MozBlob||o.WebKitBlob||i,d=n||"download",c=c.call?c.bind(o):Blob;if("true"===String(this)&&(a=(l=[l,a])[0],l=l[1]),e&&e.length<2048){var h,d=e.split("/").pop().split("?")[0];if(u.href=e,-1!==u.href.indexOf(e))return(h=new XMLHttpRequest).open("GET",e,!0),h.responseType="blob",h.onload=function(e){t(e.target.response,d,s)},setTimeout(function(){h.send()},0),h}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(l)){if(!(2096103.424<l.length&&c!==i))return navigator.msSaveBlob?navigator.msSaveBlob(m(l),d):y(l);a=(l=m(l)).type||s}else if(/([\x80-\xff])/.test(l)){for(var f=0,p=new Uint8Array(l.length),g=p.length;f<g;++f)p[f]=l.charCodeAt(f);l=new c([p],{type:a})}function m(e){for(var t=e.split(/[:;,]/),n=t[1],r=("base64"==t[0<e.indexOf("charset")?3:2]?atob:decodeURIComponent)(t.pop()),i=r.length,o=0,s=new Uint8Array(i);o<i;++o)s[o]=r.charCodeAt(o);return new c([s],{type:n})}function y(e,t){var n;return"download"in u?(u.href=e,u.setAttribute("download",d),u.className="download-js-link",u.innerHTML="downloading...",u.style.display="none",u.addEventListener("click",function(e){e.stopPropagation(),this.removeEventListener("click",arguments.callee)}),document.body.appendChild(u),setTimeout(function(){u.click(),document.body.removeChild(u),!0===t&&setTimeout(function(){o.URL.revokeObjectURL(u.href)},250)},66),!0):/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent)?(/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,s)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0):(n=document.createElement("iframe"),document.body.appendChild(n),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,s)),n.src=e,void setTimeout(function(){document.body.removeChild(n)},333))}if(r=l instanceof c?l:new c([l],{type:a}),navigator.msSaveBlob)return navigator.msSaveBlob(r,d);if(o.URL)y(o.URL.createObjectURL(r),!0);else{if("string"==typeof r||r.constructor===i)try{return y("data:"+a+";base64,"+o.btoa(r))}catch(e){return y("data:"+a+","+encodeURIComponent(r))}(n=new FileReader).onload=function(e){y(this.result)},n.readAsDataURL(r)}return!0}}),!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Mustache=t()}(this,function(){"use strict";var t=Object.prototype.toString,I=Array.isArray||function(e){return"[object Array]"===t.call(e)};function c(e){return"function"==typeof e}function M(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function d(e,t){return null!=e&&"object"==typeof e&&t in e}var n=RegExp.prototype.test;var r=/\S/;function k(e){return!n.call(r,e)}var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};var D=/\s*/,L=/\s+/,P=/\s*=/,F=/\s*\}/,B=/#|\^|\/|>|\{|&|=|!/;function s(e,t){if(!e)return[];var n,r,i,o=!1,s=[],a=[],l=[],u=!1,c=!1,d="",h=0;function f(){if(u&&!c)for(;l.length;)delete a[l.pop()];else l=[];c=u=!1}function p(e){if("string"==typeof e&&(e=e.split(L,2)),!I(e)||2!==e.length)throw new Error("Invalid tags: "+e);n=new RegExp(M(e[0])+"\\s*"),r=new RegExp("\\s*"+M(e[1])),i=new RegExp("\\s*"+M("}"+e[1]))}p(t||U.tags);for(var g,m,y,v,b,E,C=new H(e);!C.eos();){if(g=C.pos,y=C.scanUntil(n))for(var w=0,S=y.length;w<S;++w)k(v=y.charAt(w))?(l.push(a.length),d+=v):(o=c=!0,d+=" "),a.push(["text",v,g,g+1]),g+=1,"\n"===v&&(f(),d="",h=0,o=!1);if(!C.scan(n))break;if(u=!0,m=C.scan(B)||"name",C.scan(D),"="===m?(y=C.scanUntil(P),C.scan(P),C.scanUntil(r)):"{"===m?(y=C.scanUntil(i),C.scan(F),C.scanUntil(r),m="&"):y=C.scanUntil(r),!C.scan(r))throw new Error("Unclosed tag at "+C.pos);if(b=">"==m?[m,y,g,C.pos,d,h,o]:[m,y,g,C.pos],h++,a.push(b),"#"===m||"^"===m)s.push(b);else if("/"===m){if(!(E=s.pop()))throw new Error('Unopened section "'+y+'" at '+g);if(E[1]!==y)throw new Error('Unclosed section "'+E[1]+'" at '+g)}else"name"===m||"{"===m||"&"===m?c=!0:"="===m&&p(y)}if(f(),E=s.pop())throw new Error('Unclosed section "'+E[1]+'" at '+C.pos);for(var T,R=function(e){for(var t,n,r=[],i=0,o=e.length;i<o;++i)(t=e[i])&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(r.push(t),n=t));return r}(a),A=[],_=A,N=[],x=0,O=R.length;x<O;++x)switch((T=R[x])[0]){case"#":case"^":_.push(T),N.push(T),_=T[4]=[];break;case"/":N.pop()[5]=T[2],_=0<N.length?N[N.length-1][4]:A;break;default:_.push(T)}return A}function H(e){this.string=e,this.tail=e,this.pos=0}function o(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function e(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}H.prototype.eos=function(){return""===this.tail},H.prototype.scan=function(e){var e=this.tail.match(e);return e&&0===e.index?(e=e[0],this.tail=this.tail.substring(e.length),this.pos+=e.length,e):""},H.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},o.prototype.push=function(e){return new o(e,this)},o.prototype.lookup=function(e){var t,n,r,i=this.cache;if(i.hasOwnProperty(e))t=i[e];else{for(var o,s,a,l=this,u=!1;l;){if(0<e.indexOf("."))for(o=l.view,s=e.split("."),a=0;null!=o&&a<s.length;)a===s.length-1&&(u=d(o,s[a])||(n=o,r=s[a],null!=n&&"object"!=typeof n&&n.hasOwnProperty&&n.hasOwnProperty(r))),o=o[s[a++]];else o=l.view[e],u=d(l.view,e);if(u){t=o;break}l=l.parent}i[e]=t}return t=c(t)?t.call(this.view):t},e.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},e.prototype.parse=function(e,t){var n=this.templateCache,r=e+":"+(t||U.tags).join(":"),i=void 0!==n,o=i?n.get(r):void 0;return null==o&&(o=s(e,t),i)&&n.set(r,o),o},e.prototype.render=function(e,t,n,r){var i=this.getConfigTags(r),i=this.parse(e,i),t=t instanceof o?t:new o(t,void 0);return this.renderTokens(i,t,n,e,r)},e.prototype.renderTokens=function(e,t,n,r,i){for(var o,s,a,l="",u=0,c=e.length;u<c;++u)a=void 0,"#"===(s=(o=e[u])[0])?a=this.renderSection(o,t,n,r,i):"^"===s?a=this.renderInverted(o,t,n,r,i):">"===s?a=this.renderPartial(o,t,n,i):"&"===s?a=this.unescapedValue(o,t):"name"===s?a=this.escapedValue(o,t,i):"text"===s&&(a=this.rawValue(o)),void 0!==a&&(l+=a);return l},e.prototype.renderSection=function(e,t,n,r,i){var o=this,s="",a=t.lookup(e[1]);if(a){if(I(a))for(var l=0,u=a.length;l<u;++l)s+=this.renderTokens(e[4],t.push(a[l]),n,r,i);else if("object"==typeof a||"string"==typeof a||"number"==typeof a)s+=this.renderTokens(e[4],t.push(a),n,r,i);else if(c(a)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");null!=(a=a.call(t.view,r.slice(e[3],e[5]),function(e){return o.render(e,t,n,i)}))&&(s+=a)}else s+=this.renderTokens(e[4],t,n,r,i);return s}},e.prototype.renderInverted=function(e,t,n,r,i){var o=t.lookup(e[1]);if(!o||I(o)&&0===o.length)return this.renderTokens(e[4],t,n,r,i)},e.prototype.indentPartial=function(e,t,n){for(var r=t.replace(/[^ \t]/g,""),i=e.split("\n"),o=0;o<i.length;o++)i[o].length&&(0<o||!n)&&(i[o]=r+i[o]);return i.join("\n")},e.prototype.renderPartial=function(e,t,n,r){var i,o,s,a,l;if(n)return i=this.getConfigTags(r),null!=(o=c(n)?n(e[1]):n[e[1]])?(s=e[6],l=e[5],e=e[4],a=o,0==l&&e&&(a=this.indentPartial(o,e,s)),l=this.parse(a,i),this.renderTokens(l,t,n,a,r)):void 0},e.prototype.unescapedValue=function(e,t){t=t.lookup(e[1]);if(null!=t)return t},e.prototype.escapedValue=function(e,t,n){n=this.getConfigEscape(n)||U.escape,t=t.lookup(e[1]);if(null!=t)return("number"==typeof t&&n===U.escape?String:n)(t)},e.prototype.rawValue=function(e){return e[1]},e.prototype.getConfigTags=function(e){return I(e)?e:e&&"object"==typeof e?e.tags:void 0},e.prototype.getConfigEscape=function(e){if(e&&"object"==typeof e&&!I(e))return e.escape};var U={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){a.templateCache=e},get templateCache(){return a.templateCache}},a=new e;return U.clearCache=function(){return a.clearCache()},U.parse=function(e,t){return a.parse(e,t)},U.render=function(e,t,n,r){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(I(i=e)?"array":typeof i)+'" was given as the first argument for mustache#render(template, view, partials)');var i;return a.render(e,t,n,r)},U.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return i[e]})},U.Scanner=H,U.Context=o,U.Writer=e,U}),!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.printJS=t():e.printJS=t()}(window,function(){return r={},i.m=n={"./src/index.js":function(e,t,n){"use strict";n.r(t),n("./src/sass/index.scss"),n=n("./src/js/init.js").default.init,"undefined"!=typeof window&&(window.printJS=n),t.default=n},"./src/js/browser.js":function(e,t,n){"use strict";n.r(t);var r={isFirefox:function(){return"undefined"!=typeof InstallTrigger},isIE:function(){return-1!==navigator.userAgent.indexOf("MSIE")||!!document.documentMode},isEdge:function(){return!r.isIE()&&!!window.StyleMedia},isChrome:function(e){return!!(0<arguments.length&&void 0!==e?e:window).chrome},isSafari:function(){return 0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")||-1!==navigator.userAgent.toLowerCase().indexOf("safari")},isIOSChrome:function(){return-1!==navigator.userAgent.toLowerCase().indexOf("crios")}};t.default=r},"./src/js/functions.js":function(e,t,n){"use strict";n.r(t),n.d(t,"addWrapper",function(){return r}),n.d(t,"capitalizePrint",function(){return a}),n.d(t,"collectStyles",function(){return l}),n.d(t,"addHeader",function(){return u}),n.d(t,"cleanUp",function(){return c}),n.d(t,"isRawHTML",function(){return d});var i=n("./src/js/modal.js"),o=n("./src/js/browser.js");function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){return'<div style="font-family:'+t.font+" !important; font-size: "+t.font_size+' !important; width:100%;">'+e+"</div>"}function a(e){return e.charAt(0).toUpperCase()+e.slice(1)}function l(e,t){for(var n="",r=(document.defaultView||window).getComputedStyle(e,""),i=0;i<r.length;i++)(-1!==t.targetStyles.indexOf("*")||-1!==t.targetStyle.indexOf(r[i])||function(e,t){for(var n=0;n<e.length;n++)if("object"===s(t)&&-1!==t.indexOf(e[n]))return 1}(t.targetStyles,r[i]))&&r.getPropertyValue(r[i])&&(n+=r[i]+":"+r.getPropertyValue(r[i])+";");return n+("max-width: "+t.maxWidth+"px !important; font-size: "+t.font_size)+" !important;"}function u(e,t){var n,r,i=document.createElement("div");d(t.header)?i.innerHTML=t.header:(n=document.createElement("h1"),r=document.createTextNode(t.header),n.appendChild(r),n.setAttribute("style",t.headerStyle),i.appendChild(n)),e.insertBefore(i,e.childNodes[0])}function c(n){n.showModal&&i.default.close(),n.onLoadingEnd&&n.onLoadingEnd(),(n.showModal||n.onLoadingStart)&&window.URL.revokeObjectURL(n.printable);var r="mouseover";(o.default.isChrome()||o.default.isFirefox())&&(r="focus"),window.addEventListener(r,function e(){window.removeEventListener(r,e),n.onPrintDialogClose();var t=document.getElementById(n.frameId);t&&t.remove()})}function d(e){return new RegExp("<([A-Za-z][A-Za-z0-9]*)\\b[^>]*>(.*?)</\\1>").test(e)}},"./src/js/html.js":function(e,t,n){"use strict";n.r(t);var a=n("./src/js/functions.js"),r=n("./src/js/print.js");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.default={print:function(e,t){var n="object"===i(n=e.printable)&&n&&(n instanceof HTMLElement||1===n.nodeType)?e.printable:document.getElementById(e.printable);n?(e.printableElement=function e(t,n){for(var r,i=t.cloneNode(),o=Array.prototype.slice.call(t.childNodes),s=0;s<o.length;s++)-1===n.ignoreElements.indexOf(o[s].id)&&(r=e(o[s],n),i.appendChild(r));switch(n.scanStyles&&1===t.nodeType&&i.setAttribute("style",Object(a.collectStyles)(t,n)),t.tagName){case"SELECT":i.value=t.value;break;case"CANVAS":i.getContext("2d").drawImage(t,0,0)}return i}(n,e),e.header&&Object(a.addHeader)(e.printableElement,e),r.default.send(e,t)):window.console.error("Invalid HTML element id: "+e.printable)}}},"./src/js/image.js":function(e,t,n){"use strict";n.r(t);var i=n("./src/js/functions.js"),o=n("./src/js/print.js"),s=n("./src/js/browser.js");t.default={print:function(r,e){r.printable.constructor!==Array&&(r.printable=[r.printable]),r.printableElement=document.createElement("div"),r.printable.forEach(function(e){var t=document.createElement("img"),n=(t.setAttribute("style",r.imageStyle),t.src=e,s.default.isFirefox()&&(n=t.src,t.src=n),document.createElement("div"));n.appendChild(t),r.printableElement.appendChild(n)}),r.header&&Object(i.addHeader)(r.printableElement,r),o.default.send(r,e)}}},"./src/js/init.js":function(e,t,n){"use strict";n.r(t);var s=n("./src/js/browser.js"),a=n("./src/js/modal.js"),l=n("./src/js/pdf.js"),u=n("./src/js/html.js"),c=n("./src/js/raw-html.js"),d=n("./src/js/image.js"),h=n("./src/js/json.js");function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var p=["pdf","html","image","json","raw-html"];t.default={init:function(e,t){var n={printable:null,fallbackPrintable:null,type:"pdf",header:null,headerStyle:"font-weight: 300;",maxWidth:800,properties:null,gridHeaderStyle:"font-weight: bold; padding: 5px; border: 1px solid #dddddd;",gridStyle:"border: 1px solid lightgray; margin-bottom: -1px;",showModal:!1,onError:function(e){throw e},onLoadingStart:null,onLoadingEnd:null,onPrintDialogClose:function(){},onIncompatibleBrowser:function(){},modalMessage:"Retrieving Document...",frameId:"printJS",printableElement:null,documentTitle:"Document",targetStyle:["clear","display","width","min-width","height","min-height","max-height"],targetStyles:["border","box","break","text-decoration"],ignoreElements:[],repeatTableHeader:!0,css:null,style:null,scanStyles:!0,base64:!1,onPdfOpen:null,font:"TimesNewRoman",font_size:"12pt",honorMarginPadding:!0,honorColor:!1,imageStyle:"max-width: 100%;"},r=e;if(void 0===r)throw new Error("printJS expects at least 1 attribute.");switch(f(r)){case"string":n.printable=encodeURI(r),n.fallbackPrintable=n.printable,n.type=t||n.type;break;case"object":for(var i in n.printable=r.printable,n.fallbackPrintable=void 0!==r.fallbackPrintable?r.fallbackPrintable:n.printable,n.fallbackPrintable=n.base64?"data:application/pdf;base64,".concat(n.fallbackPrintable):n.fallbackPrintable,n)"printable"!==i&&"fallbackPrintable"!==i&&(n[i]=(void 0!==r[i]?r:n)[i]);break;default:throw new Error('Unexpected argument type! Expected "string" or "object", got '+f(r))}if(!n.printable)throw new Error("Missing printable information.");if(!n.type||"string"!=typeof n.type||-1===p.indexOf(n.type.toLowerCase()))throw new Error("Invalid print type. Available types are: pdf, html, image and json.");n.showModal&&a.default.show(n),n.onLoadingStart&&n.onLoadingStart(),(t=document.getElementById(n.frameId))&&t.parentNode.removeChild(t);var o=document.createElement("iframe");switch(s.default.isFirefox()?o.setAttribute("style","width: 1px; height: 100px; position: fixed; left: 0; top: 0; opacity: 0; border-width: 0; margin: 0; padding: 0"):o.setAttribute("style","visibility: hidden; height: 0; width: 0; position: absolute; border: 0"),o.setAttribute("id",n.frameId),"pdf"!==n.type&&(o.srcdoc="<html><head><title>"+n.documentTitle+"</title>",n.css&&(Array.isArray(n.css)||(n.css=[n.css]),n.css.forEach(function(e){o.srcdoc+='<link rel="stylesheet" href="'+e+'">'})),o.srcdoc+="</head><body></body></html>"),n.type){case"pdf":if(s.default.isIE())try{console.info("Print.js doesn't support PDF printing in Internet Explorer."),window.open(n.fallbackPrintable,"_blank").focus(),n.onIncompatibleBrowser()}catch(e){n.onError(e)}finally{n.showModal&&a.default.close(),n.onLoadingEnd&&n.onLoadingEnd()}else l.default.print(n,o);break;case"image":d.default.print(n,o);break;case"html":u.default.print(n,o);break;case"raw-html":c.default.print(n,o);break;case"json":h.default.print(n,o)}}}},"./src/js/json.js":function(e,t,n){"use strict";n.r(t);var c=n("./src/js/functions.js"),r=n("./src/js/print.js");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.default={print:function(t,e){if("object"!==i(t.printable))throw new Error("Invalid javascript data object (JSON).");if("boolean"!=typeof t.repeatTableHeader)throw new Error("Invalid value for repeatTableHeader attribute (JSON).");if(!t.properties||!Array.isArray(t.properties))throw new Error("Invalid properties array for your JSON data.");t.properties=t.properties.map(function(e){return{field:"object"===i(e)?e.field:e,displayName:"object"===i(e)?e.displayName:e,columnSize:"object"===i(e)&&e.columnSize?e.columnSize+";":100/t.properties.length+"%;"}}),t.printableElement=document.createElement("div"),t.header&&Object(c.addHeader)(t.printableElement,t),t.printableElement.innerHTML+=function(e){var t=e.printable,n=e.properties,r='<table style="border-collapse: collapse; width: 100%;">';e.repeatTableHeader&&(r+="<thead>"),r+="<tr>";for(var i=0;i<n.length;i++)r+='<th style="width:'+n[i].columnSize+";"+e.gridHeaderStyle+'">'+Object(c.capitalizePrint)(n[i].displayName)+"</th>";r+="</tr>",e.repeatTableHeader&&(r+="</thead>"),r+="<tbody>";for(var o=0;o<t.length;o++){r+="<tr>";for(var s=0;s<n.length;s++){var a=t[o],l=n[s].field.split(".");if(1<l.length)for(var u=0;u<l.length;u++)a=a[l[u]];else a=a[n[s].field];r+='<td style="width:'+n[s].columnSize+e.gridStyle+'">'+a+"</td>"}r+="</tr>"}return r+"</tbody></table>"}(t),r.default.send(t,e)}}},"./src/js/modal.js":function(e,t,n){"use strict";n.r(t);var i={show:function(e){var t=document.createElement("div"),n=(t.setAttribute("style","font-family:sans-serif; display:table; text-align:center; font-weight:300; font-size:30px; left:0; top:0;position:fixed; z-index: 9990;color: #0460B5; width: 100%; height: 100%; background-color:rgba(255,255,255,.9);transition: opacity .3s ease;"),t.setAttribute("id","printJS-Modal"),document.createElement("div")),r=(n.setAttribute("style","display:table-cell; vertical-align:middle; padding-bottom:100px;"),document.createElement("div"));r.setAttribute("class","printClose"),r.setAttribute("id","printClose"),n.appendChild(r),(r=document.createElement("span")).setAttribute("class","printSpinner"),n.appendChild(r),e=document.createTextNode(e.modalMessage),n.appendChild(e),t.appendChild(n),document.getElementsByTagName("body")[0].appendChild(t),document.getElementById("printClose").addEventListener("click",function(){i.close()})},close:function(){var e=document.getElementById("printJS-Modal");e&&e.parentNode.removeChild(e)}};t.default=i},"./src/js/pdf.js":function(e,t,n){"use strict";n.r(t);var r=n("./src/js/print.js"),i=n("./src/js/functions.js");function o(e,t,n){n=new window.Blob([n],{type:"application/pdf"}),n=window.URL.createObjectURL(n),t.setAttribute("src",n),r.default.send(e,t)}t.default={print:function(e,t){var n,r;e.base64?(n=Uint8Array.from(atob(e.printable),function(e){return e.charCodeAt(0)}),o(e,t,n)):(e.printable=/^(blob|http|\/\/)/i.test(e.printable)?e.printable:window.location.origin+("/"!==e.printable.charAt(0)?"/"+e.printable:e.printable),(r=new window.XMLHttpRequest).responseType="arraybuffer",r.addEventListener("error",function(){Object(i.cleanUp)(e),e.onError(r.statusText,r)}),r.addEventListener("load",function(){return-1===[200,201].indexOf(r.status)?(Object(i.cleanUp)(e),void e.onError(r.statusText,r)):void o(e,t,r.response)}),r.open("GET",e.printable,!0),r.send())}}},"./src/js/print.js":function(e,t,n){"use strict";n.r(t);var i=n("./src/js/browser.js"),r=n("./src/js/functions.js"),n={send:function(n,e){document.getElementsByTagName("body")[0].appendChild(e);var r=document.getElementById(n.frameId);r.onload=function(){var e,t;"pdf"!==n.type?((e=(e=r.contentWindow||r.contentDocument).document?e.document:e).body.appendChild(n.printableElement),"pdf"!==n.type&&n.style&&((t=document.createElement("style")).innerHTML=n.style,e.head.appendChild(t)),0<(e=e.getElementsByTagName("img")).length?(t=(t=Array.from(e)).map(function(e){if(e.src&&e.src!==window.location.href)return n=e,new Promise(function(t){!function e(){n&&void 0!==n.naturalWidth&&0!==n.naturalWidth&&n.complete?t():setTimeout(e,500)}()});var n}),Promise.all(t).then(function(){return o(r,n)})):o(r,n)):i.default.isFirefox()?setTimeout(function(){return o(r,n)},1e3):o(r,n)}}};function o(t,n){try{if(t.focus(),i.default.isEdge()||i.default.isIE())try{t.contentWindow.document.execCommand("print",!1,null)}catch(e){t.contentWindow.print()}else t.contentWindow.print()}catch(e){n.onError(e)}finally{i.default.isFirefox()&&(t.style.visibility="hidden",t.style.left="-1px"),Object(r.cleanUp)(n)}}t.default=n},"./src/js/raw-html.js":function(e,t,n){"use strict";n.r(t);var r=n("./src/js/print.js");t.default={print:function(e,t){e.printableElement=document.createElement("div"),e.printableElement.setAttribute("style","width:100%"),e.printableElement.innerHTML=e.printable,r.default.send(e,t)}}},"./src/sass/index.scss":function(e,t,n){},0:function(e,t,n){e.exports=n("./src/index.js")}},i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0).default;function i(e){var t;return(r[e]||(t=r[e]={i:e,l:!1,exports:{}},n[e].call(t.exports,t,t.exports,i),t.l=!0,t)).exports}var n,r}),!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.notifier=t():e.notifier=t()}("undefined"!=typeof self?self:this,function(){function h(e,t){var n,r=g.createElement(e);for(n in t)r.setAttribute(n,t[n]);return r}function f(e){var t=document.getElementById(e);return!!t&&(t.className=t.className.replace(" shown",""),setTimeout(function(){t.parentNode.removeChild(t)},600),!0)}var e,p=0,g=document;return e=h("div",{class:"notifier-container",id:"notifier-container"}),g.body.appendChild(e),{show:function(e,t,n,r,i){"number"!=typeof i&&(i=0);var o="notifier-"+p,s=g.querySelector(".notifier-container"),a=h("div",{class:"notifier "+n}),n=h("h3",{class:"notifier-title"}),l=h("div",{class:"notifier-body"}),u=h("div",{class:"notifier-img"}),c=h("img",{class:"img",src:r}),d=h("button",{class:"notifier-close",type:"button"});return n.innerHTML=e,l.innerHTML=t,d.innerHTML="&times;",0<r.length&&u.appendChild(c),a.appendChild(d),a.appendChild(u),a.appendChild(n),a.appendChild(l),s.appendChild(a),u.style.height=u.parentNode.offsetHeight+"px"||null,setTimeout(function(){a.className+=" shown",a.setAttribute("id",o)},100),0<i&&setTimeout(function(){f(o)},i),d.addEventListener("click",function(){f(o)}),p+=1,o},hide:f}}),!function(){"use strict";function o(e){var t;return null===e?"null":void 0===e?"undefined":"object"==(t=typeof e)&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t}function s(c){return f(function(e,t){var n,r,i,o=Object.keys(e),s=Object.keys(t);if(r=g(p),i=function(e){return t=n,Array.prototype.slice.call(e).sort(t);var t},!f(function(e,t){return r.eq(i(e),i(t))}).eq(o,s))return!1;for(var a=o.length,l=0;l<a;l++){var u=o[l];if(!c.eq(e[u],t[u]))return!1}return!0})}function a(e){return e}var f=function(e){return{eq:e}},p=f(function(e,t){return e===t}),g=function(i){return f(function(e,t){if(e.length!==t.length)return!1;for(var n=e.length,r=0;r<n;r++)if(!i.eq(e[r],t[r]))return!1;return!0})},l=f(function(e,t){var n;return e===t||(n=o(e))===o(t)&&(-1!==["undefined","boolean","number","string","function","xml","null"].indexOf(n)?e===t:"array"===n?g(l).eq(e,t):"object"===n&&s(l).eq(e,t))}),Y=function(){},u=function(n,r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n(r.apply(null,e))}},_=function(e){return function(){return e}};function w(r){for(var i=[],e=1;e<arguments.length;e++)i[e-1]=arguments[e];return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=i.concat(e);return r.apply(null,n)}}function c(e){return function(){throw new Error(e)}}function v(e){e()}function b(){return pe}function S(n){function e(){return i}function t(e){return e(n)}var r=_(n),i={fold:function(e,t){return t(n)},is:function(e){return n===e},isSome:fe,isNone:m,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:e,orThunk:e,map:function(e){return S(e(n))},each:function(e){e(n)},bind:t,exists:t,forall:t,filter:function(e){return e(n)?i:pe},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(e){return e.is(n)},equals_:function(e,t){return e.fold(m,function(e){return t(n,e)})}};return i}function T(n){return function(e){return t=typeof(e=e),(null===e?"null":"object"==t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t)===n;var t}}function R(t){return function(e){return typeof e===t}}function B(t){return function(e){return t===e}}function U(e,t){for(var n=e.length-1;0<=n;n--)t(e[n],n)}function V(e,t,n){return U(e,function(e){n=t(n,e)}),n}function W(e,t,n){return ee(e,function(e){n=t(n,e)}),n}function $(e,t){for(var n=0,r=e.length;n<r;++n)if(!0!==t(e[n],n))return!1;return!0}function j(e,t){return O(e,function(e){return!xe(t,e)})}function z(e,t){return 0<=t&&t<e.length?N.some(e[t]):N.none()}function G(e,n){return r=function(e,t){return{k:t,v:n(e,t)}},i={},X(e,function(e,t){e=r(e,t);i[e.k]=e.v}),i;var r,i}function ie(n){return function(e,t){n[t]=e}}function oe(e,n,r,i){X(e,function(e,t){(n(e,t)?r:i)(e,t)})}function se(e,t){return $e(e,t)&&void 0!==e[t]&&null!==e[t]}function ae(e,t,n){var r,i;if(!e)return!1;if(n=n||e,void 0!==e.length){for(r=0,i=e.length;r<i;r++)if(!1===t.call(n,e[r],r,e))return!1}else for(r in e)if(e.hasOwnProperty(r)&&!1===t.call(n,e[r],r,e))return!1;return!0}function le(e,t){if(e)for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function ue(e,t,n,r){for(var i=Ee(n)?e[0]:n,o=0;o<e.length;o++)i=t.call(r,i,e[o],o);return i}function ce(e,t,n){for(var r=0,i=e.length;r<i;r++)if(t.call(n,e[r],r,e))return r;return-1}function de(e){return e[e.length-1]}var he=function(t){return function(e){return!t(e)}},m=_(!1),fe=_(!0),pe=(t=function(e){return e.isNone()},{fold:function(e,t){return e()},is:m,isSome:m,isNone:fe,getOr:nn=function(e){return e},getOrThunk:e=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:_(null),getOrUndefined:_(void 0),or:nn,orThunk:e,map:b,each:Y,bind:b,exists:m,forall:fe,filter:b,equals:t,equals_:t,toArray:function(){return[]},toString:_("none()")}),N={some:S,none:b,from:function(e){return null==e?pe:S(e)}},ge=T("string"),me=T("object"),ye=T("array"),ve=B(null),be=R("boolean"),Ee=B(void 0),Ce=function(e){return null==e},we=function(e){return!Ce(e)},Se=R("function"),Te=R("number"),Re=Array.prototype.slice,Ae=Array.prototype.indexOf,_e=Array.prototype.push,Ne=function(e,t){return Ae.call(e,t)},xe=function(e,t){return-1<Ne(e,t)},Oe=function(e,t){for(var n=0,r=e.length;n<r;n++)if(t(e[n],n))return!0;return!1},x=function(e,t){for(var n=e.length,r=new Array(n),i=0;i<n;i++){var o=e[i];r[i]=t(o,i)}return r},ee=function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)},O=function(e,t){for(var n=[],r=0,i=e.length;r<i;r++){var o=e[r];t(o,r)&&n.push(o)}return n},Ie=function(e,t){for(var n=e,r=t,i=m,o=0,s=n.length;o<s;o++){var a=n[o];if(r(a,o))return N.some(a);if(i(a,o))break}return N.none()},Me=function(e,t){for(var n=0,r=e.length;n<r;n++)if(t(e[n],n))return N.some(n);return N.none()},ke=function(e,t){for(var n=x(e,t),r=[],i=0,o=n.length;i<o;++i){if(!ye(n[i]))throw new Error("Arr.flatten item "+i+" was not an array, input: "+n);_e.apply(r,n[i])}return r},De=function(e){e=Re.call(e,0);return e.reverse(),e},Le=function(e){return z(e,0)},Pe=function(e){return z(e,e.length-1)},Fe=Se(Array.from)?Array.from:function(e){return Re.call(e)},Be=Object.keys,He=Object.hasOwnProperty,X=function(e,t){for(var n=Be(e),r=0,i=n.length;r<i;r++){var o=n[r];t(e[o],o)}},Ue=function(e,t){var n={},r={};return oe(e,t,ie(n),ie(r)),{t:n,f:r}},Ve=function(e,t){var n={};return oe(e,t,ie(n),Y),n},We=function(e,t){return $e(e,t)?N.from(e[t]):N.none()},$e=function(e,t){return He.call(e,t)},je=Array.isArray,ze=function(n,r){var i=[];return ae(n,function(e,t){i.push(r(e,t,n))}),i},Ge=function(n,r){var i=[];return ae(n,function(e,t){r&&!r(e,t,n)||i.push(e)}),i},I=function(){return(I=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function Ye(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function Xe(){return Ke(0,0)}function Ke(e,t){return{major:e,minor:t}}function qe(e,t){var n=String(t).toLowerCase();return Ie(e,function(e){return e.search(n)})}function Ze(e,t){return-1!==e.indexOf(t)}function Qe(e,t){return""===(t=t)||e.length>=t.length&&e.substr(0,0+t.length)===t}function Je(t){return function(e){return e.replace(t,"")}}function et(t){return function(e){return Ze(e,t)}}function tt(e){function t(e){return function(){return n===e}}var n=e.current,e=e.version;return{current:n,version:e,isEdge:t("Edge"),isChrome:t("Chrome"),isIE:t("IE"),isOpera:t("Opera"),isFirefox:t("Firefox"),isSafari:t("Safari")}}function nt(e){function t(e){return function(){return n===e}}var n=e.current,e=e.version;return{current:n,version:e,isWindows:t("Windows"),isiOS:t("iOS"),isAndroid:t("Android"),isOSX:t("OSX"),isLinux:t("Linux"),isSolaris:t("Solaris"),isFreeBSD:t("FreeBSD"),isChromeOS:t("ChromeOS")}}function rt(e){return window.matchMedia(e).matches}function it(e){return null==e?"":(""+e).replace(cn,"")}function ot(e,t){return t?!("array"!==t||!je(e))||typeof e===t:void 0!==e}function st(e,n,r,i){i=i||this,e&&(r&&(e=e[r]),ae(e,function(e,t){return!1!==n.call(i,e,t,r)&&void st(e,n,r,i)}))}function at(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}}function lt(e,t){for(var n=[],r=function(e){return n.push(e),t(e)},i=t(e);(i=i.bind(r)).isSome(););return n}function ut(e,t){if(1!==(e=e.dom).nodeType)return!1;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}function ct(e){return e.dom.nodeType}function dt(t){return function(e){return ct(e)===t}}function ht(e){return q.fromDom(e.dom.ownerDocument)}function ft(e){return q.fromDom(vn(e).dom.defaultView)}function pt(e){return De(lt(e,En))}function gt(e){return Tn(e,0)}function mt(e){if(An(e))return e;if(null==(e=vn(e).dom.head))throw new Error("Head is not available yet");return q.fromDom(e)}function yt(t,e){ee(e,function(e){kn(t,e)})}function vt(e){e.dom.textContent="",ee(Sn(e),function(e){Dn(e)})}function bt(e){var t,n=Sn(e);0<n.length&&(t=e,ee(n,function(e){On(t,e)})),Dn(e)}function Et(n,r){return{left:n,top:r,translate:function(e,t){return Et(n+e,r+t)}}}function Ct(e,t){return void 0!==e?e:void 0!==t?t:0}function wt(e){var t=e.dom,n=t.ownerDocument.body;return n===t?Pn(n.offsetLeft,n.offsetTop):Ln(e)?(n=t.getBoundingClientRect(),Pn(n.left,n.top)):Pn(0,0)}function St(e,t,n){(n=(void 0!==n?n.dom:document).defaultView)&&n.scrollTo(e,t)}function Tt(e,t){an().browser.isSafari()&&Se(e.dom.scrollIntoViewIfNeeded)?e.dom.scrollIntoViewIfNeeded(!1):e.dom.scrollIntoView(t)}function Rt(e){var n=void 0===e?window:e,e=n.document,r=Fn(q.fromDom(e)),e=void 0===n?window:n;return N.from(e.visualViewport).fold(function(){var e=n.document.documentElement,t=e.clientWidth,e=e.clientHeight;return Bn(r.left,r.top,t,e)},function(e){return Bn(Math.max(e.pageLeft,r.left),Math.max(e.pageTop,r.top),e.width,e.height)})}function At(t){return function(e){return!!e&&e.nodeType===t}}function _t(e){return!!e&&!Object.getPrototypeOf(e)}function Nt(e){var t=e.map(function(e){return e.toLowerCase()});return function(e){return!(!e||!e.nodeName)&&(e=e.nodeName.toLowerCase(),xe(t,e))}}function xt(r,e){var i=e.toLowerCase().split(" ");return function(e){var t;if(Q(e))for(t=0;t<i.length;t++){var n=e.ownerDocument.defaultView.getComputedStyle(e,null);if((n?n.getPropertyValue(r):null)===i[t])return!0}return!1}}function Ot(t){return function(e){return Q(e)&&e.hasAttribute(t)}}function It(e){return Q(e)&&"TABLE"===e.tagName}function Mt(t){return function(e){if(Q(e)){if(e.contentEditable===t)return!0;if(e.getAttribute("data-mce-contenteditable")===t)return!0}return!1}}function kt(e){return void 0!==e.style&&Se(e.style.getPropertyValue)}function Dt(e,t,n){Yn(e.dom,t,n)}function Lt(e,t){var n=e.dom;X(t,function(e,t){Yn(n,t,e)})}function Pt(e,t){e.dom.removeAttribute(t)}function Ft(e,t){var r=e.dom;X(t,function(e,t){var n=r;if(!ge(e))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",e,":: Element ",n),new Error("CSS value must be a string: "+e);kt(n)&&n.style.setProperty(t,e)})}function Bt(e){var t={},n=e.dom;if(kt(n))for(var r=0;r<n.style.length;r++){var i=n.style.item(r);t[i]=n.style[i]}return t}function Ht(e){function r(e){t()?n(e):o.push(e)}function t(){return i.isSome()}function n(t){i.each(function(e){setTimeout(function(){t(e)},0)})}var i=N.none(),o=[];return e(function(e){t()||(i=N.some(e),ee(o,n),o=[])}),{get:r,map:function(n){return Ht(function(t){r(function(e){t(n(e))})})},isReady:t}}function Ut(e){setTimeout(function(){throw e},0)}function Vt(e){return ar(function(){return new or(e)})}function Wt(n){return{is:function(e){return n===e},isValue:fe,isError:m,getOr:_(n),getOrThunk:_(n),getOrDie:_(n),or:function(e){return Wt(n)},orThunk:function(e){return Wt(n)},fold:function(e,t){return t(n)},map:function(e){return Wt(e(n))},mapError:function(e){return Wt(n)},each:function(e){e(n)},bind:function(e){return e(n)},exists:function(e){return e(n)},forall:function(e){return e(n)},toOptional:function(){return N.some(n)}}}function $t(n){return{is:m,isValue:m,isError:fe,getOr:a,getOrThunk:function(e){return e()},getOrDie:function(){return c(String(n))()},or:function(e){return e},orThunk:function(e){return e()},fold:function(e,t){return e(n)},map:function(e){return $t(n)},mapError:function(e){return $t(e(n))},each:Y,bind:function(e){return $t(n)},exists:m,forall:fe,toOptional:N.none}}function jt(s){if(!ye(s))throw new Error("cases must be an array");if(0===s.length)throw new Error("there must be at least one case");var a=[],n={};return ee(s,function(e,r){var t=Be(e);if(1!==t.length)throw new Error("one and only one name per case");var i=t[0],o=e[i];if(void 0!==n[i])throw new Error("duplicate key detected:"+i);if("cata"===i)throw new Error("cannot have a case named cata (sorry)");if(!ye(o))throw new Error("case arguments must be an array");a.push(i),n[i]=function(){var e=arguments.length;if(e!==o.length)throw new Error("Wrong number of arguments to case "+i+". Expected "+o.length+" ("+o+"), got "+e);for(var n=new Array(e),t=0;t<n.length;t++)n[t]=arguments[t];return{fold:function(){if(arguments.length!==s.length)throw new Error("Wrong number of arguments to fold. Expected "+s.length+", got "+arguments.length);return arguments[r].apply(null,n)},match:function(e){var t=Be(e);if(a.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+a.join(",")+"\nActual: "+t.join(","));if($(a,function(e){return xe(t,e)}))return e[i].apply(null,n);throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+a.join(", "))},log:function(e){console.log(e,{constructors:a,constructor:i,params:n})}}}}),n}function zt(e){return e.fold(a,a)}var Gt,Yt,Xt,Kt=function(e,t){var n,r,t=String(t).toLowerCase();return 0===e.length?Xe():(r=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e=e,n=t))?Ke((e=function(e){return Number(n.replace(r,"$"+e))})(1),e(2)):{major:0,minor:0}},qt=Xe,Zt=function(e,n){return qe(e,n).map(function(e){var t=Kt(e.versionRegexes,n);return{current:e.name,version:t}})},Qt=function(e,n){return qe(e,n).map(function(e){var t=Kt(e.versionRegexes,n);return{current:e.name,version:t}})},Jt=Je(/^\s+|\s+$/g),en=Je(/^\s+/g),tn=Je(/\s+$/g),nn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,e=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Ze(e,"edge/")&&Ze(e,"chrome")&&Ze(e,"safari")&&Ze(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,nn],search:function(e){return Ze(e,"chrome")&&!Ze(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Ze(e,"msie")||Ze(e,"trident")}},{name:"Opera",versionRegexes:[nn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:et("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:et("firefox")},{name:"Safari",versionRegexes:[nn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Ze(e,"safari")||Ze(e,"mobile/"))&&Ze(e,"applewebkit")}}],t=[{name:"Windows",search:et("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Ze(e,"iphone")||Ze(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:et("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:et("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:et("linux"),versionRegexes:[]},{name:"Solaris",search:et("sunos"),versionRegexes:[]},{name:"FreeBSD",search:et("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:et("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],rn={browsers:_(e),oses:_(t)},on={unknown:function(){return tt({current:void 0,version:qt()})},nu:tt,edge:_("Edge"),chrome:_("Chrome"),ie:_("IE"),opera:_("Opera"),firefox:_("Firefox"),safari:_("Safari")},sn={unknown:function(){return nt({current:void 0,version:qt()})},nu:nt,windows:_("Windows"),ios:_("iOS"),android:_("Android"),linux:_("Linux"),osx:_("OSX"),solaris:_("Solaris"),freebsd:_("FreeBSD"),chromeos:_("ChromeOS")},an=(Xt=!(Gt=function(){return e=navigator.userAgent,t=rt,s=rn.browsers(),a=rn.oses(),s=Zt(s,e).fold(on.unknown,on.nu),a=Qt(a,e).fold(sn.unknown,sn.nu),{browser:s,os:a,deviceType:(s=s,e=e,t=t,n=(a=a).isiOS()&&!0===/ipad/i.test(e),r=a.isiOS()&&!n,i=(o=a.isiOS()||a.isAndroid())||t("(pointer:coarse)"),t=n||!r&&o&&t("(min-device-width:768px)"),o=r||o&&!t,s=s.isSafari()&&a.isiOS()&&!1===/safari/i.test(e),e=!o&&!t&&!s,{isiPad:_(n),isiPhone:_(r),isTablet:_(t),isPhone:_(o),isTouch:_(i),isAndroid:a.isAndroid,isiOS:a.isiOS,isWebView:_(s),isDesktop:_(e)})};var e,t,n,r,i,o,s,a}),function(){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Xt||(Xt=!0,Yt=Gt.apply(null,e)),Yt}()}),nn=navigator.userAgent,e=an(),t=e.browser,n=e.os,e=e.deviceType,ln=/WebKit/.test(nn)&&!t.isEdge(),un="FormData"in window&&"FileReader"in window&&"URL"in window&&!!URL.createObjectURL,nn=-1!==nn.indexOf("Windows Phone"),K={opera:t.isOpera(),webkit:ln,ie:!(!t.isIE()&&!t.isEdge())&&t.version.major,gecko:t.isFirefox(),mac:n.isOSX()||n.isiOS(),iOS:e.isiPad()||e.isiPhone(),android:n.isAndroid(),contentEditable:!0,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:!0,range:window.getSelection&&"Range"in window,documentMode:t.isIE()?document.documentMode||7:10,fileApi:un,ceFalse:!0,cacheSuffix:null,container:null,experimentalShadowDom:!1,canHaveCSP:!t.isIE(),desktop:e.isDesktop(),windowsPhone:nn,browser:{current:t.current,version:t.version,isChrome:t.isChrome,isEdge:t.isEdge,isFirefox:t.isFirefox,isIE:t.isIE,isOpera:t.isOpera,isSafari:t.isSafari},os:{current:n.current,version:n.version,isAndroid:n.isAndroid,isChromeOS:n.isChromeOS,isFreeBSD:n.isFreeBSD,isiOS:n.isiOS,isLinux:n.isLinux,isOSX:n.isOSX,isSolaris:n.isSolaris,isWindows:n.isWindows},deviceType:{isDesktop:e.isDesktop,isiPad:e.isiPad,isiPhone:e.isiPhone,isPhone:e.isPhone,isTablet:e.isTablet,isTouch:e.isTouch,isWebView:e.isWebView}},cn=/^\s*|\s*$/g,te={trim:it,isArray:je,is:ot,toArray:function(e){if(je(e))return e;for(var t=[],n=0,r=e.length;n<r;n++)t[n]=e[n];return t},makeMap:function(e,t,n){var r;for(t=t||",",n=n||{},r=(e="string"==typeof(e=e||[])?e.split(t):e).length;r--;)n[e[r]]={};return n},each:ae,map:ze,grep:Ge,inArray:le,hasOwn:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},extend:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++){var i,o,s=t[r];for(o in s)s.hasOwnProperty(o)&&void 0!==(i=s[o])&&(e[o]=i)}return e},create:function(e,t,n){var r,i,o,s=0,a=(e=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(e))[3].match(/(^|\.)(\w+)$/i)[2],l=this.createNS(e[3].replace(/\.\w+$/,""),n);l[a]||("static"===e[2]?(l[a]=t,this.onCreate&&this.onCreate(e[2],e[3],l[a])):(t[a]||(t[a]=function(){},s=1),l[a]=t[a],this.extend(l[a].prototype,t),e[5]&&(r=this.resolve(e[5]).prototype,i=e[5].match(/\.(\w+)$/i)[1],o=l[a],l[a]=s?function(){return r[i].apply(this,arguments)}:function(){return this.parent=r[i],o.apply(this,arguments)},l[a].prototype[a]=l[a],this.each(r,function(e,t){l[a].prototype[t]=r[t]}),this.each(t,function(e,t){r[t]?l[a].prototype[t]=function(){return this.parent=r[t],e.apply(this,arguments)}:t!==a&&(l[a].prototype[t]=e)})),this.each(t.static,function(e,t){l[a][t]=e})))},walk:st,createNS:function(e,t){var n,r;for(t=t||window,e=e.split("."),n=0;n<e.length;n++)t[r=e[n]]||(t[r]={}),t=t[r];return t},resolve:function(e,t){var n,r;for(t=t||window,n=0,r=(e=e.split(".")).length;n<r&&(t=t[e[n]]);n++);return t},explode:function(e,t){return!e||ot(e,"array")?e:ze(e.split(t||","),it)},_addCacheSuffix:function(e){var t=K.cacheSuffix;return t&&(e+=(-1===e.indexOf("?")?"?":"&")+t),e}},q={fromHtml:function(e,t){t=(t||document).createElement("div");if(t.innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return at(t.childNodes[0])},fromTag:function(e,t){t=(t||document).createElement(e);return at(t)},fromText:function(e,t){t=(t||document).createTextNode(e);return at(t)},fromDom:at,fromPoint:function(e,t,n){return N.from(e.dom.elementFromPoint(t,n)).map(at)}},dn=function(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount},M=function(e,t){return e.dom===t.dom},hn=function(e,t){return e=e.dom,t=t.dom,n=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(e.compareDocumentPosition(t)&n);var n},fn=function(e,t){return an().browser.isIE()?hn(e,t):(e=e.dom)!==(t=t.dom)&&e.contains(t)},Z=("undefined"==typeof window&&Function("return this;")(),function(e){return e.dom.nodeName.toLowerCase()}),pn=dt(1),gn=dt(3),mn=dt(9),yn=dt(11),vn=function(e){return mn(e)?e:ht(e)},bn=function(e){return N.from(e.dom.parentNode).map(q.fromDom)},En=function(e){return N.from(e.dom.previousSibling).map(q.fromDom)},Cn=function(e){return N.from(e.dom.nextSibling).map(q.fromDom)},wn=function(e){return lt(e,Cn)},Sn=function(e){return x(e.dom.childNodes,q.fromDom)},Tn=function(e,t){e=e.dom.childNodes;return N.from(e[t]).map(q.fromDom)},Rn=function(e){return Tn(e,e.dom.childNodes.length-1)},An=function(e){return yn(e)},ln=Se(Element.prototype.attachShadow)&&Se(Node.prototype.getRootNode),_n=_(ln),Nn=ln?function(e){return q.fromDom(e.dom.getRootNode())}:vn,xn=function(e){return q.fromDom(e.dom.host)},On=function(t,n){bn(t).each(function(e){e.dom.insertBefore(n.dom,t.dom)})},In=function(e,t){Cn(e).fold(function(){bn(e).each(function(e){kn(e,t)})},function(e){On(e,t)})},Mn=function(t,n){gt(t).fold(function(){kn(t,n)},function(e){t.dom.insertBefore(n.dom,e.dom)})},kn=function(e,t){e.dom.appendChild(t.dom)},Dn=function(e){e=e.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},Ln=function(e){var t,n,r,i=gn(e)?e.dom.parentNode:e.dom;return null!=i&&null!==i.ownerDocument&&(r=i.ownerDocument,e=q.fromDom(i),e=Nn(e),(An(e)?N.some(e):N.none()).fold(function(){return r.body.contains(i)},(t=Ln,n=xn,function(e){return t(n(e))})))},Pn=Et,Fn=function(e){var e=void 0!==e?e.dom:document,t=e.body.scrollLeft||e.documentElement.scrollLeft,e=e.body.scrollTop||e.documentElement.scrollTop;return Pn(t,e)},Bn=function(e,t,n,r){return{x:e,y:t,width:n,height:r,right:e+n,bottom:t+r}},Q=At(1),Hn=function(e){return Q(e)&&e.hasAttribute("data-mce-bogus")},Un=Nt(["textarea","input"]),A=At(3),Vn=At(8),Wn=At(9),$n=At(11),k=Nt(["br"]),jn=Nt(["img"]),zn=Mt("true"),D=Mt("false"),un=Nt(["td","th"]),Gn=Nt(["video","audio","object","embed"]),Yn=function(e,t,n){if(!(ge(n)||be(n)||Te(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},Xn=function(e,t){e=e.dom.getAttribute(t);return null===e?void 0:e},Kn=function(e,t){return N.from(Xn(e,t))},qn=function(e,t){var n=e.dom,r=window.getComputedStyle(n).getPropertyValue(t);return""!==r||Ln(e)?r:Zn(n,t)},Zn=function(e,t){return kt(e)?e.style.getPropertyValue(t):""},Qn=function(e,t){e=e.dom,e=Zn(e,t);return N.from(e).filter(function(e){return 0<e.length})},Jn=an().browser,er=function(e){return Ie(e,pn)},tr=function(e,t){return e.children&&xe(e.children,t)},nn={},t={exports:nn},nr=nn,rr=t,ir=void 0,or=(function(e){"object"==typeof nr&&void 0!==rr?rr.exports=e():("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=e()}(function(){return function r(i,o,s){function a(t,e){if(!o[t]){if(!i[t]){var n="function"==typeof ir&&ir;if(!e&&n)return n(t,!0);if(l)return l(t,!0);e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}n=o[t]={exports:{}};i[t][0].call(n.exports,function(e){return a(i[t][1][e]||e)},n,n.exports,r,i,o,s)}return o[t].exports}for(var l="function"==typeof ir&&ir,e=0;e<s.length;e++)a(s[e]);return a}({1:[function(e,t,n){var r,i,t=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return(r=setTimeout)(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}var l,u=[],c=!1,d=-1;function h(){c&&l&&(c=!1,l.length?u=l.concat(u):d=-1,u.length)&&f()}function f(){if(!c){var e=a(h);c=!0;for(var t=u.length;t;){for(l=u,u=[];++d<t;)l&&l[d].run();d=-1,t=u.length}l=null,c=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return(i=clearTimeout)(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||c||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=g,t.addListener=g,t.once=g,t.off=g,t.removeListener=g,t.removeAllListeners=g,t.emit=g,t.prependListener=g,t.prependOnceListener=g,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],2:[function(e,d,t){!function(t){function r(){}function o(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(e,this)}function i(n,r){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,o._immediateFn(function(){var e,t=1===n._state?r.onFulfilled:r.onRejected;if(null!==t){try{e=t(n._value)}catch(e){return void a(r.promise,e)}s(r.promise,e)}else(1===n._state?s:a)(r.promise,n._value)})):n._deferreds.push(r)}function s(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof o)return t._state=3,t._value=e,l(t);if("function"==typeof n)return c((r=n,i=e,function(){r.apply(i,arguments)}),t)}t._state=1,t._value=e,l(t)}catch(e){a(t,e)}var r,i}function a(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&o._immediateFn(function(){e._handled||o._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)i(e,e._deferreds[t]);e._deferreds=null}function u(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function c(e,t){var n=!1;try{e(function(e){n||(n=!0,s(t,e))},function(e){n||(n=!0,a(t,e))})}catch(e){n||(n=!0,a(t,e))}}var n=setTimeout;o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,t){var n=new this.constructor(r);return i(this,new u(e,t,n)),n},o.all=function(e){var a=Array.prototype.slice.call(e);return new o(function(i,o){if(0===a.length)return i([]);for(var s=a.length,e=0;e<a.length;e++)!function t(n,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var r=e.then;if("function"==typeof r)return r.call(e,function(e){t(n,e)},o),0}a[n]=e,0==--s&&i(a)}catch(e){o(e)}}(e,a[e])})},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o(function(e){e(t)})},o.reject=function(n){return new o(function(e,t){t(n)})},o.race=function(i){return new o(function(e,t){for(var n=0,r=i.length;n<r;n++)i[n].then(e,t)})},o._immediateFn="function"==typeof t?function(e){t(e)}:function(e){n(e,0)},o._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},o._setImmediateFn=function(e){o._immediateFn=e},o._setUnhandledRejectionFn=function(e){o._unhandledRejectionFn=e},void 0!==d&&d.exports?d.exports=o:this.Promise||(this.Promise=o)}.call(this,e("timers").setImmediate)},{timers:3}],3:[function(l,e,u){!function(e,t){var r=l("process/browser.js").nextTick,n=Function.prototype.apply,i=Array.prototype.slice,o={},s=0;function a(e,t){this._id=e,this._clearFn=t}u.setTimeout=function(){return new a(n.call(setTimeout,window,arguments),clearTimeout)},u.setInterval=function(){return new a(n.call(setInterval,window,arguments),clearInterval)},u.clearTimeout=u.clearInterval=function(e){e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},u.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},u.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},u._unrefActive=u.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},u.setImmediate="function"==typeof e?e:function(e){var t=s++,n=!(arguments.length<2)&&i.call(arguments,1);return o[t]=!0,r(function(){o[t]&&(n?e.apply(null,n):e.call(null),u.clearImmediate(t))}),t},u.clearImmediate="function"==typeof t?t:function(e){delete o[e]}}.call(this,l("timers").setImmediate,l("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(e,t,n){var e=e("promise-polyfill"),r="undefined"!=typeof window?window:Function("return this;")();t.exports={boltExport:r.Promise||e}},{"promise-polyfill":2}]},{},[4])(4)}),t.exports.boltExport),sr=Ht,ar=function(n){function e(e){n().then(e,Ut)}return{map:function(e){return ar(function(){return n().then(e)})},bind:function(t){return ar(function(){return n().then(function(e){return t(e).toPromise()})})},anonBind:function(e){return ar(function(){return n().then(function(){return e.toPromise()})})},toLazy:function(){return sr(e)},toCached:function(){var e=null;return ar(function(){return e=null===e?n():e})},toPromise:n,get:e}},lr=Wt,ur=$t;jt([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);function cr(e,t,n,r,i){return e(n,r)?N.some(n):Se(i)&&i(n)?N.none():t(n,r,i)}function dr(e,t,n){for(var r=e.dom,i=Se(n)?n:m;r.parentNode;){var r=r.parentNode,o=q.fromDom(r);if(t(o))return N.some(o);if(i(o))break}return N.none()}function hr(e,t,n){return dr(e,function(e){return ut(e,t)},n)}function fr(e,t){return t=t,e=void 0===e?document:e.dom,dn(e)?N.none():N.from(e.querySelector(t)).map(q.fromDom)}var pr,gr,mr,yr,vr=function(e,t,n){return cr(function(e,t){return t(e)},dr,e,t,n)},br=function(e,t,n){return cr(ut,hr,e,t,n)},Er=window.Promise||(pr=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},mr=(gr=function(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],_r(e,Cr(Sr,this),Cr(Tr,this))}).immediateFn||"function"==typeof setImmediate&&setImmediate||function(e){setTimeout(e,1)},gr.prototype.catch=function(e){return this.then(null,e)},gr.prototype.then=function(n,r){var i=this;return new gr(function(e,t){wr.call(i,new Ar(n,r,e,t))})},gr.all=function(){var a=Array.prototype.slice.call(1===arguments.length&&pr(arguments[0])?arguments[0]:arguments);return new gr(function(i,o){if(0===a.length)return i([]);for(var s=a.length,e=0;e<a.length;e++)!function t(n,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var r=e.then;if("function"==typeof r)return r.call(e,function(e){t(n,e)},o),0}a[n]=e,0==--s&&i(a)}catch(e){o(e)}}(e,a[e])})},gr.resolve=function(t){return t&&"object"==typeof t&&t.constructor===gr?t:new gr(function(e){e(t)})},gr.reject=function(n){return new gr(function(e,t){t(n)})},gr.race=function(i){return new gr(function(e,t){for(var n=0,r=i.length;n<r;n++)i[n].then(e,t)})},gr);function Cr(e,t){return function(){e.apply(t,arguments)}}function wr(n){var r=this;null!==this._state?mr(function(){var e,t=r._state?n.onFulfilled:n.onRejected;if(null!==t){try{e=t(r._value)}catch(e){return void n.reject(e)}n.resolve(e)}else(r._state?n.resolve:n.reject)(r._value)}):this._deferreds.push(n)}function Sr(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void _r(Cr(t,e),Cr(Sr,this),Cr(Tr,this))}this._state=!0,this._value=e,Rr.call(this)}catch(e){Tr.call(this,e)}}function Tr(e){this._state=!1,this._value=e,Rr.call(this)}function Rr(){for(var e=0,t=this._deferreds.length;e<t;e++)wr.call(this,this._deferreds[e]);this._deferreds=null}function Ar(e,t,n,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r}function _r(e,t,n){var r=!1;try{e(function(e){r||(r=!0,t(e))},function(e){r||(r=!0,n(e))})}catch(e){r||(r=!0,n(e))}}function Nr(e,t){return"number"!=typeof t&&(t=0),setTimeout(e,t)}function xr(e,t){return"number"!=typeof t&&(t=1),setInterval(e,t)}function Or(n,r){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];clearTimeout(i),i=Nr(function(){n.apply(this,e)},r)}var i;return e.stop=function(){clearTimeout(i)},e}var Ir={requestAnimationFrame:function(e,o){yr?yr.then(e):yr=new Er(function(e){for(var t=o=o||document.body,n=window.requestAnimationFrame,r=["ms","moz","webkit"],i=0;i<r.length&&!n;i++)n=window[r[i]+"RequestAnimationFrame"];(n=n||function(e){window.setTimeout(e,0)})(e,t)}).then(e)},setTimeout:Nr,setInterval:xr,setEditorTimeout:function(e,t,n){return Nr(function(){e.removed||t()},n)},setEditorInterval:function(e,t,n){var r=xr(function(){e.removed?clearInterval(r):t()},n);return r},debounce:Or,throttle:Or,clearInterval:function(e){return clearInterval(e)},clearTimeout:function(e){return clearTimeout(e)}};function Mr(c,d){void 0===d&&(d={});function n(e,t,n){var r,e=te._addCacheSuffix(e),i=We(f,e).getOrThunk(function(){return{id:"mce-u"+h++,passed:[],failed:[],count:0}});function o(){u(i.passed,2)}function s(){return u(i.failed,3)}function a(){var e=a;!function(){for(var e=c.styleSheets,t=e.length;t--;){var n=e[t].ownerNode;if(n&&n.id===r.id)return o(),1}}()&&(Date.now()-l<m?Ir.setTimeout(e):s())}(f[e]=i).count++;var l,u=function(e,t){for(var n=e.length;n--;)e[n]();i.status=t,i.passed=[],i.failed=[],r&&(r.onload=null,r.onerror=null,r=null)};t&&i.passed.push(t),n&&i.failed.push(n),1!==i.status&&(2!==i.status?3!==i.status?(i.status=1,t=q.fromTag("link",g.dom),Lt(t,{rel:"stylesheet",type:"text/css",id:i.id}),l=Date.now(),d.contentCssCors&&Dt(t,"crossOrigin","anonymous"),d.referrerPolicy&&Dt(t,"referrerpolicy",d.referrerPolicy),(r=t.dom).onload=a,r.onerror=s,n=t,kn(mt(p),n),Dt(t,"href",e)):s():o())}function r(t){return Vt(function(e){n(t,u(e,_(lr(t))),u(e,_(ur(t))))})}function t(e){var n=te._addCacheSuffix(e);We(f,n).each(function(e){var t;0==--e.count&&(delete f[n],e=e.id,t=mt(p),fr(t,"#"+e).each(Dn))})}var h=0,f={},p=q.fromDom(c),g=vn(p),m=d.maxLoadTime||5e3;return{load:n,loadAll:function(e,t,n){var s,e=x(e,r);s=e,Vt(function(r){var i=[],o=0;0===s.length?r([]):ee(s,function(e,t){var n;e.get((n=t,function(e){i[n]=e,++o>=s.length&&r(i)}))})}).get(function(e){e=function(e){for(var t=[],n=[],r=0,i=e.length;r<i;r++){var o=e[r];(o.isValue()?t:n).push(o)}return{pass:t,fail:n}}(e);0<e.fail.length?n(e.fail.map(zt)):t(e.pass.map(zt))})},unload:t,unloadAll:function(e){ee(e,function(e){t(e)})},_setReferrerPolicy:function(e){d.referrerPolicy=e}}}kr=new WeakMap;var kr,Dr={forElement:function(e,t){var n=Nn(e).dom;return N.from(kr.get(n)).getOrThunk(function(){var e=Mr(n,t);return kr.set(n,e),e})}},J=(Lr.prototype.current=function(){return this.node},Lr.prototype.next=function(e){return this.node=this.findSibling(this.node,"firstChild","nextSibling",e),this.node},Lr.prototype.prev=function(e){return this.node=this.findSibling(this.node,"lastChild","previousSibling",e),this.node},Lr.prototype.prev2=function(e){return this.node=this.findPreviousNode(this.node,"lastChild","previousSibling",e),this.node},Lr.prototype.findSibling=function(e,t,n,r){var i,o;if(e){if(!r&&e[t])return e[t];if(e!==this.rootNode){if(i=e[n])return i;for(o=e.parentNode;o&&o!==this.rootNode;o=o.parentNode)if(i=o[n])return i}}},Lr.prototype.findPreviousNode=function(e,t,n,r){var i;if(e&&(n=e[n],!this.rootNode||n!==this.rootNode)){if(n){if(!r)for(i=n[t];i;i=i[t])if(!i[t])return i;return n}return(r=e.parentNode)&&r!==this.rootNode?r:void 0}},Lr);function Lr(e,t){this.node=e,this.rootNode=t,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}function Pr(t){var n;return function(e){return(n=n||function(e,t){for(var n={},r=0,i=e.length;r<i;r++){var o=e[r];n[String(o)]=t(o,r)}return n}(t,fe)).hasOwnProperty(Z(e))}}function Fr(e){return pn(e)&&!qr(e)}function Br(e){return ci(e)&&e.data[0]===si}function Hr(e){return ci(e)&&e.data[e.data.length-1]===si}function Ur(e){return!Ri(e)&&(Ci(e)?!wi(e.parentNode):Si(e)||Ei(e)||Ti(e)||Vr(e))}function Vr(e){return!1===(Q(t=e)&&"true"===t.getAttribute("unselectable"))&&bi(e);var t}function Wr(e,t){return Ur(e)&&function(e,t){for(e=e.parentNode;e&&e!==t;e=e.parentNode){if(Vr(e))return!1;if(vi(e))return!0}return!0}(e,t)}function $r(e,t){var n,r=e.dom,i=t=void 0===t||t,o=0;if(Ni(r,r))return!1;if(!(n=r.firstChild))return!0;var s,a=new J(n,r);do{if(i){if(Q(s=n)&&"all"===s.getAttribute("data-mce-bogus")){n=a.next(!0);continue}if(Oi(n)){n=a.next();continue}}if(k(n))o++;else if(Ni(n,r))return!1;n=a.next()}while(n);return o<=1}function jr(e,t){return we(e)&&(Ni(e,t)||Fr(q.fromDom(e)))}function zr(e,t){var n,r,i,o={};if(e){for(e=e.split(","),t=t||10,n=0;n<e.length;n+=2)r=String.fromCharCode(parseInt(e[n],t)),Ui[r]||(i="&"+e[n+1]+";",o[r]=i,o[i]=r);return o}}function Gr(e,t){return e.replace(t?Li:Pi,function(e){return Ui[e]||e})}function Yr(e,t){return e.replace(t?Li:Pi,function(e){return 1<e.length?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":Ui[e]||"&#"+e.charCodeAt(0)+";"})}function Xr(e,t,n){return n=n||Wi,e.replace(t?Li:Pi,function(e){return Ui[e]||n[e]||e})}var Kr=Pr(["h1","h2","h3","h4","h5","h6"]),qr=Pr(["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"]),Zr=function(e){return pn(e)&&"br"===Z(e)},Qr=Pr(["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"]),Jr=Pr(["ul","ol","dl"]),ei=Pr(["li","dd","dt"]),ti=Pr(["thead","tbody","tfoot"]),ni=Pr(["td","th"]),ri=Pr(["pre","script","textarea","style"]),ii="\ufeff",oi=" ",si=ii,ai=function(e){return e===ii},li=function(e){return e.replace(/\uFEFF/g,"")},ui=Q,ci=A,di=function(e){return ci(e)&&(e=e.parentNode),ui(e)&&e.hasAttribute("data-mce-caret")},hi=function(e){return ci(e)&&ai(e.data)},fi=function(e){return di(e)||hi(e)},pi=function(e){return e.firstChild!==e.lastChild||!k(e.firstChild)},gi=function(e){var t=e.container();return!!A(t)&&(t.data.charAt(e.offset())===si||e.isAtStart()&&hi(t.previousSibling))},mi=function(e){var t=e.container();return!!A(t)&&(t.data.charAt(e.offset()-1)===si||e.isAtEnd()&&hi(t.nextSibling))},yi=function(e){return e&&e.hasAttribute("data-mce-caret")?(t=(t=e.getElementsByTagName("br"))[t.length-1],Hn(t)&&t.parentNode.removeChild(t),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("_moz_abspos"),e):null;var t},vi=zn,bi=D,Ei=k,Ci=A,wi=Nt(["script","style","textarea"]),Si=Nt(["img","input","textarea","hr","iframe","video","audio","object","embed"]),Ti=Nt(["table"]),Ri=fi,Ai=/^[ \t\r\n]*$/,_i=function(e){return Ai.test(e)},Ni=function(e,t){return Ur(e)&&!1===(t=t,A(n=e)&&_i(n.data)&&!1===function(e,t){t=q.fromDom(t),e=q.fromDom(e),t=w(M,t);return hr(e,"pre,code",t).isSome()}(n,t))||Q(n=e)&&"A"===n.nodeName&&!n.hasAttribute("href")&&(n.hasAttribute("name")||n.hasAttribute("id"))||xi(e);var n},xi=Ot("data-mce-bookmark"),Oi=Ot("data-mce-bogus"),Ii=function(e){return"span"===e.nodeName.toLowerCase()&&"bookmark"===e.getAttribute("data-mce-type")},Mi=function(e,t){return A(e)&&0<e.data.length&&(n=new J(e=e,t=t).prev(!1),e=new J(e,t).next(!1),n=Ee(n)||jr(n,t),e=Ee(e)||jr(e,t),n)&&e;var n},ki=function(e,t,n){var r=n||t;if(!Q(t)||!Ii(t)){for(var i=t.childNodes,o=i.length-1;0<=o;o--)ki(e,i[o],r);Q(t)&&1===(n=t.childNodes).length&&Ii(n[0])&&t.parentNode.insertBefore(n[0],t),$n(n=t)||Wn(n)||Ni(t,r)||Q(n=t)&&0<n.childNodes.length||Mi(t,r)||e.remove(t)}return t},Di=te.makeMap,Li=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Pi=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Fi=/[<>&\"\']/g,Bi=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,Hi={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},Ui={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},Vi={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},Wi=zr("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),$i={encodeRaw:Gr,encodeAllRaw:function(e){return(""+e).replace(Fi,function(e){return Ui[e]||e})},encodeNumeric:Yr,encodeNamed:Xr,getEncodeFunc:function(e,t){var n=zr(t)||Wi,e=Di(e.replace(/\+/g,","));return e.named&&e.numeric?function(e,t){return e.replace(t?Li:Pi,function(e){return void 0!==Ui[e]?Ui[e]:void 0!==n[e]?n[e]:1<e.length?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":"&#"+e.charCodeAt(0)+";"})}:e.named?t?function(e,t){return Xr(e,t,n)}:Xr:e.numeric?Yr:Gr},decode:function(e){return e.replace(Bi,function(e,t){return t?65535<(t="x"===t.charAt(0).toLowerCase()?parseInt(t.substr(1),16):parseInt(t,10))?(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t))):Hi[t]||String.fromCharCode(t):Vi[e]||Wi[e]||(t=e,(e=q.fromTag("div").dom).innerHTML=t,e.textContent)||e.innerText||t})}},ji={},zi={},Gi=te.makeMap,Yi=te.each,Xi=te.extend,Ki=te.explode,qi=te.inArray,Zi=function(e,t){return(e=te.trim(e))?e.split(t||" "):[]},Qi=function(e){function t(e,t,n){function r(e,t){for(var n={},r=0,i=e.length;r<i;r++)n[e[r]]=t||{};return n}var i;t=t||"","string"==typeof(n=n||[])&&(n=Zi(n));for(var o=Zi(e),s=o.length;s--;)i={attributes:r(i=Zi([a,t].join(" "))),attributesOrder:i,children:r(n,zi)},l[o[s]]=i}function n(e,t){for(var n,r,i,o=Zi(e),s=o.length,a=Zi(t);s--;)for(n=l[o[s]],r=0,i=a.length;r<i;r++)n.attributes[a[r]]={},n.attributesOrder.push(a[r])}var a,r,i,o,l={};return ji[e]||(a="id accesskey class dir lang style tabindex title role",r="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",i="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==e&&(a+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",r+=" article aside details dialog figure main header footer hgroup section nav",i+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==e&&(a+=" xml:lang",i=[i,"acronym applet basefont big font strike tt"].join(" "),Yi(Zi("acronym applet basefont big font strike tt"),function(e){t(e,"",i)}),r=[r,"center dir isindex noframes"].join(" "),o=[r,i].join(" "),Yi(Zi("center dir isindex noframes"),function(e){t(e,"",o)})),o=o||[r,i].join(" "),t("html","manifest","head body"),t("head","","base command link meta noscript script style title"),t("title hr noscript br"),t("base","href target"),t("link","href rel media hreflang type sizes hreflang"),t("meta","name http-equiv content charset"),t("style","media type scoped"),t("script","src async defer type charset"),t("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",o),t("address dt dd div caption","",o),t("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",i),t("blockquote","cite",o),t("ol","reversed start type","li"),t("ul","","li"),t("li","value",o),t("dl","","dt dd"),t("a","href target rel media hreflang type",i),t("q","cite",i),t("ins del","cite datetime",o),t("img","src sizes srcset alt usemap ismap width height"),t("iframe","src name width height",o),t("embed","src type width height"),t("object","data type typemustmatch name usemap form width height",[o,"param"].join(" ")),t("param","name value"),t("map","name",[o,"area"].join(" ")),t("area","alt coords shape href target rel media hreflang type"),t("table","border","caption colgroup thead tfoot tbody tr"+("html4"===e?" col":"")),t("colgroup","span","col"),t("col","span"),t("tbody thead tfoot","","tr"),t("tr","","td th"),t("td","colspan rowspan headers",o),t("th","colspan rowspan headers scope abbr",o),t("form","accept-charset action autocomplete enctype method name novalidate target",o),t("fieldset","disabled form name",[o,"legend"].join(" ")),t("label","form for",i),t("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),t("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===e?o:i),t("select","disabled form multiple name required size","option optgroup"),t("optgroup","disabled label","option"),t("option","disabled label selected value"),t("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),t("menu","type label",[o,"li"].join(" ")),t("noscript","",o),"html4"!==e&&(t("wbr"),t("ruby","",[i,"rt rp"].join(" ")),t("figcaption","",o),t("mark rt rp summary bdi","",i),t("canvas","width height",o),t("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[o,"track source"].join(" ")),t("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[o,"track source"].join(" ")),t("picture","","img source"),t("source","src srcset type media sizes"),t("track","kind src srclang label default"),t("datalist","",[i,"option"].join(" ")),t("article section nav aside main header footer","",o),t("hgroup","","h1 h2 h3 h4 h5 h6"),t("figure","",[o,"figcaption"].join(" ")),t("time","datetime",i),t("dialog","open",o),t("command","type label icon disabled checked radiogroup command"),t("output","for form name",i),t("progress","value max",i),t("meter","value min max low high optimum",i),t("details","open",[o,"summary"].join(" ")),t("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==e&&(n("script","language xml:space"),n("style","xml:space"),n("object","declare classid code codebase codetype archive standby align border hspace vspace"),n("embed","align name hspace vspace"),n("param","valuetype type"),n("a","charset name rev shape coords"),n("br","clear"),n("applet","codebase archive code object alt name width height align hspace vspace"),n("img","name longdesc align border hspace vspace"),n("iframe","longdesc frameborder marginwidth marginheight scrolling align"),n("font basefont","size color face"),n("input","usemap align"),n("select"),n("textarea"),n("h1 h2 h3 h4 h5 h6 div p legend caption","align"),n("ul","type compact"),n("li","type"),n("ol dl menu dir","compact"),n("pre","width xml:space"),n("hr","align noshade size width"),n("isindex","prompt"),n("table","summary width frame rules cellspacing cellpadding align bgcolor"),n("col","width align char charoff valign"),n("colgroup","width align char charoff valign"),n("thead","align char charoff valign"),n("tr","align char charoff valign bgcolor"),n("th","axis align char charoff valign nowrap bgcolor width height"),n("form","accept"),n("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),n("tfoot","align char charoff valign"),n("tbody","align char charoff valign"),n("area","nohref"),n("body","background bgcolor text link vlink alink")),"html4"!==e&&(n("input button select textarea","autofocus"),n("input textarea","placeholder"),n("a","download"),n("link script img","crossorigin"),n("img","loading"),n("iframe","sandbox seamless allowfullscreen loading")),Yi(Zi("a form meter progress dfn"),function(e){l[e]&&delete l[e].children[e]}),delete l.caption.children.table,delete l.script,ji[e]=l)},Ji=function(e,n){var r;return e&&(r={},Yi(e="string"==typeof e?{"*":e}:e,function(e,t){r[t]=r[t.toUpperCase()]=("map"===n?Gi:Ki)(e,/[, ]/)})),r};function eo(i){function e(e,t,n){var r=i[e];return r?r=Gi(r,/[, ]/,Gi(r.toUpperCase(),/[, ]/)):(r=ji[e])||(r=Gi(t," ",Gi(t.toUpperCase()," ")),r=Xi(r,n),ji[e]=r),r}function t(e){var t,n,r,i,o,s,a,l,u,c,d,h,f,p,g,m,y,v,b=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/,E=/^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/,C=/[*?+]/;if(e){var w=Zi(e,",");for(S["@"]&&(m=S["@"].attributes,y=S["@"].attributesOrder),t=0,n=w.length;t<n;t++)if(o=b.exec(w[t])){if(p=o[1],u=o[2],g=o[3],l=o[5],s={attributes:h={},attributesOrder:f=[]},"#"===p&&(s.paddEmpty=!0),"-"===p&&(s.removeEmpty=!0),"!"===o[4]&&(s.removeEmptyAttrs=!0),m&&(X(m,function(e,t){h[t]=e}),f.push.apply(f,y)),l)for(r=0,i=(l=Zi(l,"|")).length;r<i;r++)if(o=E.exec(l[r])){if(a={},d=o[1],c=o[2].replace(/[\\:]:/g,":"),p=o[3],v=o[4],"!"===d&&(s.attributesRequired=s.attributesRequired||[],s.attributesRequired.push(c),a.required=!0),"-"===d){delete h[c],f.splice(qi(f,c),1);continue}p&&("="===p&&(s.attributesDefault=s.attributesDefault||[],s.attributesDefault.push({name:c,value:v}),a.defaultValue=v),":"===p&&(s.attributesForced=s.attributesForced||[],s.attributesForced.push({name:c,value:v}),a.forcedValue=v),"<"===p)&&(a.validValues=Gi(v,"?")),C.test(c)?(s.attributePatterns=s.attributePatterns||[],a.pattern=A(c),s.attributePatterns.push(a)):(h[c]||f.push(c),h[c]=a)}m||"@"!==u||(m=h,y=f),g&&(s.outputName=u,S[g]=s),C.test(u)?(s.pattern=A(u),T.push(s)):S[u]=s}}}function n(e){S={},T=[],t(e),Yi(c,function(e,t){a[t]=e.children})}function r(e){var i=/^(~)?(.+)$/;e&&(ji.text_block_elements=ji.block_elements=null,Yi(Zi(e,","),function(e){var e=i.exec(e),t="~"===e[1],n=t?"span":"div",r=e[2];a[r]=a[n],l[r]=n,t||(w[r.toUpperCase()]={},w[r]={}),S[r]||(e=S[n],delete(e=Xi({},e)).removeEmptyAttrs,delete e.removeEmpty,S[r]=e),Yi(a,function(e,t){e[n]&&(a[t]=e=Xi({},a[t]),e[r]=e[n])})}))}function o(e){var r=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;ji[i.schema]=null,e&&Yi(Zi(e,","),function(e){var t,n,e=r.exec(e);e&&(n=e[1],t=n?a[e[2]]:a[e[2]]={"#comment":{}},t=a[e[2]],Yi(Zi(e[3],"|"),function(e){"-"===n?delete t[e]:t[e]={}}))})}function s(e){var t,n=S[e];if(n)return n;for(t=T.length;t--;)if((n=T[t]).pattern.test(e))return n}var S={},a={},T=[],l={},u={},c=Qi((i=i||{}).schema),d=(!1===i.verify_html&&(i.valid_elements="*[*]"),Ji(i.valid_styles)),h=Ji(i.invalid_styles,"map"),f=Ji(i.valid_classes,"map"),p=e("whitespace_elements","pre script noscript style textarea video audio iframe object code"),g=e("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),m=e("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),y=e("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"),v="td th iframe video audio object script code",b=e("non_empty_elements",v+" pre",m),E=e("move_caret_before_on_enter_elements",v+" table",m),C=e("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),w=e("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",C),R=e("text_inline_elements","span strong b em i font strike u var cite dfn code mark q sup sub samp"),A=(Yi((i.special||"script noscript iframe noframes noembed title style textarea xmp").split(" "),function(e){u[e]=new RegExp("</"+e+"[^>]*>","gi")}),function(e){return new RegExp("^"+e.replace(/([?+*])/g,".$1")+"$")});return i.valid_elements?n(i.valid_elements):(Yi(c,function(e,t){S[t]={attributes:e.attributes,attributesOrder:e.attributesOrder},a[t]=e.children}),"html5"!==i.schema&&Yi(Zi("strong/b em/i"),function(e){e=Zi(e,"/");S[e[1]].outputName=e[0]}),Yi(Zi("ol ul sub sup blockquote span font a table tbody strong em b i"),function(e){S[e]&&(S[e].removeEmpty=!0)}),Yi(Zi("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),function(e){S[e].paddEmpty=!0}),Yi(Zi("span"),function(e){S[e].removeEmptyAttrs=!0})),r(i.custom_elements),o(i.valid_children),t(i.extended_valid_elements),o("+ol[ul|ol],+ul[ul|ol]"),Yi({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},function(e,t){S[t]&&(S[t].parentsRequired=Zi(e))}),i.invalid_elements&&Yi(Ki(i.invalid_elements),function(e){S[e]&&delete S[e]}),s("span")||t("span[!data-mce-type|*]"),{children:a,elements:S,getValidStyles:function(){return d},getValidClasses:function(){return f},getBlockElements:function(){return w},getInvalidStyles:function(){return h},getShortEndedElements:function(){return m},getTextBlockElements:function(){return C},getTextInlineElements:function(){return R},getBoolAttrs:function(){return y},getElementRule:s,getSelfClosingElements:function(){return g},getNonEmptyElements:function(){return b},getMoveCaretBeforeOnEnterElements:function(){return E},getWhiteSpaceElements:function(){return p},getSpecialElements:function(){return u},isValidChild:function(e,t){e=a[e.toLowerCase()];return!(!e||!e[t.toLowerCase()])},isValid:function(e,t){var n,r,i=s(e);if(i){if(!t)return!0;if(i.attributes[t])return!0;if(n=i.attributePatterns)for(r=n.length;r--;)if(n[r].pattern.test(e))return!0}return!1},getCustomElements:function(){return l},addValidElements:t,setValidElements:n,addCustomElements:r,addValidChildren:o}}function to(){return!1}function no(){return!0}function ro(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r||!1):e.attachEvent&&e.attachEvent("on"+t,n)}function io(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,r||!1):e.detachEvent&&e.detachEvent("on"+t,n)}function oo(e,t){var n,r,i=t||{};for(n in e)uo[n]||(i[n]=e[n]);return i.target||(i.target=i.srcElement||document),i.composedPath&&(i.composedPath=function(){return e.composedPath()}),e&&lo.test(e.type)&&void 0===e.pageX&&void 0!==e.clientX&&(r=(t=i.target.ownerDocument||document).documentElement,t=t.body,i.pageX=e.clientX+(r&&r.scrollLeft||t&&t.scrollLeft||0)-(r&&r.clientLeft||t&&t.clientLeft||0),i.pageY=e.clientY+(r&&r.scrollTop||t&&t.scrollTop||0)-(r&&r.clientTop||t&&t.clientTop||0)),i.preventDefault=function(){i.isDefaultPrevented=no,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},i.stopPropagation=function(){i.isPropagationStopped=no,e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)},!(i.stopImmediatePropagation=function(){i.isImmediatePropagationStopped=no,i.stopPropagation()})==(i.isDefaultPrevented===no||i.isDefaultPrevented===to)&&(i.isDefaultPrevented=to,i.isPropagationStopped=to,i.isImmediatePropagationStopped=to),void 0===i.metaKey&&(i.metaKey=!1),i}var so=function(e,t,n,r){function i(e){return 1<(e=parseInt(e,10).toString(16)).length?e:"0"+e}return"#"+i(t)+i(n)+i(r)},ao=function(y,e){var a,i,v=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,b=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,E=/\s*([^:]+):\s*([^;]+);?/g,C=/\s+$/,w={},S=ii;y=y||{},e&&(a=e.getValidStyles(),i=e.getInvalidStyles());for(var t=("\\\" \\' \\; \\: ; : "+S).split(" "),T=0;T<t.length;T++)w[t[T]]=S+T,w[S+T]=t[T];return{toHex:function(e){return e.replace(v,so)},parse:function(e){function t(e,t,n){var r=h[e+"-top"+t];if(r){var i=h[e+"-right"+t];if(i){var o=h[e+"-bottom"+t];if(o){var s=h[e+"-left"+t];if(s){var a=[r,i,o,s];for(T=a.length-1;T--&&a[T]===a[T+1];);-1<T&&n||(h[e+t]=-1===T?a[0]:a.join(" "),delete h[e+"-top"+t],delete h[e+"-right"+t],delete h[e+"-bottom"+t],delete h[e+"-left"+t])}}}}}function n(e){var t,n=h[e];if(n){for(t=(n=n.split(" ")).length;t--;)if(n[t]!==n[0])return;return h[e]=n[0],1}}function r(e){return l=!0,w[e]}function i(e){return e.replace(/\\[0-9a-f]+/gi,m)}function o(e,t,n,r,i,o){if(i=i||o)return"'"+(i=g(i)).replace(/\'/g,"\\'")+"'";if(t=g(t||n||r),!y.allow_script_urls){o=t.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(o))return"";if(!y.allow_svg_data_urls&&/^data:image\/svg/i.test(o))return""}return"url('"+(t=f?f.call(p,t,"style"):t).replace(/\'/g,"\\'")+"')"}var s,a,l,u,c,d,h={},f=y.url_converter,p=y.url_converter_scope||this,g=function(e,t){return l&&(e=e.replace(/\uFEFF[0-9]/g,function(e){return w[e]})),e=t?e:e.replace(/\\([\'\";:])/g,"$1")},m=function(e){return String.fromCharCode(parseInt(e.slice(1),16))};if(e){for(e=(e=e.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,r).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(e){return e.replace(/[;:]/g,r)});a=E.exec(e);)if(E.lastIndex=a.index+a[0].length,s=a[1].replace(C,"").toLowerCase(),a=a[2].replace(C,""),s&&a){if(s=i(s),a=i(a),-1!==s.indexOf(S)||-1!==s.indexOf('"'))continue;if(!y.allow_script_urls&&("behavior"===s||/expression\s*\(|\/\*|\*\//.test(a)))continue;"font-weight"===s&&"700"===a?a="bold":"color"!==s&&"background-color"!==s||(a=a.toLowerCase()),a=(a=a.replace(v,so)).replace(b,o),h[s]=l?g(a,!0):a}t("border","",!0),t("border","-width"),t("border","-color"),t("border","-style"),t("padding",""),t("margin",""),c="border-style",d="border-color",n(u="border-width")&&n(c)&&n(d)&&(h.border=h[u]+" "+h[c]+" "+h[d],delete h[u],delete h[c],delete h[d]),"medium none"===h.border&&delete h.border,"none"===h["border-image"]&&delete h["border-image"]}return h},serialize:function(o,r){function e(e){var t,n=a[e];if(n)for(var r=0,i=n.length;r<i;r++)e=n[r],(t=o[e])&&(s+=(0<s.length?" ":"")+e+": "+t+";")}var s="";return r&&a?(e("*"),e(r)):X(o,function(e,t){var n;!e||i&&((n=i["*"])&&n[t]||(n=i[r])&&n[t])||(s+=(0<s.length?" ":"")+t+": "+e+";")}),s}}},lo=/^(?:mouse|contextmenu)|click/,uo={keyLocation:1,layerX:1,layerY:1,returnValue:1,webkitMovementX:1,webkitMovementY:1,keyIdentifier:1,mozPressure:1},co=(ho.prototype.bind=function(e,t,n,r){function i(e){d.executeHandlers(oo(e||h.event),o)}var o,s,a,l,u,c,d=this,h=window;if(e&&3!==e.nodeType&&8!==e.nodeType){e[d.expando]?o=e[d.expando]:(o=d.count++,e[d.expando]=o,d.events[o]={}),r=r||e;for(var f=t.split(" "),p=f.length;p--;)u=i,l=c=!1,"DOMContentLoaded"===(a=f[p])&&(a="ready"),d.domLoaded&&"ready"===a&&"complete"===e.readyState?n.call(r,oo({type:a})):(d.hasMouseEnterLeave||(l=d.mouseEnterLeave[a])&&(u=function(e){var t=e.currentTarget,n=e.relatedTarget;if(n&&t.contains)n=t.contains(n);else for(;n&&n!==t;)n=n.parentNode;n||((e=oo(e||h.event)).type="mouseout"===e.type?"mouseleave":"mouseenter",e.target=t,d.executeHandlers(e,o))}),d.hasFocusIn||"focusin"!==a&&"focusout"!==a||(c=!0,l="focusin"===a?"focus":"blur",u=function(e){(e=oo(e||h.event)).type="focus"===e.type?"focusin":"focusout",d.executeHandlers(e,o)}),(s=d.events[o][a])?"ready"===a&&d.domLoaded?n(oo({type:a})):s.push({func:n,scope:r}):(d.events[o][a]=s=[{func:n,scope:r}],s.fakeName=l,s.capture=c,s.nativeHandler=u,"ready"===a?function(e,t,n){var r,i=e.document,o={type:"ready"};n.domLoaded?t(o):(r=function(){io(e,"DOMContentLoaded",r),io(e,"load",r),n.domLoaded||(n.domLoaded=!0,t(o)),e=null},"complete"===i.readyState||"interactive"===i.readyState&&i.body?r():ro(e,"DOMContentLoaded",r),n.domLoaded||ro(e,"load",r))}(e,u,d):ro(e,l||a,u,c)));return e=s=null,n}},ho.prototype.unbind=function(n,e,t){var r,i,o;if(n&&3!==n.nodeType&&8!==n.nodeType){var s=n[this.expando];if(s){if(o=this.events[s],e){for(var a,l,u,c,d=e.split(" "),h=d.length;h--;)if(c=o[i=d[h]]){if(t)for(r=c.length;r--;)c[r].func===t&&(a=c.nativeHandler,l=c.fakeName,u=c.capture,(c=c.slice(0,r).concat(c.slice(r+1))).nativeHandler=a,c.fakeName=l,c.capture=u,o[i]=c);t&&0!==c.length||(delete o[i],io(n,c.fakeName||i,c.nativeHandler,c.capture))}}else X(o,function(e,t){io(n,e.fakeName||t,e.nativeHandler,e.capture)}),o={};for(i in o)if($e(o,i))return this;delete this.events[s];try{delete n[this.expando]}catch(e){n[this.expando]=null}}}return this},ho.prototype.fire=function(e,t,n){var r;if(e&&3!==e.nodeType&&8!==e.nodeType){var i=oo(null,n);for(i.type=t,i.target=e;(r=e[this.expando])&&this.executeHandlers(i,r),(e=e.parentNode||e.ownerDocument||e.defaultView||e.parentWindow)&&!i.isPropagationStopped(););}return this},ho.prototype.clean=function(e){var t,n;if(e&&3!==e.nodeType&&8!==e.nodeType&&(e[this.expando]&&this.unbind(e),e=e.getElementsByTagName?e:e.document)&&e.getElementsByTagName)for(this.unbind(e),t=(n=e.getElementsByTagName("*")).length;t--;)(e=n[t])[this.expando]&&this.unbind(e);return this},ho.prototype.destroy=function(){this.events={}},ho.prototype.cancel=function(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1},ho.prototype.executeHandlers=function(e,t){var t=this.events[t],n=t&&t[e.type];if(n)for(var r=0,i=n.length;r<i;r++){var o=n[r];if(o&&!1===o.func.call(o.scope,e)&&e.preventDefault(),e.isImmediatePropagationStopped())return}},ho.Event=new ho,ho);function ho(){this.domLoaded=!1,this.events={},this.count=1,this.expando="mce-data-"+(+new Date).toString(32),this.hasMouseEnterLeave="onmouseenter"in document.documentElement,this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}function fo(e,t,n){var r="0x"+t-65536;return r!=r||n?t:r<0?String.fromCharCode(65536+r):String.fromCharCode(r>>10|55296,1023&r|56320)}var d,E,po,go,mo,yo,vo,bo,Eo,Co,wo,So,To,Ro,Ao,_o,No,xo="sizzle"+-new Date,Oo=window.document,Io=0,Mo=0,ko=is(),Do=is(),Lo=is(),Po=function(e,t){return e===t&&(Co=!0),0},Fo="undefined",Bo={}.hasOwnProperty,n=[],Ho=n.pop,Uo=n.push,Vo=n.push,Wo=n.slice,$o=n.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]===e)return t;return-1},r="[\\x20\\t\\r\\n\\f]",e="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ln="\\["+r+"*("+e+")(?:"+r+"*([*^$|!~]?=)"+r+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+e+"))|)"+r+"*\\]",nn=":("+e+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ln+")*)|.*)\\)|)",jo=new RegExp("^"+r+"+|((?:^|[^\\\\])(?:\\\\.)*)"+r+"+$","g"),zo=new RegExp("^"+r+"*,"+r+"*"),Go=new RegExp("^"+r+"*([>+~]|"+r+")"+r+"*"),Yo=new RegExp("="+r+"*([^\\]'\"]*?)"+r+"*\\]","g"),Xo=new RegExp(nn),Ko=new RegExp("^"+e+"$"),qo={ID:new RegExp("^#("+e+")"),CLASS:new RegExp("^\\.("+e+")"),TAG:new RegExp("^("+e+"|[*])"),ATTR:new RegExp("^"+ln),PSEUDO:new RegExp("^"+nn),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+r+"*(even|odd|(([+-]|)(\\d*)n|)"+r+"*(?:([+-]|)"+r+"*(\\d+)|))"+r+"*\\)|)","i"),bool:new RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:new RegExp("^"+r+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+r+"*((?:-\\d)?\\d*)"+r+"*\\)|)(?=[^-]|$)","i")},Zo=/^(?:input|select|textarea|button)$/i,Qo=/^h\d$/i,Jo=/^[^{]+\{\s*\[native \w/,es=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ts=/[+~]/,ns=/'|\\/g,rs=new RegExp("\\\\([\\da-f]{1,6}"+r+"?|("+r+")|.)","ig");try{Vo.apply(n=Wo.call(Oo.childNodes),Oo.childNodes),n[Oo.childNodes.length].nodeType}catch(e){Vo={apply:n.length?function(e,t){Uo.apply(e,Wo.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}function ne(e,t,n,r){var i,o,s,a,l,u,c;if((t?t.ownerDocument||t:Oo)!==So&&wo(t),n=n||[],!e||"string"!=typeof e)return n;if(1!==(i=(t=t||So).nodeType)&&9!==i)return[];if(Ro&&!r){if(u=es.exec(e))if(c=u[1]){if(9===i){if(!(a=t.getElementById(c))||!a.parentNode)return n;if(a.id===c)return n.push(a),n}else if(t.ownerDocument&&(a=t.ownerDocument.getElementById(c))&&No(t,a)&&a.id===c)return n.push(a),n}else{if(u[2])return Vo.apply(n,t.getElementsByTagName(e)),n;if((c=u[3])&&d.getElementsByClassName)return Vo.apply(n,t.getElementsByClassName(c)),n}if(d.qsa&&(!Ao||!Ao.test(e))){if(l=a=xo,u=t,c=9===i&&e,1===i&&"object"!==t.nodeName.toLowerCase()){for(s=mo(e),(a=t.getAttribute("id"))?l=a.replace(ns,"\\$&"):t.setAttribute("id",l),l="[id='"+l+"'] ",o=s.length;o--;)s[o]=l+cs(s[o]);u=ts.test(e)&&ls(t.parentNode)||t,c=s.join(",")}if(c)try{return Vo.apply(n,u.querySelectorAll(c)),n}catch(e){}finally{a||t.removeAttribute("id")}}}return vo(e.replace(jo,"$1"),t,n,r)}function is(){var n=[];function r(e,t){return n.push(e+" ")>E.cacheLength&&delete r[n.shift()],r[e+" "]=t}return r}function os(e){return e[xo]=!0,e}function ss(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||1<<31)-(~e.sourceIndex||1<<31);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function as(s){return os(function(o){return o=+o,os(function(e,t){for(var n,r=s([],e.length,o),i=r.length;i--;)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function ls(e){return e&&typeof e.getElementsByTagName!=Fo&&e}function us(){}function cs(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function ds(s,e,t){var a=e.dir,l=t&&"parentNode"===a,u=Mo++;return e.first?function(e,t,n){for(;e=e[a];)if(1===e.nodeType||l)return s(e,t,n)}:function(e,t,n){var r,i,o=[Io,u];if(n){for(;e=e[a];)if((1===e.nodeType||l)&&s(e,t,n))return!0}else for(;e=e[a];)if(1===e.nodeType||l){if((r=(i=e[xo]||(e[xo]={}))[a])&&r[0]===Io&&r[1]===u)return o[2]=r[2];if((i[a]=o)[2]=s(e,t,n))return!0}}}function hs(i){return 1<i.length?function(e,t,n){for(var r=i.length;r--;)if(!i[r](e,t,n))return!1;return!0}:i[0]}function fs(e,t,n,r,i){for(var o,s=[],a=0,l=e.length,u=null!=t;a<l;a++)!(o=e[a])||n&&!n(o,r,i)||(s.push(o),u&&t.push(a));return s}d=ne.support={},go=ne.isXML=function(e){e=e&&(e.ownerDocument||e).documentElement;return!!e&&"HTML"!==e.nodeName},wo=ne.setDocument=function(e){var l=e?e.ownerDocument||e:Oo,e=l.defaultView;return l!==So&&9===l.nodeType&&l.documentElement?(To=(So=l).documentElement,Ro=!go(l),e&&e!==function(e){try{return e.top}catch(e){}return null}(e)&&(e.addEventListener?e.addEventListener("unload",function(){wo()},!1):e.attachEvent&&e.attachEvent("onunload",function(){wo()})),d.attributes=!0,d.getElementsByTagName=!0,d.getElementsByClassName=Jo.test(l.getElementsByClassName),d.getById=!0,E.find.ID=function(e,t){if(typeof t.getElementById!=Fo&&Ro)return(t=t.getElementById(e))&&t.parentNode?[t]:[]},E.filter.ID=function(e){var t=e.replace(rs,fo);return function(e){return e.getAttribute("id")===t}},E.find.TAG=d.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!=Fo)return t.getElementsByTagName(e)}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"!==e)return o;for(;n=o[i++];)1===n.nodeType&&r.push(n);return r},E.find.CLASS=d.getElementsByClassName&&function(e,t){if(Ro)return t.getElementsByClassName(e)},_o=[],Ao=[],d.disconnectedMatch=!0,Ao=Ao.length&&new RegExp(Ao.join("|")),_o=_o.length&&new RegExp(_o.join("|")),e=Jo.test(To.compareDocumentPosition),No=e||Jo.test(To.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,t=t&&t.parentNode;return e===t||!(!t||1!==t.nodeType||!(n.contains?n.contains(t):e.compareDocumentPosition&&16&e.compareDocumentPosition(t)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},Po=e?function(e,t){var n;return e===t?(Co=!0,0):!e.compareDocumentPosition-!t.compareDocumentPosition||(1&(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!d.sortDetached&&t.compareDocumentPosition(e)===n?e===l||e.ownerDocument===Oo&&No(Oo,e)?-1:t===l||t.ownerDocument===Oo&&No(Oo,t)?1:Eo?$o.call(Eo,e)-$o.call(Eo,t):0:4&n?-1:1)}:function(e,t){if(e===t)return Co=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,s=[e],a=[t];if(!i||!o)return e===l?-1:t===l?1:i?-1:o?1:Eo?$o.call(Eo,e)-$o.call(Eo,t):0;if(i===o)return ss(e,t);for(n=e;n=n.parentNode;)s.unshift(n);for(n=t;n=n.parentNode;)a.unshift(n);for(;s[r]===a[r];)r++;return r?ss(s[r],a[r]):s[r]===Oo?-1:a[r]===Oo?1:0},l):So},ne.matches=function(e,t){return ne(e,null,null,t)},ne.matchesSelector=function(e,t){if((e.ownerDocument||e)!==So&&wo(e),t=t.replace(Yo,"='$1']"),d.matchesSelector&&Ro&&(!_o||!_o.test(t))&&(!Ao||!Ao.test(t)))try{var n=(void 0).call(e,t);if(n||d.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return 0<ne(t,So,null,[e]).length},ne.contains=function(e,t){return(e.ownerDocument||e)!==So&&wo(e),No(e,t)},ne.attr=function(e,t){(e.ownerDocument||e)!==So&&wo(e);var n=E.attrHandle[t.toLowerCase()],n=n&&Bo.call(E.attrHandle,t.toLowerCase())?n(e,t,!Ro):void 0;return void 0!==n?n:d.attributes||!Ro?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},ne.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ne.uniqueSort=function(e){var t,n=[],r=0,i=0;if(Co=!d.detectDuplicates,Eo=!d.sortStable&&e.slice(0),e.sort(Po),Co){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return Eo=null,e},po=ne.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=po(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=po(t);return n},(E=ne.selectors={cacheLength:50,createPseudo:os,match:qo,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(rs,fo),e[3]=(e[3]||e[4]||e[5]||"").replace(rs,fo),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ne.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ne.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return qo.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&Xo.test(n)&&(t=(t=mo(n,!0))&&n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(rs,fo).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=ko[e+" "];return t||(t=new RegExp("(^|"+r+")"+e+"("+r+"|$)"))&&ko(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!=Fo&&e.getAttribute("class")||"")})},ATTR:function(t,n,r){return function(e){e=ne.attr(e,t);return null==e?"!="===n:!n||(e+="","="===n?e===r:"!="===n?e!==r:"^="===n?r&&0===e.indexOf(r):"*="===n?r&&-1<e.indexOf(r):"$="===n?r&&e.slice(-r.length)===r:"~="===n?-1<(" "+e+" ").indexOf(r):"|="===n&&(e===r||e.slice(0,r.length+1)===r+"-"))}},CHILD:function(f,e,t,p,g){var m="nth"!==f.slice(0,3),y="last"!==f.slice(-4),v="of-type"===e;return 1===p&&0===g?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,s,a,l,u=m!=y?"nextSibling":"previousSibling",c=e.parentNode,d=v&&e.nodeName.toLowerCase(),h=!n&&!v;if(c){if(m){for(;u;){for(o=e;o=o[u];)if(v?o.nodeName.toLowerCase()===d:1===o.nodeType)return!1;l=u="only"===f&&!l&&"nextSibling"}return!0}if(l=[y?c.firstChild:c.lastChild],y&&h){for(a=(r=(i=c[xo]||(c[xo]={}))[f]||[])[0]===Io&&r[1],s=r[0]===Io&&r[2],o=a&&c.childNodes[a];o=++a&&o&&o[u]||(s=a=0,l.pop());)if(1===o.nodeType&&++s&&o===e){i[f]=[Io,a,s];break}}else if(h&&(r=(e[xo]||(e[xo]={}))[f])&&r[0]===Io)s=r[1];else for(;(o=++a&&o&&o[u]||(s=a=0,l.pop()))&&((v?o.nodeName.toLowerCase()!==d:1!==o.nodeType)||!++s||(h&&((o[xo]||(o[xo]={}))[f]=[Io,s]),o!==e)););return(s-=g)===p||s%p==0&&0<=s/p}}},PSEUDO:function(e,o){var t,s=E.pseudos[e]||E.setFilters[e.toLowerCase()]||ne.error("unsupported pseudo: "+e);return s[xo]?s(o):1<s.length?(t=[e,e,"",o],E.setFilters.hasOwnProperty(e.toLowerCase())?os(function(e,t){for(var n,r=s(e,o),i=r.length;i--;)e[n=$o.call(e,r[i])]=!(t[n]=r[i])}):function(e){return s(e,0,t)}):s}},pseudos:{not:os(function(e){var r=[],i=[],a=yo(e.replace(jo,"$1"));return a[xo]?os(function(e,t,n,r){for(var i,o=a(e,null,r,[]),s=e.length;s--;)(i=o[s])&&(e[s]=!(t[s]=i))}):function(e,t,n){return r[0]=e,a(r,null,n,i),!i.pop()}}),has:os(function(t){return function(e){return 0<ne(t,e).length}}),contains:os(function(t){return t=t.replace(rs,fo),function(e){return-1<(e.textContent||e.innerText||po(e)).indexOf(t)}}),lang:os(function(n){return Ko.test(n||"")||ne.error("unsupported lang: "+n),n=n.replace(rs,fo).toLowerCase(),function(e){var t;do{if(t=Ro?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=window.location&&window.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===To},focus:function(e){return e===So.activeElement&&(!So.hasFocus||So.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!E.pseudos.empty(e)},header:function(e){return Qo.test(e.nodeName)},input:function(e){return Zo.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(e=e.getAttribute("type"))||"text"===e.toLowerCase())},first:as(function(){return[0]}),last:as(function(e,t){return[t-1]}),eq:as(function(e,t,n){return[n<0?n+t:n]}),even:as(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:as(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:as(function(e,t,n){for(var r=n<0?n+t:n;0<=--r;)e.push(r);return e}),gt:as(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=E.pseudos.eq,ee(["radio","checkbox","file","password","image"],function(e){var t;E.pseudos[e]=(t=e,function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t})}),ee(["submit","reset"],function(e){var n;E.pseudos[e]=(n=e,function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n})}),us.prototype=E.filters=E.pseudos,E.setFilters=new us,mo=ne.tokenize=function(e,t){var n,r,i,o,s,a,l,u=Do[e+" "];if(u)return t?0:u.slice(0);for(s=e,a=[],l=E.preFilter;s;){for(o in n&&!(r=zo.exec(s))||(r&&(s=s.slice(r[0].length)||s),a.push(i=[])),n=!1,(r=Go.exec(s))&&(n=r.shift(),i.push({value:n,type:r[0].replace(jo," ")}),s=s.slice(n.length)),E.filter)!E.filter.hasOwnProperty(o)||!(r=qo[o].exec(s))||l[o]&&!(r=l[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?ne.error(e):Do(e,a).slice(0)},yo=ne.compile=function(e,t){var n,m,y,v,b,r,i=[],o=[],s=Lo[e+" "];if(!s){for(n=(t=t||mo(e)).length;n--;)((s=function e(t){for(var r,n,i,o=t.length,s=E.relative[t[0].type],a=s||E.relative[" "],l=s?1:0,u=ds(function(e){return e===r},a,!0),c=ds(function(e){return-1<$o.call(r,e)},a,!0),d=[function(e,t,n){return!s&&(n||t!==bo)||((r=t).nodeType?u:c)(e,t,n)}];l<o;l++)if(n=E.relative[t[l].type])d=[ds(hs(d),n)];else{if((n=E.filter[t[l].type].apply(null,t[l].matches))[xo]){for(i=++l;i<o&&!E.relative[t[i].type];i++);return function e(f,p,g,m,y,t){return m&&!m[xo]&&(m=e(m)),y&&!y[xo]&&(y=e(y,t)),os(function(e,t,n,r){var i,o,s,a=[],l=[],u=t.length,c=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)ne(e,t[r],n);return n}(p||"*",n.nodeType?[n]:n,[]),d=!f||!e&&p?c:fs(c,a,f,n,r),h=g?y||(e?f:u||m)?[]:t:d;if(g&&g(d,h,n,r),m)for(i=fs(h,l),m(i,[],n,r),o=i.length;o--;)(s=i[o])&&(h[l[o]]=!(d[l[o]]=s));if(e){if(y||f){if(y){for(i=[],o=h.length;o--;)(s=h[o])&&i.push(d[o]=s);y(null,h=[],i,r)}for(o=h.length;o--;)(s=h[o])&&-1<(i=y?$o.call(e,s):a[o])&&(e[i]=!(t[i]=s))}}else h=fs(h===t?h.splice(u,h.length):h),y?y(null,t,h,r):Vo.apply(t,h)})}(1<l&&hs(d),1<l&&cs(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(jo,"$1"),n,l<i&&e(t.slice(l,i)),i<o&&e(t=t.slice(i)),i<o&&cs(t))}d.push(n)}return hs(d)}(t[n]))[xo]?i:o).push(s);(s=Lo(e,(v=0<(y=i).length,b=0<(m=o).length,r=function(e,t,n,r,i){var o,s,a,l=0,u="0",c=e&&[],d=[],h=bo,f=e||b&&E.find.TAG("*",i),p=Io+=null==h?1:Math.random()||.1,g=f.length;for(i&&(bo=t!==So&&t);u!==g&&null!=(o=f[u]);u++){if(b&&o){for(s=0;a=m[s++];)if(a(o,t,n)){r.push(o);break}i&&(Io=p)}v&&((o=!a&&o)&&l--,e)&&c.push(o)}if(l+=u,v&&u!==l){for(s=0;a=y[s++];)a(c,d,t,n);if(e){if(0<l)for(;u--;)c[u]||d[u]||(d[u]=Ho.call(r));d=fs(d)}Vo.apply(r,d),i&&!e&&0<d.length&&1<l+y.length&&ne.uniqueSort(r)}return i&&(Io=p,bo=h),c},v?os(r):r))).selector=e}return s},vo=ne.select=function(e,t,n,r){var i,o,s,a,l,u="function"==typeof e&&e,c=!r&&mo(e=u.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(s=o[0]).type&&d.getById&&9===t.nodeType&&Ro&&E.relative[o[1].type]){if(!(t=(E.find.ID(s.matches[0].replace(rs,fo),t)||[])[0]))return n;u&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(i=qo.needsContext.test(e)?0:o.length;i--&&(s=o[i],!E.relative[a=s.type]);)if((l=E.find[a])&&(r=l(s.matches[0].replace(rs,fo),ts.test(o[0].type)&&ls(t.parentNode)||t))){if(o.splice(i,1),e=r.length&&cs(o))break;return Vo.apply(n,r),n}}return(u||yo(e,c))(r,t,!Ro,n,ts.test(e)&&ls(t.parentNode)||t),n},d.sortStable=xo.split("").sort(Po).join("")===xo,d.detectDuplicates=!!Co,wo(),d.sortDetached=!0;function ps(e){return void 0!==e}function gs(e){return"string"==typeof e}function ms(e,t){var n,r=(t=t||Ns).createElement("div"),i=t.createDocumentFragment();for(r.innerHTML=e;n=r.firstChild;)i.appendChild(n);return i}function ys(e,t,n,r){var i;if(gs(t))t=ms(t,Ts(e[0]));else if(t.length&&!t.nodeType){if(t=re.makeArray(t),r)for(i=t.length-1;0<=i;i--)ys(e,t[i],n,r);else for(i=0;i<t.length;i++)ys(e,t[i],n,r);return e}if(t.nodeType)for(i=e.length;i--;)n.call(e[i],t);return e}function vs(e,t){return e&&t&&-1!==(" "+e.className+" ").indexOf(" "+t+" ")}function bs(e,t,n){var r,i;return t=re(t)[0],e.each(function(){n&&r===this.parentNode||(r=this.parentNode,i=t.cloneNode(!1),this.parentNode.insertBefore(i,this)),i.appendChild(this)}),e}function Es(e,t){return new re.fn.init(e,t)}function Cs(e){return null==e?"":(""+e).replace(Us,"")}function ws(e,t){var n,r,i,o;if(e)if(void 0===(n=e.length)){for(r in e)if(e.hasOwnProperty(r)&&(o=e[r],!1===t.call(o,r,o)))break}else for(i=0;i<n&&(o=e[i],!1!==t.call(o,i,o));i++);return e}function Ss(e,n){var r=[];return ws(e,function(e,t){n(t,e)&&r.push(t)}),r}function Ts(e){return e?9===e.nodeType?e:e.ownerDocument:Ns}function Rs(e,t,n){var r=[],i=e[t];for("string"!=typeof n&&n instanceof re&&(n=n[0]);i&&9!==i.nodeType;){if(void 0!==n){if(i===n)break;if("string"==typeof n&&re(i).is(n))break}1===i.nodeType&&r.push(i),i=i[t]}return r}function As(e,t,n,r){var i=[];for(r instanceof re&&(r=r[0]);e;e=e[t])if(!n||e.nodeType===n){if(void 0!==r){if(e===r)break;if("string"==typeof r&&re(e).is(r))break}i.push(e)}return i}function _s(e,t,n){for(e=e[t];e;e=e[t])if(e.nodeType===n)return e;return null}var Ns=document,xs=Array.prototype.push,Os=Array.prototype.slice,Is=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,Ms=co.Event,ks=te.makeMap("children,contents,next,prev"),Ds=te.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," "),Ls=te.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected"," "),Ps={for:"htmlFor",class:"className",readonly:"readOnly"},Fs={float:"cssFloat"},Bs={},Hs={},Us=/^\s*|\s*$/g;Es.fn=Es.prototype={constructor:Es,selector:"",context:null,length:0,init:function(e,t){var n,r,i=this;if(e)if(e.nodeType)i.context=i[0]=e,i.length=1;else{if(t&&t.nodeType)i.context=t;else{if(t)return re(e).attr(t);i.context=t=document}if(gs(e)){if(!(n="<"===(i.selector=e).charAt(0)&&">"===e.charAt(e.length-1)&&3<=e.length?[null,e,null]:Is.exec(e)))return re(t).find(e);if(n[1])for(r=ms(e,Ts(t)).firstChild;r;)xs.call(i,r),r=r.nextSibling;else{if(!(r=Ts(t).getElementById(n[2])))return i;if(r.id!==n[2])return i.find(e);i.length=1,i[0]=r}}else this.add(e,!1)}return i},toArray:function(){return te.toArray(this)},add:function(e,t){var n,r;if(gs(e))return this.add(re(e));if(!1!==t)for(n=re.unique(this.toArray().concat(re.makeArray(e))),this.length=n.length,r=0;r<n.length;r++)this[r]=n[r];else xs.apply(this,re.makeArray(e));return this},attr:function(t,n){var e,r=this;if("object"==typeof t)ws(t,function(e,t){r.attr(e,t)});else{if(!ps(n)){if(r[0]&&1===r[0].nodeType){if((e=Bs[t])&&e.get)return e.get(r[0],t);if(Ls[t])return r.prop(t)?t:void 0;null===(n=r[0].getAttribute(t,2))&&(n=void 0)}return n}this.each(function(){var e;1===this.nodeType&&((e=Bs[t])&&e.set?e.set(this,n):null===n?this.removeAttribute(t,2):this.setAttribute(t,n,2))})}return r},removeAttr:function(e){return this.attr(e,null)},prop:function(e,t){var n=this;if("object"==typeof(e=Ps[e]||e))ws(e,function(e,t){n.prop(e,t)});else{if(!ps(t))return n[0]&&n[0].nodeType&&e in n[0]?n[0][e]:t;this.each(function(){1===this.nodeType&&(this[e]=t)})}return n},css:function(t,n){function e(e){return e.replace(/-(\D)/g,function(e,t){return t.toUpperCase()})}function r(e){return e.replace(/[A-Z]/g,function(e){return"-"+e})}var i,o,s=this;if("object"==typeof t)ws(t,function(e,t){s.css(e,t)});else if(ps(n))t=e(t),"number"!=typeof n||Ds[t]||(n=n.toString()+"px"),s.each(function(){var e=this.style;if((o=Hs[t])&&o.set)o.set(this,n);else{try{this.style[Fs[t]||t]=n}catch(e){}null!==n&&""!==n||(e.removeProperty?e.removeProperty(r(t)):e.removeAttribute(t))}});else{if(i=s[0],(o=Hs[t])&&o.get)return o.get(i);if(!i.ownerDocument.defaultView)return i.currentStyle?i.currentStyle[e(t)]:"";try{return i.ownerDocument.defaultView.getComputedStyle(i,null).getPropertyValue(r(t))}catch(e){return}}return s},remove:function(){for(var e,t=this.length;t--;)e=this[t],Ms.clean(e),e.parentNode&&e.parentNode.removeChild(e);return this},empty:function(){for(var e,t=this.length;t--;)for(e=this[t];e.firstChild;)e.removeChild(e.firstChild);return this},html:function(t){var n;if(ps(t)){n=this.length;try{for(;n--;)this[n].innerHTML=t}catch(e){re(this[n]).empty().append(t)}return this}return this[0]?this[0].innerHTML:""},text:function(e){var t;if(ps(e)){for(t=this.length;t--;)"innerText"in this[t]?this[t].innerText=e:this[0].textContent=e;return this}return this[0]?this[0].innerText||this[0].textContent:""},append:function(){return ys(this,arguments,function(e){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.appendChild(e)})},prepend:function(){return ys(this,arguments,function(e){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.insertBefore(e,this.firstChild)},!0)},before:function(){return this[0]&&this[0].parentNode?ys(this,arguments,function(e){this.parentNode.insertBefore(e,this)}):this},after:function(){return this[0]&&this[0].parentNode?ys(this,arguments,function(e){this.parentNode.insertBefore(e,this.nextSibling)},!0):this},appendTo:function(e){return re(e).append(this),this},prependTo:function(e){return re(e).prepend(this),this},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){return bs(this,e)},wrapAll:function(e){return bs(this,e,!0)},wrapInner:function(e){return this.each(function(){re(this).contents().wrapAll(e)}),this},unwrap:function(){return this.parent().each(function(){re(this).replaceWith(this.childNodes)})},clone:function(){var e=[];return this.each(function(){e.push(this.cloneNode(!0))}),re(e)},addClass:function(e){return this.toggleClass(e,!0)},removeClass:function(e){return this.toggleClass(e,!1)},toggleClass:function(i,o){var e=this;return"string"==typeof i&&(-1!==i.indexOf(" ")?ws(i.split(" "),function(){e.toggleClass(this,o)}):e.each(function(e,t){var n,r=vs(t,i);r!==o&&(n=t.className,r?t.className=Cs((" "+n+" ").replace(" "+i+" "," ")):t.className+=n?" "+i:i)})),e},hasClass:function(e){return vs(this[0],e)},each:function(e){return ws(this,e)},on:function(e,t){return this.each(function(){Ms.bind(this,e,t)})},off:function(e,t){return this.each(function(){Ms.unbind(this,e,t)})},trigger:function(e){return this.each(function(){"object"==typeof e?Ms.fire(this,e.type,e):Ms.fire(this,e)})},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return new re(Os.apply(this,arguments))},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:function(e){for(var t=[],n=0,r=this.length;n<r;n++)re.find(e,this[n],t);return re(t)},filter:function(n){return re("function"==typeof n?Ss(this.toArray(),function(e,t){return n(t,e)}):re.filter(n,this.toArray()))},closest:function(n){var r=[];return n instanceof re&&(n=n[0]),this.each(function(e,t){for(;t;){if("string"==typeof n&&re(t).is(n)){r.push(t);break}if(t===n){r.push(t);break}t=t.parentNode}}),re(r)},offset:function(e){var t,n,r=0,i=0;return e?this.css(e):((e=this[0])&&(n=(t=e.ownerDocument).documentElement,e.getBoundingClientRect)&&(r=(e=e.getBoundingClientRect()).left+(n.scrollLeft||t.body.scrollLeft)-n.clientLeft,i=e.top+(n.scrollTop||t.body.scrollTop)-n.clientTop),{left:r,top:i})},push:xs,sort:Array.prototype.sort,splice:Array.prototype.splice},te.extend(Es,{extend:te.extend,makeArray:function(e){return e&&e===e.window||e.nodeType?[e]:te.toArray(e)},inArray:function(e,t){var n;if(t.indexOf)return t.indexOf(e);for(n=t.length;n--;)if(t[n]===e)return n;return-1},isArray:te.isArray,each:ws,trim:Cs,grep:Ss,find:ne,expr:ne.selectors,unique:ne.uniqueSort,text:ne.getText,contains:ne.contains,filter:function(e,t,n){var r=t.length;for(n&&(e=":not("+e+")");r--;)1!==t[r].nodeType&&t.splice(r,1);return 1===t.length?re.find.matchesSelector(t[0],e)?[t[0]]:[]:re.find.matches(e,t)}});ws({parent:function(e){e=e.parentNode;return e&&11!==e.nodeType?e:null},parents:function(e){return Rs(e,"parentNode")},next:function(e){return _s(e,"nextSibling",1)},prev:function(e){return _s(e,"previousSibling",1)},children:function(e){return As(e.firstChild,"nextSibling",1)},contents:function(e){return te.toArray(("iframe"===e.nodeName?e.contentDocument||e.contentWindow.document:e).childNodes)}},function(r,i){Es.fn[r]=function(t){var n=[],e=(this.each(function(){var e=i.call(n,this,t,n);e&&(re.isArray(e)?n.push.apply(n,e):n.push(e))}),1<this.length&&(ks[r]||(n=re.unique(n)),0===r.indexOf("parents"))&&(n=n.reverse()),re(n));return t?e.filter(t):e}}),ws({parentsUntil:function(e,t){return Rs(e,"parentNode",t)},nextUntil:function(e,t){return As(e,"nextSibling",1,t).slice(1)},prevUntil:function(e,t){return As(e,"previousSibling",1,t).slice(1)}},function(i,o){Es.fn[i]=function(t,e){var n=[],r=(this.each(function(){var e=o.call(n,this,t,n);e&&(re.isArray(e)?n.push.apply(n,e):n.push(e))}),1<this.length&&(n=re.unique(n),0!==i.indexOf("parents")&&"prevUntil"!==i||(n=n.reverse())),re(n));return e?r.filter(e):r}}),Es.fn.is=function(e){return!!e&&0<this.filter(e).length},Es.fn.init.prototype=Es.fn,Es.overrideDefaults=function(n){function r(e,t){return i=i||n(),0===arguments.length&&(e=i.element),t=t||i.context,new r.fn.init(e,t)}var i;return re.extend(r,this),r},Es.attrHooks=Bs,Es.cssHooks=Hs;function Vs(e,t){var n=t.attr("style"),e=e.serialize(e.parse(n),t[0].nodeName)||null;t.attr("data-mce-style",e)}function Ws(e,t){var n,r,i=0;if(e)for(n=e.nodeType,e=e.previousSibling;e;e=e.previousSibling)r=e.nodeType,(!t||3!==r||r!==n&&e.nodeValue.length)&&(i++,n=r);return i}var re=Es,$s=te.each,js=te.grep,zs=K.ie,Gs=/^([a-z0-9],?)+$/i;function Ys(l,s){function r(e){return(e=N(e))?e.attributes:[]}function n(e,t){var n,r,i=l.body,e=N(e),o=t,s=0,a=0,t=i.ownerDocument;if(o=o||i,e){if(o===i&&e.getBoundingClientRect&&"static"===qn(q.fromDom(i),"position"))return{x:s=(r=e.getBoundingClientRect()).left+(t.documentElement.scrollLeft||i.scrollLeft)-t.documentElement.clientLeft,y:a=r.top+(t.documentElement.scrollTop||i.scrollTop)-t.documentElement.clientTop};for(n=e;n&&n!==o&&n.nodeType&&!tr(n,o);)s+=n.offsetLeft||0,a+=n.offsetTop||0,n=n.offsetParent;for(n=e.parentNode;n&&n!==o&&n.nodeType&&!tr(n,o);)s-=n.scrollLeft||0,a-=n.scrollTop||0,n=n.parentNode;a+=(r=q.fromDom(e),Jn.isFirefox()&&"table"===Z(r)?er(Sn(r)).filter(function(e){return"caption"===Z(e)}).bind(function(r){return er(wn(r)).map(function(e){var e=e.dom.offsetTop,t=r.dom.offsetTop,n=r.dom.offsetHeight;return e<=t?-n:0})}).getOr(0):0)}return{x:s,y:a}}function i(e){var t,n;return e=N(e),t=k(e,"width"),n=k(e,"height"),-1===t.indexOf("px")&&(t=0),-1===n.indexOf("px")&&(n=0),{w:parseInt(t,10)||e.offsetWidth||e.clientWidth,h:parseInt(n,10)||e.offsetHeight||e.clientHeight}}function o(e,t,n,r){var i,o=[],s=N(e);for(r=void 0===r,n=n||("BODY"!==M().nodeName?M().parentNode:null),te.is(t,"string")&&(t="*"===(i=t)?function(e){return 1===e.nodeType}:function(e){return D(e,i)});s&&!(s===n||Ce(s.nodeType)||Wn(s)||$n(s));){if(!t||"function"==typeof t&&t(s)){if(!r)return[s];o.push(s)}s=s.parentNode}return r?o:null}function a(e,t,n){var r=t;if(e)for("string"==typeof t&&(r=function(e){return D(e,t)}),e=e[n];e;e=e[n])if("function"==typeof r&&r(e))return e;return null}function u(e,t,n){return W(l.createElement(e),e,t,n,!0)}function c(e,t){return e=x(e),(t?e.each(function(){for(var e;e=this.firstChild;)3===e.nodeType&&0===e.data.length?this.removeChild(e):this.parentNode.insertBefore(e,this)}):e).remove(),1<e.length?e.toArray():e[0]}function d(e,t,n){x(e).toggleClass(t,n).each(function(){""===this.className&&re(this).attr("class",null)})}function h(t,e,n){return L(e,function(e){return te.is(e,"array")&&(t=t.cloneNode(!0)),n&&$s(js(e.childNodes),function(e){t.appendChild(e)}),e.parentNode.replaceChild(t,e)})}function f(e){if(Q(e)){var t="a"===e.nodeName.toLowerCase()&&!O(e,"href")&&O(e,"id");if(O(e,"name")||O(e,"data-mce-bookmark")||t)return 1}}function p(){return l.createRange()}function g(e){var t;return e&&Q(e)?(t=e.getAttribute("data-mce-contenteditable"))&&"inherit"!==t?t:"inherit"!==e.contentEditable?e.contentEditable:null:null}var m,y,v,b,t=this,E=(void 0===s&&(s={}),{}),C=window,w={},F=0,S=Dr.forElement(q.fromDom(l),{contentCssCors:s.contentCssCors,referrerPolicy:s.referrerPolicy}),T=[],R=s.schema||eo({}),A=ao({url_converter:s.url_converter,url_converter_scope:s.url_converter_scope},s.schema),_=s.ownEvents?new co:co.Event,B=R.getBlockElements(),H=re.overrideDefaults(function(){return{context:l,element:P.getRoot()}}),N=function(e){return e&&l&&ge(e)?l.getElementById(e):e},x=function(e){return H("string"==typeof e?N(e):e)},O=function(e,t,n){var r,i,e=x(e);return i=void 0===(i=e.length?(r=G[t])&&r.get?r.get(e,t):e.attr(t):i)?n||"":i},I=function(e,t,n){""===n&&(n=null);var r,e=x(e),i=e.attr(t);e.length&&((r=G[t])&&r.set?r.set(e,n,t):e.attr(t,n),i!==n)&&s.onSetAttrib&&s.onSetAttrib({attrElm:e,attrName:t,attrValue:n})},M=function(){return s.root_element||l.body},k=function(e,t,n){e=x(e);return n?e.css(t):("float"===(t=t.replace(/-(\D)/g,function(e,t){return t.toUpperCase()}))&&(t=K.browser.isIE()?"styleFloat":"cssFloat"),e[0]&&e[0].style?e[0].style[t]:void 0)},D=function(e,t){if(!e)return!1;if(!Array.isArray(e)){if("*"===t)return 1===e.nodeType;if(Gs.test(t)){for(var n=t.toLowerCase().split(/,/),r=e.nodeName.toLowerCase(),i=n.length-1;0<=i;i--)if(n[i]===r)return!0;return!1}if(e.nodeType&&1!==e.nodeType)return!1}e=Array.isArray(e)?e:[e];return 0<ne(t,e[0].ownerDocument||e[0],null,e).length},L=function(e,n,r){var i,e="string"==typeof e?N(e):e;return!!e&&(te.isArray(e)&&(e.length||0===e.length)?(i=[],$s(e,function(e,t){e&&i.push(n.call(r,"string"==typeof e?N(e):e,t))}),i):n.call(r||t,e))},U=function(e,t){x(e).each(function(e,n){$s(t,function(e,t){I(n,t,e)})})},V=function(e,n){e=x(e);zs?e.each(function(e,t){if(!1!==t.canHaveHTML){for(;t.firstChild;)t.removeChild(t.firstChild);try{t.innerHTML="<br>"+n,t.removeChild(t.firstChild)}catch(e){re("<div></div>").html("<br>"+n).contents().slice(1).appendTo(t)}return n}}):e.html(n)},W=function(e,n,r,i,o){return L(e,function(e){var t="string"==typeof n?l.createElement(n):n;return U(t,r),i&&("string"!=typeof i&&i.nodeType?t.appendChild(i):"string"==typeof i&&V(t,i)),o?t:e.appendChild(t)})},e=$i.decode,$=$i.encodeAllRaw,j=function(e,t,n,r){if(te.isArray(e)){for(var i=e.length,o=[];i--;)o[i]=j(e[i],t,n,r);return o}return!s.collect||e!==l&&e!==C||T.push([e,t,n,r]),_.bind(e,t,n,r||P)},z=function(e,t,n){if(te.isArray(e)){for(var r=e.length,i=[];r--;)i[r]=z(e[r],t,n);return i}if(0<T.length&&(e===l||e===C))for(r=T.length;r--;){var o=T[r];e!==o[0]||t&&t!==o[1]||n&&n!==o[2]||_.unbind(o[0],o[1],o[2])}return _.unbind(e,t,n)},P={doc:l,settings:s,win:C,files:w,stdMode:!0,boxModel:!0,styleSheetLoader:S,boundEvents:T,styles:A,schema:R,events:_,isBlock:function(e){if("string"==typeof e)return!!B[e];if(e){var t=e.nodeType;if(t)return!(1!==t||!B[e.nodeName])}return!1},$:H,$$:x,root:null,clone:function(t,e){var n;return!zs||1!==t.nodeType||e?t.cloneNode(e):(n=l.createElement(t.nodeName),$s(r(t),function(e){I(n,e.nodeName,O(t,e.nodeName))}),n)},getRoot:M,getViewPort:function(e){e=Rt(e);return{x:e.x,y:e.y,w:e.width,h:e.height}},getRect:function(e){e=N(e);var t=n(e),e=i(e);return{x:t.x,y:t.y,w:e.w,h:e.h}},getSize:i,getParent:function(e,t,n){e=o(e,t,n,!1);return e&&0<e.length?e[0]:null},getParents:o,get:N,getNext:function(e,t){return a(e,t,"nextSibling")},getPrev:function(e,t){return a(e,t,"previousSibling")},select:function(e,t){return ne(e,N(t)||s.root_element||l,[])},is:D,add:W,create:u,createHTML:function(e,t,n){var r,i="";for(r in i+="<"+e,t)t.hasOwnProperty(r)&&null!==t[r]&&void 0!==t[r]&&(i+=" "+r+'="'+$(t[r])+'"');return void 0!==n?i+">"+n+"</"+e+">":i+" />"},createFragment:function(e){var t,n=l.createElement("div"),r=l.createDocumentFragment();for(r.appendChild(n),e&&(n.innerHTML=e);t=n.firstChild;)r.appendChild(t);return r.removeChild(n),r},remove:c,setStyle:function(e,t,n){n=ge(t)?x(e).css(t,n):x(e).css(t);s.update_styles&&Vs(A,n)},getStyle:k,setStyles:function(e,t){e=x(e).css(t);s.update_styles&&Vs(A,e)},removeAllAttribs:function(e){return L(e,function(e){for(var t=e.attributes,n=t.length-1;0<=n;n--)e.removeAttributeNode(t.item(n))})},setAttrib:I,setAttribs:U,getAttrib:O,getPos:n,parseStyle:function(e){return A.parse(e)},serializeStyle:function(e,t){return A.serialize(e,t)},addStyle:function(e){var t,n;if(P!==Ys.DOM&&l===document){if(E[e])return;E[e]=!0}(n=l.getElementById("mceDefaultStyles"))||((n=l.createElement("style")).id="mceDefaultStyles",n.type="text/css",(t=l.getElementsByTagName("head")[0]).firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)),n.styleSheet?n.styleSheet.cssText+=e:n.appendChild(l.createTextNode(e))},loadCSS:function(e){ee((e=e||"").split(","),function(e){w[e]=!0,S.load(e,Y)})},addClass:function(e,t){x(e).addClass(t)},removeClass:function(e,t){d(e,t,!1)},hasClass:function(e,t){return x(e).hasClass(t)},toggleClass:d,show:function(e){x(e).show()},hide:function(e){x(e).hide()},isHidden:function(e){return"none"===x(e).css("display")},uniqueId:function(e){return(e||"mce_")+F++},setHTML:V,getOuterHTML:function(e){e="string"==typeof e?N(e):e;return Q(e)?e.outerHTML:re("<div></div>").append(re(e).clone()).html()},setOuterHTML:function(e,t){x(e).each(function(){try{if("outerHTML"in this)return void(this.outerHTML=t)}catch(e){}c(re(this).html(t),!0)})},decode:e,encode:$,insertAfter:function(e,t){var r=N(t);return L(e,function(e){var t=r.parentNode,n=r.nextSibling;return n?t.insertBefore(e,n):t.appendChild(e),e})},replace:h,rename:function(t,e){var n;return t.nodeName!==e.toUpperCase()&&(n=u(e),$s(r(t),function(e){I(n,e.nodeName,O(t,e.nodeName))}),h(n,t,!0)),n||t},findCommonAncestor:function(e,t){for(var n,r=e;r;){for(n=t;n&&r!==n;)n=n.parentNode;if(r===n)break;r=r.parentNode}return!r&&e.ownerDocument?e.ownerDocument.documentElement:r},toHex:function(e){return A.toHex(te.trim(e))},run:L,getAttribs:r,isEmpty:function(e,t){var n,r=0;if(f(e))return!1;if(e=e.firstChild){var i=new J(e,e.parentNode),o=R?R.getWhiteSpaceElements():{};t=t||(R?R.getNonEmptyElements():null);do{if(n=e.nodeType,Q(e)){var s=e.getAttribute("data-mce-bogus");if(s){e=i.next("all"===s);continue}if(s=e.nodeName.toLowerCase(),t&&t[s]){if("br"!==s)return!1;r++,e=i.next();continue}if(f(e))return!1}if(8===n)return!1;if(3===n&&!_i(e.nodeValue))return!1;if(3===n&&e.parentNode&&o[e.parentNode.nodeName]&&_i(e.nodeValue))return!1;e=i.next()}while(e)}return r<=1},createRng:p,nodeIndex:Ws,split:function(e,t,n){var r,i,o=p();if(e&&t)return o.setStart(e.parentNode,Ws(e)),o.setEnd(t.parentNode,Ws(t)),r=o.extractContents(),(o=p()).setStart(t.parentNode,Ws(t)+1),o.setEnd(e.parentNode,Ws(e)+1),o=o.extractContents(),(i=e.parentNode).insertBefore(ki(P,r),e),n?i.insertBefore(n,e):i.insertBefore(t,e),i.insertBefore(ki(P,o),e),c(e),n||t},bind:j,unbind:z,fire:function(e,t,n){return _.fire(e,t,n)},getContentEditable:g,getContentEditableParent:function(e){for(var t=M(),n=null;e&&e!==t&&null===(n=g(e));e=e.parentNode);return n},destroy:function(){if(0<T.length)for(var e=T.length;e--;){var t=T[e];_.unbind(t[0],t[1],t[2])}X(w,function(e,t){S.unload(t),delete w[t]}),ne.setDocument&&ne.setDocument()},isChildOf:function(e,t){for(;e;){if(t===e)return!0;e=e.parentNode}return!1},dumpRng:function(e){return"startContainer: "+e.startContainer.nodeName+", startOffset: "+e.startOffset+", endContainer: "+e.endContainer.nodeName+", endOffset: "+e.endOffset}},G=(m=A,v=function(){return P},b=(y=s).keep_values,e={style:{set:function(e,t){null===t||"object"!=typeof t?(b&&e.attr("data-mce-style",t),null!==t&&"string"==typeof t?(e.removeAttr("style"),e.css(m.parse(t))):e.attr("style",t)):e.css(t)},get:function(e){var t=e.attr("data-mce-style")||e.attr("style");return m.serialize(m.parse(t),e[0].nodeName)}}},b&&(e.href=e.src={set:function(e,t,n){y.url_converter&&(t=y.url_converter.call(y.url_converter_scope||v(),t,n,e[0])),e.attr("data-mce-"+n,t).attr(n,t)},get:function(e,t){return e.attr("data-mce-"+t)||e.attr(t)}}),e);return P}(t=Ys=Ys||{}).DOM=t(document),t.nodeIndex=Ws;var L=Ys,Xs=L.DOM,Ks=te.each,qs=te.grep,Zs=(Qs.prototype._setReferrerPolicy=function(e){this.settings.referrerPolicy=e},Qs.prototype.loadScript=function(e,t,n){function r(){i.remove(o),s&&(s.onerror=s.onload=s=null)}var i=Xs,o=i.uniqueId(),s=document.createElement("script");s.id=o,s.type="text/javascript",s.src=te._addCacheSuffix(e),this.settings.referrerPolicy&&i.setAttrib(s,"referrerpolicy",this.settings.referrerPolicy),s.onload=function(){r(),t()},s.onerror=function(){r(),Se(n)?n():"undefined"!=typeof console&&console.log&&console.log("Failed to load script: "+e)},(document.getElementsByTagName("head")[0]||document.body).appendChild(s)},Qs.prototype.isDone=function(e){return 2===this.states[e]},Qs.prototype.markDone=function(e){this.states[e]=2},Qs.prototype.add=function(e,t,n,r){var i=this.states[e];this.queue.push(e),void 0===i&&(this.states[e]=0),t&&(this.scriptLoadedCallbacks[e]||(this.scriptLoadedCallbacks[e]=[]),this.scriptLoadedCallbacks[e].push({success:t,failure:r,scope:n||this}))},Qs.prototype.load=function(e,t,n,r){return this.add(e,t,n,r)},Qs.prototype.remove=function(e){delete this.states[e],delete this.scriptLoadedCallbacks[e]},Qs.prototype.loadQueue=function(e,t,n){this.loadScripts(this.queue,e,t,n)},Qs.prototype.loadScripts=function(t,e,n,r){var i=this,o=[],s=function(t,e){Ks(i.scriptLoadedCallbacks[e],function(e){Se(e[t])&&e[t].call(e.scope)}),i.scriptLoadedCallbacks[e]=void 0},a=(i.queueLoadedCallbacks.push({success:e,failure:r,scope:n||this}),function(){var e=qs(t);t.length=0,Ks(e,function(e){2!==i.states[e]?3!==i.states[e]?1!==i.states[e]&&(i.states[e]=1,i.loading++,i.loadScript(e,function(){i.states[e]=2,i.loading--,s("success",e),a()},function(){i.states[e]=3,i.loading--,o.push(e),s("failure",e),a()})):s("failure",e):s("success",e)}),i.loading||(e=i.queueLoadedCallbacks.slice(0),i.queueLoadedCallbacks.length=0,Ks(e,function(e){0===o.length?Se(e.success)&&e.success.call(e.scope):Se(e.failure)&&e.failure.call(e.scope,o)}))});a()},Qs.ScriptLoader=new Qs,Qs);function Qs(e){void 0===e&&(e={}),this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=0,this.settings=e}function Js(){return We(ea,ta.get())}var P=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},ea={},ta=P("en"),na={getData:function(){return G(ea,function(e){return I({},e)})},setCode:function(e){e&&ta.set(e)},getCode:function(){return ta.get()},add:function(e,t){var n=ea[e];n||(ea[e]=n={}),X(t,function(e,t){n[t.toLowerCase()]=e})},translate:function(e){function n(e){return Se(e)?Object.prototype.toString.call(e):t(e)?"":""+e}function t(e){return""===e||null==e}function r(e){return e=n(e),We(a,e.toLowerCase()).map(n).getOr(e)}function i(e){return e.replace(/{context:\w+}$/,"")}var o,s,a=Js().getOr({});return t(e)?"":me(o=e)&&$e(o,"raw")?n(e.raw):ye(o=e)&&1<o.length?(s=e.slice(1),i(r(e[0]).replace(/\{([0-9]+)\}/g,function(e,t){return $e(s,t)?n(s[t]):e}))):i(r(e))},isRtl:function(){return Js().bind(function(e){return We(e,"_dir")}).exists(function(e){return"rtl"===e})},hasCode:function(e){return $e(ea,e)}};function ra(){function l(t,n){var e=O(o,function(e){return e.name===t&&e.state===n});ee(e,function(e){return e.callback()})}function u(e){var t;return(t=f[e]?f[e].dependencies:t)||[]}function c(e,t){return"object"==typeof t?t:"string"==typeof e?{prefix:"",resource:t,suffix:""}:{prefix:e.prefix,resource:t,suffix:e.suffix}}function d(i,o,s,a,e){var t,n;h[i]||(0!==(t="string"==typeof o?o:o.prefix+o.resource+o.suffix).indexOf("/")&&-1===t.indexOf("://")&&(t=ra.baseURL+"/"+t),h[i]=t.substring(0,t.lastIndexOf("/")),n=function(){var t,e,n,r;l(i,"loaded"),t=o,e=s,n=a,r=u(i),ee(r,function(e){e=c(t,e);d(e.resource,e,void 0,void 0)}),e&&(n?e.call(n):e.call(Zs))},f[i]?n():Zs.ScriptLoader.add(t,n,a,e))}function e(e,t,n){void 0===n&&(n="added"),$e(f,e)&&"added"===n||$e(h,e)&&"loaded"===n?t():o.push({name:e,state:n,callback:t})}var r=this,i=[],h={},f={},o=[];return{items:i,urls:h,lookup:f,_listeners:o,get:function(e){return f[e]?f[e].instance:void 0},dependencies:u,requireLangPack:function(t,n){!1!==ra.languageLoad&&e(t,function(){var e=na.getCode();!e||n&&-1===(","+(n||"")+",").indexOf(","+e+",")||Zs.ScriptLoader.add(h[t]+"/langs/"+e+".js")},"loaded")},add:function(e,t,n){return i.push(t),f[e]={instance:t,dependencies:n},l(e,"added"),t},remove:function(e){delete h[e],delete f[e]},createUrl:c,addComponents:function(e,t){var n=r.urls[e];ee(t,function(e){Zs.ScriptLoader.add(n+"/"+e)})},load:d,waitFor:e}}(e=ra=ra||{}).PluginManager=e(),e.ThemeManager=e();function ia(e,t){return void 0===(e=Xn(e,t))||""===e?[]:e.split(" ")}function oa(e){return void 0!==e.dom.classList}function sa(e,t){oa(e)?e.dom.classList.add(t):(t=t=t,t=ia(e=e=e,"class").concat([t]),Dt(e,"class",t.join(" ")))}function aa(e,t){return oa(e)&&e.dom.classList.contains(t)}function la(e,t){return t=t,e=void 0===e?document:e.dom,dn(e)?[]:x(e.querySelectorAll(t),q.fromDom)}function ua(t,e){function l(e,t){n(e,function(e){return t(e),e})}function n(e,t){var n=r.get(),t=t(n.hasOwnProperty(e)?n[e]:{listeners:[],previous:P(N.none())});n[e]=t,r.set(n)}var r=P({}),i=Na(function(){var e=r.get(),e=Be(e);(e=Re.call(e,0)).sort(void 0),ee(e,function(e){n(e,function(s){var a=s.previous.get();return ka(t,N.some(e)).fold(function(){var t;a.isSome()&&(l(t=e,function(e){ee(e.listeners,function(e){return e(!1,t)})}),s.previous.set(N.none()))},function(e){var t,n,r,i=e.uid,o=e.name,e=e.elements;a.is(i)||(n=i,r=e,l(t=o,function(e){ee(e.listeners,function(e){return e(!0,t,{uid:n,nodes:x(r,function(e){return e.dom})})})}),s.previous.set(N.some(i)))}),{previous:s.previous,listeners:s.listeners}})})},30);return t.on("remove",function(){i.cancel()}),t.on("NodeChange",function(){i.throttle()}),{addListener:function(e,t){n(e,function(e){return{previous:e.previous,listeners:e.listeners.concat([t])}})}}}function ca(e){var t=(new Date).getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++La+String(t)}function da(e,t){return q.fromDom(e.dom.cloneNode(t))}function ha(e){return da(e,!1)}function fa(e){return da(e,!0)}function pa(e,t,n){function r(e){for(var t;(t=i[e]())&&!A(t)&&!n(t););return N.from(t).filter(A)}void 0===n&&(n=m);var i=new J(e,t);return{current:function(){return N.from(i.current()).filter(A)},next:function(){return r("next")},prev:function(){return r("prev")},prev2:function(){return r("prev2")}}}function ga(t,e){function o(e,t,n,r){if(A(e)){t=r(e,t,e.data);if(-1!==t)return N.some({container:e,offset:t})}return n().bind(function(e){return o(e.container,e.offset,n,r)})}var s=e||function(e){return t.isBlock(e)||k(e)||D(e)};return{backwards:function(e,t,n,r){var i=pa(e,r,s);return o(e,t,function(){return i.prev().map(function(e){return{container:e,offset:e.length}})},n).getOrNull()},forwards:function(e,t,n,r){var i=pa(e,r,s);return o(e,t,function(){return i.next().map(function(e){return{container:e,offset:0}})},n).getOrNull()}}}function ma(e,t){return e=Ha(e),t||(e.left=e.left+e.width),e.right=e.left,e.width=0,e}function ya(e,t,n){return 0<=e&&e<=Math.min(t.height,n.height)/2}function va(e,t){var n=Math.min(t.height/2,e.height/2);return e.bottom-n<t.top||!(e.top>t.bottom)&&ya(t.top-e.bottom,e,t)}function ba(e,t){return e.top>t.bottom||!(e.bottom<t.top)&&ya(t.bottom-e.top,e,t)}function Ea(e){var t=e.startContainer,n=e.startOffset;return t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null}function Ca(e){return e&&/[\r\n\t ]/.test(e)}function wa(e){return!!e.setStart&&!!e.setEnd}function Sa(e){return 0===e.left&&0===e.right&&0===e.top&&0===e.bottom}function Ta(e){function r(e){var t,n;0===e.height||0<i.length&&(n=i[i.length-1],(t=e).left===n.left)&&t.top===n.top&&t.bottom===n.bottom&&t.right===n.right||i.push(e)}function t(e,t){var n=Qa(e.ownerDocument);if(t<e.data.length){if($a(e.data[t]))return;if($a(e.data[t-1])&&(n.setStart(e,t),n.setEnd(e,t+1),!Ja(n)))return r(tl(el(n),!1))}0<t&&(n.setStart(e,t-1),n.setEnd(e,t),Ja(n)||r(tl(el(n),!1))),t<e.data.length&&(n.setStart(e,t),n.setEnd(e,t+1),Ja(n)||r(tl(el(n),!0)))}var n,i=[];if(Xa(e.container()))t(e.container(),e.offset());else if(ja(e.container()))if(e.isAtEnd())n=Za(e.container(),e.offset()),Xa(n)&&t(n,n.data.length),Ga(n)&&!Ka(n)&&r(tl(el(n),!1));else{if(n=Za(e.container(),e.offset()),Xa(n)&&t(n,0),Ga(n)&&e.isAtEnd())return r(tl(el(n),!1)),i;e=Za(e.container(),e.offset()-1),!Ga(e)||Ka(e)||!za(e)&&!za(n)&&Ga(n)||r(tl(el(e),!1)),Ga(n)&&r(tl(el(n),!0))}return i}var Ra,Aa=ra,_a=function(n,r){var i=null;return{cancel:function(){null!==i&&(clearTimeout(i),i=null)},throttle:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];null===i&&(i=setTimeout(function(){n.apply(null,e),i=null},r))}}},Na=function(n,r){var i=null;return{cancel:function(){null!==i&&(clearTimeout(i),i=null)},throttle:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];null!==i&&clearTimeout(i),i=setTimeout(function(){n.apply(null,e),i=null},r)}}},xa=function(e,t){var n=[];return ee(Sn(e),function(e){n=(n=t(e)?n.concat([e]):n).concat(xa(e,t))}),n},Oa=_("mce-annotation"),Ia=_("data-mce-annotation"),Ma=_("data-mce-annotation-uid"),ka=function(r,e){function t(e,t){return(n=e.dom)&&n.hasAttribute&&n.hasAttribute(t)?N.some(Xn(e,t)):N.none();var n}var n=r.selection.getRng(),i=q.fromDom(n.startContainer),o=q.fromDom(r.getBody()),e=e.fold(function(){return"."+Oa()},function(e){return"["+Ia()+'="'+e+'"]'}),n=Tn(i,n.startOffset).getOr(i),i=br(n,e,function(e){return M(e,o)});return i.bind(function(e){return t(e,""+Ma()).bind(function(n){return t(e,""+Ia()).map(function(e){var t=Da(r,n);return{uid:n,name:e,elements:t}})})})},Da=function(e,t){e=q.fromDom(e.getBody());return la(e,"["+Ma()+'="'+t+'"]')},La=0,Pa=function(e,t){var n=ht(e).dom,r=q.fromDom(n.createDocumentFragment()),t=(t=t,(n=(n||document).createElement("div")).innerHTML=t,Sn(q.fromDom(n)));yt(r,t),vt(e),kn(e,r)},Fa=function(e,t,n){return e.isSome()&&t.isSome()?N.some(n(e.getOrDie(),t.getOrDie())):N.none()},Ba=Math.round,Ha=function(e){return e?{left:Ba(e.left),top:Ba(e.top),bottom:Ba(e.bottom),right:Ba(e.right),width:Ba(e.width),height:Ba(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0}},Ua=function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom},Va=function(e,t){return 1===e.nodeType&&e.hasChildNodes()&&(t>=e.childNodes.length&&(t=e.childNodes.length-1),e=e.childNodes[t]),e},Wa=new RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]"),$a=function(e){return"string"==typeof e&&768<=e.charCodeAt(0)&&Wa.test(e)},ja=Q,ln=Ur,za=xt("display","block table"),nn=xt("float","left right"),Ga=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return function(e){for(var t=0;t<n.length;t++)if(!n[t](e))return!1;return!0}}(ja,ln,he(nn)),Ya=he(xt("white-space","pre pre-line pre-wrap")),Xa=A,Ka=k,qa=L.nodeIndex,Za=Va,Qa=function(e){return"createRange"in e?e.createRange():L.DOM.createRng()},Ja=function(e){var t=e.startContainer,n=e.startOffset;return!!(Ca(e.toString())&&Ya(t.parentNode)&&A(t)&&(e=t.data,Ca(e[n-1])||Ca(e[n+1])))},el=function(e){var t,n,r,i,o=e.getClientRects(),o=0<o.length?Ha(o[0]):Ha(e.getBoundingClientRect());return!wa(e)&&Ka(e)&&Sa(o)?(n=(t=e).ownerDocument,r=Qa(n),n=n.createTextNode(oi),(i=t.parentNode).insertBefore(n,t),r.setStart(n,0),r.setEnd(n,1),t=Ha(r.getBoundingClientRect()),i.removeChild(n),t):Sa(o)&&wa(e)?(i=(r=e).startContainer,n=r.endContainer,t=r.startOffset,e=r.endOffset,i===n&&A(n)&&0===t&&1===e?((i=r.cloneRange()).setEndAfter(n),el(i)):null):o},tl=function(e,t){e=ma(e,t);return e.width=1,e.right=e.left+1,e};function y(t,n,e){function r(){return e=e||Ta(y(t,n))}return{container:_(t),offset:_(n),toRange:function(){var e=Qa(t.ownerDocument);return e.setStart(t,n),e.setEnd(t,n),e},getClientRects:r,isVisible:function(){return 0<r().length},isAtStart:function(){return Xa(t),0===n},isAtEnd:function(){return Xa(t)?n>=t.data.length:n>=t.childNodes.length},isEqual:function(e){return e&&t===e.container()&&n===e.offset()},getNode:function(e){return Za(t,e?n-1:n)}}}(Ra=y=y||{}).fromRangeStart=function(e){return Ra(e.startContainer,e.startOffset)},Ra.fromRangeEnd=function(e){return Ra(e.endContainer,e.endOffset)},Ra.after=function(e){return Ra(e.parentNode,qa(e)+1)},Ra.before=function(e){return Ra(e.parentNode,qa(e))},Ra.isAbove=function(e,t){return Fa(Le(t.getClientRects()),Pe(e.getClientRects()),va).getOr(!1)},Ra.isBelow=function(e,t){return Fa(Pe(t.getClientRects()),Le(e.getClientRects()),ba).getOr(!1)},Ra.isAtStart=function(e){return!!e&&e.isAtStart()},Ra.isAtEnd=function(e){return!!e&&e.isAtEnd()},Ra.isTextPosition=function(e){return!!e&&A(e.container())},Ra.isElementPosition=function(e){return!1===Ra.isTextPosition(e)};function nl(e,t){A(t)&&0===t.data.length&&e.remove(t)}function rl(e){return e=e.parentNode,zl(e)?rl(e):e}function il(e){return e?ue(e.childNodes,function(e,t){return zl(t)&&"BR"!==t.nodeName?e=e.concat(il(t)):e.push(t),e},[]):[]}function ol(t){return function(e){return t===e}}function sl(e,t){var n,r,i=[],o=t.container(),t=t.offset();return jl(o)?n=function(e,t){for(;(e=e.previousSibling)&&jl(e);)t+=e.data.length;return t}(o,t):(t>=(r=o.childNodes).length?(n="after",t=r.length-1):n="before",o=r[t]),i.push(Yl(o)),r=function(e,t){var n=[];for(t=t.parentNode;t!==e;t=t.parentNode)n.push(t);return n}(e,o),r=Ge(r,he(Hn)),(i=i.concat(ze(r,Yl))).reverse().join("/")+","+n}function al(e,t){if(t){var t=t.split(","),n=t[0].split("/"),t=1<t.length?t[1]:"before",n=ue(n,function(e,t){var n,r,t=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(t);return t?("text()"===t[1]&&(t[1]="#text"),e=e,n=t[1],t=parseInt(t[2],10),r=il(e),r=Ge(r,function(e,t){return!jl(e)||!jl(r[t-1])}),(r=Ge(r,Nt([n])))[t]):null},e);if(n)if(jl(n)){var r=n;var i=parseInt(t,10);for(var o,s=r,a=0;jl(s);){if(o=s.data.length,a<=i&&i<=a+o){r=s,i-=a;break}if(!jl(s.nextSibling)){r=s,i=o;break}a+=o,s=s.nextSibling}return jl(r)&&i>r.data.length&&(i=r.data.length),F(r,i);return}else return t="after"===t?Gl(n)+1:Gl(n),F(n.parentNode,t);else;}return null}function ll(e,t,n,r,i){var o=r[i?"startContainer":"endContainer"],r=r[i?"startOffset":"endOffset"],s=[],i=0,a=e.getRoot();for(A(o)?s.push(n?function(e,t,n){for(var r=e(t.data.slice(0,n)).length,i=t.previousSibling;i&&A(i);i=i.previousSibling)r+=e(i.data).length;return r}(t,o,r):r):(r>=(t=o.childNodes).length&&t.length&&(i=1,r=Math.max(0,t.length-1)),s.push(e.nodeIndex(t[r],n)+i));o&&o!==a;o=o.parentNode)s.push(e.nodeIndex(o,n));return s}function ul(e,t){var n,r=e[(i=t?"start":"end")+"Container"],i=e[i+"Offset"];Q(r)&&"TR"===r.nodeName&&(r=(n=r.childNodes)[Math.min(t?i:i-1,n.length-1)])&&(i=t?0:r.childNodes.length,e["set"+(t?"Start":"End")](r,i))}function cl(e,t){return Q(e)&&(e=Va(e,t),Xl(e))?e:fi(e)&&(t=(e=A(e)&&di(e)?e.parentNode:e).previousSibling,Xl(t)||(t=e.nextSibling,Xl(t)))?t:void 0}function dl(e,t,n){var r=n.getNode(),i=r?r.nodeName:null,o=n.getRng();return Xl(r)||"IMG"===i?{name:i,index:Kl(n.dom,i,r)}:(r=cl((r=o).startContainer,r.startOffset)||cl(r.endContainer,r.endOffset))?{name:i=r.tagName,index:Kl(n.dom,i,r)}:(r=(i=n).dom,(n={}).start=ll(r,e=e,t=t,o=o,!0),i.isCollapsed()||(n.end=ll(r,e,t,o,!1)),n)}function hl(e,t){var n=e.dom,r=e.getRng(),i=n.uniqueId(),o=e.isCollapsed(),s=e.getNode(),a=s.nodeName;return"IMG"===a?{name:a,index:Kl(n,a,s)}:(a=ql(r.cloneRange()),o||(a.collapse(!1),s=Zl(n,i+"_end",t),$l(n,a,s)),(r=ql(r)).collapse(!0),o=Zl(n,i+"_start",t),$l(n,r,o),e.moveToBookmark({id:i,keep:!0}),{id:i})}function fl(e,t,n){var r=e.getParam(t,n);return-1===r.indexOf("=")?r:(r=e.getParam(t,"","hash")).hasOwnProperty(e.id)?r[e.id]:n}function pl(e){return e.getParam("content_security_policy","")}function gl(e){return e.getParam("forced_root_block_attrs",{})}function ml(e){return e.getParam("automatic_uploads",!0,"boolean")}function yl(e){return e.getParam("icons","","string")}function vl(e){return e.getParam("referrer_policy","","string")}function bl(e){return e.getParam("language","en","string")}function El(e){return e.getParam("indent_use_margin",!1)}function Cl(e){return!1!==(e=e.getParam("object_resizing"))&&!K.iOS&&(ge(e)?e:"table,img,figure.image,div")}function wl(e){return!1!==e.getParam("inline_boundaries")}function Sl(e){var t=li(e);return{count:e.length-t.length,text:t}}function Tl(e,t){var n=t.container(),r=(r=Fe(n.childNodes),(-1===(r=Ne(r,e))?N.none():N.some(r)).map(function(e){return e<t.offset()?F(n,t.offset()-1):t}).getOr(t));return Al(e),r}function Rl(e,t){return F.isTextPosition(t)?(r=t,ou(n=e)&&r.container()===n?(o=Sl((a=n).data.substr(0,(i=r).offset())),s=Sl(a.data.substr(i.offset())),0<(o.text+s.text).length?(au(a),F(a,i.offset()-o.count)):i):lu(n,r)):(s=e,((a=t).container()===s.parentNode?Tl:lu)(s,a));var n,r,i,o,s,a}function Al(e){iu(e)&&fi(e)&&(pi(e)?e.removeAttribute("data-mce-caret"):su(e)),ou(e)&&(au(e),0===e.data.length)&&su(e)}function _l(e,t,n){var r,i,o=ma(t.getBoundingClientRect(),n),e="BODY"===e.tagName?(i=e.ownerDocument.documentElement,r=e.scrollLeft||i.scrollLeft,e.scrollTop||i.scrollTop):(i=e.getBoundingClientRect(),r=e.scrollLeft-i.left,e.scrollTop-i.top);return o.left+=r,o.right+=r,o.top+=e,o.bottom+=e,o.width=1,0<(i=t.offsetWidth-t.clientWidth)&&(n&&(i*=-1),o.left+=i,o.right+=i),o}function Nl(e,s,a,l){function u(){for(var e=la(q.fromDom(s),"*[contentEditable=false],video,audio,embed,object"),t=0;t<e.length;t++){var n,r=e[t].dom,i=r.previousSibling;Hr(i)&&(1===(n=i.data).length?i.parentNode.removeChild(i):i.deleteData(n.length-1,1)),i=r.nextSibling,Br(i)&&(1===(n=i.data).length?i.parentNode.removeChild(i):i.deleteData(0,1))}d&&(Al(d),d=null),h.get().each(function(e){re(e.caret).remove(),h.set(N.none())}),c&&(Ir.clearInterval(c),c=null)}var c,d,h=P(N.none()),f=0<(e=eu(e)).length?e:"p";return{show:function(t,e){var n,r,i,o;return u(),hu(e)?null:(a(e)?(n=f,r=t,(n=(o=e).ownerDocument.createElement(n)).setAttribute("data-mce-caret",r?"before":"after"),n.setAttribute("data-mce-bogus","all"),n.appendChild(((i=document.createElement("br")).setAttribute("data-mce-bogus","1"),i)),i=o.parentNode,r?i.insertBefore(n,o):o.nextSibling?i.insertBefore(n,o.nextSibling):i.appendChild(n),d=n,r=_l(s,e,t),re(d).css("top",r.top),o=re('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(r).appendTo(s)[0],h.set(N.some({caret:o,element:e,before:t})),h.get().each(function(e){t&&re(e.caret).addClass("mce-visual-caret-before")}),c=Ir.setInterval(function(){l()?re("div.mce-visual-caret",s).toggleClass("mce-visual-caret-hidden"):re("div.mce-visual-caret",s).addClass("mce-visual-caret-hidden")},500),(i=e.ownerDocument.createRange()).setStart(d,0),i.setEnd(d,0)):(d=function(e,t){var n,r=e.ownerDocument.createTextNode(si),i=e.parentNode;if(t){if(n=e.previousSibling,ci(n)){if(fi(n))return n;if(Hr(n))return n.splitText(n.data.length-1)}i.insertBefore(r,e)}else{if(n=e.nextSibling,ci(n)){if(fi(n))return n;if(Br(n))return n.splitText(1),n}e.nextSibling?i.insertBefore(r,e.nextSibling):i.appendChild(r)}return r}(e,t),i=e.ownerDocument.createRange(),Ol(d.nextSibling)?(i.setStart(d,0),i.setEnd(d,0)):(i.setStart(d,1),i.setEnd(d,1))),i)},hide:u,getCss:function(){return".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}"},reposition:function(){h.get().each(function(e){var t=_l(s,e.element,e.before);re(e.caret).css(I({},t))})},destroy:function(){return Ir.clearInterval(c)}}}function xl(){return uu.isIE()||uu.isEdge()||uu.isFirefox()}function Ol(e){return cu(e)||du(e)}function Il(e){return Ol(e)||It(e)&&xl()}function Ml(e,t,n,r,i){var o=new J(e,r),r=fu(e)||yu(e);if(t<0){if(r&&n(e=Eu(o.prev,!0)))return e;for(;e=Eu(o.prev,i);)if(n(e))return e}if(0<t){if(r&&n(e=Eu(o.next,!0)))return e;for(;e=Eu(o.next,i);)if(n(e))return e}return null}function kl(e,t,n){return Cu(e.container(),n)===Cu(t.container(),n)}function Dl(e,t){var n;return t&&(n=t.container(),t=t.offset(),vu(n))?n.childNodes[t+e]:null}function Ll(e,t){var n=t.ownerDocument.createRange();return e?(n.setStartBefore(t),n.setEndBefore(t)):(n.setStartAfter(t),n.setEndAfter(t)),n}function Pl(e,t,n){for(var r,i,o,s=e?"previousSibling":"nextSibling";n&&n!==t;){if(r=n[s],mu(r)&&(r=r[s]),fu(r)||pu(r)){if(o=n,Cu(r,i=t)===Cu(o,i))return r;break}if(bu(r))break;n=n.parentNode}return null}function Fl(e,t,n){var r,i,o=w(Pl,!0,t),t=w(Pl,!1,t),s=n.startContainer,a=n.startOffset;if(di(s)){if("before"===(i=(s=vu(s)?s:s.parentNode).getAttribute("data-mce-caret"))&&(r=s.nextSibling,Il(r)))return wu(r);if("after"===i&&(r=s.previousSibling,Il(r)))return Su(r)}if(n.collapsed&&A(s)){if(mu(s)){if(1===e){if(r=t(s))return wu(r);if(r=o(s))return Su(r)}if(-1===e){if(r=o(s))return Su(r);if(r=t(s))return wu(r)}return n}if(Hr(s)&&a>=s.data.length-1)return 1===e&&(r=t(s))?wu(r):n;if(Br(s)&&a<=1)return-1===e&&(r=o(s))?Su(r):n;if(a===s.data.length)return(r=t(s))?wu(r):n;if(0===a)return(r=o(s))?Su(r):n}return n}function Bl(e,t){return N.from(Dl(e?0:-1,t)).filter(fu)}function Hl(e,t,n){return t=Fl(e,t,n),-1===e?y.fromRangeStart(t):y.fromRangeEnd(t)}function Ul(e,t){for(;t=e(t);)if(t.isVisible())return t;return t}function Vl(e,t){return!((t=kl(e,t))||!k(e.getNode()))||t}var Wl,F=y,$l=function(e,t,n){var r,i,o,s,a;$n(n)?(r=e,i=t,s=N.from((o=n).firstChild),a=N.from(o.lastChild),i.insertNode(o),s.each(function(e){return nl(r,e.previousSibling)}),a.each(function(e){return nl(r,e.nextSibling)})):(i=e,t.insertNode(o=n),nl(i,o.previousSibling),nl(i,o.nextSibling))},jl=A,zl=Hn,Gl=L.nodeIndex,Yl=function(e){var r,t;return(jl(e)?"text()":e.nodeName.toLowerCase())+"["+(r=il(rl(e=e)),t=ce(r,ol(e),e),r=r.slice(0,t+1),t=ue(r,function(e,t,n){return jl(t)&&jl(r[n-1])&&e++,e},0),r=Ge(r,Nt([e.nodeName])),ce(r,ol(e),e)-t)+"]"},Xl=D,Kl=function(e,t,n){var r=0;return te.each(e.select(t),function(e){if("all"!==e.getAttribute("data-mce-bogus"))return e!==n&&void r++}),r},ql=function(e){return ul(e,!0),ul(e,!1),e},Zl=function(e,t,n){t={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return n?e.create("span",t,"&#xFEFF;"):e.create("span",t)},Ql=w(dl,a,!0),Jl=L.DOM,eu=function(e){return e.getParam("force_p_newlines",!1)?"p":!1===(e=e.getParam("forced_root_block","p"))?"":!0===e?"p":e},tu=function(e){return e.getParam("event_root")},nu=function(e){return e.getParam("theme")},ru=function(e){return e.getParam("plugins","","string")},iu=Q,ou=A,su=function(e){var t=e.parentNode;t&&t.removeChild(e)},au=function(e){for(var t;-1!==(t=e.data.lastIndexOf(si));)e.deleteData(t,1)},lu=function(e,t){return Al(e),t},uu=an().browser,cu=D,du=Gn,hu=un,fu=D,pu=Gn,gu=xt("display","block table table-cell table-caption list-item"),mu=fi,yu=di,vu=Q,bu=Ur,Eu=function(e,t){for(var n;n=e(t);)if(!yu(n))return n;return null},Cu=function(e,t){for(;e&&e!==t;){if(gu(e))return e;e=e.parentNode}return null},wu=w(Ll,!0),Su=w(Ll,!1),Tu=function(e){return N.from(e.getNode()).map(q.fromDom)};(n=Wl=Wl||{})[n.Backwards=-1]="Backwards",n[n.Forwards=1]="Forwards";function Ru(e){return Si(e)||!!Vr(e=e)&&!0!==W(Fe(e.getElementsByTagName("*")),function(e,t){return e||vi(t)},!1)}function Au(e,t){return e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null}function _u(e,t){if(0<e){if(Dc(t.previousSibling)&&!Ic(t.previousSibling))return F.before(t);if(Ic(t))return F(t,0)}if(e<0){if(Dc(t.nextSibling)&&!Ic(t.nextSibling))return F.after(t);if(Ic(t))return F(t,t.data.length)}return e<0&&!kc(t)?F.after(t):F.before(t)}function Nu(t){return{next:function(e){return Pc(Wl.Forwards,e,t)},prev:function(e){return Pc(Wl.Backwards,e,t)}}}function xu(e){return F.isTextPosition(e)?0===e.offset():Ur(e.getNode())}function Ou(e){var t;return F.isTextPosition(e)?(t=e.container(),e.offset()===t.data.length):Ur(e.getNode(!0))}function Iu(e,t){return!F.isTextPosition(e)&&!F.isTextPosition(t)&&e.getNode()===t.getNode(!0)}function Mu(e,t,n){return t=Nu(t),N.from(e?t.next(n):t.prev(n))}function ku(i,o,s){return Mu(i,o,s).bind(function(e){return kl(s,e,o)&&(n=s,r=e,(t=i)?!Iu(n,r)&&!(!F.isTextPosition(t=n)&&k(t.getNode()))&&Ou(n)&&xu(r):!Iu(r,n)&&xu(n)&&Ou(r))?Mu(i,o,e):N.some(e);var t,n,r})}function Du(e,t){var n,r=e?t.firstChild:t.lastChild;return A(r)?N.some(F(r,e?0:r.data.length)):r?Ur(r)?N.some(e?F.before(r):k(n=r)?F.before(n):F.after(n)):(n=t,t=r,e=(r=e)?F.before(t):F.after(t),Mu(r,n,e)):N.none()}function Lu(e,t){return Q(t)&&e.isBlock(t)&&!t.innerHTML&&!K.ie&&(t.innerHTML='<br data-mce-bogus="1" />'),t}function Pu(e,t,n){return!(!1!==t.hasChildNodes()||!jc(e,t)||(e=n,t=(n=t).ownerDocument.createTextNode(si),n.appendChild(t),e.setStart(t,0),e.setEnd(t,0),0))}function Fu(e,t,n,r){var i,o,s,a=n[t?"start":"end"],l=e.getRoot();if(a){for(n=a[0],o=l,i=a.length-1;1<=i;i--){if(s=o.childNodes,Pu(l,o,r))return 1;if(a[i]>s.length-1)return!!Pu(l,o,r)||function(t){return Vc(o).fold(function(){return!1},function(e){return t.setStart(e.container(),e.offset()),t.setEnd(e.container(),e.offset()),!0})}(r);o=s[a[i]]}3===o.nodeType&&(n=Math.min(a[0],o.nodeValue.length)),1===o.nodeType&&(n=Math.min(a[0],o.childNodes.length)),t?r.setStart(o,n):r.setEnd(o,n)}return 1}function Bu(e){return A(e)&&0<e.data.length}function Hu(e,t,n){var r,i,o,s,a=e.get(n.id+"_"+t),l=n.keep;if(a){if(o=a.parentNode,r="start"===t?l?a.hasChildNodes()?(o=a.firstChild,1):Bu(a.nextSibling)?(o=a.nextSibling,0):Bu(a.previousSibling)?(o=a.previousSibling,a.previousSibling.data.length):(o=a.parentNode,e.nodeIndex(a)+1):e.nodeIndex(a):l?a.hasChildNodes()?(o=a.firstChild,1):Bu(a.previousSibling)?(o=a.previousSibling,a.previousSibling.data.length):(o=a.parentNode,e.nodeIndex(a)):e.nodeIndex(a),o=o,s=r,!l){for(l=a.previousSibling,i=a.nextSibling,te.each(te.grep(a.childNodes),function(e){A(e)&&(e.nodeValue=e.nodeValue.replace(/\uFEFF/g,""))});a=e.get(n.id+"_"+t);)e.remove(a,!0);l&&i&&l.nodeType===i.nodeType&&A(l)&&!K.opera&&(r=l.nodeValue.length,l.appendData(i.nodeValue),e.remove(i),o=l,s=r)}return N.some(F(o,s))}return N.none()}function Uu(e,t,n){return 2===t?dl(li,n,e):3===t?(r=(n=e).getRng(),{start:sl(n.dom.getRoot(),F.fromRangeStart(r)),end:sl(n.dom.getRoot(),F.fromRangeEnd(r))}):t?{rng:e.getRng()}:hl(e,!1);var r}function Vu(t,e){zc(t,e).each(function(e){t.setRng(e)})}function Wu(e){return _c===e}function $u(e){return""!==e&&-1!==" \f\n\r\t\v".indexOf(e)}function ju(e){return!$u(e)&&!Wu(e)}function zu(e){return!!e.nodeType}function Gu(e,t,n){var r,i,o,s=n.startOffset,a=n.startContainer;if(!(n.startContainer===n.endContainer&&(o=n.startContainer.childNodes[n.startOffset])&&/^(IMG)$/.test(o.nodeName)||1!==a.nodeType))for(s<(o=a.childNodes).length?(a=o[s],r=new J(a,e.getParent(a,e.isBlock))):(a=o[o.length-1],(r=new J(a,e.getParent(a,e.isBlock))).next(!0)),i=r.current();i;i=r.next())if(3===i.nodeType&&!qu(i))return n.setStart(i,0),t.setRng(n)}function Yu(e,t,n){if(e){var r=t?"nextSibling":"previousSibling";for(e=n?e:e[r];e;e=e[r])if(1===e.nodeType||!qu(e))return e}}function Xu(e,t){return zu(t)&&(t=t.nodeName),!!e.schema.getTextBlockElements()[t.toLowerCase()]}function Ku(e,t,n){return e.schema.isValidChild(t,n)}function qu(e,t){return void 0===t&&(t=!1),!(!we(e)||!A(e))&&(t=t?e.data.replace(/ /g," "):e.data,_i(t))}function Zu(e,n){return"string"!=typeof e?e=e(n):n&&(e=e.replace(/%(\w+)/g,function(e,t){return n[t]||e})),e}function Qu(e,t){return e=""+((e=e||"").nodeName||e),t=""+((t=t||"").nodeName||t),e.toLowerCase()===t.toLowerCase()}function Ju(e,t,n){return"color"!==n&&"backgroundColor"!==n||(t=e.toHex(t)),"fontWeight"===n&&700===t&&(t="bold"),""+(t="fontFamily"===n?t.replace(/[\'\"]/g,"").replace(/,\s+/g,","):t)}function ec(e,t,n){return Ju(e,e.getStyle(t,n),n)}function tc(t,e){var n;return t.getParent(e,function(e){return(n=t.getStyle(e,"text-decoration"))&&"none"!==n}),n}function nc(e,t,n){return e.getParents(t,n,e.getRoot())}function rc(t,e,n){function i(e){return Ve(e,function(e,t){return Oe(r,function(e){return e===t})})}var r=["inline","block","selector","attributes","styles","classes"];return Oe(t.formatter.get(e),function(e){var r=i(e);return Oe(t.formatter.get(n),function(e){var t,e=i(e),n=r;return s(t=void 0===t?l:t).eq(n,e)})})}function ic(e){return se(e,"block")}function oc(e){return se(e,"selector")}function sc(e){return se(e,"inline")}function ac(e,t){for(var n=t;n;){if(Q(n)&&e.getContentEditable(n))return"false"===e.getContentEditable(n)?n:t;n=n.parentNode}return t}function lc(e,t,n,r){for(var i=t.data,o=n;e?0<=o:o<i.length;e?o--:o++)if(r(i.charAt(o)))return e?o+1:o;return-1}function uc(e,t,n){return lc(e,t,n,function(e){return Wu(e)||$u(e)})}function cc(e,t,n){return lc(e,t,n,ju)}function dc(i,e,t,n,o,r){function s(e,t,n){var r=ga(i),r=o?r.backwards:r.forwards;return N.from(r(e,t,function(e,t){return Yc(e.parentNode)?-1:n(o,a=e,t)},l))}var a,l=i.getParent(t,i.isBlock)||e;return s(t,n,uc).bind(function(e){return r?s(e.container,e.offset+(o?-1:0),cc):N.some(e)}).orThunk(function(){return a?N.some({container:a,offset:o?0:a.length}):N.none()})}function hc(e,t,n,r,i){A(r)&&0===r.nodeValue.length&&r[i]&&(r=r[i]);for(var o=Xc(e,r),s=0;s<o.length;s++)for(var a=0;a<t.length;a++){var l=t[a];if(!("collapsed"in l&&l.collapsed!==n.collapsed)&&e.is(o[s],l.selector))return o[s]}return r}function fc(t,e,n,r){var i,o,s=t.dom,a=s.getRoot();if((o=e[0].wrapper?o:s.getParent(n,e[0].block,a))||(i=s.getParent(n,"LI,TD,TH"),o=s.getParent(A(n)?n.parentNode:n,function(e){return e!==a&&qc(t,e)},i)),!(o=o&&e[0].wrapper?Xc(s,o,"ul,ol").reverse()[0]||o:o))for(o=n;o[r]&&!s.isBlock(o[r])&&(o=o[r],!Qu(o,"br")););return o||n}function pc(e,t,n,r){var i=n.parentNode;return!we(n[r])&&(!(i!==t&&!Ce(i)&&!e.isBlock(i))||pc(e,t,i,r))}function gc(e,t,n,r,i){var o,s,a=n,l=i?"previousSibling":"nextSibling",u=e.getRoot();if(!A(n)||Kc(n)||!(i?0<r:r<n.data.length))for(;;){if(!t[0].block_expand&&e.isBlock(a))return a;for(o=a[l];o;o=o[l]){var c=A(o)&&!pc(e,u,o,l);if(!Yc(o)&&(!k(s=o)||!s.getAttribute("data-mce-bogus")||s.nextSibling)&&!Kc(o,c))return a}if(a===u||a.parentNode===u){n=a;break}a=a.parentNode}return n}function mc(e){return Yc(e.parentNode)||Yc(e)}function yc(e,t,a){function l(e){var t=e[0];return 3===t.nodeType&&t===i&&o>=t.nodeValue.length&&e.splice(0,1),t=e[e.length-1],0===c&&0<e.length&&t===s&&3===t.nodeType&&e.splice(e.length-1,1),e}function u(e,t,n){for(var r=[];e&&e!==n;e=e[t])r.push(e);return r}function n(e,t){do{if(e.parentNode===t)return e}while(e=e.parentNode)}function r(e,t,n){var r=n?"nextSibling":"previousSibling",i=e;for(i.parentNode;i&&i!==t;i=o){var o=i.parentNode,s=u(i===e?i:i[r],r);s.length&&(n||s.reverse(),a(l(s)))}}var i=t.startContainer,o=t.startOffset,s=t.endContainer,c=t.endOffset;if(1===i.nodeType&&i.hasChildNodes()&&(i=Qc(i,o)),1===s.nodeType&&s.hasChildNodes()&&(s=Qc(s,c-1)),i===s)return a(l([i]));for(var d=e.findCommonAncestor(i,s),h=i;h;h=h.parentNode){if(h===s)return r(i,d,!0);if(h===d)break}for(h=s;h;h=h.parentNode){if(h===i)return r(s,d);if(h===d)break}t=n(i,d)||i,e=n(s,d)||s,r(i,t,!0),(t=u(t===i?t:t.nextSibling,"nextSibling",e===s?e.nextSibling:e)).length&&a(l(t)),r(s,e)}function vc(e){var t=[];if(e)for(var n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t}function bc(e,t){return 0<(t=la(t,"td[data-mce-selected],th[data-mce-selected]")).length?t:O(ke(e,function(e){e=Ea(e);return e?[q.fromDom(e)]:[]}),ni)}function Ec(t){return gt(t).fold(_([t]),function(e){return[t].concat(Ec(e))})}function Cc(t){return Rn(t).fold(_([t]),function(e){return"br"===Z(e)?En(e).map(function(e){return[t].concat(Cc(e))}).getOr([]):[t].concat(Cc(e))})}function wc(n,e){return Fa((t=e.startContainer,r=e.startOffset,A(t)?0===r?N.some(q.fromDom(t)):N.none():N.from(t.childNodes[r]).map(q.fromDom)),(t=e.endContainer,r=e.endOffset,A(t)?r===t.data.length?N.some(q.fromDom(t)):N.none():N.from(t.childNodes[r-1]).map(q.fromDom)),function(e,t){e=Ie(Ec(n),w(M,e)),t=Ie(Cc(n),w(M,t));return e.isSome()&&t.isSome()}).getOr(!1);var t,r}function Sc(e,t,n,r){var i=n,o=new J(n,i),s=Ve(e.schema.getMoveCaretBeforeOnEnterElements(),function(e,t){return!xe(["td","th","table"],t.toLowerCase())});do{if(A(n)&&0!==te.trim(n.nodeValue).length)return r?t.setStart(n,0):t.setEnd(n,n.nodeValue.length);if(s[n.nodeName])return r?t.setStartBefore(n):"BR"===n.nodeName?t.setEndBefore(n):t.setEndAfter(n)}while(n=r?o.next():o.prev());"BODY"===i.nodeName&&(r?t.setStart(i,0):t.setEnd(i,i.childNodes.length))}function Tc(e){return(e=e.selection.getSel())&&0<e.rangeCount}function Rc(e){return nd.get(e)}function Ac(i){n={};var n,e,r,o={register:function(e,t){n[e]={name:e,settings:t}},lookup:function(e){return n.hasOwnProperty(e)?N.from(n[e]).map(function(e){return e.settings}):N.none()}},s=(r=o,(e=i).on("init",function(){e.serializer.addNodeFilter("span",function(e){ee(e,function(t){var e=t;N.from(e.attr(Ia())).bind(r.lookup).each(function(e){!1===e.persistent&&t.unwrap()})})})}),ua(i));return{register:function(e,t){o.register(e,t)},annotate:function(t,n){o.lookup(t).each(function(e){var o,s,a,l;s=t,a=e,l=n,(o=i).undoManager.transact(function(){var e,t,n=o.selection,r=n.getRng(),i=0<Jc(o).length;r.collapsed&&!i&&(t=Zc(e=o,r=r,[{inline:!0}]),r.setStart(t.startContainer,t.startOffset),r.setEnd(t.endContainer,t.endOffset),e.selection.setRng(r)),n.getRng().collapsed&&!i?(t=rd(o.getDoc(),l,s,a.decorate),Pa(t,oi),n.getRng().insertNode(t.dom),n.select(t.dom)):td(n,!1,function(){ed(o,function(e){id(o,e,s,a.decorate,l)})})})})},annotationChanged:function(e,t){s.addListener(e,t)},remove:function(e){ka(i,N.some(e)).each(function(e){e=e.elements;ee(e,bt)})},getAll:function(e){var t=q.fromDom(i.getBody()),t=la(t,"["+Ia()+'="'+e+'"]'),r={};return ee(t,function(e){var t=Xn(e,Ma()),n=r.hasOwnProperty(t)?r[t]:[];r[t]=n.concat([e])}),G(r,function(e){return x(e,function(e){return e.dom})})}}}var _c,Nc,xc,Oc=D,Ic=A,Mc=Q,kc=k,Dc=Ur,Lc=Wr,Pc=function(e,t,n){var r,i,o;if(!Mc(n)||!t)return null;if(t.isEqual(F.after(n))&&n.lastChild){if(o=F.after(n.lastChild),e<0&&Dc(n.lastChild)&&Mc(n.lastChild))return kc(n.lastChild)?F.before(n.lastChild):o}else o=t;var s,a,l,t=o.container(),u=o.offset();if(Ic(t)){if(e<0&&0<u)return F(t,--u);if(0<e&&u<t.length)return F(t,++u);r=t}else{if(e<0&&0<u&&(a=Au(t,u-1),Dc(a)))return!Ru(a)&&(i=Ml(a,e,Lc,a))?Ic(i)?F(i,i.data.length):F.after(i):Ic(a)?F(a,a.data.length):F.before(a);if(0<e&&u<t.childNodes.length&&(a=Au(t,u),Dc(a)))return kc(a)?(u=n,(l=(s=a).nextSibling)&&Dc(l)?Ic(l)?F(l,0):F.before(l):Pc(Wl.Forwards,F.after(s),u)):!Ru(a)&&(i=Ml(a,e,Lc,a))?Ic(i)?F(i,0):F.before(i):Ic(a)?F(a,0):F.after(a);r=a||o.getNode()}return(0<e&&o.isAtEnd()||e<0&&o.isAtStart())&&(r=Ml(r,e,fe,n,!0),Lc(r,n))?_u(e,r):(a=Ml(r,e,Lc,n),!(l=de(O(function(e,t){for(var n=[];e&&e!==t;)n.push(e),e=e.parentNode;return n}(t,n),Oc)))||a&&l.contains(a)?a?_u(e,a):null:0<e?F.after(l):F.before(l))},Fc=function(t,n,e,r){return ku(t,n,e).bind(function(e){return r(e)?Fc(t,n,e,r):N.some(e)})},Bc=w(Mu,!0),Hc=w(Mu,!1),Uc=w(Du,!0),Vc=w(Du,!1),Wc="_mce_caret",$c=function(e){return Q(e)&&e.id===Wc},jc=function(e,t){for(;t&&t!==e;){if(t.id===Wc)return t;t=t.parentNode}return null},zc=function(e,t){var n,r,i,o,s,a,e=e.dom;if(t){if(te.isArray(t.start))return s=t,a=(o=e).createRng(),Fu(o,!0,s,a)&&Fu(o,!1,s,a)?N.some(a):N.none();if("string"==typeof t.start)return N.some((o=t,a=(s=e).createRng(),i=al(s.getRoot(),o.start),a.setStart(i.container(),i.offset()),i=al(s.getRoot(),o.end),a.setEnd(i.container(),i.offset()),a));if(t.hasOwnProperty("id"))return o=Hu(r=e,"start",s=t),i=Hu(r,"end",s),Fa(o,i.or(o),function(e,t){var n=r.createRng();return n.setStart(Lu(r,e.container()),e.offset()),n.setEnd(Lu(r,t.container()),t.offset()),n});if(t.hasOwnProperty("name"))return n=e,N.from(n.select((a=t).name)[a.index]).map(function(e){var t=n.createRng();return t.selectNode(e),t});if(t.hasOwnProperty("rng"))return N.some(t.rng)}return N.none()},Gc=function(e){return Q(e)&&"SPAN"===e.tagName&&"bookmark"===e.getAttribute("data-mce-type")},Yc=(_c=oi,Gc),Xc=nc,Kc=qu,qc=Xu,Zc=function(e,t,n,r){void 0===r&&(r=!1);var i=t.startContainer,o=t.startOffset,s=t.endContainer,a=t.endOffset,l=e.dom;return Q(i)&&i.hasChildNodes()&&(i=Va(i,o),A(i))&&(o=0),Q(s)&&s.hasChildNodes()&&(s=Va(s,t.collapsed?a:a-1),A(s))&&(a=s.nodeValue.length),i=ac(l,i),s=ac(l,s),mc(i)&&(i=Yc(i)?i:i.parentNode,i=t.collapsed?i.previousSibling||i:i.nextSibling||i,A(i))&&(o=t.collapsed?i.length:0),mc(s)&&(s=Yc(s)?s:s.parentNode,s=t.collapsed?s.nextSibling||s:s.previousSibling||s,A(s))&&(a=t.collapsed?0:s.length),t.collapsed&&(dc(l,e.getBody(),i,o,!0,r).each(function(e){var t=e.container,e=e.offset;i=t,o=e}),dc(l,e.getBody(),s,a,!1,r).each(function(e){var t=e.container,e=e.offset;s=t,a=e})),(n[0].inline||n[0].block_expand)&&(n[0].inline&&A(i)&&0!==o||(i=gc(l,n,i,o,!0)),n[0].inline&&A(s)&&a!==s.nodeValue.length||(s=gc(l,n,s,a,!1))),n[0].selector&&!1!==n[0].expand&&!n[0].inline&&(i=hc(l,n,t,i,"previousSibling"),s=hc(l,n,t,s,"nextSibling")),(n[0].block||n[0].selector)&&(i=fc(e,n,i,"previousSibling"),s=fc(e,n,s,"nextSibling"),n[0].block)&&(l.isBlock(i)||(i=gc(l,n,i,o,!0)),l.isBlock(s)||(s=gc(l,n,s,a,!1))),Q(i)&&(o=l.nodeIndex(i),i=i.parentNode),Q(s)&&(a=l.nodeIndex(s)+1,s=s.parentNode),{startContainer:i,startOffset:o,endContainer:s,endOffset:a}},Qc=function(e,t){var n=e.childNodes;return t>=n.length?t=n.length-1:t<0&&(t=0),n[t]||e},Jc=function(e){return bc(vc(e.selection.getSel()),q.fromDom(e.getBody()))},ed=function(n,r){var e=Jc(n);0<e.length?ee(e,function(e){var e=e.dom,t=n.dom.createRng();t.setStartBefore(e),t.setEndAfter(e),r(t,!0)}):r(n.selection.getRng(),!1)},td=function(e,t,n){t=hl(e,t);n(t),e.moveToBookmark(t)},nd=(Nc=gn,{get:function(e){if(Nc(e))return xc(e).getOr("");throw new Error("Can only get text value of a text node")},getOption:xc=function(e){return Nc(e)?N.from(e.dom.nodeValue):N.none()},set:function(e,t){if(!Nc(e))throw new Error("Can only set raw text value of a text node");e.dom.nodeValue=t}}),rd=function(e,t,n,r){var i=t.uid,i=void 0===i?ca("mce-annotation"):i,t=function(e,t){var n={};for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n}(t,["uid"]),e=q.fromTag("span",e);sa(e,Oa()),Dt(e,""+Ma(),i),Dt(e,""+Ia(),n);var o,n=r(i,t),r=n.attributes,i=n.classes,t=void 0===i?[]:i;return Lt(e,void 0===r?{}:r),o=e,ee(t,function(e){sa(o,e)}),e},id=function(a,e,t,n,r){function i(e){var t,n,r,i,o;switch(n=a,i="span",o=Z(r=e),bn(r).fold(function(){return"skipping"},function(e){return"br"===o||gn(t=r)&&Rc(t)===si?"valid":pn(t=r)&&aa(t,Oa())?"existing":$c(r.dom)?"caret":Ku(n,i,o)&&Ku(n,Z(e),i)?"valid":"invalid-child";var t})){case"invalid-child":d();var s=Sn(e);h(s),d();break;case"valid":var s=c.get().getOrThunk(function(){var e=ha(u);return l.push(e),c.set(N.some(e)),e});On(t=e,s=s),kn(s,t)}}var l=[],u=rd(a.getDoc(),r,t,n),c=P(N.none()),d=function(){c.set(N.none())},h=function(e){ee(e,i)};return yc(a.dom,e,function(e){d(),e=x(e,q.fromDom),h(e)}),l};function od(e){return{getBookmark:w(Uu,e),moveToBookmark:w(Vu,e)}}(od=od||{}).isBookmarkNode=Gc;function sd(e,t){for(;t&&t!==e;){if(zn(t)||D(t))return t;t=t.parentNode}return null}function ad(t,n,e){if(!e.collapsed){if(K.browser.isIE()&&e.startOffset===e.endOffset-1&&e.startContainer===e.endContainer){var r=e.startContainer.childNodes[e.startOffset];if(Q(r))return Oe(r.getClientRects(),function(e){return Ua(e,t,n)})}return Oe(e.getClientRects(),function(e){return Ua(e,t,n)})}}function ld(n,a){function o(e){return e&&("IMG"===e.nodeName||a.dom.is(e,"figure.image"))}function B(e){var t,n,r,i=e.target;t=e,n=a.selection.getRng(),("longpress"!==t.type&&0!==t.type.indexOf("touch")?!o(t.target)||ad(t.clientX,t.clientY,n):(r=t.touches[0],!o(t.target)||ad(r.clientX,r.clientY,n)))||e.isDefaultPrevented()||a.selection.select(i)}function s(e){P(),F();var r=(t=S.getPos(e,x)).x,i=t.y,o=(t=e.getBoundingClientRect()).width||t.right-t.left,s=t.height||t.bottom-t.top,t=(u!==e&&(u=e,b=E=0),a.fire("ObjectSelected",{target:e}));M(e)&&!t.isDefaultPrevented()?T(O,function(t,n){var e=S.get("mceResizeHandle"+n);e&&S.remove(e),e=S.add(x,"div",{id:"mceResizeHandle"+n,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+n+"-resize; margin:0; padding:0"}),11===K.ie&&(e.contentEditable=!1),S.bind(e,"mousedown",function(e){e.stopImmediatePropagation(),e.preventDefault(),f=e.screenX,p=e.screenY,g=I(u).clientWidth,m=I(u).clientHeight,y=m/g,(h=t).name=n,h.startPos={x:o*t[0]+r,y:s*t[1]+i},C=x.scrollWidth,w=x.scrollHeight,c=u.cloneNode(!0),S.addClass(c,"mce-clonedresizable"),S.setAttrib(c,"data-mce-bogus","all"),c.contentEditable=!1,c.unSelectabe=!0,S.setStyles(c,{left:r,top:i,margin:0}),k(c,o,s),c.removeAttribute("data-mce-selected"),x.appendChild(c),S.bind(R,"mousemove",D),S.bind(R,"mouseup",L),A!==R&&(S.bind(A,"mousemove",D),S.bind(A,"mouseup",L)),d=S.add(x,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},g+" &times; "+m)}),t.elm=e,S.setStyles(e,{left:o*t[0]+r-e.offsetWidth/2,top:s*t[1]+i-e.offsetHeight/2})}):P(),u.setAttribute("data-mce-selected","1")}function r(e){function t(e,t){if(e)do{if(e===t)return 1}while(e=e.parentNode)}v||a.removed||(T(S.select("img[data-mce-selected],hr[data-mce-selected]"),function(e){e.removeAttribute("data-mce-selected")}),e="mousedown"===e.type?e.target:n.getNode(),t(e=S.$(e).closest("table,img,figure.image,hr")[0],x)&&(l(),t(n.getStart(!0),e))&&t(n.getEnd(!0),e)?s(e):P())}function i(e){return yd(sd(a.getBody(),e))}function l(){try{a.getDoc().execCommand("enableObjectResizing",!1,"false")}catch(e){}}var u,c,d,h,f,p,g,m,y,v,b,E,C,w,S=a.dom,T=te.each,R=a.getDoc(),A=document,_=Math.abs,N=Math.round,x=a.getBody(),O={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},I=function(e){return a.dom.is(e,"figure.image")?e.querySelector("img"):e},M=function(e){var t=Cl(a);return!!t&&"false"!==e.getAttribute("data-mce-resize")&&e!==a.getBody()&&ut(q.fromDom(e),t)},k=function(e,t,n){S.setStyles(I(e),{width:t,height:n})},D=function(e){var t,n=e.screenX-f,r=e.screenY-p;b=n*h[2]+g,E=r*h[3]+m,b=b<5?5:b,E=E<5?5:E,(o(u)&&!1!==a.getParam("resize_img_proportional",!0,"boolean")?!H.modifierPressed(e):H.modifierPressed(e))&&(_(n)>_(r)?(E=N(b*y),b=N(E/y)):(b=N(E/y),E=N(b*y))),k(c,b,E),e=0<(e=h.startPos.x+n)?e:0,t=0<(t=h.startPos.y+r)?t:0,S.setStyles(d,{left:e,top:t,display:"block"}),d.innerHTML=b+" &times; "+E,h[2]<0&&c.clientWidth<=b&&S.setStyle(c,"left",void 0+(g-b)),h[3]<0&&c.clientHeight<=E&&S.setStyle(c,"top",void 0+(m-E)),(n=x.scrollWidth-C)+(r=x.scrollHeight-w)!=0&&S.setStyles(d,{left:e-n,top:t-r}),v||(e=u,n=g,t=m,r="corner-"+h.name,a.fire("ObjectResizeStart",{target:e,width:n,height:t,origin:r}),v=!0)},L=function(){var e=v;v=!1;function t(e,t){t&&(u.style[e]||!a.schema.isValid(u.nodeName.toLowerCase(),e)?S.setStyle(I(u),e,t):S.setAttrib(I(u),e,""+t))}var n,r,i;e&&(t("width",b),t("height",E)),S.unbind(R,"mousemove",D),S.unbind(R,"mouseup",L),A!==R&&(S.unbind(A,"mousemove",D),S.unbind(A,"mouseup",L)),S.remove(c),S.remove(d),s(u),e&&(e=u,n=b,r=E,i="corner-"+h.name,a.fire("ObjectResized",{target:e,width:n,height:r,origin:i}),S.setAttrib(u,"style",S.getAttrib(u,"style"))),a.nodeChanged()},P=function(){F(),u&&u.removeAttribute("data-mce-selected"),X(O,function(e,t){t=S.get("mceResizeHandle"+t);t&&(S.unbind(t),S.remove(t))})},F=function(){X(O,function(e){e.elm&&(S.unbind(e.elm),delete e.elm)})};return a.on("init",function(){l(),(K.browser.isIE()||K.browser.isEdge())&&(a.on("mousedown click",function(e){var t=e.target,n=t.nodeName;v||!/^(TABLE|IMG|HR)$/.test(n)||i(t)||(2!==e.button&&a.selection.select(t,"TABLE"===n),"mousedown"===e.type&&a.nodeChanged())}),S.bind(x,"mscontrolselect",e=function(e){function t(e){Ir.setEditorTimeout(a,function(){return a.selection.select(e)})}i(e.target)||Gn(e.target)?(e.preventDefault(),t(e.target)):/^(TABLE|IMG|HR)$/.test(e.target.nodeName)&&(e.preventDefault(),"IMG"===e.target.tagName)&&t(e.target)}),a.on("remove",function(){return S.unbind(x,"mscontrolselect",e)}));var e,t=Ir.throttle(function(e){a.composing||r(e)});a.on("nodechange ResizeEditor ResizeWindow ResizeContent drop FullscreenStateChanged",t),a.on("keyup compositionend",function(e){u&&"TABLE"===u.nodeName&&t(e)}),a.on("hide blur",P),a.on("contextmenu longpress",B,!0)}),a.on("remove",F),{isResizable:M,showResizeRect:s,hideResizeRect:P,updateResizeRect:r,destroy:function(){u=c=null}}}function ud(e){return zn(e)||D(e)}function cd(t,n,r){var i,e,o=r;if(o.caretPositionFromPoint)(e=o.caretPositionFromPoint(t,n))&&((i=r.createRange()).setStart(e.offsetNode,e.offset),i.collapse(!0));else if(r.caretRangeFromPoint)i=r.caretRangeFromPoint(t,n);else if(o.body.createTextRange){i=o.body.createTextRange();try{i.moveToPoint(t,n),i.collapse(!0)}catch(e){i=function(e,n,t){var r=t.elementFromPoint(e,n),i=t.body.createTextRange();if(r&&"HTML"!==r.tagName||(r=t.body),i.moveToElementText(r),0<(t=(t=te.toArray(i.getClientRects())).sort(function(e,t){return(e=Math.abs(Math.max(e.top-n,e.bottom-n)))-Math.abs(Math.max(t.top-n,t.bottom-n))})).length){n=(t[0].bottom+t[0].top)/2;try{return i.moveToPoint(e,n),i.collapse(!0),i}catch(e){}}return null}(t,n,r)}return e=i,o=r.body,t=e&&e.parentElement?e.parentElement():null,D(function(e,t,n){for(;e&&e!==t;){if(n(e))return e;e=e.parentNode}return null}(t,o,ud))?null:e}return i}function dd(e,t,n){return null!==function(e,t,n){for(;e&&e!==t;){if(n(e))return e;e=e.parentNode}return null}(e,t,n)}function hd(e){return e&&"TABLE"===e.nodeName}function fd(e,t,n){for(var r=new J(t,e.getParent(t.parentNode,e.isBlock)||e.getRoot());t=r[n?"prev":"next"]();)if(k(t))return 1}function pd(e,t,n,r,i){var o,s,a=e.getRoot(),l=e.schema.getNonEmptyElements(),u=e.getParent(i.parentNode,e.isBlock)||a;if(r&&k(i)&&t&&e.isEmpty(u))return N.some(y(i.parentNode,e.nodeIndex(i)));for(var c,d,h=new J(i,u);s=h[r?"prev":"next"]();){if("false"===e.getContentEditableParent(s)||(d=a,fi(c=s)&&!1===dd(c,d,$c)))return N.none();if(A(s)&&0<s.nodeValue.length)return!1===dd(s,a,function(e){return"A"===e.nodeName})?N.some(y(s,r?s.nodeValue.length:0)):N.none();if(e.isBlock(s)||l[s.nodeName.toLowerCase()])return N.none();o=s}return n&&o?N.some(y(o,0)):N.none()}function gd(e){var t=e.startContainer,n=e.startOffset,r=e.endContainer,e=e.endOffset;return t===r&&A(t)?0<n&&n<t.nodeValue.length&&(t=(r=Cd(t,n)).previousSibling,n<e?(t=r=Cd(r,e-=n).previousSibling,e=r.nodeValue.length,n=0):e=0):(A(t)&&0<n&&n<t.nodeValue.length&&(t=Cd(t,n),n=0),A(r)&&0<e&&e<r.nodeValue.length&&(e=(r=Cd(r,e).previousSibling).nodeValue.length)),{startContainer:t,startOffset:n,endContainer:r,endOffset:e}}var md=od,H={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,END:35,HOME:36,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey||this.metaKeyPressed(e)},metaKeyPressed:function(e){return K.mac?e.metaKey:e.ctrlKey&&!e.altKey}},yd=D,vd=function(e,t){return e&&t&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset},bd=function(e,t,n,r){var i,o,s=e.getRoot(),a=!1,l=r[(n?"start":"end")+"Container"],u=r[(n?"start":"end")+"Offset"],r=Q(l)&&u===l.childNodes.length,c=e.schema.getNonEmptyElements(),d=n;if(fi(l))return N.none();if(Q(l)&&u>l.childNodes.length-1&&(d=!1),Wn(l)&&(l=s,u=0),l===s){if(d&&(i=l.childNodes[0<u?u-1:0])){if(fi(i))return N.none();if(c[i.nodeName]||hd(i))return N.none()}if(l.hasChildNodes()){if(u=Math.min(!d&&0<u?u-1:u,l.childNodes.length-1),l=l.childNodes[u],u=A(l)&&r?l.data.length:0,!t&&l===s.lastChild&&hd(l))return N.none();if(function(e,t){for(;t&&t!==e;){if(D(t))return 1;t=t.parentNode}}(s,l)||fi(l))return N.none();if(l.hasChildNodes()&&!1===hd(l)){var h=new J(i=l,s);do{if(D(i)||fi(i)){a=!1;break}if(A(i)&&0<i.nodeValue.length){u=d?0:i.nodeValue.length,l=i,a=!0;break}if(c[i.nodeName.toLowerCase()]&&(!(o=i)||!/^(TD|TH|CAPTION)$/.test(o.nodeName))){u=e.nodeIndex(i),l=i.parentNode,d||u++,a=!0;break}}while(i=d?h.next():h.prev())}}}return t&&(A(l)&&0===u&&pd(e,r,t,!0,l).each(function(e){l=e.container(),u=e.offset(),a=!0}),Q(l))&&(!(i=(i=l.childNodes[u])||l.childNodes[u-1])||!k(i)||i.previousSibling&&"A"===i.previousSibling.nodeName||fd(e,i,!1)||fd(e,i,!0)||pd(e,r,t,!0,i).each(function(e){l=e.container(),u=e.offset(),a=!0})),d&&!t&&A(l)&&u===l.nodeValue.length&&pd(e,r,t,!1,l).each(function(e){l=e.container(),u=e.offset(),a=!0}),a?N.some(y(l,u)):N.none()},Ed=function(e,t){var n=t.collapsed,r=t.cloneRange(),i=y.fromRangeStart(t);return bd(e,n,!0,r).each(function(e){n&&y.isAbove(i,e)||r.setStart(e.container(),e.offset())}),n||bd(e,n,!1,r).each(function(e){r.setEnd(e.container(),e.offset())}),n&&r.collapse(!0),vd(t,r)?N.none():N.some(r)},Cd=function(e,t){return e.splitText(t)};function wd(n){return{walk:function(e,t){return yc(n,e,t)},split:gd,normalize:function(t){return Ed(n,t).fold(m,function(e){return t.setStart(e.startContainer,e.startOffset),t.setEnd(e.endContainer,e.endOffset),!0})}}}(t=wd=wd||{}).compareRanges=vd,t.getCaretRangeFromPoint=cd,t.getSelectedNode=Ea,t.getNode=Va;function Sd(n,e){return n.view(e).fold(_([]),function(e){var t=n.owner(e),t=Sd(n,t);return[e].concat(t)})}function Td(e){return"textarea"===Z(e)}function Rd(e,t){i=(a=e).dom.ownerDocument,s=i.body,o=i.defaultView,i=i.documentElement;var n,r,i,o,s=s===a.dom?Pn(s.offsetLeft,s.offsetTop):(n=Ct(null==o?void 0:o.pageYOffset,i.scrollTop),o=Ct(null==o?void 0:o.pageXOffset,i.scrollLeft),r=Ct(i.clientTop,s.clientTop),i=Ct(i.clientLeft,s.clientLeft),wt(a).translate(o-i,n-r)),a=uh.get(e);return{element:e,bottom:s.top+a,height:a,pos:s,cleanup:t}}function Ad(l,u,c,d){var e,t,n,r,i,o,s;e=l,s=function(e,t){var n,r,i,o,s,a;n=l,r=u,i=c,o=d,a=q.fromDom(n.getBody()),s=q.fromDom(n.getDoc()),a.dom.offsetWidth,a=dh(q.fromDom(i.startContainer),i.startOffset),hh(n,s,r,a,o),a.cleanup()},n=(t=c).startContainer,r=t.startOffset,i=t.endContainer,o=t.endOffset,s(q.fromDom(n),q.fromDom(i)),(s=e.dom.createRng()).setStart(n,r),s.setEnd(i,o),e.selection.setRng(t)}function _d(e,t,n,r){var i=e.pos;n?St(i.left,i.top,r):(n=i.top-t+e.height,St(i.left,n,r))}function Nd(e,t,n,r,i){var o=n+t,s=r.pos.top,a=r.bottom,l=n<=a-s;s<t?_d(r,n,!1!==i,e):o<s?_d(r,n,l?!1!==i:!0===i,e):o<a&&!l&&_d(r,n,!0===i,e)}function xd(e,t,n){Ad(e,ph,t,n)}function Od(e,t,n){return fh(e,t,ph,n)}function Id(e,t,n){Ad(e,gh,t,n)}function Md(e,t,n){return fh(e,t,gh,n)}function kd(e){return void 0===e&&(e=q.fromDom(document)),N.from(e.dom.activeElement).map(q.fromDom)}function Dd(e){return bh.range(e.start,Ch(e.soffset,e.start),e.finish,Ch(e.foffset,e.finish))}function Ld(t){return function(e){return wh(t,e.start)&&wh(t,e.finish)}}function Pd(e){return!0===e.inline||Eh.isIE()}function Fd(e){return bh.range(q.fromDom(e.startContainer),e.startOffset,q.fromDom(e.endContainer),e.endOffset)}function Bd(e){var t=document.createRange();try{return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),N.some(t)}catch(e){return N.none()}}function Hd(n){return(n.bookmark||N.none()).bind(function(e){return t=q.fromDom(n.getBody()),N.from(e).filter(Ld(t)).map(Dd);var t}).bind(Bd)}function Ud(t,e){var n=t.getParam("custom_ui_selector","","string");return null!==Ah.getParent(e,function(e){return Th.isEditorUIElement(e)||!!n&&t.dom.is(e,n)})}function Vd(n,e){var r,i,e=e.editor;r=e,i=_a(function(){Sh(r)},0),r.on("init",function(){var e,t,n;r.inline&&(e=r,t=i,n=function(){t.throttle()},L.DOM.bind(document,"mouseup",n),e.on("remove",function(){L.DOM.unbind(document,"mouseup",n)})),Rh(r,i)}),r.on("remove",function(){i.cancel()}),e.on("focusin",function(){var e=n.focusedEditor;e!==this&&(e&&e.fire("blur",{focusedEditor:this}),n.setActive(this),(n.focusedEditor=this).fire("focus",{blurredEditor:e}),this.focus(!0))}),e.on("focusout",function(){var t=this;Ir.setEditorTimeout(t,function(){var e=n.focusedEditor;Ud(t,function(e){try{var t=Nn(q.fromDom(e.getElement()));return kd(t).fold(function(){return document.body},function(e){return e.dom})}catch(e){return document.body}}(t))||e!==t||(t.fire("blur",{focusedEditor:null}),n.focusedEditor=null)})}),lh||(lh=function(e){var t=n.activeEditor;t&&function(e){if(_n()&&we(e.target)){var t=q.fromDom(e.target);if(pn(t)&&we(t.dom.shadowRoot)&&e.composed&&e.composedPath){t=e.composedPath();if(t)return Le(t)}}return N.from(e.target)}(e).each(function(e){e.ownerDocument!==document||e===document.body||Ud(t,e)||n.focusedEditor!==t||(t.fire("blur",{focusedEditor:null}),n.focusedEditor=null)})},Ah.bind(document,"focusin",lh))}function Wd(e,t){e.focusedEditor===t.editor&&(e.focusedEditor=null),e.activeEditor||(Ah.unbind(document,"focusin",lh),lh=null)}function $d(t,e){_h(q.fromDom(t.getBody()),e).bind(function(e){return Uc(e.dom)}).fold(function(){t.selection.normalize()},function(e){return t.selection.setRng(e.toRange())})}function jd(t){if(t.setActive)try{t.setActive()}catch(e){t.focus()}else t.focus()}function zd(e){return e.inline?(t=e.getBody())&&Nh(q.fromDom(t)):e.iframeElement&&yh(q.fromDom(e.iframeElement));var t}function Gd(e,t,n){return Oh(e,t,!0,n,function(e,t){return Math.min(e.dom.childNodes.length,t)})}function Yd(e,t,n){return Oh(e,t,!1,n,function(e,t){return 0<t?t-1:t})}function Xd(e,t){for(var n=e;e&&A(e)&&0===e.length;)e=t?e.nextSibling:e.previousSibling;return e||n}function Kd(n,e){return x(e,function(e){var t=n.fire("GetSelectionRange",{range:e});return t.range!==e?t.range:e})}function qd(e){return Se(e)?e:m}function Zd(e,t,n){var r=e.formatter.get(n);if(r)for(var i=0;i<r.length;i++)if(!1===r[i].inherit&&e.dom.is(t,r[i].selector))return 1}function Qd(t,e,n,r){var i=t.dom.getRoot();return e!==i&&(e=t.dom.getParent(e,function(e){return!!Zd(t,e,n)||e.parentNode===i||!!Jd(t,e,n,r,!0)}),Jd(t,e,n,r))}function Jd(e,t,n,r,i){var o,s,a,l,u=e.formatter.get(n),c=e.dom;if(u&&t)for(s=0;s<u.length;s++)if(o=u[s],kh(e.dom,t,o)&&Dh(c,t,o,"attributes",i,r)&&Dh(c,t,o,"styles",i,r)){if(l=o.classes)for(a=0;a<l.length;a++)if(!e.dom.hasClass(t,l[a]))return;return o}}function eh(e,t,n,r){var i;return r?Qd(e,r,t,n):(r=e.selection.getNode(),!!Qd(e,r,t,n)||!((i=e.selection.getStart())===r||!Qd(e,i,t,n)))}function th(o,s){function t(e){return M(e,q.fromDom(o.getBody()))}return N.from(o.selection.getStart(!0)).bind(function(e){return Ih(q.fromDom(e),function(e){for(var t,n=s,r=0;r<n.length;r++){i=n[r],t=void 0;var i=Jd(o,e.dom,t=i)?N.some(t):N.none();if(i.isSome())return i}return N.none()},t)}).getOrNull()}function nh(r,i,e){return W(e,function(e,t){var n=Oe(r.formatter.get(t),function(t){function r(e){return 1<e.length&&"%"===e.charAt(0)}return Oe(["styles","attributes"],function(e){return We(t,e).exists(function(e){var n,e=ye(e)?e:(n=[],X(e,function(e,t){n.push(e)}),n);return Oe(e,r)})})});return r.formatter.matchNode(i,t,{},n)?e.concat([t]):e},[])}function rh(e,t,n){var r=n?"lastChild":"firstChild",i=n?"prev":"next";if(e[r])return e[r];if(e!==t){var o=e[i];if(o)return o;for(var s=e.parent;s&&s!==t;s=s.parent)if(o=s[i])return o}}function ih(e){var t="a"===e.name&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t}var oh,sh,ah,lh,e=wd,uh=(oh="height",sh=function(e){var t=e.dom;return Ln(e)?t.getBoundingClientRect().height:t.offsetHeight},{set:function(e,t){if(!Te(t)&&!t.match(/^[0-9]+$/))throw new Error(oh+".set accepts only positive integer values. Value was "+t);e=e.dom;kt(e)&&(e.style[oh]=t+"px")},get:ln=function(e){var t=sh(e);return t<=0||null===t?(e=qn(e,oh),parseFloat(e)||0):t},getOuter:ln,aggregate:ah=function(n,e){return W(e,function(e,t){t=qn(n,t),t=void 0===t?0:parseInt(t,10);return isNaN(t)?e:e+t},0)},max:function(e,t,n){e=ah(e,n);return e<t?t-e:0}}),ch=Object.freeze({__proto__:null,view:function(e){return(e.dom===document?N.none():N.from(null==(e=e.dom.defaultView)?void 0:e.frameElement)).map(q.fromDom)},owner:vn}),dh=function(e,t){t=t;var n,e=0===(n=Sn(e=e)).length||Td(e)?{element:e,offset:t}:t<n.length&&!Td(n[t])?{element:n[t],offset:0}:(n=n[n.length-1],Td(n)?{element:e,offset:t}:"img"===Z(n)?{element:n,offset:1}:gn(n)?{element:n,offset:Rc(n).length}:{element:n,offset:Sn(n).length}),r=q.fromHtml('<span data-mce-bogus="all">\ufeff</span>');return On(e.element,r),Rd(r,function(){return Dn(r)})},hh=function(e,t,n,r,i){var o={elm:r.element.dom,alignToTop:i};e.fire("ScrollIntoView",o).isDefaultPrevented()||(n(t,Fn(t).top,r,i),e.fire("AfterScrollIntoView",o))},fh=function(e,t,n,r){var i=q.fromDom(e.getDoc());hh(e,i,n,Rd(q.fromDom(t),Y),r)},ph=function(e,t,n,r){var i=e.dom.defaultView.innerHeight;Nd(e,t,i,n,r)},gh=function(e,t,n,r){var i,o=e.dom.defaultView.innerHeight,o=(Nd(e,t,o,n,r),e=n.element,t=q.fromDom(document),t=Fn(t),i=(o=ch).owner(e),o=Sd(o,i),i=wt(e),e=V(o,function(e,t){t=wt(t);return{left:e.left+t.left,top:e.top+t.top}},{left:0,top:0}),Pn(e.left+i.left+t.left,e.top+i.top+t.top)),e=Rt(window);o.top<e.y?Tt(n.element,!1!==r):o.top>e.bottom&&Tt(n.element,!0===r)},mh=function(e,t,n){(e.inline?xd:Id)(e,t,n)},yh=function(e){var t=Nn(e).dom;return e.dom===t.activeElement},nn=jt([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),vh=(nn.before,nn.on,nn.after,jt([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}])),bh={domRange:vh.domRange,relative:vh.relative,exact:vh.exact,exactFromRange:function(e){return vh.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){e=e.match({domRange:function(e){return q.fromDom(e.startContainer)},relative:function(e,t){return e.fold(a,a,a)},exact:function(e,t,n,r){return e}});return ft(e)},range:function(e,t,n,r){return{start:e,soffset:t,finish:n,foffset:r}}},Eh=an().browser,Ch=function(e,t){t=gn(t)?Rc(t).length:Sn(t).length+1;return t<e?t:e<0?0:e},wh=function(e,t){return!_t(t.dom)&&(fn(e,t)||M(e,t))},Sh=function(e){var t,n=Pd(e)?(t=q.fromDom(e.getBody()),((n=ft(t).dom.getSelection())&&0!==n.rangeCount?N.from(n.getRangeAt(0)):N.none()).map(Fd).filter(Ld(t))):N.none();e.bookmark=n.isSome()?n:e.bookmark},Th={isEditorUIElement:function(e){e=e.className.toString();return-1!==e.indexOf("tox-")||-1!==e.indexOf("mce-")}},Rh=function(t,e){var n,r;an().browser.isIE()?(r=t).on("focusout",function(){Sh(r)}):(n=e,t.on("mouseup touchend",function(e){n.throttle()})),t.on("keyup NodeChange",function(e){"nodechange"===e.type&&e.selectionChange||Sh(t)})},Ah=L.DOM,_h=function(t,e){return(e.collapsed?N.from(Va(e.startContainer,e.startOffset)).map(q.fromDom):N.none()).bind(function(e){return ti(e)?N.some(e):!1===fn(t,e)?N.some(t):N.none()})},Nh=function(e){return yh(e)||kd(Nn(t=e)).filter(function(e){return t.dom.contains(e.dom)}).isSome();var t},xh=function(e){return e.editorManager.setActive(e)},Oh=function(e,t,n,r,i){var o=n?t.startContainer:t.endContainer,s=n?t.startOffset:t.endOffset;return N.from(o).map(q.fromDom).map(function(e){return r&&t.collapsed?e:Tn(e,i(e,s)).getOr(e)}).bind(function(e){return pn(e)?N.some(e):bn(e).filter(pn)}).map(function(e){return e.dom}).getOr(e)},Ih=function(o,s,e){var t=s(o),a=qd(e);return t.orThunk(function(){if(!a(o))for(var e=s,t=o.dom,n=qd(a);t.parentNode;){var t=t.parentNode,r=q.fromDom(t),i=e(r);if(i.isSome())return i;if(n(r))break}return N.none()})},Mh=Qu,kh=function(e,t,n){return!!Mh(t,n.inline)||!!Mh(t,n.block)||(n.selector?1===t.nodeType&&e.is(t,n.selector):void 0)},Dh=function(e,t,n,r,i,o){var s,a,l,u=n[r];if(n.onmatch)return n.onmatch(t,n,r);if(u)if(void 0===u.length){for(s in u)if(u.hasOwnProperty(s)){if(a="attributes"===r?e.getAttrib(t,s):ec(e,t,s),i&&!a&&!n.exact)return;if((!i||n.exact)&&!Mh(a,Ju(e,Zu(u[s],o),s)))return}}else for(l=0;l<u.length;l++)if("attributes"===r?e.getAttrib(t,u[l]):ec(e,t,u[l]))return n;return n},Lh={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},Ph=(Fh.create=function(e,t){var n=new Fh(e,Lh[e]||1);return t&&X(t,function(e,t){n.attr(t,e)}),n},Fh.prototype.replace=function(e){return e.parent&&e.remove(),this.insert(e,this),this.remove(),this},Fh.prototype.attr=function(e,t){var n,r=this;if("string"!=typeof e)return null!=e&&X(e,function(e,t){r.attr(t,e)}),r;if(n=r.attributes){if(void 0===t)return n.map[e];if(null===t){if(e in n.map){delete n.map[e];for(var i=n.length;i--;)if(n[i].name===e)return n.splice(i,1),r}}else{if(e in n.map){for(i=n.length;i--;)if(n[i].name===e){n[i].value=t;break}}else n.push({name:e,value:t});n.map[e]=t}return r}},Fh.prototype.clone=function(){var e,t=new Fh(this.name,this.type);if(e=this.attributes){var n=[];n.map={};for(var r=0,i=e.length;r<i;r++){var o=e[r];"id"!==o.name&&(n[n.length]={name:o.name,value:o.value},n.map[o.name]=o.value)}t.attributes=n}return t.value=this.value,t.shortEnded=this.shortEnded,t},Fh.prototype.wrap=function(e){return this.parent.insert(e,this),e.append(this),this},Fh.prototype.unwrap=function(){for(var e=this.firstChild;e;){var t=e.next;this.insert(e,this,!0),e=t}this.remove()},Fh.prototype.remove=function(){var e=this.parent,t=this.next,n=this.prev;return e&&(e.firstChild===this?(e.firstChild=t)&&(t.prev=null):n.next=t,e.lastChild===this?(e.lastChild=n)&&(n.next=null):t.prev=n,this.parent=this.next=this.prev=null),this},Fh.prototype.append=function(e){e.parent&&e.remove();var t=this.lastChild;return t?((t.next=e).prev=t,this.lastChild=e):this.lastChild=this.firstChild=e,e.parent=this,e},Fh.prototype.insert=function(e,t,n){e.parent&&e.remove();var r=t.parent||this;return n?(t===r.firstChild?r.firstChild=e:t.prev.next=e,e.prev=t.prev,(e.next=t).prev=e):(t===r.lastChild?r.lastChild=e:t.next.prev=e,e.next=t.next,(e.prev=t).next=e),e.parent=r,e},Fh.prototype.getAll=function(e){for(var t=[],n=this.firstChild;n;n=rh(n,this))n.name===e&&t.push(n);return t},Fh.prototype.empty=function(){if(this.firstChild){for(var e=[],t=this.firstChild;t;t=rh(t,this))e.push(t);for(var n=e.length;n--;)(t=e[n]).parent=t.firstChild=t.lastChild=t.next=t.prev=null}return this.firstChild=this.lastChild=null,this},Fh.prototype.isEmpty=function(e,t,n){void 0===t&&(t={});var r=this.firstChild;if(ih(this))return!1;if(r)do{if(1===r.type){if(r.attr("data-mce-bogus"))continue;if(e[r.name])return!1;if(ih(r))return!1}if(8===r.type)return!1;if(3===r.type&&!function(e){var t;if(_i(e.value))return!(t=e.parent)||"span"===t.name&&!t.attr("style")||!/^[ ]+$/.test(e.value)}(r))return!1;if(3===r.type&&r.parent&&t[r.parent.name]&&_i(r.value))return!1;if(n&&n(r))return!1}while(r=rh(r,this));return!0},Fh.prototype.walk=function(e){return rh(this,null,e)},Fh);function Fh(e,t){this.name=e,1===(this.type=t)&&(this.attributes=[],this.attributes.map={})}function Bh(e){var a=[],l=(e=e||{}).indent,u=Vh(e.indent_before||""),c=Vh(e.indent_after||""),d=$i.getEncodeFunc(e.entity_encoding||"raw",e.entities),h="html"===e.element_format;return{start:function(e,t,n){var r,i,o,s;if(l&&u[e]&&0<a.length&&0<(s=a[a.length-1]).length&&"\n"!==s&&a.push("\n"),a.push("<",e),t)for(r=0,i=t.length;r<i;r++)o=t[r],a.push(" ",o.name,'="',d(o.value,!0),'"');a[a.length]=!n||h?">":" />",n&&l&&c[e]&&0<a.length&&0<(s=a[a.length-1]).length&&"\n"!==s&&a.push("\n")},end:function(e){a.push("</",e,">"),l&&c[e]&&0<a.length&&0<(e=a[a.length-1]).length&&"\n"!==e&&a.push("\n")},text:function(e,t){0<e.length&&(a[a.length]=t?e:d(e))},cdata:function(e){a.push("<![CDATA[",e,"]]>")},comment:function(e){a.push("\x3c!--",e,"--\x3e")},pi:function(e,t){t?a.push("<?",e," ",d(t),"?>"):a.push("<?",e,"?>"),l&&a.push("\n")},doctype:function(e){a.push("<!DOCTYPE",e,">",l?"\n":"")},reset:function(){a.length=0},getContent:function(){return a.join("").replace(/\n$/,"")}}}function Hh(e,t){return e.replace(new RegExp(t.prefix+"_[0-9]+","g"),function(e){return We(t.uris,e).getOr(e)})}function Uh(e,t,n){var r,i,o=1,s=e.getShortEndedElements(),a=/<([!?\/])?([A-Za-z0-9\-_\:\.]+)((?:\s+[^"\'>]+(?:(?:"[^"]*")|(?:\'[^\']*\')|[^>]*))*|\/|\s+)>/g;for(a.lastIndex=r=n;i=a.exec(t);){if(r=a.lastIndex,"/"===i[1])o--;else if(!i[1]){if(i[2]in s)continue;o++}if(0===o)break}return r}var Vh=te.makeMap,Wh=function(t,f){void 0===f&&(f=eo());var p=Bh(t);return(t=t||{}).validate=!("validate"in t)||t.validate,{serialize:function(e){var c=t.validate,d={3:function(e){p.text(e.value,e.raw)},8:function(e){p.comment(e.value)},7:function(e){p.pi(e.name,e.value)},10:function(e){p.doctype(e.value)},4:function(e){p.cdata(e.value)},11:function(e){if(e=e.firstChild)for(;h(e),e=e.next;);}},h=(p.reset(),function(e){var t,n,r,i,o,s,a,l,u=d[e.type];if(u)u(e);else{if(u=e.name,t=e.shortEnded,n=e.attributes,c&&n&&1<n.length&&((o=[]).map={},l=f.getElementRule(e.name))){for(s=0,a=l.attributesOrder.length;s<a;s++)(r=l.attributesOrder[s])in n.map&&(i=n.map[r],o.map[r]=i,o.push({name:r,value:i}));for(s=0,a=n.length;s<a;s++)(r=n[s].name)in o.map||(i=n.map[r],o.map[r]=i,o.push({name:r,value:i}));n=o}if(p.start(e.name,n,t),!t){if(e=e.firstChild)for(;h(e),e=e.next;);p.end(u)}}});return 1!==e.type||t.inner?d[11](e):h(e),p.getContent()}}},$h=["img","video"];function jh(G,Y){void 0===Y&&(Y=eo());function e(){}function n(a,e){void 0===e&&(e="html");for(var t,o,l,n,r,i,u,s,c,d,h,f,p,g,m,y,v,b,E,C=a.html,w=0,S=[],T=0,R=$i.decode,A=te.makeMap("src,href,data,background,formaction,poster,xlink:href"),P=/((java|vb)script|mhtml):/i,_="html"===e?0:1,N=function(e){for(var t,n=S.length;n--&&S[n].name!==e;);if(0<=n){for(t=S.length-1;n<=t;t--)(e=S[t]).valid&&Q(e.name);S.length=n}},x=function(e,t){return q(Hh(e,a),t)},O=function(e){""!==e&&(">"===e.charAt(0)&&(e=" "+e),G.allow_conditional_comments||"[if"!==e.substr(0,3).toLowerCase()||(e=" "+e),X(Hh(e,a)))},I=function(e,t){var n=e||"",r=!Qe(n,"--"),i=function(e,t,n){void 0===n&&(n=0);var r=e.toLowerCase();if(-1!==r.indexOf("[if ",n)&&(i=n,/^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(r.substr(i))))return i=r.indexOf("[endif]",n),r.indexOf(">",i);if(t)return-1!==(i=r.indexOf(">",n))?i:r.length;t=/--!?>/;t.lastIndex=n;var i=t.exec(e);return i?i.index+i[0].length:r.length}(C,r,t);return e=C.substr(t,i-t),O(r?n+e:e),i+1},F=function(e,t,n,r,i){var o,s,r=(t=t.toLowerCase())in V?t:R(n||r||i||"");if(n=We(a.uris,r).getOr(r),k&&!u&&0==(0===(i=t).indexOf("data-")||0===i.indexOf("aria-"))){if(!(o=p[t])&&g){for(s=g.length;s--&&!(o=g[s]).pattern.test(t););-1===s&&(o=null)}if(!o)return;if(o.validValues&&!(n in o.validValues))return}if(A[t]&&!G.allow_script_urls){r=n.replace(/[\s\u0000-\u001F]+/g,"");try{r=decodeURIComponent(r)}catch(e){r=unescape(r)}if(P.test(r))return;if(i=r,r=e,!(e=G).allow_html_data_urls&&(/^data:image\//i.test(i)?(e=e.allow_svg_data_urls,r=r,!(Ce(e)?xe($h,r):e)&&/^data:image\/svg\+xml/i.test(i)):/^data:/i.test(i)))return}u&&(t in A||0===t.indexOf("on"))||(l.map[t]=n,l.push({name:t,value:n}))},M=new RegExp("<(?:(?:!--([\\w\\W]*?)--!?>)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\w\\W]*?)>)|(?:!(--)?)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|(?:([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))","g"),B=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g,H=Y.getShortEndedElements(),U=G.self_closing_elements||Y.getSelfClosingElements(),V=Y.getBoolAttrs(),k=G.validate,W=G.remove_internals,$=G.fix_self_closing,j=Y.getSpecialElements(),z=C+">";t=M.exec(z);){var D=t[0];if(w<t.index&&x(R(C.substr(w,t.index-w))),o=t[7])N(o=":"===(o=o.toLowerCase()).charAt(0)?o.substr(1):o);else if(o=t[8]){if(t.index+D.length>C.length){x(R(C.substr(t.index))),w=t.index+D.length;continue}s=(o=":"===(o=o.toLowerCase()).charAt(0)?o.substr(1):o)in H,$&&U[o]&&0<S.length&&S[S.length-1].name===o&&N(o);E=B,L=t[9];var L=(E=E.exec(L))&&(L=E[1],E=E[2],"string"==typeof L)&&"data-mce-bogus"===L.toLowerCase()?E:null;if(null!==L){if("all"===L){w=Uh(Y,C,M.lastIndex),M.lastIndex=w;continue}d=!1}if(!k||(c=Y.getElementRule(o))){if(d=!0,k&&(p=c.attributes,g=c.attributePatterns),(f=t[9])?((u=-1!==f.indexOf("data-mce-type"))&&W&&(d=!1),(l=[]).map={},f.replace(B,function(e,t,n,r,i){return F(o,t,n,r,i),""})):(l=[]).map={},k&&!u){if(m=c.attributesRequired,y=c.attributesDefault,v=c.attributesForced,c.removeEmptyAttrs&&!l.length&&(d=!1),v)for(n=v.length;n--;)i=(h=v[n]).name,"{$uid}"===(b=h.value)&&(b="mce_"+T++),l.map[i]=b,l.push({name:i,value:b});if(y)for(n=y.length;n--;)(i=(h=y[n]).name)in l.map||("{$uid}"===(b=h.value)&&(b="mce_"+T++),l.map[i]=b,l.push({name:i,value:b}));if(m){for(n=m.length;n--&&!(m[n]in l.map););-1===n&&(d=!1)}if(h=l.map["data-mce-bogus"]){if("all"===h){w=Uh(Y,C,M.lastIndex),M.lastIndex=w;continue}d=!1}}d&&Z(o,l,s)}else d=!1;if(E=j[o]){E.lastIndex=w=t.index+D.length,w=(t=E.exec(C))?(d&&(r=C.substr(w,t.index-w)),t.index+t[0].length):(r=C.substr(w),C.length),d&&(0<r.length&&x(r,!0),Q(o)),M.lastIndex=w;continue}s||(f&&f.indexOf("/")===f.length-1?d&&Q(o):S.push({name:o,valid:d}))}else if(o=t[1])O(o);else if(o=t[2]){if(!(1==_||G.preserve_cdata||0<S.length&&Y.isValidChild(S[S.length-1].name,"#cdata"))){w=I("",t.index+2),M.lastIndex=w;continue}K(o)}else if(o=t[3])ee(o);else{if((o=t[4])||"<!"===D){w=I(o,t.index+D.length),M.lastIndex=w;continue}if(o=t[5]){if(1!=_){w=I("?",t.index+2),M.lastIndex=w;continue}J(o,t[6])}}w=t.index+D.length}for(w<C.length&&x(R(C.substr(w))),n=S.length-1;0<=n;n--)(o=S[n]).valid&&Q(o.name)}!1!==(G=G||{}).fix_self_closing&&(G.fix_self_closing=!0);var X=G.comment||e,K=G.cdata||e,q=G.text||e,Z=G.start||e,Q=G.end||e,J=G.pi||e,ee=G.doctype||e;return{parse:function(e,t){void 0===t&&(t="html"),n(function(e){for(var t,n=/data:[^;]+;base64,([a-z0-9\+\/=]+)/gi,r=[],i={},o=ca("img"),s=0,a=0;t=n.exec(e);){var l=t[0],u=o+"_"+a++;i[u]=l,s<t.index&&r.push(e.substr(s,t.index-s)),r.push(u),s=t.index+l.length}return 0===s?{prefix:o,uris:i,html:e}:(s<e.length&&r.push(e.substr(s)),{prefix:o,uris:i,html:r.join("")})}(e),t)}}}(jh=jh||{}).findEndTag=Uh;function zh(e,t){for(var n,r,i,o=t,s=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,a=e.schema,t=e.getTempAttrs(),e=o,t=new RegExp(["\\s?("+t.join("|")+')="[^"]+"'].join("|"),"gi"),o=e.replace(t,""),l=a.getShortEndedElements();i=s.exec(o);)n=s.lastIndex,r=i[0].length,i=l[i[1]]?n:dg.findEndTag(a,o,n),o=o.substring(0,n-r)+o.substring(i),s.lastIndex=n-r;return li(o)}function Gh(i){this.compare=function(e,t){var n,r;return e.nodeName===t.nodeName&&!(!(r=function(e,t){var n,r;for(r in e)if(e.hasOwnProperty(r)){if(void 0===(n=t[r]))return!1;if(e[r]!==n)return!1;delete t[r]}for(r in t)if(t.hasOwnProperty(r))return!1;return!0})((n=function(t){var n={};return fg(i.getAttribs(t),function(e){e=e.nodeName.toLowerCase();0!==e.indexOf("_")&&"style"!==e&&0!==e.indexOf("data-")&&(n[e]=i.getAttrib(t,e))}),n})(e),n(t))||!r(i.parseStyle(i.getAttrib(e,"style")),i.parseStyle(i.getAttrib(t,"style")))||Gc(e)||Gc(t))}}function Yh(n,r,i){return N.from(i.container()).filter(A).exists(function(e){var t=n?0:-1;return r(e.data.charAt(i.offset()+t))})}function Xh(t,n){return function(e){return N.from(Dl(t?0:-1,e)).filter(n).isSome()}}function Kh(e){return jn(e)&&"block"===qn(q.fromDom(e),"display")}function qh(e){return D(e)&&!(Q(e=e)&&"all"===e.getAttribute("data-mce-bogus"))}function Zh(n){Rn(n).each(function(t){En(t).each(function(e){qr(n)&&Zr(t)&&qr(e)&&Dn(t)})})}function Qh(e,t,n){return Fc(e,t,n,mg)}function Jh(e,t){return Ie(_g(q.fromDom(t.container()),e),qr)}function ef(e,n,r){return Qh(e,n.dom,r).forall(function(t){return Jh(n,r).fold(function(){return!1===kl(t,r,n.dom)},function(e){return!1===kl(t,r,n.dom)&&fn(e,q.fromDom(t.container()))})})}function tf(t,n,r){return Jh(n,r).fold(function(){return Qh(t,n.dom,r).forall(function(e){return!1===kl(e,r,n.dom)})},function(e){return Qh(t,e.dom,r).isNone()})}function nf(e){return Tu(e).exists(Zr)}function rf(e,t,n){var r=O(_g(q.fromDom(n.container()),t),qr),r=Le(r).getOr(t);return Mu(e,r.dom,n).filter(nf)}function of(e,t){return Tu(t).exists(Zr)||rf(!0,e,t).isSome()}function sf(e,t){return N.from(t.getNode(!0)).map(q.fromDom).exists(Zr)||rf(!1,e,t).isSome()}function af(e){return y.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd()}function lf(e,t){return t=O(_g(q.fromDom(t.container()),e),qr),Le(t).getOr(e)}function uf(e,t){return af(t)?gg(t):gg(t)||Hc(lf(e,t).dom,t).exists(gg)}function cf(e,t){return af(t)?pg(t):pg(t)||Bc(lf(e,t).dom,t).exists(pg)}function df(e){return Tu(e).bind(function(e){return vr(e,pn)}).exists(function(e){return e=qn(e,"white-space"),xe(["pre","pre-wrap"],e)})}function hf(e,t){return!df(t)&&(Ng(e,t)||Og(e,t)||sf(e,t)||uf(e,t))}function ff(e,t){return!df(t)&&(xg(e,t)||Ig(e,t)||of(e,t)||cf(e,t))}function pf(e,t){return hf(e,t)||ff(e,(t=(e=t).container(),n=e.offset(),A(t)&&n<t.data.length?y(t,n+1):e));var n}function gf(e,t){return Wu(e.charAt(t))}function mf(e){return e=e.container(),A(e)&&Ze(e.data,oi)}function yf(a,e){return N.some(e).filter(mf).bind(function(e){var n,t,r=e.container(),i=a,o=(t=r).data,s=y(t,0);return(gf(o,0)&&!pf(i,s)?(t.data=" "+o.slice(1),1):(s=(i=r).data,n=s.split(""),(t=x(n,function(e,t){return Wu(e)&&0<t&&t<n.length-1&&ju(n[t-1])&&ju(n[t+1])?" ":e}).join(""))!==s&&(i.data=t,!0)))||(o=a,i=(s=r).data,t=y(s,i.length-1),gf(i,i.length-1)&&!pf(o,t)&&(s.data=i.slice(0,-1)+" ",1))?N.some(e):N.none()})}function vf(t){var e=q.fromDom(t.getBody());t.selection.isCollapsed()&&yf(e,y.fromRangeStart(t.selection.getRng())).each(function(e){t.selection.setRng(e.toRange())})}function bf(e,t,n){var r,i,o,s,a,l;0!==n&&(o=q.fromDom(e),o=dr(o,qr).getOr(o),r=e.data.slice(t,t+n),i=t+n>=e.data.length&&ff(o,F(e,e.data.length)),o=0===t&&hf(o,F(e,0)),e.replaceData(t,n,(a=o,l=i,W(s=r,function(e,t){return $u(t)||Wu(t)?e.previousCharIsSpace||""===e.str&&a||e.str.length===s.length-1&&l?{previousCharIsSpace:!1,str:e.str+oi}:{previousCharIsSpace:!0,str:e.str+" "}:{previousCharIsSpace:!1,str:e.str+t}},{previousCharIsSpace:!1,str:""}).str)))}function Ef(e,t,n,r){void 0===r&&(r=!0);var i=tn(e.data).length,o=r?e:t,t=r?t:e;r?o.appendData(t.data):o.insertData(0,t.data),Dn(q.fromDom(t)),n&&Dg(o,i)}function Cf(e,t){return e=e,r=(n=t).container(),i=n.offset(),!1===F.isTextPosition(n)&&r===e.parentNode&&i>F.before(e).offset()?F(t.container(),t.offset()-1):t;var n,r,i}function wf(e){return Ur(e.previousSibling)?N.some((t=e.previousSibling,A(t)?F(t,t.data.length):F.after(t))):e.previousSibling?Vc(e.previousSibling):N.none();var t}function Sf(e){return Ur(e.nextSibling)?N.some((t=e.nextSibling,A(t)?F(t,0):F.before(t))):e.nextSibling?Uc(e.nextSibling):N.none();var t}function Tf(r,i){return wf(i).orThunk(function(){return Sf(i)}).orThunk(function(){return e=r,n=F.before((t=i).previousSibling||t.parentNode),Hc(e,n).fold(function(){return Bc(e,F.after(t))},N.some);var e,t,n})}function Rf(n,r){return Sf(r).orThunk(function(){return wf(r)}).orThunk(function(){return Bc(e=n,F.after(t=r)).fold(function(){return Hc(e,F.before(t))},N.some);var e,t})}function Af(t,n,e){e.fold(function(){t.focus()},function(e){t.selection.setRng(e.toRange(),n)})}function _f(e,t){return t&&$e(e.schema.getBlockElements(),Z(t))}function Nf(e){var t;return $r(e)?(t=q.fromHtml('<br data-mce-bogus="1">'),vt(e),kn(e,t),N.some(F.before(t.dom))):N.none()}function xf(t,n,e,r){void 0===r&&(r=!0),d=n,h=t.getBody(),c=e.dom;var i,o,s,a,l,u,c,d=(d?Rf:Tf)(h,c).map(w(Cf,c)),h=dr(e,w(_f,t),(i=t.getBody(),function(e){return e.dom===i})),f=(o=d,d=c=e,s=$e(t.schema.getTextInlineElements(),Z(d)),l=En(c).filter(gn),u=Cn(c).filter(gn),Dn(c),c=u,e=o,d=function(e,t,n){var e=e.dom,t=t.dom,r=e.data.length;return Ef(e,t,s),n.container()===t?F(e,r):n},((a=l).isSome()&&c.isSome()&&e.isSome()?N.some(d(a.getOrDie(),c.getOrDie(),e.getOrDie())):N.none()).orThunk(function(){return s&&(l.each(function(e){return Lg(e.dom,e.dom.length)}),u.each(function(e){return Dg(e.dom,0)})),o}));t.dom.isEmpty(t.getBody())?(t.setContent(""),t.selection.setCursorLocation()):h.bind(Nf).fold(function(){r&&Af(t,n,f)},function(e){r&&Af(t,n,N.some(e))})}function Of(e,t){return{start:e,end:t}}function If(e,t){return br(q.fromDom(e),"td,th",t)}function Mf(e,t){return hr(e,"table",t)}function kf(e){return!M(e.start,e.end)}function Df(e){return la(e,"td,th")}function Lf(e,t){return Fg(t,e).isSome()}function Pf(e,i,o){return e.filter(function(e){return kf(e)&&Lf(o,e)}).orThunk(function(){return n=o,t=If((e=i).startContainer,n),r=If(e.endContainer,n),e.collapsed?N.none():Fa(t,r,Of).fold(function(){return t.fold(function(){return r.bind(function(t){return Mf(t,n).bind(function(e){return Le(Df(e)).map(function(e){return Of(e,t)})})})},function(t){return Mf(t,n).bind(function(e){return Pe(Df(e)).map(function(e){return Of(t,e)})})})},function(e){return Lf(n,e)?N.none():Mf((t=e).start,n).bind(function(e){return Pe(Df(e)).map(function(e){return Of(t.start,e)})});var t});var n,e,t,r}).bind(function(e){return Fg(t=e,o).map(function(e){return{rng:t,table:e,cells:Df(e)}});var t})}function Ff(e,t){return Me(e,function(e){return M(e,t)})}function Bf(n){return Fa(Ff((r=n).cells,r.rng.start),Ff(r.cells,r.rng.end),function(e,t){return r.cells.slice(e,t+1)}).map(function(e){var t=n.cells;return e.length===t.length?Pg.removeTable(n.table):Pg.emptyCells(e)});var r}function Hf(e,t){function n(e){return M(r,e)}r=e,o=If((e=t).startContainer,i=n),e=If(e.endContainer,i);var r,i,o,s,a,l=Fa(o,e,Of);return s=t,a=n,l.filter(function(e){return n=a,!kf(t=e)&&Fg(t,n).exists(function(e){e=e.dom.rows;return 1===e.length&&1===e[0].cells.length})&&wc(e.start,s);var t,n}).map(function(e){return e.start}).map(function(e){return Pg.deleteCellSelection(t,e)}).orThunk(function(){return Pf(l,t,n).bind(Bf)})}function Uf(e){var t;return(8===ct(t=e)||"#comment"===Z(t)?En:Rn)(e).bind(Uf).orThunk(function(){return N.some(e)})}function Vf(e,t){return ee(t,Rg),e.selection.setCursorLocation(t[0].dom,0),!0}function Wf(e,t,n){t.deleteContents();var r,t=Uf(n).getOr(n),i=q.fromDom(e.dom.getParent(t.dom,e.dom.isBlock));return $r(i)&&(Rg(i),e.selection.setCursorLocation(i.dom,0)),M(n,i)||(t=bn(i).is(n)?[]:bn(r=i).map(Sn).map(function(e){return O(e,function(e){return!M(r,e)})}).getOr([]),ee(t.concat(Sn(n)),function(e){M(e,i)||fn(e,i)||Dn(e)})),!0}function $f(e,t){return xf(e,!1,t),!0}function jf(e,t){return Ie(_g(t,e),ni)}function zf(e,t){return Ie(_g(t,e),function(e){return"caption"===Z(e)})}function Gf(e,t){return Rg(t),e.selection.setCursorLocation(t.dom,0),N.some(!0)}function Yf(e,t){return(e?Cg:wg)(t)}function Xf(d,h,a){var f=q.fromDom(d.getBody());return zf(f,a).fold(function(){return r=d,i=h,o=f,e=a,s=F.fromRangeStart(r.selection.getRng()),jf(o,e).bind(function(e){return $r(e)?Gf(r,e):(t=o,n=e,e=s,ku(i,r.getBody(),e).bind(function(e){return jf(t,q.fromDom(e.getNode())).map(function(e){return!1===M(e,n)})}));var t,n}).getOr(!1)||(t=h,n=F.fromRangeStart((e=d).selection.getRng()),Yf(t,n))||Mu(t,e.getBody(),n).exists(function(e){return Yf(t,e)});var r,i,o,s,e,t,n},function(e){return t=d,n=h,r=f,e=e,i=F.fromRangeStart(t.selection.getRng()),($r(e)?Gf(t,e):(a=r,u=e,c=i,ku(l=n,(s=t).getBody(),c).bind(function(e){return r=l,i=c,o=e,Uc((n=u).dom).bind(function(t){return Vc(n.dom).map(function(e){return r?i.isEqual(t)&&o.isEqual(e):i.isEqual(e)&&o.isEqual(t)})}).getOr(!0)?Gf(s,u):(t=u,zf(a,q.fromDom(e.getNode())).map(function(e){return!1===M(e,t)}));var t,n,r,i,o}).or(N.some(!0)))).getOr(!1);var s,a,l,u,c,t,n,r,i})}function Kf(e,t){var n,r,i,o,s=q.fromDom(e.selection.getStart(!0)),a=Jc(e);return e.selection.isCollapsed()&&0===a.length?Xf(e,t,s):(a=s,s=q.fromDom((t=e).getBody()),e=t.selection.getRng(),0!==(n=Jc(t)).length?Vf(t,n):(r=t,o=e,zf(i=s,a).fold(function(){return t=r,Hf(i,o).map(function(e){return e.fold(w($f,t),w(Vf,t),w(Wf,t))});var t},function(e){return Gf(r,e)}).getOr(!1)))}function qf(e){return e.collapsed?e:(o=e,s=F.fromRangeStart(o),a=F.fromRangeEnd(o),l=o.commonAncestorContainer,Mu(!1,l,a).map(function(e){return!kl(s,a,l)&&kl(s,e,l)?(t=s.container(),n=s.offset(),r=e.container(),e=e.offset(),(i=document.createRange()).setStart(t,n),i.setEnd(r,e),i):o;var t,n,r,i}).getOr(o));var o,s,a,l}function Zf(e,t){var n,r,i=t.firstChild,t=t.lastChild;return i&&"meta"===i.name&&(i=i.next),n=t=t&&"mce_marker"===t.attr("id")?t.prev:t,r=(e=e).getNonEmptyElements(),n&&(n.isEmpty(r)||(r=n,(n=e).getBlockElements()[r.name]&&r.firstChild&&r.firstChild===r.lastChild&&("br"===(n=r.firstChild).name||n.value===oi)))&&(t=t.prev),!(!i||i!==t||"ul"!==i.name&&"ol"!==i.name)}function Qf(e){return 0<e.length&&(!(t=e[e.length-1]).firstChild||(t=t)&&t.firstChild&&t.firstChild===t.lastChild&&((t=t.firstChild).data===oi||k(t)))?e.slice(0,-1):e;var t}function Jf(e,t){return(t=e.getParent(t,e.isBlock))&&"LI"===t.nodeName?t:null}function ep(e,t){return e=F.after(e),(t=Nu(t).prev(e))?t.toRange():null}function tp(e,r,i,t){function n(e){var t=F.fromRangeStart(i),n=Nu(r.getRoot());return!(e=1===e?n.prev(t):n.next(t))||Jf(r,e.getNode())!==f}h=r,e=e.serialize(t),h=(t=h.createFragment(e)).firstChild,e=t.lastChild,h&&"META"===h.nodeName&&h.parentNode.removeChild(h),e&&"mce_marker"===e.id&&e.parentNode.removeChild(e);var o,s,a,l,u,c,d,h=t,f=Jf(r,i.startContainer),t=Qf((e=h.firstChild,te.grep(e.childNodes,function(e){return"LI"===e.nodeName}))),h=r.getRoot();return n(1)?(e=t,c=h,d=(u=f).parentNode,te.each(e,function(e){d.insertBefore(e,u)}),e=c,c=F.before(u),(e=Nu(e).next(c))?e.toRange():null):n(2)?(c=f,e=h,r.insertAfter((s=t).reverse(),c),ep(s[0],e)):(s=t,e=h,t=o=f,a=(h=i).cloneRange(),h=h.cloneRange(),a.setStartBefore(t),h.setEndAfter(t),t=[a.cloneContents(),h.cloneContents()],(l=o.parentNode).insertBefore(t[0],o),te.each(s,function(e){l.insertBefore(e,o)}),l.insertBefore(t[1],o),l.removeChild(o),ep(s[s.length-1],e))}function np(e,t,n){var r,i,o,s,a=e.selection,l=e.dom,u=(/^ | $/.test(t)&&(u=l,c=a.getRng(),h=t,u=q.fromDom(u.getRoot()),h=hf(u,F.fromRangeStart(c))?h.replace(/^ /,"&nbsp;"):h.replace(/^&nbsp;/," "),t=h=ff(u,F.fromRangeEnd(c))?h.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):h.replace(/&nbsp;(<br( \/)?>)?$/," ")),e.parser),c=n.merge,d=Wh({validate:e.getParam("validate")},e.schema),h='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>',f={content:t,format:"html",selection:!0,paste:n.paste};if((f=e.fire("BeforeSetContent",f)).isDefaultPrevented())e.fire("SetContent",{content:f.content,format:"html",selection:!0,paste:n.paste});else{-1===(t=f.content).indexOf("{$caret}")&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,h);var p,g=(b=a.getRng()).startContainer||(b.parentElement?b.parentElement():null),m=e.getBody();g===m&&a.isCollapsed()&&l.isBlock(m.firstChild)&&(g=e,p=m.firstChild)&&!g.schema.getShortEndedElements()[p.nodeName]&&l.isEmpty(m.firstChild)&&((b=l.createRng()).setStart(m.firstChild,0),b.setEnd(m.firstChild,0),a.setRng(b)),a.isCollapsed()||(p=(g=e).dom,m=qf(g.selection.getRng()),g.selection.setRng(m),v=p.getParent(m.startContainer,Bg),y=m,null!==(T=v)&&T===p.getParent(y.endContainer,Bg)&&wc(q.fromDom(T),y)?Wf(g,m,q.fromDom(v)):g.getDoc().execCommand("Delete",!1,null));var y,v,b,E,C,w,S,T={context:(r=a.getNode()).nodeName.toLowerCase(),data:n.data,insert:!0},R=u.parse(t,T);if(!0===n.paste&&Zf(e.schema,R)&&Jf(l,r))b=tp(d,l,a.getRng(),R),a.setRng(b),e.fire("SetContent",f);else{for(var A=R;A=A.walk();)1===A.type&&A.attr("data-mce-fragment","1");if("mce_marker"===(s=R.lastChild).attr("id"))for(s=(o=s).prev;s;s=s.walk(!0))if(3===s.type||!l.isBlock(s.name)){e.schema.isValidChild(s.parent.name,"span")&&s.parent.insert(o,s,"br"===s.name);break}if(e._selectionOverrides.showBlockCaretContainer(r),T.invalid){for(e.selection.setContent(h),r=a.getNode(),i=e.getBody(),9===r.nodeType?r=s=i:s=r;s!==i;)s=(r=s).parentNode;t=r===i?i.innerHTML:l.getOuterHTML(r),t=d.serialize(u.parse(t.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return d.serialize(R)}))),r===i?l.setHTML(i,t):l.setOuterHTML(r,t)}else y=e,m=t=d.serialize(R),"all"===(v=r).getAttribute("data-mce-bogus")?v.parentNode.insertBefore(y.dom.createFragment(m),v):(g=v.firstChild,n=v.lastChild,!g||g===n&&"BR"===g.nodeName?y.dom.setHTML(v,m):y.selection.setContent(m));b=c,w=(h=e).schema.getTextInlineElements(),S=h.dom,b&&(E=h.getBody(),C=new Gh(S),te.each(S.select("*[data-mce-fragment]"),function(e){for(var t=e.parentNode;t&&t!==E;t=t.parentNode)w[e.nodeName.toLowerCase()]&&C.compare(t,e)&&S.remove(e,!0)})),function(n,e){var t,r=n.dom,i=n.selection;if(e){i.scrollIntoView(e);var o=function(e){for(var t=n.getBody();e&&e!==t;e=e.parentNode)if("false"===r.getContentEditable(e))return e;return null}(e);if(o)return r.remove(e),i.select(o);var o=r.createRng(),s=e.previousSibling,s=(s&&3===s.nodeType?(o.setStart(s,s.nodeValue.length),K.ie||(t=e.nextSibling)&&3===t.nodeType&&(s.appendData(t.data),t.parentNode.removeChild(t))):(o.setStartBefore(e),o.setEndBefore(e)),r.getParent(e,r.isBlock));r.remove(e),s&&r.isEmpty(s)&&(n.$(s).empty(),o.setStart(s,0),o.setEnd(s,0),Bg(s)||s.getAttribute("data-mce-fragment")||!(t=function(e){e=F.fromRangeStart(e);if(e=Nu(n.getBody()).next(e))return e.toRange()}(o))?r.add(s,r.create("br",{"data-mce-bogus":"1"})):(o=t,r.remove(s))),i.setRng(o)}}(e,l.get("mce_marker")),u=e.getBody(),te.each(u.getElementsByTagName("*"),function(e){e.removeAttribute("data-mce-fragment")}),t=l,n=a.getStart(),N.from(t.getParent(n,"td,th")).map(q.fromDom).each(Zh),e.fire("SetContent",f),e.addVisual()}}}function rp(e,t){t(e),e.firstChild&&rp(e.firstChild,t),e.next&&rp(e.next,t)}function ip(e,t,a){e=function(e,n){var t,r,i={},o={},s=[];for(t in a.firstChild&&rp(a.firstChild,function(t){ee(e,function(e){e.name===t.name&&(i[e.name]?i[e.name].nodes.push(t):i[e.name]={filter:e,nodes:[t]})}),ee(n,function(e){"string"==typeof t.attr(e.name)&&(o[e.name]?o[e.name].nodes.push(t):o[e.name]={filter:e,nodes:[t]})})}),i)i.hasOwnProperty(t)&&s.push(i[t]);for(r in o)o.hasOwnProperty(r)&&s.push(o[r]);return s}(e,t),ee(e,function(t){ee(t.filter.callbacks,function(e){e(t.nodes,t.filter.name,{})})})}function op(e){return e instanceof Ph}function sp(e,t){var n;e.dom.setHTML(e.getBody(),t),zd(n=e)&&Uc(n.getBody()).each(function(e){var t=e.getNode(),t=It(t)?Uc(t).getOr(e):e;n.selection.setRng(t.toRange())})}function ap(s,a,l){return l.format=l.format||"html",l.set=!0,l.content=op(a)?"":a,l.no_events||s.fire("BeforeSetContent",l),op(a)||(a=l.content),N.from(s.getBody()).fold(_(a),function(e){return op(a)?(t=e,o=a,r=l,ip((i=s).parser.getNodeFilters(),i.parser.getAttributeFilters(),o),n=Wh({validate:i.validate},i.schema).serialize(o),r.content=ri(q.fromDom(t))?n:te.trim(n),sp(i,r.content),r.no_events||i.fire("SetContent",r),o):(t=s,n=e,i=l,0===(r=a).length||/^\s+$/.test(r)?(o='<br data-mce-bogus="1">',"TABLE"===n.nodeName?r="<tr><td>"+o+"</td></tr>":/^(UL|OL)$/.test(n.nodeName)&&(r="<li>"+o+"</li>"),r=(e=eu(t))&&t.schema.isValidChild(n.nodeName.toLowerCase(),e.toLowerCase())?(r=o,t.dom.createHTML(e,gl(t),r)):r||'<br data-mce-bogus="1">',sp(t,r),t.fire("SetContent",i)):("raw"!==i.format&&(r=Wh({validate:t.validate},t.schema).serialize(t.parser.parse(r,{isRootContent:!0,insert:!0}))),i.content=ri(q.fromDom(n))?r:te.trim(r),sp(t,i.content),i.no_events||t.fire("SetContent",i)),i.content);var t,n,r,i,o})}function lp(e,t){return i=t,((t=(r=e).dom).parentNode?(e=q.fromDom(t.parentNode),n=function(e){return!M(r,e)&&i(e)},Ie(e.dom.childNodes,function(e){return n(q.fromDom(e))}).map(q.fromDom)):N.none()).isSome();var n,r,i}function up(e){return 0<function(e){for(var t=[];e;){if(3===e.nodeType&&e.nodeValue!==Hg||1<e.childNodes.length)return[];1===e.nodeType&&t.push(e),e=e.firstChild}return t}(e).length}function cp(e){if(e){var t=new J(e,e);for(e=t.current();e;e=t.next())if(A(e))return e}return null}function dp(e){var t=q.fromTag("span");return Lt(t,{id:Ug,"data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&kn(t,q.fromText(Hg)),t}function hp(e,t,n){void 0===n&&(n=!0);var r,i,o,s,a,l=e.dom,u=e.selection;up(t)?xf(e,!1,q.fromDom(t),n):(e=u.getRng(),n=l.getParent(t,l.isBlock),r=e.startContainer,i=e.startOffset,o=e.endContainer,s=e.endOffset,(a=cp(t))&&a.nodeValue.charAt(0)===Hg&&a.deleteData(0,1),a=a,l.remove(t,!0),r===a&&0<i&&e.setStart(a,i-1),o===a&&0<s&&e.setEnd(a,s-1),n&&l.isEmpty(n)&&Rg(q.fromDom(n)),u.setRng(e))}function fp(e,t){return e.appendChild(t),t}function pp(e,t){return e=V(e,function(e,t){return fp(e,t.cloneNode(!1))},t),fp(e,e.ownerDocument.createTextNode(Hg))}function gp(e,t,n,r){var i,o,s,a,l,u,c,d,h,f,p,g=e.dom,m=e.selection,y=[],v=m.getRng(),b=v.startContainer,E=v.startOffset,C=b;for(3===b.nodeType&&(E!==b.nodeValue.length&&(i=!0),C=C.parentNode);C;){if(Jd(e,C,t,n,r)){o=C;break}C.nextSibling&&(i=!0),y.push(C),C=C.parentNode}o&&(i?(E=m.getBookmark(),v.collapse(!0),b=Zc(e,v,e.formatter.get(t),!0),b=gd(b),e.formatter.remove(t,n,b,r),m.moveToBookmark(E)):(v=jc(e.getBody(),o),E=b=dp(!1).dom,(f=(l=e.dom).getParent(u=null!==v?v:o,w(Xu,e)))&&l.isEmpty(f)||(h=q.fromDom(u),f=la(h,"br"),p=O(function(){for(var e=[],t=h.dom;t;)e.push(q.fromDom(t)),t=t.lastChild;return e}().slice(-1),Zr),f.length===p.length&&ee(p,Dn),l.isEmpty(u))?u.parentNode.replaceChild(E,u):l.insertAfter(E,u),f=b,p=o,a=t,l=n,E=r,u=(s=e).formatter,c=s.dom,d=O(Be(u.get()),function(e){return e!==a&&!Ze(e,"removeformat")}),d=nh(s,p,d),f=0<O(d,function(e){return!rc(s,e,a)}).length?(d=p.cloneNode(!1),c.add(f,d),u.remove(a,l,d,E),c.remove(d),N.some(d)):N.none(),u=pp(y.concat(f.toArray()),b),hp(e,v,!1),m.setCursorLocation(u,1),g.isEmpty(o)&&g.remove(o)))}function mp(e,t){return e.schema.getTextInlineElements().hasOwnProperty(Z(t))&&!$c(t.dom)&&!Hn(t.dom)}function yp(e){return Q(e)&&!Gc(e)&&!$c(e)&&!Hn(e)}function vp(e,t){for(var n=e;n;n=n[t]){if(A(n)&&0!==n.nodeValue.length)return e;if(Q(n)&&!Gc(n))return n}return e}function bp(e,t,n){var r,i,o=new Gh(e);if(t&&n&&(t=vp(t,"previousSibling"),n=vp(n,"nextSibling"),o.compare(t,n))){for(r=t.nextSibling;r&&r!==n;)r=(i=r).nextSibling,t.appendChild(i);return e.remove(n),te.each(te.grep(n.childNodes),function(e){t.appendChild(e)}),t}return n}function Ep(e,t,n,r){r&&!1!==t.merge_siblings&&(t=bp(e,Yu(r),r),bp(e,t,Yu(t,!0)))}function Cp(e,t,n){zg(e.childNodes,function(e){yp(e)&&(t(e)&&n(e),e.hasChildNodes())&&Cp(e,t,n)})}function wp(t,n){return function(e){return!(!e||!ec(t,e,n))}}function Sp(n,r,i){return function(e){var t;n.setStyle(e,r,i),""===e.getAttribute("style")&&e.removeAttribute("style"),t=n,"SPAN"===(e=e).nodeName&&0===t.getAttribs(e).length&&t.remove(e,!0)}}function Tp(e,t,n){return e.isChildOf(t,n)&&t!==n&&!e.isBlock(n)}function Rp(e,t,n){var r,i=t[n?"startContainer":"endContainer"],t=t[n?"startOffset":"endOffset"];return Q(i)&&(r=i.childNodes.length-1,!n&&t&&t--,i=i.childNodes[r<t?r:t]),A(i)&&n&&t>=i.nodeValue.length&&(i=new J(i,e.getBody()).next()||i),i=A(i)&&!n&&0===t?new J(i,e.getBody()).prev()||i:i}function Ap(e,t){var n,t=t?"firstChild":"lastChild";return/^(TR|TH|TD)$/.test(e.nodeName)&&e[t]?(n=e[t],"TR"===e.nodeName&&n[t]||n):e}function _p(e,t,n,r){return e=e.create(n,r),t.parentNode.insertBefore(e,t),e.appendChild(t),e}function Np(e,t,n,r,i){return t=q.fromDom(t),e=q.fromDom(e.create(r,i)),r=(n?wn:pt)(t),yt(e,r),(n?(On(t,e),Mn):(In(t,e),kn))(e,t),e.dom}function xp(e,t,n,r){return!(t=Yu(t,n,r))||"BR"===t.nodeName||e.isBlock(t)}function Op(e,r,i,t,o){var n,s=e.dom,a=s;if(!(Kg(c=t,(u=r).inline)||Kg(c,u.block)||u.selector&&Q(c)&&a.is(c,u.selector)||r.links&&"A"===t.nodeName))return Gg.keep();var l,u,c,d,h,f,p=t;if(r.inline&&"all"===r.remove&&ye(r.preserve_attributes)){a=O(s.getAttribs(p),function(e){return xe(r.preserve_attributes,e.name.toLowerCase())});if(s.removeAllAttribs(p),ee(a,function(e){return s.setAttrib(p,e.name,e.value)}),0<a.length)return Gg.rename("span")}if("all"!==r.remove){Xg(r.styles,function(e,t){e=Ju(s,Zu(e,i),t+""),Te(t)&&(t=e,o=null),!r.remove_similar&&o&&!Kg(ec(s,o,t),e)||s.setStyle(p,t,""),n=!0}),n&&""===s.getAttrib(p,"style")&&(p.removeAttribute("style"),p.removeAttribute("data-mce-style")),Xg(r.attributes,function(e,t){var n;e=Zu(e,i),Te(t)&&(t=e,o=null),!r.remove_similar&&o&&!Kg(s.getAttrib(o,t),e)||("class"===t&&(e=s.getAttrib(p,t))&&(n="",ee(e.split(/\s+/),function(e){/mce\-\w+/.test(e)&&(n+=(n?" ":"")+e)}),n)?s.setAttrib(p,t,n):("class"===t&&p.removeAttribute("className"),Yg.test(t)&&p.removeAttribute("data-mce-"+t),p.removeAttribute(t)))}),Xg(r.classes,function(e){e=Zu(e,i),o&&!s.hasClass(o,e)||s.removeClass(p,e)});for(var g=s.getAttribs(p),m=0;m<g.length;m++){var y=g[m].nodeName;if(0!==y.indexOf("_")&&0!==y.indexOf("data-"))return Gg.keep()}}return"none"!==r.remove?(c=r,t=(u=p).parentNode,h=(l=e).dom,f=eu(l),c.block&&(f?t!==h.getRoot()||c.list_block&&Kg(u,c.list_block)||ee(Fe(u.childNodes),function(e){Ku(l,f,e.nodeName.toLowerCase())?d?d.appendChild(e):(d=_p(h,e,f),h.setAttribs(d,l.settings.forced_root_block_attrs)):d=0}):h.isBlock(u)&&!h.isBlock(t)&&(xp(h,u,!1)||xp(h,u.firstChild,!0,!0)||u.insertBefore(h.create("br"),u.firstChild),xp(h,u,!0)||xp(h,u.lastChild,!1,!0)||u.appendChild(h.create("br")))),c.selector&&c.inline&&!Kg(c.inline,u)||h.remove(u,!0),Gg.removed()):Gg.keep()}function Ip(t,e,n,r,i){return Op(t,e,n,r,i).fold(m,function(e){return t.dom.rename(r,e),!0},fe)}function Mp(r,e,t,n){var i,o,s,a=Be(t.get()),l={},u={},c=O(nc(r.dom,e),function(e){return 1===e.nodeType&&!e.getAttribute("data-mce-bogus")}),e=(X(n,function(e,n){te.each(c,function(t){return r.formatter.matchNode(t,n,{},e.similar)?(-1===a.indexOf(n)&&(ee(e.callbacks,function(e){e(!0,{node:t,format:n,parents:c})}),l[n]=e.callbacks),u[n]=e.callbacks,!1):!Zd(r,t,n)&&void 0})}),n=t.get(),i=u,o=e,s=c,Ue(n,function(e,t){return!!$e(i,t)||(ee(e,function(e){e(!1,{node:o,format:t,parents:s})}),!1)}).t);t.set(I(I({},l),e))}function kp(e,t){var n=(t||document).createDocumentFragment();return ee(e,function(e){n.appendChild(e.dom)}),q.fromDom(n)}function Dp(e,t,n){return{element:e,width:t,rows:n}}function Lp(e,t){return{element:e,cells:t}}function Pp(e,t){return e=parseInt(Xn(e,t),10),isNaN(e)?1:e}function Fp(e){return W(e,function(e,t){return t.cells.length>e?t.cells.length:e},0)}function Bp(e,t){for(var n=e.rows,r=0;r<n.length;r++)for(var i=n[r].cells,o=0;o<i.length;o++)if(M(i[o],t))return N.some({x:o,y:r});return N.none()}function Hp(e,t,n,r,i){for(var o=[],s=e.rows,a=n;a<=i;a++){var l=s[a].cells,l=t<r?l.slice(t,r+1):l.slice(r,t+1);o.push(Lp(s[a].element,l))}return o}function Up(e){var p=Dp(ha(e),0,[]);return ee(la(e,"tr"),function(h,f){ee(la(h,"td,th"),function(e,t){for(var n=p,r=function(e,t,n){for(;r=t,((i=e.rows)[n]?i[n].cells:[])[r];)t++;var r,i;return t}(p,t,f),i=f,o=h,s=e,a=Pp(s,"rowspan"),l=Pp(s,"colspan"),u=n.rows,c=i;c<i+a;c++){u[c]||(u[c]=Lp(fa(o),[]));for(var d=r;d<r+l;d++)u[c].cells[d]=c===i&&d===r?s:ha(s)}})}),Dp(p.element,Fp(p.rows),p.rows)}function Vp(e,t){var n,r,i,o=q.fromDom(t.commonAncestorContainer),e=_g(o,e),s=O(e,function(e){return Fr(e)||Kr(e)}),t=(i=t,Ie(r=e,function(e){return"li"===Z(e)&&wc(e,i)}).fold(_([]),function(e){return Ie(r,function(e){return"ul"===Z(e)||"ol"===Z(e)}).map(function(e){var t=q.fromTag(Z(e)),e=Ve(Bt(e),function(e,t){return Qe(t,"list-style")});return Ft(t,e),[q.fromTag("li"),t]}).getOr([])})),e=s.concat(t.length?t:ei(n=o)?bn(n).filter(Jr).fold(_([]),function(e){return[n,e]}):Jr(n)?[n]:[]);return x(e,ha)}function Wp(){return kp([])}function $p(e,i){return t=i[0],hr(t,"table",w(M,e)).bind(function(e){var s,t,n=i[0],r=i[i.length-1],e=Up(e);return t=r,Bp(s=e,n).bind(function(o){return Bp(s,t).map(function(e){return t=s,i=o.x,n=o.y,r=e.x,i=n<(e=e.y)?Hp(t,i,n,r,e):Hp(t,i,e,r,n),Dp(t.element,Fp(i),i);var t,n,r,i})}).map(function(e){return kp([(t=x((e=e=e).rows,function(e){var t=x(e.cells,function(e){e=fa(e);return Pt(e,"colspan"),Pt(e,"rowspan"),e}),e=ha(e.element);return yt(e,t),e}),e=ha(e.element),n=q.fromTag("tbody"),yt(n,t),kn(e,n),e)]);var t,n})}).getOrThunk(Wp);var t}function jp(e,t){var n=bc(t,e);return 0<n.length?$p(e,n):(n=e,0<(e=t).length&&e[0].collapsed?Wp():(t=n,n=e[0],e=q.fromDom(n.cloneContents()),t=Vp(t,n),n=W(t,function(e,t){return kn(t,e),t},e),0<t.length?kp([n]):n))}function zp(e,t){return 0<=t&&t<e.length&&$u(e.charAt(t))}function Gp(e,t){return e=li(e.innerText),t?e.replace(/^[ \f\n\r\t\v]+/,""):e}function Yp(e,t,n){if((n=void 0===n?{}:n).get=!0,n.format=t,n.selection=!0,(n=e.fire("BeforeGetContent",n)).isDefaultPrevented())return e.fire("GetContent",n),n.content;if("text"===n.format)return s=e,N.from(s.selection.getRng()).map(function(e){var t=N.from(s.dom.getParent(e.commonAncestorContainer,s.dom.isBlock)),n=s.getBody(),r=t.map(function(e){return e.nodeName}).getOr("div").toLowerCase(),i=K.browser.isIE()&&"pre"!==r,r=s.dom.add(n,r,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},e.cloneContents()),e=Gp(r,i),o=li(r.textContent);return s.dom.remove(r),!zp(o,0)&&!zp(o,o.length-1)||(r=t.getOr(n),-1===(t=(o=Gp(r,i)).indexOf(e)))?e:(zp(o,t-1)?" ":"")+e+(zp(o,t+e.length)?" ":"")}).getOr("");var s;n.getInner=!0,t=n,a=(r=e).selection.getRng(),i=r.dom.create("body"),o=r.selection.getSel(),o=Kd(r,vc(o)),(o=t.contextual?jp(q.fromDom(r.getBody()),o).dom:a.cloneContents())&&i.appendChild(o);var r,i,o,a=r.selection.serializer.serialize(i,t);return"tree"===n.format?a:(n.content=e.selection.isCollapsed()?"":a,e.fire("GetContent",n),n.content)}function Xp(e){return Q(e)?e.outerHTML:A(e)?$i.encodeRaw(e.data,!1):Vn(e)?"\x3c!--"+e.data+"--\x3e":""}function Kp(e,r){var i=0;ee(e,function(e){var t,n;0===e[0]?i++:1!==e[0]?2===e[0]&&(t=i,(n=r).hasChildNodes())&&t<n.childNodes.length&&(n=n.childNodes[t]).parentNode.removeChild(n):(t=r,n=e[1],e=i,n=function(e){var t,n=document.createElement("div"),r=document.createDocumentFragment();for(e&&(n.innerHTML=e);t=n.firstChild;)r.appendChild(t);return r}(n),t.hasChildNodes()&&e<t.childNodes.length?(e=t.childNodes[e]).parentNode.insertBefore(n,e):t.appendChild(n),i++)})}function qp(e,t,n){var r,i,f,p,g,m,u,y,c,o;"fragmented"===t.type?(r=t.fragments,i=e.getBody(),o=x(Fe(i.childNodes),Xp),Kp((o=(f=o).length+(p=r).length+2,g=new Array(o),m=new Array(o),y=function(e,t,n,r){for(var i=e;i-t<r&&i<n&&f[i]===p[i-t];)++i;return{start:e,end:i,diag:t}},c=function(e,t,n,r){var i=t-e,o=r-n;if(0==i||0==o)return null;var s,a,l,u,c,d=i-o,o=o+i,h=(o%2==0?o:1+o)/2;for(g[1+h]=e,m[1+h]=t+1,s=0;s<=h;++s){for(a=-s;a<=s;a+=2){for(l=a+h,a===-s||a!==s&&g[l-1]<g[l+1]?g[l]=g[l+1]:g[l]=g[l-1]+1,c=(u=g[l])-e+n-a;u<t&&c<r&&f[u]===p[c];)g[l]=++u,++c;if(d%2!=0&&d-s<=a&&a<=d+s&&m[l-d]<=g[l])return y(m[l-d],a+e-n,t,r)}for(a=d-s;a<=d+s;a+=2){for(l=a+h-d,a===d-s||a!==d+s&&m[l+1]<=m[l-1]?m[l]=m[l+1]-1:m[l]=m[l-1],c=(u=m[l]-1)-e+n-a;e<=u&&n<=c&&f[u]===p[c];)m[l]=u--,c--;if(d%2==0&&-s<=a&&a<=s&&m[l]<=g[l+d])return y(m[l],a+e-n,t,r)}}},(u=function(e,t,n,r,i){var o=c(e,t,n,r);if(null===o||o.start===t&&o.diag===t-r||o.end===e&&o.diag===e-n)for(var s=e,a=n;s<t||a<r;)s<t&&a<r&&f[s]===p[a]?(i.push([0,f[s]]),++s,++a):r-n<t-e?(i.push([2,f[s]]),++s):(i.push([1,p[a]]),++a);else{u(e,o.start,n,o.start-o.diag,i);for(var l=o.start;l<o.end;++l)i.push([0,f[l]]);u(o.end,t,o.end-o.diag,r,i)}})(0,f.length,0,p.length,r=[]),r),i)):e.setContent(t.content,{format:"raw"}),e.selection.moveToBookmark(n?t.beforeBookmark:t.bookmark)}function Zp(e){return"fragmented"===e.type?e.fragments.join(""):e.content}function Qp(e){var t=q.fromTag("body",tm.get().getOrThunk(function(){var e=document.implementation.createHTMLDocument("undo");return tm.set(N.some(e)),e}));return Pa(t,Zp(e)),ee(la(t,"*[data-mce-bogus]"),bt),t.dom.innerHTML}function Jp(e){return 0===e.get()}function eg(e){return e instanceof Ph}function tg(e,t){ip(e.serializer.getNodeFilters(),e.serializer.getAttributeFilters(),t)}function ng(){return{type:"complete",fragments:[],content:"",bookmark:null,beforeBookmark:null}}function rg(r,i){function o(e){return me(e)?e:{}}var e=c("Unimplemented feature for rtc");return{undoManager:{beforeChange:Y,addUndoLevel:e,undo:function(){return i.undo(),ng()},redo:function(){return i.redo(),ng()},clear:e,reset:e,hasUndo:function(){return i.hasUndo()},hasRedo:function(){return i.hasRedo()},transact:function(e,t,n){return i.transact(n),ng()},ignore:e,extra:e},formatter:{match:function(e,t,n){return i.matchFormat(e,o(t))},matchAll:e,matchNode:e,canApply:function(e){return i.canApplyFormat(e)},closest:function(e){return i.closestFormat(e)},apply:function(e,t,n){return i.applyFormat(e,o(t))},remove:function(e,t,n,r){return i.removeFormat(e,o(t))},toggle:function(e,t,n){return i.toggleFormat(e,o(t))},formatChanged:function(e,t,n,r){return i.formatChanged(t,n,r)}},editor:{getContent:function(e,t){var n;return"html"!==t&&"tree"!==t?sm(r).editor.getContent(e,t):(e=i.getContent(),n=Wh({inner:!0}),tg(r,e),"tree"===t?e:n.serialize(e))},setContent:function(e,t){var n=eg(e)?e:r.parser.parse(e,{isRootContent:!0,insert:!0});return i.setContent(n),e},insertContent:function(e,t){var n=N.from(r.selection.getStart(!0)).map(function(e){return e.nodeName.toLowerCase()}).fold(function(){return{}},function(e){return{context:e}}),e=eg(e)?e:r.parser.parse(e,I(I({},n),{insert:!0}));i.insertContent(e)},addVisual:function(e){}},selection:{getContent:function(e,t){var n;return"html"!==e&&"tree"!==e?sm(r).selection.getContent(e,t):(t=i.getSelectedContent(),n=Wh({}),tg(r,t),"tree"===e?t:n.serialize(t))}},raw:{getModel:function(){return N.some(i.getRawModel())}}}}function ig(e){return $e(e.plugins,"rtc")}function og(e){return e.rtcInstance||sm(e)}function sg(e,t,n){var r;e&&e.hasOwnProperty(t)&&(0===(r=O(e[t],function(e){return e!==n})).length?delete e[t]:e[t]=r)}function ag(e){return!!e.select}function lg(e){return!(!e||!e.ownerDocument)&&fn(q.fromDom(e.ownerDocument),q.fromDom(e))}function ug(l,o,e,u){function n(e,t){return p||(p={},g={},f.on("NodeChange",function(e){var n=e.element,r=h.getParents(n,null,h.getRoot()),i={};te.each(p,function(e,n){te.each(r,function(t){if(h.is(t,n))return g[n]||(te.each(e,function(e){e(!0,{node:t,selector:n,parents:r})}),g[n]=e),i[n]=e,!1})}),te.each(g,function(e,t){i[t]||(delete g[t],te.each(e,function(e){e(!1,{node:n,selector:t,parents:r})}))})})),p[e]||(p[e]=[]),p[e].push(t),{unbind:function(){sg(p,e,t),sg(g,e,t)}}}function t(e,t){var n,r,i,o,s,a;n=u,e=e=e,((e=I(I({format:"html"},t=void 0===(t=t)?{}:t),{set:!0,selection:!0,content:e})).no_events||!(e=n.fire("BeforeSetContent",e)).isDefaultPrevented())&&(t.content=(o=n,"raw"===(s=e).format?s.content:(a=o.selection.getRng(),a=(a=o.dom.getParent(a.commonAncestorContainer,o.dom.isBlock))?{context:a.nodeName.toLowerCase()}:{},a=o.parser.parse(s.content,I(I({isRootContent:!0,forced_root_block:!1},a),s)),Wh({validate:o.validate},o.schema).serialize(a))),o=s=n.selection.getRng(),a=s.createContextualFragment(t.content),t=N.from(a.firstChild).map(q.fromDom),r=N.from(a.lastChild).map(q.fromDom),o.deleteContents(),o.insertNode(a),a=t.bind(En).filter(gn).bind(am),i=r.bind(Cn).filter(gn).bind(am),lm(a,t,o,!0),lm(i,r,o,!1),o.collapse(!1),n.selection.setRng(s),mh(n,s),e.no_events)||n.fire("SetContent",e)}function r(e){var t=c();t.collapse(!!e),s(t)}function c(){function e(e,t,n){try{return t.compareBoundaryPoints(e,n)}catch(e){return-1}}var t,n;if(!o)return null;var r=o.document;if(null==r)return null;if(void 0!==u.bookmark&&!1===zd(u)){var i=Hd(u);if(i.isSome())return i.map(function(e){return Kd(u,[e])[0]}).getOr(r.createRange())}try{(t=m())&&!_t(t.anchorNode)&&(n=0<t.rangeCount?t.getRangeAt(0):(t.createRange?t:r).createRange(),n=Kd(u,[n])[0])}catch(e){}return(n=n||(r.createRange?r.createRange():r.body.createTextRange())).setStart&&9===n.startContainer.nodeType&&n.collapsed&&(i=l.getRoot(),n.setStart(i,0),n.setEnd(i,0)),a&&d&&(0===e(n.START_TO_START,n,a)&&0===e(n.END_TO_END,n,a)?n=d:d=a=null),n}function s(e,t){var n;if((r=e)&&(ag(r)||lg(r.startContainer)&&lg(r.endContainer))){var r=ag(e)?e:null;if(r){d=null;try{r.select()}catch(e){}}else{r=m();if(e=u.fire("SetSelectionRange",{range:e,forward:t}).range,r){d=e;try{r.removeAllRanges(),r.addRange(e)}catch(e){}!1===t&&r.extend&&(r.collapse(e.endContainer,e.endOffset),r.extend(e.startContainer,e.startOffset)),a=0<r.rangeCount?r.getRangeAt(0):null}e.collapsed||e.startContainer!==e.endContainer||!r.setBaseAndExtent||K.ie||e.endOffset-e.startOffset<2&&e.startContainer.hasChildNodes()&&(n=e.startContainer.childNodes[e.startOffset])&&"IMG"===n.tagName&&(r.setBaseAndExtent(e.startContainer,e.startOffset,e.endContainer,e.endOffset),r.anchorNode===e.startContainer&&r.focusNode===e.endContainer||r.setBaseAndExtent(n,0,n,1)),u.fire("AfterSetSelectionRange",{range:e,forward:t})}}}function i(){var e,t=m(),n=null==t?void 0:t.anchorNode,r=null==t?void 0:t.focusNode;return!(t&&n&&r&&!_t(n)&&!_t(r))||((e=l.createRng()).setStart(n,t.anchorOffset),e.collapse(!0),(n=l.createRng()).setStart(r,t.focusOffset),n.collapse(!0),e.compareBoundaryPoints(e.START_TO_START,n)<=0)}var a,d,h,f,p,g,m=function(){return o.getSelection?o.getSelection():o.document.selection},y={bookmarkManager:null,controlSelection:null,dom:h=l,win:o,serializer:e,editor:f=u,collapse:r,setCursorLocation:function(e,t){var n=l.createRng();e?(n.setStart(e,t),n.setEnd(e,t),s(n),r(!1)):(Sc(l,n,u.getBody(),!0),s(n))},getContent:function(e){return t=(e=void 0===(e=e)?{}:e).format||"html",C(u).selection.getContent(t,e);var t},setContent:t,getBookmark:function(e,t){return v.getBookmark(e,t)},moveToBookmark:function(e){return v.moveToBookmark(e)},select:function(e,t){var r=l,i=t;return N.from(e).map(function(e){var t=r.nodeIndex(e),n=r.createRng();return n.setStart(e.parentNode,t),n.setEnd(e.parentNode,t+1),i&&(Sc(r,n,e,!0),Sc(r,n,e,!1)),n}).each(s),e},isCollapsed:function(){var e=c(),t=m();return!(!e||e.item)&&(e.compareEndPoints?0===e.compareEndPoints("StartToEnd",e):!t||e.collapsed)},isForward:i,setNode:function(e){return t(l.getOuterHTML(e)),e},getNode:function(){return e=u.getBody(),(t=c())?(n=t.startContainer,r=t.endContainer,i=t.startOffset,o=t.endOffset,s=t.commonAncestorContainer,!t.collapsed&&(n===r&&o-i<2&&n.hasChildNodes()&&(s=n.childNodes[i]),3===n.nodeType)&&3===r.nodeType&&(n=n.length===i?Xd(n.nextSibling,!0):n.parentNode,r=0===o?Xd(r.previousSibling,!1):r.parentNode,n)&&n===r?n:s&&3===s.nodeType?s.parentNode:s):e;var e,t,n,r,i,o,s},getSel:m,setRng:s,getRng:c,getStart:function(e){return Gd(u.getBody(),c(),e)},getEnd:function(e){return Yd(u.getBody(),c(),e)},getSelectedBlocks:function(e,t){var n,r=l,i=c(),o=t,s=[],t=r.getRoot();if(e=r.getParent(e||Gd(t,i,i.collapsed),r.isBlock),o=r.getParent(o||Yd(t,i,i.collapsed),r.isBlock),e&&e!==t&&s.push(e),e&&o&&e!==o)for(var a=new J(e,t);(n=a.next())&&n!==o;)r.isBlock(n)&&s.push(n);return o&&e!==o&&o!==t&&s.push(o),s},normalize:function(){var e=c(),t=m();return 1<vc(t).length||!Tc(u)?e:((t=Ed(l,e)).each(function(e){s(e,i())}),t.getOr(e))},selectorChanged:function(e,t){return n(e,t),y},selectorChangedWithUnbind:n,getScrollContainer:function(){for(var e,t=l.getRoot();t&&"BODY"!==t.nodeName;){if(t.scrollHeight>t.clientHeight){e=t;break}t=t.parentNode}return e},scrollIntoView:function(e,t){(u.inline?Od:Md)(u,e,t)},placeCaretAt:function(e,t){return s(cd(e,t,u.getDoc()))},getBoundingClientRect:function(){var e=c();return e.collapsed?F.fromRangeStart(e).getClientRects()[0]:e.getBoundingClientRect()},destroy:function(){o=a=d=null,b.destroy()}},v=md(y),b=ld(y,u);return y.bookmarkManager=v,y.controlSelection=b,y}function cg(e,t){var n;try{n=atob(t)}catch(e){return N.none()}for(var r=new Uint8Array(n.length),i=0;i<r.length;i++)r[i]=n.charCodeAt(i);return N.some(new Blob([r],{type:e}))}var dg=jh,hg=zh,fg=te.each,pg=w(Yh,!0,$u),gg=w(Yh,!1,$u),mg=function(e){e=e.container();return A(e)&&(0===e.data.length||ai(e.data)&&md.isBookmarkNode(e.parentNode))},yg=Xh(!0,Kh),vg=Xh(!1,Kh),bg=Xh(!0,Gn),Eg=Xh(!1,Gn),Cg=Xh(!0,It),wg=Xh(!1,It),Sg=Xh(!0,qh),Tg=Xh(!1,qh),Rg=function(e){vt(e),kn(e,q.fromHtml('<br data-mce-bogus="1">'))},Ag=function(e,t){return r=m,fn(n=t,t=e)?function(e,t){for(var n=Se(t)?t:m,r=e.dom,i=[];null!==r.parentNode&&void 0!==r.parentNode;){var o=r.parentNode,s=q.fromDom(o);if(i.push(s),!0===n(s))break;r=o}return i}(t,function(e){return r(e)||M(e,n)}).slice(0,-1):[];var n,r},_g=function(e,t){return[e].concat(Ag(e,t))},Ng=w(tf,!1),xg=w(tf,!0),Og=w(ef,!1),Ig=w(ef,!0),Mg=w(rf,!1),kg=w(rf,!0),Dg=function(e,t){var n=e.data.slice(t),n=n.length-en(n).length;return bf(e,t,n)},Lg=function(e,t){var n=e.data.slice(0,t),n=n.length-tn(n).length;return bf(e,t-n,n)},Pg=jt([{removeTable:["element"]},{emptyCells:["cells"]},{deleteCellSelection:["rng","cell"]}]),Fg=function(e,n){return Mf(e.start,n).bind(function(t){return Mf(e.end,n).bind(function(e){return M(t,e)?N.some(t):N.none()})})},Bg=un,Hg=si,Ug="_mce_caret",Vg=function(e,t,n){void 0===n&&(n=!0);var r=e.dom,i=e.selection;if(t)hp(e,t,n);else if(!(t=jc(e.getBody(),i.getStart())))for(;t=r.get(Ug);)hp(e,t,!1)},Wg={},$g=Ge,jg=ae,n=function(e){var t,n=e.selection.getRng(),r=Nt(["pre"]);n.collapsed||(t=e.selection.getSelectedBlocks(),jg($g($g(t,r),function(e){return r(e.previousSibling)&&-1!==le(t,e.previousSibling)}),function(e){var t=e.previousSibling;re(e=e).remove(),re(t).append("<br><br>").append(e.childNodes)}))},zg=(Wg["pre"]||(Wg.pre=[]),Wg.pre.push(n),te.each),Gg=jt([{keep:[]},{rename:["name"]},{removed:[]}]),Yg=/^(src|href|style)$/,Xg=te.each,Kg=Qu,qg=function(E,C,w,e,S){function i(e){var n,r,i=C,o=w,s=S;ee(nc((n=E).dom,e.parentNode).reverse(),function(e){var t;r||"_start"===e.id||"_end"===e.id||(t=Jd(n,e,i,o,s))&&!1!==t.split&&(r=e)});var t,a,l=E,u=T,c=r,d=e,h=!0,f=R,p=w,g=l.dom;if(c){for(var m=c.parentNode,y=d.parentNode;y&&y!==m;y=y.parentNode){for(var v=g.clone(y,!1),b=0;b<u.length&&null!==(v=function(t,e,n){return Op(t,e,p,n,n).fold(_(n),function(e){return t.dom.createFragment().appendChild(n),t.dom.rename(n,e)},_(null))}(l,u[b],v));b++);v&&(t&&v.appendChild(t),a=a||v,t=v)}!h||f.mixed&&g.isBlock(c)||(d=g.split(c,d)),t&&(e.parentNode.insertBefore(t,e),a.appendChild(e),f.inline)&&Ep(g,f,0,t)}return d}function o(e){var t,n=a.get(e?"_start":"_end"),r=n[e?"firstChild":"lastChild"];return Gc(t=r)&&Q(t)&&("_start"===t.id||"_end"===t.id)&&(r=r[e?"firstChild":"lastChild"]),A(r)&&0===r.data.length&&(r=e?n.previousSibling||n.nextSibling:n.nextSibling||n.previousSibling),a.remove(n,!0),r}function t(e){if(e=Zc(E,e,T,e.collapsed),R.split){if(e=gd(e),(t=Rp(E,e,!0))!==(n=Rp(E,e))){var t=Ap(t,!0),n=Ap(n,!1);if(Tp(a,t,n))return r=N.from(t.firstChild).getOr(t),i(Np(a,r,!0,"span",{id:"_start","data-mce-type":"bookmark"})),void o(!0);if(Tp(a,n,t))return r=N.from(n.lastChild).getOr(n),i(Np(a,r,!1,"span",{id:"_end","data-mce-type":"bookmark"})),void o(!1);t=_p(a,t,"span",{id:"_start","data-mce-type":"bookmark"}),n=_p(a,n,"span",{id:"_end","data-mce-type":"bookmark"});var r=a.createRng();r.setStartAfter(t),r.setEndBefore(n),yc(a,r,function(e){ee(e,function(e){Gc(e)||Gc(e.parentNode)||i(e)})}),i(t),i(n),t=o(!0),n=o()}else t=n=i(t);e.startContainer=t.parentNode||t,e.startOffset=a.nodeIndex(t),e.endContainer=n.parentNode||n,e.endOffset=a.nodeIndex(n)+1}yc(a,e,function(e){ee(e,function(t){l(t),ee(["underline","line-through","overline"],function(e){Q(t)&&E.dom.getStyle(t,"text-decoration")===e&&t.parentNode&&tc(a,t.parentNode)===e&&Ip(E,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:e}},null,t)})})})}var n,T=E.formatter.get(C),R=T[0],s=!0,a=E.dom,r=E.selection,l=function(e){Q(e)&&a.getContentEditable(e)&&(t=s,s="true"===a.getContentEditable(e),n=!0);var t,n,r=Fe(e.childNodes);if(s&&!n)for(var i=0;i<T.length&&!Ip(E,T[i],w,e,e);i++);if(R.deep&&r.length){for(i=0;i<r.length;i++)l(r[i]);n&&(s=t)}};if(e)zu(e)?((n=a.createRng()).setStartBefore(e),n.setEndAfter(e),t(n)):t(e);else if("false"!==a.getContentEditable(r.getNode()))r.isCollapsed()&&R.inline&&!Jc(E).length?gp(E,C,w,S):(td(r,!0,function(){ed(E,t)}),R.inline&&eh(E,C,w,r.getStart())&&Gu(a,r,r.getRng()),E.nodeChanged());else{e=r.getNode();for(var u=0;u<T.length&&(!T[u].ceFalseOverride||!Ip(E,T[u],w,e,e));u++);}},Zg=te.each,Qg=te.each,Jg=se,em=function(y,v,b,r){function E(n,e){var t;e=e||w,n&&(e.onformat&&e.onformat(n,e,b,r),Qg(e.styles,function(e,t){g.setStyle(n,t,Zu(e,b))}),e.styles&&(t=g.getAttrib(n,"style"))&&g.setAttrib(n,"data-mce-style",t),Qg(e.attributes,function(e,t){g.setAttrib(n,t,Zu(e,b))}),Qg(e.classes,function(e){e=Zu(e,b),g.hasClass(n,e)||g.addClass(n,e)}))}function h(e,t){var n=!1;return!!oc(w)&&(Qg(e,function(e){return!("collapsed"in e&&e.collapsed!==p)&&g.is(t,e.selector)&&!$c(t)?(E(t,e),!(n=!0)):void 0}),n)}function n(g,e,t,l){var m=[],u=!0,c=w.inline||w.block,d=g.create(c);E(d),yc(g,e,function(e){var s,a=function(e){var t=!1,n=u,r=e.nodeName.toLowerCase(),i=e.parentNode.nodeName.toLowerCase();if(Q(e)&&g.getContentEditable(e)&&(n=u,u="true"===g.getContentEditable(e),t=!0),k(e)&&!function(e,t,n,r){if(e.getParam("format_empty_lines",!1,"boolean")&&sc(t))return t=I(I({},e.schema.getTextBlockElements()),{td:{},th:{},li:{},dt:{},dd:{},figcaption:{},caption:{},details:{},summary:{}}),e=lp(q.fromDom(n),function(e){return $c(e.dom)}),se(t,r)&&$r(q.fromDom(n.parentNode),!1)&&!e}(y,w,e,i))s=null,ic(w)&&g.remove(e);else if(w.wrapper&&Jd(y,e,v,b))s=null;else if(u&&!t&&ic(w)&&!w.wrapper&&Xu(y,r)&&Ku(y,i,c))o=g.rename(e,c),E(o),m.push(o),s=null;else{if(oc(w)){var o=h(C,e);if(!Jg(w,"inline")||o)return void(s=null)}!u||t||!Ku(y,c,r)||!Ku(y,i,c)||!l&&3===e.nodeType&&1===e.nodeValue.length&&65279===e.nodeValue.charCodeAt(0)||$c(e)||Jg(w,"inline")&&g.isBlock(e)?(s=null,Qg(te.grep(e.childNodes),a),t&&(u=n),s=null):(s||(s=g.clone(d,!1),e.parentNode.insertBefore(s,e),m.push(s)),s.appendChild(e))}};Qg(e,a)}),!0===w.links&&Qg(m,function(e){var t=function(e){"A"===e.nodeName&&E(e,w),Qg(te.grep(e.childNodes),t)};t(e)}),Qg(m,function(e){n=0,Qg(e.childNodes,function(e){var t;we(t=e)&&A(t)&&0===t.length||Gc(e)||n++});var n,r,t,i,o,s,a,l,u,c,d,h,f,p=n;!(1<m.length)&&g.isBlock(e)||0!==p?(sc(w)||w.wrapper)&&(w.exact||1!==p||(p=e,f=!1,Qg(p.childNodes,function(e){if((t=e)&&1===t.nodeType&&!Gc(t)&&!$c(t)&&!Hn(t))return f=e,!1;var t}),(u=f)&&!Gc(u)&&kh(g,u,w)&&(l=g.clone(u,!1),E(l),g.replace(l,p,!0),g.remove(u,!0)),e=l||p),c=y,d=b,h=e,Zg(C,function(t){var r,e,n;Zg(c.dom.select(t.inline,h),function(e){yp(e)&&Ip(c,t,d,e,t.exact?e:null)}),r=c.dom,(e=t).clear_child_styles&&(n=e.links?"*:not(a)":"*",zg(r.select(n,h),function(n){yp(n)&&zg(e.styles,function(e,t){r.setStyle(n,t,"")})}))}),i=w,Jd(t=y,(a=e).parentNode,o=v,s=b)&&Ip(t,i,s,a)||i.merge_with_parents&&t.dom.getParent(a.parentNode,function(e){if(Jd(t,e,o,s))return Ip(t,i,s,a),!0}),u=e,(l=w).styles&&l.styles.backgroundColor&&Cp(u,wp(g,"fontSize"),Sp(g,"backgroundColor",Zu(l.styles.backgroundColor,b))),r=g,p=e,u=function(e){var t;1===e.nodeType&&e.parentNode&&1===e.parentNode.nodeType&&(t=tc(r,e.parentNode),r.getStyle(e,"color")&&t?r.setStyle(e,"text-decoration",t):r.getStyle(e,"text-decoration")===t&&r.setStyle(e,"text-decoration",null))},(l=w).styles&&(l.styles.color||l.styles.textDecoration)&&(te.walk(p,u,"childNodes"),u(p)),l=g,u=e,"sub"!==(p=w).inline&&"sup"!==p.inline||(Cp(u,wp(l,"fontSize"),Sp(l,"fontSize","")),l.remove(l.select("sup"===p.inline?"sub":"sup",u),!0)),Ep(g,w,0,e)):g.remove(e,!0)})}var t,e,i,o,s,a,l,u,c,d,f,C=y.formatter.get(v),w=C[0],p=!r&&y.selection.isCollapsed(),g=y.dom,m=y.selection;if("false"!==g.getContentEditable(m.getNode()))w&&(r?zu(r)?h(C,r)||((i=g.createRng()).setStartBefore(r),i.setEndAfter(r),n(g,Zc(y,i,C),0,!0)):n(g,r,0,!0):p&&sc(w)&&!Jc(y).length?(i=v,o=b,a=(e=y).selection,l=a.getRng(),u=l.startOffset,c=l.startContainer.nodeValue,(d=jc(e.getBody(),a.getStart()))&&(s=cp(d)),f=/[^\s\u00a0\u00ad\u200b\ufeff]/,c&&0<u&&u<c.length&&f.test(c.charAt(u))&&f.test(c.charAt(u-1))?(f=a.getBookmark(),l.collapse(!0),c=Zc(e,l,e.formatter.get(i)),c=gd(c),e.formatter.apply(i,o,c),a.moveToBookmark(f)):(d&&s.nodeValue===Hg||(c=e.getDoc(),f=dp(!0).dom,s=(d=c.importNode(f,!0)).firstChild,l.insertNode(d),u=1),e.formatter.apply(i,o,d),a.setCursorLocation(s,u))):(c=m.getNode(),f=C[0],y.settings.forced_root_block||!f.defaultBlock||g.getParent(c,g.isBlock)||em(y,f.defaultBlock),m.setRng(qf(m.getRng())),td(m,!0,function(e){ed(y,function(e,t){t=t?e:Zc(y,e,C);n(g,t)})}),Gu(g,m,m.getRng()),y.nodeChanged()),t=y,jg(Wg[v],function(e){e(t)}));else{r=m.getNode();for(var S=0,T=C.length;S<T;S++){var R=C[S];if(R.ceFalseOverride&&oc(R)&&g.is(r,R.selector))return void E(r,R)}}},tm=P(N.none()),nm=function(t){e=t.getBody();var e=O(x(Fe(e.childNodes),Xp),function(e){return 0<e.length}),e=ke(e,function(e){e=zh(t.serializer,e);return 0<e.length?[e]:[]}),n=e.join("");return-1!==n.indexOf("</iframe>")?{type:"fragmented",fragments:e,content:"",bookmark:null,beforeBookmark:null}:{type:"complete",fragments:null,content:n,bookmark:null,beforeBookmark:null}},rm=function(e,t){return!(!e||!t)&&(n=t,Zp(e)===Zp(n)||(n=t,Qp(e)===Qp(n)));var n},im=function(e,t,n){Jp(n)&&(e.typing=t)},om=function(e,t){e.typing&&(im(e,!1,t),e.add())},sm=function(p){return{undoManager:{beforeChange:function(e,t){var n=p;Jp(e)&&t.set(N.some(Ql(n.selection)))},addUndoLevel:function(e,t,n,r,i,o){var s=p,a=e,l=t,e=n,t=r,n=i,r=o,i=nm(s);if(n=te.extend(n=n||{},i),!1===Jp(e)||s.removed)return null;if(i=a.data[l.get()],s.fire("BeforeAddUndo",{level:n,lastLevel:i,originalEvent:r}).isDefaultPrevented())return null;if(i&&rm(i,n))return null;if(a.data[l.get()]&&t.get().each(function(e){a.data[l.get()].beforeBookmark=e}),(e=s.getParam("custom_undo_redo_levels",0,"number"))&&a.data.length>e){for(var u=0;u<a.data.length-1;u++)a.data[u]=a.data[u+1];a.data.length--,l.set(a.data.length)}return n.bookmark=Ql(s.selection),l.get()<a.data.length-1&&(a.data.length=l.get()+1),a.data.push(n),l.set(a.data.length-1),t={level:n,lastLevel:i,originalEvent:r},0<l.get()?(s.setDirty(!0),s.fire("AddUndo",t),s.fire("change",t)):s.fire("AddUndo",t),n},undo:function(e,t,n){return r=p,t=t,n=n,(e=e).typing&&(e.add(),e.typing=!1,im(e,!1,t)),0<n.get()&&(n.set(n.get()-1),i=e.data[n.get()],qp(r,i,!0),r.setDirty(!0),r.fire("Undo",{level:i})),i;var r,i},redo:function(e,t){return n=p,t=t,(e=e).get()<t.length-1&&(e.set(e.get()+1),r=t[e.get()],qp(n,r,!1),n.setDirty(!0),n.fire("Redo",{level:r})),r;var n,r},clear:function(e,t){var n=p;(e=e).data=[],t.set(0),e.typing=!1,n.fire("ClearUndos")},reset:function(e){(e=e).clear(),e.add()},hasUndo:function(e,t){return n=p,e=e,0<t.get()||e.typing&&e.data[0]&&!rm(nm(n),e.data[0]);var n},hasRedo:function(e,t){return e=e,t.get()<e.data.length-1&&!e.typing},transact:function(e,t,n){return n=n,om(e=e,t),e.beforeChange(),e.ignore(n),e.add()},ignore:function(e,t){try{e.set(e.get()+1),t()}finally{e.set(e.get()-1)}},extra:function(e,t,n,r){var i,o=p;(e=e).transact(n)&&(n=e.data[t.get()].bookmark,i=e.data[t.get()-1],qp(o,i,!0),e.transact(r))&&(e.data[t.get()-1].beforeBookmark=n)}},formatter:{match:function(e,t,n){return eh(p,e,t,n)},matchAll:function(e,t){return i=e,o=t,s=[],a={},e=(r=p).selection.getStart(),r.dom.getParent(e,function(e){for(var t=0;t<i.length;t++){var n=i[t];!a[n]&&Jd(r,e,n,o)&&(a[n]=!0,s.push(n))}},r.dom.getRoot()),s;var r,i,o,s,a},matchNode:function(e,t,n,r){return Jd(p,e,t,n,r)},canApply:function(e){var t,n,r,i,o=p,s=o.formatter.get(e),a=o.dom;if(s)for(o=o.selection.getStart(),t=nc(a,o),r=s.length-1;0<=r;r--){if(!(i=s[r].selector)||s[r].defaultBlock)return!0;for(n=t.length-1;0<=n;n--)if(a.is(t[n],i))return!0}return!1},closest:function(e){return th(p,e)},apply:function(e,t,n){return em(p,e,t,n)},remove:function(e,t,n,r){return qg(p,e,t,n,r)},toggle:function(e,t,n){var r,i=(r=p).formatter.get(e);(!eh(r,e,t,n)||"toggle"in i[0]&&!i[0].toggle?em:qg)(r,e,t,n)},formatChanged:function(e,t,n,r){return i=p,s=t,a=n,t=r,null===(o=e).get()&&(u=i,c=P({}),(l=o).set({}),u.on("NodeChange",function(e){Mp(u,e.element,c,l.get())})),i=s,d=a,h=t,f=(t=o).get(),ee(i.split(","),function(e){f[e]||(f[e]={similar:h,callbacks:[]}),f[e].callbacks.push(d)}),t.set(f),{unbind:function(){var e,t=s,n=a,r=(e=o).get();ee(t.split(","),function(e){r[e].callbacks=O(r[e].callbacks,function(e){return e!==n}),0===r[e].callbacks.length&&delete r[e]}),e.set(r)}};var i,o,s,a,l,u,c,d,h,f}},editor:{getContent:function(e,t){return o=p,s=e,a=t,N.from(o.getBody()).fold(_("tree"===s.format?new Ph("body",11):""),function(e){return t=o,r=a,e=e,(n=s).format=r,n.get=!0,n.getInner=!0,n.no_events||t.fire("BeforeGetContent",n),i="raw"===n.format?te.trim(hg(t.serializer,e.innerHTML)):"text"===n.format?t.dom.isEmpty(e)?"":li(e.innerText||e.textContent):"tree"===n.format?t.serializer.serialize(e,n):(i=(r=t).serializer.serialize(e,n),r=eu(r),r=new RegExp("^(<"+r+"[^>]*>(&nbsp;|&#160;|\\s| |<br \\/>|)<\\/"+r+">[\r\n]*|<br \\/>[\r\n]*)$"),i.replace(r,"")),xe(["text","tree"],n.format)||ri(q.fromDom(e))?n.content=i:n.content=te.trim(i),n.no_events||t.fire("GetContent",n),n.content;var t,n,r,i});var o,s,a},setContent:function(e,t){return ap(p,e,t)},insertContent:function(e,t){return np(p,e,t)},addVisual:function(e){var r,i=(r=p).dom,t=we(e)?e:r.getBody();Ee(r.hasVisual)&&(r.hasVisual=r.getParam("visual",!0,"boolean")),ee(i.select("table,a",t),function(e){switch(e.nodeName){case"TABLE":var t=r.getParam("visual_table_class","mce-item-table","string"),n=i.getAttrib(e,"border");n&&"0"!==n||!r.hasVisual?i.removeClass(e,t):i.addClass(e,t);break;case"A":i.getAttrib(e,"href")||(n=i.getAttrib(e,"name")||e.id,t=r.getParam("visual_anchor_class","mce-item-anchor","string"),n&&r.hasVisual?i.addClass(e,t):i.removeClass(e,t))}}),r.fire("VisualAid",{element:e,hasVisual:r.hasVisual})}},selection:{getContent:function(e,t){return Yp(p,e,t)}},raw:{getModel:function(){return N.none()}}}},C=function(e){e=e.rtcInstance;if(e)return e;throw new Error("Failed to get RTC instance not yet initialized.")},am=function(e){return 0===e.dom.length?(Dn(e),N.none()):N.some(e)},lm=function(e,t,s,a){e.bind(function(o){return(a?Lg:Dg)(o.dom,a?o.dom.length:0),t.filter(gn).map(function(e){var t=s,n=a,r=o.dom,e=e.dom,i=(n?r:e).length;n?(Ef(r,e,!1,!n),t.setStart(e,i)):(Ef(e,r,!1,!n),t.setEnd(e,i))})}).orThunk(function(){var e=a;return t.filter(function(e){return md.isBookmarkNode(e.dom)}).bind(e?Cn:En).or(t).filter(gn).map(function(e){var n,r=a;bn(n=e).each(function(e){var t=n.dom;r&&hf(e,F(t,0))?Dg(t,0):!r&&ff(e,F(t,t.length))&&Lg(t,t.length)})})})},um=function(e,s,a){e.addNodeFilter("font",function(e){ee(e,function(e){var t,n=s.parse(e.attr("style")),r=e.attr("color"),i=e.attr("face"),o=e.attr("size");r&&(n.color=r),i&&(n["font-family"]=i),o&&(n["font-size"]=a[parseInt(e.attr("size"),10)-1]),e.name="span",e.attr("style",s.serialize(n)),t=e,ee(["color","face","size"],function(e){t.attr(e,null)})})})},cm=function(e){var t,e=decodeURIComponent(e).split(","),n=/data:([^;]+)/.exec(e[0]);return{type:t=n?n[1]:t,data:e[1]}},dm=function(e){return 0===e.indexOf("blob:")?(i=e,new Er(function(e,t){function n(){t("Cannot convert "+i+" to Blob. Resource might not exist or is inaccessible.")}try{var r=new XMLHttpRequest;r.open("GET",i,!0),r.responseType="blob",r.onload=function(){200===this.status?e(this.response):n()},r.onerror=n,r.send()}catch(e){n()}})):0===e.indexOf("data:")?(r=e,new Er(function(e){var t=cm(r),n=t.type,t=t.data;cg(n,t).fold(function(){return e(new Blob([]))},e)})):null;var i,r},hm=0,fm=function(e){return(e||"blobid")+hm++};function pm(r,u){var i={};return{findAll:function(e,n){n=n||fe;e=O(e?Fe(e.getElementsByTagName("img")):[],function(e){var t=e.src;return!!K.fileApi&&!e.hasAttribute("data-mce-bogus")&&!e.hasAttribute("data-mce-placeholder")&&!(!t||t===K.transparentSrc)&&(0===t.indexOf("blob:")?!r.isUploaded(t)&&n(e):0===t.indexOf("data:")&&n(e))}),e=x(e,function(l){var e;return void 0!==i[l.src]?new Er(function(t){i[l.src].then(function(e){return"string"==typeof e?e:void t({image:l,blobInfo:e.blobInfo})})}):(e=new Er(function(e,t){var r,i,o,n,s,a;r=u,o=e,n=t,0!==(i=l).src.indexOf("blob:")?(t=(e=cm(i.src)).data,e=e.type,s=t,(a=r.getByData(s,e))?o({image:i,blobInfo:a}):dm(i.src).then(function(e){a=r.create(fm(),e,s),r.add(a),o({image:i,blobInfo:a})},function(e){n(e)})):(a=r.getByUri(i.src))?o({image:i,blobInfo:a}):dm(i.src).then(function(t){var n=t;new Er(function(e){var t=new FileReader;t.onloadend=function(){e(t.result)},t.readAsDataURL(n)}).then(function(e){s=cm(e).data,a=r.create(fm(),t,s),r.add(a),o({image:i,blobInfo:a})})},function(e){n(e)})}).then(function(e){return delete i[e.image.src],e}).catch(function(e){return delete i[l.src],e}),i[l.src]=e)});return Er.all(e)}}}function gm(e,t){return e&&e.firstChild&&e.firstChild===e.lastChild&&e.firstChild.name===t}function mm(e,t){var o,s,n,a,l,r,u,c,d;return o=e,n=["data-mce-selected"],a=(s=t)&&s.dom?s.dom:L.DOM,l=s&&s.schema?s.schema:eo(o),o.entity_encoding=o.entity_encoding||"named",o.remove_trailing_brs=!("remove_trailing_brs"in o)||o.remove_trailing_brs,u=Lm(o,l),c=o,d=a,(r=u).addAttributeFilter("data-mce-tabindex",function(e,t){for(var n,r=e.length;r--;)(n=e[r]).attr("tabindex",n.attr("data-mce-tabindex")),n.attr(t,null)}),r.addAttributeFilter("src,href,style",function(e,t){for(var n,r,i=e.length,o="data-mce-"+t,s=c.url_converter,a=c.url_converter_scope;i--;)void 0!==(r=(n=e[i]).attr(o))?(n.attr(t,0<r.length?r:null),n.attr(o,null)):(r=n.attr(t),"style"===t?r=d.serializeStyle(d.parseStyle(r),n.name):s&&(r=s.call(a,r,t,n.name)),n.attr(t,0<r.length?r:null))}),r.addAttributeFilter("class",function(e){for(var t,n,r=e.length;r--;)(t=e[r]).attr("class")&&(n=t.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),t.attr("class",0<n.length?n:null))}),r.addAttributeFilter("data-mce-type",function(e,t,n){for(var r,i=e.length;i--;)"bookmark"!==(r=e[i]).attr("data-mce-type")||n.cleanup||(N.from(r.firstChild).exists(function(e){return!ai(e.value)})?r.unwrap():r.remove())}),r.addNodeFilter("noscript",function(e){for(var t,n=e.length;n--;)(t=e[n].firstChild)&&(t.value=$i.decode(t.value))}),r.addNodeFilter("script,style",function(e,t){for(var n,r,i,o=e.length,s=function(e){return e.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")};o--;)r=(n=e[o]).firstChild?n.firstChild.value:"","script"===t?((i=n.attr("type"))&&n.attr("type","mce-no/type"===i?null:i.replace(/^mce\-/,"")),"xhtml"===c.element_format&&0<r.length&&(n.firstChild.value="// <![CDATA[\n"+s(r)+"\n// ]]>")):"xhtml"===c.element_format&&0<r.length&&(n.firstChild.value="\x3c!--\n"+s(r)+"\n--\x3e")}),r.addNodeFilter("#comment",function(e){for(var t,n=e.length;n--;)t=e[n],c.preserve_cdata&&0===t.value.indexOf("[CDATA[")?(t.name="#cdata",t.type=4,t.value=d.decode(t.value.replace(/^\[CDATA\[|\]\]$/g,""))):0===t.value.indexOf("mce:protected ")&&(t.name="#text",t.type=3,t.raw=!0,t.value=unescape(t.value).substr(14))}),r.addNodeFilter("xml:namespace,input",function(e,t){for(var n,r=e.length;r--;)7===(n=e[r]).type?n.remove():1!==n.type||"input"!==t||n.attr("type")||n.attr("type","text")}),r.addAttributeFilter("data-mce-type",function(e){ee(e,function(e){"format-caret"===e.attr("data-mce-type")&&(e.isEmpty(r.schema.getNonEmptyElements())?e.remove():e.unwrap())})}),r.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize,data-mce-placeholder",function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)}),{schema:(e={schema:l,addNodeFilter:u.addNodeFilter,addAttributeFilter:u.addAttributeFilter,serialize:function(e,t){var n,t=I({format:"html"},t=void 0===t?{}:t),r=(e=Pm(s,e,t),n=li((r=t).getInner?e.innerHTML:a.getOuterHTML(e)),r.selection||ri(q.fromDom(e))?n:te.trim(n)),i=(e=u,n=r,r=(r=t).selection?I({forced_root_block:!1},r):r,(i=function(e){return e&&"br"===e.name})(n=(e=e.parse(n,r)).lastChild)&&i(r=n.prev)&&(n.remove(),r.remove()),e);return"tree"===t.format?i:Bm(s,o,l,i,t)},addRules:function(e){l.addValidElements(e)},setRules:function(e){l.setValidElements(e)},addTempAttr:w(Fm,u,n),getTempAttrs:function(){return n},getNodeFilters:u.getNodeFilters,getAttributeFilters:u.getAttributeFilters}).schema,addNodeFilter:e.addNodeFilter,addAttributeFilter:e.addAttributeFilter,serialize:e.serialize,addRules:e.addRules,setRules:e.setRules,addTempAttr:e.addTempAttr,getTempAttrs:e.getTempAttrs,getNodeFilters:e.getNodeFilters,getAttributeFilters:e.getAttributeFilters}}function ym(e,t,n){return t=t,n=n=void 0===n?{}:n,og(e).editor.setContent(t,n)}function vm(e){N.from(e).each(function(e){return e.destroy()})}function bm(e){return e=ye(e)?e.join(" "):e,e=x(ge(e)?e.split(" "):[],Jt),O(e,function(e){return 0<e.length})}function Em(e,t){return e.sections().hasOwnProperty(t)}function Cm(e,t,n,r){var n=bm(n.forced_plugins),i=bm(r.plugins),o=(o=Em(o=t,"mobile")?o.sections().mobile:{}).plugins?bm(o.plugins):i;t=t,i=i,o=o,s=(e=e)&&(0,a=(s=t).sections(),Em(s,"mobile"))&&"mobile"===a.mobile.theme?O(o,w(xe,zm)):e&&Em(t,"mobile")?o:i;var s,a=[].concat(bm(n)).concat(bm(s));if(K.browser.isIE()&&xe(a,"rtc"))throw new Error("RTC plugin is not supported on IE 11.");return te.extend(r,{plugins:a.join(" ")})}function wm(e,t,n){return N.from(t.settings[n]).filter(e)}function Sm(e,t){return t.dom[e]}function Tm(e,t){return parseInt(qn(t,e),10)}function Rm(e,t,n){var r,i=q.fromDom(e.getBody()),i=e.inline?i:q.fromDom(vn(i).dom.documentElement);e=e.inline,t=t,n=n,r=(o=i).dom.getBoundingClientRect();var n=(t={x:t-(e?r.left+o.dom.clientLeft+Jm(o):0),y:n-(e?r.top+o.dom.clientTop+Qm(o):0)}).x,e=t.y,o=qm(r=i),t=Zm(r);return 0<=n&&0<=e&&n<=o&&e<=t}var Am,_m,Nm=function(e,t,n,r){(e.padd_empty_with_br||t.insert)&&n[r.name]?r.empty().append(new Ph("br",1)).shortEnded=!0:r.empty().append(new Ph("#text",3)).value=oi},xm=function(t,e,n,r){return r.isEmpty(e,n,function(e){return(e=t.getElementRule(e.name))&&e.paddEmpty})},Om=function(e,i){function t(r){var e,t=r.attr("src");(e=r).attr("src")===K.transparentSrc||e.attr("data-mce-placeholder")||r.attr("data-mce-bogus")||((e=/data:([^;]+);base64,([a-z0-9\+\/=]+)/i.exec(t))?N.some({type:e[1],data:decodeURIComponent(e[2])}):N.none()).filter(function(){return e=r,!(t=i).images_dataimg_filter||((n=new Image).src=e.attr("src"),X(e.attributes.map,function(e,t){n.setAttribute(t,e)}),t.images_dataimg_filter(n));var e,t,n}).bind(function(e){var t=e.type,n=e.data;return N.from(o.getByData(n,t)).orThunk(function(){return cg(t,n).map(function(e){e=o.create(fm(),e,n);return o.add(e),e})})}).each(function(e){r.attr("src",e.blobUri())})}var o=i.blob_cache;o&&e.addAttributeFilter("src",function(e){return ee(e,t)})},Im=te.makeMap,Mm=te.each,km=te.explode,Dm=te.extend,Lm=function(Y,X){void 0===X&&(X=eo());var K={},q=[],Z={},Q={};(Y=Y||{}).validate=!("validate"in Y)||Y.validate,Y.root_name=Y.root_name||"body";function J(e){var t,n,r=e.name;r in K&&((n=Z[r])?n.push(e):Z[r]=[e]),t=q.length;for(;t--;)(r=q[t].name)in e.attributes.map&&((n=Q[r])?n.push(e):Q[r]=[e]);return e}var e,n,t,r,p,g,i={schema:X,addAttributeFilter:function(e,n){Mm(km(e),function(e){for(var t=0;t<q.length;t++)if(q[t].name===e)return void q[t].callbacks.push(n);q.push({name:e,callbacks:[n]})})},getAttributeFilters:function(){return[].concat(q)},addNodeFilter:function(e,n){Mm(km(e),function(e){var t=K[e];t||(K[e]=t=[]),t.push(n)})},getNodeFilters:function(){var e,t=[];for(e in K)K.hasOwnProperty(e)&&t.push({name:e,callbacks:K[e]});return t},filterNode:J,parse:function(P,o){var e,t,n,r,i,a,s,l,u=[];o=o||{},Z={},Q={};function c(e,t){var n,t=new Ph(e,t);return e in K&&((n=Z[e])?n.push(t):Z[e]=[t]),t}function d(e){for(var t,n=X.getBlockElements(),r=e.prev;r&&3===r.type;){if(0<(t=r.value.replace(E,"")).length)return r.value=t;if(t=r.next){if(3===t.type&&t.value.length){r=r.prev;continue}if(!n[t.name]&&"script"!==t.name&&"style"!==t.name){r=r.prev;continue}}t=r.prev,r.remove(),r=t}}var h=Dm(Im("script,style,head,html,body,title,meta,param"),X.getBlockElements()),f=X.getNonEmptyElements(),p=X.children,g=Y.validate,m=("forced_root_block"in o?o:Y).forced_root_block,y=!1===m?"":!0===m?"p":m,v=X.getWhiteSpaceElements(),b=/^[ \t\r\n]+/,E=/[ \t\r\n]+$/,F=/[ \t\r\n]+/g,C=/^[ \t\r\n]+$/,w=v.hasOwnProperty(o.context)||v.hasOwnProperty(Y.root_name),m=dg({validate:g,allow_html_data_urls:Y.allow_html_data_urls,allow_svg_data_urls:Y.allow_svg_data_urls,allow_script_urls:Y.allow_script_urls,allow_conditional_comments:Y.allow_conditional_comments,preserve_cdata:Y.preserve_cdata,self_closing_elements:function(e){var t,n={};for(t in e)"li"!==t&&"p"!==t&&(n[t]=e[t]);return n}(X.getSelfClosingElements()),cdata:function(e){l.append(c("#cdata",4)).value=e},text:function(e,t){var n;w||(e=e.replace(F," "),(n=l.lastChild)&&(h[n.name]||"br"===n.name)&&(e=e.replace(b,""))),0!==e.length&&((n=c("#text",3)).raw=!!t,l.append(n).value=e)},comment:function(e){l.append(c("#comment",8)).value=e},pi:function(e,t){l.append(c(e,7)).value=t,d(l)},doctype:function(e){l.append(c("#doctype",10)).value=e,d(l)},start:function(e,t,n){var r,i,o,s=g?X.getElementRule(e):{};if(s){for((r=c(s.outputName||e,1)).attributes=t,r.shortEnded=n,l.append(r),(s=p[l.name])&&p[r.name]&&!s[r.name]&&u.push(r),i=q.length;i--;)(o=q[i].name)in t.map&&((a=Q[o])?a.push(r):Q[o]=[r]);h[e]&&d(r),n||(l=r),!w&&v[e]&&(w=!0)}},end:function(e){var t,n,r,i=g?X.getElementRule(e):{};if(i){if(h[e]&&!w){if((t=l.firstChild)&&3===t.type)if(0<(n=t.value.replace(b,"")).length)t.value=n,t=t.next;else for(r=t.next,t.remove(),t=r;t&&3===t.type;)n=t.value,r=t.next,0!==n.length&&!C.test(n)||(t.remove(),t=r),t=r;if((t=l.lastChild)&&3===t.type)if(0<(n=t.value.replace(E,"")).length)t.value=n,t=t.prev;else for(r=t.prev,t.remove(),t=r;t&&3===t.type;)n=t.value,r=t.prev,0!==n.length&&!C.test(n)||(t.remove(),t=r),t=r}(w&&v[e]&&(w=!1),i.removeEmpty&&xm(X,f,v,l))?(e=l.parent,h[l.name]?l.empty().remove():l.unwrap(),l=e):(i.paddEmpty&&(gm(e=l,"#text")&&e.firstChild.value===oi||xm(X,f,v,l))&&Nm(Y,o,h,l),l=l.parent)}}},X),S=l=new Ph(o.context||Y.root_name,11);if(m.parse(P,o.format),g&&u.length)if(o.context)o.invalid=!0;else for(var B=u,T,R,A,_,N,x,O,I,M,H,U=Im("tr,td,th,tbody,thead,tfoot,table"),V=X.getNonEmptyElements(),W=X.getWhiteSpaceElements(),$=X.getTextBlockElements(),j=X.getSpecialElements(),k=0;k<B.length;k++)if((T=B[k]).parent&&!T.fixed)if($[T.name]&&"li"===T.parent.name){for(M=T.next;M&&$[M.name];)M.name="li",M.fixed=!0,T.parent.insert(M,T.parent),M=M.next;T.unwrap(T)}else{for(A=[T],R=T.parent;R&&!X.isValidChild(R.name,T.name)&&!U[R.name];R=R.parent)A.push(R);if(R&&1<A.length){for(A.reverse(),_=N=J(A[0].clone()),I=0;I<A.length-1;I++){for(X.isValidChild(N.name,A[I].name)?(x=J(A[I].clone()),N.append(x)):x=N,O=A[I].firstChild;O&&O!==A[I+1];)H=O.next,x.append(O),O=H;N=x}xm(X,V,W,_)?R.insert(T,A[0],!0):(R.insert(_,A[0],!0),R.insert(T,_)),(xm(X,V,W,R=A[0])||gm(R,"br"))&&R.empty().remove()}else if(T.parent){if("li"===T.name){if((M=T.prev)&&("ul"===M.name||"ol"===M.name)){M.append(T);continue}if((M=T.next)&&("ul"===M.name||"ol"===M.name)){M.insert(T,M.firstChild,!0);continue}T.wrap(J(new Ph("ul",1)));continue}X.isValidChild(T.parent.name,"div")&&X.isValidChild("div",T.name)?T.wrap(J(new Ph("div",1))):j[T.name]?T.empty().remove():T.unwrap()}}if(y&&("body"===S.name||o.isRootContent)){function z(e){e&&((L=e.firstChild)&&3===L.type&&(L.value=L.value.replace(b,"")),L=e.lastChild)&&3===L.type&&(L.value=L.value.replace(E,""))}var G,D,L=S.firstChild;if(X.isValidChild(S.name,y.toLowerCase())){for(;L;)G=L.next,3===L.type||1===L.type&&"p"!==L.name&&!h[L.name]&&!L.attr("data-mce-type")?(D||((D=c(y,1)).attr(Y.forced_root_block_attrs),S.insert(D,L)),D.append(L)):(z(D),D=null),L=G;z(D)}}if(!o.invalid){for(s in Z)if(Z.hasOwnProperty(s)){for(a=K[s],r=(e=Z[s]).length;r--;)e[r].parent||e.splice(r,1);for(t=0,n=a.length;t<n;t++)a[t](e,s,o)}for(t=0,n=q.length;t<n;t++)if((a=q[t]).name in Q){for(r=(e=Q[a.name]).length;r--;)e[r].parent||e.splice(r,1);for(r=0,i=a.callbacks.length;r<i;r++)a.callbacks[r](e,a.name,o)}}return S}};return p=Y,g=(r=i).schema,p.remove_trailing_brs&&r.addNodeFilter("br",function(e,t,n){var r,i,o,s,a,l,u,c=e.length,d=te.extend({},g.getBlockElements()),h=g.getNonEmptyElements(),f=g.getWhiteSpaceElements();for(d.body=1,r=0;r<c;r++)if(o=(i=e[r]).parent,d[i.parent.name]&&i===o.lastChild){for(a=i.prev;a;){if("span"!==(l=a.name)||"bookmark"!==a.attr("data-mce-type")){"br"===l&&(i=null);break}a=a.prev}i&&(i.remove(),xm(g,h,f,o))&&(u=g.getElementRule(o.name))&&(u.removeEmpty?o.remove():u.paddEmpty&&Nm(p,n,d,o))}else{for(s=i;o&&o.firstChild===s&&o.lastChild===s&&!d[(s=o).name];)o=o.parent;s===o&&!0!==p.padd_empty_with_br&&((u=new Ph("#text",3)).value=oi,i.replace(u))}}),r.addAttributeFilter("href",function(e){var t=e.length;if(!p.allow_unsafe_link_target)for(;t--;){var n=e[t];"a"===n.name&&"_blank"===n.attr("target")&&n.attr("rel",(n=(n=n.attr("rel"))?te.trim(n):"",/\b(noopener)\b/g.test(n)?n:n.split(" ").filter(function(e){return 0<e.length}).concat(["noopener"]).sort().join(" ")))}}),p.allow_html_in_named_anchor||r.addAttributeFilter("id,name",function(e){for(var t,n,r,i,o=e.length;o--;)if("a"===(i=e[o]).name&&i.firstChild&&!i.attr("href"))for(r=i.parent,t=i.lastChild;n=t.prev,r.insert(t,i),t=n;);}),p.fix_list_elements&&r.addNodeFilter("ul,ol",function(e){for(var t,n,r=e.length;r--;)"ul"!==(n=(t=e[r]).parent).name&&"ol"!==n.name||(t.prev&&"li"===t.prev.name?t.prev.append(t):((n=new Ph("li",1)).attr("style","list-style-type: none"),t.wrap(n)))}),p.validate&&g.getValidClasses()&&r.addAttributeFilter("class",function(e){for(var t,n,r,i,o,s,a,l=e.length,u=g.getValidClasses();l--;){for(n=(t=e[l]).attr("class").split(" "),o="",r=0;r<n.length;r++)i=n[r],a=!1,(s=u["*"])&&s[i]&&(a=!0),s=u[t.name],(a=!a&&s&&s[i]?!0:a)&&(o&&(o+=" "),o+=i);o.length||(o=null),t.attr("class",o)}}),Om(r,p),Y.inline_styles&&(r=i,e=Y,t=ao(),e.convert_fonts_to_spans&&um(r,t,te.explode(e.font_size_legacy_values)),n=t,r.addNodeFilter("strike",function(e){ee(e,function(e){var t=n.parse(e.attr("style"));t["text-decoration"]="line-through",e.name="span",e.attr("style",n.serialize(t))})})),i},Pm=function(e,t,n){return a=n,e&&e.hasEventListeners("PreProcess")&&!a.no_events?(a=t,n=n,o=(e=e).dom,a=a.cloneNode(!0),(s=document.implementation).createHTMLDocument&&(r=s.createHTMLDocument(""),te.each("BODY"===a.nodeName?a.childNodes:[a],function(e){r.body.appendChild(r.importNode(e,!0))}),a="BODY"!==a.nodeName?r.body.firstChild:r.body,i=o.doc,o.doc=r),s=e,e=I(I({},n),{node:a}),s.fire("PreProcess",e),i&&(o.doc=i),a):t;var r,i,o,s,a},Fm=function(e,t,n){-1===te.inArray(t,n)&&(e.addAttributeFilter(n,function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)}),t.push(n))},Bm=function(e,t,n,r,i){t=Wh(t,n).serialize(r);return i.no_events||!e?t:(n=e,r=I(I({},i),{content:t}),n.fire("PostProcess",r).content)},Hm=L.DOM,Um=Object.prototype.hasOwnProperty,Vm=(Am=function(e,t){return me(e)&&me(t)?Vm(e,t):t},function(){for(var e=new Array(arguments.length),t=0;t<e.length;t++)e[t]=arguments[t];if(0===e.length)throw new Error("Can't merge zero objects");for(var n={},r=0;r<e.length;r++){var i,o=e[r];for(i in o)Um.call(o,i)&&(n[i]=Am(n[i],o[i]))}return n}),t=an().deviceType,Wm=t.isTouch(),$m=t.isPhone(),jm=t.isTablet(),zm=["lists","autolink","autosave"],Gm={table_grid:!1,object_resizing:!1,resize:!1},Ym=function(e,t){return We(e,"toolbar_mode").orThunk(function(){return We(e,"toolbar_drawer").map(function(e){return!1===e?"wrap":e})}).getOr(t)},Xm=function(e,t,n,r,i){var o,s,a=e?{mobile:(a=i.mobile||{},t=t,a={resize:!1,toolbar_mode:Ym(a,"scrolling"),toolbar_sticky:!1},I(I(I({},Gm),a),t?{menubar:!1}:{}))}:{},i=(s=["mobile"],t=Vm(a,i),t=Ue(t,function(e,t){return xe(s,t)}),a=t.t,t=t.f,{sections:_(a),settings:_(t)}),t=te.extend(n,r,i.settings(),e&&Em(i,"mobile")?(void 0===o&&(o={}),t=(t=i.sections()).hasOwnProperty("mobile")?t.mobile:{},te.extend({},o,t)):{},{validate:!0,external_plugins:(n=r,o=i.settings().external_plugins||{},n&&n.external_plugins?te.extend({},n.external_plugins,o):o)});return Cm(e,i,r,t)},Km=(_m={},{add:function(e,t){_m[e]=t},get:function(e){return _m[e]||{icons:{}}},has:function(e){return $e(_m,e)}}),qm=w(Sm,"clientWidth"),Zm=w(Sm,"clientHeight"),Qm=w(Tm,"margin-top"),Jm=w(Tm,"margin-left"),e0=function(e){e=e.inline?e.getBody():e.getContentAreaContainer();return N.from(e).map(q.fromDom).map(Ln).getOr(!1)};function t0(n){function r(){return N.from(a[0])}function i(){0<a.length&&l().reposition(a)}function o(t){Me(a,function(e){return e===t}).each(function(e){a.splice(e,1)})}function t(t,e){if(void 0===e&&(e=!0),!n.removed&&e0(n))return e&&n.fire("BeforeOpenNotification",{notification:t}),Ie(a,function(e){return!((e=l().getArgs(e)).type!==t.type||e.text!==t.text||e.progressBar||e.timeout||t.progressBar||t.timeout)}).getOrThunk(function(){n.editorManager.setActive(n);var e=l().open(t,function(){o(e),i(),r().fold(function(){return n.focus()},function(e){return q.fromDom(e.getEl()).dom.focus()})});return a.push(e),i(),n.fire("OpenNotification",I({},e)),e})}var s,a=[],l=function(){var e=n.theme;return e&&e.getNotificationManagerImpl?e.getNotificationManagerImpl():{open:e=function(){throw new Error("Theme did not provide a NotificationManager implementation.")},close:e,reposition:e,getArgs:e}};return(s=n).on("SkinLoaded",function(){var e=s.getParam("service_message");e&&t({text:e,type:"warning",timeout:0},!1)}),s.on("ResizeEditor ResizeWindow NodeChange",function(){Ir.requestAnimationFrame(i)}),s.on("remove",function(){ee(a.slice(),function(e){l().close(e)})}),{open:t,close:function(){r().each(function(e){l().close(e),o(e),i()})},getNotifications:function(){return a}}}function n0(n){function r(){var e=n.theme;return e&&e.getWindowManagerImpl?e.getWindowManagerImpl():{open:e=function(){throw new Error("Theme did not provide a WindowManager implementation.")},openUrl:e,alert:e,confirm:e,close:e,getParams:e,setParams:e}}function i(e,t){return function(){return t?t.apply(e,arguments):void 0}}function o(t){n.fire("CloseWindow",{dialog:t}),0===(a=O(a,function(e){return e!==t})).length&&n.focus()}function s(e){n.editorManager.setActive(n),Sh(n);var t,e=e();return t=e,a.push(t),n.fire("OpenWindow",{dialog:t}),e}var a=[];return n.on("remove",function(){ee(a,function(e){r().close(e)})}),{open:function(e,t){return s(function(){return r().open(e,t,o)})},openUrl:function(e){return s(function(){return r().openUrl(e,o)})},alert:function(e,t,n){r().alert(e,i(n||this,t))},confirm:function(e,t,n){r().confirm(e,i(n||this,t))},close:function(){N.from(a[a.length-1]).each(function(e){r().close(e),o(e)})}}}function r0(e,t){e.notificationManager.open({type:"error",text:t})}function i0(e,t){e._skinLoaded?r0(e,t):e.on("SkinLoaded",function(){r0(e,t)})}function o0(e,t,n){e.fire(t,{message:n}),console.error(n)}function s0(e,t,n){return n?"Failed to load "+e+": "+n+" from url "+t:"Failed to load "+e+" url: "+t}function a0(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=window.console;r&&(r.error||r.log).apply(r,Ye([e],t))}var l0=Aa.PluginManager,u0=Aa.ThemeManager,c0=function(e,t,n){o0(e,"PluginLoadError",s0("plugin",t,n))};function d0(a,l){function i(e,n,r,t){var i=new XMLHttpRequest,o=(i.open("POST",l.url),i.withCredentials=l.credentials,i.upload.onprogress=function(e){t(e.loaded/e.total*100)},i.onerror=function(){r("Image upload failed due to a XHR Transport error. Code: "+i.status)},i.onload=function(){var e,t;i.status<200||300<=i.status?r("HTTP Error: "+i.status):(t=JSON.parse(i.responseText))&&"string"==typeof t.location?n((e=l.basePath,t=t.location,e?e.replace(/\/$/,"")+"/"+t.replace(/^\//,""):t)):r("Invalid JSON: "+i.responseText)},new FormData);o.append("file",e.blob(),e.filename()),i.send(o)}function u(e,t){return{url:t,blobInfo:e,status:!0}}function c(e,t,n){return{url:"",blobInfo:e,status:!1,error:{message:t,options:n}}}function d(e,t){te.each(h[e],function(e){e(t)}),delete h[e]}var h={};return!1===Se(l.handler)&&(l.handler=i),{upload:function(e,t){return l.url||l.handler!==i?(n=e,r=t,n=te.grep(e,function(e){return!a.isUploaded(e.blobUri())}),Er.all(te.map(n,function(e){return a.isPending(e.blobUri())?(t=e.blobUri(),new Er(function(e){h[t]=h[t]||[],h[t].push(e)})):(i=e,o=l.handler,s=r,a.markPending(i.blobUri()),new Er(function(n){var t;try{var r=function(){t&&t.close()};o(i,function(e){r(),a.markUploaded(i.blobUri(),e),d(i.blobUri(),u(i,e)),n(u(i,e))},function(e,t){t=t||{};r(),a.removeFailed(i.blobUri()),d(i.blobUri(),c(i,e,t)),n(c(i,e,t))},function(e){e<0||100<e||(t=t||s()).progressBar.value(e)})}catch(e){n(c(i,e.message,{}))}}));var i,o,s,t}))):new Er(function(e){e([])});var n,r}}}function h0(e){return e+p0+++(e=function(){return Math.round(4294967295*Math.random()).toString(36)},"s"+(new Date).getTime().toString(36)+e()+e()+e())}function f0(s){function i(e,t,n){for(var r=0;-1!==(r=e.indexOf(t,r))&&(e=e.substring(0,r)+n+e.substr(r+t.length),r+=n.length-t.length+1),-1!==r;);return e}function t(t){return u=u||d0(y,{url:s.getParam("images_upload_url","","string"),basePath:s.getParam("images_upload_base_path","","string"),credentials:s.getParam("images_upload_credentials",!1,"boolean"),handler:s.getParam("images_upload_handler",null,"function")}),A().then(E(function(o){var e=x(o,function(e){return e.blobInfo});return u.upload(e,S).then(E(function(e){var i=[],e=x(e,function(e,t){var n,r=o[t].blobInfo,t=o[t].image;return e.status&&s.getParam("images_replace_blob_uris",!0,"boolean")?(m.removeByUri(t.src),T(t,e.url)):e.error&&(e.error.options.remove&&(w(t.getAttribute("src"),K.transparentSrc),i.push(t)),n=e.error.message,i0(s,na.translate(["Failed to upload image: {0}",n]))),{element:t,status:e.status,uploadUri:e.url,blobInfo:r}});return 0<e.length&&b.fireIfChanged(),0<i.length&&(ig(s)?console.error("Removing images on failed uploads is currently unsupported for RTC"):s.undoManager.transact(function(){ee(i,function(e){s.dom.remove(e),m.removeByUri(e.src)})})),t&&t(e),e}))}))}function e(t){return!1!==$(v,function(e){return e(t)})&&(0!==t.getAttribute("src").indexOf("data:")||s.getParam("images_dataimg_filter",fe,"function")(t))}function n(e){return e.replace(/src="(blob:[^"]+)"/g,function(e,n){var t=y.getResultUri(n);return t?'src="'+t+'"':(t=(t=m.getByUri(n))||W(s.editorManager.get(),function(e,t){return e||t.editorUpload&&t.editorUpload.blobCache.getByUri(n)},null))?'src="data:'+t.blob().type+";base64,"+t.base64()+'"':e})}r=[],o=function(e){var t,n,r;if(e.blob&&e.base64)return t=e.id||h0("blobid"),n=e.name||t,r=e.blob,{id:_(t),name:_(n),filename:_(e.filename||n+"."+({"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"}[r.type.toLowerCase()]||"dat")),blob:_(r),base64:_(e.base64),blobUri:_(e.blobUri||URL.createObjectURL(r)),uri:_(e.uri)};throw new Error("blob and base64 representations of the image are required for BlobInfo to be created")};var r,o,a,l,u,c,d,h,f,p,g,m={create:function(e,t,n,r,i){if(ge(e))return o({id:e,name:r,filename:i,blob:t,base64:n});if(me(e))return o(e);throw new Error("Unknown input type")},add:function(e){l(e.id())||r.push(e)},get:l=function(t){return a(function(e){return e.id()===t})},getByUri:function(t){return a(function(e){return e.blobUri()===t})},getByData:function(t,n){return a(function(e){return e.base64()===t&&e.blob().type===n})},findFirst:a=function(e){return Ie(r,e).getOrUndefined()},removeByUri:function(t){r=O(r,function(e){return e.blobUri()!==t||(URL.revokeObjectURL(e.blobUri()),!1)})},destroy:function(){ee(r,function(e){URL.revokeObjectURL(e.blobUri())}),r=[]}},y=(d={},h=function(e,t){return{status:e,resultUri:t}},{hasBlobUri:f=function(e){return e in d},getResultUri:function(e){e=d[e];return e?e.resultUri:null},isPending:function(e){return!!f(e)&&1===d[e].status},isUploaded:function(e){return!!f(e)&&2===d[e].status},markPending:function(e){d[e]=h(1,null)},markUploaded:function(e,t){d[e]=h(2,t)},removeFailed:function(e){delete d[e]},destroy:function(){d={}}}),v=[],b=(p=s,g=P(null),p.on("change AddUndo",function(e){g.set(I({},e.level))}),{fireIfChanged:function(){var t=p.undoManager.data;Pe(t).filter(function(e){return!rm(g.get(),e)}).each(function(e){p.setDirty(!0),p.fire("change",{level:e,lastLevel:z(t,t.length-2).getOrNull()})})}}),E=function(t){return function(e){return s.selection?t(e):[]}},C=function(e,t,n){var r='src="'+n+'"'+(n===K.transparentSrc?' data-mce-placeholder="1"':"");return e=i(e,'src="'+t+'"',r),i(e,'data-mce-src="'+t+'"','data-mce-src="'+n+'"')},w=function(t,n){ee(s.undoManager.data,function(e){"fragmented"===e.type?e.fragments=x(e.fragments,function(e){return C(e,t,n)}):e.content=C(e.content,t,n)})},S=function(){return s.notificationManager.open({text:s.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0})},T=function(e,t){var n=s.convertURL(t,"src");w(e.src,t),s.$(e).attr({src:s.getParam("images_reuse_filename",!1,"boolean")?t+(-1===t.indexOf("?")?"?":"&")+(new Date).getTime():t,"data-mce-src":n})},R=function(e){if(ml(s))return t(e)},A=function(){return(c=c||pm(y,m)).findAll(s.getBody(),e).then(E(function(e){return e=O(e,function(e){return"string"!=typeof e||(i0(s,e),!1)}),ee(e,function(e){w(e.image.src,e.blobInfo.blobUri()),e.image.src=e.blobInfo.blobUri(),e.image.removeAttribute("data-mce-src")}),e}))};return s.on("SetContent",function(){(ml(s)?R:A)()}),s.on("RawSaveContent",function(e){e.content=n(e.content)}),s.on("GetContent",function(e){e.source_view||"raw"===e.format||"tree"===e.format||(e.content=n(e.content))}),s.on("PostRender",function(){s.parser.addNodeFilter("img",function(e){ee(e,function(e){var t=e.attr("src");m.getByUri(t)||(t=y.getResultUri(t))&&e.attr("src",t)})})}),{blobCache:m,addFilter:function(e){v.push(e)},uploadImages:t,uploadImagesAuto:R,scanForImages:A,destroy:function(){m.destroy(),y.destroy(),c=u=null}}}var p0=0;function g0(e){function n(e,t){e&&("string"!=typeof e?te.each(e,function(e,t){n(t,e)}):(ye(t)||(t=[t]),te.each(t,function(e){void 0===e.deep&&(e.deep=!e.selector),void 0===e.split&&(e.split=!e.selector||e.inline),void 0===e.remove&&e.selector&&!e.inline&&(e.remove="none"),e.selector&&e.inline&&(e.mixed=!0,e.block_expand=!0),"string"==typeof e.classes&&(e.classes=e.classes.split(/\s+/))}),i[e]=t))}var r,t,i={};return n((r=e.dom,t={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},inherit:!1,preview:!1,defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},inherit:!1,defaultBlock:"div",preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all",preserve_attributes:["class","style"]}],forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",defaultBlock:"p",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(e,t,n){return Q(e)&&e.hasAttribute("href")},onformat:function(n,e,t){te.each(t,function(e,t){r.setAttrib(n,t,e)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]},te.each("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/),function(e){t[e]={block:e,remove:"all"}}),t)),n(e.getParam("formats")),{get:function(e){return e?i[e]:i},has:function(e){return $e(i,e)},register:n,unregister:function(e){return e&&i[e]&&delete i[e],i}}}function m0(n,e){var r,i="",t=(t=n.getParam("preview_styles","font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"),ge(t)?t:"");if(""===t)return"";function o(e){return e.replace(/%(\w+)/g,"")}if("string"==typeof e){if(!(e=n.formatter.get(e)))return;e=e[0]}if("preview"in e){var s=We(e,"preview");if(s.is(!1))return"";t=s.getOr(t)}var s=e.block||e.inline||"span",a=(a=(a=e.selector)&&"string"==typeof a?(a=(a=a.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),te.map(a.split(/(?:>|\s+(?![^\[\]]+\]))/),function(e){var e=te.map(e.split(/(?:~\+|~|\+)/),ev),t=e.pop();return e.length&&(t.siblings=e),t}).reverse()):[]).length?(a[0].name||(a[0].name=s),s=e.selector,Jy(a,n)):Jy([s],n),l=Qy.select(s,a)[0]||a.firstChild;return Zy(e.styles,function(e,t){e=o(e);e&&Qy.setStyle(l,t,e)}),Zy(e.attributes,function(e,t){e=o(e);e&&Qy.setAttrib(l,t,e)}),Zy(e.classes,function(e){e=o(e);Qy.hasClass(l,e)||Qy.addClass(l,e)}),n.fire("PreviewFormats"),Qy.setStyles(a,{position:"absolute",left:-65535}),n.getBody().appendChild(a),r=Qy.getStyle(n.getBody(),"fontSize",!0),r=/px$/.test(r)?parseInt(r,10):0,Zy(t.split(" "),function(e){var t=Qy.getStyle(l,e,!0);if(!("background-color"===e&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(t)&&(t=Qy.getStyle(n.getBody(),e,!0),"#ffffff"===Qy.toHex(t).toLowerCase())||"color"===e&&"#000000"===Qy.toHex(t).toLowerCase())){if("font-size"===e&&/em|%$/.test(t)){if(0===r)return;t=parseFloat(t)/(/%$/.test(t)?100:1)*r+"px"}"border"===e&&t&&(i+="padding:0 2px;"),i+=e+":"+t+";"}}),n.fire("AfterPreviewFormats"),Qy.remove(a),i}function y0(i){var o,e=g0(i),s=P(null),t=i;t.addShortcut("meta+b","","Bold"),t.addShortcut("meta+i","","Italic"),t.addShortcut("meta+u","","Underline");for(var n=1;n<=6;n++)t.addShortcut("access+"+n,"",["FormatBlock",!1,"h"+n]);return t.addShortcut("access+7","",["FormatBlock",!1,"p"]),t.addShortcut("access+8","",["FormatBlock",!1,"div"]),t.addShortcut("access+9","",["FormatBlock",!1,"address"]),(o=i).on("mouseup keydown",function(e){var t=o,e=e.keyCode,n=t.selection,r=t.getBody();Vg(t,null,!1),8!==e&&46!==e||!n.isCollapsed()||n.getStart().innerHTML!==Hg||Vg(t,jc(r,n.getStart())),37!==e&&39!==e||Vg(t,jc(r,n.getStart()))}),{get:e.get,has:e.has,register:e.register,unregister:e.unregister,apply:function(e,t,n){C(i).formatter.apply(e,t,n)},remove:function(e,t,n,r){C(i).formatter.remove(e,t,n,r)},toggle:function(e,t,n){C(i).formatter.toggle(e,t,n)},match:function(e,t,n){return e=e,t=t,n=n,C(i).formatter.match(e,t,n)},closest:function(e){return e=e,C(i).formatter.closest(e)},matchAll:function(e,t){return e=e,t=t,C(i).formatter.matchAll(e,t)},matchNode:function(e,t,n,r){return e=e,t=t,n=n,r=r,C(i).formatter.matchNode(e,t,n,r)},canApply:function(e){return e=e,C(i).formatter.canApply(e)},formatChanged:function(e,t,n){return r=s,e=e,t=t,void 0===(n=n)&&(n=!1),C(i).formatter.formatChanged(r,e,t,n);var r},getCssText:w(m0,i)}}function v0(n,r,i){function o(e){im(r,!1,i),r.add({},e)}var s=P(!1);n.on("init",function(){r.add()}),n.on("BeforeExecCommand",function(e){e=e.command.toLowerCase();"undo"!==e&&"redo"!==e&&"mcerepaint"!==e&&(om(r,i),r.beforeChange())}),n.on("ExecCommand",function(e){var t=e.command.toLowerCase();"undo"!==t&&"redo"!==t&&"mcerepaint"!==t&&o(e)}),n.on("ObjectResizeStart cut",function(){r.beforeChange()}),n.on("SaveContent ObjectResized blur",o),n.on("dragend",o),n.on("keyup",function(e){var t=e.keyCode;e.isDefaultPrevented()||((33<=t&&t<=36||37<=t&&t<=40||45===t||e.ctrlKey)&&(o(),n.nodeChanged()),46!==t&&8!==t||n.nodeChanged(),s.get()&&r.typing&&!1===rm(nm(n),r.data[0])&&(!1===n.isDirty()&&(n.setDirty(!0),n.fire("change",{level:r.data[0],lastLevel:null})),n.fire("TypingUndo"),s.set(!1),n.nodeChanged()))}),n.on("keydown",function(e){var t,n=e.keyCode;e.isDefaultPrevented()||(33<=n&&n<=36||37<=n&&n<=40||45===n?r.typing&&o(e):(t=e.ctrlKey&&!e.altKey||e.metaKey,!(n<16||20<n)||224===n||91===n||r.typing||t||(r.beforeChange(),im(r,!0,i),r.add({},e),s.set(!0))))}),n.on("mousedown",function(e){r.typing&&o(e)}),n.on("input",function(e){e.inputType&&("insertReplacementText"===e.inputType||"insertText"===e.inputType&&null===e.data||"insertFromPaste"===e.inputType||"insertFromDrop"===e.inputType)&&o(e)}),n.on("AddUndo Undo Redo ClearUndos",function(e){e.isDefaultPrevented()||n.nodeChanged()})}function b0(s){var e,a=P(N.none()),l=P(0),u=P(0),c={data:[],typing:!1,beforeChange:function(){var e=l,t=a;C(s).undoManager.beforeChange(e,t)},add:function(e,t){return n=c,r=u,i=l,o=a,e=e,t=t,C(s).undoManager.addUndoLevel(n,r,i,o,e,t);var n,r,i,o},undo:function(){return e=c,t=l,n=u,C(s).undoManager.undo(e,t,n);var e,t,n},redo:function(){return e=u,t=c.data,C(s).undoManager.redo(e,t);var e,t},clear:function(){var e=c,t=u;C(s).undoManager.clear(e,t)},reset:function(){var e=c;C(s).undoManager.reset(e)},hasUndo:function(){return e=c,t=u,C(s).undoManager.hasUndo(e,t);var e,t},hasRedo:function(){return e=c,t=u,C(s).undoManager.hasRedo(e,t);var e,t},transact:function(e){return t=c,n=l,e=e,C(s).undoManager.transact(t,n,e);var t,n},ignore:function(e){var t=l;C(s).undoManager.ignore(t,e)},extra:function(e,t){var n=c,r=u;C(s).undoManager.extra(n,r,e,t)}};return ig(s)||v0(s,c,l),(e=s).addShortcut("meta+z","","Undo"),e.addShortcut("meta+y,meta+shift+z","","Redo"),c}function E0(e){return"keydown"===e.type||"keyup"===e.type}function C0(e){return(e=e.keyCode)===H.BACKSPACE||e===H.DELETE}function w0(a){function l(e,t){var n,r,i,o,s;!function(e){var t;if(E0(e))return t=e.keyCode,!C0(e)&&(H.metaKeyPressed(e)||e.altKey||112<=t&&t<=123||xe(tv,t))}(e)&&(n=a.getBody(),r=!(E0(e=e)&&!(C0(e)||"keyup"===e.type&&229===e.keyCode)||(e=u,r=n,i=c,!$r(q.fromDom(r),!1))||(o=""===i,(s=r.firstElementChild)&&(e.getStyle(r.firstElementChild,"padding-left")||e.getStyle(r.firstElementChild,"padding-right")||(o?e.isBlock(s):i!==s.nodeName.toLowerCase())))),""!==u.getAttrib(n,nv)==r&&!t||(u.setAttrib(n,nv,r?d:null),u.setAttrib(n,"aria-placeholder",r?d:null),a.fire("PlaceholderToggle",{state:r}),a.on(r?"keydown":"keyup",l),a.off(r?"keyup":"keydown",l)))}var u=a.dom,c=eu(a),d=a.getParam("placeholder",Jl.getAttrib(a.getElement(),"placeholder"),"string");d&&a.on("init",function(e){l(e,!0),a.on("change SetContent ExecCommand",l),a.on("paste",function(e){return Ir.setEditorTimeout(a,function(){return l(e)})})})}function S0(e,t){var n,r;return t&&(n=t.container(),r=t.offset(),e?hi(n)?A(n.nextSibling)?F(n.nextSibling,0):F.after(n):gi(t)?F(n,r+1):t:hi(n)?A(n.previousSibling)?F(n.previousSibling,n.previousSibling.data.length):F.before(n):mi(t)?F(n,r-1):t)}function T0(e,t){return fn(e,t)?vr(t,function(e){return Qr(e)||ei(e)},(n=e,function(e){return M(n,q.fromDom(e.dom.parentNode))})):N.none();var n}function R0(e){var t;e.dom.isEmpty(e.getBody())&&(e.setContent(""),t=(t=(e=e).getBody()).firstChild&&e.dom.isBlock(t.firstChild)?t.firstChild:t,e.selection.setCursorLocation(t,0))}function A0(e,t){return{from:e,to:t}}function _0(e,t){var e=q.fromDom(e),n=q.fromDom(t.container());return T0(e,n).map(function(e){return{block:e,position:t}})}function N0(e){t=Sn(e);var t,e=Me(t,qr).fold(function(){return t},function(e){return t.slice(0,e)});return ee(e,Dn),e}function x0(e,t){t=_g(t,e),Ie(t.reverse(),function(e){return $r(e)}).each(Dn)}function O0(e,t,n,r){return $r(n)?(Rg(n),Uc(n.dom)):(0===O(pt(r),function(e){return!$r(e)}).length&&$r(t)&&On(r,q.fromTag("br")),n=Hc(n.dom,F.before(r.dom)),ee(N0(t),function(e){On(r,e)}),x0(e,t),n)}function I0(e,t,n){var r;return $r(n)?(Dn(n),$r(t)&&Rg(t),Uc(t.dom)):(r=Vc(n.dom),ee(N0(t),function(e){kn(n,e)}),x0(e,t),r)}function M0(e,t){Du(e,t.dom).map(function(e){return e.getNode()}).map(q.fromDom).filter(Zr).each(Dn)}function k0(e,t,n){return M0(!0,t),M0(!1,n),(fn(i=n,r=t)?(r=_g(r,i),N.from(r[r.length-1])):N.none()).fold(w(I0,e,t,n),w(O0,e,t,n));var r,i}function D0(e,t,n,r){return t?k0(e,r,n):k0(e,n,r)}function L0(t,n){var i,o,e,r,s=q.fromDom(t.getBody()),a=(a=s.dom,e=n,((r=t.selection.getRng()).collapsed?(o=e,e=r,e=_0(i=a,F.fromRangeStart(e)),r=e.bind(function(e){return Mu(o,i,e.position).bind(function(e){return _0(i,e).map(function(e){return t=i,n=o,k((r=e).position.getNode())&&!1===$r(r.block)?Du(!1,r.block.dom).bind(function(e){return e.isEqual(r.position)?Mu(n,t,e).bind(function(e){return _0(t,e)}):N.some(r)}).getOr(r):r;var t,n,r})})}),Fa(e,r,A0).filter(function(e){return!1===M(e.from.block,e.to.block)&&bn((n=e).from.block).bind(function(t){return bn(n.to.block).filter(function(e){return M(t,e)})}).isSome()&&!1===D((e=e).from.block.dom)&&!1===D(e.to.block.dom);var n})):N.none()).bind(function(e){return D0(s,n,e.from.block,e.to.block)}));return a.each(function(e){t.selection.setRng(e.toRange())}),a.isSome()}function P0(e,t){return t=q.fromDom(t),e=w(M,e),dr(t,ni,e).isSome()}function F0(e){var n,r,i,t,o,s,a=q.fromDom(e.getBody()),l=e.selection.getRng();return l=l,o=Hc((t=a).dom,F.fromRangeStart(l)).isNone(),s=Bc(t.dom,F.fromRangeEnd(l)).isNone(),P0(t=t,(l=l).startContainer)||P0(t,l.endContainer)||!o||!s?(n=a,r=e.selection,i=r.getRng(),Fa(T0(n,q.fromDom(i.startContainer)),T0(n,q.fromDom(i.endContainer)),function(e,t){return!1===M(e,t)&&(i.deleteContents(),D0(n,!0,e,t).each(function(e){r.setRng(e.toRange())}),!0)}).getOr(!1)):((t=e).setContent(""),t.selection.setCursorLocation(),!0)}function B0(e,t){return!e.selection.isCollapsed()&&F0(e)}function H0(e,t,n,r,i){return N.from(t._selectionOverrides.showCaret(e,n,r,i))}function U0(e,t){return e.fire("BeforeObjectSelected",{target:t}).isDefaultPrevented()?N.none():N.some(((t=(e=t).ownerDocument.createRange()).selectNode(e),t))}function V0(e,t,n){var t=Fl(1,e.getBody(),t),r=(t=F.fromRangeStart(t)).getNode();return Ol(r)?H0(1,e,r,!t.isAtEnd(),!1):(r=t.getNode(!0),Ol(r)?H0(1,e,r,!1,!1):(r=e.dom.getParent(t.getNode(),function(e){return cv(e)||uv(e)}),Ol(r)?H0(1,e,r,!1,n):N.none()))}function W0(e,t,n){return t.collapsed?V0(e,t,n).getOr(t):t}function $0(e){return Sg(e)||bg(e)}function j0(e){return Tg(e)||Eg(e)}function z0(n,r,e,t,i,o){return H0(t,n,o.getNode(!i),i,!0).each(function(e){var t;(r.collapsed?(t=r.cloneRange(),i?t.setEnd(e.startContainer,e.startOffset):t.setStart(e.endContainer,e.endOffset),t):r).deleteContents(),n.selection.setRng(e)}),t=n.dom,A(o=e)&&0===o.data.length&&t.remove(o),!0}function G0(e,t){var n,r,i,o,s,a=e.selection.getRng();return!(!A(a.commonAncestorContainer)||(n=t?Wl.Forwards:Wl.Backwards,s=Nu(e.getBody()),s=w(Ul,t?s.next:s.prev),r=t?$0:j0,i=Hl(n,e.getBody(),a),!(o=S0(t,s(i))))||!Vl(i,o))&&(r(o)?z0(e,a,i.getNode(),n,t,o):!!((s=s(o))&&r(s)&&Vl(o,s))&&z0(e,a,i.getNode(),n,t,s))}function Y0(u,c,d){return Mu(c,u,d).bind(function(e){return l=e.getNode(),ni(q.fromDom(l))||ei(q.fromDom(l))||(r=u,s=e,a=function(e){return Fr(q.fromDom(e))&&!kl(o,s,r)},Bl(!(i=c),o=d).fold(function(){return Bl(i,s).fold(m,a)},a))?N.none():c&&D(e.getNode())||!1===c&&D(e.getNode(!0))?(l=u,t=d,n=e.getNode(!1===c),T0(q.fromDom(l),q.fromDom(t.getNode())).map(function(e){return $r(e)?dv.remove(e.dom):dv.moveToElement(n)}).orThunk(function(){return N.some(dv.moveToElement(n))})):c&&Tg(d)||!1===c&&Sg(d)?N.some(dv.moveToPosition(e)):N.none();var t,n,r,i,o,s,a,l})}function X0(e,t){return N.from(sd(e.getBody(),t))}function K0(a,l){var e=a.selection.getNode();return X0(a,e).filter(D).fold(function(){return t=a.getBody(),n=l,o=a.selection.getRng(),o=Fl(n?1:-1,t,o),o=F.fromRangeStart(o),s=q.fromDom(t),(!1===n&&Tg(o)?N.some(dv.remove(o.getNode(!0))):n&&Sg(o)?N.some(dv.remove(o.getNode())):!1===n&&Sg(o)&&sf(s,o)?Mg(s,o).map(function(e){return dv.remove(e.getNode())}):n&&Tg(o)&&of(s,o)?kg(s,o).map(function(e){return dv.remove(e.getNode())}):(r=t,e=n,t=(i=o).getNode(!1===(s=e)),s=s?"after":"before",Q(t)&&t.getAttribute("data-mce-caret")===s?(s=i.getNode(!1===(t=e)),(t&&D(s.nextSibling)?N.some(dv.moveToElement(s.nextSibling)):!1===t&&D(s.previousSibling)?N.some(dv.moveToElement(s.previousSibling)):N.none()).fold(function(){return Y0(r,e,i)},N.some)):Y0(r,e,i).bind(function(e){return t=r,n=i,e.fold(function(e){return N.some(dv.remove(e))},function(e){return N.some(dv.moveToElement(e))},function(e){return kl(n,e,t)?N.none():N.some(dv.moveToPosition(e))});var t,n}))).exists(function(e){return e.fold(function(e){return i._selectionOverrides.hideFakeCaret(),xf(i,o,q.fromDom(e)),!0},(r=o=l,function(e){e=r?F.before(e):F.after(e);return n.selection.setRng(e.toRange()),!0}),(t=n=i=a,function(e){return t.selection.setRng(e.toRange()),!0}));var t,n,r,i,o});var r,e,i,t,n,o,s},fe)}function q0(t,n){var e=t.selection.getNode();return!!D(e)&&X0(t,e.parentNode).filter(D).fold(function(){var e=q.fromDom(t.getBody());return ee(la(e,".mce-offscreen-selection"),Dn),xf(t,n,q.fromDom(t.selection.getNode())),R0(t),!0},function(){return!0})}function Z0(e){var t,n=e.dom,r=e.selection,e=sd(e.getBody(),r.getNode());return zn(e)&&n.isBlock(e)&&n.isEmpty(e)&&(t=n.create("br",{"data-mce-bogus":"1"}),n.setHTML(e,""),e.appendChild(t),r.setRng(F.before(t).toRange())),!0}function Q0(e,t){return(e.selection.isCollapsed()?K0:q0)(e,t)}function J0(e,t){return!!e.selection.isCollapsed()&&(n=e,r=t,e=F.fromRangeStart(n.selection.getRng()),Mu(r,n.getBody(),e).filter(function(e){return(r?yg:vg)(e)}).bind(function(e){return N.from(Dl(r?0:-1,e))}).exists(function(e){return n.selection.select(e),!0}));var n,r}function e1(e){return hv(e)&&e.data[0]===si}function t1(e){return hv(e)&&e.data[e.data.length-1]===si}function n1(e){return e.ownerDocument.createTextNode(si)}function r1(e,t){return(e?function(e){var t;return hv(e.previousSibling)?(t1(e.previousSibling)||e.previousSibling.appendData(si),e.previousSibling):hv(e)?(e1(e)||e.insertData(0,si),e):(t=n1(e),e.parentNode.insertBefore(t,e),t)}:function(e){var t;return hv(e.nextSibling)?(e1(e.nextSibling)||e.nextSibling.insertData(0,si),e.nextSibling):hv(e)?(t1(e)||e.appendData(si),e):(t=n1(e),e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t),t)})(t)}function i1(e,t){return A(e.container())?r1(t,e.container()):r1(t,e.getNode())}function o1(e,t){return(t=t.get())&&e.container()===t&&hi(t)}function s1(t,e){return e.fold(function(e){Al(t.get());e=fv(e);return t.set(e),N.some(F(e,e.length-1))},function(e){return Uc(e).map(function(e){if(o1(e,t))return F(t.get(),1);Al(t.get());e=i1(e,!0);return t.set(e),F(e,1)})},function(e){return Vc(e).map(function(e){if(o1(e,t))return F(t.get(),t.get().length-1);Al(t.get());e=i1(e,!1);return t.set(e),F(e,e.length-1)})},function(e){Al(t.get());e=pv(e);return t.set(e),N.some(F(e,1))})}function a1(e,t){return Cu(t,e)||e}function l1(e,t){return null===jc(e,t)}function u1(e,t,n){return sv(e,t,n).filter(w(l1,t))}function c1(e){return e.fold(mv.before,mv.before,mv.after,mv.after)}function d1(e){return e.fold(mv.start,mv.start,mv.end,mv.end)}function h1(o,e,s,t,n,a){return Fa(sv(e,s,t),sv(e,s,n),function(e,t){return e!==t&&(i=t,r=Cu(e,n=s),i=Cu(i,n),r)&&r===i?mv.after(o?e:t):a;var n,r,i}).getOr(a)}function f1(e,n){return e.fold(fe,function(e){return t=n,!(Tv(e=e)===Tv(t)&&Sv(e)===Sv(t));var t})}function p1(e,t){return e?t.fold(u(N.some,mv.start),N.none,u(N.some,mv.after),N.none):t.fold(N.none,u(N.some,mv.before),N.none,u(N.some,mv.end))}function g1(e,s,a,l){var t=S0(e,l),u=wv(s,a,t);return wv(s,a,t).bind(w(p1,e)).orThunk(function(){return n=s,r=a,i=u,o=S0(t=e,l),Mu(t,r,o).map(w(S0,t)).fold(function(){return i.map(c1)},function(e){return wv(n,r,e).map(w(h1,t,n,r,o,e)).filter(w(f1,i))}).filter(Cv);var t,n,r,i,o})}function m1(e,t){var n=e.dom.createRng();n.setStart(t.container(),t.offset()),n.setEnd(t.container(),t.offset()),e.selection.setRng(n)}function y1(e,t){e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")}function v1(t,e,n){return s1(e,n).map(function(e){return m1(t,e),n})}function b1(e,t,n){return!!wl(e)&&(i=t,t=n,n=(r=e).getBody(),e=F.fromRangeStart(r.selection.getRng()),o=w(iv,r),g1(t,o,n,e).bind(function(e){return v1(r,i,e)}).isSome());var r,i,o}function E1(e,t,n){return!!wl(t)&&(e=e,r=(t=t).selection.getRng(),r=e?F.fromRangeEnd(r):F.fromRangeStart(r),!!Se(t.selection.getSel().modify))&&(e&&gi(r)?Rv(!0,t.selection,r):!(e||!mi(r))&&Rv(!1,t.selection,r));var r}function C1(l){var u=P(null),c=w(iv,l);return l.on("NodeChange",function(e){var n,r,i,t,o,s,a;!wl(l)||K.browser.isIE()&&e.initial||(o=c,s=l.dom,t=e.parents,s=x(la(q.fromDom(s.getRoot()),'*[data-mce-selected="inline-boundary"]'),function(e){return e.dom}),s=O(s,o),t=O(t,o),ee(j(s,t),w(y1,!1)),ee(j(t,s),w(y1,!0)),o=u,(t=l).selection.isCollapsed()&&!0!==t.composing&&o.get()&&(s=F.fromRangeStart(t.selection.getRng()),F.isTextPosition(s))&&!1===(gi(a=s)||mi(a))&&(m1(t,Rl(o.get(),s)),o.set(null)),n=c,r=l,i=u,a=e.parents,r.selection.isCollapsed()&&(t=O(a,n),ee(t,function(e){var t=F.fromRangeStart(r.selection.getRng());wv(n,r.getBody(),t).bind(function(e){return v1(r,i,e)})})))}),u}function w1(t,n){return function(e){return s1(n,e).exists(function(e){return m1(t,e),!0})}}function S1(r,i,o,s){var a=r.getBody(),l=w(iv,r);r.undoManager.ignore(function(){var e,t,n;r.selection.setRng((e=o,t=s,(n=document.createRange()).setStart(e.container(),e.offset()),n.setEnd(t.container(),t.offset()),n)),r.execCommand("Delete"),wv(l,a,F.fromRangeStart(r.selection.getRng())).map(d1).map(w1(r,i))}),r.nodeChanged()}function T1(e,t,n){var r,i,o,s,a,l,u,c;return!(!e.selection.isCollapsed()||!wl(e))&&(r=F.fromRangeStart(e.selection.getRng()),o=t,s=n,a=r,t=(i=e).getBody(),n=a.container(),l=Cu(n,t)||t,u=w(iv,i),(c=wv(u,l,a)).bind(function(e){return s?e.fold(_(N.some(d1(e))),N.none,_(N.some(c1(e))),N.none):e.fold(N.none,_(N.some(c1(e))),N.none,_(N.some(d1(e))))}).map(w1(i,o)).getOrThunk(function(){var t=ku(s,l,a),e=t.bind(function(e){return wv(u,l,e)});return Fa(c,e,function(){return sv(u,l,a).exists(function(e){return!!Fa(Uc(r=e),Vc(r),function(e,t){var e=S0(!0,e),n=S0(!1,t);return Bc(r,e).forall(function(e){return e.isEqual(n)})}).getOr(!0)&&(xf(i,s,q.fromDom(e)),!0);var r})}).orThunk(function(){return e.bind(function(e){return t.map(function(e){return s?S1(i,o,a,e):S1(i,o,e,a),!0})})}).getOr(!1)}))}function R1(e){return 1===Sn(e).length}function A1(l,u){var t,e=q.fromDom(l.getBody()),n=q.fromDom(l.selection.getStart()),c=O((t=_g(n,e),Me(t,qr).fold(_(t),function(e){return t.slice(0,e)})),R1);return Pe(c).exists(function(e){var t,n,r,i=F.fromRangeStart(l.selection.getRng()),o=u,s=i,a=e.dom;return!(!Fa(Uc(a),Vc(a),function(e,t){var n=S0(!0,e),r=S0(!1,t),e=S0(!1,s);return o?Bc(a,e).exists(function(e){return e.isEqual(r)&&s.isEqual(n)}):Hc(a,e).exists(function(e){return e.isEqual(n)&&s.isEqual(r)})}).getOr(!0)||$c((i=e).dom)&&up(i.dom)||(i=u,e=e,n=c,r=w(mp,t=l),0===(n=x(O(n,r),function(e){return e.dom})).length?xf(t,i,e):(r=e.dom,i=n,e=dp(!1),n=pp(i,e.dom),On(q.fromDom(r),e),Dn(q.fromDom(r)),i=F(n,0),t.selection.setRng(i.toRange())),0))})}function _1(e,t){return!!e.selection.isCollapsed()&&A1(e,t)}function N1(e,t,n){return e._selectionOverrides.hideFakeCaret(),xf(e,t,q.fromDom(n)),!0}function x1(e,t){return e.selection.isCollapsed()?(n=e,i=(r=t)?bg:Eg,o=r?Wl.Forwards:Wl.Backwards,s=Hl(o,n.getBody(),n.selection.getRng()),i(s)?N1(n,r,s.getNode(!r)):N.from(S0(r,s)).filter(function(e){return i(e)&&Vl(s,e)}).exists(function(e){return N1(n,r,e.getNode(!r))})):(o=t,e=(t=e).selection.getNode(),!!Gn(e)&&N1(t,o,e));var n,r,i,o,s}function O1(e){return e=parseInt(e,10),isNaN(e)?0:e}function I1(e,t){return(e||"table"===Z(t)?"margin":"padding")+("rtl"===qn(t,"direction")?"-right":"-left")}function M1(e){var n,t=k1(e);return!e.mode.isReadOnly()&&(1<t.length||(n=e,$(t,function(e){var t=I1(El(n),e),t=Qn(e,t).map(O1).getOr(0);return"false"!==n.dom.getContentEditable(e.dom)&&0<t})))}function k1(e){return O(x(e.selection.getSelectedBlocks(),q.fromDom),function(e){return!Nv(e)&&!bn(e).map(Nv).getOr(!1)&&vr(e,function(e){return zn(e.dom)||D(e.dom)}).exists(function(e){return zn(e.dom)})})}function D1(e,a){var l=e.dom,t=e.selection,n=e.formatter,r=e.getParam("indentation","40px","string"),u=/[a-z%]+$/i.exec(r)[0],c=parseInt(r,10),d=El(e),r=eu(e);e.queryCommandState("InsertUnorderedList")||e.queryCommandState("InsertOrderedList")||""!==r||l.getParent(t.getNode(),l.isBlock)||n.apply("div"),ee(k1(e),function(e){var t,n=l,r=a,i=c,o=u,e=e.dom,s=I1(d,q.fromDom(e));"outdent"===r?(t=Math.max(0,O1(e.style[s])-i),n.setStyle(e,s,t?t+o:"")):(t=O1(e.style[s])+i+o,n.setStyle(e,s,t))})}function L1(e,t){if(e.selection.isCollapsed()&&M1(e)){var n=e.dom,r=e.selection.getRng(),i=F.fromRangeStart(r),r=n.getParent(r.startContainer,n.isBlock);if(null!==r&&Ng(q.fromDom(r),i))return D1(e,"outdent"),!0}return!1}function P1(e,t){e.getDoc().execCommand(t,!1,null)}function F1(e){return void 0===e.touches||1!==e.touches.length?N.none():N.some(e.touches[0])}function B1(e,t){return e.hasOwnProperty(t.nodeName)}function H1(e){var t,n,r,i=e.dom,o=e.selection,s=(p=e.schema).getBlockElements(),a=o.getStart(),l=e.getBody(),u=eu(e);if(a&&Q(a)&&u){var c=l.nodeName.toLowerCase();if(p.isValidChild(c,u.toLowerCase())&&(d=s,p=l,c=a,!Oe(Ag(q.fromDom(c),q.fromDom(p)),function(e){return B1(d,e.dom)}))){for(var d,h,f,c=o.getRng(),p=c.startContainer,g=c.startOffset,m=c.endContainer,y=c.endOffset,v=zd(e),a=l.firstChild;a;)if(h=s,A(f=a)||Q(f)&&!B1(h,f)&&!Gc(f)){if(function(e,t){if(A(t)){if(0===t.nodeValue.length)return 1;if(/^\s+$/.test(t.nodeValue)&&(!t.nextSibling||B1(e,t.nextSibling)))return 1}}(s,a)){a=(n=a).nextSibling,i.remove(n);continue}t||(t=i.create(u,gl(e)),a.parentNode.insertBefore(t,a),r=!0),a=(n=a).nextSibling,t.appendChild(n)}else t=null,a=a.nextSibling;r&&v&&(c.setStart(p,g),c.setEnd(m,y),o.setRng(c),e.nodeChanged())}}}function U1(e,t){t.hasAttribute("data-mce-caret")&&(yi(t),e.selection.setRng(e.selection.getRng()),e.selection.scrollIntoView(t))}function V1(e,t){var n=fr(q.fromDom(e.getBody()),"*[data-mce-caret]").fold(_(null),function(e){return e.dom});if(n)return"compositionstart"===t.type?(t.preventDefault(),t.stopPropagation(),void U1(e,n)):void(pi(n)&&(U1(e,n),e.undoManager.add()))}function W1(e,t){return e===Wl.Backwards?De(t):t}function $1(e,t,n,r){for(var i,o,s,a=Nu(n),l=r,u=[];l&&(i=a,o=l,i=t===Wl.Forwards?i.next(o):i.prev(o));){if(k(i.getNode(!1)))return t===Wl.Forwards?{positions:W1(t,u).concat([i]),breakType:Ky.Br,breakAt:N.some(i)}:{positions:W1(t,u),breakType:Ky.Br,breakAt:N.some(i)};if(i.isVisible()){if(e(l,i))return o=l,s=k((s=i).getNode(t===Wl.Forwards))?Ky.Br:!1===kl(o,s)?Ky.Block:Ky.Wrap,{positions:W1(t,u),breakType:s,breakAt:N.some(i)};u.push(i)}l=i}return{positions:W1(t,u),breakType:Ky.Eol,breakAt:N.none()}}function j1(n,r,i,e){return r(i,e).breakAt.map(function(e){var t=r(i,e).positions;return n===Wl.Backwards?t.concat(e):[e].concat(t)}).getOr([])}function z1(e,i){return W(e,function(e,r){return e.fold(function(){return N.some(r)},function(n){return Fa(Le(n.getClientRects()),Le(r.getClientRects()),function(e,t){e=Math.abs(i-e.left);return Math.abs(i-t.left)<=e?r:n}).or(e)})},N.none())}function G1(t,e){return Le(e.getClientRects()).bind(function(e){return z1(t,e.left)})}function Y1(e){return ke(e,kv)}function X1(i,o,s,e,a,t){function n(e){var t,n,r=Y1([e]);for(-1===i&&(r=r.reverse()),t=0;t<r.length;t++)if(n=r[t],!s(n,c)){if(0<u.length&&o(n,de(u))&&l++,n.line=l,a(n))return!0;u.push(n)}}var l=0,u=[],c=de(t.getClientRects());return c&&(n(t=t.getNode()),function(e,t,n,r){for(;r=Ml(r,e,Wr,t);)if(n(r))return}(i,e,n,t)),u}function K1(t){return function(e){return e.line>t}}function q1(t){return function(e){return e.line===t}}function Z1(e,t){return Math.abs(e.left-t)}function Q1(e,t){return Math.abs(e.right-t)}function J1(e,t){return e>=t.left&&e<=t.right}function ey(e,t){return e>=t.top&&e<=t.bottom}function ty(e,i){return ue(e,function(e,t){var n=Math.min(Z1(e,i),Q1(e,i)),r=Math.min(Z1(t,i),Q1(t,i));return J1(i,t)||!J1(i,e)&&(r===n&&Pv(t.node)||r<n)?t:e})}function ny(e,t,n,r,i){var o=Fv(r,e,Wr,t,!i);do{if(!o||n(o))return}while(o=Fv(o,e,Wr,t))}function ry(e,t,n){var r,i,o=Y1(O(Fe(e.getElementsByTagName("*")),Il)),o=O(o,w(ey,n));if(n=ty(o,t)){var o=!It(n.node)&&!Gn(n.node);if((n=ty((e=e,r=n,void 0===(o=o)&&(o=!0),(i=[]).push(r),ny(qy.Up,e,w(s,va),r.node,o),ny(qy.Down,e,w(s,ba),r.node,o),i),t))&&Il(n.node))return{node:(e=n).node,before:Z1(e,o=t)<Q1(e,o)}}function s(t,e){return e=O(Y1([e]),function(e){return!t(e,r)}),i=i.concat(e),0===e.length}return null}function iy(e,t){e.selection.setRng(t),mh(e,e.selection.getRng())}function oy(e,t,n){return N.some(W0(e,t,n))}function sy(e,t,n,r,i,o){var s=t===Wl.Forwards,a=Nu(e.getBody()),a=w(Ul,s?a.next:a.prev),r=s?r:i;if(!n.collapsed){i=Ea(n);if(o(i))return H0(t,e,i,t===Wl.Backwards,!1)}var o=Hl(t,e.getBody(),n);return r(o)?U0(e,o.getNode(!s)):(i=S0(s,a(o)),o=di(n.startContainer),i?r(i)?H0(t,e,i.getNode(!s),s,!1):(a=a(i))&&r(a)&&Vl(i,a)?H0(t,e,a.getNode(!s),s,!1):o?oy(e,i.toRange(),!1):N.none():o?N.some(n):N.none())}function ay(t,e,n,r,i,o){var s=Hl(e,t.getBody(),n),a=de(s.getClientRects()),l=e===qy.Down;if(!a)return N.none();var u=(l?Lv:Dv)(t.getBody(),K1(1),s),u=O(u,q1(1)),a=a.left,c=ty(u,a);if(c&&o(c.node))return o=Math.abs(a-c.left),d=Math.abs(a-c.right),H0(e,t,c.node,o<d,!1);if(c=r(s)?s.getNode():i(s)?s.getNode(!0):Ea(n)){var o=function(e,t,n,r){function i(e){return de(e.getClientRects())}var o,s,a,l,t=Nu(t),u=[],c=0,d=1===e?(o=t.next,s=ba,a=va,F.after(r)):(o=t.prev,s=va,a=ba,F.before(r)),h=i(d);do{if(d.isVisible()&&!a(l=i(d),h)){if(0<u.length&&s(l,de(u))&&c++,(l=Ha(l)).position=d,l.line=c,n(l))return u;u.push(l)}}while(d=o(d));return u}(e,t.getBody(),K1(1),c),d=ty(O(o,q1(1)),a);if(d)return oy(t,d.position.toRange(),!1);if(d=de(O(o,q1(0))))return oy(t,d.position.toRange(),!1)}return 0===u.length?ly(t,l).filter(l?i:r).map(function(e){return W0(t,e.toRange(),!1)}):N.none()}function ly(e,t){var n,r,i=e.selection.getRng(),e=e.getBody();return(t?(n=F.fromRangeEnd(i),r=Ov(e,n),Pe):(n=F.fromRangeStart(i),r=xv(e,n),Le))(r.positions)}function uy(t,e,n){return ly(t,e).filter(n).exists(function(e){return t.selection.setRng(e.toRange()),!0})}function cy(e,t,n){var r,i=Nu(e.getBody()),i=w(Ul,1===t?i.next:i.prev);n.collapsed&&""!==eu(e)&&(r=e.dom.getParent(n.startContainer,"PRE"))&&!i(F.fromRangeStart(n))&&(i=e.dom.create(eu(e)),(!K.ie||11<=K.ie)&&(i.innerHTML='<br data-mce-bogus="1">'),n=i,1===t?e.$(r).after(n):e.$(r).before(n),e.selection.select(n,!0),e.selection.collapse())}function dy(t,e){return n=t,r=e?Wl.Forwards:Wl.Backwards,i=n.selection.getRng(),sy(n,r,i,Sg,Tg,Bv).orThunk(function(){return cy(n,r,i),N.none()}).exists(function(e){return iy(t,e),!0});var n,r,i}function hy(t,e){return r=e?1:-1,i=(n=t).selection.getRng(),ay(n,r,i,function(e){return Sg(e)||Cg(e)},function(e){return Tg(e)||wg(e)},Bv).orThunk(function(){return cy(n,r,i),N.none()}).exists(function(e){return iy(t,e),!0});var n,r,i}function fy(e,t){return uy(e,t,t?Tg:Sg)}function py(e){return xe(["figcaption"],Z(e))}function gy(e){var t=document.createRange();return t.setStartBefore(e.dom),t.setEndBefore(e.dom),t}function my(e,t,n){(n?kn:Mn)(e,t)}function yy(a,l){var u=q.fromDom(a.getBody()),c=F.fromRangeStart(a.selection.getRng()),d=eu(a),h=gl(a),e=c,t=w(M,u);return vr(q.fromDom(e.container()),qr,t).filter(py).exists(function(){var e,t,n,r,i,o,s;return i=u,s=c,!!((o=l)?(o=i.dom,Ov(o,s)):(o=i.dom,xv(o,s))).breakAt.isNone()&&(i=u,o=h,s=l,o=""===(e=d)?(t=i,n=s,r=q.fromTag("br"),my(t,r,n),gy(r)):(t=i,n=s,r=o,i=q.fromTag(e),s=q.fromTag("br"),Lt(i,r),kn(i,s),my(t,i,n),gy(s)),a.selection.setRng(o),!0)})}function vy(e,t){return!!e.selection.isCollapsed()&&yy(e,t)}function h(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){return e.apply(null,t)}}function by(e,t){return Ie((n=t,ke(x(e,function(e){return I({shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0,action:Y},e)}),function(e){return n.keyCode===e.keyCode&&n.shiftKey===e.shiftKey&&n.altKey===e.altKey&&n.ctrlKey===e.ctrlKey&&n.metaKey===e.metaKey?[e]:[]})),function(e){return e.action()});var n}function Ey(t,e){var e=e?Wl.Forwards:Wl.Backwards,n=t.selection.getRng();return sy(t,e,n,bg,Eg,Gn).exists(function(e){return iy(t,e),!0})}function Cy(t,e){var e=e?1:-1,n=t.selection.getRng();return ay(t,e,n,bg,Eg,Gn).exists(function(e){return iy(t,e),!0})}function wy(e,t){return uy(e,t,t?Eg:bg)}function Sy(e,t,n,r,i){var o,n=la(q.fromDom(n),"td,th,caption").map(function(e){return e.dom}),e=O((o=e,ke(n,function(e){var t={left:(t=Ha(e.getBoundingClientRect())).left- -1,top:t.top- -1,right:t.right+-2,bottom:t.bottom+-2,width:t.width+-1,height:t.height+-1};return[{x:t.left,y:o(t),cell:e},{x:t.right,y:o(t),cell:e}]})),function(e){return t(e,i)}),s=r,a=i;return W(e,function(e,r){return e.fold(function(){return N.some(r)},function(e){var t=Math.sqrt(Math.abs(e.x-s)+Math.abs(e.y-a)),n=Math.sqrt(Math.abs(r.x-s)+Math.abs(r.y-a));return N.some(n<t?r:e)})},N.none()).map(function(e){return e.cell})}function Ty(e,t,n){var r,i,o=e(t,n);return o.breakType===Ky.Wrap&&0===o.positions.length||!k(n.getNode())&&o.breakType===Ky.Br&&1===o.positions.length?(r=e,i=t,!o.breakAt.exists(function(e){return r(i,e).breakAt.isSome()})):o.breakAt.isNone()}function Ry(t,e,n,r){var i,o,s,a=t.selection.getRng(),l=e?1:-1;return!(!xl()||(i=e,o=n,s=F.fromRangeStart(a),!Du(!i,o).exists(function(e){return e.isEqual(s)}))||(H0(l,t,n,!e,!1).each(function(e){iy(t,e)}),0))}function Ay(a,l,u){var e=function(e,t){t=t.getNode(e);return Q(t)&&"TABLE"===t.nodeName?N.some(t):N.none()}(!!l,u),t=!1===l;e.fold(function(){return iy(a,u.toRange())},function(s){return Du(t,a.getBody()).filter(function(e){return e.isEqual(u)}).fold(function(){return iy(a,u.toRange())},function(e){var n,r,i=l,o=s,t=u;(r=eu(n=a))?n.undoManager.transact(function(){var e=q.fromTag(r),t=(Lt(e,gl(n)),kn(e,q.fromTag("br")),(i?In:On)(q.fromDom(o),e),n.dom.createRng());t.setStart(e.dom,0),t.setEnd(e.dom,0),iy(n,t)}):iy(n,t.toRange())})})}function _y(e,t,n,r){var i,o,s,a,l,u,c,d,h,f,p,g=e.selection.getRng(),g=F.fromRangeStart(g),m=e.getBody();return!t&&Vv(r,g)?(a=m,d=l=n,h=u=g,c=Le(h.getClientRects()).bind(function(e){return Hv(d,e.left,e.top)}).bind(function(e){return G1(Vc(t=e).map(function(e){return xv(t,e).positions.concat(e)}).getOr([]),h);var t}).orThunk(function(){return Le(u.getClientRects()).bind(function(e){return z1(Iv(a,F.before(l)),e.left)})}).getOr(F.before(l)),Ay(e,t,c),!0):!(!t||!Wv(r,g)||(i=m,f=o=n,p=s=g,c=Pe(p.getClientRects()).bind(function(e){return Uv(f,e.left,e.top)}).bind(function(e){return G1(Uc(t=e).map(function(e){return[e].concat(Ov(t,e).positions)}).getOr([]),p);var t}).orThunk(function(){return Le(s.getClientRects()).bind(function(e){return z1(Mv(i,F.after(o)),e.left)})}).getOr(F.after(o)),Ay(e,t,c),0))}function Ny(n,r,i){return N.from(n.dom.getParent(n.selection.getNode(),"td,th")).bind(function(t){return N.from(n.dom.getParent(t,"table")).map(function(e){return i(n,r,e,t)})}).getOr(!1)}function xy(e,t){return Ny(e,t,Ry)}function Oy(e,t){return Ny(e,t,_y)}function Iy(e){return N.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock))}function My(e,t){return e&&e.parentNode&&e.parentNode.nodeName===t}function ky(e){return e&&/^(OL|UL|LI)$/.test(e.nodeName)}function Dy(e){var t=e.parentNode;return/^(LI|DT|DD)$/.test(t.nodeName)?t:e}function Ly(e,t,n){for(var r=e[n?"firstChild":"lastChild"];r&&!Q(r);)r=r[n?"nextSibling":"previousSibling"];return r===t}function Py(s,e){function t(e){var t,n=a,r=f.getTextInlineElements(),i=e||"TABLE"===c||"HR"===c?h.create(e||v):l.cloneNode(!1),o=i;if(!1===s.getParam("keep_styles",!0))h.setAttrib(i,"style",null),h.setAttrib(i,"class",null);else for(;!r[n.nodeName]||$c(n)||Gc(n)||(t=n.cloneNode(!1),h.setAttrib(t,"id",""),i.hasChildNodes()?t.appendChild(i.firstChild):o=t,i.appendChild(t)),(n=n.parentNode)&&n!==E;);return qv(s,i),zv(o),i}function n(e){var t,n,r=Xv(e,a,o);if(!A(a)||!(e?0<r:r<a.nodeValue.length)){if((a.parentNode!==l||!d||e)&&(!e||!Q(a)||a!==l.firstChild)){if(Gv(a,"TABLE")||Gv(a,"HR"))return d&&!e||!d&&e;var i=new J(a,l);for(A(a)&&(e&&0===r?i.prev():e||r!==a.nodeValue.length||i.next());t=i.current();){if(Q(t)){if(!t.getAttribute("data-mce-bogus")&&(n=t.nodeName.toLowerCase(),p[n])&&"br"!==n)return}else if(A(t)&&!_i(t.nodeValue))return;e?i.prev():i.next()}}return 1}}function r(){u=/^(H[1-6]|PRE|FIGURE)$/.test(c)&&"HGROUP"!==y?t(v):t(),s.getParam("end_container_on_empty_block",!1)&&Yv(h,i)&&h.isEmpty(l)?u=h.split(i,l):h.insertAfter(u,l),$v(s,u)}var a,o,l,u,i,c,d,h=s.dom,f=s.schema,p=f.getNonEmptyElements(),g=s.selection.getRng(),m=(Ed(h,g).each(function(e){g.setStart(e.startContainer,e.startOffset),g.setEnd(e.endContainer,e.endOffset)}),a=g.startContainer,o=g.startOffset,v=eu(s),!(!e||!e.shiftKey)),e=!(!e||!e.ctrlKey);Q(a)&&a.hasChildNodes()&&(d=o>a.childNodes.length-1,a=a.childNodes[Math.min(o,a.childNodes.length-1)]||a,o=d&&A(a)?a.nodeValue.length:0);var y,v,b,E=Kv(h,a);if(E)if((v&&!m||!v&&m)&&(a=function(e,t,n,r){var i,o,s,a,l=v||"P",u=e.dom,c=Kv(u,n),d=u.getParent(n,u.isBlock);if(!d||!Yv(u,d)){if(c=((d=d||c)===e.getBody()||(c=d)&&/^(TD|TH|CAPTION)$/.test(c.nodeName)?d:d.parentNode).nodeName.toLowerCase(),!d.hasChildNodes())return i=u.create(l),qv(e,i),d.appendChild(i),t.setStart(i,0),t.setEnd(i,0),i;for(s=n;s.parentNode!==d;)s=s.parentNode;for(;s&&!u.isBlock(s);)s=(o=s).previousSibling;if(o&&e.schema.isValidChild(c,l.toLowerCase())){for(i=u.create(l),qv(e,i),o.parentNode.insertBefore(i,o),s=o;s&&!u.isBlock(s);)a=s.nextSibling,i.appendChild(s),s=a;t.setStart(n,r),t.setEnd(n,r)}}return n}(s,g,a,o)),l=h.getParent(a,h.isBlock),i=l?h.getParent(l.parentNode,h.isBlock):null,c=l?l.nodeName.toUpperCase():"","LI"!==(y=i?i.nodeName.toUpperCase():"")||e||(i=(l=i).parentNode,c=y),/^(LI|DT|DD)$/.test(c)&&h.isEmpty(l))jv(s,t,i,l,v);else if(!v||l!==s.getBody()){if(v=v||"P",di(l))u=yi(l),h.isEmpty(l)&&zv(l),qv(s,u),$v(s,u);else if(n())r();else if(n(!0))u=l.parentNode.insertBefore(t(),l),$v(s,Gv(l,"HR")?u:l);else{(e=(m=g).cloneRange()).setStart(m.startContainer,Xv(!0,m.startContainer,m.startOffset)),e.setEnd(m.endContainer,Xv(!1,m.endContainer,m.endOffset)),(m=e.cloneRange()).setEndAfter(l),e=m.extractContents(),ee(xa(q.fromDom(m=e),gn),function(e){e=e.dom;e.nodeValue=li(e.nodeValue)});for(var C=e;A(C)&&(C.nodeValue=C.nodeValue.replace(/^[\r\n]+/,"")),C=C.firstChild;);u=e.firstChild,h.insertAfter(e,l),function(e,t){var n,r,i=u,o=[];if(i){for(;i=i.firstChild;){if(e.isBlock(i))return;Q(i)&&!t[i.nodeName.toLowerCase()]&&o.push(i)}for(n=o.length;n--;)(!(i=o[n]).hasChildNodes()||i.firstChild===i.lastChild&&""===i.firstChild.nodeValue||(r=i)&&"A"===r.nodeName&&e.isEmpty(r))&&e.remove(i)}}(h,p),m=h,(e=l).normalize(),(b=e.lastChild)&&!/^(left|right)$/gi.test(m.getStyle(b,"float",!0))||m.add(e,"br"),h.isEmpty(l)&&zv(l),u.normalize(),h.isEmpty(u)?(h.remove(u),r()):(qv(s,u),$v(s,u))}h.setAttrib(u,"id",""),s.fire("NewBlock",{newBlock:u})}}function Fy(e,t,n){var r=e.create("span",{},"&nbsp;");n.parentNode.insertBefore(r,n),t.scrollIntoView(r),e.remove(r)}function By(e,t,n,r){e=e.createRng(),r?(e.setStartBefore(n),e.setEndBefore(n)):(e.setStartAfter(n),e.setEndAfter(n)),t.setRng(e)}function Hy(e,t){var n=q.fromTag("br");On(q.fromDom(t),n),e.undoManager.add()}function Uy(e,t){n=e.getBody(),r=t,i=F.after(r),k(i.getNode())||Bc(n,F.after(r)).map(function(e){return k(e.getNode())}).getOr(!1)||In(q.fromDom(t),q.fromTag("br"));var n,r,i=q.fromTag("br");In(q.fromDom(t),i),Fy(e.dom,e.selection,i.dom),By(e.dom,e.selection,i.dom,!1),e.undoManager.add()}function Vy(e){return e&&"A"===e.nodeName&&"href"in e}function Wy(e,t){i=w(iv,n=e),r=F.fromRangeStart(n.selection.getRng());var n,r,i=wv(i,n.getBody(),r).filter(Qv);i.isSome()?i.each(w(Jv,e)):Zv(e,t)}function $y(e,t){return Iy(e).filter(function(e){return 0<t.length&&ut(q.fromDom(e),t)}).isSome()}function jy(e,t){var n,r;n=e,r=t,gv([c2([t2],e2.none()),c2([i2("summary",!0)],e2.br()),c2([o2(!0),s2(!1),l2],e2.br()),c2([o2(!0),s2(!1)],e2.block()),c2([o2(!0),s2(!0),l2],e2.block()),c2([o2(!0),s2(!0)],e2.br()),c2([r2(!0),l2],e2.br()),c2([r2(!0)],e2.block()),c2([n2(!0),l2,u2],e2.block()),c2([n2(!0)],e2.br()),c2([a2],e2.br()),c2([n2(!1),l2],e2.br()),c2([u2],e2.block())],[n,!(!r||!r.shiftKey)]).getOr(e2.none()).fold(function(){Wy(e,t)},function(){Py(e,t)},Y)}function zy(n,r){var e=r.container(),t=r.offset();return A(e)?(e.insertData(t,n),N.some(y(e,t+n.length))):Tu(r).map(function(e){var t=q.fromText(n);return(r.isAtEnd()?In:On)(e,t),y(t.dom,n.length)})}function Gy(i,o){return function(e){return r=i,(!df(e=e)&&(n=e,Hc((t=r).dom,n).isNone()||Bc(t.dom,n).isNone()||Ng(t,n)||xg(t,n)||sf(t,n)||of(t,n)||uf(r,e)||cf(r,e))?h2:f2)(o);var t,n,r}}function Yy(e){var t,n,r,i,o=F.fromRangeStart(e.selection.getRng()),s=q.fromDom(e.getBody());return!!e.selection.isCollapsed()&&(r=w(iv,e),i=F.fromRangeStart(e.selection.getRng()),wv(r,e.getBody(),i).bind((n=s,function(e){return e.fold(function(e){return Hc(n.dom,F.before(e))},function(e){return Uc(e)},function(e){return Vc(e)},function(e){return Bc(n.dom,F.after(e))})})).bind(Gy(s,o)).exists((t=e,function(e){return t.selection.setRng(e.toRange()),t.nodeChanged(),!0})))}function Xy(e){var n,t,r,i,o,s,a,l,u,c,d=C1(e);return e.on("keyup compositionstart",w(V1,e)),c=d,(u=e).on("keydown",function(e){var t,n,r;!1===e.isDefaultPrevented()&&(t=u,n=c,r=e,e=an().os,by([{keyCode:H.RIGHT,action:h(dy,t,!0)},{keyCode:H.LEFT,action:h(dy,t,!1)},{keyCode:H.UP,action:h(hy,t,!1)},{keyCode:H.DOWN,action:h(hy,t,!0)},{keyCode:H.RIGHT,action:h(xy,t,!0)},{keyCode:H.LEFT,action:h(xy,t,!1)},{keyCode:H.UP,action:h(Oy,t,!1)},{keyCode:H.DOWN,action:h(Oy,t,!0)},{keyCode:H.RIGHT,action:h(Ey,t,!0)},{keyCode:H.LEFT,action:h(Ey,t,!1)},{keyCode:H.UP,action:h(Cy,t,!1)},{keyCode:H.DOWN,action:h(Cy,t,!0)},{keyCode:H.RIGHT,action:h(b1,t,n,!0)},{keyCode:H.LEFT,action:h(b1,t,n,!1)},{keyCode:H.RIGHT,ctrlKey:!e.isOSX(),altKey:e.isOSX(),action:h(Av,t,n)},{keyCode:H.LEFT,ctrlKey:!e.isOSX(),altKey:e.isOSX(),action:h(_v,t,n)},{keyCode:H.UP,action:h(vy,t,!1)},{keyCode:H.DOWN,action:h(vy,t,!0)}],r).each(function(e){r.preventDefault()}))}),l=d,(a=e).on("keydown",function(e){var t,n;!1===e.isDefaultPrevented()&&(t=l,n=e,by([{keyCode:H.BACKSPACE,action:h(L1,e=a,!1)},{keyCode:H.BACKSPACE,action:h(Q0,e,!1)},{keyCode:H.DELETE,action:h(Q0,e,!0)},{keyCode:H.BACKSPACE,action:h(G0,e,!1)},{keyCode:H.DELETE,action:h(G0,e,!0)},{keyCode:H.BACKSPACE,action:h(T1,e,t,!1)},{keyCode:H.DELETE,action:h(T1,e,t,!0)},{keyCode:H.BACKSPACE,action:h(Kf,e,!1)},{keyCode:H.DELETE,action:h(Kf,e,!0)},{keyCode:H.BACKSPACE,action:h(J0,e,!1)},{keyCode:H.DELETE,action:h(J0,e,!0)},{keyCode:H.BACKSPACE,action:h(x1,e,!1)},{keyCode:H.DELETE,action:h(x1,e,!0)},{keyCode:H.BACKSPACE,action:h(B0,e,!1)},{keyCode:H.DELETE,action:h(B0,e,!0)},{keyCode:H.BACKSPACE,action:h(L0,e,!1)},{keyCode:H.DELETE,action:h(L0,e,!0)},{keyCode:H.BACKSPACE,action:h(_1,e,!1)},{keyCode:H.DELETE,action:h(_1,e,!0)}],n).each(function(e){n.preventDefault()}))}),a.on("keyup",function(e){var t;!1===e.isDefaultPrevented()&&(e=e,by([{keyCode:H.BACKSPACE,action:h(Z0,t=a)},{keyCode:H.DELETE,action:h(Z0,t)}],e))}),(s=e).on("keydown",function(e){var t,n;e.keyCode===H.ENTER&&(t=s,(n=e).isDefaultPrevented()||(n.preventDefault(),(e=t.undoManager).typing&&(e.typing=!1,e.add()),t.undoManager.transact(function(){!1===t.selection.isCollapsed()&&t.execCommand("Delete"),jy(t,n)})))}),(o=e).on("keydown",function(e){var t;!1===e.isDefaultPrevented()&&(t=e,by([{keyCode:H.SPACEBAR,action:h(Yy,o)}],t).each(function(e){t.preventDefault()}))}),r=t=e,i=_a(function(){r.composing||vf(r)},0),d2.isIE()&&(r.on("keypress",function(e){i.throttle()}),r.on("remove",function(e){i.cancel()})),t.on("input",function(e){!1===e.isComposing&&vf(t)}),(n=e).on("keydown",function(e){var t;!1===e.isDefaultPrevented()&&(t=e,by([{keyCode:H.END,action:h(fy,e=n,!0)},{keyCode:H.HOME,action:h(fy,e,!1)},{keyCode:H.END,action:h(wy,e,!0)},{keyCode:H.HOME,action:h(wy,e,!1)}],t).each(function(e){t.preventDefault()}))}),d}var Ky,qy,Zy=te.each,Qy=L.DOM,Jy=function(e,t){function u(e){r="string"==typeof e?{name:e,classes:[],attrs:{}}:e;var t,n=e=Qy.create(r.name);return(t=r).classes.length&&Qy.addClass(n,t.classes.join(" ")),Qy.setAttribs(n,t.attrs),e}function c(t,e,n){var r,i,o,s=0<e.length&&e[0],a=s&&s.name,l=(l=a,o="string"!=typeof(o=t)?o.nodeName.toLowerCase():o,!(!(o=(o=d.getElementRule(o))&&o.parentsRequired)||!o.length)&&(l&&-1!==te.inArray(o,l)?l:o[0]));if(l)a===l?(i=e[0],e=e.slice(1)):i=l;else if(s)i=e[0],e=e.slice(1);else if(!n)return t;return i&&(r=u(i)).appendChild(t),n&&(r||(r=Qy.create("div")).appendChild(t),te.each(n,function(e){e=u(e);r.insertBefore(e,t)})),c(r,e,i&&i.siblings)}var r,n,d=t&&t.schema||eo({});return e&&e.length?(r=e[0],t=u(r),(n=Qy.create("div")).appendChild(c(t,e.slice(1),r.siblings)),n):""},ev=function(e){var t,o={classes:[],attrs:{}};return"*"!==(e=o.selector=te.trim(e))&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,function(e,t,n,r,i){switch(t){case"#":o.attrs.id=n;break;case".":o.classes.push(n);break;case":":-1!==te.inArray("checked disabled enabled read-only required".split(" "),n)&&(o.attrs[n]=n)}return"["===r&&(t=i.match(/([\w\-]+)(?:\=\"([^\"]+))?/))&&(o.attrs[t[1]]=t[2]),""})),o.name=t||"div",o},tv=[9,27,H.HOME,H.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,H.DOWN,H.UP,H.LEFT,H.RIGHT].concat(K.browser.isFirefox()?[224]:[]),nv="data-mce-placeholder",rv=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,iv=function(e,t){return ut(q.fromDom(t),e.getParam("inline_boundaries_selector","a[href],code,.mce-annotation","string"))},ov=function(e){return"rtl"===L.DOM.getStyle(e,"direction",!0)||(e=e.textContent,rv.test(e))},sv=function(e,t,n){e=e,t=t;n=O(L.DOM.getParents(n.container(),"*",t),e);return N.from(n[n.length-1])},av=w(S0,!0),lv=w(S0,!1),uv=zn,cv=D,dv=jt([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),hv=A,fv=w(r1,!0),pv=w(r1,!1),gv=function(e,t){for(var n=0;n<e.length;n++){var r=e[n].apply(null,t);if(r.isSome())return r}return N.none()},mv=jt([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),yv=function(e,t,n){var r=av(n),i=a1(t,r.container());return sv(e,i,r).fold(function(){return Bc(i,r).bind(w(sv,e,i)).map(function(e){return mv.before(e)})},N.none)},vv=function(e,t,n){var r=lv(n);return u1(e,t,r).bind(function(e){return Hc(e,r).isNone()?N.some(mv.start(e)):N.none()})},bv=function(e,t,n){var r=av(n);return u1(e,t,r).bind(function(e){return Bc(e,r).isNone()?N.some(mv.end(e)):N.none()})},Ev=function(e,t,n){var r=lv(n),i=a1(t,r.container());return sv(e,i,r).fold(function(){return Hc(i,r).bind(w(sv,e,i)).map(function(e){return mv.after(e)})},N.none)},Cv=function(e){return!1===ov(Sv(e))},wv=function(e,t,n){return gv([yv,vv,bv,Ev],[e,t,n]).filter(Cv)},Sv=function(e){return e.fold(a,a,a,a)},Tv=function(e){return e.fold(_("before"),_("start"),_("end"),_("after"))},Rv=(w(g1,!1),w(g1,!0),function(e,t,n){var r=e?1:-1;return t.setRng(F(n.container(),n.offset()+r).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0}),Av=w(E1,!0),_v=w(E1,!1),Nv=function(e){return Jr(e)||ei(e)},xv=(Ky={Br:0,0:"Br",Block:1,1:"Block",Wrap:2,2:"Wrap",Eol:3,3:"Eol"},w($1,y.isAbove,-1)),Ov=w($1,y.isBelow,1),Iv=w(j1,-1,xv),Mv=w(j1,1,Ov),kv=function(t){function e(e){return x(e,function(e){return(e=Ha(e)).node=t,e})}var n;return Q(t)?e(t.getClientRects()):A(t)?((n=t.ownerDocument.createRange()).setStart(t,0),n.setEnd(t,t.data.length),e(n.getClientRects())):void 0},Dv=(qy={Up:-1,"-1":"Up",Down:1,1:"Down"},w(X1,qy.Up,va,ba)),Lv=w(X1,qy.Down,ba,va),Pv=D,Fv=Ml,Bv=D,Hv=w(Sy,function(e){return e.bottom},function(e,t){return e.y<t}),Uv=w(Sy,function(e){return e.top},function(e,t){return e.y>t}),Vv=w(Ty,xv),Wv=w(Ty,Ov),$v=function(e,t){var n,r,i=t,o=e.dom,s=e.schema.getMoveCaretBeforeOnEnterElements();if(t){/^(LI|DT|DD)$/.test(t.nodeName)&&(r=function(e){for(;e;){if(1===e.nodeType||3===e.nodeType&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}}(t.firstChild))&&/^(UL|OL|DL)$/.test(r.nodeName)&&t.insertBefore(o.doc.createTextNode(oi),t.firstChild);var a=o.createRng();if(t.normalize(),t.hasChildNodes()){for(var l=new J(t,t);n=l.current();){if(A(n)){a.setStart(n,0),a.setEnd(n,0);break}if(s[n.nodeName.toLowerCase()]){a.setStartBefore(n),a.setEndBefore(n);break}i=n,n=l.next()}n||(a.setStart(i,0),a.setEnd(i,0))}else k(t)?t.nextSibling&&o.isBlock(t.nextSibling)?(a.setStartBefore(t),a.setEndBefore(t)):(a.setStartAfter(t),a.setEndAfter(t)):(a.setStart(t,0),a.setEnd(t,0));e.selection.setRng(a),mh(e,a)}},jv=function(e,t,n,r,i){var o,s=e.dom,a=e.selection.getRng();n!==e.getBody()&&(o=(i=ky(o=n)&&ky(o.parentNode)?"LI":i)?t(i):s.create("BR"),Ly(n,r,!0)&&Ly(n,r,!1)?My(n,"LI")?s.insertAfter(o,Dy(n)):s.replace(o,n):Ly(n,r,!0)?My(n,"LI")?(s.insertAfter(o,Dy(n)),o.appendChild(s.doc.createTextNode(" ")),o.appendChild(n)):n.parentNode.insertBefore(o,n):Ly(n,r,!1)?s.insertAfter(o,Dy(n)):(n=Dy(n),(t=a.cloneRange()).setStartAfter(r),t.setEndAfter(n),a=t.extractContents(),"LI"===i&&a.firstChild&&"LI"===a.firstChild.nodeName?(o=a.firstChild,s.insertAfter(a,n)):(s.insertAfter(a,n),s.insertAfter(o,n))),s.remove(r),$v(e,o))},zv=function(e){e.innerHTML='<br data-mce-bogus="1">'},Gv=function(e,t){return e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t},Yv=function(e,t){return t&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&"true"!==e.getContentEditable(t)},Xv=function(e,t,n){return!1===A(t)?n:e?1===n&&t.data.charAt(n-1)===si?0:n:n===t.data.length-1&&t.data.charAt(n)===si?t.data.length:n},Kv=function(e,t){for(var n,r=e.getRoot(),i=t;i!==r&&"false"!==e.getContentEditable(i);)"true"===e.getContentEditable(i)&&(n=i),i=i.parentNode;return i!==r?n:r},qv=function(e,t){var n,r,i,o=eu(e);o&&o.toLowerCase()===t.tagName.toLowerCase()&&(n=t,t=gl(o=e),r=o.dom,N.from(t.style).map(r.parseStyle).each(function(e){var t=Bt(q.fromDom(n)),t=I(I({},t),e);r.setStyles(n,t)}),o=N.from(t.class).map(function(e){return e.split(/\s+/)}),e=N.from(n.className).map(function(e){return O(e.split(/\s+/),function(e){return""!==e})}),Fa(o,e,function(t,e){e=O(e,function(e){return!xe(t,e)}),e=Ye(t,e);r.setAttrib(n,"class",e.join(" "))}),i=["style","class"],o=Ve(t,function(e,t){return!xe(i,t)}),r.setAttribs(n,o))},Zv=function(e,t){var n,r,i=e.selection,o=e.dom,s=i.getRng();Ed(o,s).each(function(e){s.setStart(e.startContainer,e.startOffset),s.setEnd(e.endContainer,e.endOffset)});var a=s.startOffset,l=s.startContainer,u=(1===l.nodeType&&l.hasChildNodes()&&(c=a>l.childNodes.length-1,l=l.childNodes[Math.min(a,l.childNodes.length-1)]||l,a=c&&3===l.nodeType?l.nodeValue.length:0),o.getParent(l,o.isBlock)),c=u?o.getParent(u.parentNode,o.isBlock):null,d=c?c.nodeName.toUpperCase():"",t=!(!t||!t.ctrlKey);"LI"!==d||t||(u=c),l&&3===l.nodeType&&a>=l.nodeValue.length&&!function(e){for(var t,n=new J(l,u),r=e.getNonEmptyElements();t=n.next();)if(r[t.nodeName.toLowerCase()]||0<t.length)return 1}(e.schema)&&(n=o.create("br"),s.insertNode(n),s.setStartAfter(n),s.setEndAfter(n),r=!0),n=o.create("br"),$l(o,s,n),Fy(o,i,n),By(o,i,n,r),e.undoManager.add()},Qv=function(e){return e.fold(m,Vy,Vy,m)},Jv=function(e,t){t.fold(Y,w(Hy,e),w(Uy,e),Y)},e2=jt([{br:[]},{block:[]},{none:[]}]),t2=function(e,t){return $y(e,e.getParam("no_newline_selector",""))},n2=function(n){return function(e,t){return""===eu(e)===n}},r2=function(n){return function(e,t){return Iy(e).filter(function(e){return ei(q.fromDom(e))}).isSome()===n}},i2=function(n,r){return function(e,t){return Iy(e).fold(_(""),function(e){return e.nodeName.toUpperCase()})===n.toUpperCase()===r}},o2=function(e){return i2("pre",e)},s2=function(n){return function(e,t){return e.getParam("br_in_pre",!0)===n}},a2=function(e,t){return $y(e,e.getParam("br_newline_selector",".mce-toc h2,figcaption,caption"))},l2=function(e,t){return t},u2=function(e){var t=eu(e),n=function(e,t){for(var n,r=e.getRoot(),i=t;i!==r&&"false"!==e.getContentEditable(i);)"true"===e.getContentEditable(i)&&(n=i),i=i.parentNode;return i!==r?n:r}(e.dom,e.selection.getStart());return n&&e.schema.isValidChild(n.nodeName,t||"P")},c2=function(e,t){return function(n,r){return W(e,function(e,t){return e&&t(n,r)},!0)?N.some(t):N.none()}},d2=an().browser,h2=w(zy,oi),f2=w(zy," "),p2=(g2.prototype.nodeChanged=function(e){var t,n,r=this.editor.selection;this.editor.initialized&&r&&!this.editor.getParam("disable_nodechange")&&!this.editor.mode.isReadOnly()&&(n=this.editor.getBody(),(r=r.getStart(!0)||n).ownerDocument===this.editor.getDoc()&&this.editor.dom.isChildOf(r,n)||(r=n),t=[],this.editor.dom.getParent(r,function(e){return e===n||void t.push(e)}),(e=e||{}).element=r,e.parents=t,this.editor.fire("NodeChange",e))},g2.prototype.isSameElementPath=function(e){var t,n=this.editor.$(e).parentsUntil(this.editor.getBody()).add(e);if(n.length===this.lastPath.length){for(t=n.length;0<=t&&n[t]===this.lastPath[t];t--);if(-1===t)return this.lastPath=n,!0}return this.lastPath=n,!1},g2);function g2(n){this.lastPath=[],this.editor=n;var r,t=this;"onselectionchange"in n.getDoc()||n.on("NodeChange click mouseup keyup focus",function(e){var t=n.selection.getRng(),t={startContainer:t.startContainer,startOffset:t.startOffset,endContainer:t.endContainer,endOffset:t.endOffset};"nodechange"!==e.type&&vd(t,r)||n.fire("SelectionChange"),r=t}),n.on("contextmenu",function(){n.fire("SelectionChange")}),n.on("SelectionChange",function(){var e=n.selection.getStart(!0);!e||!K.range&&n.selection.isCollapsed()||Tc(n)&&!t.isSameElementPath(e)&&n.dom.isChildOf(e,n.getBody())&&n.nodeChanged({selectionChange:!0})}),n.on("mouseup",function(e){!e.isDefaultPrevented()&&Tc(n)&&("IMG"===n.selection.getNode().nodeName?Ir.setEditorTimeout(n,function(){n.nodeChanged()}):n.nodeChanged())})}function m2(e){return Q(e)&&Qr(q.fromDom(e))}function y2(e){var t=e.getBoundingClientRect(),n=(e=e.ownerDocument).documentElement,e=e.defaultView;return{top:t.top+e.pageYOffset-n.clientTop,left:t.left+e.pageXOffset-n.clientLeft}}function v2(e,d){var h=Ir.throttle(function(e,t){d._selectionOverrides.hideFakeCaret(),d.selection.placeCaretAt(e,t)},0);return d.on("remove",h.stop),function(c){return e.on(function(e){var t,n,r,i,o,s,a,l,u=Math.max(Math.abs(c.screenX-e.screenX),Math.abs(c.screenY-e.screenY));if(!e.dragging&&10<u){if(d.fire("dragstart",{target:e.element}).isDefaultPrevented())return;e.dragging=!0,d.focus()}e.dragging&&(u=e,i={pageX:(n=c,s=(t=d).inline?y2(t.getBody()):{left:0,top:0},l=(a=t).getBody(),a=a.inline?{left:l.scrollLeft,top:l.scrollTop}:{left:0,top:0},(r={pageX:(l=t,(l=(t=n).target.ownerDocument===l.getDoc()?{left:t.pageX,top:t.pageY}:(n=y2(l.getContentAreaContainer()),i=(l=l).getBody(),o=l.getDoc().documentElement,r={left:i.scrollLeft,top:i.scrollTop},i={left:i.scrollLeft||o.scrollLeft,top:i.scrollTop||o.scrollTop},o=l.inline?r:i,{left:t.pageX-n.left+o.left,top:t.pageY-n.top+o.top})).left-s.left+a.left),pageY:l.top-s.top+a.top}).pageX-u.relX),pageY:r.pageY+5},t=e.ghost,n=d.getBody(),t.parentNode!==n&&n.appendChild(t),o=e.ghost,l=e.width,s=e.height,a=e.maxX,u=e.maxY,t=n=0,o.style.left=(e=i).pageX+"px",o.style.top=e.pageY+"px",u<e.pageY+s&&(t=e.pageY+s-u),o.style.width=l-(n=a<e.pageX+l?e.pageX+l-a:n)+"px",o.style.height=s-t+"px",h(c.clientX,c.clientY))})}}function b2(e){e.on(function(e){W2(e.ghost)}),e.clear()}function E2(e){function t(e){var t,n,r,i;0===e.button&&(i=Ie(c.dom.getParents(e.target),function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return function(e){for(var t=0;t<n.length;t++)if(n[t](e))return!0;return!1}}(U2,V2)).getOr(null),t=c.getBody(),U2(r=i))&&r!==t&&(r=c.dom.getPos(i),t=c.getBody(),n=c.getDoc().documentElement,u.set({element:i,dragging:!1,screenX:e.screenX,screenY:e.screenY,maxX:(c.inline?t.scrollWidth:n.offsetWidth)-2,maxY:(c.inline?t.scrollHeight:n.offsetHeight)-2,relX:e.pageX-r.x,relY:e.pageY-r.y,width:i.offsetWidth,height:i.offsetHeight,ghost:(n=(t=i).offsetWidth,e=i.offsetHeight,r=c.dom,t=t.cloneNode(!0),r.setStyles(t,{width:n,height:e}),r.setAttrib(t,"data-mce-selected",null),i=r.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"}),r.setStyles(i,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:e}),r.setStyles(t,{margin:0,boxSizing:"border-box"}),i.appendChild(t),i)}))}function n(o){a.on(function(e){var t,n,r,i;!e.dragging||(i=3===(i=(n=l).selection.getSel().getRangeAt(0).startContainer).nodeType?i.parentNode:i)===(r=e.element)||n.dom.isChildOf(i,r)||U2(i)||((n=e.element.cloneNode(!0)).removeAttribute("data-mce-selected"),t=n,l.fire("drop",{clientX:o.clientX,clientY:o.clientY}).isDefaultPrevented())||l.undoManager.transact(function(){W2(e.element),l.insertContent(l.dom.getOuterHTML(t)),l._selectionOverrides.hideFakeCaret()})}),b2(a)}function r(){o.on(function(e){e.dragging&&s.fire("dragend")}),b2(o)}i=P(N.none());var i,o,s,a,l,u,c,d={clear:function(){return i.set(N.none())},set:function(e){return i.set(N.some(e))},isSet:function(){return i.get().isSome()},on:function(e){return i.get().each(e)}},h=L.DOM,f=document,p=v2(u=d,c=e);o=a=d,(s=l=e).on("mousedown",t),e.on("mousemove",p),e.on("mouseup",n),h.bind(f,"mousemove",p),h.bind(f,"mouseup",r),e.on("remove",function(){h.unbind(f,"mousemove",p),h.unbind(f,"mouseup",r)})}function C2(e,t){return sd(e.getBody(),t)}function w2(u){function c(e){return e!==C&&(j2(e)||Gn(e))&&b.isChildOf(e,C)}function o(e){e&&v.setRng(e)}function d(e,t,n,r){return void 0===r&&(r=!0),u.fire("ShowCaret",{target:t,direction:e,before:n}).isDefaultPrevented()?null:(r&&v.scrollIntoView(t,-1===e),w.show(n,t))}function h(e){return A(e.startContainer)||A(e.endContainer)}function a(e,t){if(e)if(e.collapsed){if(!h(e)){var n=t?1:-1,r=Hl(n,C,e),i=r.getNode(!t);if(Il(i))return d(n,i,!!t&&!r.isAtEnd(),!1);i=r.getNode(t);if(Il(i))return d(n,i,!t&&!r.isAtEnd(),!1)}}else{var o,s,a,l,n=e.startContainer,i=e.startOffset,t=e.endOffset;if(3===n.nodeType&&0===i&&j2(n.parentNode)&&(n=n.parentNode,i=b.nodeIndex(n),n=n.parentNode),1===n.nodeType)if(t===i+1&&n===e.endContainer){r=n.childNodes[i];if(c(r))return e=(t=r).cloneNode(!0),(n=u.fire("ObjectSelected",{target:t,targetClone:e})).isDefaultPrevented()?null:(i=t,n=n.targetClone,e=e,s=u.$,0===(a=fr(q.fromDom(u.getBody()),"#"+S).fold(function(){return s([])},function(e){return s([e.dom])})).length&&(a=s('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr("id",S)).appendTo(u.getBody()),l=b.createRng(),n===e&&K.ie?(a.empty().append('<p style="font-size: 0" data-mce-bogus="all"> </p>').append(n),l.setStartAfter(a[0].firstChild.firstChild),l.setEndAfter(n)):(a.empty().append(oi).append(n).append(oi),l.setStart(a[0].firstChild,1),l.setEnd(a[0].lastChild,0)),a.css({top:b.getPos(i,u.getBody()).y}),a[0].focus(),(e=v.getSel()).removeAllRanges(),e.addRange(l),n=l,o=q.fromDom(t),ee(la(q.fromDom(u.getBody()),"*[data-mce-selected]"),function(e){M(o,e)||Pt(e,T)}),b.getAttrib(t,T)||t.setAttribute(T,"1"),f=t,_(),n)}}return null}function s(){f&&f.removeAttribute(T),fr(q.fromDom(u.getBody()),"#"+S).each(Dn),f=null}var f,t,e,n,r,i,l,p,g,m,y,v=u.selection,b=u.dom,E=b.isBlock,C=u.getBody(),w=Nl(u,C,E,function(){return zd(u)}),S="sel-"+b.uniqueId(),T="data-mce-selected",R=v.getRng,A=function(e){return fi(e)||Br(e)||Hr(e)},_=function(){w.hide()};return K.ceFalse&&(u.on("mouseup",function(e){var t=R();t.collapsed&&Rm(u,e.clientX,e.clientY)&&V0(u,t,!1).each(o)}),u.on("click",function(e){var t=C2(u,e.target);t&&(j2(t)&&(e.preventDefault(),u.focus()),$2(t))&&b.isChildOf(t,v.getNode())&&s()}),u.on("blur NewBlock",s),u.on("ResizeWindow FullscreenStateChanged",w.reposition),y=function(e){var t=Nu(e);return!!e.firstChild&&(e=F.before(e.firstChild),t=t.next(e))&&!(Sg(e=t)||Tg(e)||bg(e)||Eg(e))},u.on("tap",function(e){var t=e.target,n=C2(u,t);j2(n)?(e.preventDefault(),U0(u,n).each(a)):c(t)&&U0(u,t).each(a)},!0),u.on("mousedown",function(e){var t,n,r,i=e.target;i!==C&&"HTML"!==i.nodeName&&!b.isChildOf(i,C)||!1===Rm(u,e.clientX,e.clientY)||((t=C2(u,i))?j2(t)?(e.preventDefault(),U0(u,t).each(a)):(s(),$2(t)&&e.shiftKey||ad(e.clientX,e.clientY,v.getRng())||(_(),v.placeCaretAt(e.clientX,e.clientY))):c(i)?U0(u,i).each(a):!1===Il(i)&&(s(),_(),t=ry(C,e.clientX,e.clientY))&&(i=i,n=t.node,r=b.getParent(i,E),n=b.getParent(n,E),r&&i!==n&&b.isChildOf(r,n)&&!1===j2(C2(u,r))||r&&(i=n,b.getParent(r,E)!==b.getParent(i,E))&&y(r)||(e.preventDefault(),n=d(1,t.node,t.before,!1),u.getBody().focus(),o(n))))}),u.on("keypress",function(e){H.modifierPressed(e)||j2(v.getNode())&&e.preventDefault()}),u.on("GetSelectionRange",function(e){var t=e.range;f&&(f.parentNode?((t=t.cloneRange()).selectNode(f),e.range=t):f=null)}),u.on("SetSelectionRange",function(e){e.range=(t=e.range,n=u.schema.getShortEndedElements(),r=b.createRng(),s=t.startContainer,i=t.startOffset,o=t.endContainer,t=t.endOffset,$e(n,s.nodeName.toLowerCase())?0===i?r.setStartBefore(s):r.setStartAfter(s):r.setStart(s,i),$e(n,o.nodeName.toLowerCase())?0===t?r.setEndBefore(o):r.setEndAfter(o):r.setEnd(o,t),r);var t,n,r,i,o,s=a(e.range,e.forward);s&&(e.range=s)}),u.on("AfterSetSelectionRange",function(e){var e=e.range,t=e.startContainer.parentNode;h(e)||"mcepastebin"===t.id||_(),b.hasClass(t,"mce-offscreen-selection")||s()}),u.on("copy",function(e){var t,n=e.clipboardData;e.isDefaultPrevented()||!e.clipboardData||K.ie||(t=(t=b.get(S))&&t.getElementsByTagName("*")[0])&&(e.preventDefault(),n.clearData(),n.setData("text/html",t.outerHTML),n.setData("text/plain",t.outerText||t.innerText))}),E2(r=u),(i=r).on("drop",function(e){var t=void 0!==e.clientX?i.getDoc().elementFromPoint(e.clientX,e.clientY):null;!U2(t)&&"false"!==i.dom.getContentEditableParent(t)||e.preventDefault()}),r.getParam("block_unsupported_drop",!0,"boolean")&&(p=function(e){var t;e.defaultPrevented||(t=e.dataTransfer)&&(xe(t.types,"Files")||0<t.files.length)&&(e.preventDefault(),"drop"===e.type)&&i0(l,"Dropped file type is not supported")},g=function(e){Ud(l,e.target)&&p(e)},m=function(){var t=L.DOM,n=l.dom,r=document,i=l.inline?l.getBody():l.getDoc(),e=["drop","dragover"];ee(e,function(e){t.bind(r,e,g),n.bind(i,e,p)}),l.on("remove",function(){ee(e,function(e){t.unbind(r,e,g),n.unbind(i,e,p)})})},(l=r).on("init",function(){Ir.setEditorTimeout(l,m,0)})),e=_a(function(){var e;!t.removed&&t.getBody().contains(document.activeElement)&&(e=t.selection.getRng()).collapsed&&(e=W0(t,e,!1),t.selection.setRng(e))},0),(t=u).on("focus",function(){e.throttle()}),t.on("blur",function(){e.cancel()}),(n=u).on("init",function(){n.on("focusin",function(e){var t,e=e.target;Gn(e)&&(t=sd(n.getBody(),e),t=D(t)?t:e,n.selection.getNode()!==t)&&U0(n,t).each(function(e){return n.selection.setRng(e)})})})),{showCaret:d,showBlockCaretContainer:function(e){e.hasAttribute("data-mce-caret")&&(yi(e),o(R()),v.scrollIntoView(e))},hideFakeCaret:_,destroy:function(){w.destroy(),f=null}}}function S2(o){function e(e,t){try{o.getDoc().execCommand(e,!1,t)}catch(e){}}function s(e){return e.isDefaultPrevented()}function t(){o.shortcuts.add("meta+a",null,"SelectAll")}function n(){o.on("keydown",function(e){if(!s(e)&&e.keyCode===c&&f.isCollapsed()&&0===f.getRng().startOffset){var t=f.getNode().previousSibling;if(t&&t.nodeName&&"table"===t.nodeName.toLowerCase())return e.preventDefault(),!1}})}function r(){o.inline||(o.contentStyles.push("body {min-height: 150px}"),o.on("click",function(e){"HTML"===e.target.nodeName&&(11<K.ie?o.getBody().focus():(e=o.selection.getRng(),o.getBody().focus(),o.selection.setRng(e),o.selection.normalize(),o.nodeChanged()))}))}var i,a,l,u=te.each,c=H.BACKSPACE,d=H.DELETE,h=o.dom,f=o.selection,p=o.parser,g=K.gecko,m=K.ie,y=K.webkit,v="data:text/mce-internal,",b=m?"Text":"URL";return o.on("keydown",function(e){if(!s(e)&&e.keyCode===H.BACKSPACE){var t=(e=f.getRng()).startContainer,n=e.startOffset,r=h.getRoot(),i=t;if(e.collapsed&&0===n){for(;i&&i.parentNode&&i.parentNode.firstChild===i&&i.parentNode!==r;)i=i.parentNode;"BLOCKQUOTE"===i.tagName&&(o.formatter.toggle("blockquote",null,i),(e=h.createRng()).setStart(t,0),e.setEnd(t,0),f.setRng(e))}}}),i=function(e){var t=h.create("body"),e=e.cloneContents();return t.appendChild(e),f.serializer.serialize(t,{format:"html"})},o.on("keydown",function(e){var t,n,r=e.keyCode;s(e)||r!==d&&r!==c||(r=o.selection.isCollapsed(),t=o.getBody(),r&&!h.isEmpty(t))||!r&&(r=o.selection.getRng(),r=i(r),(n=h.createRng()).selectNode(o.getBody()),r!==i(n))||(e.preventDefault(),o.setContent(""),t.firstChild&&h.isBlock(t.firstChild)?o.selection.setCursorLocation(t.firstChild,0):o.selection.setCursorLocation(t,0),o.nodeChanged())}),K.windowsPhone||o.on("keyup focusin mouseup",function(e){H.modifierPressed(e)||f.normalize()},!0),y&&(o.inline||h.bind(o.getDoc(),"mousedown mouseup",function(e){var t;e.target===o.getDoc().documentElement&&(t=f.getRng(),o.getBody().focus(),"mousedown"===e.type?fi(t.startContainer)||f.placeCaretAt(e.clientX,e.clientY):f.setRng(t))}),o.on("click",function(e){var t=e.target;/^(IMG|HR)$/.test(t.nodeName)&&"false"!==h.getContentEditableParent(t)&&(e.preventDefault(),o.selection.select(t),o.nodeChanged()),"A"===t.nodeName&&h.hasClass(t,"mce-item-anchor")&&(e.preventDefault(),f.select(t))}),eu(o)&&o.on("init",function(){e("DefaultParagraphSeparator",eu(o))}),o.on("init",function(){o.dom.bind(o.getBody(),"submit",function(e){e.preventDefault()})}),n(),p.addNodeFilter("br",function(e){for(var t=e.length;t--;)"Apple-interchange-newline"===e[t].attr("class")&&e[t].remove()}),K.iOS?(o.inline||o.on("keydown",function(){document.activeElement===document.body&&o.getWin().focus()}),r(),o.on("click",function(e){var t=e.target;do{if("A"===t.tagName)return void e.preventDefault()}while(t=t.parentNode)}),o.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")):t()),11<=K.ie&&(r(),n()),K.ie&&(t(),e("AutoUrlDetect",!1),o.on("dragstart",function(e){var t;(e=e).dataTransfer&&(o.selection.isCollapsed()&&"IMG"===e.target.tagName&&f.select(e.target),0<(t=o.selection.getContent()).length)&&(t=v+escape(o.id)+","+escape(t),e.dataTransfer.setData(b,t))}),o.on("drop",function(e){var t;s(e)||(t=e.dataTransfer&&(t=e.dataTransfer.getData(b))&&0<=t.indexOf(v)?(t=t.substr(v.length).split(","),{id:unescape(t[0]),html:unescape(t[1])}):null)&&t.id!==o.id&&(e.preventDefault(),e=cd(e.x,e.y,o.getDoc()),f.setRng(e),e=t.html,o.queryCommandSupported("mceInsertClipboardContent")?o.execCommand("mceInsertClipboardContent",!1,{content:e,internal:!0}):o.execCommand("mceInsertContent",!1,e))})),g&&(o.on("keydown",function(e){var t,n;s(e)||e.keyCode!==c||o.getBody().getElementsByTagName("hr").length&&f.isCollapsed()&&0===f.getRng().startOffset&&(n=(t=f.getNode()).previousSibling,"HR"===t.nodeName?(h.remove(t),e.preventDefault()):n&&n.nodeName&&"hr"===n.nodeName.toLowerCase()&&(h.remove(n),e.preventDefault()))}),Range.prototype.getClientRects||o.on("mousedown",function(e){var t;s(e)||"HTML"!==e.target.nodeName||((t=o.getBody()).blur(),Ir.setEditorTimeout(o,function(){t.focus()}))}),a=function(){var e=h.getAttribs(f.getStart().cloneNode(!1));return function(){var t=f.getStart();t!==o.getBody()&&(h.setAttrib(t,"style",null),u(e,function(e){t.setAttributeNode(e.cloneNode(!0))}))}},l=function(){return!f.isCollapsed()&&h.getParent(f.getStart(),h.isBlock)!==h.getParent(f.getEnd(),h.isBlock)},o.on("keypress",function(e){var t;if(!s(e)&&(8===e.keyCode||46===e.keyCode)&&l())return t=a(),o.getDoc().execCommand("delete",!1,null),t(),e.preventDefault(),!1}),h.bind(o.getDoc(),"cut",function(e){var t;!s(e)&&l()&&(t=a(),Ir.setEditorTimeout(o,function(){t()}))}),o.getParam("readonly")||o.on("BeforeExecCommand mousedown",function(){e("StyleWithCSS",!1),e("enableInlineTableEditing",!1),Cl(o)||e("enableObjectResizing",!1)}),o.on("SetContent ExecCommand",function(e){"setcontent"!==e.type&&"mceInsertLink"!==e.command||u(h.select("a"),function(e){var t=e.parentNode,n=h.getRoot();if(t.lastChild===e){for(;t&&!h.isBlock(t);){if(t.parentNode.lastChild!==t||t===n)return;t=t.parentNode}h.add(t,"br",{"data-mce-bogus":1})}})}),o.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}"),K.mac&&o.on("keydown",function(e){!H.metaKeyPressed(e)||e.shiftKey||37!==e.keyCode&&39!==e.keyCode||(e.preventDefault(),o.selection.getSel().modify("move",37===e.keyCode?"backward":"forward","lineboundary"))}),n()),{refreshContentEditable:function(){},isHidden:function(){var e;return!(!g||o.removed||(e=o.selection.getSel())&&e.rangeCount&&0!==e.rangeCount)}}}function T2(e){return Ve(e,function(e){return!1===Ee(e)})}function R2(e){var t=e.settings,n=e.editorUpload.blobCache;return T2({allow_conditional_comments:t.allow_conditional_comments,allow_html_data_urls:t.allow_html_data_urls,allow_svg_data_urls:t.allow_svg_data_urls,allow_html_in_named_anchor:t.allow_html_in_named_anchor,allow_script_urls:t.allow_script_urls,allow_unsafe_link_target:t.allow_unsafe_link_target,convert_fonts_to_spans:t.convert_fonts_to_spans,fix_list_elements:t.fix_list_elements,font_size_legacy_values:t.font_size_legacy_values,forced_root_block:t.forced_root_block,forced_root_block_attrs:t.forced_root_block_attrs,padd_empty_with_br:t.padd_empty_with_br,preserve_cdata:t.preserve_cdata,remove_trailing_brs:t.remove_trailing_brs,inline_styles:t.inline_styles,root_name:e.inline?e.getElement().nodeName.toLowerCase():void 0,validate:!0,blob_cache:n,images_dataimg_filter:t.images_dataimg_filter})}function A2(e){var t,i,n;e.bindPendingEventDelegates(),e.initialized=!0,e.fire("Init"),e.focus(!0),n=(i=e).dom.getRoot(),i.inline||Tc(i)&&i.selection.getStart(!0)!==n||Uc(n).each(function(e){var t,n,r=e.getNode(),r=It(r)?Uc(r).getOr(e):e;K.browser.isIE()?(e=i,n=r.toRange(),t=q.fromDom(e.getBody()),n=(Pd(e)?N.from(n):N.none()).map(Fd).filter(Ld(t)),e.bookmark=n.isSome()?n:e.bookmark):i.selection.setRng(r.toRange())}),e.nodeChanged({initial:!0}),e.execCallback("init_instance_callback",e),(t=e).settings.auto_focus&&Ir.setEditorTimeout(t,function(){var e=!0===t.settings.auto_focus?t:t.editorManager.get(t.settings.auto_focus);e.destroyed||e.focus()},100)}function _2(t,e){var n,r,i,o,s,a=t.settings,l=t.getDoc(),u=t.getBody();a.browser_spellcheck||a.gecko_spellcheck||(l.body.spellcheck=!1,z2.setAttrib(u,"spellcheck","false")),t.quirks=S2(t),t.fire("PostRender"),void 0!==(l=t.getParam("directionality",na.isRtl()?"rtl":void 0))&&(u.dir=l),a.protect&&t.on("BeforeSetContent",function(t){te.each(a.protect,function(e){t.content=t.content.replace(e,function(e){return"\x3c!--mce:protected "+escape(e)+"--\x3e"})})}),t.on("SetContent",function(){t.addVisual(t.getBody())}),!1===e&&t.load({initial:!0,format:"html"}),t.startContent=t.getContent({format:"raw"}),t.on("compositionstart compositionend",function(e){t.composing="compositionstart"===e.type}),0<t.contentStyles.length&&(n="",te.each(t.contentStyles,function(e){n+=e+"\r\n"}),t.dom.addStyle(n)),i=(r=t).contentCSS,(o=((u=r).inline?u.ui:u.dom).styleSheetLoader).loadAll(i,l=function(){r.on("remove",function(){return o.unloadAll(i)}),A2(r)},l),a.content_style&&(e=a.content_style,l=q.fromDom((u=t).getBody()),l=mt(Nn(l)),s=q.fromTag("style"),Dt(s,"type","text/css"),kn(s,q.fromText(e)),kn(l,s),u.on("remove",function(){Dn(s)}))}function N2(t,e){var a,o,n,i,s,l,r,u=t.settings,c=t.getElement(),d=t.getDoc();u.inline||(t.getElement().style.visibility=t.orgVisibility),e||t.inline||(d.open(),d.write(t.iframeHTML),d.close()),t.inline&&(z2.addClass(c,"mce-content-body"),t.contentDocument=d=document,t.contentWindow=window,t.bodyElement=c,t.contentAreaContainer=c),(e=t.getBody()).disabled=!0,t.readonly=!!u.readonly,t.readonly||(t.inline&&"static"===z2.getStyle(e,"position",!0)&&(e.style.position="relative"),e.contentEditable=t.getParam("content_editable_state",!0)),e.disabled=!1,t.editorUpload=f0(t),t.schema=eo(u),t.dom=L(d,{keep_values:!0,url_converter:t.convertURL,url_converter_scope:t,hex_colors:u.force_hex_style_colors,update_styles:!0,root_element:t.inline?t.getBody():null,collect:function(){return t.inline},schema:t.schema,contentCssCors:t.getParam("content_css_cors",!1,"boolean"),referrerPolicy:vl(t),onSetAttrib:function(e){t.fire("SetAttrib",e)}}),t.parser=((c=Lm(R2(a=t),a.schema)).addAttributeFilter("src,href,style,tabindex",function(e,t){for(var n,r,i=e.length,o=a.dom,s="data-mce-"+t;i--;)if((r=(n=e[i]).attr(t))&&!n.attr(s)){if(0===r.indexOf("data:")||0===r.indexOf("blob:"))continue;"style"===t?((r=o.serializeStyle(o.parseStyle(r),n.name)).length||(r=null),n.attr(s,r),n.attr(t,r)):"tabindex"===t?(n.attr(s,r),n.attr(t,null)):n.attr(s,a.convertURL(r,t,n.name))}}),c.addNodeFilter("script",function(e){for(var t=e.length;t--;){var n=e[t],r=n.attr("type")||"no/type";0!==r.indexOf("mce-")&&n.attr("type","mce-"+r)}}),a.settings.preserve_cdata&&c.addNodeFilter("#cdata",function(e){for(var t=e.length;t--;){var n=e[t];n.type=8,n.name="#comment",n.value="[CDATA["+a.dom.encode(n.value)+"]]"}}),c.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(e){for(var t=e.length,n=a.schema.getNonEmptyElements();t--;){var r=e[t];r.isEmpty(n)&&0===r.getAll("br").length&&(r.append(new Ph("br",1)).shortEnded=!0)}}),c),t.serializer=mm((e=t.settings,I(I({},R2(t)),T2({url_converter:e.url_converter,url_converter_scope:e.url_converter_scope,element_format:e.element_format,entities:e.entities,entity_encoding:e.entity_encoding,indent:e.indent,indent_after:e.indent_after,indent_before:e.indent_before,block_elements:e.block_elements,boolean_attributes:e.boolean_attributes,custom_elements:e.custom_elements,extended_valid_elements:e.extended_valid_elements,invalid_elements:e.invalid_elements,invalid_styles:e.invalid_styles,move_caret_before_on_enter_elements:e.move_caret_before_on_enter_elements,non_empty_elements:e.non_empty_elements,schema:e.schema,self_closing_elements:e.self_closing_elements,short_ended_elements:e.short_ended_elements,special:e.special,text_block_elements:e.text_block_elements,text_inline_elements:e.text_inline_elements,valid_children:e.valid_children,valid_classes:e.valid_classes,valid_elements:e.valid_elements,valid_styles:e.valid_styles,verify_html:e.verify_html,whitespace_elements:e.whitespace_elements}))),t),t.selection=ug(t.dom,t.getWin(),t.serializer,t),t.annotator=Ac(t),t.formatter=y0(t),t.undoManager=b0(t),t._nodeChangeDispatcher=new p2(t),t._selectionOverrides=w2(t),i=t,s=P(N.none()),l=P(!1),r=Na(function(e){i.fire("longpress",I(I({},e),{type:"longpress"})),l.set(!0)},400),i.on("touchstart",function(t){F1(t).each(function(e){r.cancel();e={x:e.clientX,y:e.clientY,target:t.target};r.throttle(t),l.set(!1),s.set(N.some(e))})},!0),i.on("touchmove",function(e){r.cancel(),F1(e).each(function(r){s.get().each(function(e){var t=r,n=Math.abs(t.clientX-e.x),t=Math.abs(t.clientY-e.y);(5<n||5<t)&&(s.set(N.none()),l.set(!1),i.fire("longpresscancel"))})})},!0),i.on("touchend touchcancel",function(t){r.cancel(),"touchcancel"!==t.type&&s.get().filter(function(e){return e.target.isEqualNode(t.target)}).each(function(){l.get()?t.preventDefault():i.fire("tap",I(I({},t),{type:"tap"}))})},!0),(n=d=t).on("click",function(e){n.dom.getParent(e.target,"details")&&e.preventDefault()}),(d=d).parser.addNodeFilter("details",function(e){ee(e,function(e){e.attr("data-mce-open",e.attr("open")),e.attr("open","open")})}),d.serializer.addNodeFilter("details",function(e){ee(e,function(e){var t=e.attr("data-mce-open");e.attr("open",ge(t)?t:null),e.attr("data-mce-open",null)})}),ig(t)||(o=t).on("click",function(e){var t,n,r,i;3<=e.detail&&(n=(e=o).selection.getRng(),r=y.fromRangeStart(n),i=y.fromRangeEnd(n),y.isElementPosition(r)&&(t=r.container(),m2(t))&&Uc(t).each(function(e){return n.setStart(e.container(),e.offset())}),y.isElementPosition(i)&&(t=r.container(),m2(t))&&Vc(t).each(function(e){return n.setEnd(e.container(),e.offset())}),e.selection.setRng(qf(n)))});var h,f,p,g,c=ig(u=t)?P(null):Xy(u);g=c,(p=t).addCommand("delete",function(){var e,t=g;L1(e=p)||Q0(e,!1)||G0(e,!1)||T1(e,t,!1)||L0(e,!1)||Kf(e)||J0(e,!1)||x1(e,!1)||B0(e)||_1(e,!1)||(P1(e,"Delete"),R0(e))}),p.addCommand("forwardDelete",function(){var e,t=g;Q0(e=p,!0)||G0(e,!0)||T1(e,t,!0)||L0(e,!0)||Kf(e)||J0(e,!0)||x1(e,!0)||B0(e)||_1(e,!0)||P1(e,"ForwardDelete")}),eu(e=t)&&e.on("NodeChange",w(H1,e)),w0(t),t.fire("PreInit"),We((f=h=t).plugins,"rtc").fold(function(){return f.rtcInstance=sm(h),N.none()},function(e){return N.some(e.setup().then(function(e){return f.rtcInstance=rg(h,e),e.isRemote}))}).fold(function(){_2(t,!1)},function(e){t.setProgressState(!0),e.then(function(e){t.setProgressState(!1),_2(t,e)})})}function x2(e,t){var n,r,i,o,s,a=e.editorManager.translate("Rich Text Area. Press ALT-0 for help."),l=(o=e.id,a=a,t.height,i=e.getParam("iframe_attrs",{}),r=q.fromTag("iframe"),Lt(r,i),Lt(r,{id:o+"_ifr",frameBorder:"0",allowTransparency:"true",title:a}),sa(r,"tox-edit-area__iframe"),r.dom),a=(l.onload=function(){l.onload=null,e.fire("load")},n=e,i=l,!(document.domain===window.location.hostname||!K.browser.isIE()||(o=h0("mce"),n[o]=function(){N2(n)},o='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinymce.get("'+n.id+'");document.write(ed.iframeHTML);document.close();ed.'+o+"(true);})()",G2.setAttrib(i,"src",o),0)));return e.contentAreaContainer=t.iframeContainer,e.iframeElement=l,e.iframeHTML=(i=(r=e).getParam("doctype","<!DOCTYPE html>")+"<html><head>",r.getParam("document_base_url","")!==r.documentBaseUrl&&(i+='<base href="'+r.documentBaseURI.getURI()+'" />'),i+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',o=fl(r,"body_id","tinymce"),s=fl(r,"body_class",""),pl(r)&&(i+='<meta http-equiv="Content-Security-Policy" content="'+pl(r)+'" />'),i+('</head><body id="'+o+'" class="mce-content-body '+s+'" data-id="'+r.id)+'"><br></body></html>'),G2.add(t.iframeContainer,l),a}function O2(t,n,r){var i=l0.get(r),o=l0.urls[r]||t.documentBaseUrl.replace(/\/$/,"");if(r=te.trim(r),i&&-1===te.inArray(n,r)&&(te.each(l0.dependencies(r),function(e){O2(t,n,e)}),!t.plugins[r]))try{var s=new i(t,o,t.$);(t.plugins[r]=s).init&&(s.init(t,o),n.push(r))}catch(e){i=t,s=r,o=e;s=na.translate(["Failed to initialize plugin: {0}",s]),a0(s,o),i0(i,s)}}function I2(e){return e.replace(/^\-/,"")}function M2(e){return{editorContainer:e,iframeContainer:e,api:{}}}function k2(e){var t,n,r=e.getElement();return e.orgDisplay=r.style.display,ge(nu(e))?e.theme.renderUI():Se(nu(e))?(n=(r=e).getElement(),(t=nu(r)(r,n)).editorContainer.nodeType&&(t.editorContainer.id=t.editorContainer.id||r.id+"_parent"),t.iframeContainer&&t.iframeContainer.nodeType&&(t.iframeContainer.id=t.iframeContainer.id||r.id+"_iframecontainer"),t.height=t.iframeHeight||n.offsetHeight,t):(n=(r=e).getElement(),r.inline?M2(null):(r=n,n=Y2.create("div"),Y2.insertAfter(n,r),M2(n)))}function D2(t,e,n){return N.from(e).filter(function(e){return 0<e.length&&!Km.has(e)}).map(function(e){return{url:t.editorManager.baseURL+"/icons/"+e+"/icons"+n+".js",name:N.some(e)}})}function L2(t){var n,e,r,o,s,i,a,l,u,c,d,h=t.id;function f(){K2.unbind(window,"ready",f),t.render()}na.setCode(bl(t)),co.Event.domLoaded?t.getElement()&&K.contentEditable&&(n=q.fromDom(t.getElement()),e=W(n.dom.attributes,function(e,t){return e[t.name]=t.value,e},{}),t.on("remove",function(){U(n.dom.attributes,function(e){Pt(n,e.name)}),Lt(n,e)}),t.ui.styleSheetLoader=Dr.forElement(n,{contentCssCors:(u=t).getParam("content_css_cors"),referrerPolicy:vl(u)}),t.getParam("inline")?t.inline=!0:(t.orgVisibility=t.getElement().style.visibility,t.getElement().style.visibility="hidden"),(r=t.getElement().form||K2.getParent(h,"form"))&&(t.formElement=r,t.getParam("hidden_input")&&!Un(t.getElement())&&(K2.insertAfter(K2.create("input",{type:"hidden",name:h}),h),t.hasHiddenInput=!0),t.formEventDelegate=function(e){t.fire(e.type,e)},K2.bind(r,"submit reset",t.formEventDelegate),t.on("reset",function(){t.resetContent()}),!t.getParam("submit_patch")||r.submit.nodeType||r.submit.length||r._mceOldSubmit||(r._mceOldSubmit=r.submit,r.submit=function(){return t.editorManager.triggerSave(),t.setDirty(!1),r._mceOldSubmit(r)})),t.windowManager=n0(t),t.notificationManager=t0(t),"xml"===t.getParam("encoding")&&t.on("GetContent",function(e){e.save&&(e.content=K2.encode(e.content))}),t.getParam("add_form_submit_trigger")&&t.on("submit",function(){t.initialized&&t.save()}),t.getParam("add_unload_trigger")&&(t._beforeUnload=function(){!t.initialized||t.destroyed||t.isHidden()||t.save({format:"raw",no_events:!0,set_dirty:!1})},t.editorManager.on("BeforeUnload",t._beforeUnload)),t.editorManager.add(t),s=(o=t).suffix,l=Zs.ScriptLoader,u=l,h=s,c=function(){var r,i;Z2(l,o),Q2(l,o,s),r=o,i=s,te.each(r.getParam("external_plugins"),function(e,t){l0.load(t,e,Y,void 0,function(){c0(r,e,t)}),r.settings.plugins+=" "+t}),te.each(ru(r).split(/[ ,]/),function(e){var t,n;(e=te.trim(e))&&!l0.urls[e]&&(q2(e)?(e=e.substr(1,e.length),t=l0.dependencies(e),te.each(t,function(e){var t=l0.createUrl({prefix:"plugins/",resource:e,suffix:"/plugin"+i+".js"},e);l0.load(t.resource,t,Y,void 0,function(){c0(r,t.prefix+t.resource+t.suffix,t.resource)})})):(n={prefix:"plugins/",resource:e,suffix:"/plugin"+i+".js"},l0.load(e,n,Y,void 0,function(){c0(r,n.prefix+n.resource+n.suffix,e)})))}),l.loadQueue(function(){o.removed||X2(o)},o,function(){o.removed||X2(o)})},d=nu(i=o),ge(d)?(q2(d)||u0.urls.hasOwnProperty(d)||((a=i.getParam("theme_url"))?u0.load(d,i.documentBaseURI.toAbsolute(a)):u0.load(d,"themes/"+d+"/theme"+h+".js")),u.loadQueue(function(){u0.waitFor(d,c)})):c()):K2.bind(window,"ready",f)}function P2(o){return function(i,e){return N.from(e).map(q.fromDom).filter(pn).bind(function(e){return n=o,t=i,r=e.dom,Ih(q.fromDom(r),function(e){return Qn(t=e,n).orThunk(function(){return"font"===Z(t)?We(J2,n).bind(function(e){return Kn(t,e)}):N.none()});var t},function(e){return M(q.fromDom(t),e)}).or((r=e.dom,N.from(L.DOM.getStyle(r,o,!0))));var n,t,r}).getOr("")}}function F2(e){return Uc(e.getBody()).map(function(e){e=e.container();return A(e)?e.parentNode:e})}function B2(e,t){return n=e,N.from(n.selection.getRng()).bind(function(e){var t=n.getBody();return e.startContainer===t&&0===e.startOffset?N.none():N.from(n.selection.getStart(!0))}).orThunk(w(F2,e)).map(q.fromDom).filter(pn).map(t);var n}function H2(e,t){var n,r;return/^[0-9.]+$/.test(t)&&1<=(n=parseInt(t,10))&&n<=7?(r=te.explode(e.getParam("font_size_style_values","xx-small,x-small,small,medium,large,x-large,xx-large")),(e=te.explode(e.getParam("font_size_classes","")))?e[n-1]||t:r[n-1]||t):t}var U2=D,V2=zn,W2=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},$2=zn,j2=D,z2=L.DOM,G2=L.DOM,Y2=L.DOM,X2=function(e){var n,r,t,i;e.fire("ScriptsLoaded"),n=e,f=te.trim(yl(n)),r=n.ui.registry.getAll().icons,f=I(I({},Km.get("default").icons),Km.get(f).icons),X(f,function(e,t){$e(r,t)||n.ui.registry.addIcon(t,e)}),l=nu(f=e),ge(l)?(f.settings.theme=I2(l),o=u0.get(l),f.theme=new o(f,u0.urls[l]),f.theme.init&&f.theme.init(f,u0.urls[l]||f.documentBaseUrl.replace(/\/$/,""),f.$)):f.theme={},i=[],te.each(ru(t=e).split(/[ ,]/),function(e){O2(t,i,I2(e))});var o=k2(e),s=e,a=N.from(o.api).getOr({}),l={show:N.from(a.show).getOr(Y),hide:N.from(a.hide).getOr(Y),disable:N.from(a.disable).getOr(Y),isDisabled:N.from(a.isDisabled).getOr(m),enable:function(){s.mode.isReadOnly()||N.from(a.enable).map(v)}};s.ui=I(I({},s.ui),l);var u,c,d,h,f={editorContainer:o.editorContainer,iframeContainer:o.iframeContainer};return e.editorContainer=f.editorContainer||null,(l=e).contentCSS=l.contentCSS.concat((l=(o=u=l).getParam("content_css"),l=ge(l)?x(l.split(","),Jt):ye(l)?l:!1===l||o.inline?[]:["default"],c=u.editorManager.baseURL+"/skins/content",d="content"+u.editorManager.suffix+".css",h=!0===u.inline,x(l,function(e){return/^[a-z0-9\-]+$/i.test(e)&&!h?c+"/"+e+"/"+d:u.documentBaseURI.toAbsolute(e)}))),e.inline?N2(e):(f=x2(l=e,e=f),e.editorContainer&&(G2.get(e.editorContainer).style.display=l.orgDisplay,l.hidden=G2.isHidden(e.editorContainer)),l.getElement().style.display="none",G2.setAttrib(l.id,"aria-hidden","true"),void(f||N2(l)))},K2=L.DOM,q2=function(e){return"-"===e.charAt(0)},Z2=function(e,t){var n,r=bl(t),i=t.getParam("language_url","","string");!1===na.hasCode(r)&&"en"!==r&&(n=""!==i?i:t.editorManager.baseURL+"/langs/"+r+".js",e.add(n,Y,void 0,function(){o0(t,"LanguageLoadError",s0("language",n,r))}))},Q2=function(e,i,t){var t=D2(i,"default",t),n=N.from(i.getParam("icons_url","","string")).filter(function(e){return 0<e.length}).map(function(e){return{url:e,name:N.none()}}).orThunk(function(){return D2(i,yl(i),"")});ee(function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t}([t,n]),function(r){e.add(r.url,Y,void 0,function(){var e=i,t=r.url,n=r.name.getOrUndefined();o0(e,"IconsLoadError",s0("icons",t,n))})})},J2={"font-size":"size","font-family":"face"},eb=P2("font-size"),tb=u(function(e){return e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,",")},P2("font-family")),nb=te.each,rb=te.map,ib=te.inArray,ob=(sb.prototype.execCommand=function(t,n,r,e){var i,o,s=!1,a=this;if(!a.editor.removed){if(/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(t)||e&&e.skip_focus?(o=a.editor,Hd(o).each(function(e){return o.selection.setRng(e)})):a.editor.focus(),(e=a.editor.fire("BeforeExecCommand",{command:t,ui:n,value:r})).isDefaultPrevented())return!1;e=t.toLowerCase();if(i=a.commands.exec[e])return i(e,n,r),a.editor.fire("ExecCommand",{command:t,ui:n,value:r}),!0;if(nb(this.editor.plugins,function(e){if(e.execCommand&&e.execCommand(t,n,r))return a.editor.fire("ExecCommand",{command:t,ui:n,value:r}),!(s=!0)}),s)return s;if(a.editor.theme&&a.editor.theme.execCommand&&a.editor.theme.execCommand(t,n,r))return a.editor.fire("ExecCommand",{command:t,ui:n,value:r}),!0;try{s=a.editor.getDoc().execCommand(t,n,r)}catch(e){}return!!s&&(a.editor.fire("ExecCommand",{command:t,ui:n,value:r}),!0)}},sb.prototype.queryCommandState=function(e){var t;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(e=e.toLowerCase(),t=this.commands.state[e])return t(e);try{return this.editor.getDoc().queryCommandState(e)}catch(e){}return!1}},sb.prototype.queryCommandValue=function(e){var t;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(e=e.toLowerCase(),t=this.commands.value[e])return t(e);try{return this.editor.getDoc().queryCommandValue(e)}catch(e){}}},sb.prototype.addCommands=function(e,n){void 0===n&&(n="exec");var r=this;nb(e,function(t,e){nb(e.toLowerCase().split(","),function(e){r.commands[n][e]=t})})},sb.prototype.addCommand=function(e,i,o){var s=this;e=e.toLowerCase(),this.commands.exec[e]=function(e,t,n,r){return i.call(o||s.editor,t,n,r)}},sb.prototype.queryCommandSupported=function(e){if(e=e.toLowerCase(),this.commands.exec[e])return!0;try{return this.editor.getDoc().queryCommandSupported(e)}catch(e){}return!1},sb.prototype.addQueryStateHandler=function(e,t,n){var r=this;e=e.toLowerCase(),this.commands.state[e]=function(){return t.call(n||r.editor)}},sb.prototype.addQueryValueHandler=function(e,t,n){var r=this;e=e.toLowerCase(),this.commands.value[e]=function(){return t.call(n||r.editor)}},sb.prototype.hasCustomCommand=function(e){return e=e.toLowerCase(),!!this.commands.exec[e]},sb.prototype.execNativeCommand=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=null),this.editor.getDoc().execCommand(e,t,n)},sb.prototype.isFormatMatch=function(e){return this.editor.formatter.match(e)},sb.prototype.toggleFormat=function(e,t){this.editor.formatter.toggle(e,t?{value:t}:void 0),this.editor.nodeChanged()},sb.prototype.storeSelection=function(e){this.selectionBookmark=this.editor.selection.getBookmark(e)},sb.prototype.restoreSelection=function(){this.editor.selection.moveToBookmark(this.selectionBookmark)},sb.prototype.setupCommands=function(o){function e(t){return function(){var e=o.selection,e=e.isCollapsed()?[o.dom.getParent(e.getNode(),o.dom.isBlock)]:e.getSelectedBlocks(),e=rb(e,function(e){return!!o.formatter.matchNode(e,t)});return-1!==ib(e,!0)}}var r=this;this.addCommands({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){o.undoManager.add()},"Cut,Copy,Paste":function(e){var t,n=o.getDoc();try{r.execNativeCommand(e)}catch(e){t=!0}!(t="paste"!==e||n.queryCommandEnabled(e)?t:!0)&&n.queryCommandSupported(e)||(t=o.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead."),K.mac&&(t=t.replace(/Ctrl\+/g,"⌘+")),o.notificationManager.open({text:t,type:"error"}))},unlink:function(){var e;o.selection.isCollapsed()?(e=o.dom.getParent(o.selection.getStart(),"a"))&&o.dom.remove(e,!0):o.formatter.remove("link")},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone":function(e){var t=e.substring(7);"full"===t&&(t="justify"),nb("left,center,right,justify".split(","),function(e){t!==e&&o.formatter.remove("align"+e)}),"none"!==t&&r.toggleFormat("align"+t)},"InsertUnorderedList,InsertOrderedList":function(e){r.execNativeCommand(e);var t,e=o.dom.getParent(o.selection.getNode(),"ol,ul");e&&(t=e.parentNode,/^(H[1-6]|P|ADDRESS|PRE)$/.test(t.nodeName))&&(r.storeSelection(),o.dom.split(t,e),r.restoreSelection())},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){r.toggleFormat(e)},"ForeColor,HiliteColor":function(e,t,n){r.toggleFormat(e,n)},FontName:function(e,t,n){var r;n=H2(r=o,n=n),r.formatter.toggle("fontname",{value:(n=n.split(/\s*,\s*/),x(n,function(e){return-1===e.indexOf(" ")||Qe(e,'"')||Qe(e,"'")?e:"'"+e+"'"}).join(","))}),r.nodeChanged()},FontSize:function(e,t,n){var r;(r=o).formatter.toggle("fontsize",{value:H2(r,n)}),r.nodeChanged()},LineHeight:function(e,t,n){var r,i=n;(r=o).undoManager.transact(function(){r.formatter.toggle("lineheight",{value:String(i)}),r.nodeChanged()})},RemoveFormat:function(e){o.formatter.remove(e)},mceBlockQuote:function(){r.toggleFormat("blockquote")},FormatBlock:function(e,t,n){return r.toggleFormat(n||"p")},mceCleanup:function(){var e=o.selection.getBookmark();o.setContent(o.getContent()),o.selection.moveToBookmark(e)},mceRemoveNode:function(e,t,n){n=n||o.selection.getNode();n!==o.getBody()&&(r.storeSelection(),o.dom.remove(n,!0),r.restoreSelection())},mceSelectNodeDepth:function(e,t,n){var r=0;o.dom.getParent(o.selection.getNode(),function(e){if(1===e.nodeType&&r++===n)return o.selection.select(e),!1},o.getBody())},mceSelectNode:function(e,t,n){o.selection.select(n)},mceInsertContent:function(e,t,n){var r,i;r=o,n=(i="string"!=typeof(n=n=n)?(i=te.extend({paste:n.paste,data:{paste:n.paste}},n),{content:n.content,details:i}):{content:n,details:{}}).content,i=i.details,og(r).editor.insertContent(n,i)},mceInsertRawHTML:function(e,t,n){o.selection.setContent("tiny_mce_marker");var r=o.getContent();o.setContent(r.replace(/tiny_mce_marker/g,function(){return n}))},mceInsertNewLine:function(e,t,n){jy(o,n)},mceToggleFormat:function(e,t,n){r.toggleFormat(n)},mceSetContent:function(e,t,n){o.setContent(n)},"Indent,Outdent":function(e){D1(o,e)},mceRepaint:function(){},InsertHorizontalRule:function(){o.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){o.hasVisual=!o.hasVisual,o.addVisual()},mceReplaceContent:function(e,t,n){o.execCommand("mceInsertContent",!1,n.replace(/\{\$selection\}/g,o.selection.getContent({format:"text"})))},mceInsertLink:function(e,t,n){"string"==typeof n&&(n={href:n});var r=o.dom.getParent(o.selection.getNode(),"a");n.href=n.href.replace(/ /g,"%20"),r&&n.href||o.formatter.remove("link"),n.href&&o.formatter.apply("link",n,r)},selectAll:function(){var e,t=o.dom.getParent(o.selection.getStart(),zn);t&&((e=o.dom.createRng()).selectNodeContents(t),o.selection.setRng(e))},mceNewDocument:function(){o.setContent("")},InsertLineBreak:function(e,t,n){return Wy(o,n),!0}});r.addCommands({JustifyLeft:e("alignleft"),JustifyCenter:e("aligncenter"),JustifyRight:e("alignright"),JustifyFull:e("alignjustify"),"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){return r.isFormatMatch(e)},mceBlockQuote:function(){return r.isFormatMatch("blockquote")},Outdent:function(){return M1(o)},"InsertUnorderedList,InsertOrderedList":function(e){var t=o.dom.getParent(o.selection.getNode(),"ul,ol");return t&&("insertunorderedlist"===e&&"UL"===t.tagName||"insertorderedlist"===e&&"OL"===t.tagName)}},"state"),r.addCommands({Undo:function(){o.undoManager.undo()},Redo:function(){o.undoManager.redo()}}),r.addQueryValueHandler("FontName",function(){return B2(t=o,function(e){return tb(t.getBody(),e.dom)}).getOr("");var t},this),r.addQueryValueHandler("FontSize",function(){return B2(t=o,function(e){return eb(t.getBody(),e.dom)}).getOr("");var t},this),r.addQueryValueHandler("LineHeight",function(){return B2(t=o,function(n){var e=q.fromDom(t.getBody());return Ih(n,function(e){return Qn(e,"line-height")},w(M,e)).getOrThunk(function(){var e=parseFloat(qn(n,"line-height")),t=parseFloat(qn(n,"font-size"));return String(e/t)})}).getOr("");var t},this)},sb);function sb(e){this.commands={state:{},exec:{},value:{}},this.editor=e,this.setupCommands(e)}function ab(e,t,n){var r,i,o,s;aa(e,t)&&!1===n?(o=t,oa(r=e)?r.dom.classList.remove(o):(s=o=o,0<(i=O(ia(o=i=r,"class"),function(e){return e!==s})).length?Dt(o,"class",i.join(" ")):Pt(o,"class")),0===(oa(i=r)?i.dom.classList:ia(i,"class")).length&&Pt(i,"class")):n&&sa(e,t)}function lb(e,t,n){try{e.getDoc().execCommand(t,!1,String(n))}catch(e){}}function ub(e,t){e.dom.contentEditable=t?"true":"false"}function cb(e,t){var n,r=q.fromDom(e.getBody());ab(r,"mce-content-readonly",t),t?(e.selection.controlSelection.hideResizeRect(),e._selectionOverrides.hideFakeCaret(),N.from(e.selection.getNode()).each(function(e){e.removeAttribute("data-mce-selected")}),e.readonly=!0,ub(r,!1),ee(la(r,'*[contenteditable="true"]'),function(e){Dt(e,db,"true"),ub(e,!1)})):(e.readonly=!1,ub(r,!0),ee(la(r,"*["+db+'="true"]'),function(e){Pt(e,db),ub(e,!0)}),lb(e,"StyleWithCSS",!1),lb(e,"enableInlineTableEditing",!1),lb(e,"enableObjectResizing",!1),(zd(t=e)||(n=t,kd().filter(function(e){return!(void 0!==(t=e.dom.classList)&&(t.contains("tox-edit-area")||t.contains("tox-edit-area__iframe")||t.contains("mce-content-body")))&&Ud(n,e.dom);var t}).isSome()))&&e.focus(),e.selection.setRng(e.selection.getRng()),e.nodeChanged())}var db="data-mce-contenteditable",hb=function(e){return e.readonly},fb=function(t){t.parser.addAttributeFilter("contenteditable",function(e){hb(t)&&ee(e,function(e){e.attr(db,e.attr("contenteditable")),e.attr("contenteditable","false")})}),t.serializer.addAttributeFilter(db,function(e){hb(t)&&ee(e,function(e){e.attr("contenteditable",e.attr(db))})}),t.serializer.addTempAttr(db)},pb=function(n,r){var e,t;"click"!==r.type||H.metaKeyPressed(r)||(e=q.fromDom(r.target),t=n,br(e,"a",function(e){return M(e,q.fromDom(t.getBody()))}).bind(function(e){return Kn(e,"href")}).each(function(e){var t;r.preventDefault(),/^#/.test(e)?(t=n.dom.select(e+',[name="'+(Qe(t=e,"#")?t.substring("#".length):t)+'"]')).length&&n.selection.scrollIntoView(t[0],!0):window.open(e,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes")}))},gb=te.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," "),mb=(yb.isNative=function(e){return!!gb[e.toLowerCase()]},yb.prototype.fire=function(e,t){var n=e.toLowerCase(),r=t||{},i=(r.type=n,r.target||(r.target=this.scope),r.preventDefault||(r.preventDefault=function(){r.isDefaultPrevented=fe},r.stopPropagation=function(){r.isPropagationStopped=fe},r.stopImmediatePropagation=function(){r.isImmediatePropagationStopped=fe},r.isDefaultPrevented=m,r.isPropagationStopped=m,r.isImmediatePropagationStopped=m),this.settings.beforeFire&&this.settings.beforeFire(r),this.bindings[n]);if(i)for(var o=0,s=i.length;o<s;o++){var a=i[o];if(a.once&&this.off(n,a.func),r.isImmediatePropagationStopped())return r.stopPropagation(),r;if(!1===a.func.call(this.scope,r))return r.preventDefault(),r}return r},yb.prototype.on=function(e,t,n,r){if(t=!1===t?m:t){var i={func:t};r&&te.extend(i,r);for(var o=e.toLowerCase().split(" "),s=o.length;s--;){var a=o[s],l=this.bindings[a];l||(l=this.bindings[a]=[],this.toggleEvent(a,!0)),n?l.unshift(i):l.push(i)}}return this},yb.prototype.off=function(e,t){var n=this;if(e)for(var r=e.toLowerCase().split(" "),i=r.length;i--;){var o=r[i],s=this.bindings[o];if(!o)return X(this.bindings,function(e,t){n.toggleEvent(t,!1),delete n.bindings[t]}),this;if(s){if(t)for(var a=s.length;a--;)s[a].func===t&&(s=s.slice(0,a).concat(s.slice(a+1)),this.bindings[o]=s);else s.length=0;s.length||(this.toggleEvent(e,!1),delete this.bindings[o])}}else X(this.bindings,function(e,t){n.toggleEvent(t,!1)}),this.bindings={};return this},yb.prototype.once=function(e,t,n){return this.on(e,t,n,{once:!0})},yb.prototype.has=function(e){return e=e.toLowerCase(),!(!this.bindings[e]||0===this.bindings[e].length)},yb);function yb(e){this.bindings={},this.settings=e||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||m}function vb(n){return n._eventDispatcher||(n._eventDispatcher=new mb({scope:n,toggleEvent:function(e,t){mb.isNative(e)&&n.toggleNativeEvent&&n.toggleNativeEvent(e,t)}})),n._eventDispatcher}function bb(e,t){return"selectionchange"===t?e.getDoc():!e.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(t)?e.getDoc().documentElement:(t=tu(e))?(e.eventRoot||(e.eventRoot=Tb.select(t)[0]),e.eventRoot):e.getBody()}function Eb(e,t,n){e.hidden||hb(e)?hb(e)&&pb(e,n):e.fire(t,n)}function Cb(o,s){var e,t;o.delegates||(o.delegates={}),o.delegates[s]||o.removed||(t=bb(o,s),tu(o)?(Sb||(Sb={},o.editorManager.on("removeEditor",function(){o.editorManager.activeEditor||Sb&&(X(Sb,function(e,t){o.dom.unbind(bb(o,t))}),Sb=null)})),Sb[s]||(Sb[s]=e=function(e){for(var t=e.target,n=o.editorManager.get(),r=n.length;r--;){var i=n[r].getBody();i!==t&&!Tb.isChildOf(t,i)||Eb(n[r],s,e)}},Tb.bind(t,s,e))):(Tb.bind(t,s,e=function(e){Eb(o,s,e)}),o.delegates[s]=e))}function wb(o){var e,t,s=P("design"),a=P({design:{activate:Y,deactivate:Y,editorReadOnly:!1},readonly:{activate:Y,deactivate:Y,editorReadOnly:!0}});return(e=o).serializer?fb(e):e.on("PreInit",function(){fb(e)}),(t=o).on("ShowCaret",function(e){hb(t)&&e.preventDefault()}),t.on("ObjectSelected",function(e){hb(t)&&e.preventDefault()}),{isReadOnly:function(){return hb(o)},set:function(e){var t=o,n=a.get(),r=s,i=e;if(i!==r.get()){if(!$e(n,i))throw new Error("Editor mode '"+i+"' is invalid");t.initialized?_b(t,r,n,i):t.on("init",function(){return _b(t,r,n,i)})}},get:function(){return s.get()},register:function(e,t){a.set(function(e,t,n){if(xe(Ab,t))throw new Error("Cannot override default mode "+t);return I(I({},e),((e={})[t]=I(I({},n),{deactivate:function(){try{n.deactivate()}catch(e){console.error("problem while deactivating editor mode "+t+":",e)}}}),e))}(a.get(),e,t))}}}var Sb,ln={fire:function(e,t,n){if(this.removed&&"remove"!==e&&"detach"!==e)return t;var r=vb(this).fire(e,t);if(!1!==n&&this.parent)for(var i=this.parent();i&&!r.isPropagationStopped();)i.fire(e,r,!1),i=i.parent();return r},on:function(e,t,n){return vb(this).on(e,t,n)},off:function(e,t){return vb(this).off(e,t)},once:function(e,t){return vb(this).once(e,t)},hasEventListeners:function(e){return vb(this).has(e)}},Tb=L.DOM,Rb=I(I({},ln),{bindPendingEventDelegates:function(){var t=this;te.each(t._pendingNativeEvents,function(e){Cb(t,e)})},toggleNativeEvent:function(e,t){var n=this;"focus"!==e&&"blur"!==e&&(t?n.initialized?Cb(n,e):n._pendingNativeEvents?n._pendingNativeEvents.push(e):n._pendingNativeEvents=[e]:n.initialized&&(n.dom.unbind(bb(n,e),e,n.delegates[e]),delete n.delegates[e]))},unbindAllNativeEvents:function(){var n=this,e=n.getBody(),t=n.dom;n.delegates&&(X(n.delegates,function(e,t){n.dom.unbind(bb(n,t),t,e)}),delete n.delegates),!n.inline&&e&&t&&(e.onload=null,t.unbind(n.getWin()),t.unbind(n.getDoc())),t&&(t.unbind(e),t.unbind(n.getContainer()))}}),Ab=["design","readonly"],_b=function(e,t,n,r){var i=n[t.get()],n=n[r];try{n.activate()}catch(e){return void console.error("problem while activating editor mode "+r+":",e)}i.deactivate(),i.editorReadOnly!==n.editorReadOnly&&cb(e,n.editorReadOnly),t.set(r),e.fire("SwitchMode",{mode:r})},Nb=te.each,xb=te.explode,Ob={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},Ib=te.makeMap("alt,ctrl,shift,meta,access"),Mb=(kb.prototype.add=function(e,t,n,r){var i=this,o=i.normalizeCommandFunc(n);return Nb(xb(te.trim(e)),function(e){e=i.createShortcut(e,t,o,r);i.shortcuts[e.id]=e}),!0},kb.prototype.remove=function(e){e=this.createShortcut(e);return!!this.shortcuts[e.id]&&(delete this.shortcuts[e.id],!0)},kb.prototype.normalizeCommandFunc=function(e){var t=this,n=e;return"string"==typeof n?function(){t.editor.execCommand(n,!1,null)}:te.isArray(n)?function(){t.editor.execCommand(n[0],n[1],n[2])}:n},kb.prototype.parseShortcut=function(e){var t,n={},r=(Nb(xb(e.toLowerCase(),"+"),function(e){e in Ib?n[e]=!0:/^[0-9]{2,}$/.test(e)?n.keyCode=parseInt(e,10):(n.charCode=e.charCodeAt(0),n.keyCode=Ob[e]||e.toUpperCase().charCodeAt(0))}),[n.keyCode]);for(t in Ib)n[t]?r.push(t):n[t]=!1;return n.id=r.join(","),n.access&&(n.alt=!0,K.mac?n.ctrl=!0:n.shift=!0),n.meta&&(K.mac?n.meta=!0:(n.ctrl=!0,n.meta=!1)),n},kb.prototype.createShortcut=function(e,t,n,r){e=te.map(xb(e,">"),this.parseShortcut);return e[e.length-1]=te.extend(e[e.length-1],{func:n,scope:r||this.editor}),te.extend(e[0],{desc:this.editor.translate(t),subpatterns:e.slice(1)})},kb.prototype.hasModifier=function(e){return e.altKey||e.ctrlKey||e.metaKey},kb.prototype.isFunctionKey=function(e){return"keydown"===e.type&&112<=e.keyCode&&e.keyCode<=123},kb.prototype.matchShortcut=function(e,t){return!!t&&t.ctrl===e.ctrlKey&&t.meta===e.metaKey&&t.alt===e.altKey&&t.shift===e.shiftKey&&!!(e.keyCode===t.keyCode||e.charCode&&e.charCode===t.charCode)&&(e.preventDefault(),!0)},kb.prototype.executeShortcutAction=function(e){return e.func?e.func.call(e.scope):null},kb);function kb(e){this.shortcuts={},this.pendingPatterns=[],this.editor=e;var n=this;e.on("keyup keypress keydown",function(t){!n.hasModifier(t)&&!n.isFunctionKey(t)||t.isDefaultPrevented()||(Nb(n.shortcuts,function(e){if(n.matchShortcut(t,e))return n.pendingPatterns=e.subpatterns.slice(0),"keydown"===t.type&&n.executeShortcutAction(e),!0}),n.matchShortcut(t,n.pendingPatterns[0])&&(1===n.pendingPatterns.length&&"keydown"===t.type&&n.executeShortcutAction(n.pendingPatterns[0]),n.pendingPatterns.shift()))})}var Db=te.each,Lb=te.trim,Pb="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),Fb={ftp:21,http:80,https:443,mailto:25},Bb=(Hb.parseDataUri=function(e){var t,e=decodeURIComponent(e).split(","),n=/data:([^;]+)/.exec(e[0]);return{type:t=n?n[1]:t,data:e[1]}},Hb.getDocumentBaseUrl=function(e){e=0!==e.protocol.indexOf("http")&&"file:"!==e.protocol?e.href:e.protocol+"//"+e.host+e.pathname;return/^[^:]+:\/\/\/?[^\/]+\//.test(e)&&(e=e.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(e)||(e+="/")),e},Hb.prototype.setPath=function(e){e=/^(.*?)\/?(\w+)?$/.exec(e);this.path=e[0],this.directory=e[1],this.file=e[2],this.source="",this.getURI()},Hb.prototype.toRelative=function(e){var t,n;return"./"===e?e:"mce_host"!==(e=new Hb(e,{base_uri:this})).host&&this.host!==e.host&&e.host||this.port!==e.port||this.protocol!==e.protocol&&""!==e.protocol?e.getURI():(t=this.getURI())===(n=e.getURI())||"/"===t.charAt(t.length-1)&&t.substr(0,t.length-1)===n?t:(n=this.toRelPath(this.path,e.path),e.query&&(n+="?"+e.query),e.anchor&&(n+="#"+e.anchor),n)},Hb.prototype.toAbsolute=function(e,t){e=new Hb(e,{base_uri:this});return e.getURI(t&&this.isSameOrigin(e))},Hb.prototype.isSameOrigin=function(e){if(this.host==e.host&&this.protocol==e.protocol){if(this.port==e.port)return!0;var t=Fb[this.protocol];if(t&&(this.port||t)==(e.port||t))return!0}return!1},Hb.prototype.toRelPath=function(e,t){var n,r,i=0,o="",s=e.substring(0,e.lastIndexOf("/")).split("/"),a=t.split("/");if(s.length>=a.length)for(n=0,r=s.length;n<r;n++)if(n>=a.length||s[n]!==a[n]){i=n+1;break}if(s.length<a.length)for(n=0,r=a.length;n<r;n++)if(n>=s.length||s[n]!==a[n]){i=n+1;break}if(1===i)return t;for(n=0,r=s.length-(i-1);n<r;n++)o+="../";for(n=i-1,r=a.length;n<r;n++)o+=n!==i-1?"/"+a[n]:a[n];return o},Hb.prototype.toAbsPath=function(e,t){var n,r=0,i=[],o=/\/$/.test(t)?"/":"",e=e.split("/"),s=t.split("/");for(Db(e,function(e){e&&i.push(e)}),e=i,n=s.length-1,i=[];0<=n;n--)0!==s[n].length&&"."!==s[n]&&(".."!==s[n]?0<r?r--:i.push(s[n]):r++);return 0!==(t=(n=e.length-r)<=0?De(i).join("/"):e.slice(0,n).join("/")+"/"+De(i).join("/")).indexOf("/")&&(t="/"+t),o&&t.lastIndexOf("/")!==t.length-1&&(t+=o),t},Hb.prototype.getURI=function(e){var t;return void 0===e&&(e=!1),this.source&&!e||(t="",e||(this.protocol?t+=this.protocol+"://":t+="//",this.userInfo&&(t+=this.userInfo+"@"),this.host&&(t+=this.host),this.port&&(t+=":"+this.port)),this.path&&(t+=this.path),this.query&&(t+="?"+this.query),this.anchor&&(t+="#"+this.anchor),this.source=t),this.source},Hb);function Hb(e,t){e=Lb(e),this.settings=t||{};var n,r,i,o,t=this.settings.base_uri,s=this;/^([\w\-]+):([^\/]{2})/i.test(e)||/^\s*#/.test(e)?s.source=e:(n=0===e.indexOf("//"),0!==e.indexOf("/")||n||(e=(t&&t.protocol||"http")+"://mce_host"+e),/^[\w\-]*:?\/\//.test(e)||(r=this.settings.base_uri?this.settings.base_uri.path:new Hb(document.location.href).directory,e=this.settings.base_uri&&""==this.settings.base_uri.protocol?"//mce_host"+s.toAbsPath(r,e):(i=/([^#?]*)([#?]?.*)/.exec(e),(t&&t.protocol||"http")+"://mce_host"+s.toAbsPath(r,i[1])+i[2])),e=e.replace(/@@/g,"(mce_at)"),o=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(e),Db(Pb,function(e,t){t=(t=o[t])&&t.replace(/\(mce_at\)/g,"@@");s[e]=t}),t&&(s.protocol||(s.protocol=t.protocol),s.userInfo||(s.userInfo=t.userInfo),s.port||"mce_host"!==s.host||(s.port=t.port),s.host&&"mce_host"!==s.host||(s.host=t.host),s.source=""),n&&(s.protocol=""))}var Ub=L.DOM,Vb=te.extend,Wb=te.each,$b=te.resolve,jb=K.ie,zb=(i.prototype.render=function(){L2(this)},i.prototype.focus=function(e){this.removed||(e?xh:function(t){var e=t.selection,n=t.getBody(),r=e.getRng();t.quirks.refreshContentEditable(),void 0!==t.bookmark&&!1===zd(t)&&Hd(t).each(function(e){t.selection.setRng(e),r=e});i=t,e=e.getNode();var i,e=i.dom.getParent(e,function(e){return"true"===i.dom.getContentEditable(e)});t.$.contains(n,e)?(jd(e),$d(t,r)):(t.inline||(K.opera||jd(n),t.getWin().focus()),(K.gecko||t.inline)&&(jd(n),$d(t,r))),xh(t)})(this)},i.prototype.hasFocus=function(){return zd(this)},i.prototype.execCallback=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r,i=this.settings[e];if(i)return this.callbackLookup&&(r=this.callbackLookup[e])&&(i=r.func,r=r.scope),"string"==typeof i&&(r=(r=i.replace(/\.\w+$/,""))?$b(r):0,i=$b(i),this.callbackLookup=this.callbackLookup||{},this.callbackLookup[e]={func:i,scope:r}),i.apply(r||this,t)},i.prototype.translate=function(e){return na.translate(e)},i.prototype.getParam=function(e,t,n){return t=t,n=n,a=(e=e)in(r=this).settings?r.settings[e]:t,"hash"===n?(s={},"string"==typeof(o=a)?ee(0<o.indexOf("=")?o.split(/[;,](?![^=;,]*(?:[;,]|$))/):o.split(","),function(e){e=e.split("=");1<e.length?s[te.trim(e[0])]=te.trim(e[1]):s[te.trim(e[0])]=te.trim(e[0])}):s=o,s):"string"===n?wm(ge,r,e).getOr(t):"number"===n?wm(Te,r,e).getOr(t):"boolean"===n?wm(be,r,e).getOr(t):"object"===n?wm(me,r,e).getOr(t):"array"===n?wm(ye,r,e).getOr(t):"string[]"===n?wm((i=ge,function(e){return ye(e)&&$(e,i)}),r,e).getOr(t):"function"===n?wm(Se,r,e).getOr(t):a;var r,i,o,s,a},i.prototype.hasPlugin=function(e,t){return!(!xe(ru(this).split(/[ ,]/),e)||t&&void 0===l0.get(e))},i.prototype.nodeChanged=function(e){this._nodeChangeDispatcher.nodeChanged(e)},i.prototype.addCommand=function(e,t,n){this.editorCommands.addCommand(e,t,n)},i.prototype.addQueryStateHandler=function(e,t,n){this.editorCommands.addQueryStateHandler(e,t,n)},i.prototype.addQueryValueHandler=function(e,t,n){this.editorCommands.addQueryValueHandler(e,t,n)},i.prototype.addShortcut=function(e,t,n,r){this.shortcuts.add(e,t,n,r)},i.prototype.execCommand=function(e,t,n,r){return this.editorCommands.execCommand(e,t,n,r)},i.prototype.queryCommandState=function(e){return this.editorCommands.queryCommandState(e)},i.prototype.queryCommandValue=function(e){return this.editorCommands.queryCommandValue(e)},i.prototype.queryCommandSupported=function(e){return this.editorCommands.queryCommandSupported(e)},i.prototype.show=function(){this.hidden&&(this.hidden=!1,this.inline?this.getBody().contentEditable="true":(Ub.show(this.getContainer()),Ub.hide(this.id)),this.load(),this.fire("show"))},i.prototype.hide=function(){var e=this,t=e.getDoc();e.hidden||(jb&&t&&!e.inline&&t.execCommand("SelectAll"),e.save(),e.inline?(e.getBody().contentEditable="false",e===e.editorManager.focusedEditor&&(e.editorManager.focusedEditor=null)):(Ub.hide(e.getContainer()),Ub.setStyle(e.id,"display",e.orgDisplay)),e.hidden=!0,e.fire("hide"))},i.prototype.isHidden=function(){return!!this.hidden},i.prototype.setProgressState=function(e,t){this.fire("ProgressState",{state:e,time:t})},i.prototype.load=function(e){var t,n=this.getElement();return this.removed?"":n?((e=e||{}).load=!0,t=Un(n)?n.value:n.innerHTML,t=this.setContent(t,e),e.element=n,e.no_events||this.fire("LoadContent",e),e.element=null,t):void 0},i.prototype.save=function(e){var t,n,r=this,i=r.getElement();if(i&&r.initialized&&!r.removed)return(e=e||{}).save=!0,e.element=i,e.content=r.getContent(e),e.no_events||r.fire("SaveContent",e),"raw"===e.format&&r.fire("RawSaveContent",e),t=e.content,Un(i)?i.value=t:(!e.is_removing&&r.inline||(i.innerHTML=t),(n=Ub.getParent(r.id,"form"))&&Wb(n.elements,function(e){if(e.name===r.id)return e.value=t,!1})),e.element=i=null,!1!==e.set_dirty&&r.setDirty(!1),t},i.prototype.setContent=function(e,t){return ym(this,e,t)},i.prototype.getContent=function(e){return t=this,n=e=void 0===(e=e)?{}:e,e=e.format||"html",og(t).editor.getContent(n,e);var t,n},i.prototype.insertContent=function(e,t){t&&(e=Vb({content:e},t)),this.execCommand("mceInsertContent",!1,e)},i.prototype.resetContent=function(e){void 0===e?ym(this,this.startContent,{format:"raw"}):ym(this,e),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()},i.prototype.isDirty=function(){return!this.isNotDirty},i.prototype.setDirty=function(e){var t=!this.isNotDirty;this.isNotDirty=!e,e&&e!==t&&this.fire("dirty")},i.prototype.getContainer=function(){return this.container||(this.container=Ub.get(this.editorContainer||this.id+"_parent")),this.container},i.prototype.getContentAreaContainer=function(){return this.contentAreaContainer},i.prototype.getElement=function(){return this.targetElm||(this.targetElm=Ub.get(this.id)),this.targetElm},i.prototype.getWin=function(){var e;return this.contentWindow||(e=this.iframeElement)&&(this.contentWindow=e.contentWindow),this.contentWindow},i.prototype.getDoc=function(){var e;return this.contentDocument||(e=this.getWin())&&(this.contentDocument=e.document),this.contentDocument},i.prototype.getBody=function(){var e=this.getDoc();return this.bodyElement||(e?e.body:null)},i.prototype.convertURL=function(e,t,n){var r=this.settings;return r.urlconverter_callback?this.execCallback("urlconverter_callback",e,n,!0,t):!r.convert_urls||n&&"LINK"===n.nodeName||0===e.indexOf("file:")||0===e.length?e:r.relative_urls?this.documentBaseURI.toRelative(e):this.documentBaseURI.toAbsolute(e,r.remove_script_host)},i.prototype.addVisual=function(e){e=e=e,C(this).editor.addVisual(e)},i.prototype.remove=function(){var e,t,n,r,i;(e=this).removed||(t=e._selectionOverrides,n=e.editorUpload,r=e.getBody(),i=e.getElement(),r&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&i&&Hm.remove(i.nextSibling),e.fire("remove"),e.editorManager.remove(e),!e.inline&&r&&Hm.setStyle(e.id,"display",e.orgDisplay),e.fire("detach"),Hm.remove(e.getContainer()),vm(t),vm(n),e.destroy())},i.prototype.destroy=function(e){var t,n,r;e=e,n=(t=this).selection,r=t.dom,t.destroyed||(e||t.removed?(e||(t.editorManager.off("beforeunload",t._beforeUnload),t.theme&&t.theme.destroy&&t.theme.destroy(),vm(n),vm(r)),(n=(e=t).formElement)&&(n._mceOldSubmit&&(n.submit=n._mceOldSubmit,n._mceOldSubmit=null),Hm.unbind(n,"submit reset",e.formEventDelegate)),(r=t).contentAreaContainer=r.formElement=r.container=r.editorContainer=null,r.bodyElement=r.contentDocument=r.contentWindow=null,r.iframeElement=r.targetElm=null,r.selection&&(r.selection=r.selection.win=r.selection.dom=r.selection.dom.doc=null),t.destroyed=!0):t.remove())},i.prototype.uploadImages=function(e){return this.editorUpload.uploadImages(e)},i.prototype._scanForImages=function(){return this.editorUpload.scanForImages()},i.prototype.addButton=function(){throw new Error("editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead")},i.prototype.addSidebar=function(){throw new Error("editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead")},i.prototype.addMenuItem=function(){throw new Error("editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead")},i.prototype.addContextToolbar=function(){throw new Error("editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead")},i);function i(e,t,n){var r,i,o,s,a,l,u,c,d,h,f,p=this,g=(this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.editorManager=n,this.documentBaseUrl=n.documentBaseURL,Vb(this,Rb),this.settings=(g=e,d=(c=this).documentBaseUrl,h=n.defaultSettings,d=d,f=Wm,c=c,g={id:e,theme:"silver",toolbar_mode:Ym(t=t,"floating"),plugins:"",document_base_url:d,add_form_submit_trigger:!0,submit_patch:!0,add_unload_trigger:!0,convert_urls:!0,relative_urls:!0,remove_script_host:!0,object_resizing:!0,doctype:"<!DOCTYPE html>",visual:!0,font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:!0,inline_styles:!0,convert_fonts_to_spans:!0,indent:!0,indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",entity_encoding:"named",url_converter:c.convertURL,url_converter_scope:c},d=I(I({},g),f?Gm:{}),Xm($m||jm,$m,d,h,t)),this.settings.suffix&&(n.suffix=this.settings.suffix),this.suffix=n.suffix,this.settings.base_url&&n._setBaseUrl(this.settings.base_url),this.baseUri=n.baseURI,this.settings.referrer_policy&&(Zs.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy),L.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy)),Aa.languageLoad=this.settings.language_load,Aa.baseURL=n.baseURL,this.id=e,this.setDirty(!1),this.documentBaseURI=new Bb(this.settings.document_base_url,{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=!!this.settings.inline,this.shortcuts=new Mb(this),this.editorCommands=new ob(this),this.settings.cache_suffix&&(K.cacheSuffix=this.settings.cache_suffix.replace(/^[\?\&]+/,"")),this.ui={registry:(i={},o={},s={},a={},l={},u={},{addAutocompleter:(c={addButton:(c=function(n,r){return function(e,t){return n[e.toLowerCase()]=I(I({},t),{type:r})}})(r={},"button"),addGroupToolbarButton:c(r,"grouptoolbarbutton"),addToggleButton:c(r,"togglebutton"),addMenuButton:c(r,"menubutton"),addSplitButton:c(r,"splitbutton"),addMenuItem:c(i,"menuitem"),addNestedMenuItem:c(i,"nestedmenuitem"),addToggleMenuItem:c(i,"togglemenuitem"),addAutocompleter:c(o,"autocompleter"),addContextMenu:c(a,"contextmenu"),addContextToolbar:c(l,"contexttoolbar"),addContextForm:c(l,"contextform"),addSidebar:c(u,"sidebar"),addIcon:function(e,t){return s[e.toLowerCase()]=t},getAll:function(){return{buttons:r,menuItems:i,icons:s,popups:o,contextMenus:a,contextToolbars:l,sidebars:u}}}).addAutocompleter,addButton:c.addButton,addContextForm:c.addContextForm,addContextMenu:c.addContextMenu,addContextToolbar:c.addContextToolbar,addIcon:c.addIcon,addMenuButton:c.addMenuButton,addMenuItem:c.addMenuItem,addNestedMenuItem:c.addNestedMenuItem,addSidebar:c.addSidebar,addSplitButton:c.addSplitButton,addToggleButton:c.addToggleButton,addGroupToolbarButton:c.addGroupToolbarButton,addToggleMenuItem:c.addToggleMenuItem,getAll:c.getAll}),styleSheetLoader:void 0,show:Y,hide:Y,enable:Y,disable:Y,isDisabled:m},wb(this));this.mode=g,this.setMode=g.set,n.fire("SetupEditor",{editor:this}),this.execCallback("setup",this),this.$=re.overrideDefaults(function(){return{context:p.inline?p.getBody():p.getDoc(),element:p.getBody()}})}function Gb(t){var n=t.type;Qb(oE.get(),function(e){switch(n){case"scroll":e.fire("ScrollWindow",t);break;case"resize":e.fire("ResizeWindow",t)}})}function Yb(e){e!==tE&&(e?re(window).on("resize scroll",Gb):re(window).off("resize scroll",Gb),tE=e)}function Xb(t){var e=rE;delete nE[t.id];for(var n=0;n<nE.length;n++)if(nE[n]===t){nE.splice(n,1);break}return rE=O(rE,function(e){return t!==e}),oE.activeEditor===t&&(oE.activeEditor=0<rE.length?rE[0]:null),oE.focusedEditor===t&&(oE.focusedEditor=null),e.length!==rE.length}var Kb,qb=L.DOM,Zb=te.explode,Qb=te.each,Jb=te.extend,eE=0,tE=!1,nE=[],rE=[],iE="CSS1Compat"!==document.compatMode,oE=I(I({},ln),{baseURI:null,baseURL:null,defaultSettings:{},documentBaseURL:null,suffix:null,$:re,majorVersion:"5",minorVersion:"6.0",releaseDate:"2020-11-18",editors:nE,i18n:na,activeEditor:null,focusedEditor:null,settings:{},setup:function(){var e,t="",n=Bb.getDocumentBaseUrl(document.location);/^[^:]+:\/\/\/?[^\/]+\//.test(n)&&(n=n.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(n)||(n+="/"));var r=window.tinymce||window.tinyMCEPreInit;if(r)e=r.base||r.baseURL,t=r.suffix;else{for(var i,o=document.getElementsByTagName("script"),s=0;s<o.length;s++)if(""!==(i=o[s].src||"")){var a=i.substring(i.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(i)){-1!==a.indexOf(".min")&&(t=".min"),e=i.substring(0,i.lastIndexOf("/"));break}}!e&&document.currentScript&&(-1!==(i=document.currentScript.src).indexOf(".min")&&(t=".min"),e=i.substring(0,i.lastIndexOf("/")))}this.baseURL=new Bb(n).toAbsolute(e),this.documentBaseURL=n,this.baseURI=new Bb(this.baseURL),this.suffix=t,this.on("AddEditor",w(Vd,this)),this.on("RemoveEditor",w(Wd,this))},overrideDefaults:function(e){var t=e.base_url,t=(t&&this._setBaseUrl(t),e.suffix),t=(e.suffix&&(this.suffix=t),(this.defaultSettings=e).plugin_base_urls);void 0!==t&&X(t,function(e,t){Aa.PluginManager.urls[t]=e})},init:function(s){var n,a=this,l=te.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),u=function(e){var t=e.id;return t||(t=We(e,"name").filter(function(e){return!qb.get(e)}).getOrThunk(qb.uniqueId),e.setAttribute("id",t)),t},c=function(e,t){return t.constructor===RegExp?t.test(e.className):qb.hasClass(e,t)},d=function(e){n=e},e=function(){function n(e,t,n){e=new zb(e,t,a),o.push(e),e.on("init",function(){++i===r.length&&d(o)}),e.targetElm=e.targetElm||n,e.render()}var r,i=0,o=[];qb.unbind(window,"ready",e),function(){var e=s.onpageload;e&&e.apply(a,Array.prototype.slice.call(arguments,2))}("onpageload"),r=re.unique(function(t){var n=[];if(K.browser.isIE()&&K.browser.version.major<11)return a0("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/"),[];if(iE)return a0("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[];if(t.types)Qb(t.types,function(e){n=n.concat(qb.select(e.selector))});else{if(t.selector)return qb.select(t.selector);if(t.target)return[t.target];switch(t.mode){case"exact":var e=t.elements||"";0<e.length&&Qb(Zb(e),function(t){var e=qb.get(t);e?n.push(e):Qb(document.forms,function(e){Qb(e.elements,function(e){e.name===t&&(t="mce_editor_"+eE++,qb.setAttrib(e,"id",t),n.push(e))})})});break;case"textareas":case"specific_textareas":Qb(qb.select("textarea"),function(e){t.editor_deselector&&c(e,t.editor_deselector)||t.editor_selector&&!c(e,t.editor_selector)||n.push(e)})}}return n}(s)),s.types?Qb(s.types,function(t){te.each(r,function(e){return!qb.is(e,t.selector)||(n(u(e),Jb({},s,t),e),!1)})}):(te.each(r,function(e){(e=a.get(e.id))&&e.initialized&&!(e.getContainer()||e.getBody()).parentNode&&(Xb(e),e.unbindAllNativeEvents(),e.destroy(!0),e.removed=!0)}),0===(r=te.grep(r,function(e){return!a.get(e.id)})).length?d([]):Qb(r,function(e){var t=e;s.inline&&t.tagName.toLowerCase()in l?a0("Could not initialize inline editor on invalid inline target element",e):n(u(e),s,e)}))};return a.settings=s,qb.bind(window,"ready",e),new Er(function(t){n?t(n):d=function(e){t(e)}})},get:function(t){return 0===arguments.length?rE.slice(0):ge(t)?Ie(rE,function(e){return e.id===t}).getOr(null):Te(t)&&rE[t]?rE[t]:null},add:function(e){var n=this;return nE[e.id]===e||(null===n.get(e.id)&&("length"!==e.id&&(nE[e.id]=e),nE.push(e),rE.push(e)),Yb(!0),n.activeEditor=e,n.fire("AddEditor",{editor:e}),Kb)||(Kb=function(e){var t=n.fire("BeforeUnload");if(t.returnValue)return e.preventDefault(),e.returnValue=t.returnValue,t.returnValue},window.addEventListener("beforeunload",Kb)),e},createEditor:function(e,t){return this.add(new zb(e,t,this))},remove:function(e){var t,n,r=this;if(e){if(!ge(e))return n=e,ve(r.get(n.id))?null:(Xb(n)&&r.fire("RemoveEditor",{editor:n}),0===rE.length&&window.removeEventListener("beforeunload",Kb),n.remove(),Yb(0<rE.length),n);Qb(qb.select(e),function(e){(n=r.get(e.id))&&r.remove(n)})}else for(t=rE.length-1;0<=t;t--)r.remove(rE[t])},execCommand:function(e,t,n){var r=this.get(n);switch(e){case"mceAddEditor":return this.get(n)||new zb(n,this.settings,this).render(),!0;case"mceRemoveEditor":return r&&r.remove(),!0;case"mceToggleEditor":return r?r.isHidden()?r.show():r.hide():this.execCommand("mceAddEditor",0,n),!0}return!!this.activeEditor&&this.activeEditor.execCommand(e,t,n)},triggerSave:function(){Qb(rE,function(e){e.save()})},addI18n:function(e,t){na.add(e,t)},translate:function(e){return na.translate(e)},setActive:function(e){var t=this.activeEditor;this.activeEditor!==e&&(t&&t.fire("deactivate",{relatedTarget:e}),e.fire("activate",{relatedTarget:t})),this.activeEditor=e},_setBaseUrl:function(e){this.baseURL=new Bb(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new Bb(this.baseURL)}});oE.setup();function sE(e,t,n){var r=t.x,i=t.y,o=e.w,e=e.h,s=t.w,t=t.h;return"b"===(n=(n||"").split(""))[0]&&(i+=t),"r"===n[1]&&(r+=s),"c"===n[0]&&(i+=yE(t/2)),"c"===n[1]&&(r+=yE(s/2)),"b"===n[3]&&(i-=e),"r"===n[4]&&(r-=o),"c"===n[3]&&(i-=yE(e/2)),"c"===n[4]&&(r-=yE(o/2)),aE(r,i,o,e)}function aE(e,t,n,r){return{x:e,y:t,w:n,h:r}}function lE(){}var uE,cE,dE,hE,fE,pE,gE=Math.min,mE=Math.max,yE=Math.round,nn={inflate:function(e,t,n){return aE(e.x-t,e.y-n,e.w+2*t,e.h+2*n)},relativePosition:sE,findBestRelativePosition:function(e,t,n,r){for(var i,o=0;o<r.length;o++)if((i=sE(e,t,r[o])).x>=n.x&&i.x+i.w<=n.w+n.x&&i.y>=n.y&&i.y+i.h<=n.h+n.y)return r[o];return null},intersect:function(e,t){var n=mE(e.x,t.x),r=mE(e.y,t.y),i=gE(e.x+e.w,t.x+t.w),e=gE(e.y+e.h,t.y+t.h);return i-n<0||e-r<0?null:aE(n,r,i-n,e-r)},clamp:function(e,t,n){var r=e.x,i=e.y,o=e.x+e.w,e=e.y+e.h,s=t.x+t.w,a=t.y+t.h,l=mE(0,t.x-r),t=mE(0,t.y-i),s=mE(0,o-s),a=mE(0,e-a);return r+=l,i+=t,n&&(o+=l,e+=t,r-=s,i-=a),aE(r,i,(o-=s)-r,(e-=a)-i)},create:aE,fromClientRect:function(e){return aE(e.left,e.top,e.width,e.height)}},un=(uE={},cE={},{load:function(l,u){var e,c='Script at URL "'+u+'" failed to load',d='Script at URL "'+u+"\" did not call `tinymce.Resource.add('"+l+"', data)` within 1 second";return void 0!==uE[l]?uE[l]:(e=new Er(function(e,t){void 0===n&&(n=1e3),r=!1,i=null,e=a(e),o=a(t);var n,r,i,o,s={start:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r||null!==i||(i=setTimeout(function(){return o.apply(null,e)},n))},resolve:e,reject:o};function a(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r||(r=!0,null!==i&&(clearTimeout(i),i=null),n.apply(null,e))}}cE[l]=s.resolve,Zs.ScriptLoader.loadScript(u,function(){return s.start(d)},function(){return s.reject(c)})}),uE[l]=e)},add:function(e,t){void 0!==cE[e]&&(cE[e](t),delete cE[e]),uE[e]=Er.resolve(t)}}),vE=te.each,bE=te.extend,EE=(lE.extend=dE=function(n){function r(){var e,t,n;if(!hE&&(this.init&&this.init.apply(this,arguments),t=this.Mixins))for(e=t.length;e--;)(n=t[e]).init&&n.init.apply(this,arguments)}function t(){return this}var i=this.prototype,o=(hE=!0,new this);return hE=!1,n.Mixins&&(vE(n.Mixins,function(e){for(var t in e)"init"!==t&&(n[t]=e[t])}),i.Mixins)&&(n.Mixins=i.Mixins.concat(n.Mixins)),n.Methods&&vE(n.Methods.split(","),function(e){n[e]=t}),n.Properties&&vE(n.Properties.split(","),function(e){var t="_"+e;n[e]=function(e){return void 0!==e?(this[t]=e,this):this[t]}}),n.Statics&&vE(n.Statics,function(e,t){r[t]=e}),n.Defaults&&i.Defaults&&(n.Defaults=bE({},i.Defaults,n.Defaults)),X(n,function(e,t){var n,r;"function"==typeof e&&i[t]?o[t]=(n=t,r=e,function(){var e=this._super,t=(this._super=i[n],r.apply(this,arguments));return this._super=e,t}):o[t]=e}),r.prototype=o,(r.constructor=r).extend=dE,r},Math.min),CE=Math.max,wE=Math.round,SE={serialize:function(e){e=JSON.stringify(e);return ge(e)?e.replace(/[\u0080-\uFFFF]/g,function(e){e=e.charCodeAt(0).toString(16);return"\\u"+"0000".substring(e.length)+e}):e},parse:function(e){try{return JSON.parse(e)}catch(e){}}},n={callbacks:{},count:0,send:function(t){var n=this,r=L.DOM,i=(void 0!==t.count?t:n).count,o="tinymce_jsonp_"+i;n.callbacks[i]=function(e){r.remove(o),delete n.callbacks[i],t.callback(e)},r.add(r.doc.body,"script",{id:o,src:t.url,type:"text/javascript"}),n.count++}},TE=I(I({},ln),{send:function(e){var t,n=0,r=function(){!e.async||4===t.readyState||1e4<n++?(e.success&&n<1e4&&200===t.status?e.success.call(e.success_scope,""+t.responseText,t,e):e.error&&e.error.call(e.error_scope,1e4<n?"TIMED_OUT":"GENERAL",t,e),t=null):Ir.setTimeout(r,10)};if(e.scope=e.scope||this,e.success_scope=e.success_scope||e.scope,e.error_scope=e.error_scope||e.scope,e.async=!1!==e.async,e.data=e.data||"",TE.fire("beforeInitialize",{settings:e}),(t=new XMLHttpRequest).overrideMimeType&&t.overrideMimeType(e.content_type),t.open(e.type||(e.data?"POST":"GET"),e.url,e.async),e.crossDomain&&(t.withCredentials=!0),e.content_type&&t.setRequestHeader("Content-Type",e.content_type),e.requestheaders&&te.each(e.requestheaders,function(e){t.setRequestHeader(e.key,e.value)}),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),(t=TE.fire("beforeSend",{xhr:t,settings:e}).xhr).send(e.data),!e.async)return r();Ir.setTimeout(r,10)}}),RE=te.extend,t=(AE.sendRPC=function(e){return(new AE).send(e)},AE.prototype.send=function(e){var n=e.error,r=e.success,i=RE(this.settings,e);i.success=function(e,t){(e=void 0===(e=SE.parse(e))?{error:"JSON Parse error."}:e).error?n.call(i.error_scope||i.scope,e.error,t):r.call(i.success_scope||i.scope,e.result)},i.error=function(e,t){n&&n.call(i.error_scope||i.scope,e,t)},i.data=SE.serialize({id:e.id||"c"+this.count++,method:e.method,params:e.params}),i.content_type="application/json",TE.send(i)},AE);function AE(e){this.settings=RE({},e),this.count=0}try{var _E,NE="__storage_test__";(_E=window.localStorage).setItem(NE,NE),_E.removeItem(NE)}catch(e){fE={},pE=[],NE={getItem:function(e){return fE[e]||null},setItem:function(e,t){pE.push(e),fE[e]=String(t)},key:function(e){return pE[e]},removeItem:function(t){pE=pE.filter(function(e){return e===t}),delete fE[t]},clear:function(){pE=[],fE={}},length:0},Object.defineProperty(NE,"length",{get:function(){return pE.length},configurable:!1,enumerable:!1}),_E=NE}nn={geom:{Rect:nn},util:{Promise:Er,Delay:Ir,Tools:te,VK:H,URI:Bb,Class:lE,EventDispatcher:mb,Observable:ln,I18n:na,XHR:TE,JSON:SE,JSONRequest:t,JSONP:n,LocalStorage:_E,Color:function(e){function t(e){if("object"==typeof e){if("r"in e)a=e.r,l=e.g,u=e.b;else if("v"in e){var t=e.h,n=e.s,r=e.v;if(t=(parseInt(t,10)||0)%360,n=parseInt(n,10)/100,r=parseInt(r,10)/100,n=CE(0,EE(n,1)),r=CE(0,EE(r,1)),0!==n){var t=t/60,i=r*n,o=i*(1-Math.abs(t%2-1)),n=r-i;switch(Math.floor(t)){case 0:a=i,l=o,u=0;break;case 1:a=o,l=i,u=0;break;case 2:a=0,l=i,u=o;break;case 3:a=0,l=o,u=i;break;case 4:a=o,l=0,u=i;break;case 5:a=i,l=0,u=o;break;default:a=l=u=0}a=wE(255*(a+n)),l=wE(255*(l+n)),u=wE(255*(u+n))}else a=l=u=wE(255*r)}}else(t=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(e))?(a=parseInt(t[1],10),l=parseInt(t[2],10),u=parseInt(t[3],10)):(t=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(e))?(a=parseInt(t[1],16),l=parseInt(t[2],16),u=parseInt(t[3],16)):(t=/#([0-F])([0-F])([0-F])/gi.exec(e))&&(a=parseInt(t[1]+t[1],16),l=parseInt(t[2]+t[2],16),u=parseInt(t[3]+t[3],16));return a=a<0?0:255<a?255:a,l=l<0?0:255<l?255:l,u=u<0?0:255<u?255:u,s}var s={},a=0,l=0,u=0;return e&&t(e),s.toRgb=function(){return{r:a,g:l,b:u}},s.toHsv=function(){return e=a,t=l,n=u,i=0,(o=EE(e/=255,EE(t/=255,n/=255)))===(s=CE(e,CE(t,n)))?{h:0,s:0,v:100*(i=o)}:(r=(s-o)/s,{h:wE(60*((e===o?3:n===o?1:5)-(e===o?t-n:n===o?e-t:n-e)/((i=s)-o))),s:wE(100*r),v:wE(100*i)});var e,t,n,r,i,o,s},s.toHex=function(){function e(e){return 1<(e=parseInt(e,10).toString(16)).length?e:"0"+e}return"#"+e(a)+e(l)+e(u)},s.parse=t,s}},dom:{EventUtils:co,Sizzle:ne,DomQuery:re,TreeWalker:J,TextSeeker:ga,DOMUtils:L,ScriptLoader:Zs,RangeUtils:e,Serializer:mm,StyleSheetLoader:Mr,ControlSelection:ld,BookmarkManager:md,Selection:ug,Event:co.Event},html:{Styles:ao,Entities:$i,Node:Ph,Schema:eo,SaxParser:dg,DomParser:Lm,Writer:Bh,Serializer:Wh},Env:K,AddOnManager:Aa,Annotator:Ac,Formatter:y0,UndoManager:b0,EditorCommands:ob,WindowManager:n0,NotificationManager:t0,EditorObservable:Rb,Shortcuts:Mb,Editor:zb,FocusManager:Th,EditorManager:oE,DOM:L.DOM,ScriptLoader:Zs.ScriptLoader,PluginManager:l0,ThemeManager:u0,IconManager:Km,Resource:un,trim:te.trim,isArray:te.isArray,is:te.is,toArray:te.toArray,makeMap:te.makeMap,each:te.each,map:te.map,grep:te.grep,inArray:te.inArray,extend:te.extend,create:te.create,walk:te.walk,createNS:te.createNS,resolve:te.resolve,explode:te.explode,_addCacheSuffix:te._addCacheSuffix,isOpera:K.opera,isWebKit:K.webkit,isIE:K.ie,isGecko:K.gecko,isMac:K.mac},ln=te.extend(oE,nn),t=ln,window.tinymce=t,window.tinyMCE=t,n=ln;if("object"==typeof module)try{module.exports=n}catch(e){}}(),!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["@master/css"]=t():e["@master/css"]=t()}(this,function(){return n={642:e=>{e.exports={"3xs":360,"2xs":480,xs:600,sm:768,md:1024,lg:1280,xl:1440,"2xl":1600,"3xl":1920,"4xl":2560}},580:e=>{e.exports={fade:{10:"131518",20:"24262d",30:"363944",40:"4c515f",50:"63697c",60:"878d9f",70:"a6abb8",80:"c3c6cf",90:"f4f4f6"},gray:{10:"151515",20:"242424",30:"39393b",40:"515153",50:"6a6a6c",60:"8d8d8f",70:"aaaaac",80:"c6c6c8",90:"f4f4f6"},brown:{10:"1c130f",20:"31221b",30:"4b3429",40:"6a4a3a",50:"8a604c",60:"af836e",70:"c4a394",80:"d8c2b8",90:"f8f3f1"},orange:{10:"221205",20:"3a1f08",30:"582f0d",40:"7c4312",50:"a15717",60:"d5731e",70:"e79855",80:"efbd92",90:"fcf1e7"},gold:{10:"1e1400",20:"342300",30:"4e3400",40:"6e4900",50:"906000",60:"c08000",70:"e89a00",80:"ffba30",90:"fff3da"},yellow:{10:"1b1500",20:"2f2500",30:"473800",40:"634f00",50:"806700",60:"ac8a00",70:"d0a700",80:"f0c100",90:"fff5ca"},grass:{10:"101803",20:"1c2a05",30:"2a4008",40:"3c5a0b",50:"4e750e",60:"689c13",70:"7dbc17",80:"92da1a",90:"ebfad4"},green:{10:"011a0b",20:"022d13",30:"03441d",40:"055f28",50:"067b34",60:"08a345",70:"0ac553",80:"0be561",90:"d5fde5"},beryl:{10:"001912",20:"002b1f",30:"00432f",40:"005d41",50:"007954",60:"00a170",70:"00c387",80:"00e19c",90:"c9ffee"},teal:{10:"001918",20:"002b28",30:"00413d",40:"005b55",50:"00776f",60:"009f94",70:"00bfb2",80:"00ddce",90:"c5fffb"},cyan:{10:"00181f",20:"002a35",30:"003f51",40:"005973",50:"007391",60:"0099c1",70:"00b9e9",80:"3dd7ff",90:"dff8ff"},sky:{10:"021726",20:"032841",30:"043c61",40:"065489",50:"086eb3",60:"0b92ee",70:"4db3f7",80:"8ccefa",90:"eaf6fe"},blue:{10:"051338",20:"09205e",30:"0d318d",40:"1344c4",50:"175fe9",60:"538cee",70:"81acf3",80:"a5c7fd",90:"edf4fe"},indigo:{10:"161031",20:"24195e",30:"332592",40:"4835cc",50:"5a5bd5",60:"7d84e8",70:"a1a5ee",80:"bfc2f4",90:"f1f2ff"},violet:{10:"1f0839",20:"310e63",30:"491595",40:"641ed2",50:"7949e5",60:"9e77f5",70:"b89bf9",80:"d0bdfb",90:"f5f1ff"},purple:{10:"220736",20:"390c5b",30:"551287",40:"7719bd",50:"9832e4",60:"b56cec",70:"ca96f1",80:"dcbaf6",90:"f9f0ff"},fuchsia:{10:"2b0720",20:"470b3d",30:"68105f",40:"8e1691",50:"b61cbb",60:"e04ee5",70:"ea86ed",80:"f1b1f3",90:"feefff"},pink:{10:"2d0519",20:"4c082b",30:"720c40",40:"9d1059",50:"ca1473",60:"ee52a3",70:"f388c0",80:"f7b2d6",90:"fff0f8"},crimson:{10:"33020f",20:"500317",30:"780522",40:"a20d35",50:"ce1a4b",60:"ea5b82",70:"f58ba7",80:"ffb1c6",90:"fff1f4"},red:{10:"350001",20:"530001",30:"780506",40:"a60708",50:"d11a1e",60:"eb5f63",70:"fa8b8d",80:"fdb3b5",90:"fff1f1"},black:"000000",white:"ffffff"}},989:(e,t,n)=>{const u=n(824),c=n(860);n(580),e.exports=function(a){const e=""in(a="string"==typeof a?{"":a}:a);let t=!1;for(const e in a)if(e&&100<=+e){t=!0;break}if(!t&&(!e||1<Object.keys(a).length)){let t,i,o=0,s="0"in a?u(a[0]):[0,0,0];const l=[],r=()=>{const n=t-o,r=i.map((e,t)=>(e-s[t])/n);for(const t of l){const i=t-o,n=s.map((e,t)=>Math.round(e+r[t]*i));a[t]=c.call(this,...n)}};for(let e=1;e<100;e++){var n=e%2==0;e in a?(s=l.length?(t=e,i=u(a[e]),r(),l.length=0,i):u(a[e]),o=e):n&&l.push(e)}l.length&&(t=100,i="100"in a?u(a[100]):[255,255,255],r())}return e||(a[""]=a[t?"500":"50"]),a}},824:e=>{e.exports=function(e){e=e.match(/.{1,2}/g);return[parseInt(e[0],16),parseInt(e[1],16),parseInt(e[2],16)]}},860:e=>{e.exports=function(e,t,n){return((1<<24)+(e<<16)+(t<<8)+n).toString(16).slice(1)}}},r={},Ui.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return Ui.d(t,{a:t}),t},Ui.d=(e,t)=>{for(var n in t)Ui.o(t,n)&&!Ui.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},Ui.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),Ui.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},Vi={},(()=>{"use strict";function C(e,t){return e+":"+(t.unit?t.value+t.unit:t.value)+(t.important?"!important":"")}Ui.r(Vi),Ui.d(Vi,{Style:()=>M,StyleSheet:()=>k,Styles:()=>Li,breakpoints:()=>Hi,colors:()=>Bi,init:()=>Fi,sheets:()=>Fe});const l=/^([+-.]?\d+(\.?\d+)?)(.*)?/;function w(e,t,s,n,r){let i=n?n[e]:"",o="",a="";if(!i)if("number"==typeof e)i=e,o=t||"";else{if(s){const l=Object.keys(s);e=e.replace(new RegExp(`(^|,| |\\()(${l.join("|")})(?:-([0-9]+))?(?:\\/(\\.?[0-9]+))?(?=(\\)|\\}|,| |$))`,"gm"),(e,t,n,r,i,o)=>{n=s[n][r||""];if(n){let e="#"+n;return i&&(r=+i,r=isNaN(r)?1:Math.min(Math.max(r,0),1),e+=Math.round(255*r).toString(16).toUpperCase().padStart(2,"0")),t+e}return e})}if(t){const s=e.match(l);if(s){if(e.includes("/")){const l=e.split("/");return{value:+l[0]/+l[1]*100+"%",unit:o,unitToken:a}}return i=+s[1],(o=a=s[3]||"")||("rem"!==t&&"em"!==t||(i/=r),o=t||""),{value:i,unit:o,unitToken:a}}}i=(-1===e.indexOf("calc(")?e:function(t){var n=e=>"+"===e||"-"===e||"*"===e||"/"===e;let r,i="",o="",s=!1;function a(){r=null,o=""}for(let e=0;e<t.length;e++){var l=t[e];if("("===l||")"===l)s=")"===l,i+=o+l,a();else if(","===l)i+=o+l+" ",a();else{switch(r){case 1:break;case 2:if(n(l)){i+=o+" "+l+" ",a();continue}break;default:s&&(o+=" "),isNaN(+l)?n(l)||(r=1):r=2}o+=l}}return o&&(i+=o),i}(e)).replace(/\$\(((\w|-)+)\)/g,"var(--$1)")}return{value:i,unit:o,unitToken:a}}const P=[":disabled",":active",":focus",":hover"],F={"(":")","'":"'","{":"}"};var e=Ui(642),B=Ui.n(e);const o=(...e)=>e.join("-"),a="border",t="radius",s="margin",u="padding",n="font",r="currentColor",i="template",c="column",H="columns",d="row",U="rows",V="shadow",h="content",f="image",W="stroke",p="background",g="color",m="scroll",y="animation",$="direction",j="mode",z=o("overscroll","behavior"),G="height",v="width",b="max",E="min",Y="inline",S="flex",T="grid",X="transition",K="rotate",q="timing-function",Z="display",Q="hidden",R="box",J="fill",A="text",ee="align",te="transform",ne="word",re="decoration",_="break",N="auto",ie="position",oe="rem",x="style",se="antialiased",ae="spacing",le=o("letter",ae),ue=o(b,v),ce=o(E,v),de=o(b,G),he=o(E,G),O="table",fe="group",pe="list",ge="justify",me="offset",ye="outline",I={full:"100%",fit:o("fit",h),max:o(b,h),min:o(E,h)};for(const C in B())I[C]=B()[C]/16+"rem";const ve=Ui(989),be="matches",Ee="max-width",Ce="min-width",we="::scrollbar",Se="::slider-thumb",Te="::slider-runnable-track",Re="::progress",Ae=["!","*",">","+","~",":","[","@","_"],_e=[...Ae,void 0,"."],Ne=new RegExp(we,"g"),xe=new RegExp("::search","g"),Oe=new RegExp("::meter","g"),Ie=new RegExp(Te,"g"),Me=new RegExp(Se,"g"),ke=new RegExp("::resizer","g"),De=new RegExp(Re,"g"),Le=/(\\'(?:.*?)[^\\]\\')(?=[*_>~+,)])|(\[[^=]+='(?:.*?)[^\\]'\])/,Pe=e=>e.split(Le).map((e,t)=>t%3?e:e.replace(/\_/g," ")).join(""),Fe=[];class M{constructor(y,v){this.name=y,this.matching=v,this.at={},this.prioritySelectorIndex=-1;const b=this.constructor;if(void 0!==v||(v=b.match(y))){let d,t,e,{id:n,semantics:r,unit:h,colors:f,key:i,values:p,colorful:o,breakpoints:s,mediaQueries:a,colorSchemes:l,rootSize:g}=b,m=y;if(o||(f=null),"semantics"===v.origin)d=v.value,e=m.slice(v.value.length),this.value=r[v.value];else{if(v.origin===be)if(n===fe){let e=0;for(;e<m.length&&("{"!==m[e]||"\\"===m[e-1]);e++);t=m.slice(0,e),d=m.slice(e)}else{const C=m.indexOf(":");this.prefix=m.slice(0,C+1),d=this.prefix.includes("(")?(this.prefix=void 0,m):m.slice(C+1)}else"symbol"===v.origin&&(this.symbol=m[0],d=m.slice(1));let a,l="",u=[],c=0;!function e(t,n,r=""){let i,o=!1;for(t&&(")"===t&&"$"===l.slice(-1)?i=l.length-1:"'"===t&&(o=!0),l+=d[c++]);c<d.length;c++){var s=d[c];if(s===t){if(l+=s,o){let t=0;for(let e=l.length-2;"\\"===l[e];e--)t++;if(t%2)continue}void 0!==i&&(l=l.slice(0,i)+l.slice(i).replace(/\$\((.*)\)/,"var(--$1)")),n||(o?u.push(l):(a=w(l,h,f,p,g),u.push(a.value+a.unit)),r="",l="");break}if(!o&&s in F)e(F[s],void 0===n?0:n+1,r);else if("|"!==s||"}"===t||o&&"path"!==r){if(!t){if("."===s){if(isNaN(+d[c+1]))break;"-"===d[c-1]&&(l+="0")}else{if(","===s){a=w(l,h,f,p,g),u.push(a.value+a.unit,","),l="";continue}if("#"===s&&(l||u.length&&"|"!==d[c-1])||Ae.includes(s))break}r+=s}l+=s}else t?l+=" ":(a=w(l,h,f,p,g),u.push(a.value+a.unit),l="")}}(),l&&(a=w(l,h,f,p,g),u.push(a.value+a.unit)),e=d.slice(c),1===u.length?a?(this.value=a.value,this.unit=a.unit):(this.value=u[0],this.unit=""):this.value=u.reduce((e,t,n)=>e+t+(","===t||","===u[n+1]||n===u.length-1?"":" "),"")}(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.includes(we)?e.replace(Ne,"::-webkit-scrollbar"):e).includes("::search")?e.replace(xe,"::-webkit-search"):e).includes(Se)?e.replace(Me,"::-webkit-slider-thumb"):e).includes(Te)?e.replace(Ie,"::-webkit-slider-runnable-track"):e).includes("::meter")?e.replace(Oe,"::-webkit-meter"):e).includes("::resizer")?e.replace(ke,"::-webkit-resizer"):e).includes(Re)?e.replace(De,"::-webkit-progress"):e).includes(":first")?e.replace(/:first(?![a-z-])/g,":first-child"):e).includes(":last")?e.replace(/:last(?![a-z-])/g,":last-child"):e).includes(":even")?e.replace(/:even(?![a-z-])/g,":nth-child(2n)"):e).includes(":odd")?e.replace(/:odd(?![a-z-])/g,":nth-child(odd)"):e).includes(":nth(")&&(e=e.replace(/:nth\(/g,":nth-child(")),this.parseValue&&(this.value=this.parseValue),p&&this.value in p&&(this.value=p[this.value]),"!"===e[0]&&(this.important=!0,e=e.slice(1)),this.prefixSelector=t?Pe(t):"";var E=e.split("@");let u=E[0];if(u){u=Pe(u),this.hasWhere=u.includes(":where(");for(let e=0;e<P.length;e++)if(u.includes(P[e])){this.prioritySelectorIndex=e;break}}this.suffixSelector=u;for(let e=1;e<E.length;e++){const y=E[e];if(y)if(l.includes(y))this.colorScheme=y;else if("rtl"===y||"ltr"===y)this.direction=y;else{let e,t;const b=y.indexOf("_");if(-1!==b)e=y.slice(0,b),t=y.slice(b);else{const b=y.indexOf("(");-1!==b&&(e=y.slice(0,b),t=y.slice(b))}if(!e){e="media";const b=[],P=(this.media={token:y,features:{}},y.split("&"));for(const C of P)if("all"===C||"print"===C||"screen"===C||"speech"===C)this.media.type=C;else if("🖨"===C)this.media.type="print";else if("landscape"===C||"portrait"===C)b.push("(orientation:"+C+")");else if("motion"===C||"reduced-motion"===C)b.push("(prefers-reduced-motion:"+("motion"===C?"no-preference":"reduce")+")");else if(C in a)b.push(a[C]);else{const y={token:C};let n="",r="",i=0;switch(C.startsWith("<=")?(r="<=",n=Ee):C.startsWith(">=")||s[C]?(r=">=",n=Ce):C.startsWith(">")?(r=">",n=Ce,i=.02):C.startsWith("<")&&(r="<",n=Ee,i=-.02),n){case Ee:case Ce:const e=r?C.replace(r,""):C,t=s[e];t?Object.assign(y,w(t,"px")):Object.assign(y,w(e,"px")),"px"===y.unit&&(y.value+=i),this.media.features[n]=y,b.push("("+n+":"+(y.value+y.unit)+")")}}t="",this.media.type&&(t=this.media.type),b.length&&(t+=(t?" and ":"")+b.join(" and "))}t&&(this.at[e]=(e in this.at?this.at[e]+" and ":"")+t.replace(/\_/g," "))}}let c="";this.colorScheme&&(c+="."+this.colorScheme+" "),this.prefixSelector&&(c+=this.prefixSelector),this.direction&&(c+="[dir="+this.direction+"] "),this.text=c+"."+CSS.escape(this.name)+this.suffixSelector+(this.name in M.relations?M.relations[this.name].map(e=>", "+c+"."+CSS.escape(e)+this.suffixSelector).join(""):"")+"{"+("object"==typeof this.value?Object.keys(this.value).map(e=>C(e,Object.assign(Object.assign({},this),{unit:"",value:this.value[e]}))).join(";"):this.props?Object.keys(this.props).map(e=>C(e,this.props[e])).join(";"):C(i,this))+"}";for(const C of Object.keys(this.at).sort((e,t)=>"supports"===t?-1:1))this.text="@"+C+" "+this.at[C]+"{"+this.text+"}";void 0===this.order&&(this.order=0)}}static match(e){if(this.matches&&this.matches.test(e))return{origin:be};if(this.semantics)for(const t in this.semantics)if(e===t||e.startsWith(t)&&_e.includes(e[t.length]))return{origin:"semantics",value:t};return this.colorStarts&&(e.match("^"+this.colorStarts+"(#|(rgb|hsl)\\(.*\\))((?!\\|).)*$")||this.colorNames.length&&e.match("^"+this.colorStarts+"("+this.colorNames.join("|")+")")&&-1===e.indexOf("|"))?{origin:be}:this.symbol&&e.startsWith(this.symbol)?{origin:"symbol"}:this.key&&e.startsWith(this.key+":")?{origin:be}:void 0}static extend(t,...e){if(e.length){const s=Object.assign({},...e),n=(e,t,n)=>{var r;for(const o in s){var i=s[o];null==i?o in e&&(null!=n&&n(o),delete e[o]):e[o]=null!=(r=null==t?void 0:t(o,i))?r:i}};switch(t){case"classes":n(this.classes,(e,t)=>{if(e in this.classes)for(const t in this.relations){const n=this.relations[t],r=n.indexOf(e);-1!==r&&(1<n.length?n.splice(r,1):delete this.relations[t])}const n=Array.isArray(t)?t:t.replace(/(?:\n(?:\s*))+/g," ").trim().split(" ");for(const t of n)t in this.relations?this.relations[t].push(e):this.relations[t]=[e];return n},e=>{for(const n of this.classes[e]){var t=this.relations[n];1<t.length?t.splice(t.indexOf(e),1):delete this.relations[n]}});break;case"colors":n(this.colors,(e,t)=>(-1===this.colorNames.indexOf(e)&&this.colorNames.push(e),ve(t)),e=>{e=this.colorNames.indexOf(e);-1!==e&&this.colorNames.splice(e,1)});break;default:let e=this[t];n(e=e||(this[t]={}))}}return this}}M.unit="rem",M.rootSize=16,M.mediaQueries={},M.sheets=Fe,M.colors={},M.classes={},M.colorNames=[],M.relations={},M.colorSchemes=["dark","light"],"undefined"!=typeof window&&(window.MasterStyle=M);const Be=[",",".","#","[","!","*",">","+","~",":","@"],He="undefined"!=typeof document;let Ue;He&&((Ue=document.createElement("style")).id="master-css");e="undefined"!=typeof window;class k extends(e?window.MutationObserver:Object){constructor(s){if(super(t=>{const n={},r=[],i=[],o=[],s=(e,t)=>{t?e.classList.forEach(l):e.classList.forEach(a);var n=e.children;for(let e=0;e<n.length;e++){var r=n[e];r.classList&&(i.push(r),s(r,t))}},a=e=>{e in n?n[e]++:n[e]=1},l=e=>{e in n?n[e]--:e in this.countOfName&&(n[e]=-1)},u=(t,n)=>{for(let e=0;e<t.length;e++){var r=t[e];!r.classList||i.includes(r)||o.includes(r)||(r.isConnected!==n?(i.push(r),s(r,n)):o.push(r))}};for(let e=0;e<t.length;e++){const o=t[e],{addedNodes:s,removedNodes:a,type:l,target:c}=o;"attributes"===l?r.find(e=>e.target===c)||r.push(o):(u(s,!1),c.isConnected&&i.includes(c)||u(a,!0))}if(r.length||Object.keys(n).length){for(const{oldValue:t,target:n}of r){const r=i.includes(n),o=n.classList,s=t?t.split(" "):[];if(r){if(!n.isConnected)for(const t of s)o.contains(t)||l(t)}else if(n.isConnected){o.forEach(e=>{s.includes(e)||a(e)});for(const t of s)o.contains(t)||l(t)}}for(const t in n){const r=n[t],i=(this.countOfName[t]||0)+r;0===i?(delete this.countOfName[t],this.delete(t)):(t in this.countOfName||this.findAndInsert(t),this.countOfName[t]=i)}}}),this.container=s,this.styles=[],this.styleOfName={},this.countOfName={},He){if(s){var e=s.querySelector('[id="master-css"]');if(e){this.element=e;const s=(n,r)=>{if(n.selectorText){const s=n.selectorText.split(", ")[0].split(" ");for(let e=0;e<s.length;e++){var i=s[e];if("."===i[0]){const s=i.slice(1);let t="";for(let e=0;e<s.length;e++){const r=s[e],o=s[e+1];if("\\"===r){if(e++,"\\"!==o){t+=o;continue}}else if(Be.includes(r))break;t+=r}if(!(t in this.styleOfName||t in M.classes)){const s=k.findAndNew(t);s&&(s.cssRule=null!=r?r:n,this.styles.push(s),this.styleOfName[s.name]=s)}}}}else if(n.cssRules)for(let e=0;e<n.cssRules.length;e++)s(n.cssRules[e],null!=r?r:n.cssRules[e])};s(e.sheet,void 0)}else this.element=Ue.cloneNode(),null!=s&&s.prepend(this.element)}Fe.push(this)}}observe(e,t={subtree:!0,childList:!0}){const n=e=>{e.forEach(e=>{e in this.countOfName?this.countOfName[e]++:(this.countOfName[e]=1,this.findAndInsert(e))})};return n(e.classList),t.subtree&&e.querySelectorAll("[class]").forEach(e=>n(e.classList)),super.observe(e,Object.assign(Object.assign({},t),{attributes:!0,attributeOldValue:!0,attributeFilter:["class"]})),this}disconnect(){super.disconnect(),this.styleOfName={},this.countOfName={},this.styles.length=0;var t=this.element.sheet;if(t)for(let e=t.cssRules.length-1;0<=e;e--)t.deleteRule(e)}static findAndNew(e){var t=e=>{for(const n of this.Styles){var t=n.match(e);if(t)return new n(e,t)}};return e in M.classes?M.classes[e].map(t).filter(e=>e):t(e)}static find(e){var t=e=>{for(const t of this.Styles)if(t.match(e))return t};return e in M.classes?M.classes[e].map(t).filter(e=>e):t(e)}static refresh(){for(const e of Fe)e.refresh()}refresh(){if(this.element){const e=Ue.cloneNode();this.element.replaceWith(e),this.element=e,this.styles.length=0,this.styleOfName={};for(const e in this.countOfName)this.findAndInsert(e)}}destroy(){this.disconnect(),Fe.splice(Fe.indexOf(this),1),this.element.remove()}insert(r){if(!this.styleOfName[r.name]){const a=r.text;let n;const l=this.styles.length-1,u=r.media,c=r.order,d=r.prioritySelectorIndex,h=r.hasWhere,e=(e,t,n,r)=>{let i,o,s=0;t&&(s=e.findIndex(t)),n&&(o=e.findIndex(n)),-1===s&&(s=e.length),void 0!==o&&-1!==o||(o=e.length),i=e.slice(s,o);for(let e=0;e<i.length;e++){const t=i[e];if(!(-1===t.prioritySelectorIndex||r&&r(t))&&(t.prioritySelectorIndex<d||t.prioritySelectorIndex===d&&(h&&!t.hasWhere||t.order>=c)))return s+e}return s+i.length};if(u){const r=this.styles.findIndex(e=>e.media);if(-1!==r){const a=u.features["max-width"],f=u.features["min-width"];if(a&&f){const u=a.value-f.value;for(let t=l;t>=r;t--){n=t;const l=this.styles[t],c=l.media,p=c.features["max-width"],g=c.features["min-width"];if(!p||!g){n++;break}var i=p.value-g.value;if(i==u){if(h!==l.hasWhere)continue;if(-1!==d){const l=[this.styles[t]];for(let e=t-1;e>=r;e--){const r=this.styles[e];if(r.hasWhere!==h)break;const a=r.media,u=a.features["max-width"],c=a.features["min-width"];if(!u||!c||u.value-c.value!=i)break;l.unshift(this.styles[e])}n=e(this.styles,e=>e.media&&-1!==e.prioritySelectorIndex&&e.media.features["min-width"]&&e.media.features["max-width"])}break}if(i>u)break}}else if(f)for(let t=r;t<=l;t++){n=t;const r=this.styles[t],u=r.media,m=u.features["max-width"],y=u.features["min-width"];if(m){if(y)break}else{var o=null==y?void 0:y.value;if(o===f.value){if(!h&&r.hasWhere){n++;continue}if(-1!==d)n=e(this.styles,e=>e.media,e=>e.media&&-1!==e.prioritySelectorIndex&&e.media.features["min-width"]&&e.media.features["max-width"],e=>!e.media.features["min-width"]&&!e.media.features["max-width"]);else for(let e=t;e<=l;e++){const a=this.styles[e],l=a.media,u=l.features["min-width"];if(!l.features["max-width"]){if(a.hasWhere!==h||u.value!==o||a.order>=c)break;n=e+1}}break}if(o>f.value)break;n++}}else if(a)for(let t=l;t>=r;t--){n=t;const l=this.styles[t],v=l.media,b=v.features["max-width"];if(!v.features["min-width"]){var s=null==b?void 0:b.value;if(!s||s>a.value){n++;break}if(s===a.value&&(!h||l.hasWhere)){if(-1!==d)n=e(this.styles,e=>e.media,e=>e.media&&-1!==e.prioritySelectorIndex&&e.media.features["min-width"]&&e.media.features["max-width"],e=>!e.media.features["min-width"]&&!e.media.features["max-width"]);else{const a=[this.styles[t]];for(let e=t-1;e>=r;e--){const r=this.styles[e],l=r.media,u=l.features["min-width"],c=l.features["max-width"];if(!(u||c&&c.value===s&&r.hasWhere===h))break;a.unshift(r)}for(let e=0;e<a.length;e++){const l=a[e];if(!l.media.features["min-width"]){if(l.order>=c)break;n=t-a.length+2+e}}}break}}}}if(void 0===n)if(-1===r)n=l+1;else if(-1!==d)n=r+e(this.styles.slice(r),void 0,e=>e.media.features["max-width"]||e.media.features["min-width"]);else if(h){let e=r;for(;e<this.styles.length;e++){const r=this.styles[e];if(-1!==r.prioritySelectorIndex||!r.hasWhere||r.order>=c){n=e;break}}void 0===n&&(n=e)}else for(let e=r;e<=l;e++){n=e;const r=this.styles[e],l=r.media;if(-1!==r.prioritySelectorIndex||l.features["max-width"]||l.features["min-width"])break;if(r.hasWhere)n++;else if(r.order>=c)break}}else if(-1===d)if(h)-1===(n=this.styles.findIndex(e=>!e.hasWhere||e.media||-1!==e.prioritySelectorIndex||e.order>=c))&&(n=l+1);else{let e=0;for(;e<this.styles.length;e++){const a=this.styles[e];if(a.media||!a.hasWhere&&(a.order>=c||-1!==a.prioritySelectorIndex)){n=e;break}}void 0===n&&(n=e)}else n=e(this.styles,void 0,e=>e.media);try{if(this.element){const l=this.element.sheet;l.insertRule(a,n),r.cssRule=l.cssRules[n]}this.styles.splice(n,0,r),this.styleOfName[r.name]=r}catch(r){}}}delete(e){const n=this.element.sheet,t=e=>{var t=this.styleOfName[e];if(null!=t&&t.cssRule&&!(e in M.relations&&M.relations[e].some(e=>e in this.countOfName)))for(let e=0;e<n.cssRules.length;e++)n.cssRules[e]===t.cssRule&&(n.deleteRule(e),this.styles.splice(e,1),delete this.styleOfName[t.name])};if(e in M.classes)for(const n of M.classes[e])n in this.countOfName||t(n);else t(e)}findAndInsert(e){var t=k.findAndNew(e);if(Array.isArray(t))for(const e of t)this.insert(e);else t&&this.insert(t)}}k.Styles=[],e&&(window.MasterStyleSheet=k);class Ve extends M{}Ve.matches=/^f(ont)?:(thin|extralight|light|regular|medium|semibold|bold|bolder|extrabold|heavy)(?!\|)/,Ve.key=o(n,"weight"),Ve.unit="",Ve.values={thin:100,extralight:200,light:300,regular:400,medium:500,semibold:600,bold:700,extrabold:800,heavy:900};e="var(--font-";class We extends M{}We.matches=/^f(ont)?:(mono|sans|serif)(?!\|)/,We.key=o(n,"family"),We.values={mono:e+"mono)",sans:e+"sans)",serif:e+"serif)"};class $e extends M{}$e.matches=/^f(ont)?:([0-9]|(max|min|calc|clamp)\(.*\))((?!\|).)*$/,$e.key=o(n,"size");const je="top",ze="bottom",Ge="left",Ye="right";class Xe extends M{get props(){var e="m"===this.prefix[0]?s:u,t=o(e,Ge),n=o(e,Ye),r=o(e,je),i=o(e,ze);switch(this.prefix[1]){case"x":return{[t]:this,[n]:this};case"y":return{[r]:this,[i]:this};case"l":return{[t]:this};case"r":return{[n]:this};case"t":return{[r]:this};case"b":return{[i]:this};default:return{[e]:this}}}get order(){return"p:"===this.prefix||"m:"===this.prefix?-1:0}}Xe.id="spacing",Xe.matches=/^[pm][xytblr]?:./;class Ke extends M{}Ke.matches=/^w:./,Ke.key=v,Ke.values=I;class qe extends M{}qe.matches=/^h:./,qe.key=G,qe.values=I;class Ze extends M{}Ze.matches=/^min-w:./,Ze.key=ce,Ze.values=I;class Qe extends M{}Qe.matches=/^min-h:./,Qe.key=he,Qe.values=I;class Je extends M{}Je.matches=/^ls:./,Je.key=le,Je.unit="em";const et=o("subpixel",se),tt=o("-webkit-font","smoothing"),nt=o("-moz-osxfont","smoothing");class rt extends M{get props(){var e={};switch(this.value){case et:e[tt]=e[nt]=Object.assign(Object.assign({},this),{value:N});break;case se:e[tt]=Object.assign(Object.assign({},this),{value:se}),e[nt]=Object.assign(Object.assign({},this),{value:"grayscale"})}return e}}rt.id="fontSmoothing",rt.matches=/^f(ont)?:(antialiased|subpixel-antialiased)(?!\|)/,rt.unit="";class it extends M{}it.matches=/^f(ont)?:(normal|italic|oblique)(?!\|)/,it.key=o(n,x),it.unit="deg",it.semantics={italic:"italic",oblique:"oblique"};class ot extends M{}ot.matches=/^f(ont)?:(ordinal|slashed-zero|lining-nums|oldstyle-nums|proportional-nums|tabular-nums|diagonal-fractions|stacked-fractions)(?!\|)/,ot.key=o(n,"variant","numeric");class st extends M{}st.matches=/^lh:./,st.key=o("line",G),st.unit="";class at extends M{}at.matches=/^(object|obj):(contain|cover|fill|scale-down)/,at.key=o("object","fit");class lt extends M{}lt.matches=/^(object|obj):(top|bottom|right|left|center)/,lt.key=o("object",ie);class ut extends M{}ut.matches=/^t(ext)?:(justify|center|left|right|start|end)(?!\|)/,ut.key=o(A,ee);class ct extends M{constructor(){super(...arguments),this.order=-1}}ct.matches=/^t(ext)?:(underline|line-through|overline)/,ct.key=o(A,re),ct.colorful=!0;class dt extends M{}dt.matches=/^t(ext)?:(uppercase|lowercase|capitalize)(?!\|)/,dt.key=o(A,te),dt.semantics={uppercase:"uppercase",lowercase:"lowercase",capitalize:"capitalize"};class ht extends M{}ht.matches=/^(?:v|vertical):./,ht.key=o("vertical",ee);class ft extends M{get props(){return{overflow:Object.assign(Object.assign({},this),{value:Q}),display:Object.assign(Object.assign({},this),{value:"-webkit-box"}),"overflow-wrap":Object.assign(Object.assign({},this),{value:o(_,ne)}),"text-overflow":Object.assign(Object.assign({},this),{value:"ellipsis"}),"-webkit-box-orient":Object.assign(Object.assign({},this),{value:"vertical"}),"-webkit-line-clamp":this}}}ft.id="lines",ft.matches=/^lines:./,ft.unit="";class pt extends M{}pt.matches=/^transform:((top|bottom|right|left|center)|\d)/,pt.key=o(te,"origin"),pt.unit="px";class gt extends M{}gt.matches=/^transform:(flat|preserve-3d)(?!\|)/,gt.key=o(te,x);class mt extends M{}mt.matches=/^transform:(content|border|fill|stroke|view)(?!\|)/,mt.key=o(te,R),mt.values={content:o(h,R),border:o(a,R),fill:o(J,R),stroke:o(W,R),view:o("view",R)};class yt extends M{get parseValue(){return this.value.replace(/(translate|scale|skew|rotate|perspective|matrix)(3d|[XYZ])?\((.*?)\)/g,(e,t,n,r)=>{let i,o;switch(t){case"translate":i=oe;break;case"skew":i="deg";break;case K:"3d"===n&&(o=!0),i="deg";break;default:return e}const s=r.split(",");return e.replace(r,s.map((e,t)=>o&&s.length-1!==t||Number.isNaN(+e)?e:e/(i===oe?16:1)+i).join(","))})}}yt.matches=/^(translate|scale|skew|rotate|perspective|matrix)(3d|[XYZ])?\(/,yt.key=te,yt.unit="";class vt extends M{constructor(){super(...arguments),this.order=-1}}vt.symbol="~",vt.key=X;class bt extends M{}bt.matches=/^~delay:./,bt.key=o(X,"delay"),bt.unit="ms";class Et extends M{}Et.matches=/^~duration:./,Et.key=o(X,"duration"),Et.unit="ms";class Ct extends M{}Ct.matches=/^~property:./,Ct.key=o(X,"property");class wt extends M{}wt.matches=/^~easing:./,wt.key=o(X,q);class St extends M{}St.matches=/^max-h:./,St.key=de,St.values=I;class Tt extends M{}Tt.matches=/^max-w:./,Tt.key=ue,Tt.values=I;class Rt extends M{}Rt.matches=/^d:./,Rt.key=Z,Rt.semantics={hidden:"none",hide:"none",block:"block",table:O,flex:S,grid:T,contents:"contents",inline:Y,"inline-block":o(Y,"block"),"inline-flex":o(Y,S),"inline-grid":o(Y,T),"inline-table":o(Y,O),"table-cell":o(O,"cell"),"table-caption":o(O,"caption"),"flow-root":o("flow","root"),"list-item":o(pe,"item"),"table-row":o(O,d),"table-column":o(O,c),"table-row-group":o(O,d,fe),"table-column-group":o(O,c,fe),"table-header-group":o(O,"header",fe),"table-footer-group":o(O,"footer",fe)};class At extends M{}At.matches=/^box:(content|border)(?!\|)/,At.key=o(R,"sizing"),At.values={content:o(h,R),border:o(a,R)};class _t extends M{}_t.key="opacity",_t.unit="";class Nt extends M{}Nt.key="visibility",Nt.semantics={visible:"visible",invisible:Q};class xt extends M{}xt.key="clear";class Ot extends M{}Ot.key="float";class It extends M{}It.key="isolation",It.semantics={isolate:"isolate"};class Mt extends M{get props(){if(this.prefix)switch(this.prefix.slice(-2,-1)){case"x":return{"overflow-x":this};case"y":return{"overflow-y":this}}return{overflow:this}}get order(){if(this.prefix)switch(this.prefix.slice(-2,-1)){case"x":case"y":return 0}return-1}}Mt.id="overflow",Mt.matches=/^overflow(-x|-y)?:(?:visible|overlay|hidden|scroll|auto|clip|inherit|initial|revert|revert-layer|unset|\$|var)/,Mt.semantics={overflow:"visible"};class kt extends M{get props(){switch(this.prefix.slice(-2,-1)){case"x":return{[o(z,"x")]:this};case"y":return{[o(z,"y")]:this};default:return{[z]:this}}}}kt.id="overscrollBehavior",kt.matches=/^overscroll-behavior(?:-[xy])?:/;class Dt extends M{}Dt.matches=/^z:./,Dt.key="z-index",Dt.unit="";class Lt extends M{}Lt.matches=/^\@delay:./,Lt.key=o(y,"delay"),Lt.unit="ms";class Pt extends M{}Pt.matches=/^\@direction:./,Pt.key=o(y,$);class Ft extends M{}Ft.matches=/^\@fill-mode:./,Ft.key=o(y,J,j);class Bt extends M{}Bt.matches=/^\@iteration-count:./,Bt.key=o(y,"iteration","count"),Bt.unit="";class Ht extends M{}Ht.matches=/^\@name:./,Ht.key=o(y,"name");class Ut extends M{}Ut.matches=/^\@play-state:./,Ut.key=o(y,"play-state");class Vt extends M{}Vt.matches=/^\@easing:./,Vt.key=o(y,q);class Wt extends M{constructor(){super(...arguments),this.order=-1}}function $t(e,t,n=""){var r="border-left"+(n=n&&"-"+n),i="border-right"+n,o="border-top"+n,s="border-bottom"+n;switch(/^b(order)?-?(.)?/.exec(e)[2]){case"x":return{[r]:t,[i]:t};case"y":return{[o]:t,[s]:t};case"l":return{[r]:t};case"r":return{[i]:t};case"t":return{[o]:t};case"b":return{[s]:t};default:return{[a+n]:t}}}Wt.symbol="@",Wt.key=y,Wt.unit="";class jt extends M{get props(){return $t(this.prefix,this,g)}get order(){return this.prefix===o(a,g)+":"||"b:"===this.prefix||"border:"===this.prefix?-1:0}}jt.id="borderColor",jt.matches=/^border(-(left|right|top|bottom))?-color:./,jt.colorStarts="b([xytblr]|(order(-(left|right|top|bottom))?))?:",jt.colorful=!0,jt.values={current:r};const zt=o(a,je,Ge,t),Gt=o(a,je,Ye,t),Yt=o(a,ze,Ge,t),Xt=o(a,ze,Ye,t),Kt=o(a,t),qt=[zt,Gt,Yt,Xt];class Zt extends M{get props(){var e;if(this.prefix){let t="";const n=this.prefix.split("-");if(1<n.length)for(let e=1;e<n.length-1;e++)t+=n[e][0];else t=this.prefix.slice(1,-1);switch(t){case"t":return{[zt]:this,[Gt]:this};case"tl":case"lt":return{[zt]:this};case"rt":case"tr":return{[Gt]:this};case"b":return{[Yt]:this,[Xt]:this};case"bl":case"lb":return{[Yt]:this};case"br":case"rb":return{[Xt]:this};case"l":return{[zt]:this,[Yt]:this};case"r":return{[Gt]:this,[Xt]:this};default:return{[Kt]:this}}}const n=null==(e=this.prefix)?void 0:e.slice(0,-1);return{[qt.includes(n)?n:Kt]:this}}get order(){return this.prefix===o(a,t)+":"||"r:"===this.prefix?-1:0}}Zt.id="borderRadius",Zt.matches=/^((r[tblr]?[tblr]?|border(-(top|bottom)-(left|right))?-radius):.)/,Zt.semantics={rounded:"1e9em",round:"50%"};class Qt extends M{get props(){return $t(this.prefix,this,x)}get order(){return this.prefix===o(a,x)+":"||"b:"===this.prefix||"border:"===this.prefix?-1:0}}Qt.id="borderStyle",Qt.matches=/^(border(-(left|right|top|bottom))?-style:.|b([xytblr]|order(-(left|right|top|bottom))?)?:(none|hidden|dotted|dashed|solid|double|groove|ridge|inset|outset)(?!\|))/;class Jt extends M{get props(){return $t(this.prefix,this,v)}get order(){return this.prefix===o(a,v)+":"||"b:"===this.prefix||"border:"===this.prefix?-1:0}}Jt.id="borderWidth",Jt.matches=/^(border(-(left|right|top|bottom))?-width:.|b([xytblr]|order(-(left|right|top|bottom))?)?:(([0-9]|(max|min|calc|clamp)\(.*\))|(max|min|calc|clamp)\(.*\))((?!\|).)*$)/;class en extends M{get props(){return $t(this.prefix,this)}get order(){return"border:"===this.prefix||"b:"===this.prefix?-2:-1}}en.id="border",en.matches=/^b([xytblr]?|order(-(left|right|top|bottom))?):./,en.colorful=!0;class tn extends M{}tn.matches=/^(bg|background):(fixed|local|scroll)(?!\|)/,tn.key=o(p,"attachment");class nn extends M{}nn.key=o(p,"blend",j);class rn extends M{get props(){return{"-webkit-background-clip":this,"background-clip":this}}}rn.matches=/^(bg|background):text(?!\|)/,rn.key=o(p,"clip"),rn.values={content:o(h,R),border:o(a,R),padding:o(u,R)};class D extends M{}D.matches=/^(bg|background):transparent(?!\|)/,D.colorStarts="(bg|background):",D.key=o(p,g),D.unit="",D.colorful=!0,D.values={current:r};class on extends M{}on.matches=/^(bg|background):(content|border|padding)(?!\|)/,on.key=o(p,"origin"),on.values={content:o(h,R),border:o(a,R),padding:o(u,R)};class sn extends M{}sn.matches=/^(bg|background):(top|bottom|right|left|center)(?!\|)/,sn.key=o(p,ie),sn.unit="px";class an extends M{}an.matches=/^(bg|background):(space|round|repeat|no-repeat|repeat-x|repeat-y)(?![;a-zA-Z])/,an.key=o(p,"repeat");class ln extends M{}ln.matches=/^(bg|background):((auto|cover|contain)(?!\|)|\.?\d((?!\|).)*$)/,ln.key=o(p,"size");class un extends M{}un.matches=/^(bg|background):(url|linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient|conic-gradient)\(.*\)((?!\|).)*$/,un.key=o(p,f),un.colorful=!0;class cn extends M{constructor(){super(...arguments),this.order=-1}}cn.matches=/^bg:./,cn.key=p,cn.colorful=!0;class dn extends M{}dn.matches=/^blend:./,dn.key=o("mix","blend",j);class hn extends M{}hn.key=ie,hn.values={abs:"absolute",rel:"relative"},hn.semantics={static:"static",fixed:"fixed",abs:"absolute",rel:"relative",sticky:"sticky"};class fn extends M{get props(){var e=this.prefix.slice(0,-1);switch(e){case je:case Ge:case Ye:case ze:return{[e]:this};case"center":return{left:this,right:this,"margin-left":Object.assign(Object.assign({},this),{unit:""}),"margin-right":Object.assign(Object.assign({},this),{unit:""})};case"middle":return{top:this,bottom:this,"margin-top":Object.assign(Object.assign({},this),{unit:""}),"margin-bottom":Object.assign(Object.assign({},this),{unit:""})}}}}function pn(s,a){let l="",u=0;return function e(t,n){let r="";const i=n?a(n):"",o=()=>{r&&(l+=!i||Number.isNaN(+r)?r:+r/(i===oe?16:1)+i,r="")};for(;u<s.length;u++){const a=s[u];if(a===t&&("'"!==t||")"===s[u+1])){o(),l+=a;break}","===a||" "===a?(o(),l+=a):r||"'"!==a?r&&"("===a?(l+=r+a,u++,e(")",r),r=""):r+=a:(l+=a,u++,e(a),r="")}o()}(),l}fn.matches=/^(top|left|right|bottom|center|middle):./;class gn extends M{get props(){return{"backdrop-filter":this,"-webkit-backdrop-filter":this}}get parseValue(){return pn(this.value,e=>{switch(e){case"blur":case o("drop",V):return oe;case o("hue",K):return"deg"}return""})}}gn.matches=/^bd:./,gn.key=o("backdrop","filter"),gn.colorful=!0;class mn extends M{}mn.key=J,mn.colorStarts="fill:",mn.colorful=!0,mn.values={current:r};class yn extends M{}yn.key=W,yn.colorful=!0;class vn extends M{}vn.matches=/^stroke:([0-9]|(max|min|calc|clamp)\(.*\))((?!\|).)*$/,vn.key=o(W,v);class bn extends M{get parseValue(){return pn(this.value,e=>{switch(e){case"blur":case o("drop",V):return oe;case o("hue",K):return"deg"}return""})}}bn.matches=/^(blur|brightness|contrast|drop-shadow|grayscale|hue-rotate|invert|opacity|saturate|sepia)\(/,bn.key="filter",bn.colorful=!0;class En extends M{}En.key="cursor";class Cn extends M{}Cn.key=o("pointer","events"),Cn.semantics={untouchable:"none"};class wn extends M{}wn.key="resize";class Sn extends M{}Sn.key=o("touch","action");class Tn extends M{get props(){return{"user-drag":this,"-webkit-user-drag":this}}}Tn.key=o("user","drag");class Rn extends M{get props(){return{"user-select":this,"-webkit-user-select":this}}}Rn.key=o("user","select");class An extends M{}An.matches=/^s(?:hadow)?:./,An.key=o(R,V),An.colorful=!0;class _n extends M{}_n.key=o(A,V),_n.colorful=!0;class Nn extends M{get props(){return{"font-size":this,"line-height":Object.assign(Object.assign({},this),{value:this.unit===oe?this.value+.375+this.unit:"calc("+this.value+this.unit+" + .375rem)",unit:""})}}}Nn.id="textSize",Nn.matches=/^t(ext)?:([0-9]|(max|min|calc|clamp)\(.*\))((?!\|).)*$/;class xn extends M{}xn.key=o(ne,_),xn.unit="";class On extends M{get props(){return{display:Object.assign(Object.assign({},this),{value:T}),[o(T,i,H)]:Object.assign(Object.assign({},this),{value:"repeat("+this.value+","+E+"max(0,1fr))"})}}}On.matches=/^grid-cols:./,On.key=o(T,H),On.unit="";class In extends M{get props(){return{display:Object.assign(Object.assign({},this),{value:T}),[o(T,N,"flow")]:Object.assign(Object.assign({},this),{value:c}),[o(T,i,U)]:Object.assign(Object.assign({},this),{value:"repeat("+this.value+","+E+"max(0,1fr))"})}}}In.key=o(T,U),In.unit="";class Mn extends M{constructor(){super(...arguments),this.order=-1}get props(){switch(this.prefix[4]){case"x":return{[o(c,"gap")]:this};case"y":return{[o(d,"gap")]:this};default:return{gap:this}}}}Mn.id="gap",Mn.matches=/^gap(-x|-y)?:./;class kn extends M{}kn.key=o(ne,ae);class Dn extends M{get props(){return{["--"+this.prefix.slice(1,-1)]:this}}}Dn.id="variable",Dn.matches=/^\$.+:./,Dn.unit="";class Ln extends M{}Ln.matches=/^aspect:./,Ln.key=o("aspect","ratio"),Ln.unit="",Ln.semantics={square:"1/1",video:"16/9"};class Pn extends M{get props(){return{"box-decoration-break":this,"-webkit-box-decoration-break":this}}}Pn.matches=/^box:(slice|clone)(?!\|)/,Pn.key=o(R,re,_);class Fn extends M{}Fn.key=o(_,"after");class Bn extends M{}Bn.key=o(_,"before");class Hn extends M{}Hn.key=o(_,"inside");class Un extends M{}Un.key=o(S,"shrink"),Un.unit="";class Vn extends M{}Vn.matches=/^flex:((row|col|column)(-reverse)?)(?!\|)/,Vn.key=o(S,$),Vn.values={col:c,"col-reverse":o(c,"reverse")};class Wn extends M{}Wn.key=o(S,"grow"),Wn.unit="";class $n extends M{}$n.matches=/^flex:(wrap(-reverse)?|nowrap)(?!\|)/,$n.key=o(S,"wrap");class jn extends M{}jn.key=o(S,"basis"),jn.values=I;class zn extends M{constructor(){super(...arguments),this.order=-1}}zn.key=S,zn.unit="";class Gn extends M{}Gn.matches=/^o:./,Gn.key="order",Gn.values={first:"-999999",last:"999999"},Gn.unit="";class Yn extends M{constructor(){super(...arguments),this.order=-1}get parseValue(){return"span"===this.prefix.slice(-5,-1)&&"auto"!==this.value?"span "+this.value+"/span "+this.value:this.value}}Yn.matches=/^grid-col(?:umn)?(?:-span)?:./,Yn.key=o(T,c),Yn.unit="";class Xn extends M{}Xn.matches=/^col-span:./,Xn.key=o(c,"span");class Kn extends M{constructor(){super(...arguments),this.order=-1}get parseValue(){return"span"===this.prefix.slice(-5,-1)&&"auto"!==this.value?"span "+this.value+"/span "+this.value:this.value}}Kn.matches=/^grid-row-span:./,Kn.key=o(T,d),Kn.unit="";class L extends M{}L.matches=/^(font-color:.|font:current)/,L.colorStarts="(?:f(ont)?|color):",L.colorful=!0,L.key=g,L.unit="",L.values={current:r};class qn extends M{}qn.matches=/^ac:./,qn.key=o(ee,h);class Zn extends M{}Zn.matches=/^ai:./,Zn.key=o(ee,"items");class Qn extends M{}Qn.matches=/^as:./,Qn.key=o(ee,"self");class Jn extends M{}Jn.matches=/^grid-auto-cols:./,Jn.key=o(T,N,H),Jn.values={min:o(E,h),max:o(b,h)};class er extends M{}er.matches=/^grid-flow:./,er.key=o(T,N,"flow");class tr extends M{}tr.key=o(T,N,U),tr.values={min:o(E,h),max:o(b,h)};class nr extends M{}nr.matches=/^jc:./,nr.key=o(ge,h);class rr extends M{}rr.matches=/^ji:./,rr.key=o(ge,"items");class ir extends M{}ir.matches=/^js:./,ir.key=o(ge,"self");class or extends M{constructor(){super(...arguments),this.order=-1}}or.key=o("place",h);class sr extends M{constructor(){super(...arguments),this.order=-1}}sr.key=o("place","items");class ar extends M{constructor(){super(...arguments),this.order=-1}}ar.key=o("place","self");class lr extends M{get props(){return{[this.prefix.slice(0,-1)]:this}}get order(){return"padding:"===this.prefix?-1:0}}lr.id="padding",lr.matches=/^padding(?:-(?:left|right|top|bottom))?:./;class ur extends M{get props(){return{[this.prefix.slice(0,-1)]:this}}get order(){return"margin:"===this.prefix?-1:0}}ur.id="margin",ur.matches=/^margin(-(left|right|top|bottom))?:./;class cr extends M{}cr.matches=/^(text-(overflow|ovf):.|t(ext)?:(ellipsis|clip)(?!\|))/,cr.key=o(A,"overflow");class dr extends M{}dr.matches=/^list-style:(inside|outside)(?!\|)/,dr.key=o(pe,x,ie);class hr extends M{}hr.matches=/^list-style:(disc|decimal)(?!\|)/,hr.key=o(pe,x,"type");class fr extends M{constructor(){super(...arguments),this.order=-1}}fr.key=o(pe,x);class pr extends M{}pr.key=o(A,re,g),pr.colorStarts="text-decoration:",pr.colorful=!0,pr.values={current:r};class gr extends M{}gr.matches=/^t(ext)?:(solid|double|dotted|dashed|wavy)(?!\|)/,gr.key=o(A,re,x);class mr extends M{}mr.matches=/^text-decoration:(from-font(?!\|)|([0-9]|(max|min|calc|clamp)\(.*\))((?!\|).)*$)/,mr.key=o(A,re,"thickness"),mr.unit="em";class yr extends M{}yr.key=o(A,"indent");class vr extends M{}vr.key=h;class br extends M{}br.key=o(ye,g),br.colorStarts="outline:",br.colorful=!0,br.values={current:r};class Er extends M{}Er.key=o(ye,me);class Cr extends M{}Cr.matches=/^outline:(none|dotted|dashed|solid|double|groove|ridge|inset|outset)(?!\|)/,Cr.key=o(ye,x);class wr extends M{}wr.matches=/^outline:(medium|thick|thin|[0-9]|(max|min|calc|clamp)\(.*\))((?!\|).)*$/,wr.key=o(ye,v);class Sr extends M{constructor(){super(...arguments),this.order=-1}}Sr.key=ye,Sr.colorful=!0;class Tr extends M{}Tr.matches=/^b(order)?:(collapse|separate)(?!\|)/,Tr.key=o(a,"collapse");class Rr extends M{}Rr.key=o(a,ae);class Ar extends M{}Ar.key=o(O,"layout");class _r extends M{}_r.key=o("accent",g),_r.colorStarts="accent:",_r.colorful=!0;class Nr extends M{}Nr.key="appearance";class xr extends M{}xr.key=o("caret",g),xr.matches=/^caret:transparent(?!\|)/,xr.colorStarts="caret:",xr.colorful=!0,xr.values={current:r};class Or extends M{}Or.key=o(m,"behavior");class Ir extends M{get props(){if("m"!==this.prefix.slice(-3,-2))return{[this.prefix.replace(/-m(?!argin)/,"-margin").slice(0,-1)]:this};var e=o(m,s)+"-",t=e+Ge,n=e+Ye,r=e+je,i=e+ze;switch(this.prefix.slice(-2,-1)){case"x":return{[t]:this,[n]:this};case"y":return{[r]:this,[i]:this};case"l":return{[t]:this};case"r":return{[n]:this};case"t":return{[r]:this};case"b":return{[i]:this}}}get order(){return this.prefix===o(m,s)+":"||this.prefix===o(m,"m:")?-1:0}}Ir.id="scrollMargin",Ir.matches=/^scroll-m([xytblr]|argin(-(top|bottom|left|right))?)?:./;class Mr extends M{get props(){if("p"!==this.prefix.slice(-3,-2))return{[this.prefix.replace(/-p(?!adding)/,"-padding").slice(0,-1)]:this};var e=o(m,u)+"-",t=e+Ge,n=e+Ye,r=e+je,i=e+ze;switch(this.prefix.slice(-2,-1)){case"x":return{[t]:this,[n]:this};case"y":return{[r]:this,[i]:this};case"l":return{[t]:this};case"r":return{[n]:this};case"t":return{[r]:this};case"b":return{[i]:this}}}get order(){return this.prefix===o(m,u)+":"||this.prefix===o(m,"p:")?-1:0}}Mr.id="scrollPadding",Mr.matches=/^scroll-p([xytblr]|adding(-(top|bottom|left|right))?)?:./;class kr extends M{}kr.matches=/^scroll-snap:(start|end|center)/,kr.key=o(m,"snap",ee);class Dr extends M{}Dr.matches=/^scroll-snap:(normal|always)(?!\|)/,Dr.key=o(m,"snap","stop");class Lr extends M{}Lr.matches=/^scroll-snap:(([xy]|block|inline|both)(\|(proximity|mandatory))?)(?!\|)/,Lr.key=o(m,"snap","type");class Pr extends M{}Pr.key="will-change";class Fr extends M{}Fr.key=o(A,"underline",me);class Br extends M{get props(){return{[this.prefix.slice(0,-1)]:this}}}Br.matches=/^(?:top|bottom|left|right):./,Br.key="inset";class Hr extends M{constructor(){super(...arguments),this.order=-1}}Hr.matches=/^(columns|cols):./,Hr.key=H,Hr.unit="";class Ur extends M{}Ur.key=o("white","space"),Ur.unit="";class Vr extends M{}Vr.matches=/^t(ext)?:(mixed|upright|sideways-right|sideways|use-glyph-orientation)(?!\|)/,Vr.key=o(A,"orientation");class Wr extends M{}Wr.matches=/^writing:./,Wr.key=o("writing",j);class $r extends M{}$r.key="contain";class jr extends M{}jr.matches=/^\@duration:./,jr.key=o(y,"duration"),jr.unit="ms";class zr extends M{}zr.matches=/^t(ext)?:(optimizeSpeed|optimizeLegibility|geometricPrecision)(?!\|)/,zr.key=o(A,"rendering");class Gr extends M{}Gr.key=$;class Yr extends M{}Yr.matches=/^t(ext)?:(none|underline|overline|line-through)(?!\|)/,Yr.key=o(A,re,"line");class Xr extends M{}Xr.matches=/^grid-col-start:./,Xr.key=o(T,c,"start"),Xr.unit="";class Kr extends M{}Kr.matches=/^list-style:(url|linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient|conic-gradient)\(.*\)((?!\|).)*$/,Kr.key=o(pe,x,f);class qr extends M{}qr.matches=/^shape:((margin|content|border|padding)(?!\|)|(inset|circle|ellipse|polygon|url|linear-gradient)\(.*\)((?!\|).)*$)/,qr.key=o("shape","outside"),qr.values={content:o(h,R),border:o(a,R),padding:o(u,R),margin:o(s,R)};class Zr extends M{}Zr.matches=/^shape:([0-9]|(max|min|calc|clamp)\(.*\))((?!\|).)*$/,Zr.key=o("shape",s);class Qr extends M{}Qr.key=o("shape",f,"threshold"),Qr.unit="";class Jr extends M{}Jr.matches=/^clip:./,Jr.key=o("clip","path"),Jr.values={content:o(h,R),border:o(a,R),padding:o(u,R),margin:o(s,R),fill:o(J,R),stroke:o(W,R),view:o("view",R)};class ei extends M{constructor(){super(...arguments),this.order=-1}}ei.key=T;class ti extends M{constructor(){super(...arguments),this.order=-1}}ti.matches=/^f:./,ti.key=n,ti.unit="",ti.colorful=!0;class ni extends M{}ni.key="quotes";class ri extends M{constructor(){super(...arguments),this.order=-1}}ri.key=o(T,i);class ii extends M{}ii.key=o(T,d,"start"),ii.unit="";class oi extends M{}oi.key=o(T,i,"area")+"s";class si extends M{}si.matches=/^grid-template-cols:./,si.key=o(T,i,H),si.values={min:o(E,h),max:o(b,h)};class ai extends M{}ai.key=o(T,i,U),ai.values={min:o(E,h),max:o(b,h)};class li extends M{constructor(){super(...arguments),this.order=-1}}li.key=o(T,"area"),li.unit="";class ui extends M{}ui.matches=/^grid-col-end:./,ui.key=o(T,c,"end"),ui.unit="";class ci extends M{}ci.key=o(T,d,"end"),ci.unit="";class di extends M{get props(){return{"mask-image":this,"-webkit-mask-image":this}}}di.key=o("mask",f);class hi extends M{get props(){return{"-webkit-text-fill-color":this}}}hi.id="textFillColor",hi.matches=/^text-fill-color:./,hi.colorStarts="text-fill:",hi.colorful=!0,hi.values={current:r};class fi extends M{get props(){return{"-webkit-text-stroke":this}}}fi.id="textStroke",fi.matches=/^text-stroke:./;class pi extends M{get props(){return{"-webkit-text-stroke-width":this}}}pi.id="textStrokeWidth",pi.matches=/^text-stroke(:((thin|medium|thick)(?!\|)|\.?\d((?!\|).)*$)|-width:.)/;class gi extends M{get props(){return{"-webkit-text-stroke-color":this}}}gi.id="textStrokeColor",gi.matches=/^text-stroke-color:./,gi.colorStarts="text-stroke:",gi.colorful=!0,gi.values={current:r};class mi extends M{}mi.key=o(W,"dasharray");class yi extends M{}yi.key=o(W,"dash")+me;class vi extends M{}vi.key="x",vi.unit="";class bi extends M{}bi.key="y",bi.unit="";class Ei extends M{}Ei.key="cx",Ei.unit="";class Ci extends M{}Ci.key="cy",Ci.unit="";class wi extends M{}wi.key="rx",wi.unit="";class Si extends M{}Si.key="ry",Si.unit="";class Ti extends M{}Ti.key=o(a,f,"outset");class Ri extends M{}Ri.matches=/^border-image:(?:stretch|repeat|round|space)(?:(?!\|).)*$/,Ri.key=o(a,f,"repeat");class Ai extends M{}Ai.key=o(a,f,"slice"),Ai.unit="";class _i extends M{}_i.matches=/^border-image:(?:url|linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient|conic-gradient)\(.*\)(?:(?!\|).)*$/,_i.key=o(a,f,"source");class Ni extends M{}Ni.matches=/^border-image:(?:\.?[0-9]|(max|min|calc|clamp)\(.*\))(?:(?!\|).)*$/,Ni.key=o(a,f,v);class xi extends M{}xi.key=o(a,f),xi.unit="";const Oi=/\{(.*)\}/;class Ii extends M{get props(){const r={},n=e=>{var t,n=e.indexOf(":");-1===n||(t=e.slice(0,n))in r||(r[t]={value:e.slice(n+1)})},e=e=>{var t=e.text.slice(CSS.escape(e.name).length).match(Oi)[1].split(";");for(const e of t)n(e)},t=[];let i="";const o=()=>{i&&(t.push(i),i="")};let s=1;const a=e=>{for(;s<this.value.length;s++){var t=this.value[s];if(!e){if(";"===t){o();continue}if("}"===t)break}if(i+=t,e===t){if("'"===e){let t=0;for(let e=i.length-2;"\\"===i[e];e--)t++;if(t%2)continue}break}t in F&&"'"!==e&&(s++,a(F[t]))}};a(void 0),o();for(const r of t){const t=k.findAndNew(r);if(Array.isArray(t))for(const r of t)e(r);else t?e(t):n(r)}return r}}Ii.id=fe,Ii.matches=/^(?:.+?[*_>~+])?\{.+?\}/,Ii.unit="";class Mi extends M{}Mi.key="counter-increment",Mi.unit="";e=Ui(580),e=Ui.n(e);class ki extends M{}ki.semantics={"center-content":{"justify-content":"center","align-items":"center"},"sr-only":{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0,0,0,0)","white-space":"nowrap","border-width":"0"},full:{width:"100%",height:"100%"},center:{left:0,right:0,"margin-left":N,"margin-right":N},middle:{top:0,bottom:0,"margin-top":N,"margin-bottom":N},"break-spaces":{"white-space":o(_,"space")+"s"},"break-word":{"overflow-wrap":o(_,ne),overflow:Q}};const Di="undefined"!=typeof window,Li=[ki,Ii,Dn,Ve,We,L,Xe,ur,lr,$e,jn,$n,Wn,Un,Vn,zn,Rt,Ke,qe,Ze,Qe,$r,vr,Mi,Je,rt,it,ot,ti,st,at,lt,ut,pr,gr,mr,Yr,ct,Fr,cr,Vr,dt,zr,yr,ht,Hr,Ur,Br,ft,St,Tt,At,_t,Nt,xt,Ot,It,Mt,kt,Dt,hn,fn,En,Cn,wn,Sn,xn,kn,Tn,Rn,_n,Nn,hi,pi,gi,fi,An,Ar,mt,gt,pt,yt,Ct,wt,Et,bt,vt,Lt,Pt,jr,Ft,Bt,Ht,Ut,Vt,Wt,jt,Zt,Qt,Jt,Tr,Rr,en,Ti,Ri,Ai,_i,Ni,xi,tn,nn,rn,D,on,sn,an,ln,un,cn,dn,gn,bn,mn,mi,yi,vn,yn,vi,bi,Ei,Ci,wi,Si,Xr,ui,Yn,On,ii,ci,Kn,In,Jn,er,tr,oi,si,ai,ri,li,ei,Mn,Gn,Hn,Bn,Fn,Pn,Ln,Xn,qn,Zn,Qn,nr,rr,ir,or,sr,ar,dr,hr,Kr,fr,br,Er,Cr,wr,Sr,_r,Nr,xr,Or,Ir,Mr,kr,Dr,Lr,Pr,Wr,Gr,qr,Zr,Qr,Jr,ni,di],Pi=Li.get=n=>Li.find(e=>{var t;return n===e.id||n===(null==(t=e.key)?void 0:t.replace(/-./g,e=>e[1].toUpperCase()))||n===e.key});function Fi(){var e;Di&&(e=new k(document.head),(k.root=e).observe(document.documentElement))}Li.extend=function(e,...t){var n=Object.assign({},...t);for(const t in n){var r,i=Pi(t);i&&(r=n[t],i.extend(e,r))}return this},M.extend("colors",e()).extend("breakpoints",B()),k.Styles.push(...Li),Di&&(window.initMasterCSS=Fi,window.MasterStyles=Li,window.MasterCSSManual||Fi());const Bi=Ui(580),Hi=Ui(642)})(),Vi;function Ui(e){var t=r[e];return void 0!==t||(t=r[e]={exports:{}},n[e](t,t.exports,Ui)),t.exports}var n,r,Vi}),function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;if(void 0!==this)return this;throw new Error("전역 객체를 찾을 수 없습니다")}),globalRoot=getGlobal(),syn=(globalRoot.devicePlatform="browser","AndroidScript"in globalRoot?globalRoot.devicePlatform="android":"webkit"in globalRoot?globalRoot.devicePlatform="ios":"process"in globalRoot&&"object"==typeof module&&(globalRoot.devicePlatform="node"),syn||function(){});syn.module=function(){},syn.module.extend=function(e,t){var n=syn.module.prototype.extend,r=(syn.module.prototyping=!0,new this),i=(n.call(r,e),r.base=function(){},delete syn.module.prototyping,r.constructor),o=r.constructor=function(){if(!syn.module.prototyping)if(this.constructing||this.constructor==o)this.constructing=!0,i.apply(this,arguments),delete this.constructing;else if(null!=arguments[0])return(arguments[0].extend||n).call(arguments[0],r)};return o.ancestor=this,o.extend=this.extend,o.each=this.each,o.implement=this.implement,o.prototype=r,o.toString=this.toString,o.valueOf=function(e){return"object"==e?o:i.valueOf()},n.call(o,t),"function"==typeof o.init&&o.init(),o},syn.module.prototype={extend(e,t){if(1<arguments.length){var n,r=this[e];!r||"function"!=typeof t||r.valueOf&&r.valueOf()==t.valueOf()||!/\bbase\b/.test(t)||(n=t.valueOf(),(t=function(){var e=this.base||syn.module.prototype.base,t=(this.base=r,n.apply(this,arguments));return this.base=e,t}).valueOf=function(e){return"object"==e?t:n},t.toString=syn.module.toString),"config"===e?this[e]=function(){var e,t={};for(e in arguments){var n,r=arguments[e];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}(this[e],t):this[e]=t}else if(e){for(var i,o=syn.module.prototype.extend,s=(syn.module.prototyping||"function"==typeof this||(o=this.extend||o),{toSource:null}),a=["constructor","toString","valueOf","concreate"],l=syn.module.prototyping?0:1;i=a[l++];)e[i]!=s[i]&&o.call(this,i,e[i]);for(i in e)s[i]||o.call(this,i,e[i]);var u=e.concreate;u&&u(e)}return this}},syn.module=syn.module.extend({constructor(){this.extend(arguments[0])},concreate(){}},{ancestor:Object,version:"1.0.0",each(e,t,n){if(null!=t&&0!=t.length)for(var r in e)"object"==typeof e[r]&&t.apply(e[r],n)},implement(){for(var e=0,t=arguments.length;e<t;e++)"function"==typeof arguments[e]?arguments[e](this.prototype):this.prototype.extend(arguments[e]);return this},toString(){return String(this.valueOf())}}),globalRoot.syn=syn,!function(t){"use strict";var n=t.$browser||new syn.module,s=t.document;n.extend({version:"1.0.0",appName:navigator.appName,appCodeName:navigator.appCodeName,appVersion:navigator.appVersion,cookieEnabled:navigator.cookieEnabled,pdfViewerEnabled:navigator.pdfViewerEnabled,platform:navigator.platform,devicePlatform:t.devicePlatform,userAgent:navigator.userAgent,devicePixelRatio:t.devicePixelRatio,isExtended:screen.isExtended,screenWidth:screen.width,screenHeight:screen.height,language:"Netscape"==navigator.appName?navigator.language:navigator.browserLanguage,isWebkit:-1<navigator.userAgent.indexOf("AppleWebKit/"),isMac:-1!=navigator.appVersion.indexOf("Mac")||-1!=navigator.userAgent.indexOf("Macintosh"),isLinux:-1!=navigator.appVersion.indexOf("Linux")||-1!=navigator.appVersion.indexOf("X11"),isWindow:-1!=navigator.appVersion.indexOf("Win")||-1!=navigator.userAgent.indexOf("Windows"),isOpera:"Opera"==navigator.appName,isIE:!!s.documentMode||"Netscape"==navigator.appName&&-1!=navigator.userAgent.indexOf("trident")||-1!=navigator.userAgent.indexOf("msie"),isChrome:!!t.chrome&&-1==navigator.userAgent.indexOf("Edg"),isEdge:!!t.chrome&&-1<navigator.userAgent.indexOf("Edg"),isFF:"undefined"!=typeof InstallTrigger||-1!==navigator.userAgent.indexOf("Firefox"),isSafari:/constructor/i.test(t.HTMLElement)||"[object SafariRemoteNotification]"===(!t.safari||"undefined"!=typeof safari&&t.safari.pushNotification).toString(),isMobile:!(!navigator.userAgentData||1!=navigator.userAgentData.mobile)||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone/i.test(navigator.userAgent),getSystemFonts(){return["-apple-system","BlinkMacSystemFont","Cantarell","Consolas","Courier New","Droid Sans","Fira Sans","Helvetica Neue","Menlo","Monaco","Oxygen","Roboto","source-code-pro","Segoe UI","Ubuntu"].filter(e=>s.fonts.check("12px "+e)).join(", ")},getCanvas2dRender(){var e=s.createElement("canvas"),t=(e.width=200,e.height=50,e.getContext("2d"));if(!t)return null;t.font="21.5px Arial",t.fillText("😉",0,20),t.font="15.7px serif",t.fillText("abcdefghijklmnopqrtsuvwxyz",0,40),t.font="20.5px Arial";var n=t.createLinearGradient(0,0,e.width,e.height);return n.addColorStop(0,"red"),n.addColorStop(.5,"green"),n.addColorStop(1,"blue"),t.fillStyle=n,t.fillText("Lorem ipsum!",30,20),t.beginPath(),t.moveTo(170,5),t.lineTo(160,25),t.lineTo(185,20),t.fill(),e.toDataURL()},getWebglRender(){var e,t,n,r,i=s.createElement("canvas"),o=(i.width=50,i.height=50,i.getContext("webgl"));return o?(r=[[-.1,.8,0],[-.8,-.8,0],[.8,-.7,0]].flat(),e=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,e),o.bufferData(o.ARRAY_BUFFER,new Float32Array(r),o.STATIC_DRAW),e=[0,1,2],r=o.createBuffer(),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,r),o.bufferData(o.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),o.STATIC_DRAW),r=o.createShader(o.VERTEX_SHADER),o.shaderSource(r,"attribute vec3 coordinates;void main(void) {gl_Position = vec4(coordinates, 1.0);}"),o.compileShader(r),t=o.createShader(o.FRAGMENT_SHADER),o.shaderSource(t,"void main(void) {gl_FragColor = vec4(0.0, 0.0, 0.0, 0.5);}"),o.compileShader(t),n=o.createProgram(),o.attachShader(n,r),o.attachShader(n,t),o.linkProgram(n),o.useProgram(n),r=o.getAttribLocation(n,"coordinates"),o.vertexAttribPointer(r,3,o.FLOAT,!1,0,0),o.enableVertexAttribArray(r),o.clearColor(1,1,1,1),o.enable(o.DEPTH_TEST),o.clear(o.COLOR_BUFFER_BIT),o.viewport(0,0,i.width,i.height),o.drawElements(o.TRIANGLES,e.length,o.UNSIGNED_SHORT,0),i.toDataURL()):null},getPlugins(){return Array.from(navigator.plugins).map(e=>e.name+": "+e.filename).join(", ")},async fingerPrint(){var e={appName:n.appName,appCodeName:n.appCodeName,cookieEnabled:n.cookieEnabled,pdfViewerEnabled:n.pdfViewerEnabled,devicePixelRatio:n.devicePixelRatio,isExtended:n.isExtended,screenWidth:n.screenWidth,screenHeight:n.screenHeight,userAgent:n.userAgent,platform:n.platform,plugins:n.getPlugins(),dateFormat:new Date(0).toString(),fonts:n.getSystemFonts(),canvas2dRender:n.getCanvas2dRender(),webglRender:n.getWebglRender(),ipAddress:await n.getIpAddress()};return syn.$c.sha256(JSON.stringify(e))},windowWidth(){var e=null;return t.innerWidth?e=t.innerWidth:s.documentElement&&s.documentElement.clientWidth?e=s.documentElement.clientWidth:s.body&&(e=s.body.offsetWidth),e},windowHeight(){var e=null;return t.innerHeight?e=t.innerHeight:s.documentElement&&s.documentElement.clientHeight?e=s.documentElement.clientHeight:s.body&&(e=s.body.clientHeight),e},async getIpAddress(){var e="127.0.0.1";try{var t=await syn.$w.apiHttp("/checkip").send(null,{timeout:200}),e=200===t.status&&1==syn.$v.regexs.ipAddress.test(t.response)?t.response:"127.0.0.1"}catch(e){syn.$l.eventLog("$b.getIpAddress",e,"Error")}return e}}),syn.$b=n}(globalRoot),!function(n){"use strict";var s=n.$manipulation||new syn.module,o=n.document;s.extend({version:"1.0.0",body(){return o},documentElement(){return o.documentElement},childNodes(e){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:e.childNodes},children(e){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:e.children},firstChild(e){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:e.firstChild},firstElementChild(e){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:e.firstElementChild},lastChild(e){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:e.lastChild},lastElementChild(e){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:e.lastElementChild},nextSibling(e){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:e.nextSibling},nextElementSibling(e){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:e.nextElementSibling},previousSibling(e){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:e.previousSibling},previousElementSibling(e){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:e.previousElementSibling},siblings(t){return t=1==$object.isString(t)?syn.$l.get(t):t,1==$object.isNullOrUndefined(t)?null:[].slice.call(t.parentElement.children).filter(function(e){return e!==t})},parentNode(e){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:e.parentNode},parentElement(e){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:e.parentElement},value(e,t){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:(e.value=$string.toValue(t),e.value)},textContent(e,t){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:(e.textContent=$string.toValue(t),e.textContent)},innerText(e,t){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:(e.innerText=$string.toValue(t),e.innerText)},innerHTML(e,t){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:(e.innerHTML=$string.toValue(t),e.innerHTML)},outerHTML(e){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:e.outerHTML},className(e){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:e.className},removeAttribute(e,t){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:e.removeAttribute(t)},getAttribute(e,t){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:e.getAttribute(t)},setAttribute(e,t,n){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:e.setAttribute(t,n)},appendChild(e,t){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:e.appendChild(t)},setStyle(e,t,n){return e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e)&&(e.style[t]=n),s},addCssText(e,t){return e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e)&&(e.style.cssText=t),s},addStyle(e,t){if(e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e))for(var n in t)s.setStyle(e,n,t[n]);return s},getStyle(e,t){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:e.style[t]},hasHidden(e){return null==(e=1==$object.isString(e)?syn.$l.get(e):e)||null==e.offsetParent||"none"==n.getComputedStyle(e).display},getComputedStyle(e,t){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:n.getComputedStyle(e)[t]},addClass(e,t){if(e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e)&&0==$string.isNullOrEmpty(t))if(-1<t.indexOf(" "))for(var n=t.split(" "),r=0,i=n.length;r<i;r++){var o=n[r];0==$string.isNullOrEmpty(o)&&0==s.hasClass(e,o)&&(e.classList&&e.classList.add?e.classList.add(o):e.className=(e.className+" "+o).replace(/^\s\s*/,"").replace(/\s\s*$/,""))}else 0==s.hasClass(e,t)&&(e.classList&&e.classList.add?e.classList.add(t):e.className=(e.className+" "+t).replace(/^\s\s*/,"").replace(/\s\s*$/,""));return s},hasClass(e,t){var n=!1;return e=1==$object.isString(e)?syn.$l.get(e):e,n=0==$object.isNullOrUndefined(e)?e.classList&&e.classList.contains?e.classList.contains(t):syn.$m.getClassRegEx(t).test(e.className):n},toggleClass(e,t){return e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e)&&e.classList&&e.classList.toggle&&e.classList.toggle(t),s},removeClass(e,t){return e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e)&&(void 0===t?e.className="":e.classList&&e.classList.remove?e.classList.remove(t):(t=syn.$m.getClassRegEx(t),e.className=e.className.replace(t,""),t=null)),s},append(e,t,n,r){var i=null;return e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e)&&0==$string.isNullOrEmpty(t)&&(i=o.createElement(t),0==$string.isNullOrEmpty(n)&&(i.id=n),0==$object.isNullOrUndefined(r)&&(0==$string.isNullOrEmpty(r.type)&&(i.type=r.type),0==$object.isNullOrUndefined(r.styles)&&s.addStyle(i,r.styles),0==$string.isNullOrEmpty(r.classNames)&&s.addClass(i,r.classNames),0==$object.isNullOrUndefined(r.value)&&s.value(i,r.value),0==$object.isNullOrUndefined(r.text)&&s.innerText(i,r.text),0==$object.isNullOrUndefined(r.content)&&s.textContent(i,r.content),0==$object.isNullOrUndefined(r.html))&&s.innerHTML(i,r.html),e.appendChild(i)),i},prepend(e,t){return e=1==$object.isString(e)?syn.$l.get(e):e,t=1==$object.isString(t)?syn.$l.get(t):t,0==$object.isNullOrUndefined(e)&&0==$object.isNullOrUndefined(t)&&t.insertBefore(e,t.firstChild),s},copy(e){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?null:e.cloneNode(!0)},remove(e){return e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e)&&(syn.$w.purge(e),e.parentNode)&&e.parentNode.removeChild(e),s},hasChild(e){return e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e)&&e.hasChildNodes()},insertAfter(e,t){var n;return e=1==$object.isString(e)?syn.$l.get(e):e,t=1==$object.isString(t)?syn.$l.get(t):t,0==$object.isNullOrUndefined(e)&&0==$object.isNullOrUndefined(t)&&(n=t.parentNode,t.nextElementSibling?n.insertBefore(e,t.nextElementSibling):0==$object.isNullOrUndefined(n)?n.appendChild(e):s.appendChild(t,e)),s},display(e,t){return e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e)&&(1==$string.toBoolean(t)?e.style.display="block":e.style.display="none"),s},toggleDisplay(e){var t="none";return e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e)&&("block"===n.getComputedStyle(e).display?s.display(e,!1):s.display(e,!0),t=n.getComputedStyle(e).display),t},parent(e,t){if(e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e)){var n=e.parentElement;if(0==$string.isNullOrEmpty(t))for(;n&&0==$string.isNullOrEmpty(n.tagName)&&"HTML"!=n.tagName&&1!=$object.isNullOrUndefined(n);){if(n.id==t)return n;n=n.parentElement}}return n},create(e){var t=o.createElement(e.tag||"div");if(0==$string.isNullOrEmpty(e.id)&&(t.id=e.id),0==$object.isNullOrUndefined(e.styles)&&s.addStyle(t,e.styles),0==$string.isNullOrEmpty(e.className)&&(t.className=e.className),0==$string.isNullOrEmpty(e.classNames)&&s.addClass(t,e.classNames),0==$object.isNullOrUndefined(e.attributes))for(var n in e.attributes)t.setAttribute(n,e.attributes[n]);return 0==$object.isNullOrUndefined(e.data)&&t.setAttribute("dataset",JSON.stringify(e.data)),0==$object.isNullOrUndefined(e.value)&&s.value(t,e.value),0==$object.isNullOrUndefined(e.text)&&s.innerText(t,e.text),0==$object.isNullOrUndefined(e.content)&&s.textContent(t,e.content),0==$object.isNullOrUndefined(e.html)&&s.innerHTML(t,e.html),t},each(e,t){if(0==$object.isNullOrUndefined(e)&&1==$object.isArray(e)&&1==$object.isFunction(t))for(var n=0,r=e.length;n<r;n++)t(e[n],n)},setActive(e,t){e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e)&&(1==$string.toBoolean(t)?e.classList.add("active"):e.classList.remove("active"))},setSelected(e,t,n){e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e)&&(0==$string.toBoolean(n)&&(n=s.siblings(e),0==$object.isNullOrUndefined(n))&&s.each(n,(e,t)=>{e.selected=!1,e.removeAttribute("selected")}),1==$string.toBoolean(t)?(e.selected=!0,e.setAttribute("selected","selected")):(e.selected=!1,e.removeAttribute("selected")))},setChecked(e,t,n){e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e)&&(0==$string.toBoolean(n)&&(n=s.siblings(e),0==$object.isNullOrUndefined(n))&&s.each(n,(e,t)=>{e.checked=!1,e.removeAttribute("checked")}),1==$string.toBoolean(t)?(e.checked=!0,e.setAttribute("checked","checked")):(e.checked=!1,e.removeAttribute("checked")))},getClassRegEx(e){return new RegExp("(^|\\s)"+e+"(\\s|$)")}}),syn.$m=s}(globalRoot),!function(i){"use strict";var e=i.$dimension||new syn.module,o=i.document;e.extend({version:"1.0.0",getDocumentSize(){return{width:Math.max(o.body.scrollWidth,o.documentElement.scrollWidth,o.body.offsetWidth,o.documentElement.offsetWidth,o.body.clientWidth,o.documentElement.clientWidth),height:Math.max(o.body.scrollHeight,o.documentElement.scrollHeight,o.body.offsetHeight,o.documentElement.offsetHeight,o.body.clientHeight,o.documentElement.clientHeight),frameWidth:o.documentElement.clientWidth||o.body.clientWidth||0,frameHeight:o.documentElement.clientHeight||o.body.clientHeight||0}},getWindowSize(){return{width:globalRoot.innerWidth,height:globalRoot.innerHeight}},getScrollPosition(e){return e=1==$object.isString(e)?syn.$l.get(e):e,1==$object.isNullOrUndefined(e)?{left:o.documentElement.scrollLeft||o.body.scrollLeft||0,top:o.documentElement.scrollTop||o.body.scrollTop||0}:{left:e.pageXOffset||e.scrollLeft||0,top:e.pageYOffset||e.scrollTop||0}},getMousePosition(e){e=e||i.event||top.context.event;var t=syn.$d.getScrollPosition();return{x:e.pageX||e.clientX+t.left||0,y:e.pageY||e.clientY+t.top||0,relativeX:e.layerX||e.offsetX||0,relativeY:e.layerY||e.offsetY||0}},offset(e){var t,n,r=null;return e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e)&&(e=e.getBoundingClientRect(),t=i.pageXOffset||o.documentElement.scrollLeft,n=i.pageYOffset||o.documentElement.scrollTop,r={top:e.top+n,left:e.left+t}),r},offsetLeft(e){var t=0;if(e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e))for(;void 0!==e&&e&&e.parentElement!==i;)e.offsetLeft&&(t+=e.offsetLeft),e=e.parentElement;return t},parentOffsetLeft(e){return(e=(e=1==$object.isString(e)?syn.$l.get(e):e)||top.document.documentElement||top.document.body).parentElement===e.offsetParent?e.offsetLeft:syn.$d.offsetLeft(e)-syn.$d.offsetLeft(e.parentElement)},offsetTop(e){var t=0;if(e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e))for(;void 0!==e&&e&&e.parentElement!==i;)e.offsetTop&&(t+=e.offsetTop),e=e.parentElement;return t},parentOffsetTop(e){return(e=(e=1==$object.isString(e)?syn.$l.get(e):e)||top.document.documentElement||top.document.body).parentElement===e.offsetParent?e.offsetTop:syn.$d.offsetTop(e)-syn.$d.offsetTop(e.parentElement)},getSize(e){var t,n=null;return e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e)&&(t=i.getComputedStyle(e),n={width:e.clientWidth-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight),height:e.clientHeight-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom),clientWidth:e.clientWidth,clientHeight:e.clientHeight,offsetWidth:e.offsetWidth,offsetHeight:e.offsetHeight,marginWidth:e.offsetWidth+parseFloat(t.marginLeft)+parseFloat(t.marginRight),marginHeight:e.offsetHeight+parseFloat(t.marginTop)+parseFloat(t.marginBottom)}),n},measureWidth(e,t){var n=o.createElement("div"),t=(n.style.position="absolute",n.style.visibility="hidden",n.style.whiteSpace="nowrap",n.style.left="-9999px",t&&(n.style.fontSize=t),n.innerText=e,o.body.appendChild(n),i.getComputedStyle(n).width);return o.body.removeChild(n),t},measureHeight(e,t,n){var r=o.createElement("div"),t=(r.style.position="absolute",r.style.visibility="hidden",r.style.width=t,r.style.left="-9999px",n&&(r.style.fontSize=n),r.innerText=e,o.body.appendChild(r),i.getComputedStyle(r).height);return o.body.removeChild(r),t},measureSize(e,t,n){var r,i;return n=n||"800px",1==$object.isNumber(n)&&(n=n.toString()+"px"),1==$object.isNullOrUndefined(e)?null:{width:r=1==(r=syn.$d.measureWidth(e,t)).endsWith("px")&&0==$string.isNullOrEmpty(n)&&(i=$string.toNumber(r.substring(0,r.indexOf("px"))),n=1==n.endsWith("px")?$string.toNumber(n.substring(0,n.indexOf("px"))):$string.toNumber(n),0==isNaN(n))&&n<i?n.toString()+"px":r,height:syn.$d.measureHeight(e,r,t)}}}),syn.$d=e}(globalRoot),!function(){"use strict";var y,n,r,i,s,e=globalRoot.$crytography||new syn.module;function o(e,t){if(!i[e]){i[e]={};for(var n=0;n<e.length;n++)i[e][e.charAt(n)]=n}return i[e][t]}e.extend({version:"1.0.0",base64Encode(e){return"node"===globalRoot.devicePlatform?Buffer.from(e).toString("base64"):btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(parseInt(t,16))}))},base64Decode(e){return"node"===globalRoot.devicePlatform?Buffer.from(e,"base64").toString():decodeURIComponent(atob(e).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))},utf8Encode(e){if("string"!=typeof e)throw new TypeError("parameter is not a plain string");return e.replace(/[\u0080-\u07ff]/g,function(e){e=e.charCodeAt(0);return String.fromCharCode(192|e>>6,128|63&e)}).replace(/[\u0800-\uffff]/g,function(e){e=e.charCodeAt(0);return String.fromCharCode(224|e>>12,128|e>>6&63,128|63&e)})},utf8Decode(e){if("string"!=typeof e)throw new TypeError("parameter is not a utf8 string");return e.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(e){e=(15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2);return String.fromCharCode(e)}).replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(e){e=(31&e.charCodeAt(0))<<6|63&e.charCodeAt(1);return String.fromCharCode(e)})},sha256(e){function y(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function v(e,t){return e>>>t|e<<32-t}for(var t=function(e,t){var n,r=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),i=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),o=new Array(64);e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var s,a=0;a<e.length;a+=16){for(var l=i[0],u=i[1],c=i[2],d=i[3],h=i[4],f=i[5],p=i[6],g=i[7],m=0;m<64;m++)o[m]=m<16?e[m+a]:y(y(y(v(s=o[m-2],17)^v(s,19)^s>>>10,o[m-7]),v(s=o[m-15],7)^v(s,18)^s>>>3),o[m-16]),s=y(y(y(y(g,v(h,6)^v(h,11)^v(h,25)),h&f^~h&p),r[m]),o[m]),n=y(v(l,2)^v(l,13)^v(l,22),l&u^l&c^u&c),g=p,p=f,f=h,h=y(d,s),d=c,c=u,u=l,l=y(s,n);i[0]=y(l,i[0]),i[1]=y(u,i[1]),i[2]=y(c,i[2]),i[3]=y(d,i[3]),i[4]=y(h,i[4]),i[5]=y(f,i[5]),i[6]=y(p,i[6]),i[7]=y(g,i[7])}return i}(function(e){for(var t=Array(),n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<24-n%32;return t}(e=syn.$c.utf8Encode(e)),8*e.length),n="0123456789abcdef",r="",i=0;i<4*t.length;i++)r+=n.charAt(t[i>>2]>>8*(3-i%4)+4&15)+n.charAt(t[i>>2]>>8*(3-i%4)&15);return r},encrypt(e,t){var n;return 1==$object.isNullOrUndefined(e)?null:(n=6,1==$string.isNullOrEmpty(t)?t=syn.$c.sha256(t="").substring(0,n):n=t.length,t=syn.$c.sha256(t).substring(0,n),encodeURIComponent(syn.$c.base64Encode(function(e,t){for(var n=[],r=t.length,i=0;i<e.length;i++){var o=i%r,o=e.charCodeAt(i)+t.charCodeAt(o);n.push(o)}return JSON.stringify(n)}(e,t)+"."+t)))},decrypt(e,u){var t=null;if(1!=$object.isNullOrUndefined(e))try{if(-1===(e=syn.$c.base64Decode(decodeURIComponent(e))).indexOf("."))return t;var n=e.split("."),t=function(e,t){var n="",r=6;if(1==$string.isNullOrEmpty(u)?(u="",u=syn.$c.sha256(u).substring(0,r)):r=u.length,t==syn.$c.sha256(u).substring(0,r)){for(var i=[],o=JSON.parse(e),s=t.length,a=0;a<o.length;a++){var l=o[a]-t.charCodeAt(a%s);i.push(l)}for(a=0;a<i.length;a++)n+=String.fromCharCode(i[a])}return n}(n[0],n[1])}catch(e){syn.$l.eventLog("$c.decrypt",e,"Error")}return t},LZString:(y=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",i={},s={compressToBase64(e){if(null==e)return"";var t=s._compress(e,6,function(e){return n.charAt(e)});switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64(t){return null==t?"":""==t?null:s._decompress(t.length,32,function(e){return o(n,t.charAt(e))})},compressToUTF16(e){return null==e?"":s._compress(e,15,function(e){return y(e+32)})+" "},decompressFromUTF16(t){return null==t?"":""==t?null:s._decompress(t.length,16384,function(e){return t.charCodeAt(e)-32})},compressToUint8Array(e){for(var t=s.compress(e),n=new Uint8Array(2*t.length),r=0,i=t.length;r<i;r++){var o=t.charCodeAt(r);n[2*r]=o>>>8,n[2*r+1]=o%256}return n},decompressFromUint8Array(e){if(1==$object.isNullOrUndefined(e))return s.decompress(e);for(var t=new Array(e.length/2),n=0,r=t.length;n<r;n++)t[n]=256*e[2*n]+e[2*n+1];var i=[];return t.forEach(function(e){i.push(y(e))}),s.decompress(i.join(""))},compressToEncodedURIComponent(e){return null==e?"":s._compress(e,6,function(e){return r.charAt(e)})},decompressFromEncodedURIComponent(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),s._decompress(t.length,32,function(e){return o(r,t.charAt(e))}))},compress(e){return s._compress(e,16,function(e){return y(e)})},_compress(e,t,n){if(null==e)return"";for(var r,i,o,s,a={},l={},u="",c=2,d=3,h=2,f=[],p=0,g=0,m=0;m<e.length;m+=1)if(o=e.charAt(m),Object.prototype.hasOwnProperty.call(a,o)||(a[o]=d++,l[o]=!0),s=u+o,Object.prototype.hasOwnProperty.call(a,s))u=s;else{if(Object.prototype.hasOwnProperty.call(l,u)){if(u.charCodeAt(0)<256){for(r=0;r<h;r++)p<<=1,g==t-1?(g=0,f.push(n(p)),p=0):g++;for(i=u.charCodeAt(0),r=0;r<8;r++)p=p<<1|1&i,g==t-1?(g=0,f.push(n(p)),p=0):g++,i>>=1}else{for(i=1,r=0;r<h;r++)p=p<<1|i,g==t-1?(g=0,f.push(n(p)),p=0):g++,i=0;for(i=u.charCodeAt(0),r=0;r<16;r++)p=p<<1|1&i,g==t-1?(g=0,f.push(n(p)),p=0):g++,i>>=1}0==--c&&(c=Math.pow(2,h),h++),delete l[u]}else for(i=a[u],r=0;r<h;r++)p=p<<1|1&i,g==t-1?(g=0,f.push(n(p)),p=0):g++,i>>=1;0==--c&&(c=Math.pow(2,h),h++),a[s]=d++,u=String(o)}if(""!==u){if(Object.prototype.hasOwnProperty.call(l,u)){if(u.charCodeAt(0)<256){for(r=0;r<h;r++)p<<=1,g==t-1?(g=0,f.push(n(p)),p=0):g++;for(i=u.charCodeAt(0),r=0;r<8;r++)p=p<<1|1&i,g==t-1?(g=0,f.push(n(p)),p=0):g++,i>>=1}else{for(i=1,r=0;r<h;r++)p=p<<1|i,g==t-1?(g=0,f.push(n(p)),p=0):g++,i=0;for(i=u.charCodeAt(0),r=0;r<16;r++)p=p<<1|1&i,g==t-1?(g=0,f.push(n(p)),p=0):g++,i>>=1}0==--c&&(c=Math.pow(2,h),h++),delete l[u]}else for(i=a[u],r=0;r<h;r++)p=p<<1|1&i,g==t-1?(g=0,f.push(n(p)),p=0):g++,i>>=1;0==--c&&(c=Math.pow(2,h),h++)}for(i=2,r=0;r<h;r++)p=p<<1|1&i,g==t-1?(g=0,f.push(n(p)),p=0):g++,i>>=1;for(;;){if(p<<=1,g==t-1){f.push(n(p));break}g++}return f.join("")},decompress(t){return null==t?"":""==t?null:s._decompress(t.length,32768,function(e){return t.charCodeAt(e)})},_decompress(e,t,n){for(var r,i,o,s,a,l,u=[],c=4,d=4,h=3,f="",p=[],g={val:n(0),position:t,index:1},m=0;m<3;m+=1)u[m]=m;for(i=0,s=Math.pow(2,2),a=1;a!=s;)o=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=n(g.index++)),i|=(0<o?1:0)*a,a<<=1;switch(i){case 0:for(i=0,s=Math.pow(2,8),a=1;a!=s;)o=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=n(g.index++)),i|=(0<o?1:0)*a,a<<=1;l=y(i);break;case 1:for(i=0,s=Math.pow(2,16),a=1;a!=s;)o=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=n(g.index++)),i|=(0<o?1:0)*a,a<<=1;l=y(i);break;case 2:return""}for(r=u[3]=l,p.push(l);;){if(e<g.index)return"";for(i=0,s=Math.pow(2,h),a=1;a!=s;)o=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=n(g.index++)),i|=(0<o?1:0)*a,a<<=1;switch(l=i){case 0:for(i=0,s=Math.pow(2,8),a=1;a!=s;)o=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=n(g.index++)),i|=(0<o?1:0)*a,a<<=1;u[d++]=y(i),l=d-1,c--;break;case 1:for(i=0,s=Math.pow(2,16),a=1;a!=s;)o=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=n(g.index++)),i|=(0<o?1:0)*a,a<<=1;u[d++]=y(i),l=d-1,c--;break;case 2:return p.join("")}if(0==c&&(c=Math.pow(2,h),h++),u[l])f=u[l];else{if(l!==d)return null;f=r+r.charAt(0)}p.push(f),u[d++]=r+f.charAt(0),r=f,0==--c&&(c=Math.pow(2,h),h++)}}})}),syn.$c=e}(),!function(){"use strict";var i=globalRoot.$keyboard||new syn.module;i.extend({version:"1.0.0",keyCodes:{backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,delete:46,semicolon:186,colon:186,equal:187,plus:187,comma:188,less:188,minus:189,underscore:189,period:190,greater:190,slash:191,questionmark:191,backtick:192,tilde:192,openingsquarebracket:219,openingcurlybracket:219,backslash:220,pipe:220,closingsquarebracket:221,closingcurlybracket:221,singlequote:222,doublequote:222,clear:12,meta:91,contextmenu:93,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,subtract:109,decimal:110,divide:111,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},targetEL:null,elements:{},setElement(e){function t(e){var t=e.type,n=e.keyCode;if(null!=r[t][n]&&!1===r[t][n](e))return e.returnValue=!1,e.cancel=!0,e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}var r;return e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e)&&0==$string.isNullOrEmpty(e.id)&&(r=i.elements[e.id],1==$object.isNullOrUndefined(r)&&(r={keydown:{},keyup:{}},syn.$l.addEvent(e,"keydown",t),syn.$l.addEvent(e,"keyup",t),i.elements[e.id]=r),i.targetEL=e),i},addKeyCode(e,t,n){var r;return i.targetEL&&(r=i.elements[i.targetEL.id],0==$object.isNullOrUndefined(r))&&(r[e][t]=n),i},removeKeyCode(e,t){var n;return i.targetEL&&(n=i.elements[i.targetEL.id],0==$object.isNullOrUndefined(n))&&(n[e][t]=null,delete n[e][t]),i}}),syn.$k=i}(),!function(context){"use strict";var $validation=context.$validation||new syn.module;$validation.extend({version:"1.0.0",isContinue:!0,messages:[],targetEL:null,elements:{},initializeValidObject(e){var t=$validation.elements[e.id];1==$object.isNullOrUndefined(t)&&($validation.elements[e.id]=t={pattern:{},range:{},custom:{}})},setElement(e){return e=1==$object.isString(e)?syn.$l.get(e):e,0==$object.isNullOrUndefined(e)&&0==$string.isNullOrEmpty(e.id)&&($validation.initializeValidObject(e),$validation.targetEL=e),$validation},required(e,t,n){return 0==$string.isNullOrEmpty(n)?(e=1==$object.isString(e)?syn.$l.get(e):e,$validation.setElement(e),0==$object.isNullOrUndefined(e)&&(e.required=$string.toBoolean(t),e.message=n)):syn.$l.eventLog("$v.required","message 확인 필요","Information"),$validation},pattern(e,t,n){return 0==$object.isNullOrUndefined(n)?0==$object.isNullOrUndefined(n.expr)&&0==$string.isNullOrEmpty(n.message)?(e=1==$object.isString(e)?syn.$l.get(e):e,$validation.setElement(e),0==$object.isNullOrUndefined(e)&&0==$string.isNullOrEmpty(e.id)&&($validation.elements[e.id].pattern[t]=n)):syn.$l.eventLog("$v.pattern","options.expr, options.message 확인 필요","Information"):syn.$l.eventLog("$v.pattern","options 확인 필요","Information"),$validation},range(e,t,n){return 0==$object.isNullOrUndefined(n)?1==$string.isNumber(n.min)&&1==$string.isNumber(n.max)&&0==$string.isNullOrEmpty(n.minOperator)&&0==$string.isNullOrEmpty(n.maxOperator)&&0==$string.isNullOrEmpty(n.message)?(e=1==$object.isString(e)?syn.$l.get(e):e,$validation.setElement(e),0==$object.isNullOrUndefined(e)&&0==$string.isNullOrEmpty(e.id)&&($validation.elements[e.id].range[t]=n)):syn.$l.eventLog("$v.pattern","options.min, options.minOperator, options.max, options.maxOperator, options.message 확인 필요","Information"):syn.$l.eventLog("$v.range","options 확인 필요","Information"),$validation},custom(e,t,n){return 0==$object.isNullOrUndefined(n)?0==$object.isNullOrUndefined(n.functionName)&&0==$string.isNullOrEmpty(n.message)?(e=1==$object.isString(e)?syn.$l.get(e):e,$validation.setElement(e),0==$object.isNullOrUndefined(e)&&0==$string.isNullOrEmpty(e.id)&&($validation.elements[e.id].custom[t]=n)):syn.$l.eventLog("$v.custom","options.functionName, options.message 확인 필요","Information"):syn.$l.eventLog("$v.custom","options 확인 필요","Information"),$validation},removeValidate(e,t){if($validation.targetEL){$validation.initializeValidObject($validation.targetEL);var n=$validation.elements[$validation.targetEL.id];try{n[e][t]=null,delete n[e][t]}catch{}}return $validation},remove(e){var t;return $validation.targetEL&&(t=$validation.elements[$validation.targetEL.id],0==$object.isNullOrUndefined(t))&&(t.pattern[e]=null,delete t.pattern[e],t.range[e]=null,delete t.range[e],t.custom[e]=null,delete t.custom[e]),$validation},clear(){return $validation.isContinue=!1,$validation.messages=[],$validation.targetEL=null,$validation.elements={},$validation},validateControl(el){var result=!1;if(el=1==$object.isString(el)?syn.$l.get(el):el,$validation.setElement(el),0==$object.isNullOrUndefined(el)&&0==$string.isNullOrEmpty(el.id)){if(1==$string.toBoolean(el.required))if(0<el.value.length)result=!0;else if(result=!1,$validation.messages.push(el.message),0==$validation.isContinue)return result;var validObject=$validation.elements[el.id];if(0==$object.isNullOrUndefined(validObject))for(var validType in validObject)if("pattern"===validType){var pattern=null,expr=null,validID;for(validID in validObject[validType]){var pattern=validObject[validType][validID],expr=pattern.expr,result=expr.test(el.value);if(0==result&&($validation.messages.push(pattern.message),0==$validation.isContinue))break}}else if("range"===validType){var range=null,min=null,max=null,minOperator=null,maxOperator=null,validID;for(validID in validObject[validType]){range=validObject[validType][validID],min=range.min,max=range.max,minOperator=range.minOperator,maxOperator=range.maxOperator;try{var value=el.value.trim();result=1==$string.isNumber(value)&&eval(min+` ${minOperator} ${value} && ${max} ${maxOperator} `+value)}catch(error){syn.$l.eventLog("$v.validateControl",'elID: "{0}" 유효성 range 검사 오류 '.format(el.id)+error.message,"Warning")}if(0==result&&($validation.messages.push(range.message),0==$validation.isContinue))break}}else if("custom"===validType){var custom=null,functionName=null,parameters=null,validID;for(validID in validObject[validType]){for(var parameterName in custom=validObject[validType][validID],functionName=custom.functionName,parameters=[],custom)"functionName"!==parameterName&&(parameters[parameterName]=custom[parameterName]);try{result=$this?eval('window[syn.$w.pageScript]["method"]["'+functionName+'"]').call($this,parameters):eval(functionName).call(globalRoot,parameters)}catch(error){syn.$l.eventLog("$v.validateControl",'elID: "{0}" 유효성 custom 검사 오류 '.format(el.id)+error.message,"Warning")}if(0==result&&($validation.messages.push(custom.message),0==$validation.isContinue))break}}}return 0===$validation.messages.length},validateControls(e){var t=!0,n=null;if(e.type)t=$validation.validateControl(n=e);else if(e.length)for(var r=0,i=e.length;r<i;r++)n=e[r],t=$validation.validateControl(n);return t},validateForm(){var e,t=!1;for(e in $validation.elements)t=$validation.validateControl(e);return t},toMessages(){for(var e=[],t=0;t<$validation.messages.length;t++)e.push($validation.messages[t]);return $validation.messages=[],e.join("\n")},valueType:new function(){this.valid=0,this.valueMissing=1,this.typeMismatch=2,this.patternMismatch=3,this.tooLong=4,this.rangeUnderflow=5,this.rangeOverflow=6,this.stepMismatch=7},validType:new function(){this.required=0,this.pattern=1,this.range=2,this.custom=3},regexs:new function(){this.alphabet=/^[a-zA-Z]*$/,this.juminNo=/^(?:[0-9]{2}(?:0[1-9]|1[0-2])(?:0[1-9]|[1,2][0-9]|3[0,1]))-?[1-4][0-9]{6}$/,this.numeric=/^-?[0-9]*(\.[0-9]+)?$/,this.email=/^([a-z0-9_\.\-\+]+)@([\da-z\.\-]+)\.([a-z\.]{2,6})$/i,this.url=/^(https?:\/\/)?[\da-z\.\-]+\.[a-z\.]{2,6}[#&+_\?\/\w \.\-=]*$/i,this.ipAddress=/^(?:\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b|null)$/,this.date=/^\d{4}-\d{2}-\d{2}$/,this.mobilePhone=/^01([0|1|6|7|8|9])(\d{7,8})/,this.seoulPhone=/^02(\d{7,8})/,this.areaPhone=/^0([0|3|4|5|6|7|8|])([0|1|2|3|4|5|])(\d{7,8})/,this.onesPhone=/^050([2|5])(\d{7,8})/,this.float=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,this.isoDate=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/}}),syn.$v=$validation}(globalRoot),!function(e){"use strict";var v=e.$date||new syn.module,i=e.$array||new syn.module,g=e.$string||new syn.module,t=e.$number||new syn.module,m=e.$object||new syn.module;Function.prototype.clone||(Function.prototype.clone=function(){function e(){return n.apply(this,arguments)}var t,n=this;for(t in this)e[t]=this[t];return e}),Object.assign||(Object.assign=function(e){if(null===e||"object"!=typeof e)return e;var t,n=e.constructor();for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}),Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),n=t.length,r=new Array(n);n--;)r[n]=[t[n],e[t[n]]];return r}),String.prototype.trim||(String.prototype.trim=function(){for(var e=this.replace(/^\s+/,""),t=e.length-1;0<t;t--)if(/\S/.test(e.charAt(t))){e=e.substring(0,t+1);break}return e}),String.prototype.includes||(String.prototype.includes=function(e){return-1!==this.indexOf(e)}),String.prototype.format||(String.prototype.format=function(){for(var e=this,t=0,n=arguments.length;t<n;t++)var r=new RegExp("{"+t.toString()+"+?}","g"),e=e.replace(r,arguments[t]);return e}),"node"===globalRoot.devicePlatform||(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest)||(Element.prototype.closest=function(e){var t=this;do{if(t.matches(e))return t}while(null!==(t=t.parentElement||t.parentNode)&&1===t.nodeType);return null}),v.extend({version:"1.0.0",interval:{year:31536e6,week:6048e5,day:864e5,hour:36e5,minute:6e4,second:1e3},now(){return new Date},clone(e){var t=null;return e instanceof Date?t=new Date(e.getTime()):1==m.isString(e)&&(t=new Date(e)),t},isBetween(e,t,n){var r=!1;return r=e instanceof Date&&t instanceof Date&&n instanceof Date?e.getTime()>=t.getTime()&&e.getTime()<=n.getTime():r},equals(e,t){var n=!1;return n=e instanceof Date&&t instanceof Date?e.getTime()==t.getTime():n},equalDay(e,t){var n=!1;return n=e instanceof Date&&t instanceof Date?e.toDateString()==t.toDateString():n},isToday(e){var t=!1;return t=e instanceof Date?v.equalDay(e,new Date):t},toString(e,t){var n="",r=e.getFullYear(),i=e.getMonth()+1,o=1==e.getDate().toString().length?"0"+e.getDate().toString():e.getDate().toString(),s=1==e.getHours().toString().length?"0"+e.getHours().toString():e.getHours().toString(),a=1==e.getMinutes().toString().length?"0"+e.getMinutes().toString():e.getMinutes().toString(),l=1==e.getSeconds().toString().length?"0"+e.getSeconds().toString():e.getSeconds().toString(),u=e.getMilliseconds().toString().padStart(3,"0"),c=["일","월","화","수","목","금","토"],i=1==i.toString().length?"0"+i.toString():i.toString();switch(t){case"d":n=r.toString().concat("-",i,"-",o);break;case"t":n=s.toString().concat(":",a,":",l);break;case"a":n=r.toString().concat("-",i,"-",o," ",s,":",a,":",l);break;case"f":n=r.toString().concat(i,o,s,a,l,u);break;case"s":n=s.toString().concat(a,l,u);break;case"n":var d=c[e.getDay()],n=r.toString().concat("년 ",i,"월 ",o,"일 ","(",d,")");break;case"mdn":d=c[e.getDay()];n=i.toString().concat("월 ",o,"일");break;case"w":for(var h=1,f=v.weekOfMonth(r,i),p=Number(v.toString(e,"d").replace(/-/g,"")),g=0;g<f.length;g++){var m=f[g],y=Number(m.weekStartDate.replace(/-/g,"")),m=Number(m.weekEndDate.replace(/-/g,""));if(y<=p&&p<=m){h=g+1;break}}n=h;break;case"wn":n=c[e.getDay()];break;case"m":n=i;break;case"ym":n=r.toString().concat("-",i);break;default:n=e.getDate().toString().padStart(2,"0")}return n},addSecond(e,t){var n=null;return n=e instanceof Date?new Date(e.getTime()+t*v.interval.second):n},addMinute(e,t){var n=null;return n=e instanceof Date?new Date(e.getTime()+t*v.interval.minute):n},addHour(e,t){var n=null;return n=e instanceof Date?new Date(e.getTime()+t*v.interval.hour):n},addDay(e,t){var n,r=null;return e instanceof Date&&(n=new Date(e.getTime()),r=new Date(n.setDate(e.getDate()+t))),r},addWeek(e,t){var n,r=null;return e instanceof Date&&(n=new Date(e.getTime()),r=new Date(n.setDate(e.getDate()+7*t))),r},addMonth(e,t){var n,r=null;return e instanceof Date&&(n=new Date(e.getTime()),r=new Date(n.setMonth(e.getMonth()+t))),r},addYear(e,t){var n,r=null;return e instanceof Date&&(n=new Date(e.getTime()),r=new Date(n.setFullYear(e.getFullYear()+t))),r},getFirstDate(e){var t=null;return t=e instanceof Date?new Date(e.setDate(1)):t},getLastDate(e){return e instanceof Date?(e=v.addMonth(e,1),v.addDay(new Date(e.setDate(1)),-1)):null},diff(e,t,n){var r=0;return e instanceof Date&&t instanceof Date&&("month"==(n=n||"day")?r=t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear()):0==m.isNullOrUndefined(v.interval[n])&&(t=Math.abs(t-e),r=Math.floor(t/v.interval[n]))),r},toTicks(e){return 1e4*e.getTime()+621355968e9},isDate(e){var t=!1,n=null;return t=1==m.isString(e)?"NaN"!=(n=new Date(e)).toString()&&"Invalid Date"!=n.toString()||1==syn.$b.isSafari&&0==syn.$b.isChrome&&(e=e.match(/(\d+)/g),"NaN"!=(n=new Date(e[0],e[1]-1,e[2])).toString())&&"Invalid Date"!=n.toString():t},isISOString(e){var t=!1;return t=1==v.isDate(e)?new Date(e).toISOString()===e:t},weekOfMonth(e,t,n){for(var r=[],e=(t=t||(new Date).getMonth()+1,n=n||8,new Date(e,t)),i=new Date(e.getFullYear(),e.getMonth()-1,1),o=new Date(e.getFullYear(),e.getMonth(),0),s=null,a=!0,l=i.getDay(),u=function(e,t){return(e=String(e)).length>=t?e:new Array(t-e.length+1).join("0")+e},c=1;c<=6&&o.getMonth()==i.getMonth();c++)s={},i.getDay()<=1&&(0==i.getDay()&&i.setDate(i.getDate()+1),s.weekStartDate=i.getFullYear().toString()+"-"+u((i.getMonth()+1).toString(),2)+"-"+u(i.getDate().toString(),2)),l<n?a?(n-i.getDay()==1&&i.setDate(i.getDate()+(n-i.getDay())-1),1<n-i.getDay()&&i.setDate(i.getDate()+(n-i.getDay())-1),a=!1):i.setDate(i.getDate()+6):i.setDate(i.getDate()+(6-i.getDay())+n),void 0!==s.weekStartDate&&(s.weekEndDate=i.getFullYear().toString()+"-"+u((i.getMonth()+1).toString(),2)+"-"+u(i.getDate().toString(),2),r.push(s)),i.setDate(i.getDate()+1);return r}}),e.$date=v,g.extend({version:"1.0.0",toValue(e,t){var n="";return 1==m.isNullOrUndefined(e)?0==g.isNullOrEmpty(t)&&(n=t.toString()):n=e.toString(),n},br(e){return e.replace(/(\r\n|\r|\n)/g,"<br />")},interpolate(e,t,i=null){var n=null;if(null!=t){i=syn.$w.argumentsExtend({defaultValue:null,separator:"\n"},i);var r=function(e,r){return e.replace(/\#{([^{}]*)}/g,function(e,t){var t=r[t],n=e;return"string"==typeof t||"number"==typeof t?n=t:0==m.isNullOrUndefined(t)?1==m.isArray(t)?n=t.join(", "):1==m.isDate(t)?n=v.toString(t,"a"):1==m.isBoolean(t)&&(n=t.toString()):n=null==i.defaultValue?e:i.defaultValue,n})};if(0==m.isArray(t))n=r(e,t);else{var o,s=[];for(o in t){var a=t[o];s.push(r(e,a))}n=s.join(i.separator)}}return n},isNullOrEmpty(e){return null==e||""===e},sanitizeHTML(e,t){return(1==(t=t||!0)?e.replace(/<.[^<>]*?>/g,"").replace(/&nbsp;|&#160;/gi," "):e.replace(/<.[^<>]*?>/g,"").replace(/&nbsp;|&#160;/gi," ").replace(/[.(),;:!?%#$'\"_+=\/\-“”’]*/g,"")).trim()},cleanHTML(e){var t=document.createElement("div");return t.innerHTML=e.replace(/\<br\s*\/\>/gim,"\n"),t.innerText.trim()},toHtmlChar(e){return e.replace(/&/g,"&amp;").replace(/\'/g,"&quot;").replace(/\'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},toCharHtml(e){return e.replace(/&amp;/g,"&").replace(/&quot;/g,"'").replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">")},length(e){for(var t=0,n=0,r=e.length;n<r;n++)127<e.charCodeAt(n)?t+=2:t++;return t},split(e,t){return e.split(t).filter(e=>e)},isNumber(e){e=String(e).replace(/^\s+|\s+$/g,"");return!!/^[\-]?(([1-9][0-9]{0,2}(,[0-9]{3})*)|[0-9]+){1}(\.[0-9]+)?$/g.test(e)&&(e=e.replace(/,/g,""),!isNaN(e))},toNumber(e){var t=0;try{t=parseFloat(0===(1==m.isNullOrUndefined(e)?0:e)||""===e?"0":e.toString().replace(/,/g,""))}catch(e){syn.$l.eventLog("$string.toNumber",e,"Warning")}return t},capitalize(e){return e.replace(/\b([a-z])/g,function(e){return e.toUpperCase()})},toJson(e,t){for(var n=(t=t||{}).delimeter||",",r=t.newline||"\n",i=t.meta||{},o=e.split(RegExp("{0}".format(r),"g")),s=o[0].split(n),a=0;a<s.length;a++)s[a]=s[a].replace(/(^[\s"]+|[\s"]+$)/g,"");var l=[],u=o.length,c=s.length;if(1==m.isEmpty(i))for(a=1;a<u;a++){for(var d=o[a].split(n),h={},f=0;f<c;f++)h[s[f]]=g.toDynamic(d[f]);l.push(h)}else for(a=1;a<u;a++){d=o[a].split(n);for(h={},f=0;f<c;f++){var p=s[f];h[p]=g.toParseType(d[f],i[p])}l.push(h)}return l},toParameterObject(e){return(e.match(/([^?:;]+)(:([^;]*))/g)||[]).reduce(function(e,t){return e[t.slice(0,t.indexOf(":")).replace("@","")]=t.slice(t.indexOf(":")+1),e},{})},toBoolean(e){return"true"===e||"True"===e||"TRUE"===e||"Y"===e||"1"==e},toDynamic(e,t){return 1==(t=g.toBoolean(t))&&""===e?null:"true"===e||"True"===e||"TRUE"===e||"false"!==e&&"False"!==e&&"FALSE"!==e&&($validation.regexs.float.test(e)?g.toNumber(e):$validation.regexs.isoDate.test(e)?new Date(e):e)},toParseType(e,t,n){var r;if(t=t||"string",1==(n=g.toBoolean(n))&&""===e)r=null;else switch(t){case"string":r=e;break;case"bool":r=g.toBoolean(e);break;case"number":case"int":r=1!=m.isNullOrUndefined(e)&&1==g.isNumber(e)?g.toNumber(e):null;break;case"date":$validation.regexs.isoDate.test(e)&&(r=new Date(e));break;default:r=e}return r},toNumberString(e){return e.trim().replace(/[^0-9\-\.]/g,"")},toCurrency(e,t,n){var r=null;if(0!=g.isNumber(e))if(1==m.isNullOrUndefined(t)){for(var i=e.toString().split("."),o=i[0],i=1<i.length?"."+i[1]:"",s=/(\d+)(\d{3})/;s.test(o);)o=o.replace(s,"$1,$2");r=o+i}else i=syn.$w.argumentsExtend({style:"currency",currency:"KRW"},n),r=Intl.NumberFormat(t,i).format(e);return r}}),e.$string=g,i.extend({version:"1.0.0",distinct(e){for(var t=[],n=0,r=e.length;n<r;n++)0==i.contains(t,e[n])&&t.push(e[n]);return t},sort(e,t){var n=null;if(1==(t=t||!0))for(var r=0,i=e.length;r<i;r++)for(var o=0,s=e.length;o<s;o++)e[r]<e[o]&&(n=e[r],e[r]=e[o],e[o]=n);else for(r=0,i=e.length;r<i;r++)for(o=0,s=e.length;o<s;o++)e[r]>e[o]&&(n=e[r],e[r]=e[o],e[o]=n);return e},objectSort(e,n,t){return 1==(t=t||!0)?e.sort(function(e,t){e=e[n],t=t[n];return e<t?-1:t<e?1:0}):e.sort(function(e,t){e=e[n],t=t[n];return e<t?1:t<e?-1:0}),e},groupBy(e,r){return e.reduce((e,t)=>{var n=t[r];return void 0===e[n="function"==typeof r?r(t):n]&&(e[n]=[]),e[n].push(t),e},{})},shuffle(e){for(var t,n,r=e.length;r--;)t=Math.floor((r+1)*Math.random()),n=e[r],e[r]=e[t],e[t]=n;return e},addAt(e,t,n){return t<=e.length-1&&e.splice(t,0,n),e},removeAt(e,t){return t<=e.length-1&&e.splice(t,1),e},contains(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return!0;return!1},merge(e,t,n=(e,t)=>e===t){const r=[...e];return t.forEach(t=>r.some(e=>n(t,e))?null:r.push(t)),r},union(e,t){for(var n=[],r={},i=0;i<e.length;i++)r[e[i]]=1;for(var o,i=0;i<t.length;i++)r[t[i]]=1;for(o in r)n.push(o);return n},difference(e,t){return e.filter(function(e){return!t.includes(e)})},intersect(e,t){return e.filter(function(e){return t.includes(e)})},symmetryDifference(t,n){return t.filter(function(e){return!n.includes(e)}).concat(n.filter(function(e){return!t.includes(e)}))},getValue(e,t,n,r,i){var o,s=null;return e&&0<e.length&&(o=null,s=(o=r?e.find(function(e){return e[r]==t}):e.find(function(e){return e.parameterName==t}))?i?o[i]:o.value:void 0===n?"":n),s},ranks(e,t){var n=[];if(0==m.isNullOrUndefined(e)&&1==m.isArray(e)){if(1==(t=1!=m.isNullOrUndefined(t)&&g.toBoolean(t)))for(var r=0;r<e.length;r++)e[r]=-+e[r];var i=e.slice().sort(function(e,t){return t-e}),n=e.map(function(e){return i.indexOf(e)+1})}return n}}),e.$array=i,t.extend({version:"1.0.0",duration(e){e<0&&(e=-e);e={year:0,week:0,day:Math.floor(e/864e5),hour:Math.floor(e/36e5)%24,minute:Math.floor(e/6e4)%60,second:Math.floor(e/1e3)%60,millisecond:Math.floor(e)%1e3};return 365<e.day&&(e.year=e.day%365,e.day=Math.floor(e.day/365)),7<e.day&&(e.week=e.day%7,e.day=Math.floor(e.day/7)),e},toByteString(e,t,n){void 0===t&&(t=3),void 0===n&&(n=!0);var r,i=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];return Math.abs(e)<1?e+(n?" ":"")+i[0]:(r=Math.min(Math.floor(Math.log10(e<0?-e:e)/3),i.length-1),(e<0?"-":"")+Number(((e<0?-e:e)/Math.pow(1024,r)).toPrecision(t))+(n?" ":"")+i[r])},random(e,t){return 1==g.isNullOrEmpty(e)&&(e=0),1==g.isNullOrEmpty(t)&&(t=10),Math.floor(Math.random()*(t-e+1)+e)},isRange(e,t,n){return t<=e&&e<=n},limit(e,t,n){return e<t?t:n<e?n:e},percent(e,t,n){n=n||0,n=Math.pow(10,n);return Math.round(100*e/t*n)/n}}),e.$number=t,m.extend({version:"1.0.0",isNullOrUndefined(e){return null==e},toCSV(e,t){if("object"!=typeof e)return null;var n=(t=t||{}).scopechar||"/",r=t.delimeter||",",t=t.newline||"\n";!1===Array.isArray(e)&&(e=[e]);for(var i,o,s,a,l=[],u=[],c={},d=[],h=0;h<e.length;h++){for(a=[e[h],""],u[h]={};0<a.length;)if(o=a.pop(),null!==(i=a.pop())&&"object"==typeof i)for(s in i)i.hasOwnProperty(s)&&(a.push(i[s]),a.push(o+(o?n:"")+s));else void 0===c[o]&&(c[o]=!0),u[h][o]=i;l[h]=[]}for(s in c)if(c.hasOwnProperty(s))for(d.push(s),h=0;h<e.length;h++)l[h].push(void 0===u[h][s]?"":u[h][s]);for(h=0;h<e.length;h++)l[h]=l[h].join(r);return d.join(r)+t+l.join(t)},toParameterString(e){return e?Object.entries(e).reduce(function(e,t,n){var r=t[0],t=t[1];return e+=`@${r}:${g.toValue(g.toDynamic(t),"")};`},""):""},getType(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array||!(e instanceof Object)&&"[object Array]"==Object.prototype.toString.call(e)||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if(!(e instanceof Object||"[object Function]"!=Object.prototype.toString.call(e)&&(void 0===e.call||void 0===e.propertyIsEnumerable||e.propertyIsEnumerable("call"))))return"function";if(e instanceof Date)return"date";if(e instanceof HTMLElement)return"element"}else if("function"==t&&void 0===e.call)return"object";return t},defaultValue(e){if("string"!=typeof e)return"";switch(e){case"bool":case"boolean":return!1;case"function":return function(){};case"null":return null;case"int":case"number":return 0;case"object":return{};case"date":return new Date;case"string":return"";case"symbol":return Symbol();case"undefined":return;default:return""}},isDefined(e){return void 0!==e},isNull(e){return null===e},isArray(e){return"array"==this.getType(e)},isDate(e){var t=!1;try{"[object Date]"===Object.prototype.toString.call(e)?t=!0:"string"==typeof e&&(1==e.includes("T")?t="function"==typeof e.parseISOString().getFullYear:1==v.isDate(e)&&(t=!0))}catch(e){}return t},isString(e){return"string"==typeof e},isNumber(e){return"number"==typeof e},isFunction(e){return"function"==this.getType(e)},isObject(e){return"object"==typeof e},isObjectEmpty(e){if("object"==typeof e)for(var t in e)if(1==e.hasOwnProperty(t))return!1;return!0},isBoolean(e){return 1!=m.isNullOrUndefined(e)&&("boolean"==typeof e||!("string"!=typeof e&&"number"!=typeof e||"TRUE"!==(e=e.toString()).toUpperCase()&&"FALSE"!==e.toUpperCase()&&"Y"!==e&&"N"!==e&&"1"!=e&&"0"!=e))},isEmpty(e){return!("number"==typeof e||"boolean"==typeof e||"function"==typeof e||"object"==typeof e&&e instanceof Date||null!=e&&(Object.keys(e)||e).length)},clone(t,e){var r=null;if(1==m.isNullOrUndefined(e)&&(e=!0),1==m.isArray(t))r=JSON.parse(JSON.stringify(t));else if(1==m.isObject(t))if(t)if([Number,String,Boolean].forEach(function(e){t instanceof e&&(r=e(t))}),1==e&&"[object Array]"===Object.prototype.toString.call(t))r=[],t.forEach(function(e,t,n){r[t]=m.clone(e)});else if("object"==typeof t)if(t.nodeType&&"function"==typeof t.cloneNode)r=t.cloneNode(!0);else if(t.prototype)r=t.constructor?new t.constructor:t;else for(var n in r={},t)r[n]=m.clone(t[n]);else r=t;else r=t;else r=1==m.isFunction(t)?t.clone():t;return r},extend(e,t,n){var r,i;for(r in t)(i=void 0!==e[r])&&"object"==typeof t[r]&&null!==t[r]&&void 0===t[r].nodeName?m.isDate(t[r])?n&&(e[r]=new Date(t[r].getTime())):m.isArray(t[r])?n&&(e[r]=t[r].slice(0)):e[r]=m.extend({},t[r],n):!n&&i||(e[r]=t[r]);return e}}),e.$object=m}(globalRoot),!function(l){"use strict";var e,i,u=l.$library||new syn.module,c=null;"node"!==globalRoot.devicePlatform&&(c=l.document,"function"!=typeof l.CustomEvent&&((e=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=c.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}).prototype=l.Event.prototype,l.CustomEvent=e),l.events={items:i=[],add(e,t,n){i.push(arguments)},remove(t,n,r){var e=i.findIndex(e=>e[0]==t&&e[1]==n&&e[2]==r);-1<e&&i.splice(e,1)},flush(){for(var e,t=i.length-1;0<=t;t-=1)(e=i[t])[0].removeEventListener&&e[0].removeEventListener(e[1],e[2],e[3]),"on"!=e[1].substring(0,2)&&(e[1]="on"+e[1]),e[0].detachEvent&&e[0].detachEvent(e[1],e[2]),e[0][e[1]]=null;syn.$w.purge(c.body)}}),u.extend({version:"1.0.0",prefixs:["webkit","moz","ms","o",""],eventMap:{mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},guid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},stringToArrayBuffer(e,t){for(var n=1,t=(1==$string.toBoolean(t)&&(n=2),new ArrayBuffer(e.length*n)),r=new Uint8Array(t),i=0,o=e.length;i<o;i++)r[i]=e.charCodeAt(i);return t},arrayBufferToString(e){e=new Uint8Array(e),e=String.fromCharCode.apply(null,e);return decodeURIComponent(e)},random(e,t){for(var e=e||8,n="";n.length<e;)n+=Math.random().toString(36).substring(2);return 1==$string.toBoolean(t)?n.substring(0,e):n.substring(0,e).toUpperCase()},execPrefixFunc(e,t){for(var n,r,i=syn.$l.prefixs,o=0;o<i.length&&!e[n];){if(n=t,""==i[o]&&(n=n.substring(0,1).toLowerCase()+n.substring(1)),"undefined"!=(r=typeof e[n=i[o]+n]))return i=[i[o]],"function"==r?e[n]():e[n];o++}},dispatchClick(e,t){try{e=1==$object.isString(e)?syn.$l.get(e):e,t=syn.$w.argumentsExtend({canBubble:!0,cancelable:!0,view:l,detail:0,screenX:0,screenY:0,clientX:80,clientY:20,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:null},t);var n=c.createEvent("MouseEvents");n.initMouseEvent("click",t.canBubble,t.cancelable,t.view,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget),e.dispatchEvent(n)}catch(e){syn.$l.eventLog("$l.dispatchClick",e,"Warning")}},addEvent(e,t,n){return(e=1==$object.isString(e)?syn.$l.get(e):e)&&n&&1==$object.isFunction(n)&&(e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=e["e"+t+n],events.add(e,t,n),1==$object.isString(t))&&"resize"===t.toLowerCase()&&n(),u},addEvents(e,t,n){if(n&&1==$object.isFunction(n)){var r=[];if(1==$object.isString(e)&&0==$string.isNullOrEmpty(e))r=syn.$l.querySelectorAll(e);else if(1==$object.isArray(e)&&0<e.length){var i=e[0];if(1==$object.isString(i))for(var o=0,s=e.length;o<s;o++)r=$array.merge(r,syn.$l.querySelectorAll(e[o]));else 1==$object.isObject(i)&&(r=e)}else 1==$object.isObject(e)&&(r=[e]);for(o=0,s=r.length;o<s;o++){var a=r[o];syn.$l.addEvent(a,t,n)}}return u},addLive(r,e,i){return u.addEvent(l||c,e,function(e){for(var t,n=syn.$w.activeControl(e);n&&!(t=n.id==r);)n=n.parentElement;t&&i.call(n,e)}),u},removeEvent(e,t,n){return n&&1==$object.isFunction(n)&&((e=1==$object.isString(e)?syn.$l.get(e):e).removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null,events.remove(e,t,n)),u},hasEvent(e,t){var n,r=!1;e=1==$object.isString(e)?syn.$l.get(e):e;for(var i=0,o=events.items.length;i<o;i++)if((n=events.items[i])&&n[0]instanceof l.constructor||n[0]instanceof c.constructor){if(n[1]==t){r=!0;break}}else if(n&&n[0].id&&n[0].id==e.id&&n[1]==t){r=!0;break}return r},trigger(e,t,n){var r,i=!1,o=null;e=1==$object.isString(e)?syn.$l.get(e):e;for(var s=0,a=events.items.length;s<a;s++)if((r=events.items[s])[0]instanceof l.constructor||r[0]instanceof c.constructor){if(r[1]==t){o=r[2];break}}else if(r[0].id&&r[0].id==e.id&&r[1]==t){o=r[2];break}return o&&(n?o.call(e,n):o.call(e),i=!0),i},triggerEvent(e,t,n){var r;return e=1==$object.isString(e)?syn.$l.get(e):e,l.CustomEvent?n?e.dispatchEvent(new CustomEvent(t,{detail:n})):e.dispatchEvent(new CustomEvent(t)):c.createEvent?((r=c.createEvent("HTMLEvents")).initEvent(t,!1,!0),n?e.dispatchEvent(r,n):e.dispatchEvent(r)):e.fireEvent&&((r=c.createEventObject()).eventType=t,n?e.fireEvent("on"+r.eventType,n):e.fireEvent("on"+r.eventType)),u},get(){for(var e,t=[],n=null,r=0,i=arguments.length;r<i;r++)e=arguments[r],1==$object.isString(e)&&(n=c.getElementById(e)),t.push(n);return 1==t.length?n:t},querySelector(){for(var e,t=[],n=null,r=0,i=arguments.length;r<i;r++)e=arguments[r],1==$object.isString(e)&&(n=c.querySelector(e)),t.push(n);return 1==t.length?n:t},getTagName(){for(var e=[],t=0,n=arguments.length;t<n;t++){var r=arguments[t];if(1==$object.isString(r))for(var i=c.getElementsByTagName(r),o=0,s=i.length;o<s;o++)e.push(i[o])}return e},querySelectorAll(){for(var e=[],t=0,n=arguments.length;t<n;t++){var r=arguments[t];if(1==$object.isString(r))for(var i=c.querySelectorAll(r),o=0,s=i.length;o<s;o++)e.push(i[o])}return e},toEnumText(e,t){var n,r=null;for(n in e)if(e[n]==t){r=n;break}return r},prettyTSD(e,t){var n=null;try{var r,i=e.split("＾");return n=1<i.length?(r=$string.toParameterObject(i[0]),$string.toJson(i[1],{delimeter:"｜",newline:"↵",meta:r})):$string.toJson(i[0],{delimeter:"｜",newline:"↵"}),1==$string.toBoolean(t)?JSON.stringify(n,null,2):n}catch(e){n=e.message}return n},text2Json(e,t,n){null==t&&(t=",");var i=e.slice(0,e.indexOf(n=null==n?"\n":n)).split(t);return e.slice(e.indexOf(n)+1).split(n).map(function(e){var r=e.split(t);return i.reduce(function(e,t,n){return e[t]=r[n],e},{})})},json2Text(e,t,r,n){function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}return r==r&&(r=","),null==n&&(n="\n"),[t.join(r)].concat(function(e){if(Array.isArray(e))return i(e)}(e=e.map(function(n){return t.reduce(function(e,t){return"".concat(e).concat(e.length?r:"").concat(n[t]||"")},"")}))||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){var n;if(e)return"string"==typeof e?i(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}(e)||function(){throw new TypeError("유효하지 않은 데이터 타입")}()).join(n)},nested2Flat(e,t,n,r){var i,o=[];return e?(1==$object.isNullOrUndefined(r)&&(r="items"),delete(i=$object.clone(e,!1))[r],i[n]=null,o.push(i),syn.$l.parseNested2Flat(e,o,t,n,r)):syn.$l.eventLog("$l.nested2Flat","필수 데이터 확인 필요","Warning"),o},parseNested2Flat(e,t,n,r,i){var o=e[i=1==$object.isNullOrUndefined(i)?"items":i];if(e&&o)for(var s=0;s<o.length;s++){var a=o[s],l=$object.clone(a,!1);delete l[i],l[r]=e[n],t.push(l),a[i]&&0<a[i].length&&syn.$l.parseNested2Flat(a,t,n,r,i)}return null},flat2Nested(e,t,n,r){var i,o=null;return e&&t&&n?(1==$object.isNullOrUndefined(r)&&(r="items"),i=e.find(function(e){return null==e[n]}),e=syn.$l.parseFlat2Nested(e,i,[],t,n,r),i[r]=e[r],o=i):syn.$l.eventLog("$l.flat2Nested","필수 데이터 확인 필요","Warning"),o},parseFlat2Nested(e,t,n,r,i,o){1==$object.isNullOrUndefined(o)&&(o="items");var s=e.filter(function(e){return e[i]==t[r]});if(0<s.length){n[o]||(n[o]=[]);for(var a=0;a<s.length;a++)n[o].push($object.clone(s[a])),syn.$l.parseFlat2Nested(e,s[a],n[o][a],r,i,o)}return n},findNestedByID(e,t,n,r){var i=null,o=e[r=1==$object.isNullOrUndefined(r)?"items":r];if(e&&o){if(e[n]==t)return i=e;for(var s=0;s<o.length;s++){var a=o[s];if(a[n]==t)return i=a;if(a[r]&&0<a[r].length&&(i=syn.$l.findNestedByID(a,t,n,r)))return i}}return i},deepFreeze(e){var t;for(t of Object.getOwnPropertyNames(e)){var n=e[t];e[t]=n&&"object"==typeof n?syn.$l.deepFreeze(n):n}return Object.freeze(e)},createBlob(t,n){try{return new Blob([t],{type:n})}catch(e){var r=new(globalRoot.BlobBuilder||globalRoot.WebKitBlobBuilder||globalRoot.MozBlobBuilder||globalRoot.MSBlobBuilder);return r.append(t.buffer||t),r.getBlob(n)}},dataUriToBlob(e){var t=null;try{for(var n=syn.$c.base64Decode(e.split(",")[1]),r=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(n.length),o=new Uint8Array(i),s=0;s<n.length;s++)o[s]=n.charCodeAt(s);t=new Blob([i],{type:r})}catch(e){syn.$l.eventLog("$w.dataUriToBlob",e,"Warning")}return t},dataUriToText(e){var t=null;try{t={value:syn.$c.base64Decode(e.split(",")[1]),mime:e.split(",")[0].split(":")[1].split(";")[0]}}catch(e){syn.$l.eventLog("$w.dataUriToText",e,"Warning")}return t},blobToDataUri(e,t){var n;1==$object.isNullOrUndefined(t)?syn.$l.eventLog("$l.blobToDataUri","blob 결과 callback 확인 필요","Warning"):((n=new FileReader).onloadend=function(){var e=n.result;t(e)},n.onerror=function(){syn.$l.eventLog("$l.blobToDataUri",n.error,"Error"),n.abort()},n.readAsDataURL(e))},blobToDownload(e,t){var n,r;l.navigator&&l.navigator.msSaveOrOpenBlob?l.navigator.msSaveOrOpenBlob(e,t):(n=syn.$r.createBlobUrl(e),(r=c.createElement("a")).href=n,r.download=t,syn.$l.dispatchClick(r),setTimeout(function(){syn.$r.revokeBlobUrl(n),r.remove&&r.remove()},100))},blobUrlToBlob(e,t){var n;1==$object.isNullOrUndefined(t)?syn.$l.eventLog("$l.blobUrlToBlob","blob 결과 callback 확인 필요","Warning"):((n=syn.$w.xmlHttp()).open("GET",e),syn.$w.setServiceClientHeader&&0==syn.$w.setServiceClientHeader(n)||(n.responseType="blob",n.onload=function(){t(n.response)},n.onerror=function(){syn.$l.eventLog("$l.blobUrlToBlob","url: {0}, status: {1}".format(e,n.statusText),"Warning")},n.send()))},blobUrlToDataUri(n,r){var e;1==$object.isNullOrUndefined(r)?syn.$l.eventLog("$l.blobUrlToDataUri","blob 결과 callback 확인 필요","Warning"):((e=syn.$w.xmlHttp()).open("GET",n),syn.$w.setServiceClientHeader&&0==syn.$w.setServiceClientHeader(e)||(e.responseType="blob",e.onload=function(){var t=new FileReader;t.onloadend=function(){var e=t.result;setTimeout(function(){syn.$r.revokeBlobUrl(n)},25),r(null,e)},t.onerror=function(){syn.$l.eventLog("$l.blobUrlToDataUri",t.error,"Error"),t.abort(),r(t.error.message,null)},t.readAsDataURL(e.response)},e.onerror=function(){syn.$l.eventLog("$l.blobUrlToDataUri","url: {0}, status: {1}".format(n,e.statusText),"Warning"),r("url: {0}, status: {1}".format(n,e.statusText),null)},e.send()))},async blobToBase64(r){return new Promise((e,t)=>{const n=new FileReader;n.onloadend=()=>e(n.result),n.onerror=e=>t(e),n.readAsDataURL(r)})},base64ToBlob(e,t,n){if(""!==e&&void 0!==e){1==$string.isNullOrEmpty(t)&&(t=""),1==$string.isNullOrEmpty(n)&&(n=512);for(var r=atob(e),i=[],o=0;o<r.length;o+=n){for(var s=r.slice(o,o+n),a=new Array(s.length),l=0;l<s.length;l++)a[l]=s.charCodeAt(l);var u=new Uint8Array(a);i.push(u)}return new Blob(i,{type:t})}},async blobToFile(e,t,n="text/plain"){var r=null;return r=e&&e.type&&e.size?new File([e],t,{type:n}):r},async fileToBase64(r){return new Promise((e,t)=>{var n=new FileReader;n.onload=()=>e(n.result),n.onerror=e=>t(e),n.readAsDataURL(r)})},async fileToBlob(e){var e=await syn.$l.fileToBase64(e),t=e?.match(/[^:]\w+\/[\w-+\d.]+(?=;|,)/)[0],e=e.split(",")[1];return syn.$l.base64ToBlob(e,t)},async resizeImage(n,r){function i(){var e=s.width,t=s.height;return t<e?r<=0?(r=80)<e&&(t*=r/e,e=r):r<e&&(t*=r/e,e=r):r<=0?(r=80)<t&&(e*=r/t,t=r):r<t&&(e*=r/t,t=r),a.width=e,a.height=t,a.getContext("2d").drawImage(s,0,0,e,t),{blob:function(e){for(var t=(0<=e.split(",")[0].indexOf("base64")?atob:decodeURIComponent)(e.split(",")[1]),e=e.split(",")[0].split(":")[1].split(";")[0],n=t.length,r=new Uint8Array(n),i=0;i<n;i++)r[i]=t.charCodeAt(i);return new Blob([r],{type:e||"image/jpeg"})}(a.toDataURL("image/jpeg")),width:e,height:t}}var o=new FileReader,s=new Image,a=c.createElement("canvas");return new Promise(function(t,e){n.type.match(/image.*/)?(o.onload=function(e){s.onload=function(){return t(i())},s.src=e.target.result},o.readAsDataURL(n)):e(new Error("이미지 파일 확인 필요"))})},logLevel:new function(){this.Verbose=0,this.Debug=1,this.Information=2,this.Warning=3,this.Error=4,this.Fatal=5},start:(new Date).getTime(),eventLogTimer:null,eventLogCount:0,eventLog(e,t,n){var r="object"==typeof t?t.message:t,t="object"==typeof t?t.stack:t;if(n?1==$object.isString(n)&&(n=syn.$l.logLevel[n]):n=0,!(syn.Config&&syn.Config.UIEventLogLevel&&syn.$l.logLevel[syn.Config.UIEventLogLevel]>n)){var n=syn.$l.toEnumText(syn.$l.logLevel,n),i=(new Date).getTime()-syn.$l.start;if("node"===globalRoot.devicePlatform)switch(s=syn.$l.eventLogCount.toString()+"@"+(i/1e3).toString().format("0.000")+" ["+e+"] "+(r===t?r:t),n){case"Debug":globalRoot.$logger.debug(s);break;case"Information":globalRoot.$logger.info(s);break;case"Warning":globalRoot.$logger.warn(s);break;case"Error":globalRoot.$logger.error(s);break;case"Fatal":globalRoot.$logger.fatal(s);break;default:globalRoot.$logger.trace(s)}else{var o,s=syn.$l.eventLogCount.toString()+"@"+(i/1e3).toString().format("0.000")+" ["+n+"] ["+e+"] "+(r===t?r:t);1==syn.Config.IsDebugMode&&"Development"==syn.Config.Environment&&["Warning","Error","Fatal"].indexOf(n),l.console?console.log(s):(i=c.createElement("DIV"),e=c.createTextNode(s),i.appendChild(e),(o=c.getElementById("eventlogs"))?(o.appendChild(i),clearTimeout(syn.$l.eventLogTimer),syn.$l.eventLogTimer=setTimeout(function(){o.scrollTop=o.scrollHeight},10)):c.body.appendChild(i)),l.bound&&bound.browserEvent("browser",{ID:"EventLog",Data:s},function(e,t){e&&console.log("browser EventLog - {0}".format(e))})}syn.$l.eventLogCount++}},moduleEventLog(e,t,n,r){var i="object"==typeof n?n.message:n,n="object"==typeof n?n.stack:n;if(r?1==$object.isString(r)&&(r=syn.$l.logLevel[r]):r=0,!(syn.Config&&syn.Config.UIEventLogLevel&&syn.$l.logLevel[syn.Config.UIEventLogLevel]>r)){var r=syn.$l.toEnumText(syn.$l.logLevel,r),o=(new Date).getTime()-syn.$l.start,s=syn.$l.eventLogCount.toString()+"@"+(o/1e3).toString().format("0.000")+" ["+t+"] "+(i===n?i:n),o=syn.getModuleLibrary(e);if(o){var a=o.logger;switch(r){case"Debug":a.debug(s);break;case"Information":a.info(s);break;case"Warning":a.warn(s);break;case"Error":a.error(s);break;case"Fatal":a.fatal(s);break;default:a.trace(s)}}else console.log("ModuleID 확인 필요 - {0}".format(e));syn.$l.eventLogCount++}}}),syn.$l=u,"node"===globalRoot.devicePlatform?(delete syn.$l.addEvent,delete syn.$l.addLive,delete syn.$l.removeEvent,delete syn.$l.hasEvent,delete syn.$l.trigger,delete syn.$l.triggerEvent,delete syn.$l.addBind,delete syn.$l.get,delete syn.$l.querySelector,delete syn.$l.getName,delete syn.$l.querySelectorAll,delete syn.$l.getElementsById,delete syn.$l.getElementsByClassName,delete syn.$l.getElementsByTagName):(delete syn.$l.moduleEventLog,l.onevent=syn.$l.addEvent,l.bind=syn.$l.addBind,l.trigger=syn.$l.trigger,syn.$l.addEvent(l,"unload",events.flush))}(globalRoot),!function(e){"use strict";var s=e.$request||new syn.module,a=null;"node"!==globalRoot.devicePlatform&&(a=e.document),s.extend({version:"1.0.0",params:{},path:"node"===globalRoot.devicePlatform?"":location.pathname,query(e,t){return function(e){for(var t=(1==(e=e.split("?")).length?e[0]:e[1]).split("&"),n=0;n<t.length;n++){var r=t[n].indexOf("="),i=t[n].substring(0,r),r=t[n].substring(r+1);syn.$r.params[i]=r}return syn.$r.params}(t=t||location.href)[e]},url(){var e,t=syn.$r.path.split("?"),n="",n=syn.$r.path+(0<syn.$r.path.length&&1<t.length?"&":"?");for(e in s.params)"string"==typeof syn.$r.params[e]&&(n+=e+"="+syn.$r.params[e]+"&");return syn.Config&&0==$string.toBoolean(syn.Config.IsClientCaching)&&(n+="&noCache="+(new Date).getTime()),encodeURI(n.substring(0,n.length-1))},toQueryString(e,t){e=e?Object.entries(e).reduce((e,t,n)=>{var r=t[0],t=t[1];return e+=`&${r}=`+$string.toValue(t,"")},""):"";return e=0==$string.isNullOrEmpty(e)&&1==$string.toBoolean(t)?"?"+e.substring(1):e},toUrlObject(e){return((e=e||location.href).match(/([^?=&]+)(=([^&]*))/g)||[]).reduce(function(e,t){return e[t.slice(0,t.indexOf("="))]=t.slice(t.indexOf("=")+1),e},{})},async isCorsEnabled(e){var t=!1;try{var n=await fetch(e,{method:"HEAD",timeout:200});0==(t=200<=n.status&&n.status<=299)&&syn.$l.eventLog("$w.isCorsEnabled","{0}, {1}:{2}".format(e,n.status,n.statusText),"Warning")}catch(e){syn.$l.eventLog("$w.isCorsEnabled",e.message,"Error")}return t},httpRequest(e,t,n,r){1==$object.isNullOrUndefined(n)&&(n={});var i="application/json",o=null;if(0==$object.isNullOrUndefined(n.body)){var i=null,s=n.body;if("GET"==e.toUpperCase()){var a=t+(1<t.split("?").length?"&":"?");for(l in s)a+=l+"="+s[l].toString()+"&";t=encodeURI(a.substring(0,a.length-1))}else for(var l in o=new FormData,s)o.append(l,s[l].toString())}var u=syn.$w.xmlHttp();if(u.open(e,t,!0),!syn.$w.setServiceClientHeader||0!=syn.$w.setServiceClientHeader(u))if(r)u.onreadystatechange=function(){4===u.readyState&&(200!==u.status?0==u.status?syn.$l.eventLog("$r.httpRequest","X-Requested transfort error","Fatal"):syn.$l.eventLog("$r.httpRequest","response status - {0}".format(u.statusText)+u.responseText,"Error"):r&&r({status:u.status,response:u.responseText}))},null==o?n!={}?u.send(JSON.stringify(n)):u.send():u.send(o);else{if(globalRoot.Promise)return new Promise(function(e){u.onload=function(){return e({status:u.status,response:u.responseText})},u.onerror=function(){return e({status:u.status,response:u.responseText})},null!=i&&u.setRequestHeader("Content-Type",i),null==o?n!={}?u.send(JSON.stringify(n)):u.send():u.send(o)});syn.$l.eventLog("$w.httpRequest","지원하지 않는 기능. 매개변수 확인 필요","Error")}},httpSubmit(e,t,n){if(0==a.forms.length)return!1;0<a.forms.length&&1==$object.isNullOrUndefined(t)&&(t=a.forms[0].id);t=a.forms[t];if(!t)return!1;t.method=n||"POST",t.action=e,t.submit()},createBlobUrl:globalRoot.URL&&URL.createObjectURL&&URL.createObjectURL.bind(URL)||globalRoot.webkitURL&&webkitURL.createObjectURL&&webkitURL.createObjectURL.bind(webkitURL)||globalRoot.createObjectURL,revokeBlobUrl:globalRoot.URL&&URL.revokeObjectURL&&URL.revokeObjectURL.bind(URL)||globalRoot.webkitURL&&webkitURL.revokeObjectURL&&webkitURL.revokeObjectURL.bind(webkitURL)||globalRoot.revokeObjectURL,getCookie(e){e=a.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return e?decodeURIComponent(e[1]):void 0},setCookie(e,t,n,r,i,o){return 1==$object.isNullOrUndefined(n)&&(n=new Date((new Date).getTime()+864e5)),1==$object.isNullOrUndefined(r)&&(r="/"),a.cookie=e+"="+encodeURI(t)+(n?";expires="+n.toGMTString():"")+(r?";path="+r:"")+(i?";domain="+i:"")+(o?";secure":""),s},deleteCookie(e,t,n){return syn.$r.getCookie(e)&&(a.cookie=e+"="+(t?";path="+t:"")+(n?";domain="+n:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"),s}}),syn.$r=s}(globalRoot),!function(f){"use strict";var p,g,w,S=f.$network||new syn.module;f.document;function T(e){return Array.isArray?Array.isArray(e):-1!=e.constructor.toString().indexOf("Array")}function e(e){try{if(1==$string.isNullOrEmpty(e.data))return;var t=JSON.parse(e.data);if("object"!=typeof t||null===t)return void syn.$l.eventLog("$network.onPostMessage","postMessage data 확인 필요","Warning")}catch(e){return}var n,r=e.source,i=e.origin,o=null,e=null,s=null;if("string"==typeof t.method&&(s=2==(n=t.method.split("::")).length?(o=n[0],n[1]):t.method),void 0!==t.id&&(e=t.id),"string"==typeof s){var a=!1;if(g[i]&&g[i][o])for(var l=0;l<g[i][o].length;l++)if(g[i][o][l].channelWindow===r){g[i][o][l].handler(i,s,t),a=!0;break}if(!a&&g["*"]&&g["*"][o])for(l=0;l<g["*"][o].length;l++)if(g["*"][o][l].channelWindow===r){g["*"][o][l].handler(i,s,t);break}}else void 0!==e&&w[e]&&w[e](i,s,t)}S.extend({version:"1.0.0",myChannelID:null,connections:[],concreate(e){e.myChannelID=syn.$r.query("channelID")||syn.$r.query("ChannelID")||syn.$r.query("CHANNELID")||syn.$r.query("channelid")||""},rooms:(p=Math.floor(1000001*Math.random()),g={},w={},f.addEventListener?f.addEventListener("message",e,!1):f.attachEvent&&f.attachEvent("onmessage",e),{connect(m){var s=m.scope||syn.$l.random();if(S.findChannel(s))syn.$l.eventLog("$network.connect","channelID: {0} 중복 확인 필요".format(s),"Warning");else{var y=function(e){if(m.debugOutput){try{"string"!=typeof e&&(e=JSON.stringify(e))}catch(e){syn.$l.eventLog("$network.debug","channelID: {0}, message: {1}".format(s,e.message),"Error")}syn.$l.eventLog("$network.debug","channelID: {0}, message: {1}".format(s,e),"Information")}};if("object"!=typeof m)syn.$l.eventLog("$network.options","유효한 매개변수 없이 호출된 채널 빌드","Error");else if(m.window&&m.window.postMessage)if(f===m.window)syn.$l.eventLog("$network.context","동일한 화면에서 거래되는 채널 생성은 허용되지 않음","Error");else{m.origin||(m.origin="*");var e=!1;if("string"==typeof m.origin&&("*"===m.origin?e=!0:null!==(t=m.origin.match(/^https?:\/\/(?:[-a-zA-Z0-9_\.])+(?::\d+)?/))&&(m.origin=t[0].toLowerCase(),e=!0)),e){if(void 0!==m.scope){if("string"!=typeof m.scope)return void syn.$l.eventLog("$network.scope","scope는 문자열이어야 함","Error");if(1<m.scope.split("::").length)return void syn.$l.eventLog("$network.scope",'scope에는 이중 콜론 ("::")이 포함될 수 없음',"Error")}var v={},b={},E={},a=!1,l=[],u=function(e,t,n){if("function"==typeof m.gotMessageObserver)try{m.gotMessageObserver(e,n)}catch(d){y("gotMessageObserver() 오류: "+d.toString())}if(n.id&&t){if(v[t]){h=n.id,f=n.callbacks||[],g=p=!1;var r={origin:e,invoke(e,t){if(E[h]){for(var n=!1,r=0;r<f.length;r++)if(e===f[r]){n=!0;break}n?C({id:h,callback:e,params:t}):syn.$l.eventLog("$network.invoke","존재하지 않는 콜백 호출 시도: "+e,"Warning")}else syn.$l.eventLog("$network.invoke","존재하지 않는 트랜잭션의 콜백 호출 시도: "+h,"Warning")},error(e,t){g=!0,E[h]?(delete E[h],C({id:h,error:e,message:t})):syn.$l.eventLog("$network.error","존재하지 않는 메시지의 호출 시도: "+h,"Warning")},complete(e){g=!0,E[h]?(delete E[h],C({id:h,result:e})):syn.$l.eventLog("$network.complete","존재하지 않는 메시지의 호출 시도: "+h,"Warning")},delayReturn(e){return p="boolean"==typeof e?!0===e:p},completed(){return g}};E[n.id]={};try{if(n.callbacks&&T(n.callbacks)&&0<n.callbacks.length)for(var i=0;i<n.callbacks.length;i++){for(var o=n.callbacks[i],s=n.params,a=o.split("/"),l=0;l<a.length-1;l++){var u=a[l];"object"!=typeof s[u]&&(s[u]={}),s=s[u]}s[a[a.length-1]]=function(){var t=o;return function(e){return r.invoke(t,e)}}()}var c=v[t](r,n.params);r.delayReturn()||r.completed()||r.complete(c)}catch(t){var d="runtime_error",c=null;if("string"==typeof t?c=t:"object"==typeof t&&(t&&T(t)&&2==t.length?(d=t[0],c=t[1]):"string"==typeof t.error&&(d=t.error,t.message?"string"==typeof t.message?c=t.message:t=t.message:c="")),null===c)try{void 0===(c=JSON.stringify(t))&&(c=t.toString())}catch(e){c=t.toString()}r.error(d,c)}}}else n.id&&n.callback?b[n.id]&&b[n.id].callbacks&&b[n.id].callbacks[n.callback]?b[n.id].callbacks[n.callback](n.params):y("유효하지 않는 콜백, id:"+n.id+" ("+n.callback+")"):n.id?b[n.id]?(n.error?(0,b[n.id].error)(n.error,n.message):void 0!==n.result?(0,b[n.id].success)(n.result):(0,b[n.id].success)(),delete b[n.id],delete w[n.id]):y("유효하지 않는 응답: "+n.id):t&&v[t]&&v[t]({origin:e},n.params);var h,f,p,g},n=m.window,t=m.origin,r="string"==typeof m.scope?m.scope:"",e=u;function i(e){for(var t=0;t<e.length;t++)if(e[t].channelWindow===n)return!0;return!1}var o=!1;if("*"===t){for(var c in g)if(g.hasOwnProperty(c)&&"*"!==c&&"object"==typeof g[c][r]&&(o=i(g[c][r])))break}else!(o=g["*"]&&g["*"][r]?i(g["*"][r]):o)&&g[t]&&g[t][r]&&(o=i(g[t][r]));o?syn.$l.eventLog("$network.addChannel","origin: "+t+", scope: "+r+"에 해당하는 채널이 이미 있습니다","Warning"):("object"!=typeof g[t]&&(g[t]={}),"object"!=typeof g[t][r]&&(g[t][r]=[]),g[t][r].push({channelWindow:n,handler:e}));var d=function(e){return e="string"==typeof m.scope&&m.scope.length?[m.scope,e].join("::"):e},C=function(e,t){if(e)if(y((a?"post ":"queue ")+" message: "+JSON.stringify(e)),t||a){if("function"==typeof m.postMessageObserver)try{m.postMessageObserver(m.origin,e)}catch(e){y("postMessageObserver() 확인 필요: "+e.toString())}m.window.postMessage(JSON.stringify(e),m.origin)}else l.push(e);else syn.$l.eventLog("$network.postMessage","null 메시지로 postMessage 호출","Error")},h={unbind(e){return!!v[e]&&(delete v[e]||void syn.$l.eventLog("$network.unbind","registrationMappingMethods 삭제 확인 필요: "+e,"Warning"))},bind(e,t){if(e&&"string"==typeof e)if(t&&"function"==typeof t){if(!v[e])return v[e]=t,S;syn.$l.eventLog("$network.bind",e+" method 중복 확인 필요","Warning")}else syn.$l.eventLog("$network.bind","callback 매개변수 확인 필요","Warning");else syn.$l.eventLog("$network.bind","method 매개변수 확인 필요","Warning")},call(e){var i,o,s,a,t,n,r,l;e?e.method&&"string"==typeof e.method?e.success&&"function"==typeof e.success?(i={},o=[],s=[],(a=function(e,t){if(0<=s.indexOf(t))syn.$l.eventLog("$network.pruneFunctions","recursive params 데이터 없음","Warning");else if(s.push(t),"object"==typeof t)for(var n in t){var r;t.hasOwnProperty(n)&&(r=e+(e.length?"/":"")+n,"function"==typeof t[n]?(i[r]=t[n],o.push(r),delete t[n]):"object"==typeof t[n]&&a(r,t[n]))}})("",e.params),t={id:p,method:d(e.method),params:e.params},o.length&&(t.callbacks=o),e.timeout&&(n=p,r=e.timeout,l=d(e.method),setTimeout(function(){b[n]&&((0,b[n].error)("timeout_error",'"'+l+'" 타임아웃 ('+r+"ms) "),delete b[n],delete w[n])},r)),b[p]={callbacks:i,error:e.error,success:e.success},w[p]=u,p++,C(t)):syn.$l.eventLog("$network.call","callback 매개변수 확인 필요","Warning"):syn.$l.eventLog("$network.call","method 매개변수 확인 필요","Warning"):syn.$l.eventLog("$network.call","매개변수 확인 필요","Warning")},emit(e){if(!e)throw"missing arguments to emit function";e.method&&"string"==typeof e.method?C({method:d(e.method),params:e.params}):syn.$l.eventLog("$network.emit","method 매개변수 확인 필요","Warning")},destroy(){for(var e=m.window,t=m.origin,n="string"==typeof m.scope?m.scope:"",r=g[t][n],i=0;i<r.length;i++)r[i].channelWindow===e&&r.splice(i,1);0===g[t][n].length&&delete g[t][n];var o=S.connections.findIndex(e=>e.options.origin==t&&e.options.scope==n);-1<o&&S.connections.splice(o,1),f.removeEventListener?f.removeEventListener("message",u,!1):f.detachEvent&&f.detachEvent("onmessage",u),a=!1,v={},E={},b={},m.origin=null,l=[],s="",y("채널 삭제")}};return h.bind("__ready",function(e,t){if(y("ready message received"),a)syn.$l.eventLog("$network.onReady","ready 메시지 확인 필요","Warning");else{for(s+="T"===t?"-R":"-L",h.unbind("__ready"),a=!0,y("ready message accepted"),"T"===t&&h.emit({method:"__ready",params:"A"});l.length;)C(l.pop());"function"==typeof m.onReady&&m.onReady(h)}}),setTimeout(function(){C({method:d("__ready"),params:"T"},!0)},0),h.options=m,S.connections.push(h),h}syn.$l.eventLog("$network.origin","유효한 origin 없이 호출된 채널 빌드","Error")}else syn.$l.eventLog("$network.context","필수 매개변수 없이 호출된 채널 빌드","Error")}}}),findChannel(t){return S.connections.find(e=>e.options.scope==t)},call(e,n,t){var r=S.findChannel(e);r&&(e={method:n,params:t,error:(e,t)=>{},success:e=>{}},!0===r.options.debugOutput&&(e.error=(e,t)=>{syn.$l.eventLog("$network.call.error",'"{0}" call error: {1}, message: {2}, channelID: {3}'.format(n,e,t,r.options.scope),"Information")},e.success=e=>{syn.$l.eventLog("$network.call.success",'"{0}" call returns: {1}, channelID: {2}'.format(n,e,r.options.scope),"Information")}),r.call(e))},broadCast(n,e){for(var t=0;t<connections.length;t++){var r,i=connections[t];i&&(r={method:n,params:e,error:(e,t)=>{},success:e=>{}},!0===i.options.debugOutput&&(r.error=(e,t)=>{syn.$l.eventLog("$network.call.error",'"{0}" call error: {1}, message: {2}, channelID: {3}'.format(n,e,t,i.options.scope),"Information")},r.success=e=>{syn.$l.eventLog("$network.call.success",'"{0}" call returns: {1}, channelID: {2}'.format(n,e,i.options.scope),"Information")}),i.call(r))}},emit(n,e){var t;0==$string.isNullOrEmpty(S.myChannelID)&&(t=S.findChannel(S.myChannelID))&&(e={method:n,params:e,error:(e,t)=>{},success:e=>{}},!0===t.options.debugOutput&&(e.error=(e,t)=>{syn.$l.eventLog("$network.emit.error",'"{0}" emit error: {1}, message: {2}'.format(n,e,t),"Information")},e.success=e=>{syn.$l.eventLog("$network.emit.success",'"{0}" emit returns: {1}'.format(n,e),"Information")}),t.emit(e))}}),S.myChannelID=syn.$r.query("channelID")||syn.$r.query("ChannelID")||syn.$r.query("CHANNELID")||syn.$r.query("channelid")||"",syn.$n=S}(globalRoot),!function(context){"use strict";var $webform=context.$webform||new syn.module,document=null;if("node"!==globalRoot.devicePlatform&&($webform.context=context,$webform.document=context.document,document=context.document),$webform.extend({version:"1.0.0",localeID:"ko-KR",cookiePrefixName:"HandStack",method:"POST",isPageLoad:!1,transactionLoaderID:null,pageReadyTimeout:6e4,eventAddReady:"node"===globalRoot.devicePlatform?null:new CustomEvent("addready"),eventRemoveReady:"node"===globalRoot.devicePlatform?null:new CustomEvent("removeready"),mappingModule:!0,moduleReadyIntervalID:null,remainingReadyIntervalID:null,remainingReadyCount:0,defaultControlOptions:{value:"",text:"",dataType:"string",bindingID:"",resourceKey:"",localeID:"ko-KR",required:!1,tooltip:""},setStorage(e,t,n,r){return null==n&&(n=!1),"node"===globalRoot.devicePlatform?1==n?localStorage.setItem(e,JSON.stringify(t)):(null==r&&(r=12e5),r={value:t,expiry:(new Date).getTime()+r,ttl:r},localStorage.setItem(e,JSON.stringify(r))):(1==n?localStorage:sessionStorage).setItem(e,JSON.stringify(t)),$webform},getStorage(e,t){var n=null;if(null==t&&(t=!1),"node"===globalRoot.devicePlatform)if(1==t)localStorage.getItem(e);else{var r=localStorage.getItem(e);if(!r)return null;r=JSON.parse(r);if((new Date).getTime()>r.expiry)return localStorage.removeItem(e),null;var n=r.value,i=r.ttl,r={value:n,expiry:(new Date).getTime()+i,ttl:i};localStorage.setItem(e,JSON.stringify(r))}else n=1==t?JSON.parse(localStorage.getItem(e)):JSON.parse(sessionStorage.getItem(e));return n},removeStorage(e,t){null==t&&(t=!1),("node"===globalRoot.devicePlatform||1==t?localStorage:sessionStorage).removeItem(e)},activeControl(e){var t=null;return null==(t=(e=e||context.event||null)?e.target||e.srcElement||e||null:document.activeElement||null)?globalRoot.$this&&(t=$this.context.focusControl||null):$this.context.focusControl=t,t},async contentLoaded(){if(syn.$l.addEvent(document,"addready",function(){syn.$w.remainingReadyCount++}),syn.$l.addEvent(document,"removeready",function(){syn.$w.remainingReadyCount--}),syn.$l.get("moduleScript"))syn.$w.extend({pageScript:syn.$l.get("moduleScript").value});else{var pathname=location.pathname,filename,input=(0<pathname.split("/").length&&(filename=pathname.split("/")[pathname.split("/").length-1],$webform.extend({pageProject:pathname.split("/")[pathname.split("/").length-2],pageScript:"$"+(-1<filename.indexOf(".")?filename.substring(0,filename.indexOf(".")):filename)})),document.createElement("input"));if(input.id="moduleScript",input.type="text",input.style.display="none",input.value=syn.$w.pageScript,document.body.appendChild(input),document.forms)for(var i=0;i<document.forms.length;i++)syn.$l.addEvent(document.forms[i],"submit",function(e){var t=!1,n=e.target||e.srcElement;if($this&&$this.hook&&$this.hook.frameEvent&&(t=$this.hook.frameEvent("beforeSubmit",{el:n,evt:e}),1!=$object.isNullOrUndefined(t)&&0!=$string.toBoolean(t)||(t=!1)),0==t)return e.returnValue=!1,e.cancel=!0,e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1})}var pageLoad=function(){context.domainPageLoad&&context.domainPageLoad();var e,n=context[syn.$w.pageScript],t=(n&&n.hook.pageLoad&&n.hook.pageLoad(),n&&n.hook.pageMatch&&(e=function(e){var t="xs";switch(e.media){case"(min-width: 576px)":t="sm";break;case"(min-width: 768px)":t="md";break;case"(min-width: 992px)":t="lg";break;case"(min-width: 1200px)":t="xl";break;case"(min-width: 1400px)":t="xxl"}document.dispatchEvent(new CustomEvent("mediaquery",{detail:t})),n.hook.pageMatch(t),context.domainPageMediaQuery&&context.domainPageMediaQuery(t)},syn.$l.addEvent(matchMedia("(min-width: 0px)"),"change",e),syn.$l.addEvent(matchMedia("(min-width: 576px)"),"change",e),syn.$l.addEvent(matchMedia("(min-width: 768px)"),"change",e),syn.$l.addEvent(matchMedia("(min-width: 992px)"),"change",e),syn.$l.addEvent(matchMedia("(min-width: 1200px)"),"change",e),syn.$l.addEvent(matchMedia("(min-width: 1400px)"),"change",e)),1==$object.isNullOrUndefined(syn.$w.User)&&(e={TokenID:"",UserNo:0,UserID:"",UserName:"",BusinessTel:"",BusinessEMail:"",DepartmentID:"",DepartmentName:"",PositionID:"",PositionName:"",CompanyNo:"",CompanyName:"",Roles:[],Claims:[]},syn.$w.getSSOInfo?syn.$w.User=syn.$w.getSSOInfo()||e:syn.$w.User=e),0==$object.isNullOrUndefined(syn.$w.User)&&syn.$l.deepFreeze(syn.$w.User),0==$object.isNullOrUndefined(syn.$w.Variable)&&syn.$l.deepFreeze(syn.$w.Variable),null);if(document.forms)for(var r=0;r<document.forms.length;r++){var i=document.forms[r],t=i.getAttribute("hidden");0==$object.isNullOrUndefined(t)&&0==$string.toBoolean(t)&&(i.removeAttribute("hidden"),syn.$m.removeClass(i,"hidden"),i.style.display="")}if(t=document.body.getAttribute("hidden"),0==$object.isNullOrUndefined(t)&&0==$string.toBoolean(t)&&(document.body.removeAttribute("hidden"),syn.$m.removeClass(document.body,"hidden"),document.body.style.display=""),n&&n.context.synControls&&(1==$object.isNullOrUndefined(n.context.tabOrderControls)||0==n.context.tabOrderControls.length)){var o=[],s=document.body.outerHTML.match(/<(syn_).+?>/gi);if(s)for(var a=s.length,r=0;r<a;r++){var l=s[r],u=l.substring(1,l.indexOf(" ")).toUpperCase();o.push(u)}for(var o=$array.distinct(o),c=document.querySelectorAll("input,select,textarea,button"+(0<o.length?","+o.join(","):"")),d=[],h=c.length,f=0;f<h;f++)(p=c[f])&&p.style&&"none"==p.style.display||"hidden"==p.type?!p.id||"SELECT"!=p.tagName.toUpperCase()||null==p.getAttribute("syn-datafield")&&null==p.getAttribute("syn-datafield")||d.push(p):(p.id&&0==p.id.includes("btn_syneditor_")&&0==p.id.includes("chk_syngrid_")&&0==p.id.includes("_hidden")||p.id&&"SELECT"==p.tagName.toUpperCase()&&(null!=p.getAttribute("syn-datafield")||null!=p.getAttribute("syn-datafield"))||p.id&&1==p.tagName.includes("SYN_"))&&d.push(p);for(var p,g,m,y,v,b=[],r=0,h=d.length,f=0;f<h;f++)(p=d[f]).id&&0==p.id.includes("btn_syneditor_")&&0==p.id.includes("chk_syngrid_")&&0==p.id.includes("_hidden")?(g=p.id,m=syn.$d.offset(p),(v=p.getAttribute("baseID"))&&(g=v),(v=n.context.synControls.find(function(e){return e.id==g}))&&("datepicker"==v.type?m=syn.$d.offset(p.parentElement):"colorpicker"==v.type&&(m=syn.$d.offset(p.parentElement.parentElement)),b.push({elID:p.id,tagName:p.tagName,formID:v.formDataFieldID,type:v.type,top:m.top,left:m.left}))):!p.id||"SELECT"!=p.tagName.toUpperCase()||null==p.getAttribute("syn-datafield")&&null==p.getAttribute("syn-datafield")?p.id&&1==p.tagName.includes("SYN_")&&(g=p.id.replace("_hidden",""),"SYN_DATEPICKER"!=p.tagName&&p.tagName,m=null)&&(v=n.context.synControls.find(function(e){return e.id==g}))&&b.push({elID:g,tagName:p.tagName,formID:v.formDataFieldID,type:v.type,top:m.top,left:m.left}):(m=null,!1===p.getAttribute("multiple")?(y=syn.uicontrols.$select.getControl(p.id))&&(m=syn.$d.offset(y.picker.select)):(y=syn.uicontrols.$multiselect.getControl(p.id))&&(m=syn.$d.offset(y.picker.select)),m&&(v=n.context.synControls.find(function(e){return e.id==p.id}))&&b.push({elID:p.id,tagName:p.tagName,formID:v.formDataFieldID,type:v.type,top:m.top,left:m.left})),r+=1;n.context.focusControl=null,n.context.tabOrderFocusID=null,n.context.tabOrderControls=b,n&&n.hook.frameEvent&&n.hook.frameEvent("tabOrderControls",n.context.tabOrderControls),0<n.context.tabOrderControls.length&&(n.config?(1==$string.isNullOrEmpty(n.context.tapOrderFlow)&&(n.context.tapOrderFlow="html"),"tdlr"==n.context.tapOrderFlow?n.context.tabOrderControls.sort(function(e,t){return e.top===t.top?e.left-t.left:e.top>t.top?1:-1}):"lrtd"==n.context.tapOrderFlow&&n.context.tabOrderControls.sort(function(e,t){return e.left===t.left?e.top-t.top:e.left>t.left?1:-1})):n.context.tabOrderControls.sort(function(e,t){return e.top===t.top?e.left-t.left:e.top>t.top?1:-1}));var E=syn.$l.querySelector("[autofocus]");E&&E.id&&E.tagName&&(u=E.tagName.toUpperCase(),-1<"input,select,textarea,button".toUpperCase().split(",").indexOf(u))&&(n.context.focusControl=E,n.context.tabOrderFocusID=E.id,setTimeout(function(){E.focus()}))}n&&n.hook.pageComplete&&n.hook.pageComplete(),context.domainPageComplete&&context.domainPageComplete()},pageFormInit=async function(){var mod=context[syn.$w.pageScript];if(mod&&mod.hook.pageFormInit&&await mod.hook.pageFormInit(),context.domainLibraryLoad){var isContinue=domainLibraryLoad();if(0==$object.isNullOrUndefined(isContinue)&&!1===isContinue)return!1}for(var synControlList=[],synControls=document.querySelectorAll("[syn-datafield],[syn-options],[syn-events]"),i=0;i<synControls.length;i++){var synControl=synControls[i];if(synControl.tagName){var tagName=synControl.tagName.toUpperCase(),dataField=synControl.getAttribute("syn-datafield"),elementID=synControl.getAttribute("id"),formDataField=synControl.closest("form")?synControl.closest("form").getAttribute("syn-datafield"):"",controlType="",controlOptions=synControl.getAttribute("syn-options")||null;if(null!=controlOptions)try{controlOptions=eval("("+controlOptions+")")}catch(error){syn.$l.eventLog("$w.contentLoaded",'elID: "{0}" syn-options 확인 필요 '.format(elementID)+error.message,"Warning")}else controlOptions={};var controlModule=null;if(syn.uicontrols)if(-1<tagName.indexOf("SYN_"))var moduleName=tagName.substring(4).toLowerCase(),controlModule=syn.uicontrols["$"+moduleName],controlType=moduleName;else switch(tagName){case"BUTTON":controlModule=syn.uicontrols.$button,controlType="button";break;case"INPUT":switch(controlType=null==synControl.getAttribute("type")?"text":synControl.getAttribute("type").toLowerCase(),controlType){case"hidden":case"text":case"password":case"color":case"email":case"number":case"search":case"tel":case"url":controlModule=syn.uicontrols.$textbox;break;case"submit":case"reset":case"button":controlModule=syn.uicontrols.$button;break;case"radio":controlModule=syn.uicontrols.$radio;break;case"checkbox":controlModule=syn.uicontrols.$checkbox}break;case"TEXTAREA":controlModule=syn.uicontrols.$textarea,controlType="textarea";break;case"SELECT":controlType=null==synControl.getAttribute("multiple")?(controlModule=syn.uicontrols.$select,"select"):(controlModule=syn.uicontrols.$multiselect,"multiselect");break;default:controlModule=syn.uicontrols.$element,controlType="element"}syn.$l.addEvent(synControl.id,"focus",function(e){$this.context.focusControl=e.target||e.currentTarget||e.srcElement,$this.context.focusControl?$this.context.tabOrderFocusID=$this.context.focusControl.id:$this.context.tabOrderFocusID=null}),controlModule?(controlModule.addModuleList&&controlModule.addModuleList(synControl,synControlList,controlOptions,controlType),controlModule.controlLoad(elementID,controlOptions)):(elementID&&synControlList.push({id:elementID,formDataFieldID:formDataField,field:dataField,module:null,type:controlType||synControl.tagName.toLowerCase()}),$this.hook.controlLoad&&$this.hook.controlLoad(elementID,controlOptions))}}for(var synEventControls=document.querySelectorAll("[syn-events]"),i=0;i<synEventControls.length;i++){var synControl=synEventControls[i],events=null;try{events=eval("("+synControl.getAttribute("syn-events")+")")}catch(error){syn.$l.eventLog("$w.contentLoaded",'elID: "{0}" syn-events 확인 필요 '.format(synControl.id)+error.message,"Warning")}if(events&&$this.event)for(var length=events.length,j=0;j<length;j++){var event=events[j],func=$this.event[synControl.id+"_"+event];func&&syn.$l.addEvent(synControl.id,event,func)}}for(var synOptionControls=document.querySelectorAll("[syn-options]"),i=0;i<synOptionControls.length;i++){var synControl=synOptionControls[i],elID=synControl.id.replace("_hidden",""),options=null;try{var el=syn.$l.get(synControl.id+"_hidden")||syn.$l.get(synControl.id),options=eval("("+el.getAttribute("syn-options")+")")}catch(error){syn.$l.eventLog("$w.contentLoaded",'elID: "{0}" syn-options 확인 필요'.format(synControl.id)+error.message,"Warning")}if(options&&options.transactConfig&&options.transactConfig.triggerEvent)if(1==$object.isString(options.transactConfig.triggerEvent))syn.$l.addEvent(elID,options.transactConfig.triggerEvent,function(evt){var el=$webform.activeControl(evt),options=eval("("+el.getAttribute("syn-options")+")"),transactConfig=null;options&&options.transactConfig&&(transactConfig=options.transactConfig),transactConfig&&syn.$w.transactionAction(transactConfig,transactConfig.options)});else if(1==$object.isArray(options.transactConfig.triggerEvent)){var triggerFunction=function(evt){var el=$webform.activeControl(evt),options=eval("("+el.getAttribute("syn-options")+")"),transactConfig=null;options&&options.transactConfig&&(transactConfig=options.transactConfig),transactConfig&&syn.$w.transactionAction(transactConfig,transactConfig.options)},key;for(key in options.transactConfig.triggerEvent){var eventName=options.transactConfig.triggerEvent[key];syn.$l.addEvent(elID,eventName,triggerFunction)}}if(options&&options.triggerConfig&&options.triggerConfig.triggerEvent)if(1==$object.isString(options.triggerConfig.triggerEvent))syn.$l.addEvent(elID,options.triggerConfig.triggerEvent,function(triggerConfig){var el=$webform.activeControl(evt),options,options;triggerConfig&&1==$object.isNullOrUndefined(triggerConfig.triggerEvent)?(options=eval("("+el.getAttribute("syn-options")+")"),triggerConfig=options.triggerConfig):(options=eval("("+el.getAttribute("syn-options")+")"),options&&options.triggerConfig&&(triggerConfig=options.triggerConfig)),triggerConfig&&syn.$w.triggerAction(triggerConfig)});else if(1==$object.isArray(options.triggerConfig.triggerEvent)){var triggerFunction=function(triggerConfig){var el=$webform.activeControl(evt),options,options;triggerConfig&&1==$object.isNullOrUndefined(triggerConfig.triggerEvent)?(options=eval("("+el.getAttribute("syn-options")+")"),triggerConfig=options.triggerConfig):(options=eval("("+el.getAttribute("syn-options")+")"),options&&options.triggerConfig&&(triggerConfig=options.triggerConfig)),triggerConfig&&syn.$w.triggerAction(triggerConfig)},key;for(key in options.triggerConfig.triggerEvent){var eventName=options.triggerConfig.triggerEvent[key];syn.$l.addEvent(elID,eventName,triggerFunction)}}}var elem=document.createElement("input");elem.type="hidden",elem.id="synControlList",elem.textContent=JSON.stringify(synControlList),document.body.appendChild(elem),mod?mod.context.synControls=synControlList:context.synControls=synControlList,syn.$w.remainingReadyIntervalID=setInterval(function(){0==syn.$w.remainingReadyCount&&(clearInterval(syn.$w.remainingReadyIntervalID),syn.$w.remainingReadyIntervalID=null,pageLoad(),syn.$w.isPageLoad=!0)},25),setTimeout(function(){null!=syn.$w.remainingReadyIntervalID&&(clearInterval(syn.$w.remainingReadyIntervalID),syn.$w.remainingReadyIntervalID=null,syn.$l.eventLog("pageLoad","화면 초기화 오류, remainingReadyCount: {0} 확인 필요".format(syn.$w.remainingReadyCount),"Fatal"))},syn.$w.pageReadyTimeout)},module,mod;1==syn.$w.mappingModule?(module={},syn.$l.get("moduleScript")&&syn.$w.extend({pageScript:syn.$l.get("moduleScript").value}),0==$string.toBoolean(window.noPageScript)&&(module=await syn.$w.fetchScript(syn.$w.pageScript.replace("$",""))),mod=context[syn.$w.pageScript]||new syn.module,mod.config={programID:syn.Config.ApplicationID,businessID:syn.$w.pageProject||syn.Config.ProjectID,systemID:syn.Config.SystemID,transactionID:syn.$w.pageScript.replace("$",""),transactions:[],dataSource:{},actionButtons:[]},mod.prop={},mod.model={},mod.hook={},mod.event={},mod.translate={},mod.transaction={},mod.method={},mod.store={},mod.context={},mod.extend(module),context[syn.$w.pageScript]=mod,context.$this=mod,window.synLoader?(syn.$l.addEvent(document,"pageReady",pageFormInit),context.pageFormReady=!0,setTimeout(function(){syn.$l.removeEvent(document,"pageReady",pageFormInit),null!=syn.$w.remainingReadyIntervalID&&syn.$l.eventLog("pageReady","화면 초기화 오류, loader 또는 dispatchEvent 확인 필요","Fatal")},syn.$w.pageReadyTimeout)):await pageFormInit()):(pageLoad(),syn.$w.isPageLoad=!0)},addReadyCount(){syn.$w.eventAddReady&&0==syn.$w.isPageLoad&&document.dispatchEvent(syn.$w.eventAddReady)},removeReadyCount(){syn.$w.eventRemoveReady&&0==syn.$w.isPageLoad&&document.dispatchEvent(syn.$w.eventRemoveReady)},createSelection(e,t,n){var r,i;(e=1==$object.isString(e)?syn.$l.get(e):e).createTextRange?(r=n-t,(i=e.createTextRange()).collapse(!0),i.moveStart("character",t),i.moveEnd("character",r),i.select(),i=r=null):"email"!=e.type&&e.setSelectionRange&&e.setSelectionRange(t,n),e.focus()},argumentsExtend(){var e,t={};for(e in arguments){var n,r=arguments[e];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},loadJson(e,t,n,r,i,o){null==i&&(i=!0),null==o&&(o=!1);var s=new XMLHttpRequest;!0===i?(s.onreadystatechange=function(){s.readyState===XMLHttpRequest.DONE&&(200===s.status?(n&&n(t,JSON.parse(s.responseText)),r&&r()):syn.$l.eventLog("$w.loadJson","async url: "+e+", status: "+s.status.toString()+", responseText: "+s.responseText,"Error"),200!==s.status)&&r&&1==o&&r()},s.open("GET",e,!0),syn.$w.setServiceClientHeader&&0==syn.$w.setServiceClientHeader(s)||s.send()):(s.open("GET",e,!1),syn.$w.setServiceClientHeader&&0==syn.$w.setServiceClientHeader(s)||(s.send(),200===s.status?(n&&n(t,JSON.parse(s.responseText)),r&&r()):syn.$l.eventLog("$w.loadJson","sync url: "+e+", status: "+s.status.toString()+", responseText: "+s.responseText,"Error"),r&&1==o&&r()))},getTriggerOptions(e){return e=1==$object.isString(e)?syn.$l.get(e):e,JSON.parse(e.getAttribute("triggerOptions"))},triggerAction(e){if($this){var t=!0;if(e.params=syn.$w.argumentsExtend({args:[],options:{}},e.params),$this.hook.beforeTrigger&&(t=$this.hook.beforeTrigger(e.triggerID,e.action,e.params)),1==$object.isNullOrUndefined(t)||1==t){var t=syn.$l.get(e.triggerID),n=null;if(e.action&&1==e.action.startsWith("syn.uicontrols.$")){n=syn.uicontrols;var r=e.action.split(".");if(3<r.length)for(var i=2;i<r.length;i++)var o=r[i],n=(n||context)[o];else n=context[e.action]}else n=$this.event?$this.event["{0}_{1}".format(e.triggerID,e.action)]:null;n?(t.setAttribute("triggerOptions",JSON.stringify(e.params.options)),-1<e.action.indexOf("$")&&$array.addAt(e.params.args,0,e.triggerID),t=n.apply(t,e.params.args),$this.hook.afterTrigger&&$this.hook.afterTrigger(null,e.action,{elID:e.triggerID,result:t})):$this.hook.afterTrigger&&$this.hook.afterTrigger("{0} trigger 확인 필요".format(e.action),e.action,null)}else $this.hook.afterTrigger&&$this.hook.afterTrigger("hook.beforeTrigger continue false",e.action,null)}},tryAddFunction(transactConfig){if(transactConfig&&$this&&$this.config){1==$object.isNullOrUndefined(transactConfig.noProgress)&&(transactConfig.noProgress=!1);try{1==$object.isNullOrUndefined($this.config.transactions)&&($this.config.transactions=[]);for(var transactions=$this.config.transactions,i=0;i<transactions.length;i++)if(transactConfig.functionID==transactions[i].functionID){transactions.splice(i,1);break}var synControlList=$this.context.synControls,transactionObject={};if(transactionObject.functionID=transactConfig.functionID,transactionObject.transactionResult=1==$object.isNullOrUndefined(transactConfig.transactionResult)||!0===transactConfig.transactionResult,transactionObject.inputs=[],transactionObject.outputs=[],transactConfig.inputs)for(var inputs=transactConfig.inputs,inputsLength=inputs.length,i=0;i<inputsLength;i++){var inputConfig=inputs[i],input={requestType:inputConfig.type,dataFieldID:inputConfig.dataFieldID||(0<document.forms.length?document.forms[0].getAttribute("syn-datafield"):""),items:{}},synControlConfigs=null;if("Row"==inputConfig.type){var synControlConfigs=synControlList.filter(function(e){return e.formDataFieldID==input.dataFieldID&&-1==["grid","chart","chartjs"].indexOf(e.type)});if(synControlConfigs&&0<synControlConfigs.length)for(var k=0;k<synControlConfigs.length;k++){var synControlConfig=synControlConfigs[k],el=syn.$l.get(synControlConfig.id+"_hidden")||syn.$l.get(synControlConfig.id),options=el.getAttribute("syn-options");if(null!=options){var synOptions=null,isBelong;try{synOptions=JSON.parse(options)}catch(e){synOptions=eval("("+options+")")}null!=synOptions&&""!=synControlConfig.field&&(isBelong=!1,synOptions.belongID&&(1==$object.isString(synOptions.belongID)?isBelong=transactConfig.functionID==synOptions.belongID:1==$object.isArray(synOptions.belongID)&&(isBelong=-1<synOptions.belongID.indexOf(transactConfig.functionID))),1==isBelong)&&(input.items[synControlConfig.field]={fieldID:synControlConfig.field,dataType:synOptions.dataType||"string"})}}else{var synControlConfigs=synControlList.filter(function(e){return e.field==input.dataFieldID&&"grid"==e.type});if(synControlConfigs&&0<synControlConfigs.length)for(var k=0;k<synControlConfigs.length;k++){var synControlConfig=synControlConfigs[k],el=syn.$l.get(synControlConfig.id+"_hidden")||syn.$l.get(synControlConfig.id),synOptions=JSON.parse(el.getAttribute("syn-options"));if(null!=synOptions)for(var l=0;l<synOptions.columns.length;l++){var column=synOptions.columns[l],dataType="string";switch(column.columnType){case"checkbox":dataType="bool";break;case"numeric":dataType="int";break;case"date":dataType="date"}var isBelong=!1;"Flag"==column.data?isBelong=!0:column.belongID&&(1==$object.isString(column.belongID)?isBelong=transactConfig.functionID==column.belongID:1==$object.isArray(column.belongID)&&(isBelong=-1<column.belongID.indexOf(transactConfig.functionID))),1==isBelong&&(input.items[column.data]={fieldID:column.data,dataType:dataType})}}else if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(var k=0;k<syn.uicontrols.$data.storeList.length;k++){var store=syn.uicontrols.$data.storeList[k];if("Form"==store.storeType&&store.dataSourceID==input.dataFieldID){for(var l=0;l<store.columns.length;l++){var column=store.columns[l],isBelong=!1;1==$object.isString(column.belongID)?isBelong=transactConfig.functionID==column.belongID:1==$object.isArray(column.belongID)&&(isBelong=-1<column.belongID.indexOf(transactConfig.functionID)),1==isBelong&&(input.items[column.data]={fieldID:column.data,dataType:column.dataType||"string"})}break}}}}else if("List"==inputConfig.type){var synControlConfigs=synControlList.filter(function(e){return e.field==input.dataFieldID&&"grid"==e.type});if(synControlConfigs&&1==synControlConfigs.length){var synControlConfig=synControlConfigs[0],el=syn.$l.get(synControlConfig.id+"_hidden")||syn.$l.get(synControlConfig.id),synOptions=JSON.parse(el.getAttribute("syn-options"));if(null==synOptions)continue;for(var k=0;k<synOptions.columns.length;k++){var column=synOptions.columns[k],dataType="string";switch(column.columnType){case"checkbox":dataType="bool";break;case"numeric":dataType="int";break;case"date":dataType="date"}var isBelong=!1;"Flag"==column.data?isBelong=!0:column.belongID&&(1==$object.isString(column.belongID)?isBelong=transactConfig.functionID==column.belongID:1==$object.isArray(column.belongID)&&(isBelong=-1<column.belongID.indexOf(transactConfig.functionID))),1==isBelong&&(input.items[column.data]={fieldID:column.data,dataType:dataType})}}else{var isMapping=!1;if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(var k=0;k<syn.uicontrols.$data.storeList.length;k++){var store=syn.uicontrols.$data.storeList[k];if("Grid"==store.storeType&&store.dataSourceID==input.dataFieldID){isMapping=!0;for(var l=0;l<store.columns.length;l++){var column=store.columns[l],isBelong=!1;1==$object.isString(column.belongID)?isBelong=transactConfig.functionID==column.belongID:1==$object.isArray(column.belongID)&&(isBelong=-1<column.belongID.indexOf(transactConfig.functionID)),1==isBelong&&(input.items[column.data]={fieldID:column.data,dataType:column.dataType||"string"})}break}}0==isMapping&&syn.$l.eventLog("$w.tryAddFunction","{0} 컬럼 ID 중복 또는 존재여부 확인 필요".format(input.dataFieldID),"Warning")}}transactionObject.inputs.push(input)}if(transactConfig.outputs)for(var outputs=transactConfig.outputs,outputsLength=outputs.length,synControls=$this.context.synControls,i=0;i<outputsLength;i++){var outputConfig=outputs[i],output={responseType:outputConfig.type,dataFieldID:outputConfig.dataFieldID||"",items:{}},synControlConfigs=null;if("Form"==outputConfig.type){var synControlConfigs=synControlList.filter(function(e){return e.formDataFieldID==output.dataFieldID&&-1==["grid","chart","chartjs"].indexOf(e.type)});if(synControlConfigs&&0<synControlConfigs.length)for(var k=0;k<synControlConfigs.length;k++){var synControlConfig=synControlConfigs[k],el=syn.$l.get(synControlConfig.id+"_hidden")||syn.$l.get(synControlConfig.id),options=el.getAttribute("syn-options");if(null!=options){var synOptions=null;try{synOptions=JSON.parse(options)}catch(e){synOptions=eval("("+options+")")}if(null!=synOptions&&""!=synControlConfig.field&&(output.items[synControlConfig.field]={fieldID:synControlConfig.field,dataType:synOptions.dataType},1==outputConfig.clear)&&synControls&&1==synControls.length){var bindingControlInfos=synControls.filter(function(e){return e.field==outputConfig.dataFieldID});if(1==bindingControlInfos.length){var controlInfo=bindingControlInfos[0];if(null!=controlInfo.module){var controlID=controlInfo.id,controlField=controlInfo.field,controlModule=null,currings=controlInfo.module.split(".");if(0<currings.length)for(var l=0;l<currings.length;l++){var curring=currings[l];controlModule=(controlModule||context)[curring]}else controlModule=context[controlInfo.module];controlModule.clear&&controlModule.clear(controlID)}}else syn.$l.eventLog("$w.tryAddFunction Form","{0} dataFieldID 중복 또는 존재여부 확인 필요".format(outputConfig.dataFieldID),"Warning")}}}else if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(var k=0;k<syn.uicontrols.$data.storeList.length;k++){var store=syn.uicontrols.$data.storeList[k];if("Form"==store.storeType&&store.dataSourceID==output.dataFieldID){for(var l=0,dataStore;l<store.columns.length;l++){var column=store.columns[l];output.items[column.data]={fieldID:column.data,dataType:column.dataType||"string"}}1==outputConfig.clear&&(dataStore=$this.store[store.dataSourceID],dataStore)&&(dataStore.length=0);break}}}else if("Grid"==outputConfig.type){var synControlConfigs=synControlList.filter(function(e){return e.field==output.dataFieldID&&"grid"==e.type});if(synControlConfigs&&1==synControlConfigs.length){var synControlConfig=synControlConfigs[0],el=syn.$l.get(synControlConfig.id+"_hidden")||syn.$l.get(synControlConfig.id),synOptions=JSON.parse(el.getAttribute("syn-options"));if(null==synOptions)continue;for(var k=0;k<synOptions.columns.length;k++){var column=synOptions.columns[k],dataType="string";switch(column.type){case"checkbox":dataType="bool";break;case"numeric":dataType="int";break;case"date":dataType="date"}output.items[column.data]={fieldID:column.data,dataType:dataType}}if(1==outputConfig.clear&&synControls&&0<synControls.length){var bindingControlInfos=synControls.filter(function(e){return e.field==output.dataFieldID}),controlInfo=bindingControlInfos[0],controlModule=null,currings=controlInfo.module.split(".");if(0<currings.length)for(var l=0;l<currings.length;l++){var curring=currings[l];controlModule=(controlModule||context)[curring]}else controlModule=context[controlInfo.module];controlModule.clear&&controlModule.clear(controlInfo.id)}}else if(synControlConfigs=synControlList.filter(function(e){return e.field==output.dataFieldID&&-1<["chart","chartjs"].indexOf(e.type)}),synControlConfigs&&1==synControlConfigs.length){var synControlConfig=synControlConfigs[0],el=syn.$l.get(synControlConfig.id+"_hidden")||syn.$l.get(synControlConfig.id),synOptions=JSON.parse(el.getAttribute("syn-options"));if(null==synOptions)continue;for(var k=0;k<synOptions.series.length;k++){var column=synOptions.series[k];output.items[column.columnID]={fieldID:column.columnID,dataType:column.dataType||"string"}}if(1==outputConfig.clear&&synControls&&1==synControls.length){var bindingControlInfos=synControls.filter(function(e){return e.field==outputConfig.dataFieldID});if(1==bindingControlInfos.length){var controlInfo=bindingControlInfos[0];if(null==controlInfo.module)continue;var controlID=controlInfo.id,controlField=controlInfo.field,controlModule=null,currings=controlInfo.module.split(".");if(0<currings.length)for(var l=0;l<currings.length;l++){var curring=currings[l];controlModule=(controlModule||context)[curring]}else controlModule=context[controlInfo.module];controlModule.clear&&controlModule.clear(controlID)}}}else{var isMapping=!1;if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(var k=0;k<syn.uicontrols.$data.storeList.length;k++){var store=syn.uicontrols.$data.storeList[k];if("Grid"==store.storeType&&store.dataSourceID==output.dataFieldID){isMapping=!0;for(var l=0,dataStore;l<store.columns.length;l++){var column=store.columns[l];output.items[column.data]={fieldID:column.data,dataType:column.dataType||"string"}}1==outputConfig.clear&&(dataStore=$this.store[store.dataSourceID],dataStore)&&(dataStore.length=0);break}}0==isMapping&&syn.$l.eventLog("$w.tryAddFunction Grid","{0} dataFieldID 중복 또는 존재여부 확인 필요".format(output.dataFieldID),"Warning")}}transactionObject.outputs.push(output)}$this.config.transactions.push(transactionObject)}catch(error){syn.$l.eventLog("$w.tryAddFunction",error,"Error")}}else syn.$l.eventLog("$w.tryAddFunction","{0} 거래 ID 또는 설정 확인 필요".format(transactConfig),"Warning")},transactionAction(o,e){if(1==$object.isString(o)){var t=o;if(o=$this.transaction[o],1==$object.isNullOrUndefined(o))return void syn.$l.eventLog("$w.transactionAction",'functionID "{0}" 확인 필요'.format(t),"Warning");1==$string.isNullOrEmpty(o.functionID)&&(o.functionID=t)}if(o&&$this&&$this.config){1==$object.isNullOrUndefined(o.noProgress)&&(o.noProgress=!1),syn.$w.progressMessage&&0==o.noProgress&&syn.$w.progressMessage($resource.translations.progress);try{1==$object.isNullOrUndefined($this.config.transactions)&&($this.config.transactions=[]);var n=!0;$this.hook.beforeTransaction&&(n=$this.hook.beforeTransaction(o)),1==$object.isNullOrUndefined(n)||1==n?((e=syn.$w.argumentsExtend({message:"",dynamic:"Y",authorize:"N",commandType:"D",returnType:"Json",transactionScope:"N",transactionLog:"Y"},e))&&syn.$w.progressMessage&&syn.$w.progressMessage(e.message),syn.$w.tryAddFunction(o),syn.$w.transaction(o.functionID,function(t,n,r){var i=null,e=(t&&0<t.errorText.length&&(i=t.errorText[0],syn.$l.eventLog("$w.transaction.callback",i,"Error")),null);null==(e=o.callback&&1==$object.isFunction(o.callback)?o.callback(i,t,n,r):e)||!0===e?$this.hook.afterTransaction&&$this.hook.afterTransaction(null,o.functionID,t,n,r):!1===e&&$this.hook.afterTransaction&&$this.hook.afterTransaction("callbackResult continue false",o.functionID,null,null,r),o.callback&&1==$object.isArray(o.callback)&&setTimeout(function(){var e={error:i,result:t,addtionalData:n,correlationID:r};syn.$l.trigger(o.callback[0],o.callback[1],e)})},e)):(syn.$w.closeProgressMessage&&syn.$w.closeProgressMessage(),$this.hook.afterTransaction&&$this.hook.afterTransaction("beforeTransaction continue false",o.functionID,null,null))}catch(e){syn.$l.eventLog("$w.transactionAction",e,"Error"),syn.$w.closeProgressMessage&&syn.$w.closeProgressMessage()}}else syn.$l.eventLog("$w.transactionAction","{0} 거래 ID 또는 설정 확인 필요".format(o),"Warning")},transactionDirect(e,n,t){e.transactionResult=1==$object.isNullOrUndefined(e.transactionResult)||!0===e.transactionResult,e.systemID=e.systemID||$this.config.systemID;var r=syn.$w.transactionObject(e.functionID,"Json");if(r.programID=e.programID,r.businessID=e.businessID,r.systemID=e.systemID,r.transactionID=e.transactionID,r.dataMapInterface=e.dataMapInterface||"Row|Form",r.transactionResult=1==$object.isNullOrUndefined(e.transactionResult)||!0===e.transactionResult,(t=syn.$w.argumentsExtend({message:"",dynamic:"Y",authorize:"N",commandType:"D",returnType:"Json",transactionScope:"N",transactionLog:"Y"},t))&&syn.$w.progressMessage&&syn.$w.progressMessage(t.message),r.options=t,"node"===globalRoot.devicePlatform?r.screenID=e.screenID||e.transactionID:r.screenID=syn.$w.pageScript.replace("$",""),r.startTraceID=e.startTraceID||t.startTraceID||"",e.inputLists&&0<e.inputLists.length){for(var i in e.inputLists)r.inputs.push(e.inputLists[i]);r.inputsItemCount.push(e.inputLists.length)}else r.inputs.push(e.inputObjects),r.inputsItemCount.push(1);syn.$w.executeTransaction(e,r,function(e,t){n&&n(e,t)})},transaction(N,x,e){var O="";try{syn.$w.domainTransactionLoaderStart&&syn.$w.domainTransactionLoaderStart(),(e=syn.$w.argumentsExtend({message:"",dynamic:"Y",authorize:"N",commandType:"D",returnType:"Json",transactionScope:"N",transactionLog:"Y"},e))&&syn.$w.progressMessage&&syn.$w.progressMessage(e.message);var I={errorText:[],outputStat:[]};if($this&&$this.config&&$this.config.transactions){var t=$this.config.transactions.filter(function(e){return e.functionID==N});if(1==t.length){for(var M=t[0],n=syn.$w.transactionObject(M.functionID,"Json"),r=(n.programID=$this.config.programID,n.businessID=$this.config.businessID,n.systemID=$this.config.systemID,n.transactionID=$this.config.transactionID,n.screenID=syn.$w.pageScript.replace("$",""),n.startTraceID=e.startTraceID||"",n.options=e,$this.context.synControls),i=M.inputs.length,o=0;o<i;o++){var s=M.inputs[o],a=[];if("Row"==s.requestType){if(1==(T=r.filter(function(e){return e.field==s.dataFieldID})).length){var l=T[0];if(-1<["grid","chart"].indexOf(l.type)){var u=s.dataFieldID,c="";if(r&&0<r.length)if(1==(T=r.filter(function(e){return e.field==u})).length){var l=T[0],d=null;if(0<(R=l.module.split(".")).length)for(var h=0;h<R.length;h++){var f=R[h];d=(d||context)[f]}else d=context[l.module];for(var p=syn.$l.get(l.id+"_hidden")||syn.$l.get(l.id),g=JSON.parse(p.getAttribute("syn-options")),m=0;m<g.columns.length;m++){var y=g.columns[m];if(y.validators&&$validation.transactionValidate)if(y.controlText=g.controlText||"",0==$validation.transactionValidate(d,l,y,s.requestType))return $this.hook.afterTransaction&&$this.hook.afterTransaction("validators continue false",N,y,null),syn.$w.domainTransactionLoaderEnd&&syn.$w.domainTransactionLoaderEnd(),!1}a=d.getValue(l.id,"Row",s.items)[0]}else syn.$l.eventLog("$w.transaction",'"{0}" Row List Input Mapping 확인 필요'.format(u),"Warning")}else for(var v in s.items){var b=s.items[v],u=v,E=b.fieldID,C=b.dataType,w={prop:E,val:""},c="";if(0<r.length){if(1!=(T=r.filter(function(e){return e.field==u&&e.formDataFieldID==s.dataFieldID})).length){syn.$l.eventLog("$w.transaction",'"{0}" Row Control Input Mapping 확인 필요'.format(u),"Warning");continue}l=T[0];if(1==$object.isNullOrUndefined(l.module))c=syn.$l.get(l.id).value;else{d=null;if(0<(R=l.module.split(".")).length)for(h=0;h<R.length;h++){f=R[h];d=(d||context)[f]}else d=context[l.module];p=syn.$l.get(l.id+"_hidden")||syn.$l.get(l.id),g=JSON.parse(p.getAttribute("syn-options"));if(g.validators&&$validation.transactionValidate)if(0==$validation.transactionValidate(d,l,g,s.requestType))return $this.hook.afterTransaction&&$this.hook.afterTransaction("validators continue false",N,g,null),syn.$w.domainTransactionLoaderEnd&&syn.$w.domainTransactionLoaderEnd(),!1;c=d.getValue(l.id,b),1==$object.isNullOrUndefined(c)&&"int"==C&&(c=0)}}w.val=c,a.push(w)}}else if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(var v in s.items){for(var S=!1,b=s.items[v],u=v,E=b.fieldID,C=b.dataType,w={prop:E,val:""},c="",m=0;m<syn.uicontrols.$data.storeList.length;m++)if("Form"==(A=syn.uicontrols.$data.storeList[m]).storeType&&A.dataSourceID==s.dataFieldID){S=!0,1==(T=A.columns.filter(function(e){return e.data==u})).length?(l=T[0],(c=$this.store[A.dataSourceID][l.data])||"int"!=C||(c=0),1==$object.isNullOrUndefined(c)&&(c="")):syn.$l.eventLog("$w.transaction",'"{0}" Row Input Mapping 확인 필요'.format(u),"Warning");break}1==S?(w.val=c,a.push(w)):syn.$l.eventLog("$w.transaction","{0} Row 컨트롤 ID 중복 또는 존재여부 확인 필요".format(s.dataFieldID),"Warning")}n.inputs.push(a),n.inputsItemCount.push(1)}else if("List"==s.requestType){var T,u=s.dataFieldID,c="";if(r&&0<r.length)if(1==(T=r.filter(function(e){return e.field==u})).length){var R,l=T[0],d=null;if(0<(R=l.module.split(".")).length)for(h=0;h<R.length;h++){f=R[h];d=(d||context)[f]}else d=context[l.module];for(p=syn.$l.get(l.id+"_hidden")||syn.$l.get(l.id),g=JSON.parse(p.getAttribute("syn-options")),m=0;m<g.columns.length;m++){y=g.columns[m];if(y.controlText=g.controlText||"",y.validators&&$validation.transactionValidate)if(0==$validation.transactionValidate(d,l,y,s.requestType))return $this.hook.afterTransaction&&$this.hook.afterTransaction("validators continue false",N,y,null),syn.$w.domainTransactionLoaderEnd&&syn.$w.domainTransactionLoaderEnd(),!1}a=d.getValue(l.id,"List",s.items)}else{S=!1;if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(var A,m=0;m<syn.uicontrols.$data.storeList.length;m++)if("Grid"==(A=syn.uicontrols.$data.storeList[m]).storeType&&A.dataSourceID==u){S=!0;var _=syn.uicontrols.$data.bindingList.find(function(e){return e.dataSourceID==A.dataSourceID&&"grid"==e.controlType});if(_)a=$this.store[A.dataSourceID][_.dataFieldID];else{for(var c=[],k=$this.store[A.dataSourceID],P=k.length,h=0;h<P;h++){var D=k[h],L=[];for(v in D){w={prop:v,val:D[v]};L.push(w)}c.push(L)}a=c}break}0==S&&syn.$l.eventLog("$w.transaction",'"{0}" List Input Mapping 확인 필요'.format(u),"Warning")}for(v in a)n.inputs.push(a[v]);n.inputsItemCount.push(a.length)}}syn.$w.executeTransaction($this.config,n,function(e,t,n){for(var r=!1,i=0;i<M.outputs.length;i++)if("Dynamic"==M.outputs[i].responseType){r=!0;break}if(1==r)I.outputStat.push({fieldID:"Dynamic",count:1,dynamicData:e});else if(e.length==M.outputs.length)for(var o=$this.context.synControls,s=M.outputs.length,a=0;a<s;a++){var l=M.outputs[a],u=e[a],c=u.id,d=u.value;if($this.outputDataBinding&&$this.outputDataBinding(N,c,d),"Form"==l.responseType)if(1==$object.isNullOrUndefined(d)||1==$object.isObjectEmpty(d))I.outputStat.push({fieldID:c,Count:0});else for(var h in I.outputStat.push({fieldID:c,Count:1}),l.items){var f=l.items[h],p=h,g=d[f.fieldID];if(null!=g&&o&&0<o.length)if(1==(R=o.filter(function(e){return e.field==p&&e.formDataFieldID==l.dataFieldID})).length){var m=null;if(0<(_=(A=R[0]).module.split(".")).length)for(i=0;i<_.length;i++){var y=_[i];m=(m||context)[y]}else m=context[A.module];m.setValue(A.id,g,f)}else{var v=!1;if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(var b=0;b<syn.uicontrols.$data.storeList.length;b++){var E=syn.uicontrols.$data.storeList[b];if(1==$object.isNullOrUndefined($this.store[E.dataSourceID])&&($this.store[E.dataSourceID]={}),"Form"==E.storeType&&E.dataSourceID==l.dataFieldID){v=!0,1==(R=E.columns.filter(function(e){return e.data==p})).length&&($this.store[E.dataSourceID][p]=g);break}}0==v&&(O='"{0}" Form Output Mapping 확인 필요'.format(p),I.errorText.push(O),syn.$l.eventLog("$w.transaction",O,"Error"))}}else if("Grid"==l.responseType)if(d.length&&0<d.length){I.outputStat.push({fieldID:c,Count:d.length});p=l.dataFieldID;if(o&&0<o.length)if(1==(R=o.filter(function(e){return e.field==p})).length){m=null;if(0<(_=(A=R[0]).module.split(".")).length)for(i=0;i<_.length;i++){y=_[i];m=(m||context)[y]}else m=context[A.module];m.setValue(A.id,d,l.items)}else{v=!1;if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(b=0;b<syn.uicontrols.$data.storeList.length;b++){E=syn.uicontrols.$data.storeList[b];if(1==$object.isNullOrUndefined($this.store[E.dataSourceID])&&($this.store[E.dataSourceID]=[]),"Grid"==E.storeType&&E.dataSourceID==l.dataFieldID){v=!0;for(var C=syn.uicontrols.$data.bindingList.filter(function(e){return e.dataSourceID==E.dataSourceID&&"grid"==e.controlType}),w=d.length,i=0;i<w;i++)d[i].Flag="R";if(0<C.length)for(var S=0;S<C.length;S++){var T=C[S];$this.store[E.dataSourceID][T.dataFieldID]=d}else $this.store[E.dataSourceID]=d;break}}0==v&&(O='"{0}" Grid Output Mapping 확인 필요'.format(p),I.errorText.push(O),syn.$l.eventLog("$w.transaction",O,"Error"))}}else I.outputStat.push({fieldID:c,Count:0});else if("Chart"==l.responseType)if(d.length&&0<d.length){I.outputStat.push({fieldID:c,Count:d.length});var R,p=l.dataFieldID;if(o&&0<o.length)if(1==(R=o.filter(function(e){return e.field==p})).length){var A,_,m=null;if(0<(_=(A=R[0]).module.split(".")).length)for(i=0;i<_.length;i++){y=_[i];m=(m||context)[y]}else m=context[A.module];m.setValue(A.id,d,l.items)}else O='"{0}" Chart Output Mapping 확인 필요'.format(p),I.errorText.push(O),syn.$l.eventLog("$w.transaction",O,"Error")}else I.outputStat.push({fieldID:c,Count:0})}else O='"{0}" 기능의 거래 응답 정의와 데이터 갯수가 다릅니다'.format(M.functionID),I.errorText.push(O),syn.$l.eventLog("$w.transaction",O,"Error");x&&x(I,t,n),syn.$w.domainTransactionLoaderEnd&&syn.$w.domainTransactionLoaderEnd()})}else O='"{0}" 거래 중복 또는 존재여부 확인 필요'.format(N),I.errorText.push(O),syn.$l.eventLog("$w.transaction",O,"Error"),x&&x(I),syn.$w.domainTransactionLoaderEnd&&syn.$w.domainTransactionLoaderEnd()}else O="화면 매핑 정의 데이터가 없습니다",I.errorText.push(O),syn.$l.eventLog("$w.transaction",O,"Error"),x&&x(I),syn.$w.domainTransactionLoaderEnd&&syn.$w.domainTransactionLoaderEnd()}catch(e){syn.$l.eventLog("$w.transaction",e,"Error"),syn.$w.domainTransactionLoaderEnd&&syn.$w.domainTransactionLoaderEnd()}},getterValue(t){try{var e=$this.transaction[t];if(1!=$object.isNullOrUndefined(e)){1==$string.isNullOrEmpty(e.functionID)&&(e.functionID=t),syn.$w.tryAddFunction(e);var n="",r={errors:[],inputs:[]};if($this&&$this.config&&$this.config.transactions){var i=$this.config.transactions.filter(function(e){return e.functionID==t});if(1==i.length)for(var o=i[0],s=context[syn.$w.pageScript].context.synControls,a=o.inputs.length,l=0;l<a;l++){var u=o.inputs[l],c=[];if("Row"==u.requestType){if(1==(R=s.filter(function(e){return e.field==u.dataFieldID})).length){var d=R[0];if(-1<["grid","chart"].indexOf(d.type)){var h=u.dataFieldID,f="";if(s&&0<s.length)if(1==(R=s.filter(function(e){return e.field==h})).length){var d=R[0],p=null;if(0<(A=d.module.split(".")).length)for(var g=0;g<A.length;g++){var m=A[g];p=(p||context)[m]}else p=context[d.module];c=p.getValue(d.id,"Row",u.items)[0]}else syn.$l.eventLog("$w.getterValue",'"{0}" Row List Input Mapping 확인 필요'.format(h),"Warning")}else for(var y in u.items){var v=u.items[y],h=y,b=v.fieldID,E=v.dataType,C={prop:b,val:""},f="";if(0<s.length){if(1!=(R=s.filter(function(e){return e.field==h&&e.formDataFieldID==u.dataFieldID})).length){syn.$l.eventLog("$w.getterValue",'"{0}" Row Control Input Mapping 확인 필요'.format(h),"Warning");continue}d=R[0],p=null;if(0<(A=d.module.split(".")).length)for(g=0;g<A.length;g++){m=A[g];p=(p||context)[m]}else p=context[d.module];(f=p.getValue(d.id,v))||"int"!=E||(f=0)}C.val=f,c.push(C)}}else if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(var y in u.items){for(var w=!1,v=u.items[y],h=y,b=v.fieldID,E=v.dataType,C={prop:b,val:""},f="",S=0;S<syn.uicontrols.$data.storeList.length;S++)if("Form"==(_=syn.uicontrols.$data.storeList[S]).storeType&&_.dataSourceID==u.dataFieldID){w=!0,1==(R=_.columns.filter(function(e){return e.data==h})).length?(d=R[0],(f=$this.store[_.dataSourceID][d.data])||"int"!=E||(f=0),1==$object.isNullOrUndefined(f)&&(f="")):syn.$l.eventLog("$w.getterValue",'"{0}" Row Input Mapping 확인 필요'.format(h),"Warning");break}1==w?(C.val=f,c.push(C)):syn.$l.eventLog("$w.getterValue","{0} Row 컨트롤 ID 중복 또는 존재여부 확인 필요".format(u.dataFieldID),"Warning")}for(var T={},g=0;g<c.length;g++)T[(k=c[g]).prop]=k.val;r.inputs.push(T)}else if("List"==u.requestType){var R,h=u.dataFieldID,f="";if(s&&0<s.length)if(1==(R=s.filter(function(e){return e.field==h})).length){var A,d=R[0],p=null;if(0<(A=d.module.split(".")).length)for(g=0;g<A.length;g++){m=A[g];p=(p||context)[m]}else p=context[d.module];c=p.getValue(d.id,"List",u.items)}else{w=!1;if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(var _,S=0;S<syn.uicontrols.$data.storeList.length;S++)if("Grid"==(_=syn.uicontrols.$data.storeList[S]).storeType&&_.dataSourceID==h){w=!0;var N=syn.uicontrols.$data.bindingList.find(function(e){return e.dataSourceID==_.dataSourceID&&"grid"==e.controlType});if(N)c=$this.store[_.dataSourceID][N.dataFieldID];else{for(var f=[],x=$this.store[_.dataSourceID],O=x.length,g=0;g<O;g++){var I=x[g],M=[];for(y in I){C={prop:y,val:I[y]};M.push(C)}f.push(M)}c=f}break}0==w&&syn.$l.eventLog("$w.getterValue",'"{0}" List Input Mapping 확인 필요'.format(h),"Warning")}for(y in c){for(var k,T={},D=c[y],g=0;g<D.length;g++)T[(k=D[g]).prop]=k.val;r.inputs.push(T)}}}else n='"{0}" 거래 중복 또는 존재여부 확인 필요'.format(t),r.errors.push(n),syn.$l.eventLog("$w.getterValue",n,"Error")}else n="화면 매핑 정의 데이터가 없습니다",r.errors.push(n),syn.$l.eventLog("$w.getterValue",n,"Error");return r}syn.$l.eventLog("$w.setterValue",'functionID "{0}" 확인 필요'.format(t),"Warning")}catch(e){return syn.$l.eventLog("$w.getterValue",e,"Error"),r.errors.push(e.message),r}},setterValue(t,e){try{var n=$this.transaction[t];if(1!=$object.isNullOrUndefined(n)){1==$string.isNullOrEmpty(n.functionID)&&(n.functionID=t),syn.$w.tryAddFunction(n);var r="",i={errors:[],outputs:[]};if($this&&$this.config&&$this.config.transactions){var o=$this.config.transactions.filter(function(e){return e.functionID==t});if(1==o.length)for(var s=o[0],a=context[syn.$w.pageScript].context.synControls,l=s.outputs.length,u=0;u<l;u++){var c=s.outputs[u],d=c.responseType+"Data"+u.toString(),h=e[u];if("Form"==c.responseType)if(1==$object.isNullOrUndefined(h)||1==$object.isObjectEmpty(h))i.outputs.push({fieldID:d,Count:0});else for(var f in i.outputs.push({fieldID:d,Count:1}),c.items){var p=c.items[f],g=f,m=h[p.fieldID];if(null!=m&&a&&0<a.length)if(1==(N=a.filter(function(e){return e.field==g&&e.formDataFieldID==c.dataFieldID})).length){var y=N[0],v=null;if(0<(x=y.module.split(".")).length)for(var b=0;b<x.length;b++){var E=x[b];v=(v||context)[E]}else v=context[y.module];v.setValue(y.id,m,p)}else{var C=!1;if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(var w=0;w<syn.uicontrols.$data.storeList.length;w++){var S=syn.uicontrols.$data.storeList[w];if(1==$object.isNullOrUndefined($this.store[S.dataSourceID])&&($this.store[S.dataSourceID]={}),"Form"==S.storeType&&S.dataSourceID==c.dataFieldID){C=!0,1==(N=S.columns.filter(function(e){return e.data==g})).length&&($this.store[S.dataSourceID][g]=m);break}}0==C&&(r='"{0}" Form Output Mapping 확인 필요'.format(g),i.errors.push(r),syn.$l.eventLog("$w.transaction",r,"Error"))}}else if("Grid"==c.responseType)if(h.length&&0<h.length){i.outputs.push({fieldID:d,Count:h.length});g=c.dataFieldID;if(a&&0<a.length)if(1==(N=a.filter(function(e){return e.field==g})).length){y=N[0],v=null;if(0<(x=y.module.split(".")).length)for(b=0;b<x.length;b++){E=x[b];v=(v||context)[E]}else v=context[y.module];v.setValue(y.id,h,c.items)}else{C=!1;if(syn.uicontrols.$data&&0<syn.uicontrols.$data.storeList.length)for(w=0;w<syn.uicontrols.$data.storeList.length;w++){S=syn.uicontrols.$data.storeList[w];if(1==$object.isNullOrUndefined($this.store[S.dataSourceID])&&($this.store[S.dataSourceID]=[]),"Grid"==S.storeType&&S.dataSourceID==c.dataFieldID){C=!0;for(var T=syn.uicontrols.$data.bindingList.filter(function(e){return e.dataSourceID==S.dataSourceID&&"grid"==e.controlType}),R=h.length,b=0;b<R;b++)h[b].Flag="R";if(0<T.length)for(var A=0;A<T.length;A++){var _=T[A];$this.store[S.dataSourceID][_.dataFieldID]=h}else $this.store[S.dataSourceID]=h;break}}0==C&&(r='"{0}" Grid Output Mapping 확인 필요'.format(g),i.errors.push(r),syn.$l.eventLog("$w.transaction",r,"Error"))}}else i.outputs.push({fieldID:d,Count:0});else if("Chart"==c.responseType)if(h.length&&0<h.length){i.outputs.push({fieldID:d,Count:h.length});var N,g=c.dataFieldID;if(a&&0<a.length)if(1==(N=a.filter(function(e){return e.field==g})).length){var x,y=N[0],v=null;if(0<(x=y.module.split(".")).length)for(b=0;b<x.length;b++){E=x[b];v=(v||context)[E]}else v=context[y.module];v.setValue(y.id,h,c.items)}else r='"{0}" Chart Output Mapping 확인 필요'.format(g),i.errors.push(r),syn.$l.eventLog("$w.transaction",r,"Error")}else i.outputs.push({fieldID:d,Count:0})}else r='"{0}" 거래 중복 또는 존재여부 확인 필요'.format(t),i.errors.push(r),syn.$l.eventLog("$w.transaction",r,"Error")}else r="화면 매핑 정의 데이터가 없습니다",i.errors.push(r),syn.$l.eventLog("$w.transaction",r,"Error");return i}syn.$l.eventLog("$w.setterValue",'functionID "{0}" 확인 필요'.format(t),"Warning")}catch(e){return syn.$l.eventLog("$w.transaction",e,"Error"),i.errors.push(e.message),i}},scrollToTop(){var e=document.documentElement.scrollTop||document.body.scrollTop;0<e&&(context.requestAnimationFrame(syn.$w.scrollToTop),context.scrollTo(0,e-e/8))},setFavicon(e){var t=document.querySelector('link[rel="icon"]');t?t.href=e:((t=document.createElement("link")).rel="icon",t.href=e,document.head.appendChild(t))},fileDownload(e,t){var n="",t=(t?n=t:(t=e.toString().match(/.*\/(.+?)\./))&&1<t.length&&(n=t[1]),document.createElement("a"));t.setAttribute("href",e),t.setAttribute("download",n),document.body.appendChild(t),t.click(),document.body.removeChild(t)},sleep(t,e){if(e)setTimeout(e,t);else{if(globalRoot.Promise)return new Promise(function(e){return setTimeout(e,t)});syn.$l.eventLog("$w.sleep","지원하지 않는 기능. 매개변수 확인 필요","Debug")}},purge(e){var t,n,r,i=e.attributes;if(i)for(t=i.length-1;0<=t;--t)"function"==typeof e[r=i[t].name]&&(e[r]=null);if(i=e.childNodes)for(n=i.length,t=0;t<n;t+=1)syn.$w.purge(e.childNodes[t])},setServiceObject(e){"string"!=typeof e&&JSON.stringify(e);return $webform},setServiceClientHeader(e){return e.setRequestHeader("CertificationKey","SGFuZFN0YWNr"),!0},xmlParser(e){return(new globalRoot.DOMParser).parseFromString(e,"text/xml")},apiHttp(a){return new Proxy({},{get(e,s){return async function(e,t){if(-1==["send"].indexOf(s))return Promise.resolve({error:s+" 메서드 확인 필요"});if(t=syn.$w.argumentsExtend({method:"GET"},t),0==$object.isNullOrUndefined(e)&&0==$object.isString(e)){if(t.method="POST",1==$object.isNullOrUndefined(t.headers)&&(t.headers=new Headers,t.headers.append("Content-Type","application/json")),syn.Environment)if((o=syn.Environment).Header)for(var n in o.Header)0==t.headers.has(n)&&t.headers.append(n,o.Header[n]);var r={method:t.method,headers:t.headers,body:e instanceof FormData?e:JSON.stringify(e),redirect:"follow"},i=(0==$object.isNullOrUndefined(t.timeout)&&(r.timeout=t.timeout),await fetch(a,r))}else{var o;if(1==$object.isNullOrUndefined(t.headers)&&(t.headers=new Headers,t.headers.append("Content-Type","text/plain")),syn.Environment)if((o=syn.Environment).Header)for(var n in o.Header)0==t.headers.has(n)&&t.headers.append(n,o.Header[n]);r={method:t.method,headers:t.headers,redirect:"follow"},i=(0==$object.isNullOrUndefined(t.timeout)&&(r.timeout=t.timeout),await fetch(a,r))}return 1==i.ok?(e=null,e=-1<i.headers.get("Content-Type").indexOf("application/json")?i.json():i.text(),Promise.resolve(e)):(syn.$l.eventLog("$w.apiHttp",`status: ${i.status}, text: `+await i.text(),"Error"),Promise.resolve({error:"요청 정보 확인 필요"}))}}})},xmlHttp(){return new globalRoot.XMLHttpRequest},loadScript(e,t){document.getElementsByTagName("head")||document.documentElement.insertBefore(document.createElement("head"),document.documentElement.firstChild);var n=document.getElementsByTagName("head")[0],t=t||"id_"+syn.$l.random(),r=document.createElement("script");return r.setAttribute("type","text/javascript"),r.setAttribute("id",t),syn.Config&&1==$string.toBoolean(syn.Config.IsClientCaching)?r.setAttribute("src",e):r.setAttribute("src",e+(-1<e.indexOf("?")?"&":"?")+"noCache="+(new Date).getTime()),n.insertBefore(r,n.firstChild),$webform},loadStyle(e,t){document.getElementsByTagName("head")||document.documentElement.insertBefore(document.createElement("head"),document.documentElement.firstChild);var n=document.getElementsByTagName("head")[0],t=t||"id_"+syn.$l.random(),r=document.createElement("link");return r.setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r.setAttribute("id",t),syn.Config&&1==$string.toBoolean(syn.Config.IsClientCaching)?r.setAttribute("href",e):r.setAttribute("href",e+(-1<e.indexOf("?")?"&":"?")+"noCache="+(new Date).getTime()),n.appendChild(r),$webform},async fetchScript(moduleUrl){var result=null,moduleName,moduleScript,moduleName=1<moduleUrl.split("/").length?(moduleName=moduleUrl.split("/")[location.pathname.split("/").length-1],2==moduleName.split(".").length?-1<moduleName.indexOf(".")?moduleName.substring(0,moduleName.indexOf(".")):moduleName:""):moduleUrl,module,$module,module,moduleFunction,moduleScript;if(0==$string.isNullOrEmpty(moduleName))try{if(module="object"==eval("typeof $"+moduleName)?($module=new syn.module,$module.extend(eval("$"+moduleName))):(moduleScript=syn.Config&&1==syn.Config.IsClientCaching?await syn.$w.fetchText(moduleUrl+".js"):await syn.$w.fetchText(moduleUrl+".js?tick="+(new Date).getTime()),moduleScript?(moduleFunction="return (function() {var module = {};(function (window, module) {'use strict';"+moduleScript+";var $module = new syn.module();$module.extend($"+moduleName+");module.exports = $module;})(typeof window !== 'undefined' ? window : {},typeof module !== 'undefined' ? module : {});return module.exports;})();",new Function(moduleFunction).call(globalRoot)):new syn.module),module.extends&&1==$object.isArray(module.extends))for(var i=0;i<module.extends.length;i++){var name=module.extends[i],result=await syn.$w.fetchText(name+".js"),moduleText=result.substring(result.indexOf("{"),result.lastIndexOf("}")+1),base=eval("("+moduleText+")"),$base=new syn.module;$base.extend(base),module=syn.$w.argumentsExtend($base,module),module.config=syn.$w.argumentsExtend($base.config,module.config),module.prop=syn.$w.argumentsExtend($base.prop,module.prop),module.hook=syn.$w.argumentsExtend($base.hook,module.hook),module.event=syn.$w.argumentsExtend($base.event,module.event),module.model=syn.$w.argumentsExtend($base.model,module.model),module.transaction=syn.$w.argumentsExtend($base.transaction,module.transaction),module.method=syn.$w.argumentsExtend($base.method,module.method),module.message=syn.$w.argumentsExtend($base.message,module.message),$base.hook&&$base.hook.extendLoad&&base.hook.extendLoad(module)}result=module}catch(error){syn.$l.eventLog("$w.fetchScript",error,"Warning"),moduleScript&&syn.$l.eventLog("$w.fetchScript",'<script src="{0}.js"><\/script> 문법 확인 필요'.format(moduleUrl),"Information")}return result},fetchText(e){var r={},r=syn.$w.getFetchClientOptions?syn.$w.getFetchClientOptions(r):{method:"GET",mode:"cors",cache:"default",credentials:"same-origin",headers:{"Content-Type":"text/plain"},redirect:"follow",referrerPolicy:"no-referrer-when-downgrade"};return syn.Config&&1==$string.toBoolean(syn.Config.IsClientCaching)&&(e=e+(-1<e.indexOf("?")?"&":"?")+"tick="+(new Date).getTime()),new Promise(function(t,n){fetch(e,r).then(async function(e){return"2"==e.status?.toString().substring(0,1)?t(e.text()):(syn.$l.eventLog("$w.fetchText",`status: ${e.status}, text: `+await e.text(),"Warning"),t(null))}).catch(function(e){return syn.$l.eventLog("$w.fetchText",e,"Error"),n(e)})})},fetchJson(e){var r={};return(r=syn.$w.getFetchClientOptions?syn.$w.getFetchClientOptions(r):{method:"GET",mode:"cors",cache:"default",credentials:"same-origin",headers:{"Content-Type":"text/plain"},redirect:"follow",referrerPolicy:"no-referrer-when-downgrade"}).headers["Content-Type"]="application/json",syn.Config&&1==$string.toBoolean(syn.Config.IsClientCaching)&&(e=e+(-1<e.indexOf("?")?"&":"?")+"tick="+(new Date).getTime()),new Promise(function(t,n){fetch(e,r).then(function(e){return"2"==e.status?.toString().substring(0,1)?t(e.json()):(syn.$l.eventLog("$w.fetchJson",`status: ${e.status}, text: `+e.text(),"Warning"),t(null))}).catch(function(e){return syn.$l.eventLog("$w.fetchJson",e,"Error"),n(null)})})},transactionObject(e,t){var n="Json",t=(t&&(n=t),{});return t.programID="",t.businessID="",t.systemID="",t.transactionID="",t.dataMapInterface=null,t.transactionResult=!0,t.functionID=e,t.screenID="",t.startTraceID="",t.requestID=null,t.returnType=n,t.resultAlias=[],t.inputsItemCount=[],t.inputs=[],syn.$w.setServiceObject&&syn.$w.setServiceObject(t),t},dynamicType:new function(){this.DataSet="0",this.Json="1",this.Scalar="2",this.NonQuery="3",this.SQLText="4",this.SchemeOnly="5",this.CodeHelp="6",this.Xml="7",this.DynamicJson="8"},async executeTransaction(p,g,m,e,t){if(1==$object.isNullOrUndefined(p)||1==$object.isNullOrUndefined(g))"browser"===globalRoot.devicePlatform&&alert("서비스 호출에 필요한 거래 정보가 구성되지 않았습니다"),syn.$l.eventLog("$w.executeTransaction","서비스 호출에 필요한 거래 정보 확인 필요","Error");else{var n=null,r=("node"===globalRoot.devicePlatform&&((r=syn.$w.getStorage("apiServices",!1))?(n=r[syn.Config.SystemID+syn.Config.Environment.substring(0,1)],1==$object.isNullOrUndefined(r.BearerToken)&&globalRoot.bearerToken&&(r.BearerToken=globalRoot.bearerToken,syn.$w.setStorage("apiServices",r,!1))):null!=syn.Config.DomainAPIServer?(n=syn.Config.DomainAPIServer,r={},(t||globalRoot.bearerToken)&&(r.BearerToken=t||globalRoot.bearerToken),r[syn.Config.SystemID+syn.Config.Environment.substring(0,1)]=n,syn.$w.setStorage("apiServices",r,!1),syn.$l.eventLog("$w.executeTransaction","apiService 확인 필요 systemApi: {0}".format(JSON.stringify(n)),"Warning")):syn.$l.eventLog("$w.executeTransaction","서비스 호출에 필요한 BP 정보가 구성되지 확인 필요","Error")),syn.$w.getStorage("apiServices",!1));if(null==(n=r?r[syn.Config.SystemID+syn.Config.Environment.substring(0,1)]:n))syn.$l.eventLog("$w.executeTransaction","apiService 확인 필요","Fatal");else if(n.exceptionText)syn.$l.eventLog("$w.executeTransaction","apiService 확인 필요 SystemID: {0}, ServerType: {1}, Message: {2}".format(p.systemID,syn.Config.Environment.substring(0,1),n.exceptionText),"Fatal");else{var t=syn.$w.getStorage("ipAddress",!1),i=(1==$object.isNullOrUndefined(t)&&0==$string.isNullOrEmpty(syn.Config.FindClientIPServer)&&(t=await syn.$w.apiHttp(syn.Config.FindClientIPServer).send(null,{method:"GET",redirect:"follow",timeout:1e3})),1==$object.isNullOrUndefined(t)&&(t="localhost"),syn.$w.setStorage("ipAddress",t,!1),""),i=n.Port&&""!=n.Port?"{0}://{1}:{2}{3}".format(n.Protocol,n.IP,n.Port,n.Path):"{0}://{1}{2}".format(n.Protocol,n.IP,n.Path),o=(i="/transact/api/transaction/execute",syn.$w.Variable&&syn.$w.Variable.InstallType?syn.$w.Variable.InstallType:"L"),s=syn.Config&&syn.Config.Environment?syn.Config.Environment.substring(0,1):"D",a=syn.Config&&syn.Config.Transaction?syn.Config.Transaction.MachineTypeID.substring(0,1):"W",l=(syn.$w.Variable&&syn.$w.Variable.ProgramID?syn.$w.Variable.ProgramID:p.programID).padStart(8,"0"),u=p.businessID.padStart(3,"0").substring(0,3),c=g.transactionID.padStart(6,"0").substring(0,6),d=g.functionID.padStart(4,"0").substring(0,4),h=(syn.$w.User&&syn.$w.User.TokenID?syn.$w.User.TokenID:syn.$l.random(6)).padStart(6,"0").substring(0,6),o=(""+o+s+l+u+c+d+a+h+$date.toString(new Date,"s").substring(0,6)).toUpperCase(),a="",y=(0==$string.isNullOrEmpty(syn.Config.FindGlobalIDServer)&&(n.GlobalID=await syn.$w.apiHttp(syn.Config.FindGlobalIDServer).send({applicationID:l,projectID:u,transactionID:c,serviceID:d,screenID:g.screenID,tokenID:h},{method:"POST",redirect:"follow",timeout:1e3})),a=0==$string.isNullOrEmpty(n.GlobalID)?n.GlobalID:o,{accessToken:r.BearerToken,action:"SYN",kind:"BIZ",clientTag:syn.Config.SystemID.concat("|",syn.Config.HostName,"|",syn.Config.Program.ProgramName,"|",syn.Config.Environment.substring(0,1)),loadOptions:{encryptionType:syn.Config.Transaction.EncryptionType,encryptionKey:syn.Config.Transaction.EncryptionKey,platform:syn.$b.platform},requestID:o,version:syn.Config.Transaction.ProtocolVersion,environment:syn.Config.Environment.substring(0,1),system:{programID:p.programID,version:syn.Config.SystemVersion,routes:[{systemID:p.systemID,requestTick:(new Date).getTime()}],localeID:syn.Config.Program.LocaleID,hostName:"browser"==globalRoot.devicePlatform?location.host:syn.Config.HostName,pathName:"browser"==globalRoot.devicePlatform?location.pathname:""},interface:{devicePlatform:globalRoot.devicePlatform,interfaceID:syn.Config.Transaction.MachineTypeID,sourceIP:t,sourcePort:0,sourceMAC:"",connectionType:"node"==globalRoot.devicePlatform?"unknown":navigator.connection.effectiveType,timeout:syn.Config.TransactionTimeout},transaction:{globalID:a,businessID:p.businessID,transactionID:g.transactionID,functionID:g.functionID,commandType:g.options&&g.options.commandType||"D",simulationType:syn.Config.Transaction.SimulationType,terminalGroupID:"browser"==globalRoot.devicePlatform?syn.$w.User?"{0}|{1}".format(syn.$w.User.CompanyID,syn.$w.User.DepartmentID):"":syn.Config.Program.BranchCode,operatorID:"browser"==globalRoot.devicePlatform?syn.$w.User?syn.$w.User.UserID:"":syn.Config.Program.ProgramName,screenID:g.screenID,startTraceID:g.startTraceID,dataFormat:syn.Config.Transaction.DataFormat,compressionYN:syn.Config.Transaction.CompressionYN},payLoad:{property:{},mapID:"",dataMapInterface:"",dataMapCount:[],dataMapSet:[]}});if(syn.$w.transactionLoadOptions&&syn.$w.transactionLoadOptions(y.loadOptions),0==$object.isNullOrUndefined(g.options)){for(var f in g.options){var v=g.options[f];if("encryptionType"==f||"encryptionKey"==f||"platform"==f)throw new Error("{0} 옵션 사용 불가".format(f));y.loadOptions[f]=v}l=y.loadOptions.dynamic,u=(0==$string.isNullOrEmpty(l)&&0==$string.toBoolean(l)&&(delete y.loadOptions.dynamic,delete y.loadOptions.authorize,delete y.loadOptions.commandType,delete y.loadOptions.returnType,delete y.loadOptions.transactionScope,delete y.loadOptions.transactionLog),y.loadOptions.action),c=(0==$string.isNullOrEmpty(u)&&(y.action=u,delete y.loadOptions.action),y.loadOptions.kind);0==$string.isNullOrEmpty(c)&&(y.kind=c,delete y.loadOptions.kind),delete y.loadOptions.message}d=context[syn.$w.pageScript];if(d&&d.hook.payLoadProperty&&(h={},h=d.hook.payLoadProperty(g.transactionID,g.functionID),1==$object.isNullOrUndefined(h)&&(h={}),y.payLoad.property=h),p.transactions?1==(n=p.transactions.filter(function(e){return e.functionID==g.functionID})).length&&(C=(r=n[0]).inputs.map(function(e){return e.requestType}).join(","),o=r.outputs.map(function(e){return e.responseType}).join(","),y.payLoad.dataMapInterface="{0}|{1}".format(C,o)):g.dataMapInterface&&(y.payLoad.dataMapInterface=g.dataMapInterface),"J"!=y.transaction.dataFormat&&"T"!=y.transaction.dataFormat)throw new Error("transaction.dataFormat 확인 필요: {0}".format(y.transaction.dataFormat));y.payLoad.dataMapCount=g.inputsItemCount,y.payLoad.dataMapSet=[],y.payLoad.dataMapSetRaw=[];for(var b=g.inputs.length,E=0;E<b;E++){for(var C=g.inputs[E],w=[],S=0;S<C.length;S++){v=C[S];w.push({id:v.prop,value:v.val})}"Y"==syn.Config.Transaction.CompressionYN?"J"==y.transaction.dataFormat?y.payLoad.dataMapSetRaw.push(syn.$c.LZString.compressToBase64(JSON.stringify(w))):y.payLoad.dataMapSetRaw.push(syn.$c.LZString.compressToBase64($object.toCSV(w,{delimeter:"｜",newline:"↵"}))):"J"==y.transaction.dataFormat?y.payLoad.dataMapSet.push(w):y.payLoad.dataMapSetRaw.push($object.toCSV(w,{delimeter:"｜",newline:"↵"}))}if("PSH"==y.action){t=new Blob([JSON.stringify(y)],{type:"application/json; charset=UTF-8"});navigator.sendBeacon(i,t),syn.$w.domainTransactionLoaderEnd&&syn.$w.domainTransactionLoaderEnd(),syn.$w.closeProgressMessage&&syn.$w.closeProgressMessage()}else{var T=syn.$w.xmlHttp();if(T.open(syn.$w.method,i,!0),T.setRequestHeader("Accept-Language",syn.$w.localeID),T.setRequestHeader("Server-SystemID",p.systemID),T.setRequestHeader("Server-BusinessID",p.businessID),syn.Environment)if((s=syn.Environment).Header)for(var v in s.Header)T.setRequestHeader(v,s.Header[v]);if(!syn.$w.setServiceClientHeader||0!=syn.$w.setServiceClientHeader(T)){if(void 0!==e&&1==T.async&&(T.async=e,0==T.async))return T.setRequestHeader("X-Requested-With","HandStack ServiceClient"),T.setRequestHeader("Content-Type","application/json"),T.send(y),T;T.onreadystatechange=function(){if(4===T.readyState)if(200!==T.status)0==T.status?syn.$l.eventLog("$w.executeTransaction","X-Requested transfort error","Fatal"):syn.$l.eventLog("$w.executeTransaction","response status - {0}".format(T.statusText)+T.responseText,"Error"),syn.$w.domainTransactionLoaderEnd&&syn.$w.domainTransactionLoaderEnd();else if(!syn.$w.clientTag||!syn.$w.serviceClientInterceptor||!1!==syn.$w.serviceClientInterceptor(syn.$w.clientTag,T)){try{var e=JSON.parse(T.responseText);if(1==g.transactionResult)if(1==e.acknowledge){var t=[],n=e.message;if(null!=e.result.dataSet&&0<e.result.dataSet.length){e.result.mapID;for(var r=(f=e.result.dataSet).length,i=0;i<r;i++){var o,s,a,l=f[i];e.transaction.simulationType==syn.$w.dynamicType.CodeHelp?t.push({id:l.id,value:l.value}):"J"==e.transaction.dataFormat?"Y"==e.transaction.compressionYN?t.push({id:l.id,value:JSON.parse(syn.$c.LZString.decompressFromBase64(l.value))}):t.push({id:l.id,value:l.value}):p.transactions?(o=p.transactions.find(function(e){return e.functionID==g.functionID}))&&(s=null,0==$object.isEmpty(l.value)&&(s=("Y"==e.transaction.compressionYN?syn.$c.LZString.decompressFromBase64(l.value):l.value).split("＾"),a=$string.toParameterObject(s[0]),s=$string.toJson(s[1],{delimeter:"｜",newline:"↵",meta:a}),"Form"==o.outputs[i].responseType?(s=s[0],1==$object.isNullOrUndefined(s)&&(s={})):1==$object.isNullOrUndefined(s)&&(s=[])),t.push({id:l.id,value:s})):(s=("Y"==e.transaction.compressionYN?syn.$c.LZString.decompressFromBase64(l.value):l.value).split("＾"),a=$string.toParameterObject(s[0]),s=$string.toJson(s[1],{delimeter:"｜",newline:"↵",meta:a}),1==l.id.startsWith("Form")&&(s=s[0],1==$object.isNullOrUndefined(s)?s={}:1==$object.isNullOrUndefined(s)&&(s=[])),t.push({id:l.id,value:s}))}}if(m){var u={};if(n.additions&&0<n.additions.length)for(i=0;i<n.additions.length;i++){var c=n.additions[i];"F"==c.code&&1==$object.isNullOrUndefined(u[c.code])?u[c.code]=c.text:"P"!=c.code&&c.code}try{m(t,u,e.correlationID)}catch(e){syn.$l.eventLog("$w.executeTransaction callback",e,"Error")}}}else{var d=e.exceptionText,h="거래: {0}, 기능: {1} 수행중 오류가 발생하였습니다\nGlobalID: {2}".format(y.transaction.transactionID,y.transaction.functionID,y.transaction.globalID);if(syn.$w.serviceClientException&&syn.$w.serviceClientException("요청오류",h,d),syn.$l.eventLog("$w.executeTransaction",d,"Warning"),"browser"===globalRoot.devicePlatform)$this&&$this.hook&&$this.hook.frameEvent&&$this.hook.frameEvent("transactionException",{transactionID:y.transaction.transactionID,functionID:y.transaction.functionID,errorText:d,errorMessage:h});else if(m)try{m([],null),e.correlationID}catch(e){syn.$l.eventLog("$w.executeTransaction callback",e,"Error")}}else if(m){if(e&&e.acknowledge&&1==e.acknowledge)try{if(null!=e.result.dataSet&&0<e.result.dataSet.length){e.result.mapID;for(var f,r=(f=e.result.dataSet).length,i=0;i<r;i++){l=f[i];"J"==e.transaction.dataFormat?"Y"==e.transaction.compressionYN&&(l.value=JSON.parse(syn.$c.LZString.decompressFromBase64(l.value))):l.value="Y"==e.transaction.compressionYN?syn.$c.LZString.decompressFromBase64(l.value):l.value}}}catch(e){syn.$l.eventLog("$w.executeTransaction",e,"Error")}try{m(e,null,e.correlationID)}catch(e){syn.$l.eventLog("$w.executeTransaction callback",e,"Error")}}}catch(e){h="거래: {0}, 기능: {1} 수행중 오류가 발생하였습니다\nGlobalID: {2}".format(y.transaction.transactionID,y.transaction.functionID,y.transaction.globalID);if(syn.$w.serviceClientException&&syn.$w.serviceClientException("요청오류",h,e.stack),syn.$l.eventLog("$w.executeTransaction",e,"Error"),"browser"===globalRoot.devicePlatform)$this&&$this.hook&&$this.hook.frameEvent&&$this.hook.frameEvent("transactionError",{transactionID:y.transaction.transactionID,functionID:y.transaction.functionID,errorText:e.message,errorMessage:h});else if(m)try{m([],null)}catch(e){syn.$l.eventLog("$w.executeTransaction callback",e,"Error")}}syn.$w.domainTransactionLoaderEnd&&syn.$w.domainTransactionLoaderEnd()}},syn.$l.eventLog("$w.executeTransaction",y.requestID,"Verbose"),T.setRequestHeader("X-Requested-With","HandStack ServiceClient"),T.setRequestHeader("Content-Type","application/json"),T.timeout=syn.Config.TransactionTimeout,T.send(JSON.stringify(y))}}}}}}),syn&&!syn.Config&&(syn.Config={}),syn.$w=$webform,"node"===globalRoot.devicePlatform){var fs=require("fs"),path=require("path");process.env.SYN_CONFIG&&(syn.Config=JSON.parse(process.env.SYN_CONFIG)),syn.Config&&1==$string.isNullOrEmpty(syn.Config.DataSourceFilePath)&&(syn.Config.DataSourceFilePath=path.join(process.cwd(),"BusinessContract/Database/DataSource.xml")),delete syn.$w.isPageLoad,delete syn.$w.pageReadyTimeout,delete syn.$w.eventAddReady,delete syn.$w.eventRemoveReady,delete syn.$w.moduleReadyIntervalID,delete syn.$w.remainingReadyIntervalID,delete syn.$w.remainingReadyCount,delete syn.$w.defaultControlOptions,delete syn.$w.initializeScript,delete syn.$w.activeControl,delete syn.$w.contentLoaded,delete syn.$w.addReadyCount,delete syn.$w.removeReadyCount,delete syn.$w.createSelection,delete syn.$w.getTriggerOptions,delete syn.$w.triggerAction,delete syn.$w.transactionAction,delete syn.$w.transaction,delete syn.$w.scrollToTop,delete syn.$w.setFavicon,delete syn.$w.fileDownload}else{var pathname=location.pathname,filename,urlArgs=(0<pathname.split("/").length&&(filename=pathname.split("/")[pathname.split("/").length-1],$webform.extend({pageProject:pathname.split("/")[pathname.split("/").length-2],pageScript:"$"+(-1<filename.indexOf(".")?filename.substring(0,filename.indexOf(".")):filename)})),syn.$l.addEvent(context,"load",function(){var e=context[syn.$w.pageScript];e&&e.hook.windowLoad&&e.hook.windowLoad()}),"true"==syn.$r.getCookie("syn.iscache")?"":"?tick="+(new Date).getTime()),isAsyncLoad=0==syn.$b.isIE;if(globalRoot.isLoadConfig=!1,context.synConfig?(syn.Config=syn.$w.argumentsExtend(synConfig,syn.Config),context.synConfig=void 0,globalRoot.isLoadConfig=!0,setTimeout(async function(){await $webform.contentLoaded()})):$webform.loadJson("/"+(context.synConfigName||"syn.config.json")+urlArgs,null,function(e,t){syn.Config=syn.$w.argumentsExtend(t,syn.Config),globalRoot.isLoadConfig=!0,setTimeout(async function(){await $webform.contentLoaded()})},null,isAsyncLoad),context.Configuration&&(syn.Environment=context.Configuration,syn.$l.deepFreeze(syn.Environment),delete context.Configuration),syn.Environment){var environment=syn.Environment;if(environment.Cookie)for(var item in environment.Cookie){var value=syn.$r.getCookie(item);1==$object.isNullOrUndefined(value)&&syn.$r.setCookie(item,environment.Cookie[item])}}"browser"===globalRoot.devicePlatform&&(syn.$b.appName=syn.Config.HostName,syn.$b.appCodeName=syn.Config.ApplicationID)}}(globalRoot),!function(context){"use strict";var $resource=context.$resource||new syn.module,document=context.document;$resource.extend({version:"1.0.0",localeID:"ko-KR",fullyQualifiedLocale:{ko:"ko-KR",en:"en-US",ja:"ja-JP",zh:"zh-CN"},translations:{},translateControls:[],concreate(){for(var els=document.querySelectorAll("[syn-i18n]"),i=0;i<els.length;i++){var el=els[i],tagName=el.tagName.toUpperCase(),elID=el.getAttribute("id"),i18nOption=el.getAttribute("syn-i18n");if(null!=i18nOption&&""!==i18nOption){var options=null;if(1==i18nOption.startsWith("{"))try{options=eval("("+i18nOption+")"),void 0===options.options.bindSource||null===options.options.bindSource?options.bindSource="content":options.bindSource=options.options.bindSource}catch(error){console.log('$resource.concreate, tagName: "'+tagName+'", elID: "'+elID+'" syn-i18n 확인 필요, error: '+error.message)}else options={key:i18nOption,bindSource:"content"};if(options&&0==(void 0===options.key||null===options.key||""===options.key)){el.setAttribute("i18n-key",options.key);var controlType="",moduleName=null;if(-1<tagName.indexOf("SYN_"))moduleName=tagName.substring(4).toLowerCase(),controlType=moduleName;else switch(tagName){case"BUTTON":moduleName="button",controlType="button";break;case"INPUT":switch(controlType=el.getAttribute("type").toLowerCase(),controlType){case"hidden":case"text":case"password":case"color":case"email":case"number":case"search":case"tel":case"url":moduleName="textbox";break;case"submit":case"reset":case"button":moduleName="button";break;case"radio":moduleName="radio";break;case"checkbox":moduleName="checkbox"}break;case"TEXTAREA":moduleName="textarea",controlType="textarea";break;case"SELECT":controlType=null==el.getAttribute("multiple")?(moduleName="select","select"):(moduleName="multiselect","multiselect");break;default:moduleName="element"}var key=options.key,bindSource=options.bindSource;delete options.key,delete options.bindSource,$resource.translateControls.push({elID:elID,key:key,bindSource:bindSource,tag:tagName,module:moduleName,type:controlType,options:options})}else console.log('$resource.concreate, tagName: "'+tagName+'", elID: "'+elID+'" key 확인 필요')}}var mod=window[syn.$w.pageScript];mod&&mod.hook.pageResource&&mod.hook.pageResource($resource.localeID),syn.Config&&1==$string.toBoolean(syn.Config.IsLocaleTranslations)&&($resource.remainingReadyIntervalID=setInterval(function(){1==syn.$w.isPageLoad&&(clearInterval($resource.remainingReadyIntervalID),$resource.remainingReadyIntervalID=null,$resource.setLocale($resource.localeID))},25))},add(e,t){$resource.translations[e]=t},remove(e){delete $resource.translations[e]},interpolate(e,n){return Object.keys(n).reduce(function(e,t){return e.replace(new RegExp("#{s*"+t+"s*}","g"),n[t])},e)},getControl(e){var t,n,r,i=null;return 1==$object.isString(e)&&(e=syn.$l.get(e)),0==$object.isNullOrUndefined(e)&&(t=e.id,n=e.tagName,r=e.getAttribute("i18n-key"),i=1==$string.isNullOrEmpty(t)?$resource.translateControls.find(function(e){return e.tag==n&&e.key==r}):$resource.translateControls.find(function(e){return e.elID==t&&e.tag==n&&e.key==r})),i},translatePage(){$resource.translateControls.forEach(function(e){$resource.translateControl(e)})},translateElement(e,t){e=$resource.getControl(e);0==$object.isNullOrUndefined(e)&&$resource.translateControl(e,t)},translateControl(e,t){var n,r;0==$object.isNullOrUndefined(e)&&(r=null,r=0==$string.isNullOrEmpty(e.elID)?syn.$l.get(e.elID):syn.$l.querySelector('{0}[i18n-key="{1}"]'.format(e.tag,e.key)),1==$object.isNullOrUndefined(e.module)?(n=$resource.getBindSource(e),0==$string.isNullOrEmpty(n)&&(r[n]=$resource.translateText(e,t))):syn.uicontrols&&(r=syn.uicontrols["$"+e.module])&&r.setLocale&&r.setLocale(e.elID,$resource.translations,e,t))},translateText(e,t){var n,r="";return e&&(e=e.key,e=$resource.translations[e],n=null,1==$object.isString(e)?n=e:1==$object.isArray(e)?n=e[0]:1==$object.isObject(e)&&(n=e.Text),r=1==/#{s*\w+s*}/g.test(n)&&((e=syn.$w.getSSOInfo())?t&&(e=syn.$w.argumentsExtend(e,t)):e=t,e)?$resource.interpolate(n,e):n),r},getBindSource(e){var t=null;switch(e.bindSource){case"text":t="innerText";break;case"content":t="textContent";break;case"html":t="innerHTML";break;case"url":t="src";break;case"placeholder":t="placeholder";break;case"control":t="controlText";break;case"value":t="value"}return t},async setLocale(e){var t="/assets/shared/language/";if(syn&&syn.Config&&(t=syn.Config.LocaleAssetUrl||syn.Config.SharedAssetUrl+"language/"),$resource.localeID=e,1==await syn.$r.isCorsEnabled(t=""+t+e+".json"))try{var n=await syn.$w.fetchJson(t);$resource.translations=syn.$w.argumentsExtend($resource.translations,n)}catch(e){syn.$l.eventLog("$resource.setLocale",e.message,"Warning")}document.documentElement.lang=e.substring(0,2),$resource.translatePage()}}),context.$resource=$resource}(globalRoot),!function(){if(!$resource)throw new Error("$res 리소스 객체가 없습니다.");$resource.add("localeID","ko-KR"),$resource.add("progress","진행 중입니다."),$resource.add("appendTo","신규 입력 상태입니다."),$resource.add("appendPre","화면 구성 중..."),$resource.add("retrieve","정상적으로 조회되었습니다."),$resource.add("retrieveException","데이터를 조회하는 과정에서 문제가 발생하였습니다."),$resource.add("retrievePre","데이터 조회 중..."),$resource.add("save","정상적으로 저장되었습니다."),$resource.add("saveException","데이터를 저장하는 과정에서 문제가 발생하였습니다."),$resource.add("savePre","저장 중..."),$resource.add("update","정상적으로 수정되었습니다."),$resource.add("updateException","데이터를 수정하는 과정에서 문제가 발생하였습니다."),$resource.add("updatePre","수정 중..."),$resource.add("remove","정상적으로 삭제되었습니다."),$resource.add("removeException","데이터를 삭제하는 과정에서 문제가 발생하였습니다."),$resource.add("removePre","삭제 중..."),$resource.add("copyAppend","기존 데이터를 복사하여 입력 상태로 전환했습니다."),$resource.add("userInfoNothing","사용자 정보에 문제가 발생했습니다."),$resource.add("isLogOut","정말로 로그아웃 하시겠습니까?"),$resource.add("waiting","잠시만 기다려주세요..."),$resource.add("notElemnet","컨트롤이 발견되지 않았습니다. 쿼리나 HTML 디자인을 살펴보세요"),$resource.add("dualElemnet",'"{0}"의 아이디는 현재 페이지에서 중복된 이름 또는 아이디의 컨트롤로 발견되었습니다.'),$resource.add("requiredKeyData","필수 입력 항목 오류"),$resource.add("requiredInsertData","아래 항목은 필수 입력 항목입니다."),$resource.add("errorMessage","에러가 발생했습니다."),$resource.add("serverErrorMessage","서버에서 에러가 발생했습니다."),$resource.add("initialComplete","화면 구성 완료"),$resource.add("initialException","화면 구성 실패"),$resource.add("isDateTimeInsert",'"{0}" 포맷의 날짜와 시간을 입력해야 합니다.'),$resource.add("isDateInsert",'"{0}" 포맷의 날짜를 입력해야 합니다.'),$resource.add("isTimeInsert",'"{0}" 포맷의 시간을 입력해야 합니다.'),$resource.add("isNumericInsert","숫자를 입력해야 합니다."),$resource.add("forceSave","편집중인 데이터를 저장하시겠습니까?"),$resource.add("textMaxLength",'입력 가능한 "{0}"자리수를 넘었습니다'),$resource.add("create","입력"),$resource.add("read","조회"),$resource.add("find","검색"),$resource.add("edit","수정"),$resource.add("delele","삭제"),$resource.add("removeStatusNo","삭제 가능한 상태가 아닙니다. 데이터를 조회한 후 삭제 해야 합니다."),$resource.add("removeConfirm","정말로 삭제 하시겠습니까?"),$resource.add("notData","데이터가 없습니다."),$resource.add("notCondData","입력하신 조건에 맞는 데이터가 없습니다."),$resource.add("notRetrieveCond","조회에 필요한 항목이 입력되지 않았습니다."),$resource.add("notDateBetween","기간이 올바르게 설정되지 않았습니다."),$resource.add("notDate","정확한 날짜를 입력 하거나 선택해야 합니다."),$resource.add("notFindCond","검색에 필요한 문장을 입력해야 합니다. 정확한 검색을 위해 두글자 이상 입력해야 합니다."),$resource.add("selectData","데이터를 선택해야 합니다."),$resource.add("selectAll","전체"),$resource.add("saveExcel","엑셀 다운로드 중입니다."),$resource.add("saveExcelComplete","엑셀 파일을 다운로드 했습니다."),$resource.add("saveExcelFail","엑셀 파일 다운로드를 실패 했습니다"),$resource.add("notSupportContent","지원 하지 않는 컨텐츠 타입입니다.")}(),!function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $checkbox=syn.uicontrols.$checkbox||new syn.module;$checkbox.extend({name:"syn.uicontrols.$checkbox",version:"1.0.0",defaultSetting:{contents:"",toSynControl:!1,disabled:!1,checkedValue:"1",uncheckedValue:"0",dataType:"string",belongID:null,controlText:null,textContent:"",validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,n,r){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:r})},controlLoad(elID,setting){var el=syn.$l.get(elID),mod=(setting=syn.$w.argumentsExtend($checkbox.defaultSetting,setting),window[syn.$w.pageScript]),moduleSettings,dataFieldID,events,value,checked,disabled,html,html,parent,wrapper;mod&&mod.hook.controlInit&&(moduleSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleSettings)),(1==setting.toSynControl?(el.setAttribute("id",el.id+"_hidden"),el.setAttribute("syn-options",JSON.stringify(setting)),el.style.display="none",dataFieldID=el.getAttribute("syn-datafield"),events=el.getAttribute("syn-events"),value=el.value,checked=el.checked,disabled=setting.disabled||el.disabled,html="",html=events?'<input class="ui_checkbox" id="{0}" name="{1}" type="checkbox" syn-datafield="{2}" value="{3}" {4} {5} syn-events={6}>'.format(elID,name,dataFieldID,value,1==checked?'checked="checked"':"",1==disabled?'disabled="disabled"':"","['"+eval(events).join("','")+"']"):'<input class="ui_checkbox" id="{0}" name="{1}" type="checkbox" syn-datafield="{2}" value="{3}" {4} {5}>'.format(elID,name,dataFieldID,value,1==checked?'checked="checked"':"",1==disabled?'disabled="disabled"':""),1==$object.isString(setting.textContent)&&(html+='<label class="ml-1" for="{0}">{1}</label>'.format(elID,setting.textContent)),parent=el.parentNode,wrapper=syn.$m.create({tag:"span",className:"formControl"}),wrapper.innerHTML=html,parent.appendChild(wrapper),syn.$l.get(elID)):el).setAttribute("syn-options",JSON.stringify(setting)),setting.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(elID,setting.bindingID)},getValue(e,t){var n,r=null,e=syn.$l.get(e);return 0==$object.isNullOrUndefined(e)?(n=e.getAttribute("syn-options"))?(n=JSON.parse(n)).checkedValue&&n.uncheckedValue&&(r=1==e.checked?n.checkedValue:n.uncheckedValue):r=e.checked:r="",r},setValue(e,t,n){e=syn.$l.get(e);t?(t=t.toString().toUpperCase(),e.checked="TRUE"==t||"Y"==t||"1"==t):e.checked=!1},toggleValue(e){e=syn.$l.get(e);0==e.checked?e.checked=!0:1==e.checked&&(e.checked=!1)},clear(e,t){syn.$l.get(e).checked=!1},getGroupNames(){for(var e=[],t=syn.$l.querySelectorAll("input[type='checkbox']"),n=0;n<t.length;n++)e.push(t[n].name);return $array.distinct(e)},setLocale(e,t,n,r){}}),syn.uicontrols.$checkbox=$checkbox}(window),!function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $codepicker=$codepicker||new syn.module;$codepicker.extend({name:"syn.uicontrols.$codepicker",version:"1.0.0",defaultSetting:{dataSourceID:null,storeSourceID:null,local:!0,parameters:"",label:"",labelWidth:"",codeElementID:"",codeElementWidth:"",codeElementClass:"",textElementID:"",textElementWidth:"",textElementClass:"",required:!1,readonly:!1,disabled:!1,textBelongID:null,textDataFieldID:null,searchValue:"",searchText:"",isMultiSelect:!1,isAutoSearch:!0,isOnlineData:!1,viewType:"",dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,n,r){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:r}),t.push({id:i+"_Text",formDataFieldID:e,field:n.textDataFieldID,module:syn.uicontrols.$textbox.name,type:"text"})},controlLoad(elID,setting){var el=syn.$l.get(elID),mod=(setting=syn.$w.argumentsExtend($codepicker.defaultSetting,setting),window[syn.$w.pageScript]),moduleSettings,dataField=(mod&&mod.hook.controlInit&&(moduleSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleSettings)),el.setAttribute("id",el.id+"_hidden"),el.setAttribute("syn-options",JSON.stringify(setting)),el.style.display="none",el.getAttribute("syn-datafield")),events=el.getAttribute("syn-events"),textboxCode=syn.$m.create({id:elID+"_Code",tag:"input",className:"form-control"}),buttonOpen=(textboxCode.setAttribute("syn-events","['keydown']"),textboxCode.setAttribute("baseID",elID),0==$string.isNullOrEmpty(dataField)&&textboxCode.setAttribute("syn-datafield",dataField),0==$string.isNullOrEmpty(setting.codeElementWidth)&&(textboxCode.style.width=codeElementWidth),0==$string.isNullOrEmpty(setting.codeElementClass)&&syn.$m.addClass(textboxCode,codeElementClass),1==$string.toBoolean(setting.readonly)&&textboxCode.setAttribute("readonly","readonly"),1==$string.toBoolean(setting.disabled)&&textboxCode.setAttribute("disabled","disabled"),1==$string.toBoolean(setting.required)&&textboxCode.setAttribute("required","required"),1==$string.isNullOrEmpty(setting.belongID)?textboxCode.setAttribute("syn-options","{editType: 'text', dataType: 'string'}"):1==$object.isArray(setting.belongID)?textboxCode.setAttribute("syn-options",`{editType: 'text', dataType: 'string', belongID: '[${eval(setting.belongID).join("','")}]'}`):textboxCode.setAttribute("syn-options",`{editType: 'text', dataType: 'string', belongID: '${setting.belongID}'}`),0==$object.isNullOrUndefined(events)&&textboxCode.setAttribute("syn-events",`['${eval(events).join("','")}']'`),syn.$m.insertAfter(textboxCode,el),syn.$m.create({id:elID+"_Button",tag:"button",className:"btn btn-icon f:18! bg-muted-lt"})),textboxText=(buttonOpen.innerHTML='<i class="ti ti-search"></i>',1!=$string.toBoolean(setting.readonly)&&1!=$string.toBoolean(setting.disabled)||textboxText.setAttribute("disabled","disabled"),syn.$m.insertAfter(buttonOpen,textboxCode),syn.$m.create({id:elID+"_Text",tag:"input",className:"form-control"})),codeEL=(textboxText.setAttribute("syn-events","['keydown']"),textboxText.setAttribute("baseID",elID),0==$string.isNullOrEmpty(setting.textDataFieldID)&&textboxText.setAttribute("syn-datafield",setting.textDataFieldID),0==$string.isNullOrEmpty(setting.textElementWidth)&&(textboxText.style.width=textElementWidth),0==$string.isNullOrEmpty(setting.textElementClass)&&syn.$m.addClass(textboxText,textElementClass),1==$string.toBoolean(setting.readonly)&&textboxText.setAttribute("readonly","readonly"),1==$string.toBoolean(setting.disabled)&&textboxText.setAttribute("disabled","disabled"),1==$string.toBoolean(setting.required)&&textboxText.setAttribute("required","required"),1==$string.isNullOrEmpty(setting.textBelongID)?textboxText.setAttribute("syn-options","{editType: 'text', dataType: 'string'}"):1==$object.isArray(setting.textBelongID)?textboxText.setAttribute("syn-options",`{editType: 'text', dataType: 'string', belongID: '['${eval(setting.textBelongID).join("','")}']'}`):textboxText.setAttribute("syn-options",`{editType: 'text', dataType: 'string', belongID: '${setting.textBelongID}'}`),0==$object.isNullOrUndefined(events)&&textboxText.setAttribute("syn-events",`['${eval(events).join("','")}']'`),syn.$m.insertAfter(textboxText,buttonOpen),syn.$l.get(elID+"_Code")),textEL=(syn.$l.addEvent(codeEL,"focus",function(e){var e=e.srcElement||e.target,t=window[syn.$w.pageScript];t&&(t.focusControl=e)}),syn.$l.addEvent(codeEL,"keydown",function(e){var t=e.currentTarget.id.replace("_Code","");syn.$l.get(t+"_Text").value="",13==e.keyCode&&syn.$l.trigger(syn.$l.get(t+"_Button"),"click",e)}),syn.uicontrols.$textbox.controlLoad(codeEL.id,eval(`(${codeEL.getAttribute("syn-options")})`)),syn.$l.get(elID+"_Text")),buttonEL=(syn.$l.addEvent(textEL,"focus",function(e){var e=e.srcElement||e.target,t=window[syn.$w.pageScript];t&&(t.focusControl=e)}),syn.$l.addEvent(textEL,"keydown",function(e){var t=e.currentTarget.id.replace("_Text","");syn.$l.get(t+"_Code").value="",13==e.keyCode&&syn.$l.trigger(syn.$l.get(t+"_Button"),"click",e)}),syn.uicontrols.$textbox.controlLoad(textEL.id,eval(`(${textEL.getAttribute("syn-options")})`)),syn.$l.get(elID+"_Button"));syn.$l.addEvent(buttonEL,"focus",function(e){var e=e.srcElement||e.target,t=window[syn.$w.pageScript];t&&(t.focusControl=e)}),syn.$l.addEvent(buttonEL,"click",function(e){var n=(this&&-1<this.id.indexOf("_Button")?this:e.currentTarget).id.replace("_Button","").replace("_Code","").replace("_Text",""),e=JSON.parse(syn.$l.get(n+"_hidden").getAttribute("syn-options")),r=(e.elID=n,e.viewType="form",e.codeElementID=n+"_Code",e.textElementID=n+"_Text",e.searchValue=syn.$l.get(e.codeElementID).value,e.searchText=syn.$l.get(e.textElementID).value,syn.$l.get(e.codeElementID).value),i=syn.$l.get(e.textElementID).value;syn.uicontrols.$codepicker.find(e,function(e){e&&0<e.length&&(t=mod[n+"_change"])&&t(r,i,e);var t=mod.hook.frameEvent;t&&t.call(this,"codeReturn",{elID:n,result:e})})}),setting.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(elID,setting.bindingID)},find(c,d){var e,t,n;1==$object.isNullOrUndefined(c.dataSourceID)?syn.$l.eventLog("$codepicker.find","dataSourceID 설정 없음","Debug"):(c.storeSourceID=c.storeSourceID||c.dataSourceID,e=c.elID+c.viewType+c.dataSourceID,(t=window[syn.$w.pageScript])&&(t.hook.frameEvent&&(n=t.hook.frameEvent("codeInit",c),c=syn.$w.argumentsExtend(c,n)),0==/(\@ApplicationID)\s*:/.test(c.parameters)&&(c.parameters="@ApplicationID:{0};".format(syn.Config.ApplicationID)+c.parameters),syn.$w.User&&syn.$w.User.WorkCompanyNo&&0==/(\@CompanyNo)\s*:/.test(c.parameters)&&(c.parameters="@CompanyNo:{0};".format(syn.$w.User.WorkCompanyNo)+c.parameters),0==/(\@LocaleID)\s*:/.test(c.parameters)&&(c.parameters="@LocaleID:{0};".format(syn.Config.Program.LocaleID)+c.parameters),t.codePickerArguments=t.codePickerArguments||{},t.codePickerArguments[e]=c),(n=$object.clone(syn.$w.dialogOptions)).minWidth=640,n.minHeight=480,n.caption=(c.controlText||c.columnText||c.dataSourceID)+" 코드도움",syn.$w.showUIDialog(syn.Config.SharedAssetUrl+"codehelp/index.html?parameterID={0}".format(e),n,function(e){if(e&&0<e.length){var t,n,r="",i="";if(0==c.isMultiSelect)r=(u=e[0]).value,i=u.text;else{for(var o=[],s=[],a=e.length,l=0;l<a;l++){var u=e[l];o.push(u.value),s.push(u.text)}r=o.join(),i=s.join()}"form"==c.viewType?(syn.$l.get(c.codeElementID).value=r,c.textElementID&&(syn.$l.get(c.textElementID).value=i)):"grid"==c.viewType&&(n=(t=syn.uicontrols.$grid).getActiveRowIndex(c.elID),t.setDataAtCell(c.elID,n,c.codeColumnID,r),c.textColumnID)&&t.setDataAtCell(c.elID,n,c.textColumnID,i)}d&&d(e)}))},toParameterString(e){return e?Object.entries(e).reduce(function(e,t,n){var r=t[0],t=t[1];return-1==r.indexOf("@")&&(e+="string"==typeof t?"@"+r+":"+t+";":""),e},""):""},toParameterObject(e){return(e.match(/([^?:;]+)(:([^;]*))/g)||[]).reduce(function(e,t){return e[t.slice(0,t.indexOf(":")).replace("@","")]=t.slice(t.indexOf(":")+1),e},{})},getValue(e,t){return syn.$l.get(e+"_Code").value},setValue(e,t,n){syn.$l.get(e+"_Code").value=t},setText(e,t,n){syn.$l.get(e+"_Text").value=t},clear(e,t){syn.$l.get(e+"_Code").value="",syn.$l.get(e+"_Text").value=""},open(e){syn.$l.trigger(e+"_Button","click")},setLocale(e,t,n,r){}}),syn.uicontrols.$codepicker=$codepicker}(window),!function(h){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var f=syn.uicontrols.$colorpicker||new syn.module;f.extend({name:"syn.uicontrols.$colorpicker",version:"1.0.0",colorControls:[],defaultSetting:{elID:"",defaultColor:null,defineColors:["FF0000","FF4000","FF8000","FFBF00","FFFF00","BFFF00","80FF00","40FF00","00FF00","00FFFF","00BFFF","0080FF","0040FF","8000FF","BF00FF","FF00FF","FF0080","FF0080","848484","000000"],dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,n,r){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:r})},controlLoad(e,t){for(var n=syn.$l.get(e),r=(t=syn.$w.argumentsExtend(f.defaultSetting,t),h[syn.$w.pageScript]),r=(r&&r.hook.controlInit&&(r=r.hook.controlInit(e,t),t=syn.$w.argumentsExtend(t,r)),t.elID=e,n.setAttribute("id",n.id+"_hidden"),n.setAttribute("syn-options",JSON.stringify(t)),n.style.display="none",n.getAttribute("syn-datafield")),r='<div class="control">'+'<input type="text" class="form-control" id="{0}" syn-datafield="{1}" syn-options="{editType: \'text\', maskPattern: \'#SSSSSS\', dataType: \'string\', belongID: \'{2}\'}" />'.format(e,r,t.belongID)+'<button type="button" id="{0}_Button" type="button" class="btn btn-default btn-code-search"></button>'.format(e)+"</div>",n=n.parentNode,i=syn.$m.create({tag:"div",id:e+"_box",className:"control-set"}),o=(i.innerHTML=r,n.appendChild(i),syn.uicontrols.$textbox.controlLoad(e),t.field=syn.$l.get(e),t.trigger=syn.$l.get(e+"_Button"),syn.$l.addEvent(t.trigger,"click",function(e){o[o.visible?"exit":"enter"]()}),new CP(t.field)),s=(1==$object.isString(t.defaultColor)&&o.set(t.defaultColor),document.createElement("span")),a=(s.className="color-pickers",o.self.appendChild(s),null),l=0,u=t.defineColors.length;l<u;++l)(a=document.createElement("span")).title="#"+t.defineColors[l],a.style.backgroundColor="#"+t.defineColors[l],syn.$l.addEvent(a,"click",function(e){o.set(this.title),o.fire("change",[this.title.slice(1)],"main-change"),e.stopPropagation()}),s.appendChild(a);var c=document.createElement("input");function d(){this.value.length&&(o.set(this.value),o.fire("change",[this.value.slice(1)]))}o.source.onclick=function(e){e.preventDefault()},c.className="color-picker-code",c.pattern="^#[A-Fa-f0-9]{6}$",c.type="text",o.on("enter",function(){c.value="#"+CP._HSV2HEX(this.get())}),o.on("change",function(e){this.source.value="#"+e,c.value="#"+e,c.style.backgroundColor="#"+e}),o.self.appendChild(c),c.oncut=d,c.onpaste=d,c.onkeyup=d,c.oninput=d,f.colorControls.push({id:e,picker:o,setting:$object.clone(t)}),t.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(e,t.bindingID)},getValue(e,t){var n=null,e=f.getControl(e);return n=e?e.picker.field.value:n},setValue(e,t,n){e=f.getControl(e);e&&(e.picker.field.value=t)},colorConvert(e,t){return CP[e](t)},clear(e,t){e=f.getControl(e);e&&e.picker.clear()},getControl(e){for(var t=null,n=f.colorControls.length,r=0;r<n;r++){var i=f.colorControls[r];if(i.id==e){t=i;break}}return t},setLocale(e,t,n,r){}}),syn.uicontrols.$colorpicker=f}(window),!function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $contextmenu=syn.uicontrols.$contextmenu||new syn.module;$contextmenu.extend({name:"syn.uicontrols.$contextmenu",version:"1.0.0",menuControls:[],eventHooks:["close","create","beforeOpen","open","select"],defaultSetting:{target:"targetCSSSelector",delegate:"delegateCSSSelector",autoFocus:!0,closeOnWindowBlur:!0,hide:!1,show:!1,menu:[{title:"Cut",cmd:"cut"},{title:"Copy",cmd:"copy",uiIcon:"ui-icon-copy"},{title:"---"},{title:"More",children:[{title:"Sub 1",cmd:"sub1"},{title:"Sub 2",cmd:"sub1"}]}],dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},controlLoad(elID,setting){var el=syn.$l.get(elID),mod=(setting=syn.$w.argumentsExtend($contextmenu.defaultSetting,setting),window[syn.$w.pageScript]),moduleSettings,hookEvents=(mod&&mod.hook.controlInit&&(moduleSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleSettings)),el.setAttribute("syn-options",JSON.stringify(setting)),el.style.display="none",el.getAttribute("syn-events"));try{hookEvents=hookEvents&&eval(hookEvents)}catch(error){syn.$l.eventLog("ContextMenu_controlLoad",error.toString(),"Debug")}for(var i=0;i<hookEvents.length;i++){var hookEvent=hookEvents[i];-1<$contextmenu.eventHooks.indexOf(hookEvent)&&1==$object.isNullOrUndefined(setting[hookEvent])&&(setting[hookEvent]=function(t,e){var n=$contextmenu.eventHooks.find(function(e){return e.toLowerCase()==t.type.replace("contextmenu","")}),r=window[syn.$w.pageScript];r&&(r=r.event?r.event["{0}_{1}".format(elID,n)]:null)&&r.apply(syn.$l.get(elID),[t,e])})}$contextmenu.menuControls.push({id:elID,context:$(setting.target).contextmenu(setting),config:setting})},getValue(e,t){return null},setValue(e,t,n){},clear(e,t){},getControl(e){for(var t=null,n=$contextmenu.menuControls.length,r=0;r<n;r++){var i=$contextmenu.menuControls[r];if(i.id==e){t=i;break}}return t},close(e){e=$contextmenu.getControl(e).context;e&&e.contextmenu("close")},enableEntry(e,t,n){e=$contextmenu.getControl(e).context;e&&e.contextmenu("enableEntry",t,n)},getEntry(e,t){var n=null,e=$contextmenu.getControl(e).context;return n=e?e.contextmenu("getEntry",t):n},setEntry(e,t,n){var r=null,e=$contextmenu.getControl(e).context;return r=e?e.contextmenu("setEntry",t,n):r},updateEntry(e,t,n){var r=null,e=$contextmenu.getControl(e).context;return r=e?e.contextmenu("updateEntry",t,n):r},showEntry(e,t,n){var r=null,e=$contextmenu.getControl(e).context;return r=e?e.contextmenu("showEntry",t,n):r},getEntryWrapper(e,t){var n=null,e=$contextmenu.getControl(e).context;return n=e?e.contextmenu("getEntryWrapper",t):n},getMenu(e){var t=null,e=$contextmenu.getControl(e).context;return t=e?e.contextmenu("getMenu"):t},isOpen(e){var t=null,e=$contextmenu.getControl(e).context;return t=e?e.contextmenu("isOpen"):t},open(e,t,n){e=$contextmenu.getControl(e).context;e&&e.contextmenu("open",t,n)},setIcon(e,t,n){var r=null,e=$contextmenu.getControl(e).context;return r=e?e.contextmenu("setIcon",t,n):r},setTitle(e,t,n){var r=null,e=$contextmenu.getControl(e).context;return r=e?e.contextmenu("setTitle",t,n):r},setLocale(e,t,n,r){}}),syn.uicontrols.$contextmenu=$contextmenu}(window),!function(i){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var d=syn.uicontrols.$data||new syn.module;d.extend({name:"syn.uicontrols.$data",version:"1.0.0",bindingList:[],storeList:[],propertyEvent:!0,defaultSetting:{dataSourceID:"",storeType:"Form",dataItems:[],dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},controlLoad(e,t){var n=syn.$l.get(e),r=(t=syn.$w.argumentsExtend(d.defaultSetting,t),i[syn.$w.pageScript]);r&&r.hook.controlInit&&(r=r.hook.controlInit(e,t),t=syn.$w.argumentsExtend(t,r)),n.setAttribute("syn-options",JSON.stringify(t)),n.style.display="none",$this.store[t.dataSourceID]="Form"==t.storeType?{}:[],d.storeList.push({id:e,dataSourceID:t.dataSourceID,storeType:t.storeType,columns:t.columns})},getValue(e,t){var n=null,e=(d.propertyEvent=!1,d.getMetaStore(e));return e&&(n=$this.store[e.dataSourceID]),d.propertyEvent=!0,n},setValue(e,t,n){},clear(e,t){},getMetaStore(e){for(var t=null,n=d.storeList.length,r=0;r<n;r++){var i=d.storeList[r];if(i.id==e){t=i;break}}return t},reactionGetValue(t,n,r){var e=null,i=d.bindingList.find(function(e){return e.elID==t&&e.dataSourceID==n&&e.dataFieldID==r});if(i){var o=d.storeList.find(function(e){return e.dataSourceID==i.dataSourceID});if("grid"==i.controlType||"list"==i.controlType||"chart"==i.controlType){for(var s={},a=o.columns.length,l=0;l<a;l++){var u=o.columns[l];s[u.data]={fieldID:u.data,dataType:u.dataType}}var c="Form"==o.storeType?"Row":"List",e=i.controlModule.getValue(t,c,s)}else e=i.controlModule.getValue(t)}return e},reactionSetValue(t,n,r,e){var i=d.bindingList.find(function(e){return e.elID==t&&e.dataSourceID==n&&e.dataFieldID==r});if(i){var o=d.storeList.find(function(e){return e.dataSourceID==i.dataSourceID});if("grid"==i.controlType||"list"==i.controlType||"chart"==i.controlType){for(var s={},a=o.columns.length,l=0;l<a;l++){var u=o.columns[l];s[u.data]={fieldID:u.data,dataType:u.dataType}}i.controlModule.setValue(t,e,s)}else i.controlModule.setValue(t,e)}},bindingSource(t,n){var e=$this.store[n],r=syn.$l.get(t+"_hidden")||syn.$l.get(t);if(0==$object.isNullOrUndefined(r)){var i=r.tagName.toUpperCase(),o=null,s=null;if(-1<i.indexOf("QAF_"))var a=i.substring(4).toLowerCase(),o=syn.uicontrols["$"+a],s=a;else switch(i){case"BUTTON":o=syn.uicontrols.$button,s="button";break;case"INPUT":switch(s=r.getAttribute("type").toLowerCase()){case"hidden":case"text":case"password":case"color":case"email":case"number":case"search":case"tel":case"url":o=syn.uicontrols.$textbox;break;case"submit":case"reset":case"button":o=syn.uicontrols.$button;break;case"radio":o=syn.uicontrols.$radio;break;case"checkbox":o=syn.uicontrols.$checkbox}break;case"TEXTAREA":o=syn.uicontrols.$textarea,s="textarea";break;case"SELECT":s=null==r.getAttribute("multiple")?(o=syn.uicontrols.$select,"select"):(o=syn.uicontrols.$multiselect,"multiselect")}var l=r.getAttribute("syn-datafield");l?null==("grid"==s||"list"==s||"chart"==s?d.bindingList.find(function(e){return e.dataSourceID==n}):d.bindingList.find(function(e){return e.elID==t&&e.dataSourceID==n&&e.dataFieldID==l}))?(d.bindingList.push({elID:t,dataSourceID:n,dataFieldID:l,controlModule:o,controlType:s}),Object.defineProperty(e,l,{get(){if(1==d.propertyEvent)return d.reactionGetValue(t,n,l)},set(e){1==d.propertyEvent&&d.reactionSetValue(t,n,l,e)},configurable:!0,enumerable:!0})):syn.$l.eventLog("$data.bindingSource","binding 정보 확인 필요 - elID: {0}, dataSourceID: {1}, dataFieldID: {2}, controlType: {3}, ".format(t,n,l,s),"Warning"):syn.$l.eventLog("$data.bindingSource","dataFieldID 확인 필요","Warning")}else syn.$l.eventLog("$data.bindingSource",'"{0}" elID 확인 필요'.format(t),"Warning")},setLocale(e,t,n,r){}}),syn.uicontrols.$data=d}(window),!function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $datepicker=syn.uicontrols.$datepicker||new syn.module;$datepicker.extend({name:"syn.uicontrols.$datepicker",version:"1.0.0",dateControls:[],defaultSetting:{elID:"",width:"100%",value:"",defaultDate:null,setDefaultDate:!1,minDate:null,maxDate:null,bound:!0,format:"YYYY-MM-DD",ariaLabel:"날짜를 선택하세요",i18n:{previousMonth:"이전 달",nextMonth:"다음 달",months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],weekdays:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],weekdaysShort:["일","월","화","수","목","금","토"]},showWeekNumber:!1,showMonthAfterYear:!0,yearSuffix:"년",firstDay:0,useRangeSelect:!1,rangeStartControlID:null,rangeEndControlID:null,numberOfMonths:1,dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,n,r){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:r})},controlLoad(elID,setting){var el=syn.$l.get(elID),mod=(setting=syn.$w.argumentsExtend($datepicker.defaultSetting,setting),window[syn.$w.pageScript]),moduleSettings,dataField=(mod&&mod.hook.controlInit&&(moduleSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleSettings)),!0===setting.useRangeSelect&&(1==$object.isNullOrUndefined(setting.rangeStartControlID)&&(setting.rangeStartControlID=elID),1==$object.isNullOrUndefined(setting.rangeEndControlID))&&(setting.rangeEndControlID=elID),setting.elID=elID,el.setAttribute("id",el.id+"_hidden"),el.setAttribute("syn-options",JSON.stringify(setting)),el.style.display="none",el.getAttribute("syn-datafield")),events=el.getAttribute("syn-events"),textbox=syn.$m.create({id:elID,tag:"input",className:"form-control"}),button=(0==$string.isNullOrEmpty(dataField)&&textbox.setAttribute("syn-datafield",dataField),1==$string.isNullOrEmpty(setting.belongID)?textbox.setAttribute("syn-options","{editType: 'date', maskPattern: '9999-99-99', dataType: 'string'}"):1==$object.isArray(setting.belongID)?textbox.setAttribute("syn-options",`{editType: 'date', maskPattern: '9999-99-99', dataType: 'string', belongID: '[${eval(setting.belongID).join("','")}]'}`):textbox.setAttribute("syn-options",`{editType: 'date', maskPattern: '9999-99-99', dataType: 'string', belongID: '${setting.belongID}'}`),0==$object.isNullOrUndefined(events)&&textbox.setAttribute("syn-events",`['${eval(events).join("','")}']'`),syn.$m.insertAfter(textbox,el),syn.$m.create({id:elID+"_Button",tag:"button",className:"btn btn-icon f:20! bg-muted-lt"})),picker=(button.innerHTML='<i class="ti ti-calendar"></i>',syn.$m.insertAfter(button,textbox),syn.uicontrols.$textbox.controlLoad(elID,eval("("+syn.$l.get(elID).getAttribute("syn-options")+")")),setting.field=syn.$l.get(elID),setting=syn.$w.argumentsExtend({onOpen(){var e=this._o.elID,t=this.getDate(),n=($datepicker.updateRangeDate(e,t),window[syn.$w.pageScript]),r="{0}_onselect".format(e);n&&n[r]&&n[r](e,t)},onClose(){var e=this._o.elID,t=this.getDate(),n=($datepicker.updateRangeDate(e,t),window[syn.$w.pageScript]),r="{0}_onselect".format(e);n&&n[r]&&n[r](e,t)},onSelect(e){var t,n,r;e&&(t=this._o.elID,$datepicker.updateRangeDate(t,e),n=window[syn.$w.pageScript],r="{0}_onselect".format(t),n)&&n[r]&&n[r](t,e)}},setting),new Pikaday(setting)),value,date;0==$string.isNullOrEmpty(setting.value)&&(value=setting.value,date=null,"now"==value?date=new Date:1==value.startsWith("day:")?date=$date.addDay(new Date,$string.toNumber(value.split(":")[1])):1==value.startsWith("week:")?date=$date.addWeek(new Date,$string.toNumber(value.split(":")[1])):1==value.startsWith("month:")?date=$date.addMonth(new Date,$string.toNumber(value.split(":")[1])):1==value.startsWith("year:")&&(date=$date.addyear(new Date,$string.toNumber(value.split(":")[1]))),date)&&picker.setDate($date.toString(date,"d")),syn.$l.addEvent(syn.$l.get(elID+"_Button"),"click",function(e){picker[picker.isVisible()?"hide":"show"]()}),$datepicker.dateControls.push({id:elID,picker:picker,setting:$object.clone(setting)}),setting.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(elID,setting.bindingID)},getValue(e,t){var n=null,e=$datepicker.getControl(e);return n=e?e.picker._o.field.value:n},setValue(e,t,n){e=$datepicker.getControl(e);e&&e.picker.setDate(t)},clear(e,t){e=$datepicker.getControl(e);e&&e.picker.clear()},getControl(e){for(var t=null,n=$datepicker.dateControls.length,r=0;r<n;r++){var i=$datepicker.dateControls[r];if(i.id==e){t=i;break}}return t},updateRangeDate(e,t){var n,r,i,o=syn.$l.get(e);0==$object.isNullOrUndefined(o)&&(o=$datepicker.getControl(e))&&!0===o.setting.useRangeSelect&&(o.setting.rangeStartControlID==e?(n=o.picker,r=null,(i=$datepicker.getControl(o.setting.rangeEndControlID))&&(r=i.picker),n&&r&&$datepicker.updateStartDate(n,r,t)):o.setting.rangeEndControlID==e&&(n=null,r=o.picker,n=(i=$datepicker.getControl(o.setting.rangeStartControlID))?i.picker:n)&&r&&$datepicker.updateEndDate(n,r,t))},updateStartDate(e,t,n){e.setStartRange(n),t.setStartRange(n),t.setMinDate(n)},updateEndDate(e,t,n){e.setEndRange(n),e.setMaxDate(n),t.setEndRange(n)},setLocale(e,t,n,r){}}),syn.uicontrols.$datepicker=$datepicker}(window),!function(i){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var c=syn.uicontrols.$multiselect||new syn.module;c.extend({name:"syn.uicontrols.$multiselect",version:"1.0.0",selectControls:[],defaultSetting:{elID:"",required:!1,placeholder:"전체",animate:!1,local:!0,search:!1,multiSelectAll:!0,width:"100%",classNames:null,dataSourceID:null,storeSourceID:null,parameters:null,selectedValue:null,toSynControl:!1,dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,n,r){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:r})},controlLoad(e,t){t=syn.$w.argumentsExtend(c.defaultSetting,t);var n=i[syn.$w.pageScript],r=(n&&n.hook.controlInit&&(r=n.hook.controlInit(e,t),t=syn.$w.argumentsExtend(t,r)),t.elID=e,t.storeSourceID=t.storeSourceID||t.dataSourceID,syn.$l.get(e));r.setAttribute("syn-options",JSON.stringify(t)),c.addControlSetting(r,t),t.storeSourceID&&(syn.$w.addReadyCount(),r=null,(r=n.config&&n.config.dataSource&&n.config.dataSource[t.storeSourceID]&&1==t.local?n.config.dataSource[t.storeSourceID]:r)?(c.loadData(t.elID,r,t.required),t.selectedValue&&c.setValue(t.elID,t.selectedValue),syn.$w.removeReadyCount()):1==t.local?syn.$w.loadJson(syn.Config.SharedAssetUrl+"code/{0}.json".format(t.storeSourceID),t,function(e,t){t&&(n.config.dataSource[e.storeSourceID]=t,c.loadData(e.elID,t,e.required),e.selectedValue)&&c.setValue(e.elID,e.selectedValue),syn.$w.removeReadyCount()},!1):syn.$w.getDataSource(t.dataSourceID,t.parameters,function(e){e&&(n.config.dataSource[t.storeSourceID]=e,c.loadData(t.elID,e,t.required),t.selectedValue)&&c.setValue(t.elID,t.selectedValue),syn.$w.removeReadyCount()})),t.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(e,t.bindingID)},dataRefresh(e,t,n){var r;(t=syn.$w.argumentsExtend(JSON.parse(syn.$l.get(e).getAttribute("syn-options")),t)).storeSourceID=t.storeSourceID||t.dataSourceID,syn.$l.get(e).setAttribute("syn-options",JSON.stringify(t)),t.dataSourceID&&((r=i[syn.$w.pageScript]).config&&r.config.dataSource&&r.config.dataSource[t.storeSourceID]&&delete r.config.dataSource[t.storeSourceID],r&&r.hook.controlInit&&(e=r.hook.controlInit(e,t),t=syn.$w.argumentsExtend(t,e)),e=null,(e=r.config&&r.config.dataSource&&r.config.dataSource[t.storeSourceID]?r.config.dataSource[t.storeSourceID]:e)?(c.loadData(t.elID,e,t.required),t.selectedValue&&c.setValue(t.elID,t.selectedValue),n&&n()):1==t.local?syn.$w.loadJson(syn.Config.SharedAssetUrl+"code/{0}.json".format(t.storeSourceID),t,function(e,t){r.config.dataSource[e.storeSourceID]=t,c.loadData(e.elID,t,e.required),e.selectedValue&&c.setValue(e.elID,e.selectedValue),n&&n()},!1):syn.$w.getDataSource(t.dataSourceID,t.parameters,function(e){r.config.dataSource[t.storeSourceID]=e,c.loadData(t.elID,e,t.required),t.selectedValue&&c.setValue(t.elID,t.selectedValue),n&&n()}))},addControlSetting(e,t){var n=null;1==t.toSynControl&&(n=tail.select(e,t),syn.$m.addClass(n.select,e.className),n.on("open",function(){var e=c.getControl(this.e.id).picker,t=(1==$string.toBoolean(e.selectedDisabled)?(e.selectValues=e.value(),e.label.style.backgroundColor="#f2f2f2",e.label.style.color="#999"):(e.label.style.backgroundColor="",e.label.style.color=""),this.e.options),n=t.length,r=0,i=0;if(0<n){for(var o=0;o<n;o++){var s=t[o].textContent.length;r<s&&(r=s,i=o)}var e=syn.$d.measureSize(t[i].textContent);e&&(600<(e=parseInt(e.width.replace("px",""))+50)&&(e=600),syn.$d.getSize(this.dropdown).width<e)&&(this.dropdown.style.width=e.toString()+"px")}}),n.on("close",function(){var e=c.getControl(this.e.id).picker;1==$string.toBoolean(e.selectedDisabled)?(c.setValue(this.e.id,e.selectValues),e.label.style.backgroundColor="#f2f2f2",e.label.style.color="#999"):(e.label.style.backgroundColor="",e.label.style.color="")}),setTimeout(function(){n.select.picker=n,syn.$l.addEvent(n.select,"focus",function(e){$this.tabOrderFocusID=this.picker.e.id,$this.focusControl=this.picker.e})})),c.selectControls.push({id:e.id,picker:n,setting:$object.clone(t)})},getValue(e,t){var n=[],r=syn.$l.get(e);if(0==$object.isNullOrUndefined(r))for(var i=r.options.length,o=0;o<i;o++){var s=r.options[o];1==s.selected&&n.push(s.value)}return n.join(",")},setValue(e,t,n){var r=syn.$l.get(e);if(0==$object.isNullOrUndefined(r)){0==$object.isBoolean(n)&&(n=!0);for(var i=r.options.length,o=0;o<i;o++)r.options[o].selected;if(0==$object.isNullOrUndefined(t))for(var s=(t=0==$object.isArray(t)?t.split(","):t).length,o=0;o<s;o++)for(var a=t[o],l=0;l<i;l++){var u=r.options[l];if(u.value==a){u.selected=n;break}}c.controlReload(e)}},clear(e,t){var n=syn.$l.get(e);if(0==$object.isNullOrUndefined(n)){for(var r=n.options.length,i=0;i<r;i++)n.options[i].selected=!1;c.controlReload(e)}},loadData(e,t,n){for(var r=syn.$l.get(e),i=(1==$object.isNullOrUndefined(n)&&(n=!1),syn.uicontrols.$multiselect.getControl(e).setting.placeholder),o=(tail.select.strings.en.placeholderMulti=i,[]),s=((r.options.length=0)==n&&o.push(`<option value="">${i}</option>`),t.DataSource.length),a=0;a<s;a++){var l=t.DataSource[a];o.push('<option value="'.concat(l[t.CodeColumnID],'">',l[t.ValueColumnID],"</option>"))}r.innerHTML=o.join(""),c.setSelectedDisabled(e,!1),c.controlReload(e)},controlReload(e){var t=syn.$l.get(e);0==$object.isNullOrUndefined(t)&&(t=c.getControl(e))&&t.picker&&t.picker.reload()},getSelectedIndex(e){var t="",e=syn.$l.get(e);return t=0==$object.isNullOrUndefined(e)?e.options.selectedIndex:t},setSelectedIndex(e,t){e=syn.$l.get(e);0==$object.isNullOrUndefined(e)&&(e.options.selectedIndex=t)},getSelectedValue(e){var t="",e=syn.$l.get(e);return t=0==$object.isNullOrUndefined(e)&&-1<e.options.selectedIndex?e.options[e.options.selectedIndex].value:t},getSelectedText(e){var t="",e=syn.$l.get(e);return t=0==$object.isNullOrUndefined(e)&&-1<e.options.selectedIndex?e.options[e.options.selectedIndex].text:t},setSelectedValue(e,t){var n=syn.$l.get(e);if(0==$object.isNullOrUndefined(n)){for(var r=n.options.length,i=0;i<r;i++){var o=n.options[i];1==$object.isString(t)?o.value==t&&(o.selected=!0):1==$object.isArray(t)&&-1<t.indexOf(o.value)&&(o.selected=!0)}c.controlReload(e)}},setSelectedText(e,t){var n=syn.$l.get(e);if(0==$object.isNullOrUndefined(n)){for(var r=n.options.length,i=0;i<r;i++){var o=n.options[i];1==$object.isString(t)?o.text==t&&(o.selected=!0):1==$object.isArray(t)&&-1<t.indexOf(o.text)&&(o.selected=!0)}c.controlReload(e)}},disabled(e,t){1==$object.isNullOrUndefined(t)&&(t=!1),t=$string.toBoolean(t);var n=syn.uicontrols.$multiselect.getControl(e);n&&(1==n.setting.toSynControl?n.picker.config("disabled",t):(n=syn.$l.get(e),1==t?n.setAttribute("disabled","disabled"):n.removeAttribute("disabled")))},setSelectedDisabled(e,t){var n=syn.$l.get(e);if(0==$object.isNullOrUndefined(n)){var r=c.getValue(e).split(","),i=n.options.length,t=$string.toBoolean(t);if(1==t)for(var o=0;o<i;o++){var s=n.options[o];-1<r.indexOf(s.value)?s.disabled=!1:s.disabled=!0}else for(o=0;o<i;o++)(s=n.options[o]).disabled=!1;c.controlReload(e);e=c.getControl(e).picker;e&&(1==(e.selectedDisabled=t)?(e.label.style.backgroundColor="#f2f2f2",e.label.style.color="#999"):(e.label.style.backgroundColor="",e.label.style.color=""))}},getControl(e){for(var t=null,n=c.selectControls.length,r=0;r<n;r++){var i=c.selectControls[r];if(i.id==e){t=i;break}}return t},setLocale(e,t,n,r){}}),syn.uicontrols.$multiselect=c}(window),!function(i){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var u=syn.uicontrols.$select||new syn.module;u.extend({name:"syn.uicontrols.$select",version:"1.0.0",selectControls:[],defaultSetting:{elID:"",placeholder:"전체",required:!1,animate:!1,local:!0,search:!1,multiSelectAll:!1,width:"100%",classNames:null,dataSourceID:null,storeSourceID:null,parameters:null,selectedValue:null,toSynControl:!0,dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,n,r){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:r})},controlLoad(e,t){t=syn.$w.argumentsExtend(u.defaultSetting,t);var n=i[syn.$w.pageScript],r=(n&&n.hook.controlInit&&(r=n.hook.controlInit(e,t),t=syn.$w.argumentsExtend(t,r)),t.elID=e,t.storeSourceID=t.storeSourceID||t.dataSourceID,syn.$l.get(e));r.setAttribute("syn-options",JSON.stringify(t)),u.addControlSetting(r,t),t.storeSourceID&&(syn.$w.addReadyCount(),r=null,(r=n.config&&n.config.dataSource&&n.config.dataSource[t.storeSourceID]&&1==t.local?n.config.dataSource[t.storeSourceID]:r)?(u.loadData(t.elID,r,t.required),t.selectedValue&&u.setValue(t.elID,t.selectedValue),syn.$w.removeReadyCount()):1==t.local?syn.$w.loadJson(syn.Config.SharedAssetUrl+"code/{0}.json".format(t.storeSourceID),t,function(e,t){t&&(n.config.dataSource[e.storeSourceID]=t,u.loadData(e.elID,t,e.required),e.selectedValue)&&u.setValue(e.elID,e.selectedValue),syn.$w.removeReadyCount()},!1):syn.$w.getDataSource(t.dataSourceID,t.parameters,function(e){e&&(n.config.dataSource[t.storeSourceID]=e,u.loadData(t.elID,e,t.required),t.selectedValue)&&u.setValue(t.elID,t.selectedValue),syn.$w.removeReadyCount()})),t.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(e,t.bindingID)},dataRefresh(e,t,n){var r;(t=syn.$w.argumentsExtend(JSON.parse(syn.$l.get(e).getAttribute("syn-options")),t)).storeSourceID=t.storeSourceID||t.dataSourceID,syn.$l.get(e).setAttribute("syn-options",JSON.stringify(t)),t.dataSourceID&&((r=i[syn.$w.pageScript]).config&&r.config.dataSource&&r.config.dataSource[t.storeSourceID]&&delete r.config.dataSource[t.storeSourceID],r&&r.hook.controlInit&&(e=r.hook.controlInit(e,t),t=syn.$w.argumentsExtend(t,e)),e=null,(e=r.config&&r.config.dataSource&&r.config.dataSource[t.storeSourceID]?r.config.dataSource[t.storeSourceID]:e)?(u.loadData(t.elID,e,t.required),t.selectedValue&&u.setValue(t.elID,t.selectedValue),n&&n()):1==t.local?syn.$w.loadJson(syn.Config.SharedAssetUrl+"code/{0}.json".format(t.storeSourceID),t,function(e,t){r.config.dataSource[e.storeSourceID]=t,u.loadData(e.elID,t,e.required),e.selectedValue&&u.setValue(e.elID,e.selectedValue),n&&n()},!1):syn.$w.getDataSource(t.dataSourceID,t.parameters,function(e){r.config.dataSource[t.storeSourceID]=e,u.loadData(t.elID,e,t.required),t.selectedValue&&u.setValue(t.elID,t.selectedValue),n&&n()}))},addControlSetting(e,t){var n=null;1==t.toSynControl&&(n=tail.select(e,t),syn.$m.addClass(n.select,e.className),n.on("open",function(){var e=u.getControl(this.e.id).picker,t=(1==$string.toBoolean(e.selectedDisabled)?(e.selectValue=e.value(),e.label.style.backgroundColor="#f2f2f2",e.label.style.color="#999"):(e.label.style.backgroundColor="",e.label.style.color=""),this.e.options),n=t.length,r=0,i=0;if(0<n){for(var o=0;o<n;o++){var s=t[o].textContent.length;r<s&&(r=s,i=o)}var e=syn.$d.measureSize(t[i].textContent);e&&(600<(e=parseInt(e.width.replace("px",""))+50)&&(e=600),syn.$d.getSize(this.dropdown).width<e)&&(this.dropdown.style.width=e.toString()+"px")}}),n.on("close",function(){var e=u.getControl(this.e.id).picker;1==$string.toBoolean(e.selectedDisabled)?(u.setValue(this.e.id,e.selectValue),e.label.style.backgroundColor="#f2f2f2",e.label.style.color="#999"):(e.label.style.backgroundColor="",e.label.style.color="")}),setTimeout(function(){n.select.picker=n,syn.$l.addEvent(n.select,"focus",function(e){$this.tabOrderFocusID=this.picker.e.id,$this.focusControl=this.picker.e})})),u.selectControls.push({id:e.id,picker:n,setting:$object.clone(t)})},getValue(e,t){var n="",e=syn.$l.get(e);return n=0==$object.isNullOrUndefined(e)?e.value:n},setValue(e,t,n){var r=syn.$l.get(e);0==$object.isNullOrUndefined(r)&&(r.value=t,u.controlReload(e))},clear(e,t){var n=syn.$l.get(e);0==$object.isNullOrUndefined(n)&&(n.value="",u.controlReload(e))},loadData(e,t,n){for(var r=syn.$l.get(e),i=(1==$object.isNullOrUndefined(n)&&(n=!1),syn.uicontrols.$select.getControl(e).setting.placeholder),o=(tail.select.strings.en.placeholder=i,[]),s=((r.options.length=0)==n&&o.push(`<option value="">${i}</option>`),t.DataSource.length),a=0;a<s;a++){var l=t.DataSource[a];o.push('<option value="'.concat(l[t.CodeColumnID],'">',l[t.ValueColumnID],"</option>"))}r.innerHTML=o.join(""),u.setSelectedDisabled(e,!1),u.controlReload(e)},controlReload(e){var t=syn.$l.get(e);0==$object.isNullOrUndefined(t)&&(t=u.getControl(e))&&t.picker&&t.picker.reload()},getSelectedIndex(e){var t="",e=syn.$l.get(e);return t=0==$object.isNullOrUndefined(e)?e.options.selectedIndex:t},setSelectedIndex(e,t){var n=syn.$l.get(e);0==$object.isNullOrUndefined(n)&&n.options.length>t&&(n.selectedIndex=t,u.controlReload(e))},setSelectedValue(e,t){var n=syn.$l.get(e);if(0==$object.isNullOrUndefined(n))for(var r=n.options.length,i=0;i<r;i++)if(n.options[i].value==t){n.selectedIndex=i,u.controlReload(e);break}},setSelectedText(e,t){var n=syn.$l.get(e);if(0==$object.isNullOrUndefined(n))for(var r=n.options.length,i=0;i<r;i++)if(n.options[i].text==t){n.selectedIndex=i,u.controlReload(e);break}},getSelectedValue(e){var t="",e=syn.$l.get(e);return t=0==$object.isNullOrUndefined(e)&&-1<e.options.selectedIndex?e.options[e.options.selectedIndex].value:t},getSelectedText(e){var t="",e=syn.$l.get(e);return t=0==$object.isNullOrUndefined(e)&&-1<e.options.selectedIndex?e.options[e.options.selectedIndex].text:t},disabled(e,t){1==$object.isNullOrUndefined(t)&&(t=!1),t=$string.toBoolean(t);var n=syn.uicontrols.$select.getControl(e);n&&(1==n.setting.toSynControl?n.picker.config("disabled",t):(n=syn.$l.get(e),1==t?n.setAttribute("disabled","disabled"):n.removeAttribute("disabled")))},setSelectedDisabled(e,t){var n=syn.$l.get(e);if(0==$object.isNullOrUndefined(n)){var r=u.getSelectedValue(e),i=n.options.length,t=$string.toBoolean(t);if(1==t)for(var o=0;o<i;o++)(s=n.options[o]).value==r?s.disabled=!1:s.disabled=!0;else for(var s,o=0;o<i;o++)(s=n.options[o]).disabled=!1;u.controlReload(e);e=u.getControl(e).picker;e&&(1==(e.selectedDisabled=t)?(e.label.style.backgroundColor="#f2f2f2",e.label.style.color="#999"):(e.label.style.backgroundColor="",e.label.style.color=""))}},getControl(e){for(var t=null,n=u.selectControls.length,r=0;r<n;r++){var i=u.selectControls[r];if(i.id==e){t=i;break}}return t},setLocale(e,t,n,r){}}),syn.uicontrols.$select=u}(window),!function(window){"use strict";window.fileUploadOptions=null,syn.uicontrols=syn.uicontrols||new syn.module;var $fileclient=$fileclient||new syn.module;$fileclient.extend({name:"syn.uicontrols.$fileclient",version:"1.0.0",fileManagers:[],fileControls:[],applicationID:"",mimeType:{html:"text/html",htm:"text/html",css:"text/css",xml:"text/xml",txt:"text/plain",gif:"image/gif",jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",tif:"image/tiff",ico:"image/x-icon",bmp:"image/x-ms-bmp",svg:"image/svg+xml",webp:"image/webp",js:"application/x-javascript",pdf:"application/pdf",rtf:"application/rtf",doc:"application/msword",docx:"application/msword",xls:"application/vnd.ms-excel",xlsx:"application/vnd.ms-excel",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.ms-powerpoint","7z":"application/x-7z-compressed",zip:"application/zip",bin:"application/octet-stream",exe:"application/octet-stream",dll:"application/octet-stream",iso:"application/octet-stream",msi:"application/octet-stream",mp3:"audio/mpeg",ogg:"audio/ogg",mp4:"video/mp4"},isFileAPIBrowser:!1,defaultSetting:{elementID:null,dialogTitle:"파일 업로드",tokenID:"",repositoryID:"",dependencyID:"",applicationID:"",fileUpdateCallback:null,accept:"*/*",uploadUrl:"",fileChangeHandler:void 0,custom1:void 0,custom2:void 0,custom3:void 0,minHeight:360,fileManagerServer:"",dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,n,r){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:r})},controlLoad(elID,setting){var el=syn.$l.get(elID),mod=(setting=syn.$w.argumentsExtend($fileclient.defaultSetting,setting),setting.elementID=elID,window[syn.$w.pageScript]),moduleSettings;mod&&mod.hook.controlInit&&(moduleSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleSettings)),setting.uploadType=null,setting.uploadUrl=null,syn.Config&&syn.Config.FileManagerServer&&(setting.fileManagerServer=syn.Config.FileManagerServer),1==$string.isNullOrEmpty(setting.fileManagerServer)?syn.$l.eventLog("$fileclient.controlLoad","파일 컨트롤 초기화 오류, 파일 서버 정보 확인 필요","Information"):(1==location.pathname.startsWith(syn.Config.TenantAppRequestPath?`/${syn.Config.TenantAppRequestPath}/`:"/app/")?1==$string.isNullOrEmpty($fileclient.applicationID)&&($fileclient.applicationID=syn.$w.ManagedApp.ApplicationID):1==$string.isNullOrEmpty($fileclient.applicationID)&&($fileclient.applicationID=syn.$w.Variable.ApplicationID||syn.$w.User.ApplicationID),1==$string.isNullOrEmpty($fileclient.applicationID)?syn.$l.eventLog("$fileclient.controlLoad","파일 컨트롤 초기화 오류, 파일 업무 ID 정보 확인 필요","Information"):(syn.$w.loadJson(setting.fileManagerServer+"/repository/api/storage/get-repository?applicationID={0}&repositoryID={1}".format($fileclient.applicationID,setting.repositoryID),setting,function(setting,repositoryData){setting.dialogTitle=repositoryData.RepositoryName,setting.storageType=repositoryData.StorageType,setting.isMultiUpload=repositoryData.IsMultiUpload,setting.isAutoPath=repositoryData.IsAutoPath,setting.policyPathID=repositoryData.PolicyPathID,setting.uploadType=repositoryData.UploadType,setting.uploadExtensions=repositoryData.UploadExtensions,setting.accept=repositoryData.UploadExtensions,setting.uploadCount=repositoryData.UploadCount,setting.uploadSizeLimit=repositoryData.UploadSizeLimit,"Single"==setting.uploadType?setting.uploadUrl=syn.Config.SharedAssetUrl+"upload/SingleFile.html":"Profile"==setting.uploadType?setting.uploadUrl=syn.Config.SharedAssetUrl+"upload/ProfilePicture.html":"Multi"==setting.uploadType?setting.uploadUrl=syn.Config.SharedAssetUrl+"upload/MultiFiles.html":"ImageLink"==setting.uploadType&&(setting.uploadUrl=syn.Config.SharedAssetUrl+"upload/ImageLinkFiles.html"),setting.elID=elID,el.setAttribute("id",el.id+"_hidden"),el.setAttribute("syn-options",JSON.stringify(setting)),el.style.display="none";var dataFieldID=el.getAttribute("syn-datafield"),events=el.getAttribute("syn-events"),value=el.value||"",name=el.name||"",html="",html=events?'<input type="hidden" id="{0}" name="{1}" syn-datafield="{2}" value="{3}" syn-events={4}>'.format(elID,name,dataFieldID,value,"['"+eval(events).join("','")+"']"):'<input type="hidden" id="{0}" name="{1}" syn-datafield="{2}" value="{3}">'.format(elID,name,dataFieldID,value),parent=el.parentNode,wrapper=document.createElement("div");wrapper.innerHTML=html,parent.appendChild(wrapper),syn.$l.get(elID).setAttribute("syn-options",JSON.stringify(setting)),$fileclient.fileControls.push({id:elID,setting:$object.clone(setting)})},function(){1==$string.isNullOrEmpty(setting.uploadUrl)&&syn.$w.alert("{0}에 대한 파일 서버 저장 정보 확인 필요".format(setting.repositoryID))},!0,!0),setting.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(elID,setting.bindingID)))},moduleInit(){syn.$l.addEvent(window,"message",function(e){var repositoryData=e.data;if(-1<(syn.Config.FileManagerServer+"/repository/api/storage").indexOf(e.origin)&&repositoryData&&"UploadFiles"==repositoryData.action&&(window.$progressBar&&$progressBar.close(),repositoryData.callback)){var mod=window[syn.$w.pageScript];if(mod){var clientCallback=null,clientCallback=mod[repositoryData.callback];if(1==$object.isNullOrUndefined(clientCallback))try{clientCallback=eval("$this."+repositoryData.callback)}catch(error){syn.$l.eventLog("clientCallback",error,"Warning")}if(clientCallback){for(var result={elID:repositoryData.elementID,repositoryID:repositoryData.repositoryID,items:repositoryData.repositoryItems},items=[],i=0;i<repositoryData.repositoryItems.length;i++){var item=repositoryData.repositoryItems[i];items.push(item.ItemID)}repositoryData.elementID&&(syn.$l.get(repositoryData.elementID).value=items.join(",")),clientCallback("upload",result)}}}$.modal&&$.modal.close()})},getFileSetting(e){for(var t=null,n=$fileclient.fileControls.length,r=0;r<n;r++){var i=$fileclient.fileControls[r];if(i.id==e){t=i.setting;break}}return t},getValue(e,t){return syn.$l.get(e).value},setValue(e,t,n){syn.$l.get(e).value=t||""},clear(e,t){syn.$l.get(e).value=""},init(e,t,n,r){var i=$fileclient.getTemporaryDependencyID(e);$fileclient.fileManagers.push({elID:e,container:t,datas:n,dependencyID:i,filechange:r}),window.File&&window.FileList&&($fileclient.isFileAPIBrowser=!0),null!=t&&0<document.forms.length&&(e=document.forms[0],null==syn.$l.get("syn-repository")&&(syn.$m.append(e,"iframe","syn-repository",{styles:{display:"none"}}).name="syn-repository"),e.enctype="multipart/form-data",e.target="syn-repository",e.method="post",e.action=syn.Config.FileManagerServer+"/repository/api/storage")},getRepositoryUrl(e){for(var t,n=null,r=0;r<$fileclient.fileManagers.length;r++)if((t=$fileclient.fileManagers[r]).datas&&t.datas.repositoryID==e){n=t.datas.fileManagerServer+"/repository/api/storage";break}return n},getFileManager(e){for(var t,n=null,r=0;r<$fileclient.fileManagers.length;r++)if((t=$fileclient.fileManagers[r]).elID==e){n=t;break}return n},getFileMaxIndex(e){for(var t=1,n=[],r=syn.$l.querySelectorAll('[id*="'+e+'_filesName"]'),i=1;i<=r.length;i++)n.push(i);return null==(t=n[n.length-1])&&(t=0),++t},addFileUI(e,t){var n,r,i,o,s=$fileclient.getFileManager(e);s?(s=s.container,n=document.createElement("div"),syn.$m.addClass(n,"mt-2"),o=document.createElement("div"),syn.$m.addClass(o,"input-group"),r=document.createElement("input"),syn.$m.addClass(r,"form-control"),i=document.createElement("button"),syn.$m.addClass(i,"btn btn-icon bg-muted-lt"),i.innerHTML='<i class="f:18 ti ti-trash"></i>',o.appendChild(r),o.appendChild(i),n.appendChild(o),s.appendChild(n),o=$fileclient.getFileMaxIndex(e).toString(),r.id=e+"_filesName_"+o,r.name="files",r.type="file",r.multiple=!1,t&&(r.accept=t),syn.$l.addEvent(r,"change",function(e){var e=e.target,t=null,n=null,r=e.id.split("_"),i=$fileclient.getFileManager(r[0]);i&&i.filechange&&(n=r[r.length-1],t=1==$fileclient.isFileAPIBrowser?{name:(r=e.files[0]).name,size:r.size,type:r.type,index:n}:((r=new Image).src=e.value,{name:r.nameProp,size:void 0,type:$fileclient.getFileMimeType(r.nameProp),index:n}),i.filechange(e,t))}),i.id=e+"_filesRemove_"+o,i.name=e+"_filesRemove_"+o,i.type="button",i.index=o,syn.$l.addEvent(i,"click",function(e){e=e.srcElement||e.target;"I"==e.tagName&&(e=e.parentElement),syn.$l.get(e.id.replace("_filesRemove_","_filesName_")).value=""})):syn.$w.alert(e+" 파일 관리자가 지정되지 않았습니다.")},getFileMimeType(e){var t="application/octet-stream",e=e.substring(e.lastIndexOf(".")+1);return e&&($resource&&$resource.mimeType?1==$resource.mimeType.hasOwnProperty(e)&&(t=$resource.mimeType[e]):1==$fileclient.mimeType.hasOwnProperty(e)&&(t=$fileclient.mimeType[e])),t},prependChild(e,t){var e=$fileclient.getFileManager(e).container,n=e.childNodes,r=n.length-1;t&&e.insertBefore(n[r],t)},getRepositoryID(e){var t="",e=$fileclient.getFileManager(e);return t=e?e.datas.repositoryID:t},getDependencyID(e){var t="",e=$fileclient.getFileManager(e);return t=e?e.dependencyID:t},setDependencyID(e,t){e=$fileclient.getFileManager(e);e&&(e.dependencyID=t)},doUpload(e,t){var n=$fileclient.getFileManager(e),r=null;if(n){var i,o=!1;if(-1==n.datas.uploadExtensions.indexOf("*/*"))for(var s=n.datas.uploadExtensions.split(";"),a=syn.$l.querySelectorAll("[id*='_filesName_']"),l=0;l<n.datas.uploadCount&&null!=(r=a[l]);l++){for(var u=0;u<s.length;u++){if(""==r.value){o=!0;break}if(r.value.substring(r.value.lastIndexOf(".")+1,r.value.length).toLowerCase()===s[u].toLowerCase()){o=!0;break}}if(0==o)break}else if(0<(a=syn.$l.querySelectorAll("[id*='_filesName_']")).length){for(l=0;l<a.length;l++)r=a[l],0==$string.isNullOrEmpty(r.value)&&(o=!0);if(0==o)return void syn.$w.alert("업로드할 파일을 선택해야합니다")}1==o&&0<document.forms.length?null!=syn.$l.get("syn-repository")?(syn.$r.params=[],i=$fileclient.getRepositoryID(e),syn.$r.path=$fileclient.getRepositoryUrl(i)+"/upload-files",syn.$r.params.elementID=t.elementID,syn.$r.params.repositoryID=i,syn.$r.params.dependencyID=$fileclient.getDependencyID(e),syn.$r.params.custompath1=t.custom1,syn.$r.params.custompath2=t.custom2,syn.$r.params.custompath3=t.custom3,0==$string.isNullOrEmpty(t.profileFileName)&&(syn.$r.params.fileName=t.profileFileName),n.datas.fileUpdateCallback&&(syn.$r.params.callback=n.datas.fileUpdateCallback),syn.$r.params.applicationID=$fileclient.applicationID,(i=document.forms[0]).action=syn.$r.url(),i.submit(),window.$progressBar&&$progressBar.show("파일 업로드 중입니다...")):syn.$w.alert("doUpload 메서드를 지원하지 않는 화면입니다."):1==$object.isNullOrUndefined(r)?syn.$w.alert("이전에 업로드 한 파일을 삭제해야합니다"):syn.$w.alert(n.datas.uploadExtensions+"확장자를 가진 파일을 업로드 해야합니다")}else syn.$w.alert(e+" 파일 관리자가 지정되지 않았습니다.")},getUploadUrl(e,t,n,r){return 1==$object.isNullOrUndefined(n)&&(n=!0),syn.$r.path=syn.Config.FileManagerServer+"/repository/api/storage/"+(1==n?"UploadFile":"UploadFiles"),syn.$r.params.repositoryID=e,syn.$r.params.dependencyID=t,syn.$r.params.responseType="json",1==n&&0==$string.isNullOrEmpty(r)&&(syn.$r.params.fileName=r),syn.$r.params.applicationID=$fileclient.applicationID,syn.$r.url()},getFileAction(e,t){if(1==$object.isNullOrUndefined(e.action))syn.$l.eventLog("getFileAction","필수 입력 정보 확인 필요","Warning");else{syn.$r.path=syn.Config.FileManagerServer+"/repository/api/storage/action-handler";var n=e.action;switch(syn.$r.params.action=n){case"GetItem":syn.$r.params.repositoryID=e.repositoryID,syn.$r.params.itemID=e.itemID;break;case"GetItems":syn.$r.params.repositoryID=e.repositoryID,syn.$r.params.dependencyID=e.dependencyID;break;case"UpdateDependencyID":syn.$r.params.repositoryID=e.repositoryID,syn.$r.params.sourceDependencyID=e.sourceDependencyID,syn.$r.params.targetDependencyID=e.targetDependencyID;break;case"UpdateFileName":syn.$r.params.repositoryID=e.repositoryID,syn.$r.params.itemID=e.itemID,syn.$r.params.fileName=e.fileName;break;case"DeleteItem":syn.$r.path=syn.Config.FileManagerServer+"/repository/api/storage/remove-item",syn.$r.params.repositoryID=e.repositoryID,syn.$r.params.itemID=e.itemID;break;case"DeleteItems":syn.$r.path=syn.Config.FileManagerServer+"/repository/api/storage/remove-items",syn.$r.params.repositoryID=e.repositoryID,syn.$r.params.dependencyID=e.dependencyID;break;default:return void syn.$l.eventLog("getFileAction","action 확인 필요","Warning")}syn.$r.params.applicationID=$fileclient.applicationID,$fileclient.executeProxy(syn.$r.url(),t)}},getItem(e,t,n){var r,i=$fileclient.getFileSetting(e);(i=null==i&&(r=$fileclient.getFileManager(e))?r.datas:i)?(syn.$r.path=i.fileManagerServer+"/repository/api/storage/action-handler",syn.$r.params.action="GetItem",syn.$r.params.repositoryID=i.repositoryID):(r=$fileclient.getRepositoryID(e),syn.$r.path=$fileclient.getRepositoryUrl(r)+"/action-handler",syn.$r.params.action="GetItem",syn.$r.params.repositoryID=r),syn.$r.params.itemID=t,syn.$r.params.applicationID=$fileclient.applicationID,$fileclient.executeProxy(syn.$r.url(),n)},getItems(e,t,n){var r,i=$fileclient.getFileSetting(e);(i=null==i&&(r=$fileclient.getFileManager(e))?r.datas:i)?(syn.$r.path=i.fileManagerServer+"/repository/api/storage/action-handler",syn.$r.params.action="GetItems",syn.$r.params.repositoryID=i.repositoryID):(r=$fileclient.getRepositoryID(e),syn.$r.path=$fileclient.getRepositoryUrl(r)+"/action-handler",syn.$r.params.action="GetItems",syn.$r.params.repositoryID=r),syn.$r.params.dependencyID=t,syn.$r.params.applicationID=$fileclient.applicationID,$fileclient.executeProxy(syn.$r.url(),n)},updateDependencyID(e,t,n,r){e=$fileclient.getFileSetting(e);syn.$r.path=e.fileManagerServer+"/repository/api/storage/action-handler",syn.$r.params.action="UpdateDependencyID",syn.$r.params.repositoryID=e.repositoryID,syn.$r.params.sourceDependencyID=t,syn.$r.params.targetDependencyID=n,syn.$r.params.applicationID=$fileclient.applicationID,$fileclient.executeProxy(syn.$r.url(),r)},updateFileName(e,t,n,r){e=$fileclient.getFileSetting(e);syn.$r.path=e.fileManagerServer+"/repository/api/storage/action-handler",syn.$r.params.action="UpdateFileName",syn.$r.params.repositoryID=e.repositoryID,syn.$r.params.itemID=t,syn.$r.params.fileName=n,syn.$r.params.applicationID=$fileclient.applicationID,$fileclient.executeProxy(syn.$r.url(),r)},fileUpload(e,t,n,r,i){var o="",o=1==$object.isNullOrUndefined(i)?syn.Config.FileManagerServer+"/repository/api/storage/upload-files?repositoryID={0}&dependencyID={1}&responseType=json&callback=none".format(t,n):i;if(0==$string.isNullOrEmpty(syn.uicontrols.$fileclient.applicationID)&&(o=o+"&applicationID="+syn.uicontrols.$fileclient.applicationID),(e=1==$object.isString(e)?syn.$l.get(e):e)&&"FILE"==e.type.toUpperCase()){for(var s=new FormData,a=0;a<e.files.length;a++)s.append("files",e.files[a]);var l=syn.$w.xmlHttp();l.open("POST",o,!0),l.onload=function(){r&&r({status:l.status,response:l.responseText})},l.onerror=function(){r&&r({status:l.status,response:l.responseText})},l.send(s)}},fileDownload(n){var e=null;if(1==$object.isString(n)){var t=n,r=$fileclient.getFileSetting(t),i=syn.$l.get(t)?syn.$l.get(t).value:null;if(!r||!i)return void syn.$l.eventLog("fileDownload",'"{0}"에 대한 요청 정보 확인 필요'.format(t),"Debug");e=JSON.stringify({RepositoryID:r.repositoryID,ItemID:i,FileMD5:"",TokenID:r.tokenID,ApplicationID:$fileclient.applicationID})}else{if(!n.repositoryID||!n.itemID)return void syn.$l.eventLog("fileDownload",'"{0}"에 대한 요청 정보 확인 필요'.format(t),"Debug");e=JSON.stringify({RepositoryID:n.repositoryID,ItemID:n.itemID,FileMD5:n.fileMD5,TokenID:n.tokenID,ApplicationID:$fileclient.applicationID})}syn.$r.path=(n.fileManagerServer||syn.Config.FileManagerServer)+"/repository/api/storage/download-file";var o=syn.$w.xmlHttp();o.open("POST",syn.$r.url(),!0),o.setRequestHeader("Content-type","application/json"),o.responseType="blob",o.onload=function(e){var t;200==o.status?"DownloadResult"==o.getResponseHeader("FileModelType")?(t=$c.base64Decode(o.getResponseHeader("HandStack_Result")),1==(t=JSON.parse(t)).Result?syn.$l.blobToDownload(o.response,t.FileName):syn.$l.eventLog("fileDownload",'파일 다운로드 실패: "{0}"'.format(t.Message),"Debug")):syn.$l.eventLog("fileDownload",'itemID: "{0}" 파일 다운로드 응답 오류'.format(JSON.stringify(n)),"Debug"):syn.$l.eventLog("fileDownload",'파일 다운로드 오류, status: "{0}"'.format(o.statusText),"Debug")},o.send(e)},httpDownloadFile(e,t,n,r){var i;0<document.forms.length&&null==syn.$l.get("repositoryDownload")&&(i=document.forms[0],(i=syn.$m.append(i,"iframe","repositoryDownload",{styles:{display:"none"}})).name="repositoryDownload",i.width="100%"),syn.$r.path=syn.Config.FileManagerServer+"/repository/api/storage/HttpDownloadFile",syn.$r.params.repositoryID=e,syn.$r.params.itemID=t,syn.$r.params.fileMD5=n,syn.$r.params.tokenID=r,syn.$r.params.applicationID=$fileclient.applicationID,syn.$l.get("repositoryDownload").src=syn.$r.url()},virtualDownloadFile(e,t,n){var r;0<document.forms.length&&null==syn.$l.get("repositoryDownload")&&(r=document.forms[0],syn.$m.append(r,"iframe","repositoryDownload",{styles:{display:"none"}}).name="repositoryDownload"),syn.$r.path=syn.Config.FileManagerServer+"/repository/api/storage/virtual-download-file",syn.$r.params.repositoryID=e,syn.$r.params.fileName=t,syn.$r.params.subDirectory=n,syn.$r.params.applicationID=$fileclient.applicationID,syn.$l.get("repositoryDownload").src=syn.$r.url()},virtualDeleteFile(e,t,n){syn.$r.path=syn.Config.FileManagerServer+"/repository/api/storage/virtual-delete-file",syn.$r.params.repositoryID=e,syn.$r.params.fileName=t,syn.$r.params.subDirectory=n,syn.$r.params.applicationID=$fileclient.applicationID,$fileclient.executeProxy(syn.$r.url(),function(e){0==e.Result&&syn.$l.eventLog("virtualDeleteFile",e.Message)})},deleteItem(s,a,l){var e,u=$fileclient.getFileSetting(s);(u=null==u&&(e=$fileclient.getFileManager(s))?e.datas:u)?(syn.$r.path=u.fileManagerServer+"/repository/api/storage/remove-item",syn.$r.params.repositoryID=u.repositoryID):(e=$fileclient.getRepositoryID(s),syn.$r.path=$fileclient.getRepositoryUrl(e)+"/remove-item",syn.$r.params.repositoryID=e),syn.$r.params.itemID=a,syn.$r.params.applicationID=$fileclient.applicationID,$fileclient.executeProxy(syn.$r.url(),function(e){if("Single"==u.uploadType||"Profile"==u.uploadType)e&&1==e.Result&&(t=syn.$l.get(s),0==$object.isNullOrUndefined(t))&&(t.value="");else if(e&&1==e.Result){var t=syn.$l.get(s);if(0==$object.isNullOrUndefined(t)){for(var n=[],r=t.value.split(","),i=0;i<r.length;i++){var o=r[i];o!=a&&n.push(o)}t.value=n.join(",")}}l&&l(e)})},deleteItems(n,e,r){var t,i=$fileclient.getFileSetting(n);(i=null==i&&(t=$fileclient.getFileManager(n))?t.datas:i)?(syn.$r.path=i.fileManagerServer+"/repository/api/storage/remove-items",syn.$r.params.repositoryID=i.repositoryID):(t=$fileclient.getRepositoryID(n),syn.$r.path=$fileclient.getRepositoryUrl(t)+"/remove-items",syn.$r.params.repositoryID=t),syn.$r.params.dependencyID=e,syn.$r.params.applicationID=$fileclient.applicationID,$fileclient.executeProxy(syn.$r.url(),function(e){var t;e&&1==e.Result&&(t=syn.$l.get(n),0==$object.isNullOrUndefined(t))&&(t.value=""),r&&r(e)})},uploadBlob(e,t){var n,r,i;e=syn.$w.argumentsExtend({repositoryID:null,dependencyID:null,blobInfo:null,mimeType:"application/octet-stream",fileName:null},e),0==$string.isNullOrEmpty(e.repositoryID)&&0==$string.isNullOrEmpty(e.dependencyID)&&e.blobInfo?(syn.$r.path=syn.Config.FileManagerServer+"/repository/api/storage/upload-file",syn.$r.params.repositoryID=e.repositoryID,syn.$r.params.dependencyID=e.dependencyID,syn.$r.params.applicationID=$fileclient.applicationID,(n=syn.$w.xmlHttp()).open("POST",syn.$r.url()),n.onload=function(){if(200!=n.status)syn.$l.eventLog("$fileclient.uploadBlob","HTTP Error code: {0}, text: {1}".format(n.status,n.statusText),"Warning");else try{var e=n.responseText;0==$string.isNullOrEmpty(e)?t&&t(JSON.parse(e)):syn.$w.alert("Blob 파일 업로드 정보 확인 필요")}catch(e){syn.$w.alert("Blob 파일 업로드 오류: {0}".format(e.message)),syn.$l.eventLog("$fileclient.uploadBlob",e,"Warning")}},n.onerror=function(){syn.$l.eventLog("$fileclient.uploadBlob","HTTP Error code: {0}, text: {1}".format(n.status,n.statusText),"Warning")},r=new FormData,i=e.fileName||"blob-"+syn.$l.random(24),r.append("file",e.blobInfo,i),n.send(r)):(syn.$w.alert(e="Blob 파일 업로드 필수 항목 확인 필요"),syn.$l.eventLog("$fileclient.uploadBlob",e,"Warning"))},uploadDataUri(e,t){e=syn.$w.argumentsExtend({repositoryID:null,dependencyID:null,dataUri:null,mimeType:null,fileName:null},e),0==$string.isNullOrEmpty(e.repositoryID)&&0==$string.isNullOrEmpty(e.dependencyID)&&0==$string.isNullOrEmpty(e.dataUri)?(e.blobInfo=syn.$l.dataUriToBlob(e.dataUri),e.mimeType=e.blobInfo.type,$fileclient.uploadBlob(e,t)):(syn.$w.alert(e="DataUri 파일 업로드 필수 항목 확인 필요"),syn.$l.eventLog("$fileclient.uploadDataUri",e,"Warning"))},uploadBlobUri(t,n){var e;t=syn.$w.argumentsExtend({repositoryID:null,dependencyID:null,blobUri:null,mimeType:null,fileName:null},t),0==$string.isNullOrEmpty(t.repositoryID)&&0==$string.isNullOrEmpty(t.dependencyID)&&0==$string.isNullOrEmpty(t.blobUri)?syn.$l.blobUrlToData(t.blobUri,function(e){t.blobInfo=e,t.mimeType=t.blobInfo.type,$fileclient.uploadBlob(t,n)}):(syn.$w.alert(e="BlobUri 파일 업로드 필수 항목 확인 필요"),syn.$l.eventLog("$fileclient.uploadBlobUri",e,"Warning"))},uploadUI(e){var t=$object.clone(syn.$w.dialogOptions);t.minWidth=420,t.minHeight=320,e=syn.$w.argumentsExtend(t,e),t.minWidth=e.minWidth,t.minHeight=e.minHeight,t.caption=e.dialogTitle,""==e.repositoryID||""==e.uploadUrl?syn.$w.alert("uploadOptions에 repositoryID 또는 uploadUrl이 입력되지 않았습니다."):(-1<e.uploadUrl.indexOf("?")?e.uploadUrl+="&repositoryID="+e.repositoryID:e.uploadUrl+="?repositoryID="+e.repositoryID,e.uploadUrl+="&companyNo="+syn.$w.User.WorkCompanyNo,fileUploadOptions=e,syn.$w.showUIDialog(e.uploadUrl,t))},toFileLengthString(e){var t="0 KB";return(e=e<0?0:e)<1048576&&(t=(e/1024).toString()+" KB"),t=e<1073741824?(e/1024/1024).toString()+" MB":t},executeProxy(t,n){var r=syn.$w.xmlHttp();r.onreadystatechange=function(){var e;r.readyState===XMLHttpRequest.DONE&&(200===r.status?(e=r.responseText,0==$string.isNullOrEmpty(e)?n&&n(JSON.parse(e)):syn.$w.alert("파일 응답 정보 확인 필요")):syn.$l.eventLog("$fileclient.executeProxy","async url: "+t+", status: "+r.status.toString()+", responseText: "+r.responseText,"Error"))},r.open("GET",t,!0),r.send()},getTemporaryDependencyID(e){return 1==$string.isNullOrEmpty(e)?syn.$l.guid().replaceAll("-",""):e+syn.$l.random(24)},setLocale(e,t,n,r){}}),$fileclient.moduleInit(),syn.uicontrols.$fileclient=$fileclient}(window),!function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $radio=$radio||new syn.module;$radio.extend({name:"syn.uicontrols.$radio",version:"1.0.0",defaultSetting:{contents:"",toSynControl:!1,dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,n,r){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:r})},controlLoad(elID,setting){var el=syn.$l.get(elID),mod=(setting=syn.$w.argumentsExtend($radio.defaultSetting,setting),window[syn.$w.pageScript]),moduleSettings,dataFieldID,events,value,checked,name,html,html,parent,wrapper;mod&&mod.hook.controlInit&&(moduleSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleSettings)),(1==setting.toSynControl?(el.setAttribute("id",el.id+"_hidden"),el.setAttribute("syn-options",JSON.stringify(setting)),el.style.display="none",dataFieldID=el.getAttribute("syn-datafield"),events=el.getAttribute("syn-events"),value=el.value,checked=el.checked,name=el.name,html="",html=events?'<input class="ui_radio" id="{0}" name="{1}" type="radio" syn-datafield="{2}" value="{3}" {4} syn-events={5}>'.format(elID,name,dataFieldID,value,1==checked?'checked="checked"':"","['"+eval(events).join("','")+"']"):'<input class="ui_radio" id="{0}" name="{1}" type="radio" syn-datafield="{2}" value="{3}" {4}>'.format(elID,name,dataFieldID,value,1==checked?'checked="checked"':""),1==$object.isString(setting.textContent)&&(html+='<label for="{0}">{1}</label>'.format(elID,setting.textContent)),parent=el.parentNode,wrapper=syn.$m.create({tag:"span",className:"formControl"}),wrapper.innerHTML=html,parent.appendChild(wrapper),syn.$l.get(elID)):el).setAttribute("syn-options",JSON.stringify(setting)),setting.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(elID,setting.bindingID)},getValue(e,t){return syn.$l.get(e).checked},setValue(e,t,n){syn.$l.get(e).checked=t},clear(e,t){syn.$l.get(e).checked=!1},getGroupNames(){for(var e=[],t=syn.$l.querySelectorAll("input[type='radio']"),n=0;n<t.length;n++)e.push(t[n].name);return $array.distinct(e)},getGroupValue(e){for(var t=null,n=syn.$l.querySelectorAll('input[type="radio"][name="{0}"]'.format(e)),r=0;r<n.length;r++){var i=n[r];if(-1==i.id.indexOf("_hidden")&&1==i.checked){t=i.value;break}}return t},selectedValue(e,t){for(var n=syn.$l.querySelectorAll('input[type="radio"][name="{0}"]'.format(e)),r=0;r<n.length;r++){n[r];if(-1==n[r].id.indexOf("_hidden")&&n[r].value===t){n[r].checked=!0;break}}},setLocale(e,t,n,r){}}),syn.uicontrols.$radio=$radio}(window),!function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $textarea=syn.uicontrols.$textarea||new syn.module;$textarea.extend({name:"syn.uicontrols.$textarea",version:"1.0.0",textControls:[],defaultSetting:{width:"100%",height:"240px",indentUnit:4,lineNumbers:!0,toSynControl:!0,dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,n,r){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:r})},controlLoad(elID,setting){var el=syn.$l.get(elID),mod=(setting=syn.$w.argumentsExtend($textarea.defaultSetting,setting),window[syn.$w.pageScript]),moduleSettings,events=(mod&&mod.hook.controlInit&&(moduleSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleSettings)),setting.elementID=elID,setting.width=el.style.width||setting.width,setting.height=el.style.height||setting.height,el.style.width=setting.width,el.style.height=setting.height,el.setAttribute("syn-options",JSON.stringify(setting)),el.getAttribute("syn-events")),editor=null;if(1==setting.toSynControl){if((el.getAttribute("maxlength")||el.getAttribute("maxlengthB"))&&(el.getAttribute("maxlengthB")&&el.setAttribute("maxlength",el.getAttribute("maxlengthB")),setting.maxLength=el.getAttribute("maxlength")),editor=CodeMirror.fromTextArea(el,setting),0==$object.isNullOrUndefined(setting.maxLength)&&editor.on("blur",function(e,t){var n=syn.$l.get(editor.options.elementID).getAttribute("maxlengthB"),n=0==$string.isNullOrEmpty(n)?parseInt(n):e.getOption("maxLength");return n<$string.length(e.getValue())&&(e=$object.clone(syn.$w.alertOptions),syn.$w.alert($resource.translations.textMaxLength.format($string.toCurrency(n)),"정보",e,function(e){editor.focus()})),!0}),events)for(var events=eval(events),i=0;i<events.length;i++){var editorEvent=events[i],eventHandler=mod[el.id+"_"+editorEvent];eventHandler&&editor.on(editorEvent,eventHandler)}editor.setSize(setting.width,setting.height),setTimeout(function(){editor.refresh()},30)}else(el.getAttribute("maxlength")||el.getAttribute("maxlengthB"))&&(el.getAttribute("maxlengthB")&&el.setAttribute("maxlength",el.getAttribute("maxlengthB")),syn.$l.addEvent(el,"blur",$textarea.event_blur));$textarea.textControls.push({id:elID,editor:editor,setting:$object.clone(setting)}),setting.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(elID,setting.bindingID)},getValue(e){var t=null,n=$textarea.getControl(e);return n&&n.editor?t=n.editor.getValue():(n=syn.$l.get(e),0==$object.isNullOrUndefined(n)&&(t=n.value)),t},setValue(e,t){var n=$textarea.getControl(e);n&&n.editor?n.editor.setValue(t):(n=syn.$l.get(e),0==$object.isNullOrUndefined(n)&&(n.value=t))},clear(e,t){var n=$textarea.getControl(e);n&&n.editor?n.editor.setValue(""):(n=syn.$l.get(e),0==$object.isNullOrUndefined(n)&&(n.value=""))},getControl(e){for(var t=null,n=$textarea.textControls.length,r=0;r<n;r++){var i=$textarea.textControls[r];if(i.id==e){t=i;break}}return t},event_blur(e){var t,n,e=e.target||e.srcElement||e,r=e.getAttribute("maxlengthB");0==$string.isNullOrEmpty(r)?(t=parseInt(r))<$string.length(e.value)&&(n=$object.clone(syn.$w.alertOptions),syn.$w.alert($resource.translations.textMaxLength.format($string.toCurrency(t)),"정보",n),e.focus()):(r=e.getAttribute("maxlength"),0==$string.isNullOrEmpty(r)&&(t=parseInt(r))<e.value.length&&(n=$object.clone(syn.$w.alertOptions),syn.$w.alert($resource.translations.textMaxLength.format($string.toCurrency(t)),"정보",n),e.focus()))},setLocale(e,t,n,r){}}),syn.uicontrols.$textarea=$textarea}(window),!function(s){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var i=new syn.module;i.extend({name:"syn.uicontrols.$textbox",version:"1.0.0",defaultSetting:{editType:"text",formatNumber:!0,maskPattern:null,maxCount:null,minCount:0,placeText:[],defaultSetValue:"0",dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,n,r){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:r})},controlLoad(e,t){var n=syn.$l.get(e),r=(t=syn.$w.argumentsExtend(i.defaultSetting,t),s[syn.$w.pageScript]);switch(r&&r.hook.controlInit&&(r=r.hook.controlInit(e,t),t=syn.$w.argumentsExtend(t,r)),n.setAttribute("syn-options",JSON.stringify(t)),0==$object.isEmpty(t.placeText)&&superplaceholder({el:n,sentences:1==$object.isString(t.placeText)?[t.placeText]:t.placeText}),t.editType){case"text":syn.$l.addEvent(n,"focus",i.event_focus);break;case"english":syn.$l.addEvent(n,"focus",i.event_focus),syn.$l.addEvent(n,"blur",i.event_english_blur),syn.$l.addEvent(n,"keydown",i.event_english_keydown),syn.$m.setStyle(n,"ime-mode","disabled");break;case"number":syn.$l.addEvent(n,"focus",i.event_numeric_focus),syn.$l.addEvent(n,"blur",i.event_number_blur),syn.$l.addEvent(n,"keypress",i.event_numeric_keypress),syn.$m.setStyle(n,"ime-mode","disabled"),VMasker(n).maskNumber();break;case"numeric":syn.$l.addEvent(n,"focus",i.event_numeric_focus),syn.$l.addEvent(n,"blur",i.event_numeric_blur),syn.$l.addEvent(n,"keypress",i.event_numeric_keypress),syn.$m.setStyle(n,"ime-mode","disabled"),VMasker(n).maskNumber();break;case"spinner":syn.$l.addEvent(n,"focus",i.event_numeric_focus),syn.$l.addEvent(n,"blur",i.event_numeric_blur),syn.$l.addEvent(n,"keypress",i.event_numeric_keypress),syn.$m.setStyle(n,"ime-mode","disabled"),n.offsetWidth&&(n.offsetWidth=n.offsetWidth<=28?0:n.offsetWidth-28),new ISpin(n,{wrapperClass:"ispin-wrapper",buttonsClass:"ispin-button",step:1,pageStep:10,disabled:!1,repeatInterval:100,wrapOverflow:!1,parse:Number,format:String}),VMasker(n).maskNumber();break;case"year":syn.$l.addEvent(n,"focus",i.event_focus),syn.$l.addEvent(n,"blur",i.event_year_blur),syn.$l.addEvent(n,"keypress",i.event_numeric_keypress);break;case"date":syn.$l.addEvent(n,"focus",i.event_focus),syn.$l.addEvent(n,"blur",i.event_date_blur),syn.$l.addEvent(n,"keypress",i.event_numeric_keypress);break;case"hour":syn.$l.addEvent(n,"focus",i.event_focus),syn.$l.addEvent(n,"blur",i.event_hour_blur),syn.$l.addEvent(n,"keypress",i.event_numeric_keypress),syn.$m.setStyle(n,"ime-mode","disabled");break;case"minute":syn.$l.addEvent(n,"focus",i.event_focus),syn.$l.addEvent(n,"blur",i.event_minute_blur),syn.$l.addEvent(n,"keypress",i.event_numeric_keypress),syn.$m.setStyle(n,"ime-mode","disabled");break;case"yearmonth":syn.$l.addEvent(n,"focus",i.event_focus),syn.$l.addEvent(n,"blur",i.event_yearmonth_blur),syn.$l.addEvent(n,"keypress",i.event_numeric_keypress);break;case"homephone":syn.$l.addEvent(n,"focus",i.event_phone_focus),syn.$l.addEvent(n,"blur",i.event_homephone_blur),syn.$l.addEvent(n,"keypress",i.event_numeric_keypress),syn.$m.setStyle(n,"ime-mode","disabled");break;case"mobilephone":syn.$l.addEvent(n,"focus",i.event_phone_focus),syn.$l.addEvent(n,"blur",i.event_mobilephone_blur),syn.$l.addEvent(n,"keypress",i.event_numeric_keypress),syn.$m.setStyle(n,"ime-mode","disabled");break;case"phone":syn.$l.addEvent(n,"focus",i.event_phone_focus),syn.$l.addEvent(n,"blur",i.event_phone_blur),syn.$l.addEvent(n,"keypress",i.event_numeric_keypress),syn.$m.setStyle(n,"ime-mode","disabled");break;case"email":syn.$l.addEvent(n,"focus",i.event_focus),syn.$l.addEvent(n,"blur",i.event_email_blur),syn.$m.setStyle(n,"ime-mode","inactive");break;case"juminno":syn.$l.addEvent(n,"focus",i.event_focus),syn.$l.addEvent(n,"blur",i.event_juminno_blur),syn.$l.addEvent(n,"keypress",i.event_numeric_keypress),syn.$m.setStyle(n,"ime-mode","disabled"),1==$string.isNullOrEmpty(t.maskPattern)&&VMasker(n).maskPattern("999999-9999999");break;case"businessno":syn.$l.addEvent(n,"focus",i.event_focus),syn.$l.addEvent(n,"blur",i.event_businessno_blur),syn.$l.addEvent(n,"keypress",i.event_numeric_keypress),syn.$m.setStyle(n,"ime-mode","disabled"),1==$string.isNullOrEmpty(t.maskPattern)&&VMasker(n).maskPattern("999-99-99999");break;case"corporateno":syn.$l.addEvent(n,"focus",i.event_focus),syn.$l.addEvent(n,"blur",i.event_corporateno_blur),syn.$l.addEvent(n,"keypress",i.event_numeric_keypress),syn.$m.setStyle(n,"ime-mode","disabled"),1==$string.isNullOrEmpty(t.maskPattern)&&VMasker(n).maskPattern("999999-9999999")}(n.getAttribute("maxlength")||n.getAttribute("maxlengthB"))&&(n.getAttribute("maxlengthB")&&n.setAttribute("maxlength",n.getAttribute("maxlengthB")),syn.$l.addEvent(n,"blur",i.event_blur)),0==$string.isNullOrEmpty(t.maskPattern)&&VMasker(n).maskPattern(t.maskPattern),t.contents&&i.setValue(e,t.contents),t.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(e,t.bindingID)},event_english_keydown(e){var t=e.which||e.keyCode;return 1!=(7<t&&t<47)&&1!=(64<t&&t<91)&&1!=(47<t&&t<58)&&1!=(95<t&&t<123)&&((t=e.target||e.srcElement||e).value=t.value.replace(/[\ㄱ-ㅎㅏ-ㅣ가-힣]/g,""),e.returnValue=!1,e.cancel=!0,e.preventDefault&&e.preventDefault(),0),!0},event_numeric_keypress(e){var t=e.target||e.srcElement||e,n=e.which||e.keyCode;if(31<n&&(n<48||57<n||45==n||109==n)){if(45==n||109==n){n=t.value;if(1==n.startsWith("-")&&n.split("-").length<=2||1==n.split("-").length)return!0}e.returnValue=!1,e.cancel=!0,e.preventDefault&&e.preventDefault(),0}return!0},event_focus(e){e=e.target||e.srcElement||e;0<e.value.length&&i.rangeMoveCaret(e)},event_phone_focus(e){e=e.target||e.srcElement||e;0<e.value.length&&(e.value=e.value.replace(/-/g,""),i.rangeMoveCaret(e))},event_numeric_focus(e){e=e.target||e.srcElement||e;0<e.value.length&&(e.value=$string.toNumberString(e.value),i.rangeMoveCaret(e))},event_blur(e){var t,n,e=e.target||e.srcElement||e,r=e.getAttribute("maxlengthB");0==$string.isNullOrEmpty(r)?(t=parseInt(e.getAttribute("maxlengthB")))<$string.length(e.value)&&(n=$object.clone(syn.$w.alertOptions),syn.$w.alert($resource.translations.textMaxLength.format($string.toCurrency(t)),"정보",n),e.focus(),i.event_focus(e)):(r=e.getAttribute("maxlength"),0==$string.isNullOrEmpty(r)&&(t=parseInt(e.getAttribute("maxlength")))<e.value.length&&(n=$object.clone(syn.$w.alertOptions),syn.$w.alert($resource.translations.textMaxLength.format($string.toCurrency(t)),"정보",n),e.focus(),i.event_focus(e)))},event_hour_blur(e){e=e.target||e.srcElement||e;0<e.value.length&&(23<parseInt(e.value)&&(e.value="23"),1==e.value.length)&&(e.value=e.value.padStart(2,"0"))},event_minute_blur(e){e=e.target||e.srcElement||e;0<e.value.length&&(59<parseInt(e.value)&&(e.value="59"),1==e.value.length)&&(e.value=e.value.padStart(2,"0"))},event_english_blur(e){e=e.target||e.srcElement||e;e.value=e.value.replace(/[^a-z0-9]/gi,"")},event_number_blur(e){var e=e.target||e.srcElement||e,t=JSON.parse(e.getAttribute("syn-options")),t=(0==$object.isNullOrUndefined(t.maxCount)&&$string.toNumber(e.value)>t.maxCount&&(e.value=t.maxCount),0==$object.isNullOrUndefined(t.minCount)&&$string.toNumber(e.value)<t.minCount&&(e.value=t.minCount),e.value);(1==t.startsWith("-")&&1==t.length||0==t.trim().length)&&(e.value="0")},event_numeric_blur(e){var e=e.target||e.srcElement||e,t=JSON.parse(e.getAttribute("syn-options")),t=(0==$object.isNullOrUndefined(t.maxCount)&&$string.toNumber(e.value)>t.maxCount&&(e.value=t.maxCount),0==$object.isNullOrUndefined(t.minCount)&&$string.toNumber(e.value)<t.minCount&&(e.value=t.minCount),0<e.value.length&&!0===t.formatNumber&&(e.value=$string.toCurrency(e.value)),e.value);(1==t.startsWith("-")&&1==t.length||0==t.trim().length)&&(e.value="0")},event_homephone_blur(e){var e=e.target||e.srcElement||e,t=(e.value=e.value.replace(/-/g,""),e.value);0<t.length&&(e.setAttribute("placeholder",""),12==t.length?1==syn.$v.regexs.onesPhone.test(t)?e.value=t.substr(0,4).concat("-",t.substr(4,4),"-",t.substr(8,4)):e.value="":9==t.length?1==syn.$v.regexs.seoulPhone.test(t)?e.value=t.substr(0,2).concat("-",t.substr(2,3),"-",t.substr(5,4)):e.value="":10==t.length?"02"==t.substring(0,2)?1==syn.$v.regexs.seoulPhone.test(t)?e.value=t.substr(0,2).concat("-",t.substr(2,4),"-",t.substr(6,4)):e.value="":1==syn.$v.regexs.areaPhone.test(t)?e.value=t.substr(0,3).concat("-",t.substr(3,3),"-",t.substr(6,4)):e.value="":11==t.length&&(1==syn.$v.regexs.areaPhone.test(t)||1==syn.$v.regexs.mobilePhone.test(t))?e.value=t.substr(0,3).concat("-",t.substr(3,4),"-",t.substr(7,4)):e.value="",""==e.value)&&e.setAttribute("placeholder","전화번호 확인 필요")},event_mobilephone_blur(e){var e=e.target||e.srcElement||e,t=(e.value=e.value.replace(/-/g,""),e.value);0<t.length&&(e.setAttribute("placeholder",""),1==syn.$v.regexs.mobilePhone.test(t)?10==t.length?e.value=t.substr(0,3).concat("-",t.substr(3,3),"-",t.substr(6,4)):11==t.length?e.value=t.substr(0,3).concat("-",t.substr(3,4),"-",t.substr(7,4)):e.value="":e.value="",""==e.value)&&e.setAttribute("placeholder","전화번호 확인 필요")},event_phone_blur(e){var e=e.target||e.srcElement||e,t=(e.value=e.value.replace(/-/g,""),e.value);0<t.length&&(e.setAttribute("placeholder",""),1==syn.$v.regexs.mobilePhone.test(t)?10==t.length?e.value=t.substr(0,3).concat("-",t.substr(3,3),"-",t.substr(6,4)):11==t.length?e.value=t.substr(0,3).concat("-",t.substr(3,4),"-",t.substr(7,4)):e.value="":12==t.length?1==syn.$v.regexs.onesPhone.test(t)?e.value=t.substr(0,4).concat("-",t.substr(4,4),"-",t.substr(8,4)):e.value="":9==t.length?1==syn.$v.regexs.seoulPhone.test(t)?e.value=t.substr(0,2).concat("-",t.substr(2,3),"-",t.substr(5,4)):e.value="":10==t.length?"02"==t.substring(0,2)?1==syn.$v.regexs.seoulPhone.test(t)?e.value=t.substr(0,2).concat("-",t.substr(2,4),"-",t.substr(6,4)):e.value="":1==syn.$v.regexs.areaPhone.test(t)?e.value=t.substr(0,3).concat("-",t.substr(3,3),"-",t.substr(6,4)):e.value="":11==t.length&&(1==syn.$v.regexs.areaPhone.test(t)||1==syn.$v.regexs.mobilePhone.test(t))?e.value=t.substr(0,3).concat("-",t.substr(3,4),"-",t.substr(7,4)):e.value="",""==e.value)&&e.setAttribute("placeholder","전화번호 확인 필요")},event_email_blur(e){var e=e.target||e.srcElement||e,t=e.value;0<e.value.length&&(e.setAttribute("placeholder",""),0==syn.$v.regexs.email.test(t))&&(e.setAttribute("placeholder","이메일 확인 필요"),e.value="")},event_year_blur(e){e=e.target||e.srcElement||e;0<e.value.length&&(e.setAttribute("placeholder",""),"0000"!=e.value&&0!=$date.isDate(e.value)||(e.setAttribute("placeholder","년도 확인 필요"),e.value=""))},event_yearmonth_blur(e){e=e.target||e.srcElement||e;0<e.value.length&&(e.setAttribute("placeholder",""),"0000-00"!=e.value&&0!=$date.isDate(e.value+"-01")||(e.setAttribute("placeholder","년월 확인 필요"),e.value=""))},event_date_blur(e){var t,e=e.target||e.srcElement||e;0<e.value.length&&(e.setAttribute("placeholder",""),8==(t=e.value).length&&(t=t.substring(0,4)+"-"+t.substring(4,6)+"-"+t.substring(6,8)),1==$date.isDate(t)?e.value=t:(e.setAttribute("placeholder","일자 확인 필요"),e.value=""))},event_juminno_blur(e){var e=e.target||e.srcElement||e,t=e.value;0<t.length&&(e.setAttribute("placeholder",""),0==syn.$v.regexs.juminNo.test(t)?(e.setAttribute("placeholder","주민등록번호 확인 필요"),e.value=""):(13==t.length&&(t=t.substring(0,6)+"-"+t.substring(6,13)),e.value=t))},event_businessno_blur(e){var e=e.target||e.srcElement||e,t=e.value;0<t.length&&(e.setAttribute("placeholder",""),0==syn.$w.isBusinessNo(t)?(e.setAttribute("placeholder","사업자번호 확인 필요"),e.value=""):(12!=t.length&&(t=(t=t.replace(/-/gi,"")).substring(0,3)+"-"+t.substring(3,5)+"-"+t.substring(5)),e.value=t))},event_corporateno_blur(e){var e=e.target||e.srcElement||e,t=e.value;0<t.length&&(e.setAttribute("placeholder",""),0==$string.isCorporateNo(t)?(e.setAttribute("placeholder","법인번호 확인 필요"),e.value=""):(14!=t.length&&(t=(t=t.replace(/-/gi,"")).substring(0,6)+"-"+t.substring(6)),e.value=t))},rangeMoveCaret(e){var t=e.target?e.srcElement:e,n=t.value.length,r=function(){var e;"email"!=t.type&&t.setSelectionRange?t.setSelectionRange(0,n):t.createTextRange&&((e=t.createTextRange()).collapse(!0),e.moveEnd("character",n),e.moveStart("character",0),e.select())};(syn.$b.isIE?r:()=>{setTimeout(r,0)})()},getValue(e){var t="",n=syn.$l.get(e);if(0==$object.isNullOrUndefined(n)){var r=JSON.parse(n.getAttribute("syn-options"));switch(r.editType){case"text":case"english":case"number":case"spinner":case"date":case"hour":case"minute":case"yearmonth":case"homephone":case"mobilephone":case"email":case"juminno":case"businessno":case"corporateno":var i=s[syn.$w.pageScript];(!0!==r.getter||!i.hook.frameEvent||(t=i.hook.frameEvent("controlGetValue",{elID:e,value:n.value}),1==$object.isNullOrUndefined(t)))&&(t=n.value);break;case"numeric":t=n.value.replace(/,/g,"");break;default:t=""}}return t},setValue(e,t){var n=syn.$l.get(e);if(0==$object.isNullOrUndefined(n))if(null!=t){var r=JSON.parse(n.getAttribute("syn-options"));switch(r.editType){case"text":case"english":case"number":case"spinner":case"date":case"hour":case"minute":case"yearmonth":case"homephone":case"mobilephone":case"email":case"juminno":case"businessno":case"corporateno":var i=s[syn.$w.pageScript];r&&!0===r.setter&&i.hook.frameEvent?(i=i.hook.frameEvent("controlSetValue",{elID:e,value:t}),1==$object.isNullOrUndefined(i)&&(n.value=i)):n.value=t;break;case"numeric":-1<t.indexOf(",")?n.value=t:n.value=1==$string.isNumber(t)?$string.toCurrency(t):t;break;default:n.value=""}}else{var o=syn.$w.getTriggerOptions(e);o&&o.value&&(n.value=o.value)}},clear(e,t){var n,e=syn.$l.get(e);0==$object.isNullOrUndefined(e)&&(n=JSON.parse(e.getAttribute("syn-options")),e.value=$object.defaultValue(n.dataType))},setLocale(e,t,n,r){var i,e=syn.$l.get(e),o=$resource.getBindSource(n,"placeholder");null!=o&&(n=$resource.translateText(n,r),e[o]=n,"placeholder"==o?(i=JSON.parse(e.getAttribute("syn-options")))&&(i.placeText=n,0==$object.isEmpty(i.placeText)&&superplaceholder({el:e,sentences:1==$object.isString(i.placeText)?[i.placeText]:i.placeText}),e.setAttribute("syn-options",JSON.stringify(i))):"controlText"==o&&(i=JSON.parse(e.getAttribute("syn-options")))&&(i.controlText=n,e.setAttribute("syn-options",JSON.stringify(i))))}}),syn.uicontrols.$textbox=i}(window),!function(o){syn.uicontrols=syn.uicontrols||new syn.module;var s=syn.uicontrols.$sourceeditor||new syn.module;s.extend({name:"syn.uicontrols.$sourceeditor",version:"1.0.0",editorPendings:[],editorControls:[],defaultSetting:{width:"100%",height:"360px",language:"javascript",minimap:{enabled:!1},roundedSelection:!1,scrollBeyondLastLine:!1,readOnly:!1,lineNumbers:"on",theme:"vs-dark",dataType:"string",basePath:"/lib/monaco-editor-0.39.0/vs",isLoadScript:!1,belongID:null,controlText:null,validators:null,transactConfig:null,triggerConfig:null},controlLoad(e,t){var n;o.monaco?s.awaitControlLoad(e,t):(0==s.defaultSetting.isLoadScript&&(s.defaultSetting.isLoadScript=!0,o.require?require.config({paths:{vs:s.defaultSetting.basePath},"vs/nls":{availableLanguages:{"*":"ko"}}}):o.require={paths:{vs:s.defaultSetting.basePath},"vs/nls":{availableLanguages:{"*":"ko"}}},syn.$w.loadScript(s.defaultSetting.basePath+"/loader.js"),syn.$w.loadScript(s.defaultSetting.basePath+"/editor/editor.main.nls.ko.js"),syn.$w.loadScript(s.defaultSetting.basePath+"/editor/editor.main.js")),n=setInterval(function(){if(o.monaco){for(var e=s.editorPendings.length,t=0;t<e;t++){var n=s.editorPendings[t];clearInterval(n.intervalID),s.awaitControlLoad(n.elID,n.setting)}s.editorPendings.length=0}},25),s.editorPendings.push({elID:e,setting:t,intervalID:n}))},awaitControlLoad(e,t){var n=syn.$l.get(e),r=(t=syn.$w.argumentsExtend(s.defaultSetting,t),o[syn.$w.pageScript]),r=(r&&r.hook.controlInit&&(r=r.hook.controlInit(e,t),t=syn.$w.argumentsExtend(t,r)),n.setAttribute("id",n.id+"_hidden"),n.setAttribute("syn-options",JSON.stringify(t)),n.style.display="none",n.parentNode),i=document.createElement("div"),n=(i.id=e,i.setAttribute("syn-datafield",n.getAttribute("syn-datafield")),i.setAttribute("syn-options",n.getAttribute("syn-options")),syn.$m.setStyle(i,"width",t.width),syn.$m.setStyle(i,"height",t.height),r.appendChild(i),monaco.editor.create(i,t));n.onKeyDown(function(e){"Space"===e.code&&!0===e.ctrlKey&&e.preventDefault()}),syn.$l.addEvent(o,"resize",s.window_onresize),s.editorControls.push({id:e,editor:n,setting:$object.clone(t)})},window_onresize(){for(var e=s.editorControls.length,t=0;t<e;t++){var n=s.editorControls[t],n=s.getControl(n.id);n&&n.editor&&(result=n.editor.layout())}},getValue(e,t){var n="",r=syn.$l.get(e);return n=0==$object.isNullOrUndefined(r)&&(r=s.getControl(e))&&r.editor?r.editor.getValue():n},setValue(e,t,n){var r=syn.$l.get(e);0==$object.isNullOrUndefined(r)&&(r=s.getControl(e))&&r.editor&&r.editor.setValue(t)},clear(e,t){var n=syn.$l.get(e);0==$object.isNullOrUndefined(n)&&(n=s.getControl(e))&&n.editor&&n.editor.setValue("")},applyEdits(e,t){var n;e&&(n=syn.$l.get(elID),0==$object.isNullOrUndefined(n))&&(n=s.getControl(elID))&&n.editor&&(null==t&&(t=n.editor.getPosition()),n.editor.getModel().applyEdits([{range:monaco.Range.fromPositions(t),text:e}]))},getValueInRange(e){var t=null,n=syn.$l.get(elID);return 0==$object.isNullOrUndefined(n)&&(n=s.getControl(elID))&&n.editor&&(null==e&&(e=n.editor.getPosition()),t=n.editor.getModel().getValueInRange(e)),t},getContentLine(e){if(e){var t=0,n=syn.$l.get(elID);if(0==$object.isNullOrUndefined(n)){n=s.getControl(elID);if(n&&n.editor)for(var r=n.editor.getValue().split("\n"),i=r.length,o=0;o<i;o++)if(-1<r[o].indexOf(e)){t=o+1;break}}return t}},setSelection(e){var t;e&&(t=syn.$l.get(elID),0==$object.isNullOrUndefined(t))&&(t=s.getControl(elID))&&t.editor&&t.editor.setSelection(e)},revealLine(e){var t,n=syn.$l.get(elID);0==$object.isNullOrUndefined(n)&&(n=s.getControl(elID))&&n.editor&&(e&&(e=(t=n.editor.getModel().getLineCount())<e?t:e),n.editor.revealLine(e))},findSelection(e){var t;e&&(t=syn.$l.get(elID),0==$object.isNullOrUndefined(t))&&(t=s.getControl(elID))&&t.editor&&(t.editor.trigger(e,"actions.find"),t.editor.trigger(e,"actions.findWithSelection"),t.editor.trigger(e,"editor.action.nextMatchFindAction"),t.editor.trigger("keyboard","closeFindWidget"))},layoutResize(e){var t=syn.$l.get(e);0==$object.isNullOrUndefined(t)&&(t=s.getControl(e))&&t.editor&&t.editor.layout()},getActions(e){var t=null,n=syn.$l.get(e);return t=0==$object.isNullOrUndefined(n)&&(n=s.getControl(e))&&n.editor?n.editor.getActions():t},getControl(e){for(var t=null,n=s.editorControls.length,r=0;r<n;r++){var i=s.editorControls[r];if(i.id==e){t=i;break}}return t},setLocale(e,t,n,r){}}),syn.uicontrols.$sourceeditor=s}(window),!function(){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var d=syn.uicontrols.$htmleditor||new syn.module;d.extend({name:"syn.uicontrols.$htmleditor",version:"1.0.0",applicationID:"",editorControls:[],defaultSetting:{applicationID:"",selector:"",fileManagerServer:"",repositoryID:null,dependencyID:null,relative_urls:!1,remove_script_host:!1,convert_urls:!1,isNumberTempDependency:!0,height:300,imageFileSizeLimit:3e5,viewerHtml:'<html><head><base href="/"><style type="text/css">body { font-family: \'맑은 고딕\', 돋움체; font-size: 12px; }</style><link type="text/css" rel="stylesheet" href="/lib/tinymce-5.6.0/skins/ui/oxide/content.min.css"><link type="text/css" rel="stylesheet" href="/lib/tinymce-5.6.0/skins/content/default/content.min.css"></head><body id="tinymce" class="mce-content-body">{0}<script>document.onselectstart = function () { return false; }; document.oncontextmenu = function () { return false; }; document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A" && !(e.ctrlKey && !e.altKey)) {e.preventDefault();}}}, false);<\/script></body></html>',language:"ko_KR",plugins:["autolink link image lists print hr anchor pagebreak searchreplace visualblocks visualchars code insertdatetime media nonbreaking table paste advcode help"],toolbar:"styleselect | bold italic forecolor backcolor table | alignleft aligncenter alignright | link image | code help",menubar:!1,content_style:"body { font-family: '맑은 고딕', 돋움체; font-size: 12px; }",powerpaste_word_import:"merge",powerpaste_googledocs_import:"merge",defaultHtmlContent:null,table_default_attributes:{border:"1",width:"100%"},table_default_styles:{"border-collapse":"collapse",width:"100%"},table_responsive_width:!1,limitTableWidth:null,verify_html:!1,table_sizing_mode:"fixed",images_file_types:"jpeg,jpg,png,gif,bmp,webp,JPEG,JPG,PNG,GIF,BMP,WEBP",paste_data_images:!0,resize:!1,allowExternalLink:!1,prefixHtml:"",suffixHtml:"",limitGuideLineWidth:"",dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,n,r){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:r})},controlLoad(u,c){var a=syn.$l.get(u),e=(c=syn.$w.argumentsExtend(d.defaultSetting,c),window[syn.$w.pageScript]),e=(e&&e.hook.controlInit&&(e=e.hook.controlInit(u,c),c=syn.$w.argumentsExtend(c,e)),0==$string.isNullOrEmpty(c.repositoryID)?(1==$string.isNullOrEmpty(d.applicationID)&&(d.applicationID=syn.$w.User.ApplicationID),1==$string.isNullOrEmpty(d.applicationID)&&syn.$l.eventLog("$htmleditor.controlLoad","파일 컨트롤 초기화 오류, 파일 업무 ID 정보 확인 필요","Information"),syn.Config&&syn.Config.FileManagerServer&&(c.fileManagerServer=syn.Config.FileManagerServer),1==$string.isNullOrEmpty(c.fileManagerServer)&&syn.$l.eventLog("$htmleditor.fileManagerServer","HTML 편집기 업로드 초기화 오류, 파일 서버 정보 확인 필요","Information"),1==$string.isNullOrEmpty(c.dependencyID)&&(1==c.isNumberTempDependency?c.dependencyID=$date.toTicks(new Date).toString():c.dependencyID=syn.uicontrols.$fileclient.getTemporaryDependencyID(u)),c.images_upload_handler=function(t,n,r){function i(i,n,o){var s=syn.$w.xmlHttp(),e=(s.withCredentials=!1,c.fileManagerServer+"/repository/api/storage/upload-file?RepositoryID={0}&DependencyID={1}".format(c.repositoryID,c.dependencyID));0==$string.isNullOrEmpty(d.applicationID)&&(e=e+"&applicationID="+d.applicationID),s.open("POST",e),s.onload=function(){if(200!=s.status)e="HTTP Error code: {0}, text: {1}".format(s.status,s.statusText),syn.$l.eventLog("$htmleditor.images_upload_handler",e,"Warning"),o(e);else try{var t,e,r=JSON.parse(s.responseText);r&&1==r.Result?(syn.$r.path=c.fileManagerServer+"/repository/api/storage/action-handler",syn.$r.params.action="GetItem",syn.$r.params.repositoryID=c.repositoryID,syn.$r.params.itemID=r.ItemID,0==$string.isNullOrEmpty(d.applicationID)&&(syn.$r.params.applicationID=d.applicationID),(t=syn.$w.xmlHttp()).onreadystatechange=function(){var e;t.readyState===XMLHttpRequest.DONE&&(200===t.status?(e=JSON.parse(t.responseText),r.location=e.AbsolutePath,n(r.location),setTimeout(function(){var e,t,n=tinymce.activeEditor.$('img[src$="'+r.location+'"]');0<n.length&&(e=i.width,t=i.height,tinymce.activeEditor.dom.setStyle(n,"width",e),tinymce.activeEditor.dom.setStyle(n,"height",t),n.attr("width",e),n.attr("height",t),n.after("&nbsp;"))},100)):syn.$l.eventLog("$htmleditor.images_upload_handler","async url: "+url+", status: "+t.status.toString()+", responseText: "+t.responseText,"Error"))},t.open("GET",syn.$r.url(),!0),t.send()):(e=r.Message,syn.$w.alert("이미지 업로드 실패: {0}".format(e)),syn.$l.eventLog("$htmleditor.images_upload_handler",e,"Warning"),o(e))}catch(e){syn.$w.alert("이미지 업로드 오류: {0}".format(e.message)),syn.$l.eventLog("$htmleditor.images_upload_handler",e,"Warning"),o(e)}},s.onerror=function(){var e="HTTP Error code: {0}, text: {1}".format(s.status,s.statusText);syn.$l.eventLog("$htmleditor.images_upload_handler",e,"Warning"),o(e)},(e=new FormData).append("file",i.blob,i.fileName),s.send(e)}var e=t.blob().size;if(c.imageFileSizeLimit<e){var e="에디터에 표시 가능한 이미지 파일크기는 {0} 미만입니다".format($number.toByteString(c.imageFileSizeLimit)),o=(syn.$w.alert(e),t.blobUri()),e=(syn.$r.revokeBlobUrl(o),r(e),tinymce.activeEditor.$('img[src$="'+o+'"]'));0<e.length&&e.remove()}else try{var s=window[syn.$w.pageScript].event["{0}_beforeUploadImageResize".format(u)];s?s.apply(a,[u,t,e=>{i({blob:e.blob,width:e.width,height:e.height,fileName:t.filename()},n,r)}]):d.resizeImage(t.blob(),0).then(e=>{i({blob:e.blob,width:e.width,height:e.height,fileName:t.filename()},n,r),syn.uicontrols.$htmleditor.getHtmlEditor(u).execCommand("mceRepaint")})}catch(e){syn.$l.eventLog("$htmleditor.images_upload_handler",e.toString(),"Error")}}):syn.$l.eventLog("$htmleditor.fileManagerServer",u+": HTML 편집기내 이미지 파일 업로드 사용 안함","Debug"),c.paste_preprocess=function(e,t){},c.paste_postprocess=function(e,t){if(t.node.firstElementChild&&"TABLE"==t.node.firstElementChild.tagName&&0==(t.mode&&"merge"==t.mode)){var t=t.node.firstElementChild,n=(t.border="1",t.cellspacing="0",t.cellpadding="0",syn.$m.setStyle(t,"border-collapse","collapse"),t.querySelectorAll("thead tr:first-child td")),r=n.length;if(0<r)for(var i=0;i<r;i++){var o=n[i];syn.$m.setStyle(o,"background-color","#ecf0f1")}else if(0<(r=(n=t.querySelectorAll("tr:first-child td")).length))for(i=0;i<r;i++){o=n[i];syn.$m.setStyle(o,"background-color","#ecf0f1")}}},c.width=a.style.width||320,c.height=a.style.height||240,a.setAttribute("id",a.id+"_hidden"),a.setAttribute("syn-options",JSON.stringify(c)),a.style.display="none",a.parentNode),t=document.createElement("div");t.style.width=c.width,t.style.height=c.height,t.id=u,t.innerHTML=1==$string.isNullOrEmpty(a.innerHTML)?"<div></div>":a.innerHTML,e.appendChild(t),c.selector="#"+u,c.init_instance_callback=function(a){var l=syn.$l.get(u),e=l.getAttribute("setInitValue");e&&a.setContent(e),a.on("keydown",function(e){9==(e.keyCode||e.which)&&(a.execCommand("mceInsertContent",!1,"&nbsp;&nbsp;&nbsp;&nbsp;"),tinymce.dom.Event.cancel(e),e.preventDefault())}),a.on("ObjectResized",function(e){if("TABLE"==e.target.nodeName)for(var t=e.target,n=(0==$string.isNullOrEmpty(c.limitTableWidth)&&c.limitTableWidth<t.style.width&&(t.style.width=c.limitTableWidth),0==$string.isNullOrEmpty(t.style.width)&&t.setAttribute("width",t.style.width),0==$string.isNullOrEmpty(t.style.height)&&t.setAttribute("height",t.style.height),e.target.querySelectorAll("td")),r=n.length,i=0;i<r;i++){var o=n[i];0==$string.isNullOrEmpty(o.style.width)&&o.setAttribute("width",o.style.width),0==$string.isNullOrEmpty(o.style.height)&&o.setAttribute("height",o.style.height)}var s;"IMG"==e.target.nodeName&&(t=tinymce.activeEditor.selection.getNode(),s=window[syn.$w.pageScript].event["{0}_imageResized".format(u)])&&s.apply(l,[u,e,a,t])}),0==$string.isNullOrEmpty(c.defaultHtmlContent)&&a.setContent(c.defaultHtmlContent),d.editorControls.push({id:u,editor:a,setting:$object.clone(c)}),1==c.readonly&&Array.from(a.getDoc().querySelectorAll("a")).map(function(e){e.target="_blank"}),1==c.readonly&&1==c.allowExternalLink&&Array.from(a.getDoc().querySelectorAll(".mce-object-iframe")).map(function(e){e.setAttribute("data-mce-selected","2")});e=window[syn.$w.pageScript].event["{0}_documentReady".format(u)];e&&e.apply(l,[u,a])},tinymce.init(c),0==$string.isNullOrEmpty(c.limitGuideLineWidth)&&syn.$l.get(u).controlPseudoStyle(" + div .tox-edit-area:after",'{content: "";width: 2px;height: 100%;background: #EF4444 repeat-y;top: 0px;left: {0};position: absolute;display: inline-block;}'.format(c.limitGuideLineWidth)),c.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(u,c.bindingID)},resizeImage(r,n){function i(){var e=s.width,t=s.height;return t<e?n<=0?(n=600)<e&&(t*=n/e,e=n):n<e&&(t*=n/e,e=n):n<=0?(n=600)<t&&(e*=n/t,t=n):n<t&&(e*=n/t,t=n),a.width=e,a.height=t,a.getContext("2d").drawImage(s,0,0,e,t),{blob:function(e){for(var t=(0<=e.split(",")[0].indexOf("base64")?atob:decodeURIComponent)(e.split(",")[1]),e=e.split(",")[0].split(":")[1].split(";")[0],n=t.length,r=new Uint8Array(n),i=0;i<n;i++)r[i]=t.charCodeAt(i);return new Blob([r],{type:e||"image/jpeg"})}(a.toDataURL("image/jpeg")),width:e,height:t}}var o=new FileReader,s=new Image,a=document.createElement("canvas");return new Promise(function(t,e){var n=r.blob();n.type.match(/image.*/)?(o.onload=function(e){s.onload=function(){return t(i())},s.src=e.target.result},o.readAsDataURL(n)):e(new Error("이미지 파일 확인 필요"))})},getHtmlEditor(e){for(var t=null,n=d.editorControls.length,r=0;r<n;r++){var i=d.editorControls[r];if(i.id==e){t=i.editor;break}}return t},getHtmlSetting(e){for(var t=null,n=d.editorControls.length,r=0;r<n;r++){var i=d.editorControls[r];if(i.id==e){t=i.setting;break}}return t},setMode(e,t){e=d.getHtmlEditor(e);e&&e.setMode(t)},insertContent(e,t){e=d.getHtmlEditor(e);e&&e.insertContent(t)},execCommand(e,t,n,r,i){var o=!1,e=d.getHtmlEditor(e);return e&&(1==$object.isNullOrUndefined(n)&&(n=!1),o=e.execCommand(t,n,r,i)),o},isDirty(e){var t=!1,e=d.getHtmlEditor(e);return t=e?e.isDirty():t},updateDependencyID(e,t,n){e=d.getHtmlSetting(e);syn.$r.path=e.fileManagerServer+"/repository/api/storage/action-handler",syn.$r.params.action="UpdateDependencyID",syn.$r.params.repositoryID=e.repositoryID,syn.$r.params.sourceDependencyID=e.dependencyID,syn.$r.params.targetDependencyID=t,syn.uicontrols.$fileclient.executeProxy(syn.$r.url(),n)},getDependencyID(e){var t="",e=d.getHtmlSetting(e);return t=e?e.dependencyID:t},setDependencyID(e,t){e=d.getHtmlSetting(e);e&&(e.dependencyID=t)},getValue(e,t){var n=null,r=d.getHtmlEditor(e);if(r){var n=r.getContent(),i=d.getHtmlSetting(e);if(0==$string.isNullOrEmpty(i.limitTableWidth)){var o=n.match(/<table[^>]*>(.*?)/gim);if(0==$string.isNullOrEmpty(o))for(var s=0;s<o.length;s++){var a=o[s];-1==a.indexOf("width=")&&(n=n.replace(a,a.substring(0,a.length-1)+' width="{0}">'.format(i.limitTableWidth)))}}0==$string.isNullOrEmpty(i.prefixHtml)&&(n=i.prefixHtml+n),0==$string.isNullOrEmpty(i.suffixHtml)&&(n+=i.suffixHtml)}return n=(n=(n=(n=(n=n.replace(/&amp;/gm,"&")).replace(/\<p\>\<\/p\>/gm,"<p>&nbsp;</p>")).replace(/\<p style="text-align: left;"\>\<\/p\>/gm,'<p style="text-align: left;">&nbsp;</p>')).replace(/\<p style="text-align: center;"\>\<\/p\>/gm,'<p style="text-align: center;">&nbsp;</p>')).replace(/\<p style="text-align: right;"\>\<\/p\>/gm,'<p style="text-align: right;">&nbsp;</p>')},setValue(e,t,n){var r=d.getHtmlEditor(e),i=syn.$l.get("{0}_hidden".format(e)).getAttribute("syn-options");0==$object.isNullOrUndefined(i)&&(i=JSON.parse(i),0==$string.isNullOrEmpty(i.prefixHtml)&&0==$string.isNullOrEmpty(i.prefixHtml)&&1==t.startsWith(i.prefixHtml)&&(t=t.replace(i.prefixHtml,"")),0==$string.isNullOrEmpty(i.suffixHtml))&&0==$string.isNullOrEmpty(i.suffixHtml)&&1==t.endsWith(i.suffixHtml)&&(t=t.replace(i.suffixHtml,"")),r?r.setContent(t):syn.$l.get(e).setAttribute("setInitValue",t)},clear(e,t){e=d.getHtmlEditor(e);e&&e.setContent("")},setLocale(e,t,n,r){}}),syn.uicontrols.$htmleditor=d}(),!function(window){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var $tree=syn.uicontrols.$tree||new syn.module;$tree.extend({name:"syn.uicontrols.$tree",version:"1.0.0",treeControls:[],eventHooks:["blurTree","focusTree","activate","beforeActivate","beforeExpand","beforeSelect","blur","click","collapse","createNode","dblclick","expand","focus","keydown","keypress"],defaultSetting:{width:"100%",height:"300px",itemID:"id",parentItemID:"parentID",childrenID:"children",reduceMap:{key:"key",title:"title",parentID:"parentID",folder:"folder",icon:!1},toggleEffect:!1,checkbox:!1,extensions:["persist","filter"],persist:{expandLazy:!1,expandOpts:{noAnimation:!1,noEvents:!1},overrideSource:!0,store:"session",types:"active expanded focus selected"},multi:{mode:"sameParent"},filter:{counter:!1,mode:"hide"},source:[],dataType:"string",belongID:null,getter:!1,setter:!1,controlText:null,validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,n,r){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:r})},controlLoad(elID,setting){var el=syn.$l.get(elID),mod=($tree.defaultSetting.persist=!1,$tree.defaultSetting.multi=!1,setting=syn.$w.argumentsExtend($tree.defaultSetting,setting),window[syn.$w.pageScript]),moduleSettings,hookEvents=(mod&&mod.hook.controlInit&&(moduleSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleSettings)),setting.width=el.style.width||setting.width,setting.height=el.style.height||setting.height,el.setAttribute("id",elID+"_hidden"),el.setAttribute("syn-options",JSON.stringify(setting)),el.style.display="none",el.getAttribute("syn-events"));try{hookEvents=hookEvents&&eval(hookEvents)}catch(error){syn.$l.eventLog("TreeView_controlLoad",error.toString(),"Debug")}for(var i=0;i<hookEvents.length;i++){var hookEvent=hookEvents[i];-1<$tree.eventHooks.indexOf(hookEvent)&&1==$object.isNullOrUndefined(setting[hookEvent])&&(setting[hookEvent]=function(t,e){var n=$tree.eventHooks.find(function(e){return e.toLowerCase()==t.type.replace("fancytree","")}),r=window[syn.$w.pageScript];r&&(r=r.event?r.event["{0}_{1}".format(elID,n)]:null)&&r.apply(syn.$l.get(elID),[t,e])})}var parent=el.parentNode,wrapper=document.createElement("div");wrapper.style.width=setting.width,wrapper.style.height=setting.height,wrapper.className="tree-container border",wrapper.innerHTML='<div id="'+elID+'"></div>',parent.appendChild(wrapper),$tree.treeControls.push({id:elID,element:$("#"+elID).fancytree(setting),tree:$.ui.fancytree.getTree("#"+elID),config:setting}),setting.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(elID,setting.bindingID)},getValue(e,t){var n=null,r=$tree.getControl(e).tree;if(r){for(var e=$tree.getControl(e).config,i=e.reduceMap,r=r.toDict(!0),o=syn.$l.nested2Flat(r,e.itemID,e.parentItemID,e.childrenID),s=[],a=o.length,l=0;l<a;l++){var u=o[l],c=u.data;c&&(c[i.key]=u.key,c[i.title]=u.title,c[i.parentID]=u.parentID,c[i.folder]=u.folder,s.push(c))}n=s}return n},setValue(e,t,n){var r=$tree.getControl(e).tree;if(r){for(var e=$tree.getControl(e).config,i=e.reduceMap,o=[],s=t.length,a=0;a<s;a++){var l=t[a];o.push({key:l[i.key],title:l[i.title],parentID:l[i.parentID],folder:$string.toBoolean(l[i.folder]),icon:!1,data:$object.clone(l,!1)})}e=syn.$l.flat2Nested(o,e.itemID,e.parentItemID,e.childrenID);r.reload([e])}},clear(e,t){e=$tree.getControl(e).tree;e&&e.reload([])},getControl(e){for(var t=null,n=$tree.treeControls.length,r=0;r<n;r++){var i=$tree.treeControls[r];if(i.id==e){t=i;break}}return t},getActiveNode(e){var t=null,e=$tree.getControl(e).tree;return t=e?e.getActiveNode():t},toogleEnabled(e){var t=!1,e=$tree.getControl(e).tree;return e&&(t=!e.options.disabled,e.enable(!t)),t},getRootNodeID(e){var t=null,e=$tree.getControl(e).tree;return t=e?e.rootNode.key.replace("root_",""):t},activateKey(e,t){1!=$object.isNullOrUndefined(t)&&(e=$tree.getControl(e).tree)&&e.activateKey(t)},expendLevel(e,t){1==$object.isNullOrUndefined(t)&&(t=1);e=$tree.getControl(e).tree;e&&e.visit(function(e){e.getLevel()<t&&e.setExpanded(!0)})},collapseLevel(e,t){1==$object.isNullOrUndefined(t)&&(t=1);e=$tree.getControl(e).tree;e&&e.visit(function(e){e.getLevel()<t&&e.setExpanded(!1)})},expandAll(e){e=$tree.getControl(e).tree;e&&e.expandAll()},collapseAll(e){e=$tree.getControl(e).tree;e&&e.expandAll(!1)},getSelectedNodes(e){var t=[],e=$tree.getControl(e).tree;return t=e?e.getSelectedNodes():t},filterNodes(e,t){e=$tree.getControl(e).tree;return e&&e.filterNodes(t,{autoExpand:!0}),[]},filterBranches(e,t){e=$tree.getControl(e).tree;return e&&e.filterBranches(t,{autoExpand:!0,leavesOnly:!0}),[]},clearFilter(e){var t=[],e=$tree.getControl(e).tree;return t=e?e.clearFilter():t},setSelectedAll(e,t){var n;return $tree.getControl(e).tree&&(n=t.isSelected(),t.visit(function(e){e.setSelected(n)})),[]},setLocale(e,t,n,r){}}),syn.uicontrols.$tree=$tree}(window),!function(window){"use strict";var textEditor,$grid=(window.Handsontable&&(textEditor=Handsontable.editors.TextEditor.prototype.extend(),Handsontable.validators.registerValidator("require",function(e,t){var n=!1,n=1!=$string.isNullOrEmpty(e);return t&&t(n),n}),Handsontable.cellTypes.registerCellType("codehelp",{editor:textEditor,renderer(e,t,n,r,i,o,s){var a,l;if(Handsontable.renderers.TextRenderer.apply(this,arguments),(l=document.createElement("SPAN")).textContent=o,a=document.createElement("BUTTON"),syn.$m.addCssText(a,"height: 21px;;"),syn.$m.addClass(a,"btn w:21px mt:1px float:right"),a.tag=[e,t,n,r,i,o,s],a.innerHTML='<i class="ti ti-search"></i>',Handsontable.dom.addEvent(a,"click",function(e){e.preventDefault();var e=e.currentTarget,n=e.tag[0],r=e.tag[2],i=e.tag[3],o=e.tag[4],s=n.getSettings().columns.filter(function(e){return e.data==o})[0],a=n.rootElement.id,e=syn.$w.argumentsExtend(syn.uicontrols.$codepicker.defaultSetting,s);e.elID=a,e.controlType="grid",syn.uicontrols.$codepicker.find(e,function(e){e&&s.codeColumnID&&s.textColumnID&&((t=[]).push([r,n.propToCol(s.codeColumnID),e[0].value]),t.push([r,i,e[0].text]),n.setDataAtCell(t));var t=window[syn.$w.pageScript].hook.frameEvent;t&&t.call(this,"codeReturn",{elID:a,row:r,col:i,columnName:o,result:e})})}),Handsontable.dom.empty(t),t.appendChild(a),t.appendChild(l),s&&s.className)for(var u=s.className.split(" "),c=0;c<u.length;c++){var d=u[c];""!=d&&syn.$m.addClass(t,d)}return t},validator(e,t){t(!0)},allowInvalid:!0}),Handsontable.cellTypes.registerCellType("button",{renderer(n,e,r,i,o,s,t){if(Handsontable.renderers.TextRenderer.apply(this,arguments),0==$string.isNullOrEmpty(s)){var a=n.getSettings().columns[i].columnOptions,l=document.createElement("BUTTON");if(l.classList.add("celltype"),a&&(1==a.clearBorder&&(l.style.border="0px",l.style.backgroundColor="transparent",l.style.textDecoration="underline"),a.color&&(l.style.color=a.color),1==a.bold)&&(l.style.fontWeight="900"),s.indexOf&&-1<s.indexOf("|")){var u,c=s.split("|");if(1<c[0].split(" ").length)for(u in c[0].split(" "))l.classList.add(u);else l.classList.add(c[0]);s=c[1]}if(l.tag=[n,e,r,i,o,s,t],l.setAttribute("data",s),l.textContent=a&&1==$string.toBoolean(a.toCurrency)?$string.toCurrency(s):s,syn.$l.addEvent(l,"click",function(e){e.preventDefault();var e=event.target||event.srcElement,t=window[syn.$w.pageScript].event["{0}_cellButtonClick".format(n.elID)];t&&t.apply(e,[n.elID,r,i,o,s])}),Handsontable.dom.empty(e),e.appendChild(l),t&&t.className)for(var d=t.className.split(" "),h=0;h<d.length;h++){var f=d[h];""!=f&&syn.$m.addClass(e,f)}}return e},validator(e,t){t(!0)},allowInvalid:!0}),Handsontable.cellTypes.registerCellType("safehtml",{editor:textEditor,renderer(e,t,n,r,i,o,s){var a,l,o=Handsontable.helper.stringify(o);if(a=o,l=((((l="<em><p><br><b><u><strong><a><big><img>")||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join(""),o=a.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,"").replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,function(e,t){return-1<l.indexOf("<"+t.toLowerCase()+">")?e:""}),t.innerHTML=o,s&&s.className)for(var u=s.className.split(" "),c=0;c<u.length;c++){var d=u[c];""!=d&&syn.$m.addClass(t,d)}return t},validator(e,t){t(!0)},allowInvalid:!0}),Handsontable.cellTypes.registerCellType("image",{editor:textEditor,renderer(e,t,n,r,i,o,s){var a;if(Handsontable.renderers.TextRenderer.apply(this,arguments),0===Handsontable.helper.stringify(o).indexOf("http")?((a=document.createElement("IMG")).src=o,Handsontable.dom.addEvent(a,"click",function(e){e.preventDefault()}),Handsontable.dom.empty(t),t.appendChild(a)):Handsontable.renderers.TextRenderer.apply(this,arguments),s&&s.className)for(var l=s.className.split(" "),u=0;u<l.length;u++){var c=l[u];""!=c&&syn.$m.addClass(t,c)}return t},validator(e,t){t(!0)},allowInvalid:!0}),Handsontable.cellTypes.registerCellType("radio",{renderer(u,e,c,d,h,t,n){Handsontable.renderers.TextRenderer.apply(this,arguments);var r="rdo_{0}_{1}_{2}".format(u.elID,c,d),i=document.createElement("INPUT");if(i.id=r,i.type="radio",syn.$m.addClass(i,"form-check-input"),t&&(!0===$string.toBoolean(t)?i.checked=!0:i.checked=!1),Handsontable.dom.addEvent(i,"click",function(e){e.preventDefault();var e=e.target||e.srcElement,t=window[syn.$w.pageScript],n=u.getSettings(),r=n.columns[d].readOnly,i=u.getCellMeta(c,d);if(!1===r&&0==i.readOnly){if(n.data&&0<n.data.length)for(var o,s=n.data,a=s.length,l=0;l<a;l++)1==$string.toBoolean(s[l][h])&&("R"==s[l].Flag&&(s[l].Flag="U"),s[l][h]=0,o=syn.$l.get("rdo_{0}_{1}_{2}".format(u.elID,l,d)))&&(o.checked=!1);u.setDataAtCell(c,d,!0===e.checked?"1":"0");r=t.event["{0}_cellRadioClick".format(u.elID)];r&&r.apply(e,[u.elID,c,d,h,!0===e.checked?"1":"0"]),u.render()}}),Handsontable.dom.empty(e),e.appendChild(i),n&&n.className)for(var o=n.className.split(" "),s=0;s<o.length;s++){var a=o[s];""!=a&&syn.$m.addClass(e,a)}return e},validator(e,t){t(!0)},allowInvalid:!0}),Handsontable.cellTypes.registerCellType("checkbox2",{renderer(i,e,o,s,a,t,n){Handsontable.renderers.TextRenderer.apply(this,arguments);var r="chk_syngrid_{0}_{1}_{2}".format(i.elID,o,s),l=document.createElement("INPUT");if(l.id=r,l.type="checkbox",syn.$m.addClass(l,"form-check-input"),t&&(!0===$string.toBoolean(t)?l.checked=!0:l.checked=!1),Handsontable.dom.addEvent(l,"click",function(e){e.preventDefault();var e=e.target||e.srcElement,t=window[syn.$w.pageScript],n=i.getSettings().columns[s].readOnly,r=i.getCellMeta(o,s);(0==n||0==r.readOnly)&&(i.setDataAtCell(o,s,!0===e.checked?"1":"0"),n=t.event["{0}_cellCheckboxClick".format(i.elID)])&&n.apply(e,[i.elID,o,s,a,!0===e.checked?"1":"0"])}),Handsontable.dom.empty(e),e.appendChild(l),n&&n.className)for(var u=n.className.split(" "),c=0;c<u.length;c++){var d=u[c];""!=d&&syn.$m.addClass(e,d)}return e},validator(e,t){t(!0)},allowInvalid:!0})),syn.uicontrols=syn.uicontrols||new syn.module,syn.uicontrols.$grid||new syn.module);$grid.extend({name:"syn.uicontrols.$grid",version:"1.0.0",defaultHotSettings:{licenseKey:"non-commercial-and-evaluation",language:"ko-KR",data:[],colWidths:120,rowHeights:31,rowHeaders:!0,copyPaste:!0,beforePaste(e,t){return!1},autoColumnSize:!1,stretchH:"none",undo:!1,observeChanges:!1,observeDOMVisibility:!0,currentRowClassName:"currentRow",manualColumnResize:!0,manualRowResize:!1,manualColumnMove:!1,manualRowMove:!1,manualColumnFreeze:!1,autoInsertRow:!1,isRemoveRowHidden:!0,autoWrapRow:!0,outsideClickDeselects:!0,selectionMode:"range",sortIndicator:!1,columnSorting:!0,wordWrap:!1,dropdownMenu:!1,filters:!0,isContainFilterHeader:!1,firstShowColIndex:null,lastShowColIndex:null,fillHandle:!1,contextMenu:{items:{copy:{name:"내용복사"},hidden_columns_hide:{name:"컬럼 숨김",callback(e,t,n){if(t&&0<t.length){for(var t=t[0],r=t.start.col,i=t.end.col,o=[];r<=i;r++)o.push(r);$grid.visibleColumns(this.elID,o,!1);t=window[syn.$w.pageScript];t&&(t=t.event?t.event["{0}_{1}".format(this.elID,"afterHiddenColumns")]:null)&&t.apply(syn.$l.get(this.elID),[o])}}},hidden_columns_show:{name:"컬럼 표시",callback(e,t,n){if(t&&0<t.length){for(var t=t[0],r=t.start.col,i=t.end.col,o=[];r<=i;r++)o.push(r);$grid.visibleColumns(this.elID,o,!0);t=window[syn.$w.pageScript];t&&(t=t.event?t.event["{0}_{1}".format(this.elID,"afterUnHiddenColumns")]:null)&&t.apply(syn.$l.get(this.elID),o)}}},columns_chooser:{name:"컬럼 표시 선택",callback(e,t,n){for(var o=this.elID,r=$object.clone(syn.$w.dialogOptions),i=(r.minWidth=240,r.minHeight=240,syn.$l.get("columnChooserHtml")),s=(i||((a=syn.$m.create({tag:"div",id:"columnChooserHtml"})).style.display="none",a.innerHTML='<h3 class="mt-0 mb-0">컬럼 표시 선택</h3><div class="btn-area"><input type="button" id="btnColumnApply" class="btn btn-primary" value="컬럼 표시 적용"></div><ul class="row" id="lstChooseColumns" style = "overflow: auto; height: 150px; width:360px; padding-top:10px; padding-left:10px;" > <li><input type="checkbox" id="a"><label for="a">컬럼명</label></li></ul>',document.body.appendChild(a),i=syn.$l.get("columnChooserHtml")),Handsontable.dom.addEvent(i.querySelector("#btnColumnApply"),"click",function(){for(var e=[],t=syn.$l.get("lstChooseColumns").children,n=0;n<t.length;n++){var r=t[n],i=r.children[0].id.split("_")[2],r=!r.children[0].checked;e.push({col:n,colID:i,isHidden:r})}syn.$w.closeDialog(e)}),i.querySelector("ul")),a=(s.innerHTML="",this.getSettings()),l=this.getSettings().colHeaders,u=a.columns,c=1;c<u.length;c++){var d=l[c],h=u[c],f=(document.createElement("li"),syn.$m.create({tag:"li",className:"col-12"})),p=(syn.$m.setStyle(f,"padding-top","10px"),"{0}_checkbox_{1}".format(o,h.data)),g=$grid.isColumnHidden(o,c),m=syn.$m.create({tag:"input",id:p,attributes:{type:"checkbox"}}),g=(m.checked=!g,syn.$m.create({tag:"label",id:"{0}_label_{1}".format(o,h.data),attributes:{for:p}}));syn.$m.setStyle(g,"padding-left","10px"),g.textContent=d,syn.$m.appendChild(f,m),syn.$m.appendChild(f,g),syn.$m.appendChild(s,f)}syn.$w.showDialog(syn.$l.get("columnChooserHtml"),r,function(e){if(e){for(var t=[],n=[],r=1;r<u.length;r++){var i=e[r-1];i&&(0==i.isHidden?t:n).push(r)}$grid.visibleColumns(o,t,!0),$grid.visibleColumns(o,n,!1)}})}}}},hiddenColumns:{columns:[0],indicators:!1},deleteKeyColumns:[],keyLockedColumns:[],summarys:[],exportColumns:[],transactConfig:null,triggerConfig:null},gridControls:[],handsontableHooks:null,gridHooks:[],gridCodeDatas:[],addModuleList(e,t,n,r){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:r})},controlLoad(elID,setting){for(var el=syn.$l.get(elID),moduleHotSettings,mod=(setting=syn.$w.argumentsExtend($grid.defaultHotSettings,setting),setting.columns&&(moduleHotSettings=$grid.getInitializeColumns(setting,elID),setting=syn.$w.argumentsExtend(setting,moduleHotSettings)),window[syn.$w.pageScript]),moduleHotSettings,isFlagColumn=(mod&&mod.hook.controlInit&&(moduleHotSettings=mod.hook.controlInit(elID,setting),setting=syn.$w.argumentsExtend(setting,moduleHotSettings)),setting.elementID=elID,setting.colHeaders=setting.colHeaders||["Flag","A","B","C"],-1==setting.colHeaders.indexOf("Flag")&&(setting.colHeaders.unshift("Flag"),setting.colWidths.unshift(10)),setting.columns=setting.columns||[{data:0},{data:1},{data:2},{data:3}],!1),columnCount=setting.columns.length,i=0;i<columnCount;i++){var column=setting.columns[i];if("Flag"==column.data){isFlagColumn=!0;break}}0==isFlagColumn&&setting.columns.unshift({data:"Flag",type:"text",readOnly:!0}),!0===setting.dropdownMenu?setting.dropdownMenu=["filter_by_condition","filter_operators","filter_by_condition2","filter_action_bar"]:setting.dropdownMenu=!1;var debounceFn=Handsontable.helper.debounce(function(e,t){var n=t.target||t.srcElement;e=$grid.getActiveColIndex(n.gridID);n=$grid.getGridControl(n.gridID).getPlugin("filters");0==n.isEnabled()&&n.enablePlugin(),n.clearConditions(e),0<t.target.value.length&&n.addCondition(e,"contains",[t.target.value]),n.filter()},100),isSummary=!1,parent=(setting.summarys&&0<setting.summarys.length?(isSummary=!0,setting.fixedRowsBottom=1,setting.cells=function(e,t,n){var r=this.instance;if(1==$grid.getGridValue(r.elID).applyCells){var i=r.getSettings();if(i.summarys&&0<i.summarys.length)if(e===i.data.length-1)return o={type:"text",readOnly:!0,className:"summaryRow"},(i=i.columns.find(function(e){return e.data==n}))&&i.className&&-1==i.className.indexOf(o.className)&&(o.className+=" "+i.className),o}i=window[syn.$w.pageScript];if(i){var o,i=i.event["{0}_applyCells".format(r.elID)];if(i)if(o=i.apply(r,[r.elID,e,t,n]))return o}}):setting.cells=function(e,t,n){var r=window[syn.$w.pageScript];if(r){var i=this.instance,r=r.event["{0}_applyCells".format(i.elID)];if(r){r=r.apply(i,[i.elID,e,t,n]);if(r)return r}}},setting.beforeColumnSort=function(e,t){var n,r=this.getSettings();r.summarys&&0<r.summarys.length&&($grid.getGridValue(this.elID).applyCells=!1,n=(r=this.getSettings()).data.find(function(e){return"S"==e.Flag}))&&-1<(n=r.data.indexOf(n))&&r.data.splice(n,1)},setting.afterColumnSort=function(e,t){var n=this.getSettings();n.summarys&&0<n.summarys.length&&$grid.renderSummary(this)},setting.afterGetColHeader=function(c,e){if("number"!=typeof c)return c;0<=c&&1==setting.isContainFilterHeader&&e.childElementCount<2&&(t=document.createElement("div"),d=document.createElement("input"),t.className="filterHeader",d.gridID=elID,Handsontable.dom.addEvent(d,"contextmenu",function(e){return Handsontable.dom.stopImmediatePropagation(e),e.preventDefault&&e.preventDefault(),!1}),Handsontable.dom.addEvent(d,"keydown",function(e){debounceFn(c,e)}),Handsontable.dom.addEvent(d,"focus",function(e){var t=window[syn.$w.pageScript];t&&(t.focusControl=syn.$l.get(d.gridID))}),t.appendChild(d),e.appendChild(t));var d,t=1==$object.isArray(setting.dropdownMenu)?3:2,h=setting.columns[c];h&&!0===h.isSelectAll&&(t+=2),0<=c&&h&&("checkbox"==h.type||"checkbox2"==h.type)&&!0===h.isSelectAll&&e.firstElementChild.childElementCount<t?3!=e.firstElementChild.childElementCount&&0==syn.$m.hasClass(e,"hiddenHeader")&&(t="chk_syngrid_All_{0}_{1}".format(elID,c),null!=syn.$l.get(t)&&(syn.$m.remove(syn.$l.get(t)),syn.$m.remove(syn.$l.querySelector('label[for="'+t+'"]'))),(d=document.createElement("input")).id=t,d.type="checkbox",d.setAttribute("columnSelectAll","1"),d.gridID=elID,d.checked=1==h.toogleChecked,syn.$m.addClass(d,"form-check-input"),Handsontable.dom.addEvent(d,"click",function(e){var t=e.target||e.srcElement,n=t.checked?"1":"0";h.toogleChecked=n;var r=window[syn.$w.pageScript].event["{0}_selectAllCheck".format(d.gridID)];if(r)r.apply(t,[d.gridID,c,$string.toBoolean(h.toogleChecked.toString())]),(i=$grid.getGridControl(t.gridID)).render();else{var i=$grid.getGridControl(t.gridID),r=$grid.getSettings(t.gridID);if(r.data&&0<r.data.length)for(var o=r.data,s=o.length,a=i.colToProp(c),l=0;l<s;l++){var u=o[l].Flag;"R"==u&&(o[l].Flag="U"),"S"!=u&&(o[l][a]=n)}i.render()}e.stopImmediatePropagation()}),syn.$m.prepend(d,e.firstElementChild)):(t=e.querySelector('input[type="checkbox"]'),0<=c&&h&&("checkbox"==h.type||"checkbox2"==h.type)&&null!=t&&(e.firstElementChild.removeChild(t),t=e.querySelector("label[for]"),e.firstElementChild.removeChild(t)))},1==setting.isContainFilterHeader&&(setting.className="contain-filter-header"),setting.width=setting.width||"100%",setting.height=setting.height||240,el.setAttribute("id",el.id+"_hidden"),el.setAttribute("syn-options",JSON.stringify(setting)),el.style.display="none",el.parentNode),wrapper=document.createElement("div"),fileEL=(1==isSummary&&syn.$m.addClass(wrapper,"summaryRow"),wrapper.id=elID,parent.appendChild(wrapper),document.createElement("input")),gridHookEvents=(fileEL.id="{0}_ImportFile".format(elID),fileEL.type="file",fileEL.style.display="none",fileEL.accept=".csv, .xls, .xlsx",Handsontable.dom.addEvent(fileEL,"change",$grid.importFileLoad),parent.appendChild(fileEL),el=syn.$l.get(elID),$grid.handsontableHooks||($grid.handsontableHooks=Handsontable.hooks.getRegistered()),$grid.gridHooks=["afterChange","afterCreateRow","afterRemoveRow","beforeOnCellMouseDown","afterSelectionEnd","beforeKeyDown"],syn.$l.get(el.id+"_hidden").getAttribute("syn-events"));try{gridHookEvents=gridHookEvents&&eval(gridHookEvents)}catch(error){syn.$l.eventLog("WebGrid_controlLoad",error.toString(),"Debug")}if(gridHookEvents)for(var i=0;i<gridHookEvents.length;i++){var hook=gridHookEvents[i];-1==$grid.gridHooks.indexOf(hook)&&$grid.gridHooks.push(hook)}$grid.gridHooks.forEach(function(hook){setting[hook]=function(){var elID=this.rootElement.id,$grid=syn.uicontrols.$grid,mod=window[syn.$w.pageScript],hot=$grid.getGridControl(elID);if(null!=hot){var defaultGridHooks=["afterChange","afterCreateRow","afterRemoveRow","beforeOnCellMouseDown","afterSelectionEnd","beforeKeyDown"],gridValue=$grid.getGridValue(elID),eventHandler,rowIndex,method_index,method_amount,method_rows,event,coords,td,gridValue,now,gridValue;if(-1==defaultGridHooks.indexOf(hook))1!=gridValue.passSelectCellEvent&&mod&&(eventHandler=mod.event?mod.event["{0}_{1}".format(elID,hook)]:null,eventHandler)&&eventHandler.apply(syn.$l.get(elID),arguments);else if(!gridValue||"afterChange"!=hook||"insertRow"!=gridValue.eventName&&"removeRow"!=gridValue.eventName){if("beforeKeyDown"==hook){var evt=arguments[0],selected,currentRow,currentCol,firstCol,lastCol,lastRow,selected,currentRow,currentCol,firstCol,lastCol,lastRow;1==evt.altKey&&13==evt.keyCode?Handsontable.dom.stopImmediatePropagation(evt):1==evt.shiftKey&&9==evt.keyCode?(selected=hot.getSelected()[0],currentRow=selected[0],currentCol=selected[1],firstCol=$grid.getFirstShowColIndex(elID),lastCol=$grid.getLastShowColIndex(elID),0<currentRow&&currentCol==firstCol?(Handsontable.dom.stopImmediatePropagation(evt),evt.preventDefault&&evt.preventDefault(),hot.selectCell(currentRow-1,lastCol)):0==currentRow&&currentCol==firstCol&&(Handsontable.dom.stopImmediatePropagation(evt),evt.preventDefault&&evt.preventDefault(),lastRow=hot.countRows()-1,-1<lastRow)&&hot.selectCell(lastRow,lastCol)):9==evt.keyCode&&(selected=hot.getSelected()[0],currentRow=selected[0],currentCol=selected[1],firstCol=$grid.getFirstShowColIndex(elID),lastCol=$grid.getLastShowColIndex(elID),lastRow=hot.countRows()-1,currentRow<lastRow&&currentCol==lastCol?(Handsontable.dom.stopImmediatePropagation(evt),evt.preventDefault&&evt.preventDefault(),hot.selectCell(currentRow+1,firstCol)):currentRow==lastRow&&currentCol==lastCol&&(Handsontable.dom.stopImmediatePropagation(evt),evt.preventDefault&&evt.preventDefault(),1==setting.autoInsertRow?($grid.insertRow(elID,{amount:1},function(e){hot.selectCell(e,firstCol)}),Handsontable.dom.stopImmediatePropagation(evt),evt.preventDefault&&evt.preventDefault()):hot.selectCell(0,firstCol)))}else if("afterChange"==hook||"afterCreateRow"==hook||"afterRemoveRow"==hook||"hiddenRow"==hook){if("afterChange"==hook&&"loadData"==arguments[1])return;if("afterChange"==hook&&"edit"==arguments[1]&&"Flag"==arguments[0][0][1])return;if("afterCreateRow"==hook)var method_index=arguments[0],method_amount=arguments[1],method_source=arguments[2],rowIndex=method_index;else if("afterChange"==hook){var method_changes=arguments[0],method_source=arguments[1];if(1==$object.isNullOrUndefined(method_changes))return;rowIndex=method_changes[0][0];var columnName=method_changes[0][1],changeValue=method_changes[0][3],columnInfos=hot.getSettings().columns,columnInfo=columnInfos.filter(function(e){return e.data==columnName})[0],oldValue;if("dropdown"==columnInfo.type){var dataSource=columnInfo.dataSource;if(dataSource)if(0==columnInfo.required&&""==changeValue)method_changes[0][4]="",hot.setDataAtCell(rowIndex,hot.propToCol(columnInfo.codeColumnID),"");else for(var j=0;j<dataSource.DataSource.length;j++){var item=dataSource.DataSource[j];if(item[dataSource.ValueColumnID]==changeValue){var code=item[dataSource.CodeColumnID];method_changes[0][4]=code,hot.setDataAtCell(rowIndex,hot.propToCol(columnInfo.codeColumnID),code);break}}}else{"codehelp"==columnInfo.type&&(oldValue=method_changes[0][2],""==changeValue?(method_changes[0][4]="",hot.setDataAtCell(rowIndex,hot.propToCol(columnInfo.codeColumnID),"")):oldValue!=changeValue&&hot.setDataAtCell(rowIndex,hot.propToCol(columnInfo.codeColumnID),""))}}else{"afterRemoveRow"==hook?(method_index=arguments[0],method_amount=arguments[1],rowIndex=method_index):"hiddenRow"==hook&&(method_rows=arguments[0],rowIndex=method_rows[0])}if(!rowIndex&&0!=rowIndex)return;var physicalRowIndex=hot.toPhysicalRow(rowIndex),rowData=hot.getSourceDataAtRow(physicalRowIndex),rowFlag=rowData&&rowData.Flag?rowData.Flag:"C",cellRowFlag;"afterCreateRow"==hook?rowFlag="C":"afterChange"==hook?"R"==rowFlag&&method_changes[0][2]!=method_changes[0][3]&&(rowFlag="U"):"hiddenRow"!=hook||"R"!=rowFlag&&"U"!=rowFlag||(rowFlag="D"),"afterRemoveRow"!=hook&&(cellRowFlag=hot.getDataAtCell(rowIndex,0),cellRowFlag!=rowFlag)&&hot.setDataAtCell(rowIndex,0,rowFlag)}else{"beforeOnCellMouseDown"==hook&&(event=arguments[0],coords=arguments[1],td=arguments[2],-1===coords.row&&"INPUT"===event.target.nodeName&&(event.stopImmediatePropagation(),this.deselectCell()),-1==coords.row&&(gridValue=$grid.getGridValue(elID),gridValue.colHeaderClick=!0,gridValue.previousRow=coords.row,gridValue.previousCol=coords.col),now=(new Date).getTime(),td.lastClick&&now-td.lastClick<200?hook="afterOnCellDoubleClick":td.lastClick=now)}if(mod){var el=syn.$l.get(elID),elHidden=syn.$l.get(elID+"_hidden"),gridHookEvents=elHidden.getAttribute("syn-events"),eventHandler;try{gridHookEvents=gridHookEvents&&eval(gridHookEvents)}catch(error){syn.$l.eventLog("WebGrid_gridHookEvents",error.toString(),"Debug")}gridHookEvents&&-1<gridHookEvents.indexOf(hook)&&1!=gridValue.passSelectCellEvent&&mod&&(eventHandler=mod.event?mod.event["{0}_{1}".format(elID,hook)]:null,eventHandler)&&eventHandler.apply(el,arguments)}"afterOnCellDoubleClick"==hook&&(hook="beforeOnCellMouseDown"),"afterSelectionEnd"==hook&&(gridValue=$grid.getGridValue(elID),gridValue.colHeaderClick=!1,gridValue.previousRow=arguments[0],gridValue.previousCol=arguments[1],mod)&&(mod.focusControl=syn.$l.get(elID))}else gridValue.eventName}}});var controlSetting=$object.clone(setting),wtHolder=($grid.gridControls.push({id:elID,hot:new Handsontable(el,controlSetting),setting:controlSetting,value:{eventName:"",colHeaderClick:!1,applyCells:!1,previousRow:-1,previousCol:-1}}),syn.$l.get(elID).querySelector(".wtHolder"));if(wtHolder.gridID=elID,Handsontable.dom.addEvent(wtHolder,"click",function(e){var t=window[syn.$w.pageScript];t&&(t.focusControl=syn.$l.get(wtHolder.gridID))}),0<$grid.gridCodeDatas.length)for(var length=$grid.gridCodeDatas.length,i=0;i<length;i++){syn.$w.addReadyCount();var codeData=$grid.gridCodeDatas[i];$grid.dataRefresh(codeData.elID,codeData.type)}setting.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(elID,setting.bindingID),1==$object.isNullOrUndefined($grid.remainingReadyIntervalID)&&($grid.remainingReadyIntervalID=setInterval(function(){if(1==syn.$w.isPageLoad){clearInterval($grid.remainingReadyIntervalID),$grid.remainingReadyIntervalID=null;for(var e=0,t=$grid.gridControls.length;e<t;e++)$grid.gridControls[e].hot.render()}},25))},dataRefresh(d,t,n){var r,e,h,f,i,p,o,s;(t=syn.$w.argumentsExtend({columnName:null,codeColumnID:null,required:!0,local:!0,dataSourceID:null,storeSourceID:null,dataSource:null,parameters:null,selectedValue:null},t)).elID=d,t.storeSourceID=t.storeSourceID||t.dataSourceID,t.columnName&&t.storeSourceID&&((r=window[syn.$w.pageScript]).config&&r.config.dataSource&&r.config.dataSource[t.storeSourceID]&&delete r.config.dataSource[t.storeSourceID],r&&r.hook.controlInit&&(e=r.hook.controlInit(d,t),t=syn.$w.argumentsExtend(t,e)),e=null,r.config&&r.config.dataSource&&r.config.dataSource[t.dataSourceID]&&(e=r.config.dataSource[t.storeSourceID]),h=$grid.getGridControl(d),i=(f=h.getSettings()).columns,p=h.propToCol(t.columnName),"dropdown"==(o=i[p]).type)&&(s=function(e,t,n){e.dataSource=t,e.storeSourceID=n.storeSourceID,e.local=n.local,e.required=n.required,e.codeColumnID=n.codeColumnID||e.codeColumnID;var r=[];0==e.required&&r.push("");for(var i=0;i<t.DataSource.length;i++){var o=t.DataSource[i];r.push(o[t.ValueColumnID])}if(e.source=r,e.visibleRows=1==$object.isNullOrUndefined(r)?0:r.length+1,e.trimDropdown=!0,e.trimWhitespace=!0,e.wordWrap=!1,e.allowInvalid=!1,$grid.updateSettings(n.elID,f),n.selectedValue){var s=$grid.getActiveRowIndex(d);if(-1<s){for(var a=h.propToCol(e.codeColumnID),l="",u=e.dataSource.DataSource.length,c=0;c<u;c++)if((o=e.dataSource.DataSource[c]).CodeID==n.selectedValue){l=o.CodeValue;break}a=[[s,a,n.selectedValue],[s,p,l]];h.setDataAtCell(a)}}},e?(s(o,e,t),n&&n(),syn.$w.removeReadyCount()):1==t.local?syn.$w.loadJson(syn.Config.SharedAssetUrl+"code/{0}.json".format(t.storeSourceID),t,function(e,t){t&&(r.config.dataSource[e.storeSourceID]=t,s(o,t,e),n)&&n(),syn.$w.removeReadyCount()},!1):syn.$w.getDataSource(t.dataSourceID,t.parameters,function(e){e&&(r.config.dataSource[t.storeSourceID]=e,s(o,e,t),n)&&n(),syn.$w.removeReadyCount()}))},getInitializeColumns(e,t){for(var n=e.columns,r={colHeaders:[],columns:[],colWidths:[],hiddenColumns:{columns:[0],indicators:!1}},i=n.length,o=0;o<i;o++){var s,a,l=n[o],u={data:l[0],type:"text",filter:!0,isHidden:l[3],readOnly:1==$string.toBoolean(e.readOnly)||l[5],className:1==$object.isNullOrUndefined(l[6])?"":"ht"+$string.capitalize(l[6]),belongID:1==$object.isNullOrUndefined(l[7])?"":l[7],validators:null},c=(8<l.length&&l[8]&&(u.validators=l[8],-1<u.validators.indexOf("require"))&&(u.className=u.className+" required"),9<l.length&&l[9]&&(d=l[9],0==$string.isNullOrEmpty(d.placeholder)&&(u.placeholder=d.placeholder),1!=d.sorting&&(u.columnSorting={indicator:!1,headerAction:!1,compareFunctionFactorycompareFunctionFactory(){return function(){return 0}}}),"checkbox"!=u.type&&"checkbox2"!=u.type||1!=d.isRadioTheme||(u.className=u.className+" required"),u.columnOptions=d),10!=l.length&&0==e.columnSorting&&(u.columnSorting={indicator:!1,headerAction:!1,compareFunctionFactorycompareFunctionFactory(){return function(){return 0}}}),null),d=l[4];if(1==$object.isString(d)?(u.type=d,"dropdown"==u.type||"codehelp"==u.type?syn.$l.eventLog("getInitializeColumns",'"{0}" 컬럼 타입은 객체로 선언 필요'.format(d),"Warning"):"checkbox"==u.type||"checkbox2"==u.type?(u.isSelectAll=!1,u.checkedTemplate="1",u.uncheckedTemplate="0",u.allowInvalid=!1):"numeric"!=u.type&&"date"!=u.type&&"time"!=u.type&&"autocomplete"!=u.type||(u.allowInvalid=!1,"numeric"==u.type?d.numericFormat?u.numericFormat=d.numericFormat:0!=d.numericFormat&&(u.numericFormat={pattern:"0,00",culture:"ko-KR"}):"date"==u.type?(u.dateFormat=d.timeFormat,u.correctFormat=d.correctFormat,u.defaultDate=d.defaultDate,u.datePickerConfig=d.datePickerConfig):"time"==u.type&&(u.timeFormat=d.timeFormat,u.correctFormat=d.correctFormat))):(u.type=d.columnType,"dropdown"==u.type||"codehelp"==u.type?(s=d.storeSourceID||d.dataSourceID)&&(a=window[syn.$w.pageScript]).config&&a.config.dataSource&&a.config.dataSource[s]&&(c=a.config.dataSource[s]):"checkbox"==u.type||"checkbox2"==u.type?(u.isSelectAll=0==$object.isNullOrUndefined(d.isSelectAll)&&!0===d.isSelectAll,u.checkedTemplate=0==$object.isNullOrUndefined(d.checkedTemplate)?d.checkedTemplate:"1",u.uncheckedTemplate=0==$object.isNullOrUndefined(d.uncheckedTemplate)?d.uncheckedTemplate:"1",u.allowInvalid=0==$object.isNullOrUndefined(d.allowInvalid)&&!0===d.allowInvalid):"numeric"!=u.type&&"date"!=u.type&&"time"!=u.type&&"autocomplete"!=u.type||(u.allowInvalid=!1,"numeric"==u.type?d.numericFormat?u.numericFormat=d.numericFormat:0!=d.numericFormat&&(u.numericFormat={pattern:"0,00",culture:"ko-KR"}):"date"==u.type?(u.dateFormat=d.timeFormat,u.correctFormat=d.correctFormat,u.defaultDate=d.defaultDate,u.datePickerConfig=d.datePickerConfig):"time"==u.type&&(u.timeFormat=d.timeFormat,u.correctFormat=d.correctFormat))),"dropdown"==u.type){var h=[];if(c)for(var f=0;f<c.DataSource.length;f++){var p=c.DataSource[f];h.push(p[c.ValueColumnID])}else t&&(d.columnName=l[0],!0===d.local?$grid.dataRefresh(t,d):$grid.gridCodeDatas.push({elID:t,type:d}));u.dataSource=c,u.dataSourceID=d.dataSourceID,u.storeSourceID=d.storeSourceID||d.dataSourceID,u.local=!0===d.local,u.codeBelongID=d.codeBelongID,u.codeColumnID=d.codeColumnID,u.codeColumnType=d.codeColumnType||"text",u.codeColumnHidden=null==d.codeColumnHidden||d.codeColumnHidden,u.source=h,u.strict=!0,u.visibleRows=1==$object.isNullOrUndefined(h)?0:h.length+1,u.trimDropdown=!0,u.trimWhitespace=!0,u.wordWrap=!1,u.allowInvalid=!1}else"codehelp"==u.type?(u.dataSource=c,u.dataSourceID=d.dataSourceID,u.storeSourceID=d.storeSourceID||d.dataSourceID,u.local=d.local,u.controlText=d.controlText,u.codeColumnID=d.codeColumnID||l[0],u.textColumnID=d.textColumnID||l[0],u.parameters=d.parameters||""):"date"==u.type&&(u.dateFormat=d.dateFormat||"YYYY-MM-DD",u.correctFormat=!0,u.datePickerConfig={format:u.dateFormat,ariaLabel:"날짜를 선택하세요",i18n:{previousMonth:"이전 달",nextMonth:"다음 달",months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],weekdays:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],weekdaysShort:["일","월","화","수","목","금","토"]},showWeekNumber:!1,showMonthAfterYear:!0,yearSuffix:"년",firstDay:0,numberOfMonths:1});"dropdown"==u.type&&(a={data:u.codeColumnID,type:u.codeColumnType,filter:!0,readOnly:!0,className:"htLeft",belongID:u.codeBelongID||$object.clone(l[7])},1==u.codeColumnHidden?(r.colHeaders.push(l[1]+"_$HIDDEN"),u.columnText=l[1]+"_$HIDDEN"):(r.colHeaders.push(l[1]+"_코드"),u.columnText=l[1]+"_코드"),r.columns.push(a),r.colWidths.push(l[2])),r.colHeaders.push(l[1]),u.columnText=l[1],r.columns.push(u),r.colWidths.push(l[2])}for(var g=r.colHeaders.length,o=0;o<g;o++)-1<r.colHeaders[o].indexOf("_$HIDDEN")&&r.hiddenColumns.columns.push(o+1);for(o=0;o<g;o++)1==(u=r.columns[o]).isHidden&&r.hiddenColumns.columns.push(o+1);return r},merge(e,t,n,r,i){var e=$grid.getGridControl(e);e&&(0==(e=e.getPlugin("mergeCells")).isEnabled()&&e.enablePlugin(),e.merge(t,n,r,i))},unmerge(e,t,n,r,i){var e=$grid.getGridControl(e);e&&(0==(e=e.getPlugin("mergeCells")).isEnabled()&&e.enablePlugin(),e.unmerge(t,n,r,i))},addCondition(e,t,n,r){var i,e=$grid.getGridControl(e);e&&(0==(i=e.getPlugin("filters")).isEnabled()&&i.enablePlugin(),1==$object.isString(t)&&(t=e.propToCol(t)),1==$object.isString(r)&&(r=[r]),i.addCondition(t,n,r),i.filter())},removeCondition(e,t){var n,e=$grid.getGridControl(e);e&&(0==(n=e.getPlugin("filters")).isEnabled()&&n.enablePlugin(),1==$object.isString(t)&&(t=e.propToCol(t)),n.removeConditions(t),n.filter())},clearConditions(e){var e=$grid.getGridControl(e);e&&(0==(e=e.getPlugin("filters")).isEnabled()&&e.enablePlugin(),e.clearConditions(),e.filter())},countRows(e,t){var n,r=0,e=$grid.getGridControl(e);return e&&(!(n=0)===t&&(0==(t=e.getPlugin("hiddenRows")).isEnabled()&&t.enablePlugin(),n=t?t.getHiddenRows().length:0),r=e.countSourceRows()-n),r},countRenderedRows(e){var t=-1,e=$grid.getGridControl(e);return t=e?e.countRenderedRows():t},countRenderedCols(e){var t=-1,e=$grid.getGridControl(e);return t=e?e.countRenderedCols():t},render(e){e=$grid.getGridControl(e);e&&e.render()},insertRow(e,t,n){var r=$grid.getGridControl(e),i=(t=syn.$w.argumentsExtend({index:r.countRows(),amount:1},t),r.alter("insert_row_below",t.index,t.amount),r.render(),r.suspendRender(),$grid.getGridValue(e)),o=(i.eventName="insertRow",t&&t.index?t.index:0),s=t&&t.amount?t.amount:1,a=r.getSettings();if(a){for(var l=[],u=a.columns,c=u.length,d=0;d<c;d++){var h=u[d];if(0<=d&&("checkbox"==h.type||"checkbox2"==h.type)){var f=!1;if(null==h.uncheckedTemplate&&null==h.uncheckedTemplate||(f=h.uncheckedTemplate),1==s)l.push([o,d,f]);else if(1<s)for(var p=0;p<s;p++){var g=o+p;l.push([g,d,f])}}}0<l.length&&r.setDataAtCell(l)}var m=syn.$w.getTriggerOptions(e);if(m){if(m.sourceValueID&&m.targetColumnID){a=window[syn.$w.pageScript];if(a){var y=a.context.synControls;if(y&&0<y.length)if(1==$object.isString(m.sourceValueID)&&1==$object.isString(m.targetColumnID)){var v=(_=m.sourceValueID.split("@"))[0],b=_[1],E=y.filter(function(e){return e.field==v});if(1==E.length)if("grid"==(N=E[0]).type){var C=r.propToCol(m.targetColumnID),w=N.id,S=$grid.getActiveRowIndex(w),T=$grid.propToCol(w,b),R=$grid.getDataAtCell(w,S,T);if(1==s)r.setDataAtCell(o,C,R);else if(1<s)for(p=0;p<s;p++){g=o+p;r.setDataAtCell(g,C,R)}}else{var d=r.propToCol(m.targetColumnID),A=syn.$l.querySelector('[syn-datafield="{0}"] #{1}'.format(v,b));if(0==$object.isNullOrUndefined(A))if(1==s)r.setDataAtCell(o,d,A.value);else if(1<s)for(p=0;p<s;p++){g=o+p;r.setDataAtCell(g,d,A.value)}}else syn.$l.eventLog("insertRow","{0} 컬럼 ID 중복 또는 존재여부 확인 필요".format(v),"Debug")}else if(1==$object.isArray(m.sourceValueID)&&1==$object.isArray(m.targetColumnID))for(c=m.sourceValueID.length,p=0;p<c;p++){var _,N,v=(_=m.sourceValueID[p].split("@"))[0],b=_[1],E=y.filter(function(e){return e.field==v});if(1==E.length)if("grid"==(N=E[0]).type){C=r.propToCol(m.targetColumnID[p]),w=N.id,S=$grid.getActiveRowIndex(w),T=$grid.propToCol(w,b),R=$grid.getDataAtCell(w,S,T);if(1==s)r.setDataAtCell(o,C,R);else if(1<s)for(p=0;p<s;p++){g=o+p;r.setDataAtCell(g,C,R)}}else{var d=r.propToCol(m.targetColumnID[p]),A=syn.$l.querySelector('[syn-datafield="{0}"] #{1}'.format(v,b));if(0==$object.isNullOrUndefined(A))if(1==s)r.setDataAtCell(o,d,A.value);else if(1<s)for(p=0;p<s;p++){g=o+p;r.setDataAtCell(g,d,A.value)}}else syn.$l.eventLog("insertRow","{0} 컬럼 ID 중복 또는 존재여부 확인 필요".format(v),"Debug")}}}m.focusColumnID&&(d=r.propToCol(m.focusColumnID),r.selectCell(o+(s-1),d))}else{var x=[];if(1==s)for(var O in t.values){d=$grid.propToCol(e,O);1==$object.isNumber(d)&&x.push([o,d,t.values[O]])}else if(1<s)for(p=0;p<s;p++){g=o+p;for(O in t.values){d=$grid.propToCol(e,O);1==$object.isNumber(d)&&x.push([g,d,t.values[O]])}}$grid.setDataAtRow(e,x)}r.resumeRender(),n&&n(o,s),t.focusColumnID&&(d=r.propToCol(t.focusColumnID),r.selectCell(o+(s-1),d)),i.eventName=""},removeRow(e,t,n,r){var i=$grid.getGridControl(e);if(i&&(i.suspendRender(),1==$object.isNullOrUndefined(n)&&((s=i.getSelected())?n=s[0][0]:(n=$grid.getActiveRowIndex(e))&&-1<n&&((o=$grid.getGridValue(e)).colHeaderClick=!1,o.previousRow=-1,o.previousCol=-1)),1==$object.isNullOrUndefined(n)&&(n=$grid.countRows(e,!0)-1),1!=$grid.isRowHidden(e,n))){if(-1<n){(o=$grid.getGridValue(e)).eventName="removeRow";var o,s=i.toPhysicalRow(n),s=i.getSourceDataAtRow(s),s=s&&s.Flag?s.Flag:"C";if("D"==s){i.setDataAtCell(n,0,s="U");for(var a=0;a<i.countCols();a++){var l=(l=i.getCellMeta(n,a).className).replace(" removeRow","");i.setCellMeta(n,a,"className",l)}}else if("C"!=(s="R"!=s&&"U"!=s?s:"D")&&"S"!=s&&i.setDataAtCell(n,0,s),"C"==s){i.alter("remove_row",n);var u=i.countSourceRows(),c=syn.$w.getTriggerOptions(e);c&&c.focusColumnID&&(c=i.propToCol(c.focusColumnID),0<n&&u<=n?i.selectCell(n=u-1,c):i.selectCell(n-1,c))}else if("S"!=s)if(!0===i.getSettings().isRemoveRowHidden)$grid.visibleRows(e,n,!1);else for(a=0;a<i.countCols();a++)i.setCellMeta(n,a,"className",i.getCellMeta(n,a).className+" removeRow");r?r(n):(1==$string.isNullOrEmpty(t)&&(t=1),0<=n-1&&$grid.selectCell(e,n-1,t)),o.eventName=""}i.resumeRender()}},loadData(e,t,n){var r=$grid.getGridControl(e);if(r){for(var i=$grid.getGridValue(e),o=(i.applyCells=!1,r.deselectCell(),$grid.clearConditions(e),$grid.unHiddenRows(e),syn.$l.querySelectorAll("div.handsontable > div table input[type=checkbox][columnSelectAll]")),s=0;s<o.length;s++)o[s].checked=!1;for(var a=t.length,s=0;s<a;s++)t[s].Flag="R";r.loadData(t);for(var l=r.getSettings(),s=0;s<l.columns.length;s++){var u=l.columns[s];u.toogleChecked&&(u.toogleChecked=0)}i.colHeaderClick=!1,i.previousRow=-1,i.previousCol=-1,0!=l.columnSorting&&(0==(e=r.getPlugin("columnSorting")).isEnabled()&&e.enablePlugin(),1==e.isSorted())&&e.sort(e.sortColumn,e.sortOrder),i.applyCells=!0}n&&n()},getFirstShowColIndex(e){var t=0,e=$grid.getGridControl(e);if(e){var n=e.getSettings();if(n.firstShowColIndex)t=n.firstShowColIndex;else{for(var r=e.countCols()-1,i=[],o=0;o<=r;o++)i.push(o);if(n.hiddenColumns&&n.hiddenColumns.columns&&0<n.hiddenColumns.columns.length){for(var s=n.hiddenColumns.columns.length,o=0;o<s;o++)for(var a=n.hiddenColumns.columns[o],l=i.length-1;-1<l;l--)if(a==i[l]){$array.removeAt(i,l);break}t=i[0]}}}return t},getLastShowColIndex(e){var t=0,e=$grid.getGridControl(e);if(e){var n=e.getSettings();if(n.lastShowColIndex)t=n.lastShowColIndex;else{for(var t=e.countCols()-1,r=[],i=0;i<=t;i++)r.push(i);if(n.hiddenColumns&&n.hiddenColumns.columns&&0<n.hiddenColumns.columns.length){for(var o=n.hiddenColumns.columns.length,i=0;i<o;i++)for(var s=n.hiddenColumns.columns[i],a=r.length-1;-1<a;a--)if(s==r[a]){$array.removeAt(r,i);break}t=r[r.length-1]}}}return t},updateSettings(e,t,n){var r=$grid.getGridControl(e);r&&(n&&1==n&&$grid.clear(e),r.updateSettings(t),r.render())},getSettings(e){var t=null,e=$grid.getGridControl(e);return t=e?e.getSettings():t},isUpdateData(e){var t=!1,n=$grid.getSettings(e);if(n&&n.data&&0<n.data.length)for(var r=n.data.length,i=0;i<r;i++){var o=n.data[i].Flag;if(1!=$string.isNullOrEmpty(o)&&"R"!=o&&"S"!=o){t=!0;break}}return t},getFlag(e,t){e=$grid.getGridControl(e);if(e)return e.getDataAtCell(t,"Flag")},setFlag(e,t,n){var r,e=$grid.getGridControl(e);e&&(r=e.propToCol("Flag"),"S"!=e.getDataAtCell(t,r))&&e.setDataAtCell(t,r,n)},getDataAtCell(e,t,n){e=$grid.getGridControl(e);if(e)return e.getDataAtCell(t,n)},scrollViewportTo(e,t,n,r,i){var o=null,e=$grid.getGridControl(e);return o=e?e.scrollViewportTo(t,n,r,i):o},isEmptyRow(e,t){var n=null,e=$grid.getGridControl(e);return n=e?e.isEmptyRow(t):n},isEmptyCol(e,t){var n=null,e=$grid.getGridControl(e);return e&&(1==$object.isString(t)&&(t=e.propToCol(t)),n=e.isEmptyCol(t)),n},getDataAtRow(e,t){var n=null,e=$grid.getGridControl(e);return n=e?e.getDataAtRow(t):n},getSourceDataAtRow(e,t){var n=null,e=$grid.getGridControl(e);return n=e?e.getSourceDataAtRow(t):n},getDataAtCol(e,t){var n=null,e=$grid.getGridControl(e);return e&&(1==$object.isString(t)&&(t=e.propToCol(t)),n=e.getDataAtCol(t)),n},getSourceDataAtCol(e,t){var n=null,e=$grid.getGridControl(e);return e&&(1==$object.isString(t)&&(t=e.propToCol(t)),n=e.getSourceDataAtCol(t)),n},getRowHeader(e,t){var n=null,e=$grid.getGridControl(e);return n=e?e.getRowHeader(t):n},setDataAtCell(e,t,n,r,i){e=$grid.getGridControl(e);e&&(1==$object.isString(n)&&(n=e.propToCol(n)),e.setDataAtCell(t,n,r,i))},setDataAtRow(e,t){e=$grid.getGridControl(e);e&&e.setDataAtCell(t)},isCellClassName(e,t,n,r){var i=!1,e=$grid.getGridControl(e);return e&&(1==$object.isString(n)&&(n=e.propToCol(n)),i=null!=(e=e.getCellMeta(t,n).className)&&-1<e.indexOf(r)),i},setCellClassName(e,t,n,r,i){if(1==$object.isNullOrUndefined(r))syn.$l.eventLog("$grid.setCellClassName","className 확인 필요","Warning");else{var o=$grid.getGridControl(e);if(o){1==$object.isString(n)&&(n=o.propToCol(n)),1==$object.isNullOrUndefined(i)&&(i=!1);var s=function(e,t,n,r){var i=o.getCellMeta(e,t).className;i?!0===r?-1==i.indexOf(n)&&o.setCellMeta(e,t,"className",o.getCellMeta(e,t).className+" "+n):-1<i.indexOf(n)&&(i=i.replace(" "+n,""),o.setCellMeta(e,t,"className",i)):o.setCellMeta(e,t,"className",n)};if(-1==t&&-1==n)for(var a=o.countRows(),l=o.countCols(),u=0;u<a;u++)for(var c=0;c<l;c++)s(u,c,r,i);else if(-1==t&&-1<n)for(a=o.countRows(),u=0;u<a;u++)s(u,n,r,i);else if(-1<t&&-1==n)for(l=o.countCols(),u=0;u<l;u++)s(t,u,r,i);else s(t,n,r,i);o.render()}}},setCellMeta(e,t,n,r,i){e=$grid.getGridControl(e);e&&(1==$object.isString(n)&&(n=e.propToCol(n)),e.setCellMeta(t,n,r,i))},setDataAtRowProp(e,t,n,r,i){e=$grid.getGridControl(e);e&&(1==$object.isString(n)&&(n=e.propToCol(n)),e.setDataAtRowProp(t,n,r,i))},getCellMeta(e,t,n){var r=null,e=$grid.getGridControl(e);return e&&(1==$object.isString(n)&&(n=e.propToCol(n)),r=e.getCellMeta(t,n)),r},getCellMetaAtRow(e,t){var n=null,e=$grid.getGridControl(e);return n=e?e.getCellMetaAtRow(t):n},getUpdateData(e,t,n){var r=[],i=$grid.getGridControl(e);if(n){if("Row"==t){if(null!=(c=i.toPhysicalRow($grid.getActiveRowIndex(e)))&&-1<c){var o=(d=i.getSourceDataAtRow(c)).Flag||"C";i.getCellMetaAtRow(c);if(o&&"S"!=o){for(f in d=$object.clone(d),(h={}).Flag=o,n){var s=n[f],a=d[f];h[s.fieldID]=a,h[s.fieldID]=void 0===a?"number"==s.dataType?null:$object.defaultValue(s.dataType):a}r.push(h)}}}else if("List"==t)for(var l=i.countSourceRows(),u=0;u<l;u++){var c=i.toPhysicalRow(u);if(null!=c){var d,h,f,o=(d=i.getSourceDataAtRow(c)).Flag||"C";i.getCellMetaAtRow(c);if(o&&"S"!=o&&"R"!=o){for(f in d=$object.clone(d),(h={}).Flag=o,n){s=n[f],a=d[f];h[s.fieldID]=a,h[s.fieldID]=void 0===a?"number"==s.dataType?null:$object.defaultValue(s.dataType):a}r.push(h)}}}}else syn.$l.eventLog("getUpdateData","Input Mapping 설정 없음","Debug");return r},validateColumns(e,t,n){var r=!1,e=$grid.getGridControl(e);return r=e?e.validateColumns(t,n):r},validateRows(e,t,n){var r=!1,e=$grid.getGridControl(e);return r=e?e.validateRows(t,n):r},getPhysicalRowIndex(e,t){var n=null,e=$grid.getGridControl(e);return n=e?e.toPhysicalRow(t):n},getPhysicalColIndex(e,t){var n=null,e=$grid.getGridControl(e);return n=e?e.toPhysicalColumn(t):n},getLogicalRowIndex(e,t){var n=null,e=$grid.getGridControl(e);return n=e?e.toVisualRow(t):n},getLogicalColIndex(e,t){var n=null,e=$grid.getGridControl(e);return n=e?e.toVisualColumn(t):n},unHiddenColumns(e){var t=$grid.getGridControl(e);if(t){for(var n=t.getPlugin("hiddenColumns"),r=(0==n.isEnabled()&&n.enablePlugin(),t.countCols()),i=[],o=0;o<r;o++)"Flag"!=t.colToProp(o)&&1==n.isHidden(o)&&i.push(o);$grid.visibleColumns(e,i,!0)}},isColumnHidden(e,t,n){var r=!1,e=$grid.getGridControl(e);return e&&(0==(e=e.getPlugin("hiddenColumns")).isEnabled()&&e.enablePlugin(),r=e.isHidden(t,n)),r},visibleColumns(e,t,n){e=$grid.getGridControl(e);if(e){var r=e.getPlugin("hiddenColumns");0==r.isEnabled()&&r.enablePlugin();var i=e.getSettings().columns;if(1==n)if(1==$object.isNumber(t))i[t].isHidden=!1,r.showColumn(t);else{for(var o=0;o<t.length;o++)i[t[o]].isHidden=!1;r.showColumns(t)}else if(1==$object.isNumber(t))i[t].isHidden=!0,r.hideColumn(t);else{for(o=0;o<t.length;o++)i[t[o]].isHidden=!0;r.hideColumns(t)}e.render()}},unHiddenRows(e){var t=$grid.getGridControl(e);if(t){for(var n=t.getPlugin("hiddenRows"),r=(0==n.isEnabled()&&n.enablePlugin(),t.countRows()),i=[],o=0;o<r;o++)1==n.isHidden(o)&&i.push(o);$grid.visibleRows(e,i,!0)}},isRowHidden(e,t,n){var r=!1,e=$grid.getGridControl(e);return e&&(0==(e=e.getPlugin("hiddenRows")).isEnabled()&&e.enablePlugin(),r=e.isHidden(t,n)),r},visibleRows(e,t,n){var r,e=$grid.getGridControl(e);e&&(0==(r=e.getPlugin("hiddenRows")).isEnabled()&&r.enablePlugin(),1==n?1==$object.isNumber(t)?r.showRow(t):r.showRows(t):1==$object.isNumber(t)?r.hideRow(t):r.hideRows(t),e.render())},propToCol(e,t){var n=-1,e=$grid.getGridControl(e);return n=e?e.propToCol(t):n},getColHeader(e,t){var n=null,e=$grid.getGridControl(e);return n=e?e.getColHeader(t):n},colToProp(e,t){var n=null,e=$grid.getGridControl(e);return n=e?e.colToProp(t):n},countCols(e){var t=null,e=$grid.getGridControl(e);return t=e?e.countCols():t},getSelected(e){var t=null,e=$grid.getGridControl(e);return t=e?e.getSelected():t},getActiveRowIndex(e){var t,n=-1,r=$grid.getGridControl(e);return n=r?(t=r.getSelected())&&0<t.length?r.getSelected()[0][0]:$grid.getGridValue(e).previousRow:n},getActiveColIndex(e){var t,n=-1,r=$grid.getGridControl(e);return n=r?(t=r.getSelected())&&0<t.length?r.getSelected()[0][1]:$grid.getGridValue(e).previousCol:n},selectCell(e,t,n,r,i,o,s){var a,l,e=$grid.getGridControl(e);e&&(-1===t&&((a=0)==(l=e.getPlugin("hiddenRows")).isEnabled()&&l.enablePlugin(),a=l?l.hiddenRows.length:0,t=e.countSourceRows()-a-1),e.selectCell(t,n,r,i,o,s))},getExportPlugin(e,t){var n=null,e=$grid.getGridControl(e);return e&&0==(n=e.getPlugin("exportFile")).isEnabled()&&n.enablePlugin(),n},exportAsString(e,t){var n=null,r=$grid.getExportPlugin(e,t);if(r){1==$object.isNullOrUndefined(t)&&(t={});for(var i=$grid.getGridControl(e),o=((t=syn.$w.argumentsExtend({exportHiddenRows:!1,exportHiddenColumns:!1,rowHeaders:!1,bom:!1,columnDelimiter:",",range:t.range||[0,1,i.countRows(),i.countCols()-1],filename:"{0}_{1}_{2}".format(syn.$w.pageScript,e,$date.toTicks(new Date))},t)).columnHeaders=!1,i.getSettings().columns),s=[],e=t.range?t.range[1]:1,a=t.range?t.range[3]:i.countCols()-1,l=e;l<=a;l++)s.push(o[l]);i=s.filter(function(e){return 1==t.exportHiddenColumns||0==e.isHidden}).map(function(e){return e.columnText}),e=r.exportAsString("csv",t),n=i.join(",")+"\r\n"+e}return n},exportFile(e,t){var n=$grid.getExportPlugin(e,t);if(n)if(1==$object.isNullOrUndefined(t)&&(t={}),"excel"==(t=syn.$w.argumentsExtend({fileType:"excel",exportHiddenRows:!1,exportHiddenColumns:!1,columnHeaders:!0,rowHeaders:!1,bom:!1,columnDelimiter:","},t)).fileType){for(var r,i=(r=$grid.getGridControl(e)).getSettings(),o=i.columns,s=[],a=t.range?t.range[1]:1,l=t.range?t.range[3]:r.countCols()-1,u=a;u<=l;u++)s.push(o[u]);for(var c=s.filter(function(e){return 1==t.exportHiddenColumns||0==e.isHidden}).map(function(e,t){return{index:r.propToCol(e.data),type:e.type}}),a=i.exportColumns.map(function(e,t){return{index:r.propToCol(e.columnID),type:e.type}}),d=(c=$object.extend(c,a)).length,h=i.colWidths,f=[],u=0;u<d;u++){var p=c[u].index;f.push({wpx:h[p]})}for(var a=$grid.exportAsString(e,t),g=Papa.parse(a).data,m=g.length,y=document.createElement("DIV"),u=0;u<d;u++)if("numeric"==c[u].type)for(var v=1;v<m;v++)g[v][u]=$string.toParseType(g[v][u],"number");else if(-1<c[u].type.indexOf("html"))for(v=1;v<m;v++)y.innerHTML=g[v][u],g[v][u]=y.textContent||y.innerText||"";y=null,i=XLSX.utils.book_new(),a=XLSX.utils.aoa_to_sheet(g),a=(a["!cols"]=f,XLSX.utils.book_append_sheet(i,a,"Sheet1"),XLSX.write(i,{bookType:"xlsx",type:"binary"}));syn.$l.blobToDownload(new Blob([$l.stringToArrayBuffer(a)],{type:"application/octet-stream"}),t.filename+".xlsx")}else"csv"==t.fileType&&(r=$grid.getGridControl(e),t=syn.$w.argumentsExtend({range:t.range||[0,1,r.countRows(),r.countCols()],filename:"{0}_{1}_{2}".format(syn.$w.pageScript,e,$date.toTicks(new Date))},t),n.downloadFile("csv",t))},importFile(e,t){$grid.getGridControl(e)&&((e=syn.$l.get("{0}_ImportFile".format(e))).callback=t,e.click())},importFileLoad(e){var O=e.srcElement||e.target,I=O.id.split("_")[0],M=$grid.getSettings(I),e=[".csv",".xls",".xlsx"],k=O.files[0].name,D=k.substring(-1==k.lastIndexOf(".")?k.length:k.lastIndexOf("."));if(D&&e.indexOf(D)<0)return syn.$w.alert("{0} 확장자를 가진 파일만 가능합니다".format(e.toString())),!1;e=new FileReader;e.onload=function(e){O.value="";var e=e.target.result,t=$grid.getGridControl(I);if(".csv"==D){var n=e.split(/\r\n|\n/);if(0==n.length)$grid.clear(I);else if(0<n.length){for(var r=[],i=n[0].split(","),o=[],s=M.columns.map(function(e){return e.data}),a=M.columns.map(function(e){return e.type}),l=0;l<i.length;l++){if(m=(m=(m=i[l]).replace(/^["]/,"")).replace(/["]$/,""),i[l]=m,-1==(C=M.colHeaders.indexOf(m)))return syn.$w.alert("올바른 형식의 파일이 아닙니다.\n파일을 확인해주세요.".format(M.controlText)),!1;var u=t.propToCol(s[C]);o.push({headerIndex:l,columnID:s[C],columnIndex:u,columnType:a[C]})}for(var c=n[1],d=c.split(","),l=0;l<o.length;l++){var h=o[l],f=(m=(m=(m=d[l]).replace(/^["]/,"")).replace(/["]$/,""),!0);switch(h.columnType){case"checkbox":case"checkbox2":f=$string.toBoolean(m);break;case"numeric":null==m&&(m=0),f=1==$object.isNumber(m)||$string.isNumber(m);break;case"date":f=null==m||$object.isDate(m);break;default:null==m&&(m=""),f=$object.isString(m)}if(0==f)return syn.$w.alert("올바른 형식의 파일이 아닙니다.\n파일을 확인해주세요."),!1}for(l=1;l<n.length;l++)if(c=n[l],0==$string.isNullOrEmpty(c)){for(var p={},d=n[l].split(","),g=0;g<o.length;g++){var h=o[g],m=d[g];m=1==$object.isNullOrUndefined(m)?"":(m=m.replace(/^["]/,"")).replace(/["]$/,""),"numeric"==h.columnType&&null!=m&&(m=1==$object.isNumber(m)?m:Number(m)),p[h.columnID]=m}r.push(p)}}}else{for(var s=M.columns.map(function(e){return e.data}),e=XLSX.read(e,{type:"binary"}),y=e.Sheets[e.SheetNames[0]],v=XLSX.utils.decode_range(y["!ref"]),b=v.s.c;b<=v.e.c;++b){var E=y[XLSX.utils.encode_cell({c:b,r:0})];if(null==E)break;var C,w=E.v;if(-1==(C=M.colHeaders.indexOf(w)))return syn.$w.alert("올바른 형식의 파일이 아닙니다.\n파일을 확인해주세요.".format(M.controlText)),!1;w=s[C];E.v=w,E.h=w,E.w=w}r=XLSX.utils.sheet_to_json(y)}for(var S={},T=0;T<M.columns.length;T++){var R=M.columns[T],A="string";switch(R.type){case"radio":case"checkbox":case"checkbox2":A="bool";break;case"numeric":A="int";break;case"date":A="string"}S[R.data]={fieldID:R.data,dataType:A}}$grid.clear(I),$grid.setValue(I,r,S);for(var _=t.propToCol("Flag"),N=t.countRows(I),x=[],l=0;l<N;l++)x.push([l,_,"C"]);t.setDataAtCell(x),O.callback&&O.callback(k)},".csv"==D?e.readAsText(O.files[0]):e.readAsBinaryString(O.files[0])},getGridControl(e){for(var t=null,n=$grid.gridControls.length,r=0;r<n;r++){var i=$grid.gridControls[r];if(i.id==e){t=i.hot;break}}return t},getGridValue(e){for(var t=null,n=$grid.gridControls.length,r=0;r<n;r++){var i=$grid.gridControls[r];if(i.id==e){t=i.value;break}}return t},getGridSetting(e){for(var t=null,n=$grid.gridControls.length,r=0;r<n;r++){var i=$grid.gridControls[r];if(i.id==e){t=i.setting;break}}return t},getColumnWidths(e){var t=[],n=$grid.getGridControl(e);if(n)for(var r=n.countCols(),i=0;i<r;i++)t.push(n.getColWidth(i));return t},setColumnWidth(e,t,n){var r,e=$grid.getGridControl(e);e&&(0==(r=e.getPlugin("manualColumnResize")).isEnabled()&&r.enablePlugin(),1==$object.isString(t)&&(t=e.propToCol(t)),1==$object.isNumber(n))&&r.setManualSize(t,n)},setControlSize(e,t){var n=syn.$l.get(e);n&&t&&(t.width&&(n.style.width=t.width),t.height&&(n.style.height=t.height),$grid.getGridControl(e).render())},getValue(e,t,n){for(var r=[],i=$grid.getUpdateData(e,t,n),o=i.length,s=0;s<o;s++){var a,l=i[s],u=[];for(a in l){var c={prop:a,val:l[a]};u.push(c)}r.push(u)}return r},setValue(e,t,n){var r="",i=$grid.getGridControl(e);if(i){var o,s=i.getSettings();if(s&&t&&0<t.length){for(o in g=t[0]){var a=!1,l=n[o];if(l){switch(l.dataType.toLowerCase()){case"string":a=null==g[o]||$object.isString(g[o])||$string.isNumber(g[o]);break;case"bool":a=1==$string.isNullOrEmpty(g[o])||$object.isBoolean(g[o]);break;case"number":case"int":a=1==$string.isNullOrEmpty(g[o])||$string.isNumber(g[o])||$object.isNumber(g[o]);break;case"date":a=1==$string.isNullOrEmpty(g[o])||$object.isDate(g[o]);break;default:a=!1}if(0==a){r='바인딩 데이터 타입과 매핑 정의가 다름, 바인딩 ID - "{0}", 타입 - "{1}"'.format(o,l.dataType);break}}}if(""==r){for(var u=s.columns,c=[],d=0;d<u.length;d++)"dropdown"==(h=u[d]).type&&c.push(h);if(0<c.length)for(d=0;d<c.length;d++){var h,f=(h=c[d]).dataSource;if(f)for(var p=0;p<t.length;p++)for(var g,m=t[p][h.codeColumnID],y=0;y<f.DataSource.length;y++)if((g=f.DataSource[y])[f.CodeColumnID]==m){t[p][h.data]=g[f.ValueColumnID];break}}$grid.loadData(e,t),$grid.renderSummary(i)}else syn.$l.eventLog("syn.uicontrols.$grid",r,"Debug")}else $grid.loadData(e,[]),$grid.renderSummary(i)}},renderSummary(e){var t=e.getSettings();t.summarys&&0<t.summarys.length&&(t={index:e.countRows(),amount:1},e.alter("insert_row_below",t.index,t.amount),e.render(),$grid.getGridValue(e.elID).applyCells=!0,$grid.refreshSummary(e.elID))},refreshSummary(e){var t=$grid.getGridControl(e),n=t.getSettings();if(n.summarys&&0<n.summarys.length){for(var r=n.data.length-1,i=[],o=n.summarys.length,s=function(e){return 1==$string.isNullOrEmpty(e)||0==$string.isNumber(e)?0:parseFloat($object.isNumber(e)?e:$string.toNumber(e))},a=0;a<o;a++){var l=0,u=n.summarys[a],c=t.propToCol(u.columnID),d=n.data.map(function(e){return e.Flag&&"S"!=e.Flag&&e[u.columnID]});if(0<d.length){var h=JSON.parse(JSON.stringify(d));switch(u.type){case"min":$array.sort(h,!0);l=s(h[0]);break;case"max":$array.sort(h,!1),l=s(h[0]);break;case"avg":for(var f=0;f<h.length;f++)l+=s(h[f]);l/=h.length;break;case"sum":for(f=0;f<h.length;f++)l+=s(h[f]);break;case"count":l=h.length-1;break;case"custom":var p=window[syn.$w.pageScript];p&&(p=p.event["{0}_customSummary".format(t.elID)])&&(l=p.apply(t,[t.elID,u.columnID,c,h]))}"custom"!=u.type&&(l=1==$object.isNullOrUndefined(u.fixed)?l.toFixed("avg"==u.type?"1":"0"):l.toFixed(u.fixed),l=1==$object.isNullOrUndefined(u.format)||!0===u.format?$string.toCurrency(l):l.toString()),i.push([r,c,l])}}i.push([r,0,"S"]),t.setDataAtCell(i)}},clear(e,t){$grid.loadData(e,[])},checkEditValue(e){return 0<$grid.getDataAtCol(e,"Flag").filter(e=>0==$string.isNullOrEmpty(e)&&"R"!=e).length},checkUniqueValueCol(e,t){var n=$grid.getSourceDataAtCol(e,t);return 0<!n.filter(function(e,t){return n.indexOf(e)!==t}).length},checkValueCountCol(e,t,n){return $grid.getDataAtCol(e,t).filter(e=>e===n).length},checkEmptyValueCol(e,t,n){return 1==$object.isNullOrUndefined(n)?0<$grid.getDataAtCol(e,t).filter(e=>1==$string.isNullOrEmpty(e)).length:0<$grid.getDataAtCol(e,t).filter(e=>1==$string.isNullOrEmpty(e)||e===n).length},checkEmptyValueCols(e,t,n){for(var r=$grid.getSettings(e).data,i=0,o=r.length;i<o;i++){for(var s=r[i],a=!1,l=0;l<t.length;l++){var u=t[l];if(1==$object.isNullOrUndefined(n)){if(1!=$string.isNullOrEmpty(s[u])){a=!1;break}}else if(1!=$string.isNullOrEmpty(s[u])&&s[u]!==n){a=!1;break}a=!0}if(1==a)return a}return!1},setLocale(e,t,n,r){syn.$l.get(e),$resource.getBindSource(n)}}),syn.uicontrols.$grid=$grid}(window),!function(i){"use strict";syn.uicontrols=syn.uicontrols||new syn.module;var o=syn.uicontrols.$element||new syn.module;o.extend({name:"syn.uicontrols.$element",version:"1.0.0",defaultSetting:{contents:"",disabled:!1,dataType:"string",belongID:null,controlText:null,content:"value",validators:null,transactConfig:null,triggerConfig:null},addModuleList(e,t,n,r){var i=e.getAttribute("id"),o=e.getAttribute("syn-datafield"),e=e.closest("form")?e.closest("form").getAttribute("syn-datafield"):"";t.push({id:i,formDataFieldID:e,field:o,module:this.name,type:r})},controlLoad(e,t){var n=syn.$l.get(e),r=(t=syn.$w.argumentsExtend(o.defaultSetting,t),i[syn.$w.pageScript]);r&&r.hook.controlInit&&(r=r.hook.controlInit(e,t),t=syn.$w.argumentsExtend(t,r)),n.setAttribute("syn-options",JSON.stringify(t)),t.bindingID&&syn.uicontrols.$data&&syn.uicontrols.$data.bindingSource(e,t.bindingID)},getValue(e,t){var n=null,r=syn.$l.get(e);if(0==$object.isNullOrUndefined(r)){e=r.getAttribute("syn-options");if(e)switch(JSON.parse(e).content){case"value":n=r.value;break;case"text":n=r.innerText;break;case"html":n=r.innerHTML;break;default:n=r.value}else n=r.value}else n="";return n},setValue(e,t,n){var r=syn.$l.get(e);if(t&&0==$object.isNullOrUndefined(r)){e=r.getAttribute("syn-options");if(e)switch(JSON.parse(e).content){case"value":r.value=t;break;case"text":"innerText"in r&&(r.innerText=t);break;case"html":"innerHTML"in r&&(r.innerHTML=t);break;default:r.value=t}else r.value=t}},clear(e,t){var n=syn.$l.get(e);if(0==$object.isNullOrUndefined(n)){e=n.getAttribute("syn-options");if(e)switch(JSON.parse(e).content){case"value":n.value="";break;case"text":"innerText"in n&&(n.innerText="");break;case"html":"innerHTML"in n&&(n.innerHTML="");break;default:n.value=""}else n.value=""}},setLocale(e,t,n,r){var i,o;0==$object.isNullOrUndefined(n)&&(i=null,i=0==$string.isNullOrEmpty(n.elID)?syn.$l.get(n.elID):syn.$l.querySelector('{0}[i18n-key="{1}"]'.format(n.tag,n.key)),o=$resource.getBindSource(n),0==$string.isNullOrEmpty(o))&&(i[o]=$resource.translateText(n,r))}}),syn.uicontrols.$element=o}(window);